******
微积分
******





函数导数
==========


定义 : 函数在某点处的导数
    函数 :math:`f(x)` 在 :math:`x_{0}` 处的导数为

.. math::
	\begin{align}
	f'(x_{0})=\lim \limits_{x \to x_{0}} \frac{f(x)-f(x_{0})}{x-x_{0}}= \lim \limits_{h \to 0}\frac{f(x_{0}+h)-f(x_{0})}{h}
	\end{align}

函数在某点处可导当且仅当其在该点处的左、右导数存在且相等，即

.. math::
	\begin{align}
	\lim \limits_{x \to x_{0}^{-}} \frac{f(x)-f(x_{0})}{x-x_{0}}= 
	\lim \limits_{x \to x_{0}^{+}} \frac{f(x)-f(x_{0})}{x-x_{0}}
	\end{align}

或者

.. math::
	\begin{align}
	\lim \limits_{h \to 0^{-}}\frac{f(x_{0}+h)-f(x_{0})}{h}=
	\lim \limits_{h \to 0^{+}}\frac{f(x_{0}+h)-f(x_{0})}{h}
	\end{align}



基本导数公式
------------

常用的导数公式有：

.. math::
	\begin{align}
	\begin{array}{lll}
	(\tan x)'=\sec ^{2}x \quad & (\cot x)'=-\csc ^{2}x \quad & (\sec x)'=\tan x \sec x \\
	(\arcsin x)'=\frac{1}{\sqrt{1-x^{2}}} \quad & (\arctan x)'=\frac{1}{1+x^{2}} \quad  & (\operatorname{sh}x)'=\operatorname{ch}x \\
	(\arccos x)'=\frac{-1}{\sqrt{1-x^{2}}} \quad & (\operatorname{arccot}  x)'=\frac{-1}{1+x^{2}} \quad  & (\operatorname{ch}x )'=\operatorname{sh}x 
	\end{array}
	\end{align}



高阶导数公式
------------

.. math::
	\begin{align*}
	 (a^{x})^{(n)} &=a^{x}\ln ^{n}a \\
	 [\sin (kx+a)]^{(n)}&=k^{n}\sin \bigl(kx+a+\frac{n\pi}{2} \bigr) \\
	 [\cos (kx+a)]^{(n)}&=k^{n}\cos \bigl(kx+a+\frac{n\pi}{2} \bigr) \\
	 (x^{\mu})^{(n)}&=\mu(\mu-1)\cdots (\mu-n+1)x^{\mu-n} \\
	 (\log_{a}x)^{(n)}&=\frac{(-1)^{n-1}(n-1)!}{x^{n}\ln a} \\
	 (u\cdot v)^{(n)}&=\sum_{k=0}^{n}\binom{n}{k}u^{(n-k)} v^{(k)}
	\end{align*}


.. note:: 

	高阶导数的莱布尼兹公式可以类比二项式定理：

	.. math::
		\begin{align*}
		    (a+b)^{n}=\sum _{k=0}^{n}\binom{n}{k}a^{n-k}b^{k}
		\end{align*}




泰勒公式
========


带Peano余项的泰勒展开
---------------------


定义 : 带Peano余项的泰勒展开
    带Peano余项的泰勒展开：

.. math::
	\begin{align}
	f(x)=\sum _{k=0}^{n}\frac{f^{(k)}(x_{0})}{k!}(x-x_{0})^{k}+o((x-x_{0})^{n})
	\end{align}

进行带Peano余项的展开的条件为：:math:`f(x)` 在 :math:`x_{0}` 处n阶可导。


这里列出一些常用的麦克劳林展开公式：

.. math::
	\begin{align*}
	    e^{x} &=1+x+\frac{x^{2}}{2!}+\frac{x^{3}}{3!}+o(x^{3}) \\
	    \ln(1+x) &=x-\frac{x^{2}}{2}+\frac{x^{3}}{3}+o(x^{3}) \\
	    \frac{1}{1-x} &=1+x+x^{2}+x^{3}+o(x^{3}) \\
	    \sin x &=x-\frac{x^{3}}{3!}+\frac{x^{5}}{5!}+o(x^{5}) \\
	    \cos x &=1-\frac{x^{2}}{2!}+\frac{x^{4}}{4!}+o(x^{4}) \\
	    (1+x)^{a} &=1+ax+\frac{a(a-1)}{2!}x^{2}+\frac{a(a-1)(a-2)}{3!}x^{3}+o(x^{3}) \\
	\end{align*}

利用麦克劳林公式可以求无穷小的阶数。利用带Peano余项的泰勒展开的级数形式，可以来求函数在0处的高阶导数。利用带Peano余项的泰勒展开可以证明函数某一点是否为极值点。




带Lagrange余项的泰勒展开
------------------------

定义 : 带Lagrange余项的泰勒展开
    带Lagrange余项的泰勒展开：

.. math::
	\begin{align}
	f(x)=\sum \limits_{k=0}^{n}\frac{f^{(k)}(x_{0})}{k!}(x-x_{0})^{k}+\frac{f^{(n+1)}(\xi )}{(n+1)!}(x-x_{0})^{n+1}
	\end{align}

进行带Lagrange余项的展开的条件为: :math:`\xi ` 介于x与 :math:`x_{0} ` 之间，且 :math:`f(x)` 在 :math:`\xi ` 的取值范围内处处 :math:`n+1` 阶可导。


这里给出一些常见函数的带Lagrange余项的级数形式：

.. math::
	\begin{align}
	e^{x} &= \sum _{k=0}^{n}\frac{x^{k}}{k!}+\frac{e^{\xi }}{(n+1)!}x^{n+1} \\
	\ln(1+x) &= \sum _{k=1}^{n}(-1)^{k-1}\frac{x^{k}}{k}+(-1)^{n}\frac{x^{n+1}}{(n+1)(1+\xi )^{n+1}} \\
	(1+x)^{a} &= \sum_{k=0}^{n}\frac{a(a-1)\cdots(a-k+1)}{k!}x^{k}+\frac{a(a-1)\cdots(a-n) }{(n+1)!}(1+\xi )^{a-n-1}x^{n+1}
	\end{align}

需要注意的是，以上两种展开方式的展开阶数，都由余项前面的那一项的幂次决定。


函数作图
=========

函数的凸凹性
------------

定义 : 凸函数
    凸函数有三种定义或判别式，凸函数的二元定义式为：

.. math::
	\begin{align}
	\lambda f(x)+(1-\lambda )f(y)\geqslant f(\lambda x+(1-\lambda)y)
	\end{align}

凸函数的多元定义式为： :math:`\forall \lambda_{1}+\lambda_{2}+\cdots +\lambda_{n}=1` 满足

.. math::
	\begin{align}
	\lambda_{1}f(x_{1})+\lambda_{2}f(x_{2})+\cdots+\lambda_{n}f(x_{n})\geqslant f(\lambda_{1}x_{1}+\lambda_{2}x_{2}+\cdots +\lambda_{n}x_{n})
	\end{align}

凸函数的导数定义为： :math:`f''(x)\geqslant 0` 。


凸函数有以下性质。三斜率定理： 

.. math::
	\begin{align}
	    \frac{f(x_{1})-f(x_{2})}{x_{1}-x_{2}} \leqslant 
	    \frac{f(x_{1})-f(x_{3})}{x_{1}-x_{3}} \leqslant
	    \frac{f(x_{2})-f(x_{3})}{x_{2}-x_{3}}
	\end{align}

若将 :math:`\sum \limits_{k=1}^{n}\lambda_{k}(~~)` 记作 :math:`\sigma (~~)` ，则凸函数满足

.. math::
	\begin{align}
	\sigma (f(x)) \geqslant f(\sigma (x))
	\end{align}

特别地，可以写为积分形式：

.. math::
	\begin{align}
	\frac{\int _{0}^{t}f(g(x))\mathrm{d}x}{t} \geqslant f \left(\frac{\int _{0}^{t}g(x)\mathrm{d}x }{t}\right)
	\end{align}



利用这些不等关系可以证明一些多变量不等式：

**例题** :math:`\forall x_{1}, x_{2}, \ldots, x_{n} \geqslant 0`  以及  :math:`p \geqslant 1` , 求证：

.. math::
	\begin{align}
	\left(\frac{x_{1}+x_{2}+\cdots+x_{n}}{n}\right)^{p} \leqslant \frac{x_{1}^{p}+x_{2}^{p}+\cdots+x_{n}^{p}}{n}
	\end{align}

**证明** :math:`\forall x \geqslant 0` , 定义  :math:`f(x)=x^{p}` , 则  :math:`f`  为连续函数且在  :math:`(0,+\infty)`  上二阶可导. 
又  :math:`\forall x>0` , 我们有  :math:`f^{\prime}(x)=p x^{p-1}, f^{\prime \prime}(x)=p(p-1) x^{p-2} \geqslant 0` , 故  :math:`f`  为凸函数, 从而由凸函数的性质可知,  :math:`\forall x_{1}, x_{2}, \ldots, x_{n} \geqslant 0` , 我们有

.. math::
	\begin{align}
	\left(\frac{x_{1}+x_{2}+\cdots+x_{n}}{n}\right)^{p}=f\left(\sum_{k=1}^{n} \frac{1}{n} x_{k}\right) \leqslant \sum_{k=1}^{n} \frac{1}{n} f\left(x_{k}\right)=\frac{x_{1}^{p}+x_{2}^{p}+\cdots+x_{n}^{p}}{n}
	\end{align}

由此可知所证结论成立。



定义 : 拐点
    拐点为函数凸凹性发生改变的一个二维点，即满足 :math:`f''(x_{0})=0` 的 :math:`(x_{0},f(x_{0}))` 。


需要注意的是，证明函数为凸函数或者判断凹凸区间时，要留意导数的定义域，如果出现断点可能会导致函数在两个区间上严格凸，但在合并区间并不是凸函数。这个时候要用凸函数的二元定义式来说明其在合并区间不是严格凸：


**例题** 讨论由参数方程给出的函数  :math:`\left\{\begin{array}{l}x=3 \cos ^{3} t \\ y=3 \sin ^{3} t\end{array}(0 \leqslant t \leqslant \pi)\right.`  的凸凹性。

**解** 由题设知  :math:`x, y`  为初等函数, 故无穷可导。又  :math:`x`  在  :math:`[0, \pi]`  上严格 递减, 因而有反函数  :math:`t=\arccos \sqrt[3]{\frac{x}{3}}` 。而函数  :math:`x`  的值域为  :math:`[-3,3]` , 因此  :math:`y`  可以 看成是  :math:`x`  的连续函数  :math:`f(x)` 。函数  :math:`f`  的定义域为  :math:`[-3,3]` , 它为偶函数。 :math:`\forall t \in[0, \pi]` , 我们有

.. math::
	\begin{align}
	x^{\prime}(t)=-9\left(\cos ^{2} t\right) \sin t,~~ y^{\prime}(t)=9\left(\sin ^{2} t\right) \cos t
	\end{align}

由此可知 当  :math:`t \ne 0, \frac{\pi}{2}, \pi`  时, 也即  :math:`x\ne 3,0,-3`  时,  :math:`x^{\prime}(t) \ne 0` , 此时  :math:`y`  关于  :math:`x`  可导, 且

.. math::
	\begin{align}
	f^{\prime}(x)=\frac{\mathrm{d} y}{\mathrm{~d} x}=\frac{9\left(\sin ^{2} t\right) \cos t}{-9\left(\cos ^{2} t\right) \sin t}=-\tan t
	\end{align}

进而可知此时  :math:`y`  关于  :math:`x`  也二阶可导, 且

.. math::
	\begin{align}
	f^{\prime \prime}(x)=\frac{\mathrm{d}^{2} y}{\mathrm{~d} x^{2}}=\frac{\mathrm{d}}{\mathrm{d} t}\left(\frac{\mathrm{d} y}{\mathrm{~d} x}\right) \cdot \frac{1}{x^{\prime}(t)}=-\frac{1}{\cos ^{2} t} \cdot \frac{1}{-9\left(\cos ^{2} t\right) \sin t}=\frac{1}{\left(9 \cos ^{4} t\right) \sin t}>0
	\end{align}

则  :math:`f`  在  :math:`[-3,0]`  和  :math:`[0,3]`  上均为严格凸. 又函数  :math:`x, y`  分别在  :math:`\left[0, \frac{\pi}{2}\right]`  上严格递减 和严格递增, 因此  :math:`f`  在  :math:`[0,3]`  上严格递减, 从而  :math:`\forall t \in\left(0, \frac{\pi}{2}\right)` , 我们有

.. math::
	\begin{align}
	\frac{1}{2} f(-x(t))+\frac{1}{2} f(x(t))=f(x(t))<f(0)=y\left(\frac{\pi}{2}\right)=f\left(\frac{1}{2}(-x(t))+\frac{1}{2} x(t)\right)
	\end{align}

因此  :math:`f`  在  :math:`[-3,3]`  上不是凸函数。



渐近线
------

定义 : 水平渐近线
    水平渐近线：当函数在趋于自变量趋于无穷时会趋于某个确定的值L，则这个值所确定的水平线 :math:`y=L` 即为函数的水平渐近线，即

.. math::
	\begin{align}
	\lim \limits_{x \to +\infty}f(x)=L_{1},~~\lim \limits_{x \to -\infty}f(x)=L_{2}
	\end{align}



定义 : 竖直渐近线
    竖直渐近线：当函数在自变量趋于某个值 :math:`x_{0}` 的时候会趋于无穷，则这个值所确定的竖直线 :math:`x=_{0}` 即为函数的竖直渐近线，即

.. math::
	\begin{align}
	\lim \limits_{x \to x_{0}}f(x)=\infty
	\end{align}



定义 : 斜渐近线
    斜渐近线：斜渐近线一般分为两侧，其中

.. math::
	\begin{align}
	\lim \limits_{x \to +\infty}\frac{f(x)}{x}=k_{1}\ne 0 ,~~\lim \limits_{x \to +\infty}(f(x)-kx)=b_{1}
	\end{align}

.. math::
	\begin{align}
	\lim \limits_{x \to -\infty}\frac{f(x)}{x}=k_{2}\ne 0 ,~~\lim \limits_{x \to -\infty}(f(x)-kx)=b_{2}
	\end{align}


单变量积分的性质
================

一致连续函数
------------


定义 : 一致连续
    :math:`\forall \epsilon >0, ~\exists \delta >0` 使 :math:`\forall x,y \in X,~ |x-y|<\delta` 均有 :math:`|f(x)-f(y)|<\epsilon` ，则称为f(x)一致连续。


判断函数是一致连续的方法有：

- 若函数在闭区间内连续，则该函数在这个闭区间内一致连续。但对于开区间没有这样的性质。
- q-Lipschitz判别准则：若 :math:`\exists q>0` 使得 :math:`|f(x)-f(y)|\leqslant q|x-y|` ，则f(x)一致连续。一般来说，q可以通过拉格朗日中值定理来确定。
- 根据定义的 :math:`\epsilon-\delta` 语言，通过一定的放缩证明 :math:`|f(x)-f(y)|<const \times |x-y|` ，此时取 :math:`\epsilon= \text{const} \times \delta`

证明函数不是一致连续，一般采用取数列的方法：

在X中的两个数列满足 :math:`\lim \limits_{n \to \infty}x_{n}=0,~~\lim \limits_{n \to \infty }y_{0}=0` ，但 :math:`\lim\limits_{n \to \infty}(f(x_{n}-f(y_{n})))\ne 0` ，则可证明f(x)不是一致连续。

如果  :math:`\Omega \subset \mathbb{R}^{n}`  为有界闭集，而  :math:`f\in \mathscr{C}(\Omega)`  ,则  :math:`f`  在  :math:`\Omega`  上一致连续。




黎曼积分
--------

定义 : 黎曼积分
    对于 :math:`\xi _{i} \in [x_{i},x_{i+1}],~~\Delta x_{i}=x_{i+1}-x_{i},~~a =x_{0}<x_{1}<\cdots <x_{n}= b` ，黎曼积分定义为

.. math::
	\begin{align}
	\int _{a}^{b}f(x)\mathrm{d}x=\lim\limits_{\lambda(P) \to 0}\sum\limits_{i=1}^{n}f(\xi _{i})\Delta x_{i} 
	\end{align}

通过积分与级数求和的转化，可以实现积分式极限中进行部分积分.一种常见的形式为

.. math::
	\begin{align}
	\int_{0}^{1}f(x)\mathrm{d}x=\lim \limits_{n \to +\infty}\sum\limits_{i=1}^{n}f(\xi _{i})\frac{1}{n}
	\end{align}

其中 :math:`\xi _{i}\in [\frac{i}{n},\frac{i+1}{n}]` 。





**例题** 若 :math:`f\in C[0,2\pi ]` ，求证： :math:`\lim \limits _{n \to \infty} \int_{0}^{2\pi }f(x)\left | \sin (nx ) \right | ~dx=\frac{2}{\pi }\int_{0}^{2\pi } f(x)~dx` 。

**证明** 令 :math:`x_{k}=\frac{2\pi k}{n},~x_{k+1}\frac{2\pi (k+1)}{n}` 取 :math:`\xi_{k} \in [x_{k},x_{k+1}]` ，由积分第一中值定理可得

.. math::
	\begin{align}
	    \int_{0}^{2\pi }f(x)\left | \sin (nx ) \right | ~dx=
	    \sum\limits_{k=1}^{n}f(\xi ) \int_{x_{i}}^{x_{i+1}}|\sin(nx)|\mathrm{d}x=
	    \sum\limits_{k=1}^{n}f(\xi )\frac{4}{n}
	\end{align}

配凑黎曼积分可得

.. math::
	\begin{align}
	    \sum\limits_{k=1}^{n}f(\xi )\frac{4}{n}=
	    \frac{2}{\pi}\sum\limits_{k=1}^{n}f(\xi )\frac{2\pi}{n}=
	    \frac{2}{\pi }\int_{0}^{2\pi } f(x)~\mathrm{d}x 
	\end{align}



利用类似的处理方式可以解决计算极限问题： :math:`\lim \limits _{n \to \infty} \int_{0}^{1}x^{2}\sin ^{2}(n\pi x)~\mathrm{d}x` 。还可以实现级数求和的极限（通常分母次数大于分子）转化为定积分。常见形式为：

.. math::
	\begin{align}
	    \lim\limits_{n \to \infty}\sum\limits_{k=1}^{n}\frac{b-a}{n}f(k\frac{b-a}{n})=\int_{a}^{b}f(x)\mathrm{d}x
	\end{align}



**例题** 求极限 :math:`\lim \limits_{n \to \infty} \frac{1}{n} \sum\limits_{k=1}^{n} 2^{\frac{k}{n}}=\int_{0}^{1} 2^{x} ~\mathrm{d}x` 。

**解** :math:`\forall x \in[0,1]` , 定义  :math:`f(x)=2^{x}` , 则  :math:`f \in \mathscr{C}[0,1]` , 从而  :math:`f`  可积, 并且

.. math::
	\begin{align}
	\lim _{n \rightarrow \infty} \frac{1}{n} \sum_{k=1}^{n} 2^{\frac{k}{n}}=\int_{0}^{1} 2^{x} \mathrm{~d} x=\left.\frac{2^{x}}{\log 2}\right|_{0} ^{1}=\frac{1}{\log 2}
	\end{align}

再注意到,  :math:`\forall n \geqslant 1` , 我们均有  :math:`\frac{1}{n+1} \sum\limits_{k=1}^{n} 2^{\frac{k}{n}} \leqslant \sum\limits_{k=1}^{n} \frac{2 \frac{k}{n}}{n+\frac{1}{k}} \leqslant \frac{1}{n} \sum\limits_{k=1}^{n} 2^{\frac{k}{n}}` , 于是由夹逼原理可知  :math:`\lim \limits_{n \rightarrow \infty} \frac{1}{n} \sum\limits_{k=1}^{n} \frac{2 \frac{k}{n}}{n+\frac{1}{k}}=\frac{1}{\log 2}` 。




积分的性质
----------

线性性：

.. math::
	\begin{align}
	\int _{a}^{b}(\alpha f(x)+\beta g(x))\mathrm{d}x=\alpha \int _{a}^{b}f(x)\mathrm{d}x+\beta \int _{a}^{b}g(x)\mathrm{d}x
	\end{align}

区间可加性：

.. math::
	\begin{align}
	    \int _{a}^{b}f(x)\mathrm{d}x=\int _{a}^{c}f(x)\mathrm{d}x+\int _{c}^{b}f(x)\mathrm{d}x
	\end{align}

保序性：

.. math::
	\begin{align}
	    \text{若}f\geqslant g,\text{则}\int _{a}^{b}f(x)\mathrm{d}x \geqslant \int _{a}^{b}g(x)\mathrm{d}x
	\end{align}

根据保序性可以推出保号性，以及积分放缩或作差来比较大小。



积分不等式
----------

**放缩不等式** ：对于 :math:`m\leqslant f(x) \leqslant M` , 有

.. math::
	\begin{align}
	    m(b-a)\leqslant \int _{a}^{b}f(x)\mathrm{d}x \leqslant M(b-a)
	\end{align}

很多时候利用单调性或取值的选择可以做到很好的放缩，从而证明与具体的数比较大小，以及配合夹逼定理证明积分式的极限。


**绝对值不等式** ：

.. math::
	\begin{align}
	    \left| \int _{a}^{b}f(x)\mathrm{d}x  \right| \leqslant\int _{a}^{b}|f(x)|\mathrm{d}x
	\end{align}


**柯西不等式** ：

.. math::
	\begin{align}
	    \left(\int _{a}^{b}f(x)g(x)\mathrm{d}x\right)^{2} \leqslant\left(\int _{a}^{b}(f(x))^{2}\mathrm{d}x\right)\left(\int _{a}^{b}(g(x))^{2}\mathrm{d}x\right)
	\end{align}

一般不等式中出现了平方项都要首先考虑能否使用柯西不等式，而在应用的时候常常会将常数 :math:`1` 看做平方甚至积分，并且可以将没有平方的项看做是开根后再平方。


**Holder不等式** ：对于 :math:`\frac{1}{p}+\frac{1}{q}=1` 有

.. math::
	\begin{align}
	    \left|\int _{a}^{b}f(x)g(x)\mathrm{d}x\right| \leqslant\left(\int _{a}^{b}|f(x)|^{p}\mathrm{d}x\right)^{\frac{1}{p}}\left(\int _{a}^{b}|g(x)|^{q}\mathrm{d}x\right)^{\frac{1}{q}}
	\end{align}


**Jensen不等式** ：对于 :math:`f''(x)\geqslant 0` 有

.. math::
	\begin{align}
	\frac{\int _{a}^{b}f(g(x))\mathrm{d}x}{b-a} \geqslant f \left(\frac{\int _{a}^{b}g(x)\mathrm{d}x }{b-a}\right)
	\end{align}




积分中值定理
------------

**积分第一中值定理** ：若 :math:`f\in R[a,b]` 在(a,b)上连续，则 :math:`\exists \xi \in (a,b)` 使得

.. math::
	\begin{align}
	\int_{a}^{b}f(x)\mathrm{d}x=f(\xi)(b-a)
	\end{align}

**广义积分第一中值定理** ：若 :math:`f\in R[a,b]` 在(a,b)上连续， :math:`g(x)\in R[a,b]` 且不变号，则 :math:`\exists \xi \in (a,b)` 使得

.. math::
	\begin{align}
	\int_{a}^{b}f(x)g(x)\mathrm{d}x=f(\xi)\int_{a}^{b}g(x)\mathrm{d}x
	\end{align}

**积分第二中值定理** ：若 :math:`f\in R[a,b]` , :math:`g` 在 :math:`[a,b]` 上单调，则 :math:`\exists \xi \in [a,b]` 使得

.. math::
	\begin{align}
	    \int_{a}^{b}f(x)g(x)\mathrm{d}x=g(a)\int_{a}^{\xi}f(x)\mathrm{d}x+g(b)\int_{\xi}^{b}f(x)\mathrm{d}x
	\end{align}


牛顿-莱布尼兹公式
-----------------

原函数
^^^^^^

定义 : 原函数
    若 :math:`F(x)=\int_{a}^{b}f(x)\mathrm{d}x` 且满足 :math:`\forall x_{0}\in X` 均有 :math:`F'(x_{0})=f(x_{0})` ，则称 :math:`F(x)` 为 :math:`f(x)` 的原函数。

如果函数是连续的，那它一定有原函数；而有些非连续函数也存在原函数。但并不是所有函数都有原函数，例如：有跳跃间断点的函数没有原函数。所以一种判断存在原函数的方法就是利用左、右极限证明没有跳跃间断点。

若 :math:`f` 在开区间内连续，则 :math:`F` 在这个区间内可导；如果 :math:`f` 是连续的，那么可以利用求导来判断 :math:`F` 的单调性，否则只能用单调性的定义来说明。


变上限积分函数求导
^^^^^^^^^^^^^^^^^^

变上限积分函数的求导公式：

.. math::
	\begin{align}
	\text{对于}G(x)=\int_{\psi(x) }^{\varphi(x)}f(t)\mathrm{d}t~~\text{,有}~~G'(x)=f(\varphi(x)) \varphi'(x)-f(\psi(x) )\psi'(x) 
	\end{align}

基于这个求导法则，可以利用洛必达法则处理含有变上限积分的极限式。


**例题** 求极限 :math:`\lim \limits_{x \rightarrow 0} \frac{\int_{\sin x}^{x}  \sqrt{1-t^{2}} \mathrm{~d} t}{x^{3}}` 。

**解** 

.. math::
	\begin{align}
	\text{原式}&=\lim \limits_{x \rightarrow 0} \frac{\sqrt{1-x^{2}} -\sqrt{1- \sin ^{2} x} \cos x}{3 x^{2}}=
	\lim \limits_{x \rightarrow 0} \frac{\sqrt{1-x^{2}}-\cos ^{2} x}{3 x^{2}} \\
	&=\lim \limits_{x \rightarrow 0} \frac{\frac{-x}{\sqrt{1-x^{2}}}+2 \sin x \cos x}{6 x}=
	-\frac{1}{6}+\frac{1}{3}=\frac{1}{6}
	\end{align}



牛顿-莱布尼兹公式
^^^^^^^^^^^^^^^^^

对于存在原函数的函数积分，可以写成

.. math::
	\begin{align}
	\int_{a}^{b}f(x)\mathrm{d}x=F(b)-F(a)
	\end{align}

实际上，在含有积分式的等式或不等式中，常常逆用牛顿-莱布尼兹公式来进行整合，即

.. math::
	\begin{align}
	f(b)-f(a)=\int_{a}^{b}f'(x)\mathrm{d}x
	\end{align}




不定积分
========

基本的不定积分公式
------------------

(1) 一般函数：
    
.. math::
	\begin{align}
	& \int x^{k}\mathrm{d}x=\frac{1}{k+1}x^{k+1}+C~~(k\ne \text{-1}) \\
	& \int \frac{1}{x}\mathrm{d}x=\ln |x| +C \\
	& \int a^{x}\mathrm{d}x=\frac{a^{x}}{\ln a}+C
	\end{align}

(2) 分母平方类
    
.. math::
	\begin{align}
	& \int \frac{1}{x^{2}+a^{2}}\mathrm{d}x=\frac{1}{a}\arctan \frac{x}{a}+C \\
	& \int \frac{1}{x^{2}-a^{2}}\mathrm{d}x=\frac{1}{2a}\ln |\frac{x-a}{x+a}|+C
	\end{align}

(3) 含根号类
    
.. math::
	\begin{align}
	& \int\frac{1}{\sqrt{x^{2}\pm a^{2}}}\mathrm{d}x=\ln |x+\sqrt{x^{2}\pm a^{2}}|+C \\
	& \int\frac{1}{\sqrt{a^{2}-x^{2}}}\mathrm{d}x=\arcsin \frac{x}{a}+C \\
	& \int\sqrt{x^{2}\pm a^{2}}\mathrm{d}x=\frac{x}{2}\sqrt{x^{2}\pm a^{2}}\pm \frac{a^{2}}{2}\ln |x+\sqrt{x^{2}\pm a^{2}}|+C
	& \int\sqrt{a^{2}-x^{2}}\mathrm{d}x=\frac{x}{2}\sqrt{a^{2}-x^{2}}+\frac{a^{2}}{2}\arcsin \frac{x}{a}+C
	\end{align}


(4) 三角函数类

.. math::
	\begin{align}
	& \int \tan x\mathrm{d}x=-\ln |\cos x|+C && \int \cot x\mathrm{d}x=\ln |\sin x|+C \\
	& \int \sec x\mathrm{d}x=\ln |\sec x+\tan x|+C && \int \csc x\mathrm{d}x=\ln |\csc x-\cot x|+C \\
	& \int \sin^{2}x\mathrm{d}x=\frac{2x-\sin 2x}{4}+C && \int \cos^{2}x\mathrm{d}x=\frac{2x+\sin 2x}{4}+C \\
	& \int \tan^{2}x\mathrm{d}x=\tan x-x+C && \int \cot^{2}x\mathrm{d}x=-\cot x-x+C \\
	& \int \sec^{2}x\mathrm{d}x=\tan x+C && \int \csc^{2}x\mathrm{d}x=-\cot x+C
	\end{align}

(5) 指数乘三角类
    
.. math::
	\begin{align}
	& \int e^{ax}\cos bx\mathrm{d}x=\frac{e^{ax}}{a^{2}+b^{2}}(a\cos bx+b\sin bx)+C \\
	& \int e^{ax}\sin bx\mathrm{d}x=\frac{e^{ax}}{a^{2}+b^{2}}(a\sin bx-b\cos bx)+C
	\end{align}



不定积分方法
------------

分段函数的不定积分
^^^^^^^^^^^^^^^^^^

先根据定义域划分，去掉绝对值；然后分别积分，保留 :math:`C_{1},C_{2}` ;最后根据连续性确定 :math:`C_{1},C_{2}` 的关系。


第一类换元积分(凑微分)
^^^^^^^^^^^^^^^^^^^^^^^^

凑微分的基本运算过程为

.. math::
	\begin{align}
	\int f(\varphi(x))\varphi'(x)\mathrm{d}x=\int f(\varphi(x))\mathrm{d}(\varphi(x))=F(\varphi(x))
	\end{align}

实际运用的时候就是让 :math:`\mathrm{d}x` 与被积函数中的一部分先运算，从而换元化简。一些常见的配凑有： :math:`\frac{x}{\sqrt{1+x^{2}}}\mathrm{d}x=\mathrm{d}\left(\sqrt{1+x^{2}} \right)` 。


第二类换元积分
^^^^^^^^^^^^^^

(1) 倒代换
    
在被积函数的分母次数比分子高两次及以上时，可以令 :math:`x=\frac{1}{t}` .尤其出现了 :math:`x^{n}` 时，很可能要用这种方法代换，同时使用凑微分。

(2) 复杂函数直接替换
    
当被积函数有 :math:`e^{x},~\ln x,~\arcsin x,~\arctan x` 等时，直接令它们等于 :math:`t` 。

但是当 :math:`\ln x,~\arctan x,~\arcsin x` 与 :math:`P_{n}(x)` 或 :math:`e^{x}` 相乘时，优先考虑分部积分。

(3) 三角换元
    
对于 :math:`\sqrt{a^{2}-x^{2}}` 结构，令 :math:`x=a\sin t` ，此时  :math:`\mathrm{d}x=a\cos t\mathrm{d}t` ；

对于 :math:`\sqrt{a^{2}+x^{2}}` 结构，令 :math:`x=a	an t` ，此时  :math:`\mathrm{d}x=a\sec^{2} t\mathrm{d}t` ；

对于 :math:`\sqrt{x^{2}-a^{2}}` 结构，令 :math:`x=a\sec t` ，此时  :math:`\mathrm{d}x=a\tan t\sec t\mathrm{d}t` 。

在进行代换的时候，要注意 :math:`x` 的取值范围与正负号。


重要的三角函数运算公式：

(1) 倍角公式：
    
.. math::
	\begin{align}
	& 1+\cos x=2\cos^{2}\frac{x}{2} && 1-\cos x=2\sin^{2}\frac{x}{2} \\
	& \cos^{2}x=\frac{1+\cos2x}{2} && \sin^{2}x=\frac{1-\cos2x}{2} \\
	&\sin x=2\sin\frac{x}{2}\cos\frac{x}{2} && (\sin x+\cos x)^{2}=1+\sin 2x \\
	& (\sin x-\cos x)^{2}=1-\sin 2x
	\end{align}

(2) 和差化积：
    
.. math::
	\begin{align}
	& \sin x+\sin y=2\sin \frac{x+y}{2}\cos \frac{x-y}{2} && \sin x-\sin y=2\cos \frac{x+y}{2}\sin \frac{x-y}{2} \\
	& \cos x+\cos y=2\cos \frac{x+y}{2}\cos \frac{x-y}{2} && \cos x-\cos y=-2\sin \frac{x+y}{2}\sin \frac{x-y}{2}
	\end{align}

(3) 积化和差：
    
.. math::
	\begin{align}
	& \sin x\cos y=\frac{1}{2}[\sin(x+y)+\sin(x-y)] && \cos x\sin y=\frac{1}{2}[\sin(x+y)-\sin(x-y)] \\
	& \cos x\cos y=\frac{1}{2}[\cos(x+y)+\cos(x-y)] && \sin x\sin y=-\frac{1}{2}[\cos(x+y)-\cos(x-y)]
	\end{align}




分部积分
^^^^^^^^

分部积分公式为

.. math::
	\begin{align}
	\int u \mathrm{d}v=uv-\int v\mathrm{d}u
	\end{align}

判断凑微分部分的口诀为：反、对、幂、三、指，在前面的不动，在后面的凑微分。

有时候不需要一直求导到零，当中间出现了可以积出来的式子就可以不用分部积分了。而分部积分的过程中，可以根据需要调配x到u或v，从而让分部积分能够进行下去。

某些情况下会把 :math:`1` 看做凑微分的项来进行分部积分，从而实现对积分内的式子求导。




有理函数的不定积分
------------------

如果分子次数比分母次数高，则先进行长除法分解。而对于有理真分式 :math:`\frac{P(x)}{Q(x)}` ,总能分解为四种分解项的和，即

.. math::
	\begin{align}
	\frac{P(x)}{Q(x)}=\sum \frac{A}{x-a}+\sum \frac{B}{(x-a)^{2}}+\sum \frac{Cx+D}{x^{2}+px+q}+\sum \frac{Ex+F}{(x^{2}+px+q)^{2}}
	\end{align}

这些分解项是根据分母的因式分解来决定。因此要通过求根法来分解因式。

- 对于因子  :math:`\frac{1}{x-A}`  的系数，可以直接使用留数法（不求导）得到；
- 对于因子  :math:`\frac{1}{(x-A)^{p}}~~(p\geqslant 2)`  的系数，可以通过留数法（求导）得到，也可以用极限法或特殊值法得到；
- 对于因子  :math:`\frac{1}{(x^{2}+Mx+N)^{p}}`  的系数，一般用特殊值法和极限法求得待定系数。
  
各类分解项的积分如下：

.. math::
	\begin{align}
	& \int \frac{1}{x-a}\mathrm{d}x=\ln |x-a|+C && \int \frac{1}{(x-a)^{m}}\mathrm{d}x=\frac{1}{-m+1}\frac{1}{(x-a)^{m-1}}+C \\
	& \int \frac{x}{x^{2}+a^{2}}\mathrm{d}x=\frac{1}{2}\ln (x^{2}+a^{2})+C && \int \frac{x}{(x^{2}+a^{2})}\mathrm{d}x=\frac{1}{2(-m+1)}\frac{1}{(x^{2}+a^{2})^{m-1}}+C
	\end{align}


对于 :math:`I_{m}=\int \frac{1}{(x^{2}+a^{2})^{m}}\mathrm{d}x` ，基于 :math:`I_{1}=\frac{1}{a}\arctan \frac{x}{a}+C` ，存在递推关系式：

.. math::
	\begin{align}
	I_{m+1}=\frac{x}{2a^{2}m(x^{2}+a^{2})^{m}}+\frac{2m-1}{2a^{2}m}I_{m}
	\end{align}




三角有理式的不定积分
--------------------

定义 : 三角有理式
    由 :math:`\sin x,\cos x` 的四则运算组成的算式称为三角有理式，记作 :math:`R(\sin x,\cos x)` 。



万能公式：令 :math:`t=\tan \frac{x}{2}` 可以将三角有理式的积分转化为有理函数的积分。其中：

.. math::
	\begin{align}
	\sin x=\frac{2t}{1+t^{2}};\quad\cos x=\frac{1-t^{2}}{1+t^{2}};\quad\mathrm{d}x=\frac{2}{1+t^{2}}\mathrm{d}t
	\end{align}

并不是所有三角有理式都需要用万能公式来转化为有理函数积分。有时候用万能公式会造成大量的运算，而对于以下情形可以采取其他的换元方法：

- 如果是关于 :math:`\sin x` 的奇函数，则令 :math:`t=\cos x` 凑微分；
- 如果是关于 :math:`\cos x` 的奇函数，则令 :math:`t=\sin x` 凑微分；
- 如果是关于 :math:`\sin x,\cos x` 的偶函数，则分子分母同乘 :math:`\sec^{2} x` 构造关于 :math:`\tan x` 的有理式，令 :math:`t=\tan x` .
- 对于 :math:`\int \sin ax\cos bx\mathrm{d}x,~\int \cos ax\cos bx\mathrm{d}x,~\int \sin ax\sin bx\mathrm{d}x` 类型，使用积化和差来分解，分别进行积分。
- 对于 :math:`\int \sin^{m}x\cos^{n}x\mathrm{d}x` 类型：若 :math:`m,n` 其中有一个是奇数，则从是奇数次幂的三角函数那凑微分，令令一项三角函数等于 :math:`t` ，从而转化为多项式积分；若 :math:`m,n` 均为偶数，则需要不断使用倍角公式来降幂。类似的思想可以处理 :math:`\int \sin^{n}x\mathrm{d}x` 和 :math:`\int \cos^{n}\mathrm{d}x`


部分无理函数的积分
------------------

对于以下含根式的情形可以通过根式代换来积分：

对于含有 :math:`\sqrt[n]{ax+b},\sqrt{\frac{ax+b}{cx+d}},\sqrt{ae^{bx}+c}` 等结构的函数，令 :math:`t=\sqrt{\Delta}` .

然而，有时候进行分子有理化并使用三角换元可能会避开有理函数繁杂的计算。



定积分
======

定积分的计算方法
----------------

大部分定积分都是基于不定积分的结果，由牛顿-莱布尼兹公式求出。需要额外注意的是，积分上下限确定了变量正负号，所以在使用三角换元的时候要考虑正负号。

以下说明定积分特有的计算方法。


分段函数的定积分
^^^^^^^^^^^^^^^^

通过区间可加性，拆分成不同区间的定积分，从而去掉绝对值。


周期连续函数的定积分
^^^^^^^^^^^^^^^^^^^^

若函数 :math:`f(x)` 的周期为 :math:`T>0` ，则

.. math::
	\begin{align}
	    \int_{a}^{a+T}f(x)\mathrm{d}x=\int_{0}^{T}f(x)\mathrm{d}x
	\end{align}


定积分的对称性
^^^^^^^^^^^^^^

函数对称理论：若 :math:`u(x)` 关于 :math:`[a,b]` 轴对称，则 :math:`f(u(x))` 关于 :math:`[a,b]` 对称；若 :math:`u(x)` 关于 :math:`[a,b]` 中心对称，则 :math:`f(u(x))` 的对称性与 :math:`f(x)` 的奇偶性保持一致。

定积分积分上下限变换：基于对称理论，可以得到定积分积分上下限的变化公式：

- 若 :math:`f(x)` 关于 :math:`[a,b]` 对称，则 :math:`\int_{a}^{b}f(x)\mathrm{d}x=2\int_{a}^{\frac{a+b}{2}}f(x)\mathrm{d}x` ；特别地，若 :math:`f(x)` 是偶函数，则 :math:`\int_{-a}^{a}f(x)\mathrm{d}x=2\int_{0}^{a}f(x)\mathrm{d}x` 。
- 若 :math:`f(x)` 关于 :math:`[a,b]` 中心对称，则 :math:`\int_{a}^{b}f(x)\mathrm{d}x=0` ;特别地，若 :math:`f(x)` 是奇函数，则 :math:`\int_{-a}^{a}f(x)\mathrm{d}x=0` 。
  

三角函数的定积分
^^^^^^^^^^^^^^^^

对于难以计算出来的三角函数定积分，常令 :math:`x=\frac{\pi}{2}\pm u` 或 :math:`\pi \pm u` ，尝试化简式子，或复现被积函数从而通过移项求解

若 :math:`f(x)` 连续，存在以下等式：

.. math::
	\begin{align*}
	    & \int_{0}^{\frac{\pi}{2}}f(\sin x)\mathrm{d}x=
	    \int_{0}^{\frac{\pi}{2}}f(\cos x)\mathrm{d}x=
	    \int_{\frac{\pi}{2}}^{\pi}f(\sin x)\mathrm{d}x \\
	    & \int_{0}^{\pi}f(\sin x)\mathrm{d}x=2\int_{0}^{\frac{\pi}{2}}f(\sin x)\mathrm{d}x \\
	    & \int_{0}^{\pi}f(\cos x)\mathrm{d}x=\int_{0}^{\frac{\pi}{2}}f(\cos x)\mathrm{d}x+\int_{0}^{\frac{\pi}{2} }f(-\sin x)\mathrm{d}x \\
	    & \int_{0}^{\pi}xf(\sin x)\mathrm{d}x=
	    \frac{\pi}{2}\int_{0}^{\pi}f(\sin x)\mathrm{d}x=
	    \pi\int_{0}^{\frac{\pi}{2}}f(\sin x)\mathrm{d}x  \\
	    & \int_{0}^{\frac{\pi}{2}}f(\sin x,\cos x)\mathrm{d}x=
	    \int_{0}^{\frac{\pi}{2}}f(\cos x,\sin x)\mathrm{d}x
	\end{align*}

点火公式：用来处理 :math:`\sin^{n} x` 和 :math:`\cos^{n}x` 从 :math:`0` 到 :math:`\frac{\pi}{2}` 的定积分。

.. math::
	\begin{align}
	\int_{0}^{\frac{\pi}{2} }\sin^{n}x\mathrm{d}x=\int_{0}^{\frac{\pi}{2} }\cos^{n}x\mathrm{d}x=
	\left\{\begin{array}{ll}
	\frac{\pi}{2}\cdot \frac{(n-1)!!}{n!!}~,\text{若n为正偶数} \\
	\frac{(n-1)!!}{n!!}~,\text{若n为正奇数}
	\end{array}\right.
	\end{align}



定积分的应用
------------

求平面面积
^^^^^^^^^^

对于直角坐标表达式 :math:`y=f(x)` ，有 :math:`S=\int_{a}^{b}y\mathrm{d}x` 。

对于参数方程表达式 :math:`\left\{\begin{array}{ll}x=x(t) \\ y=y(t)\end{array}\right.` ，有 :math:`S=\left|\int_{\alpha}^{\beta}y(t)x'(t)\mathrm{d}t \right|` 。

对于极坐标表达式 :math:`\rho=\rho(\theta) ` ，有 :math:`S=\int_{\alpha}^{\beta}\frac{1}{2}\rho^{2}\mathrm{d}\theta` 。


求曲线弧长
^^^^^^^^^^

对于直角坐标表达式 :math:`y=f(x)` ，有 :math:`l=\int_{a}^{b}\sqrt{1+(y'(x))^{2}}\mathrm{d}x` 。

对于参数方程表达式 :math:`\left\{\begin{array}{ll}x=x(t) \\ y=y(t)\end{array}\right.` ，有 :math:`l=\int_{\alpha}^{\beta}\sqrt{(x'(t))^{2}+(y'(t))^{2}}\mathrm{d}t` 。

对于极坐标表达式 :math:`\rho=\rho(\theta) ` ，有 :math:`l=\int_{\alpha}^{\beta}\sqrt{\rho^{2}+(\rho')^{2}}\mathrm{d}\theta` 。


求曲线曲率
^^^^^^^^^^


求旋转体体积
^^^^^^^^^^^^

若绕 :math:`x` 轴旋转，则：

对于直角坐标表达式 :math:`y=f(x)` ，有 :math:`V=\int_{a}^{b}\pi y^{2}\mathrm{d}x` 。

对于极坐标表达式 :math:`\rho=\rho(\theta) ` ，有 :math:`V=\int_{\alpha}^{\beta }\frac{2\pi}{3}\rho^{3}\sin\theta\mathrm{d}\theta` 。

若绕 :math:`y` 轴旋转，则对于直角坐标表达式 :math:`y=f(x)` ，有 :math:`V=\int_{a}^{b}2\pi xy\mathrm{d}x` 。


求旋转面侧面积
^^^^^^^^^^^^^^

若绕 :math:`x` 轴旋转，则面积微元 :math:`\mathrm{d}\sigma=2\pi |y|\mathrm{d}l` 。

其中，对于极坐标表达式 :math:`\rho=\rho(\theta) ` ，有 :math:`S=\int_{\alpha}^{\beta}2\pi |\rho\sin x|\sqrt{\rho^{2}+(\rho')^{2}}\mathrm{d}\theta` 。

若绕 :math:`y` 轴旋转，则面积微元 :math:`\mathrm{d}\sigma=2\pi |x|\mathrm{d}l` 。

求平面曲线的质心
^^^^^^^^^^^^^^^^






广义积分
=========

广义积分的概念
--------------

定义 : 广义积分
    当定积分为瑕积分或无穷限积分时，称为广义积分，而其值定义为 :math:`\int_{a}^{\omega}f(x)\mathrm{d}x=\lim\limits_{A \to \omega^{-}}\int_{a}^{A}f(x)\mathrm{d}x` 。

因此，广义积分在计算时要根据使 :math:`f(x)` 无界的瑕点进行区间分割，分别考虑极限是否存在，一般有 :math:`(0,1),(1,+\infty)` 分段和 :math:`(a,\frac{a+b}{2}),(\frac{a+b}{2},b)` 分段。同时，在进行分部积分的时候也需要判断分离出来的项极限是否存在；因此广义积分的计算通常是先根据不定积分求出结果再代入上下限。



定义 : 绝对收敛
    若 :math:`\int_{a}^{\omega}|f(x)|\mathrm{d}x` 收敛，则称 :math:`f(x)` 绝对收敛。此时 :math:`\int_{a}^{\omega}f(x)\mathrm{d}x` 一定也收敛。


定义 : 条件收敛
    若 :math:`\int_{a}^{\omega}|f(x)|\mathrm{d}x` 发散，但 :math:`\int_{a}^{\omega}f(x)\mathrm{d}x` 收敛，则称 :math:`f(x)` 条件收敛。



广义积分收敛性的判定
--------------------


重要的广义积分
^^^^^^^^^^^^^^

.. math::
	\begin{align}
	&\int_{1}^{+\infty} \frac{\mathrm{d} x}{x^{p}}=\left.\frac{1}{1-p} \cdot \frac{1}{x^{p-\mathrm{I}}}\right|_{1} ^{+\infty}=\left\{\begin{array}{c}
	\frac{1}{p-1}, \quad \text { 若 } p>1, \\
	+\infty, \text { 若 } p<1 .
	\end{array}\right. \\
	&\int_{0}^{1} \frac{\mathrm{d} x}{x^{p}}=\left.\frac{1}{1-p} \cdot \frac{1}{x^{p-\mathrm{I}}}\right|_{0} ^{1}=\left\{\begin{array}{cc}
	+\infty, & \text { 若 } p>1, \\
	\frac{1}{1-p}, & \text { 若 } p<1 .
	\end{array}\right.
	\end{align}

.. math::
	\begin{align}
	&\int_{1}^{+\infty}\frac{\ln x}{x^{p}}\mathrm{d}x~\text{收敛当且仅当}~p>1\\
	&\int_{0}^{1}\frac{\ln x}{x^{p}}\mathrm{d}x~\text{收敛当且仅当}~p<1
	\end{align}

.. math::
	\begin{align}
	\int_{1}^{+\infty}\frac{\sin x}{x^{p}}\mathrm{d}x \text{在}p>1 \text{时绝对收敛，在} 0<p\leqslant 1 \text{时条件收敛}
	\end{align}



柯西判定准则
^^^^^^^^^^^^



等价无穷小同敛散性
^^^^^^^^^^^^^^^^^^

若 :math:`f, g:[a, \omega) \rightarrow[0,+\infty)`  在任意闭子区间上可积，且存在  :math:`C>0`  以及  :math:`c \in[a, \omega)`  使得  :math:`\forall x \in`   :math:`[c, \omega)`  均有  :math:`|f(x)| \leq C|g(x)|` （简记为 :math:`f(x)=O(g(x))\left(x \rightarrow \omega^{-}\right)` ），则 :math:`f(x),g(x)` 同敛散性。



比较法则
^^^^^^^^

若要证明广义积分收敛，则将被积函数放大后，证明其积分收敛，则可证明原广义积分收敛；

若要证明广义积分发散，则将被积函数缩小后，证明其积分发散，则可证明原广义积分发散。

一般进行敛散性判断的区间都是 :math:`(0,1),(1,+\infty)` ，如果是其他区间的话，一般要进行拆分，或者通过换元来变回标准区间。


Abel判别准则
^^^^^^^^^^^^

若 :math:`\int_{a}^{\omega}f(x)\mathrm{d}x` 收敛，且 :math:`g(x)` 单调有界，则 :math:`\int_{a}^{\omega}f(x)g(x)\mathrm{d}x` 收敛。


Dirichlet判别准则
^^^^^^^^^^^^^^^^^

若 :math:`A\in [a,\omega),\int_{a}^{A}f(x)\mathrm{d}x` 有界，且 :math:`g(x)` 单调并满足 :math:`\lim\limits_{x \to \omega^{-}}g(x)=0` ，则 :math:`\int_{a}^{\omega}f(x)g(x)\mathrm{d}x` 收敛。





欧拉积分
--------


定义 : :math:`\Gamma` 函数
    :math:`\Gamma` 函数： :math:`\Gamma(s)=\int_{0}^{+\infty}x^{s-1}e^{-x}\mathrm{d}x` ，其中 :math:`s\in \mathbb{R}` 。


:math:`\Gamma` 函数收敛当且仅当 :math:`s>0` 。

:math:`\forall s>0,~\Gamma(s)=(s-1)\Gamma(s-1)` ，从而可以推出对任意的整数 :math:`n\geqslant0` ，有 :math:`\Gamma(n+1)=n!` .特别地有 :math:`\Gamma(1)=1` 。

余元公式： :math:`\forall 0<s<1,~\Gamma(s)\Gamma(1-s)=\frac{\pi}{\sin\pi s}` 。特别地有 :math:`\Gamma(\frac{1}{2})=\sqrt{\pi}` 。



定义 :  :math:`B` 函数
    :math:`B` 函数： :math:`B(p,q)=\int_{0}^{1}x^{p-1}(1-x)^{q-1}` ，其中 :math:`s\in \mathbb{R}` 。


:math:`B` 函数收敛当且仅当 :math:`p,q>0` 。

.. math::
	\begin{align}
	    B(p,q)=B(q,p);\quad 
	    B(p,q)=\frac{\Gamma(p)\Gamma(q)}{\Gamma(p+q)}
	\end{align}






常微分方程
==========

一阶常微分方程的初等解法
------------------------

一阶线性常微分方程
^^^^^^^^^^^^^^^^^^

一阶线性齐次常微分方程: :math:`\frac{\mathrm{d} y}{\mathrm{d} x}+P(x)y=0` 。其通解形式为：

.. math::
	\begin{align}
	y=Ce^{-\int P(x)\mathrm{d}x}
	\end{align}



一阶线性常微分方程的形式为 :math:`y'+p(x)y=g(x)` ，其通解形式为

.. math::
	\begin{align}
	y=e^{-\int p(x)~\mathrm{d}x}\left ( C+\int g(x)e^{\int p(x)~\mathrm{d}x}~\mathrm{d}x\right ) 
	\end{align}

特别地，如果是一阶线性齐次常微分方程，即 :math:`y'+p(x)y=0` ，则通解形式化简为 :math:`y=Ce^{-\int p(x)~\mathrm{d}x}` ；如果 :math:`p(x)` 和 :math:`g(x)` 均为常数，即 :math:`y'+By=K` ，则通解形式化简为 :math:`y=Ce^{-Bx}+\frac{K}{B}` 。

若给定初值条件 :math:`y(x_{0})=y_{0}` ，则解可写为定积分形式：

.. math::
	\begin{align}
	y=e^{-\int_{x_{0}}^{x} P(t)\mathrm{d}t }\left ( y_{0}+\int_{x_{0}}^{x} Q(t)e^{\int_{x_{0}}^{t} P(u)\mathrm{d}u } \mathrm{d}t \right ) 
	\end{align}




可分离变量的一阶常微分方程
^^^^^^^^^^^^^^^^^^^^^^^^^^

可分离变量的一阶常微分方程： :math:`\frac{\mathrm{d} y}{\mathrm{d} x}=f(x)g(y)` 。

当 :math:`g(y)\ne 0` 时，移项得到 :math:`\frac{1}{g(y)}\mathrm{d}y=f(x)\mathrm{d}x` ，两边积分得到一个 :math:`y` 的隐函数。

特别的，若 :math:`g(y_{0}=0)` ，则 :math:`y\equiv y_{0}` 也是原方程的一个解。




可转化为一阶线性方程的一阶方程
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

- **线性组合变量型** ：
  
一般形式为： :math:`\frac{\mathrm{d} y}{\mathrm{d} x}=f(ax+by+c)` 。

令 :math:`u=ax+by+c` ，则 :math:`\frac{\mathrm{d} u}{\mathrm{d} x}=a+b\frac{\mathrm{d} y}{\mathrm{d} x}` ，代入原方程即可。

若 :math:`\exists u_{0}\in \mathbb{R}` 使得 :math:`a+bf(u_{0})=0` ,则 :math:`ax+by+c=u_{0}` 也为原方程的解。


- **齐次型一阶常微分方程** ：
  
一般形式为： :math:`\frac{\mathrm{d} y}{\mathrm{d} x}=f(ax+by+c)` 。

令 :math:`u=ax+by+c` ，则 :math:`\frac{\mathrm{d} u}{\mathrm{d} x}=a+b\frac{\mathrm{d} y}{\mathrm{d} x}` ，代入原方程即可。

若 :math:`\exists u_{0}\in \mathbb{R}` 使得 :math:`F(u_{0})=0` ，则 :math:`y=u_{0}x` 也为原方程的解。

实际上还有其他类型的齐次，如 :math:`\frac{x}{y},xy` 。


- **线性组合分式型** ：
  
一般形式为 :math:`\frac{\mathrm{d} y}{\mathrm{d} x}=f(\frac{a_{1}x+b_{1}y+c_{1}}{a_{2}x+b_{2}y+c_{2}})` 。

先求出直线 :math:`a_{1}x+b_{1}y+c_{1}=0` 和直线 :math:`a_{2}x+b_{2}y+c_{2}` 的交点 :math:`(x_{0},y_{0})` ,令 :math:`X=x-x_{0},Y=y-y_{0}` 可以得到 :math:`\frac{\mathrm{d} Y}{\mathrm{d} X}=F(\frac{Y}{X})` 。


- **伯努利方程** ：
  
一般形式为 :math:`\frac{\mathrm{d} y}{\mathrm{d} x}+P(x)y=Q(x)y^{a}` 。

将 :math:`y^{a}` 除到方程的左边，令 :math:`z=y^{1-a}` ，则 :math:`\frac{\mathrm{d} z}{\mathrm{d} x}=(1-a)y^{-a}\frac{\mathrm{d} y}{\mathrm{d} x}` ，代入原方程即可。




可降阶的高阶常微分方程
^^^^^^^^^^^^^^^^^^^^^^

- **不显含y的方程**
  
一般形式为 :math:`y^{(n)}=F(x,y^{(k)},\dots ,y^{(n-1)})` 。

令  :math:`p(x)=y^{(k)}` , 则  :math:`p^{(n-k)}=F\left(x, p, p^{\prime}, \ldots, p^{(n-k-1)}\right)` , 由此解出  :math:`p=p(x)` , 再对  :math:`y^{(k)}=p(x)`  求  :math:`k`  次原函数。


- **不显含x的二阶方程**
  
一般形式为 :math:`F(y,\frac{\mathrm{d} y}{\mathrm{d} x},\frac{d^{2} y}{d x^{2}})=0` 。

将  :math:`y`  看成自变量, 并令  :math:`p=\frac{d y}{d x}` , 则  :math:`\frac{d^{2} y}{d x^{2}}=\frac{d p}{d x}=\frac{d p d y}{d y d x}=p_{d y}^{d p}` , 可由  :math:`F\left(y, p, p \frac{d p}{d y}\right)=0`  求  :math:`p=p(y)` , 再用分离变量法解  :math:`\frac{d y}{d x}=p(y)` 。






常系数高阶线性微分方程
----------------------

二阶线性常系数齐次方程
^^^^^^^^^^^^^^^^^^^^^^

二阶线性常系数齐次方程的形式为 :math:`y''+Ay'+By=0` ，其特征方程为 :math:`\lambda ^{2}+A\lambda +B=0` ，可以从中解出特征根 :math:`\lambda _{1},\lambda _{2}` 。

如果特征方程的 :math:`\Delta >0` ，则通解为 :math:`y=C_{1}e^{\lambda_{1}x}+C_{2}e^{\lambda_{2}x}` ；

如果特征方程的 :math:`\Delta =0` ，则通解为 :math:`y=C_{1}e^{\lambda x}+C_{2}xe^{\lambda x}` ；

如果特征方程的 :math:`\Delta <0` ，则有两个共轭复特征根 :math:`\lambda=\alpha \pm i\beta` ，方程的通解为 :math:`y=e^{\alpha x}(C_{1}\cos\beta x+C_{2}\sin\beta x)` 。


二阶线性常系数非齐次方程
^^^^^^^^^^^^^^^^^^^^^^^^

特别地，对于 :math:`y''+2\alpha y' + \omega^{2}y=K` ，其通解形式为

.. math::
	\begin{align}
	y & = C_{1} e^{t \left(- \alpha + \sqrt{\alpha^{2} - \omega^{2}}\right)} + C_{2} e^{- t \left(\alpha + \sqrt{\alpha^{2} - \omega^{2}}\right)} + \frac{K}{\omega^{2}}
	\end{align}



对于  :math:`f(x)=Ce^{kx}`  的情况，将所有的  :math:`D`  全部换为  :math:`k` ；若分母变成零，则对分母求导，并在式子前面添一个  :math:`x`  。


对于  :math:`f(x)=\sin ax`  或  :math:`f(x)=\cos ax`  的情况，将  :math:`D^{2}`  换成  :math:`-a^{2}`  ；若分母变成零，则对分母求导，并在式子前面添一个  :math:`x`  ，且  :math:`\frac{1}{D}`  表示积分；如果分母只含有  :math:`D`  与常数，则利用平方差公式。


对于  :math:`f(x)=P_{n}(x)`  的情况，根据  :math:`\frac{1}{1-D}`  的泰勒展开进行，展开次数由  :math:`P_{n}(x)`  的最高次确定。

对于  :math:`f(x)=e^{kx}g(x)`  的情况，其中  :math:`g(x)`  可以是多项式、 :math:`\sin ax`  或  :math:`\cos ax`  ，则特解满足形式

.. math::
	\begin{align*}
	    y^{*}=\frac{1}{F(D)}e^{kx}g(x)=e^{kx}\frac{1}{F(D+k)}g(x)
	\end{align*}


对于  :math:`f(x)=P_{n}\sin ax`  或  :math:`f(x)=P_{n}(x)\cos ax`  的情况，利用欧拉公式将三角函数写成指数形式，再根据  :math:`f(x)=e^{kx}g(x)`  的情况来进行，最后根据需要取实部或虚部。

特别地，对于 :math:`f(x)=x\sin ax`  或  :math:`f(x)=x\cos ax`  的情况，特解满足形式

.. math::
	\begin{align*}
	    y^{*}=(x-\frac{F'(D)}{F(D)} )\frac{1}{F(D)} \sin ax ~(\text{或}\cos ax )
	\end{align*}





欧拉方程
--------

欧拉方程的一般形式为： :math:`x^{n} y^{(n)}+a_{n-1} x^{n-1} y^{(n-1)}+\cdots+a_{1} x y^{\prime}+a_{0} y=0` , 其中  :math:`a_{0}, a_{1}, \ldots, a_{n-1}`  为常数

作变量替换  :math:`t=\ln |x|`  来将方程化为以  :math:`t`  为自变量、以  :math:`y`  为待定函数的常系数方程。在替换自变量后有如下关系：

.. math::
	\begin{align*}
	    \frac{\mathrm{d} y}{\mathrm{~d} x} &=\frac{1}{x} \frac{\mathrm{d} y}{\mathrm{~d} t} \\
	    \frac{\mathrm{d}^{2} y}{\mathrm{~d} x^{2}} &=\frac{1}{x^{2}} \frac{\mathrm{d}^{2} y}{\mathrm{~d} t^{2}}-\frac{1}{x^{2}} \frac{\mathrm{d} y}{\mathrm{~d} t} \\
	    \frac{\mathrm{d}^{3} y}{\mathrm{~d} x^{3}} &=\frac{1}{x^{3}} \frac{\mathrm{d}^{3} y}{\mathrm{~d} t^{2}}-\frac{3}{x^{3}} \frac{\mathrm{d}^{2} y}{\mathrm{~d} t^{2}}+\frac{2}{x^{3}} \frac{\mathrm{~d} y}{\mathrm{~d} x}
	\end{align*}





多元函数及其微分学
==================


二重极限与累次极限
------------------

计算多变量函数的极限目前唯一有效方法是将其转化为单变量函数极限。接下来考虑二重极限： :math:`\lim\limits_{(x,y)	o(x_{0},y_{0})}f(x,y)`  与  :math:`\lim \limits_{\substack{x \rightarrow x_{0} \\ y \rightarrow y_{0}}} f(x, y)`  .两种极限表达不同的趋近方式：


定义 : 二重极限
    若  :math:`\forall>0,\exists\delta>0`  使得  :math:`0<\sqrt{(x-x_{0})^{2}+(y-y_{0})^{2}}<\delta`  时，均有  :math:`|f(x,y)-A|<\varepsilon`  ，则称为

.. math::
	\begin{align}
	\lim\limits_{(x,y)\to(x_{0},y_{0})}f(x,y)
	\end{align}

若  :math:`\forall>0,\exists\delta>0`  使得  :math:`0<|x-x_{0}|<\delta,~0<|y-y_{0}|<\delta`  时，均有  :math:`|f(x,y)-A|<\varepsilon`  ，则称为

.. math::
	\begin{align}
	\lim _{\substack{x \rightarrow x_{0} \\ y \rightarrow y_{0}}} f(x, y)
	\end{align}



在计算二重极限时，有多种处理方式：

- 将原式放缩成简单的式子，根据夹逼原理得到结果。常用的不等式有  :math:`x^{2}+y^{2}\geqslant 2xy`  ,  :math:`x+y\leqslant |x|+|y|\leqslant \sqrt{2(x^{2}+y^{2})}` ,  :math:`\frac{(|x|+|y|)^{2}}{2}\leqslant x^{2}+y^{2}`  ,  :math:`|x|^{3}+|y|^{3}\leqslant (x^{2}+y^{2})(|x|+|y|)`  以及  :math:`e^{x}`  的单调性。
- 对数化处理复杂指数，利用等价无穷小化简成容易得到结果的式子。
- 通过选取特殊路径，证明二重极限不存在。


定义 : 累次极限
    对于累次极限

.. math::
	\begin{align}
	\lim\limits_{x\to x_{0}} \lim\limits_{y\to y_{0}}f(x,y)
	\end{align}

先对  :math:`x\ne x_{0}`  计算

.. math::
	\begin{align}
	\varphi(x)=\lim_{y\to y_{0}}f(x,y)
	\end{align}

随后再求  :math:`\lim\limits_{x\to x_{0}}\varphi(x)` 。



假设  :math:`\lim\limits_{(x,y)	o (x_{0},y_{0})}f(x,y)=A`  且在  :math:`x_{0}`  的某去心邻域  :math:`U`  内  :math:`\lim\limits_{y	o y_{0}}f(x,y)=\varphi(x)`  收敛，则

.. math::
	\begin{align}
	A=\lim_{x\to x_{0}}\varphi(x)=\lim_{x \to x_{0}}\lim_{y\to y_{0}}f(x,y)
	\end{align}

据此可以得到两个推论：

- 若二重极限与某一个累次极限均存在，则二者必然相等；
- 若累次极限存在但不相等，则二重极限不存在。
  


多元函数的连续性
----------------

定义 : 向量值函数的连续性
    :math:`\Vec{f}`  在点  :math:`X_{0}`  连续，当且仅当  :math:`\forall \varepsilon >0, \exists \delta >0`  使得  :math:`\forall X \in \Omega`  ，当  :math:`\left \| X-X_{0} \right \| _{n}<\delta`  时，均有

.. math::
	\begin{align}
	\left \| \vec{f}(X)-\vec{f}(X_{0})\right \|_{m}<\varepsilon
	\end{align}

定义  :math:`\mathscr{C}(\Omega;\mathbb{R}^{m} )=\left \{ \vec{f}~|~ \vec{f}:\Omega \to \mathbb{R}^{m} \text{为连续}\right\}` 。当 :math:`m=1` 时，简记为  :math:`\mathscr{C}(\Omega)` 。


设   :math:`\Omega \subset \mathbb{R}^{n}`   为开集, 而 :math:`\vec{f}: \Omega \rightarrow \mathbb{R}^{m}` 为向量值函数. 则 :math:`\vec{f}`   连续当且仅当对   :math:`\mathbb{R}^{m}` 中任意开集 :math:`G`  , 原像集 :math:`\vec{f}^{-1}(G)=\{X \in \Omega \mid \vec{f}(X) \in G\}` 均为开集。

设   :math:`\Omega \subset \mathbb{R}^{n}` 为开集, 而 :math:`\vec{f}: \Omega \rightarrow \mathbb{R}^{m}` 为向量值函数. 则   :math:`\vec{f}`   连续当且仅当对   :math:`\mathbb{R}^{m}` 中任意闭集 :math:`F` ，原像集 :math:`\vec{f}^{-1}(F)=\{X \in \Omega \mid \vec{f}(X) \in F\}` 为 :math:`\Omega` 中的闭集. 这里将 :math:`\Omega` 当作整个空间。



定理 : 最值定理
    假设 :math:`\Omega \subseteq \mathbb{R}^{n}` 为有界闭集，而 :math:`f \in \mathscr{C}(\Omega)`  , 则 :math:`f` 在 :math:`\Omega` 上有最大值和最小值。


最值定理的两个推论应用是：

- 若  :math:`X_{0}\in \mathbb{R}^{n},\Omega \subseteq \mathbb{R}^{n}`  为闭集，则  :math:`\exists Y_{0}\in \Omega `  使得  :math:`\left \| X_{0}-Y_{0} \right \| =\inf \limits _{Y\in \Omega }\left \| X_{0}-Y \right \|` 。
-  设  :math:`\Omega_{1},\Omega_{2} \subseteq \mathbb{R}^{n}`  .若  :math:`\Omega_{1}`  为有界闭集而  :math:`\Omega_{2}`  为闭集，则存在  :math:`X_{0}\in \Omega_{1},Y_{0}\in \Omega_{2}`  使得  :math:`\inf \limits _{X\in \Omega _{1},Y\in \Omega_{2} }\left \| X-Y \right \| =\left \| X_{0}-Y_{0} \right \|` 。
   


定义 : 弧连通
    如果 :math:`\forall X, Y \in D`  , 均存在   :math:`D` 中的连续曲线将   :math:`X, Y`   连接起来, 即存在向量值连续函数 :math:`\gamma:[0,1] \rightarrow D`   使得我们有 :math:`\gamma(0)=X, \gamma(1)=Y` ，则称集合 :math:`D \subseteq \mathbb{R}^{n}` 为弧连通。

若 :math:`\vec{f} \in \mathscr{C}\left(\Omega ; \mathbb{R}^{m}\right)` 而 :math:`\Omega \subseteq \mathbb{R}^{n}` 为弧连通, 则 :math:`\vec{f}(\Omega)` 为弧连通集。


定理 : 多元函数的介值定理
    假设 :math:`\Omega \subseteq \mathbb{R}^{n}` 为弧连通集，而 :math:`f \in \mathscr{C}(\Omega)`  , 则 :math:`\forall X_{1}, X_{2} \in \Omega` 以及介于 :math:`f\left(X_{1}\right)`  ， :math:`f\left(X_{2}\right)` 之间的实数 :math:`\mu, \exists X_{0} \in \Omega` 使得 :math:`f\left(X_{0}\right)=\mu` 。




定义 : 无穷小多元函数的阶
    设  :math:`n\geqslant 1`  为整数，  :math:`\Omega \subseteq \mathbb{R}^{n}`  ，而  :math:`X_{0}\in \mathbb{R}^{n}`  为  :math:`\Omega`  的极限点，  :math:`f:\Omega \to \mathbb{R}`  为函数。

- 若 :math:`\lim\limits_{X\to X_{0}}f(X)=0`  ,称  :math:`f`  在 :math:`\Omega \ni X\to X_{0}` 时为无穷小函数，记作
  
.. math::
	\begin{align}
	f(X)=0(1)~(\Omega \ni X\to X_{0})
	\end{align}

- 设 :math:`g: \Omega \rightarrow \mathbb{R}` 为函数. 若存在 :math:`\beta>0, \delta>0` 使 :math:`\forall X \in \Omega \cap \stackrel{\circ}{B}\left(X_{0}, \delta\right),|f(X)| \leqslant \beta|g(X)|` ，则记

.. math::
	\begin{align}
	f(X)=O(g(X))\left(\Omega \ni X \rightarrow X_{0}\right)
	\end{align}

若还有 :math:`g(X)=O(f(X))` ，则称 :math:`f, g` 为同阶。

- 设 :math:`k \geqslant 0` 。若 :math:`\lim \limits_{\Omega \ni X \rightarrow X_{0}} \frac{f(X)}{\left\|X-X_{0}\right\|^{k}}=0` ，则称 :math:`f` 在 :math:`\Omega \ni X \rightarrow X_{0}$ 时为 $\left\|X-X_{0}\right\|^{k}` 的高阶的无穷小, 记作

.. math::
	\begin{align}
	f(X)=o\left(\left\|X-X_{0}\right\|^{k}\right)\left(\Omega \ni X \rightarrow X_{0}\right) 
	\end{align}

- 若 :math:`\lim \limits_{\Omega \ni X \rightarrow X_{0}} \frac{f(X)}{\left\|X-X_{0}\right\|^{k}}=c \neq 0` ，则我们称 :math:`f` 在 :math:`\Omega \ni X \rightarrow X_{0}` 时为 :math:`\left\|X-X_{0}\right\|` 的 :math:`k` 阶的无穷小, 此时 :math:`f` 局部常号. 若 :math:`k=0` ，则 :math:`\lim \limits_{\Omega \ni X \rightarrow X_{0}} f(X)=c` 。
  



n元函数的全微分与偏导数
-----------------------


定义 : 偏导数
    设 :math:`X_{0}=\left(x_{1}^{(0)}, \ldots, x_{n}^{(0)}\right) \in \mathbb{R}^{n}` 而函数 :math:`f` 定义在点 :math:`X_{0}` 的某邻域上. 固定 :math:`1 \leqslant j \leqslant n` 。若存在

.. math::
	\begin{align}
	\frac{\partial f}{\partial x_{j}}\left(X_{0}\right):=\lim _{h \rightarrow 0} \frac{f\left(x_{1}^{(0)}, \ldots, x_{j-1}^{(0)}, x_{j}^{(0)}+h, x_{j+1}^{(0)}, \ldots, x_{n}^{(0)}\right)-f\left(X_{0}\right)}{h}
	\end{align}

则称函数 :math:`f` 在点 :math:`X_{0}` 处关于第 :math:`j` 个变量 有偏导数 :math:`\frac{\partial f}{\partial x_{j}}\left(X_{0}\right)` ，通常也会将之记作 :math:`\partial_{j} f\left(X_{0}\right)` 或 :math:`f_{x_{j}}^{\prime}\left(X_{0}\right)` 。

若对于 :math:`1 \leqslant j \leqslant n` ，偏导数 :math:`\frac{\partial f}{\partial x_{j}}\left(X_{0}\right)` 均存在, 则称函数 :math:`f` 在点 :math:`X_{0}` 处可导。

如果用向量函数来表示则为：设 :math:`\vec{e}_{1}, \ldots, \vec{e}_{n}$ 为 $\mathbb{R}^{n}` 的自然基底, 那么 

.. math::
	\begin{align}
	\frac{\partial f}{\partial x_{j}}\left(X_{0}\right):=\lim _{h \rightarrow 0} \frac{f\left(X_{0}+h \vec{e}_{j}\right)-f\left(X_{0}\right)}{h}
	\end{align}

令 :math:`F(h)=f\left(X_{0}+h \vec{e}_{j}\right)` 。则 :math:`\frac{\partial f}{\partial x_{j}}\left(X_{0}\right)=F^{\prime}(0)` 。

.. note:: 当 :math:`n\geqslant 2` 时， :math:`n` 元函数 :math:`f` 在点 :math:`X_{0}` 可导并不意味着它在该点连续，更不意味着该点可微。


若 :math:`f` 在点 :math:`X_{0}` 处可微，则它可导且

.. math::
	\begin{align}
	\mathrm{d} f\left(X_{0}\right)=\sum_{j=1}^{n} \frac{\partial f}{\partial x_{j}}\left(X_{0}\right) \mathrm{d} x_{j}
	\end{align}





判断函数 :math:`f` 在点 :math:`(x_{0},y_{0})` 是否可微的步骤：

1. 判断 :math:`f` 在该点的连续性；
2. 判断 :math:`\frac{\partial f}{\partial x}(x_{0},y_{0}),\frac{\partial f}{\partial y}(x_{0},y_{0})` 的存在性；
3. 若在该点可导，估计当 :math:`(x,y) \to (x_{0},y_{0})` 时
   
.. math::
	\begin{align}
	f(x,y)-f(x_{0},y_{0})-\frac{\partial f}{\partial x}(x_{0},y_{0})(x-x_{0})-\frac{\partial f}{\partial y}(x_{0},y_{0})(y-y_{0})
	\end{align}

的阶数。若为 :math:`o(\left \| (x-x_{0},y-y_{0}) \right \| )` ，则可微。


.. note:: 

	特别地，对于二元函数在原点处的微分，第三步的表达式可以表示成

	.. math::
		\begin{align*}
		    f(x,y)-f(0,0)-\frac{\partial f}{\partial x}\left ( 0,0 \right ) x-\frac{\partial f}{\partial y}\left ( 0,0 \right ) y=o(\sqrt{x^{2}+y^{2}})
		\end{align*}



定理 : 
    若 :math:`\Omega \subseteq \mathbb{R}^{n}` 为开集，而函数 :math:`f:\Omega \to \mathbb{R}` 在点 :math:`X_{0}\in \Omega` 处连续可导，则 :math:`f` 在该点可微。

.. note:: 可以推出，初等函数在其定义区域的内部可微。






方向导数与数量场的梯度
----------------------

定义 : 方向导数
    设  :math:`\Omega \subseteq \mathbb{R}^{n}`  为开集,  :math:`X_{0} \in \Omega, f: \Omega \rightarrow \mathbb{R}` 为函数,  :math:`\vec{\ell}` 为非零向量,  :math:`\overrightarrow{\ell^{0}}=\left(\cos \alpha_{1}, \ldots, \cos \alpha_{n}\right)^{T}` 为其单位向量, 其中 :math:`\alpha_{j}` 为 :math:`\vec{\ell}` 与 :math:`x_{j}` 轴的夹角。若极限

.. math::
	\begin{align}
	\lim _{h \rightarrow 0^{+}} \frac{f\left(X_{0}+h \ell^{0}\right)-f\left(X_{0}\right)}{h}
	\end{align}

存在, 则称之为 :math:`f` 在点 :math:`X_{0}` 处沿 :math:`\vec{\ell}` 方向的方向导数, 记作 :math:`\frac{\partial f}{\partial \vec{\ell}}\left(X_{0}\right)` ,
或 :math:`\left.\frac{\partial f}{\partial \vec{\ell}}\right|_{X_{0}}` , 或  :math:`f_{\vec{\ell}}^{\prime}\left(X_{0}\right)` 。于是 :math:`\frac{\partial f}{\partial \vec{\ell}}\left(X_{0}\right)=\frac{\partial f}{\partial \vec{\ell}}\left(X_{0}\right)` 。



定理 : 
    若 :math:`f` 在点 :math:`X_{0}` 可微，则 :math:`\frac{\partial f}{\partial \vec{\ell}}` 存在且

.. math::
	\begin{align}
	\frac{\partial f}{\partial \vec{\ell} }(X_{0})
	=\sum \limits_{j=1}^{n}\frac{\partial f}{\partial x_{j}}(X_{0})\cos\alpha _{j}
	=\operatorname{grad}f(X_{0})\cdot \frac{\vec{\ell}}{\big\| \vec{\ell}  \big\| }
	\end{align}



定义 : 梯度
    设  :math:`\Omega \subseteq \mathbb{R}^{n}`  为开集, :math:`X_{0} \in \Omega, f: \Omega \rightarrow \mathbb{R}` 在点 :math:`X_{0}` 沿任意方向有方向导数. 称向量 :math:`\vec{e}` 为 :math:`f` 在点 :math:`X_{0}` 的梯度, 若 :math:`f` 在 :math:`X_{0}` 处沿 :math:`\vec{e}` 的方向 导数的值最大且该值等于 :math:`\|\vec{e}\|` , 此时将 :math:`\vec{e}` 记作 :math:`\operatorname{grad} f\left(X_{0}\right)` 或 :math:`\vec{\nabla} f\left(X_{0}\right)` , 也将之记作 :math:`\overrightarrow{\operatorname{grad}} f\left(X_{0}\right)` , 或 :math:`\operatorname{grad} f\left(X_{0}\right)` , 或 :math:`\nabla f\left(X_{0}\right)` 。

若 :math:`f` 在点 :math:`X_{0}` 处可微，则

.. math::
	\begin{align}
	\operatorname{grad} f\left(X_{0}\right)=
	\left(\begin{array}{c}
	\frac{\partial f}{\partial x_{1}}\left(X_{0}\right) \\
	\vdots \\
	\frac{\partial f}{\partial x_{n}}\left(X_{0}\right)
	\end{array}\right)
	\end{align}

可以得到推论： :math:`f` 在点 :math:`X_{0}` 沿梯度增长最快，反向最慢，于是方向导数与梯度的关系为

.. math::
	\begin{align}
	\frac{\partial f}{\partial \vec{\ell^{0}}}(X_{0})=\operatorname{grad}f(X_{0})\cdot \vec{\ell^{0}}
	\end{align}


计算方向导数的步骤如下：

1. 选取单位方向向量 :math:`(a,b)` ，对于任意方向的常用 :math:`(\cos \alpha,\sin \alpha)` ；
2. 引入参变量 :math:`t` ，则变量为 :math:`(ta,tb)` ；
3. 于是在 :math:`(x_{0},y_{0})` 处的方向导数为

.. math::
    \begin{align*}
        \frac{\partial f}{\partial \vec{\ell}_{0}}=\lim_{t\to 0^{+}}\frac{f(x_{0}+ta,y_{0}+tb)-f(x_{0},y_{0})}{t}
    \end{align*}

对于函数偏导数存在的、不分段的且容易求得的情况，更多考虑使用

.. math::
	\begin{align*}
	    \frac{\partial f}{\partial \vec{\ell}^{0}}=\operatorname{grad}f(X_{0})\cdot \vec{\ell}^{0}
	\end{align*}


.. note:: 

	- 由于方向导数式单侧极限，所以其不一定就是通过双侧极限得到的偏导数。
	- 函数 :math:`f` 在 :math:`X_{0}` 处沿任意的方向均有方向导数并不意味着 :math:`f` 在该点可导或可微。





高阶偏导数
----------

定义 : 
    设 :math:`\Omega \subset \mathbb{R}^{n}` 为非空开集. 若 :math:`f: \Omega \rightarrow \mathbb{R}` 在 :math:`\Omega` 上可导, 则我们可以在 :math:`\Omega` 上定义 :math:`n` 个偏导 函数 :math:`\frac{\partial f}{\partial x_{i}}(1 \leqslant i \leqslant n)` 。如果 :math:`\frac{\partial f}{\partial x_{i}}` 关于第 :math:`j` 个变量 有偏导数 :math:`\frac{\partial}{\partial x_{j}}\left(\frac{\partial f}{\partial x_{i}}\right)` ，我们将之称为二阶偏导数, 记作 :math:`\frac{\partial^{2} f}{\partial x_{j} \partial x_{i}}` 或者 :math:`\partial_{j i} f` 。特别地, 当 :math:`i=j` 时, 我们 将之记作 :math:`\frac{\partial^{2} f}{\partial x_{i}^{2}}` 。如此递归下去, 我们可定义三阶偏导数以及任意阶的偏导数。


一般情况下，求二阶偏导时不能交换求导次序，只有满足下面条件时才能交换次序：

定理 : 
    设 :math:`\Omega \subset \mathbb{R}^{n}` 为非空开集. 若 :math:`f: \Omega \rightarrow \mathbb{R}` 在 :math:`\Omega` 上有二阶偏导函数 :math:`\frac{\partial^{2} f}{\partial x_{j} \partial x_{i}}, \frac{\partial^{2} f}{\partial x_{i} \partial x_{j}}(i \neq j)` ，并且它们当中的一个在点 :math:`X_{0} \in \Omega` 处连续, 则

.. math::
	\begin{align}
	\frac{\partial^{2} f}{\partial x_{j} \partial x_{i}}\left(X_{0}\right)=\frac{\partial^{2} f}{\partial x_{i} \partial x_{j}}\left(X_{0}\right)
	\end{align}



定理 : 
    设 :math:`z(x,y)` 定义在矩形区域 :math:`D=\left \{ \left.(x,y) ~\right |~ 0\leqslant x\leqslant a,~0\leqslant y\leqslant b \right \}` 上的 :math:`\mathscr{C}^{(1)}` 函数，有

.. math::
	\begin{align*}
	z(x,y)=f(y) &\Longleftrightarrow \forall  (x,y)\in D,~\frac{\partial z}{\partial x}=0 \\
	z(x,y)=f(x)+g(y) &\Longleftrightarrow \forall (x,y)\in D,~\frac{\partial z}{\partial x}{y}=0 
	\end{align*}




向量值函数的微分
----------------

定义 : 
    设 :math:`X_{0}=\left(x_{1}^{(0)}, \ldots, x_{n}^{(0)}\right) \in \mathbb{R}^{n}, r>0` ，而 :math:`\vec{f}: B\left(X_{0}, r\right) \subset \mathbb{R}^{n} \rightarrow \mathbb{R}^{m}, g: B\left(X_{0}, r\right) \rightarrow \mathbb{R}` 为 映射. 若 :math:`\lim _{X \rightarrow X_{0}} \frac{\|\vec{f}(X)\|}{|g(X)|}=0` ，则记

.. math::
	\begin{align}
	\vec{f}(X)=\vec{o}(|g(X)|)=|g(X)| \vec{o}(1)\left(X \rightarrow X_{0}\right)
	\end{align}

如果记 :math:`\vec{f}=\left(f_{1}, \ldots, f_{m}\right)^{T}` ，则上式成立当且仅当 对任意的整数 :math:`1 \leqslant i \leqslant m` ，我们均有

.. math::
	\begin{align}
	f_{i}(X)=o(|g(X)|)\left(X \rightarrow X_{0}\right)
	\end{align}


定义 : Jacobi矩阵
    假设 :math:`X_{0}=\left(x_{1}^{(0)}, \ldots, x_{n}^{(0)}\right) \in \mathbb{R}^{n}, r>0` ， :math:`\vec{f}: B\left(X_{0}, r\right) \subset \mathbb{R}^{n} \rightarrow \mathbb{R}^{m}` 为向量值函数. 如果 存在线性映射 :math:`A: \mathbb{R}^{n} \rightarrow \mathbb{R}^{m}` 使得 :math:`X \rightarrow X_{0}` 时，

.. math::
	\begin{align}
	\vec{f}(X)-\vec{f}\left(X_{0}\right)=A\left(X-X_{0}\right)+\vec{o}\left(\left\|X-X_{0}\right\|\right)
	\end{align} 

则称 :math:`\vec{f}` 在点 :math:`X_{0}` 可微并将映射 :math:`A` 记作 :math:`\mathrm{d} \vec{f}\left(X_{0}\right)` , 称为 :math:`\vec{f}` 在点 :math:`X_{0}` 的全微分或微分. 线性映射 :math:`A` 所对应的矩阵记作 :math:`J \vec{f}\left(X_{0}\right)` ，也被记作 :math:`J_{\vec{f}}\left(X_{0}\right)` ， 称为 :math:`\vec{f}` 在点 :math:`X_{0}` 处的 Jacobi 矩阵。


实际上，Jacobi矩阵与微分元进行矩阵相乘即为向量值函数的微分，记作 :math:`\mathrm{d}\vec{f}(X_{0})=J_{\vec{f}}(X_{0})\mathrm{d}X=\frac{\partial (f_{1},\dots,f_{m})}{\partial (x_{1},\dots,x_{n})}(X_{0})\mathrm{d}X` ，即

.. math::
	\begin{align}
	\mathrm{d} \vec{f}\left(X_{0}\right)=
	\left(\begin{array}{ccc}
	\frac{\partial f_{1}}{\partial x_{1}}\left(X_{0}\right) & \cdots & \frac{\partial f_{1}}{\partial x_{n}}\left(X_{0}\right) \\
	\vdots & \cdots & \vdots \\
	\frac{\partial f_{m}}{\partial x_{1}}\left(X_{0}\right) & \cdots & \frac{\partial f_{m}}{\partial x_{n}}\left(X_{0}\right)
	\end{array}\right)
	\left(\begin{array}{c}
	\mathrm{d} x_{1} \\
	\vdots \\
	\mathrm{d} x_{n}
	\end{array}\right)
	\end{align}

当 :math:`m=n` 时，相应的行列式称为Jacobi行列式，记作 :math:`\frac{D(f_{1},\dots,f_{m})}{D(x_{1},\dots,x_{n})}(X_{0})` 。




可微复合向量值函数的微分
^^^^^^^^^^^^^^^^^^^^^^^^


定理 : 
    假设 :math:`\Omega_{1} \subseteq \mathbb{R}^{n}, \Omega_{2} \subseteq \mathbb{R}^{m}` 均为非空开集， :math:`X_{0} \in \Omega_{1}` ，而映射 :math:`\vec{g}: \Omega_{1} \rightarrow \Omega_{2}` 在点 :math:`X_{0}` 处可微， :math:`\vec{f}: \Omega_{2} \rightarrow \mathbb{R}^{k}` 在点 :math:`Y_{0}=\vec{g}\left(X_{0}\right)` 处可微，则 :math:`\vec{f} \circ \vec{g}` 在点 :math:`X_{0}` 处可微，并且

.. math::
	\begin{align}
	\mathrm{d}(\vec{f} \circ \vec{g})\left(X_{0}\right)=\mathrm{d} \vec{f}\left(Y_{0}\right) \circ \mathrm{d} \vec{g}\left(X_{0}\right)
	\end{align}

于是对任意整数 :math:`1\leqslant i\leqslant n` ，我们有

.. math::
	\begin{align*}
	\frac{\partial f\circ \vec{g} }{\partial x_{i}}(X_{0}) & = \sum\limits_{j=1}^{m}\frac{\partial f}{\partial y_{i}(\vec{g}(X_{0})} \frac{\partial g_{j}}{\partial x_{i}}(X_{0}) \\
	& =\frac{\partial f}{\partial y_{1}}\frac{\partial g_{1}}{\partial x_{i}}+\frac{\partial f}{\partial y_{2}}\frac{\partial g_{2}}{\partial x_{i}}+\cdots \frac{\partial f}{\partial y_{m}}\frac{\partial g_{m}}{\partial x_{i}}
	\end{align*}



隐函数的存在性及其微分
^^^^^^^^^^^^^^^^^^^^^^


定理 : 隐函数定理(两个变量的方程)
    设函数 :math:`F(x,y)` 为 :math:`\mathscr{C}^{(1)}` 类使得

.. math::
	\begin{align*}
	    F(x_{0},y_{0})=0~,~\frac{\partial F}{\partial y}(x_{0},y_{0})\ne 0
	\end{align*}

则方程 :math:`F(x,y)=0` 在局部上有 :math:`\mathscr{C}^{(1)}` 类的解 :math:`y=f(x)` ，并且

.. math::
	\begin{align*}
	    f'(x)=-\frac{\frac{\partial F}{\partial x}\left ( x,f(x) \right ) }{\frac{\partial F}{\partial y} \left ( x,f(x) \right )}.
	\end{align*}


定理 : 隐函数定理(多个变量的方程)
    假设函数 :math:`F(x_{1},x_{2},\dots ,x_{n},y)` 为 :math:`\mathscr{C}^{(1)}` 类使得

.. math::
	\begin{align*}
	    F(X_{0},y_{0})=0~,~\frac{\partial F}{\partial y} (X_{0},y_{0})\ne 0
	\end{align*}

则方程 :math:`F(x_{1},x_{2},\dots ,x_{n},y)=0` 局部上有 :math:`\mathscr{C}^{(1)}` 类解 :math:`y=f(x_{1},x_{2},\dots ,x_{n})` ，且

.. math::
	\begin{align*}
	    \frac{\partial f}{\partial x_{i}}(X)=-\frac{\frac{\partial F}{\partial x_{i}} \left ( X,f(X) \right ) }{\frac{\partial F}{\partial y}\left ( X,f(X) \right ) } 
	\end{align*}




定理 : 隐函数定理(多个变量的方程组)
    假设 :math:`F_{i}(x_{1},\dots,x_{n},y_{1},\dots ,y_{m})~(1\leqslant i\leqslant m)` 为 :math:`\mathscr{C}^{(1)}` 类使得

.. math::
	\begin{align*}
	    F_{i}(X_{0},Y_{0})=0 ~(1\leqslant i\leqslant m),~\frac{D(F_{1},\dots ,F_{m})}{D(y_{1},\dots ,y_{m})}\left ( X_{0},Y_{0} \right )  \ne 0
	\end{align*}

则方程组 :math:`F_{i}(x_{1},\dots,x_{n},y_{1},\dots ,y_{m})~(1\leqslant i\leqslant m)=0 ~(1\leqslant i\leqslant m)` 在局部上有 :math:`\mathscr{C}^{(1)}` 类解 :math:`y_{i}=f_{i}(x_{1},x_{2},\dots ,x_{n})~(1\leqslant i\leqslant m )` ，满足

.. math::
	\begin{align*}
	    J_{\vec{f}}(X)=-\left ( \frac{\partial (F_{1},\dots,F_{m})}{\partial (y_{1},\dots ,y_{m})}\left ( X,\vec{f}(X)  \right )  \right )^{-1}\cdot \frac{\partial (F_{1},\dots ,F_{m})}{\partial (x_{1},\dots,x_{n})} \left ( X,\vec{f}(X)\right )
	\end{align*}




反函数的存在及其微分
^^^^^^^^^^^^^^^^^^^^


定理 : 反函数定理
    假设 :math:`X=\vec{g}(Y)` 为 :math:`\mathscr{C}^{(1)}` 类使得 :math:`X_{0}=\vec{g}(Y_{0})` 且 :math:`J_{\vec{g}}(Y_{0})` 可逆，则局部上存在 :math:`\mathscr{C}^{(1)}` 反函数 :math:`Y=\vec{f}(X)` ，并且 :math:`J_{\vec{f}}(X)=\left( J_{\vec{g}}(\vec{f}(X)\right)^{-1}` ，即

.. math::
	\begin{align*}
	    \frac{\partial (f_{1},f_{2},\dots ,f_{n})}{\partial (x_{1},x_{2},\dots ,x_{n})}(X)=\left ( \frac{\partial (g_{1},g_{2},\dots ,g_{n})}{\partial (y_{1},y_{2},\dots ,y_{n})} \left ( \vec{f}(X)\right)\right )^{-1}
	\end{align*}

.. note:: 简单来说，这个定理就是用来将 :math:`\frac{\partial x}{\partial u},\frac{\partial y}{\partial u},\frac{\partial x}{\partial v},\frac{\partial y}{\partial v}` 转化为 :math:`\frac{\partial u}{\partial x},\frac{\partial u}{\partial y},\frac{\partial v}{\partial x},\frac{\partial v}{\partial y}` 的定理，而转化的方式就是通过Jacobi矩阵的逆矩阵。





曲面与曲线、切平面与法线的表示法
-----------------------------------

三维空间中的直线与平面
^^^^^^^^^^^^^^^^^^^^^^


取 :math:`P_{0}(x_{0},y_{0},z_{0})\in \mathbb{R}^{3}` 。设法向量 :math:`\vec{e}=(a,b,c)^{T} \in \mathbb{R}^{3}` 为非零向量。过 :math:`P_{0}` 沿法向量方向 :math:`\vec{e}` 的法线 :math:`\Gamma` 的方程为

.. math::
	\begin{align*}
	\left \{  \begin{array}{lll}
	x=x_{0}+at \\
	y=y_{0}+bt \\
	z=z_{0}+ct
	\end{array} \right .
	\end{align*}

该直线也可以表示成

.. math::
	\begin{align*}
	    \frac{x-x_{0}}{a}=\frac{y-y_{0}}{b}=\frac{z-z_{0}}{c}   
	\end{align*}

:math:`\Gamma` 过 :math:`P_{0}` 的法平面方程为

.. math::
	\begin{align*}
	    a(x-x_{0})+b(y-y_{0})+c(z-z_{0})=0
	\end{align*}

设过点 :math:`P_{0}` 的平面 :math:`S` 的参数方程为

.. math::
	\begin{align*}
	\left \{ \begin{array}{lll}
	x=x_{0}+a_{1}u+b_{1}v \\
	y=y_{0}+a_{2}u+b_{2}v \\
	z=z_{0}+a_{3}u+b_{3}v
	\end{array}\right.
	\end{align*}

于是该平面的法向量为 :math:`\left ( \begin{vmatrix}a_{2} & b_{2} \\ a_{3} & b_{3}\end{vmatrix}, \begin{vmatrix}a_{3} & b_{3} \\ a_{1} & b_{1}\end{vmatrix} , \begin{vmatrix}a_{1}&b_{1}\\a_{2}&b_{2}\end{vmatrix} \right )^{T}` ，从而平面 :math:`S` 过点 :math:`P_{0}` 的法线方程为

.. math::
	\begin{align*}
	    \frac{x-x_{0}}{\begin{vmatrix}a_{2}&b_{2}\\a_{3}&b_{3}\end{vmatrix}}=\frac{y-y_{0}}{\begin{vmatrix}a_{3}&b_{3}\\a_{1}&b_{1}\end{vmatrix}} =\frac{z-z_{0}}{\begin{vmatrix}a_{1}&b_{1}\\a_{2}&b_{2}\end{vmatrix}}  
	\end{align*}




曲面及其切平面和法线
^^^^^^^^^^^^^^^^^^^^

对于曲面 :math:`S:~z=f(x,y)` ， :math:`f` 在点 :math:`(x_{0},y_{0})` 处可微，令 :math:`z_{0}=f(x_{0},y_{0})` ，则曲面 :math:`S` 在点 :math:`(x_{0},y_{0},z_{0})` 处的切平面方程为

.. math::
	\begin{align*}
	    z-z_{0}=\frac{\partial f}{\partial x}(x_{0},y_{0})(x-x_{0})+\frac{\partial f}{\partial y}(x_{0},y_{0})(y-y_{0})
	\end{align*}

于是该切平面的法向量为

.. math::
	\begin{align*}
	    \vec{n}=
	\begin{pmatrix}
	\frac{\partial f}{\partial x}(x_{0},y_{0}) \\
	\frac{\partial f}{\partial y}(x_{0},y_{0}) \\
	-1
	\end{pmatrix}
	\end{align*}

相应的法线方程为

.. math::
	\begin{align*}
	    \frac{x-x_{0}}{\frac{\partial f}{\partial x}(x_{0},y_{0})}=\frac{y-y_{0}}{\frac{\partial f}{\partial y}(x_{0},y_{0})} =\frac{z-z_{0}}{-1}  
	\end{align*}




考虑曲面 :math:`S:\left \{\begin{array}{lll}x=f_{1}(u,v) \\y=f_{2}(u,v) \\z=f_{3}(u,v)\end{array} \right. ~,(u,v)\in D \subset \mathbb{R}^{2}` 。设 :math:`(u_{0},v_{0})\in D` ， :math:`f_{1},f_{2},f_{3}` 在点 :math:`(u_{0},v_{0})` 可微，令

.. math::
	\begin{align*}
	\begin{pmatrix}
	x_{0} \\
	y_{0} \\
	z_{0}
	\end{pmatrix}=
	\begin{pmatrix}
	f_{1}(u_{0},v_{0}) \\
	f_{2}(u_{0},v_{0}) \\
	f_{3}(u_{0},v_{0})
	\end{pmatrix}
	\end{align*}

当矩阵 :math:`\frac{\partial (f_{1},f_{2},f_{3})}{\partial (u,v)}(u_{0},v_{0})` 的秩等于 :math:`2` 时，曲面 :math:`S` 在点 :math:`(x_{0},y_{0},z_{0})` 处有切平面：

.. math::
	\begin{align*}
	\begin{pmatrix}
	x-x_{0} \\
	y-y_{0} \\
	z-z_{0}
	\end{pmatrix}=
	\frac{\partial (f_{1},f_{2},f_{3})}{\partial (u,v)}(u_{0},v_{0})
	\binom{u-u_{0}}{v-v_{0}} 
	\end{align*}

或者表示成

.. math::
	\begin{align*}
	\frac{D(f_{2},f_{3})}{D(u,v)}(u_{0},v_{0}) (x-x_{0})+
	\frac{D(f_{3},f_{1})}{D(u,v)}(u_{0},v_{0}) (y-y_{0})+
	\frac{D(f_{1},f_{2})}{D(u,v)}(u_{0},v_{0}) (z-z_{0})=0
	\end{align*}

从而曲面 :math:`S` 在点 :math:`(x_{0},y_{0},z_{0})` 处的法线方程为

.. math::
	\begin{align*}
	\frac{x-x_{0}}{\frac{D(f_{2},f_{3})}{D(u,v)}(u_{0},v_{0})}
	=\frac{y-y_{0}}{\frac{D(f_{3},f_{1})}{D(u,v)}(u_{0},v_{0})}
	=\frac{z-z_{0}}{\frac{D(f_{1},f_{2})}{D(u,v)}(u_{0},v_{0}) }   
	\end{align*}





考虑 :math:`S:F(x,y,z)=0` ，设 :math:`P_{0}(x_{0},y_{0},z_{0})\in S` ，而 :math:`F` 在点 :math:`P_{0}` 处可微，则当 :math:`J_{F}(P_{0}) \ne \vec{o}` 时，曲面在点 :math:`P_{0}` 有切平面:

.. math::
	\begin{align*}
	\frac{\partial F}{\partial x}(P_{0})(x-x_{0})+
	\frac{\partial F}{\partial y}(P_{0})(y-y_{0})+
	\frac{\partial F}{\partial z}(P_{0})(z-z_{0})=0
	\end{align*}

于是曲面 :math:`S` 在点 :math:`P_{0}` 处的法向量为

.. math::
	\begin{align*}
	\vec{n}=
	\begin{pmatrix}
	 \frac{\partial F}{\partial x}(P_{0})\\
	 \frac{\partial F}{\partial y}(P_{0}) \\
	 \frac{\partial F}{\partial z}(P_{0})
	\end{pmatrix}=\operatorname{grad}F(P_{0})  
	\end{align*}

相应的法线方程为

.. math::
	\begin{align*}
	    \frac{x-x_{0}}{\frac{\partial F}{\partial x}(P_{0})}=\frac{y-y_{0}}{\frac{\partial F}{\partial y}(P_{0})}=\frac{z-z_{0}}{\frac{\partial F}{\partial z}(P_{0})}   
	\end{align*}




空间曲线及其切线和法平面
^^^^^^^^^^^^^^^^^^^^^^^^

对于曲线

.. math::
	\begin{align*}
	\Gamma :\left \{ \begin{array}{lll}
	x=x(t) \\
	y=y(t) \\
	z=z(t)
	\end{array}  \right. ,\quad t\in [\alpha ,\beta ]
	\end{align*}

若上述函数在点 :math:`t=t_{0}` 处可微，则称曲线 :math:`\Gamma` 在点 :math:`P_{0}(x_{0},y_{0},z_{0})` 处可微，相应的切线方程为

.. math::
	\begin{align*}
	\left \{ \begin{array}{lll}
	x-x_{0}=x'(t_{0})(t-t_{0}) \\
	y-y_{0}=y'(t_{0})(t-t_{0}) \\
	z-z_{0}=z'(t_{0})(t-t_{0}) 
	\end{array}  \right.
	\end{align*}

该切线也可表述成

.. math::
	\begin{align*}
	    \frac{x-x_{0}}{x'(t_{0})} =\frac{y-y_{0}}{y'(t_{0})} =\frac{z-z_{0}}{z'(t_{0})} 
	\end{align*}

:math:`\Gamma` 在点 :math:`P_{0}` 处的法平面方程为

.. math::
	\begin{align*}
	    x'(t_{0})(x-x_{0})+y'(t_{0})(y-y_{0})+z'(t_{0})(z-z_{0})=0
	\end{align*}




对于空间曲线

.. math::
	\begin{align*}
	\Gamma :\left \{  \begin{array}{ll}
	F_{1}(x,y,z)=0 \\
	F_{2}(x,y,z)=0
	\end{array} \right.
	\end{align*}

若 :math:`F_{1},F_{2}` 在点 :math:`P_{0}(x_{0},y_{0},z_{0})` 可微且 :math:`\operatorname{grad}F_{1}(P_{0}) , \operatorname{grad}F_{2}(P_{0})` 不为零，则曲线 :math:`\Gamma` 在该点的切线为

.. math::
	\begin{align*}
	\left \{  \begin{array}{ll}
	\frac{\partial F_{1}}{\partial x}\left ( P_{0} \right )\left ( x-x_{0} \right ) 
	+\frac{\partial F_{1}}{\partial y}\left ( P_{0} \right )\left ( y-y_{0} \right )  
	+\frac{\partial F_{1}}{\partial z}\left ( P_{0} \right )\left ( z-z_{0} \right )=0 \\
	\frac{\partial F_{2}}{\partial x}\left ( P_{0} \right )\left ( x-x_{0} \right ) 
	+\frac{\partial F_{2}}{\partial y}\left ( P_{0} \right )\left ( y-y_{0} \right )  
	+\frac{\partial F_{2}}{\partial z}\left ( P_{0} \right )\left ( z-z_{0} \right )=0  
	\end{array} \right.
	\end{align*}

要求Jacobi矩阵 :math:`\frac{\partial (F_{1},F_{2})}{\partial (x,y,z)}(P_{0})` 的秩等于 :math:`2` 。该切线的方向为

.. math::
	\begin{align*}
	\vec{T}=\operatorname{grad}F_{1}(P_{0})\times \operatorname{grad}F_{2}(P_{0}) 
	=\begin{pmatrix}
	 \frac{D(F_{1},F_{2})}{D(y,z)}(P_{0}) \\
	 \frac{D(F_{1},F_{2})}{D(z,x)}(P_{0}) \\
	 \frac{D(F_{1},F_{2})}{D(x,y)}(P_{0}) 
	\end{pmatrix}  
	\end{align*}

据此也可以得到切线的另外一个表述：

.. math::
	\begin{align*}
	    \frac{x-x_{0}}{\frac{D(F_{1},F_{2})}{D(y,z)}(P_{0}) } =\frac{y-y_{0}}{\frac{D(F_{1},F_{2})}{D(z,x)} (P_{0})} =\frac{z-z_{0}}{\frac{D(F_{1},F_{2})}{D(x,y)}(P_{0}) } 
	\end{align*}




Taylor公式
------------


定理 : 带Lagrange余项的一阶Taylor展式
    设 :math:`X_{0} \in \mathbb{R}^{n},r>0,f\in \mathscr{C}^{(2)}\left ( B(X_{0},r) \right )` 。则 :math:`\forall X\in B(X_{0},r),\exists \theta \in (0,1)` 使得

.. math::
	\begin{align*}
	    f(X)=f(X_{0})+J_{f}(X_{0})\Delta X+\frac{1}{2!}\left ( \Delta X \right )  ^{T}H_{f}(X_{\theta })\Delta X
	\end{align*}

其中

.. math::
	\begin{align*}
	    H_{f}(X_{\theta})=J_{\operatorname{grad}f}(X)=\left ( \frac{\partial f}{\partial x_{i}}{x_{j}} \left ( X_{\theta } \right )  \right ) _{1\leqslant i,j\leqslant n}
	\end{align*}

为 :math:`f` 在点 :math:`X_{\theta}` 的海塞矩阵， :math:`\Delta X=X-X_{0} , X_{\theta}=X_{0}+\theta(X-X_{0})` 。




定理 : 带Peano余项的二阶Taylor展式
	带Peano余项的二阶Taylor展式如下所示

.. math::
	\begin{align*}
	    f(X)=f(X_{0})+J_{f}(X_{0})\Delta X+\frac{1}{2!}(\Delta X)^{T}H_{f}(X_{0})\Delta X+o\left ( \left \| \Delta X \right \| ^{2} \right )  
	\end{align*}


.. note:: 

	特别地，对于二元函数，就会存在

	.. math::
		\begin{align*}
		\begin{pmatrix}
		 x & y
		\end{pmatrix}
		\begin{pmatrix}
		 a & b\\
		 b & c
		\end{pmatrix}
		\begin{pmatrix}
		x \\
		y
		\end{pmatrix}=ax^{2}+b2xy+cy^{2}
		\end{align*}




极值与条件极值
-----------------


极值
^^^^^^^

极值点不一定是最值点，最值点也不一定是极值点，如果最值点为内点，则它是极值点。

定理 : 
    假设 :math:`\Omega \subseteq \mathbb{R}^{n}` ， :math:`X_{0}` 为 :math:`\Omega` 的内点，而函数 :math:`f:\Omega\to \mathbb{R}` 在该点可导。若 :math:`X_{0}` 为 :math:`f` 的极值点，则

.. math::
	\begin{align*}
	    J_{f}(X_{0})=\vec{0} ,\text{即} \frac{\partial f}{\partial x_{j}}(X_{0})=0 \quad (1\leqslant j\leqslant n)
	\end{align*}

若 :math:`J_{f}(X_{0})=\vec{0}` ，则称点 :math:`X_{0}` 为函数 :math:`f` 的驻点，但是驻点不一定取到极值。



定理 : 
    设 :math:`\Omega \subseteq \mathbb{R}^{n}` 为有界开区域，而 :math:`f\in \mathscr{C}(\bar{\Omega})` 在 :math:`\Omega` 内可微且在 :math:`\partial \Omega` 上取常值，则 :math:`f` 在 :math:`\Omega` 内必定有驻点，即

.. math::
	\begin{align*}
	    \exists \xi \in \Omega ~\text{使得}~J_{f}(\xi )=\vec{0}  
	\end{align*}



定理 : 
    设 :math:`X_{0} \in \mathbb{R}^{n},r>0` ，而 :math:`f:B(X_{0},r)\to \mathbb{R}` 为二阶连续可微且 :math:`J_{f}(X_{0})=\vec{0}` 。

- 若 :math:`H_{f}(X_{0})` 正定，则 :math:`X_{0}` 为 :math:`f` 的极小值点；
- 若 :math:`H_{f}(X_{0})` 负定，则 :math:`X_{0}` 为 :math:`f` 的极大值点。

反过来，

- 若 :math:`X_{0}` 为 :math:`f` 的极小值点，则 :math:`H_{f}(X_{0})` 为正定或半正定；
- 若 :math:`X_{0}` 为 :math:`f` 的极大值点，则 :math:`H_{f}(X_{0})` 为负定或半负定。



.. note:: 

	- 当 :math:`H_{f}(X_{0})` 半正定或半负定时，一般无法判断 :math:`X_{0}` 是否为 :math:`f` 的极值点；
	- 当 :math:`H_{f}(X_{0})` 为不定时，则能确定 :math:`X_{0}` 不是 :math:`f` 的极值点。


判断二阶连续可导函数极值点的步骤为：

1. 求一阶偏导数，确定驻点；
2. 求二阶偏导数，得到海塞矩阵；
3. 判断海塞矩阵在驻点处的性态：正定则为极小值点，负定则为极大值点，不定则不是极值点。
   


判断矩阵是否为正定矩阵的方法：

1. 如果所有顺序主子式都是正的，那么该矩阵正定；
2. 如果所有特征值都是正的，那么该矩阵正定。
   

判断矩阵是否为负定的方法：

1. 如果所有特征值都小于零，那么该矩阵负定；
2. 如果偶数阶主子式为正，奇数阶主子式为负，那么该矩阵负定。
   




条件极值
^^^^^^^^^^

定理 : Lagrange乘数法
    设 :math:`\Omega \subset \mathbb{R}^{n}` 为开集，而 :math:`f,\varphi_{1},\dots ,\varphi_{n-k} :\Omega\to \mathbb{R}` 为 :math:`\mathscr{C}^{(1)}` 类函数使得 :math:`\forall X\in \Omega` ，矩阵 :math:`\frac{\partial (\varphi _{1},\dots ,\varphi_{n-k})}{\partial (x_{1},\dots ,x_{n})}` 的秩为 :math:`n-k` 。令

.. math::
	\begin{align*}
	    S=\left \{ X\in \Omega ~\left. \right | ~\varphi_{i}(X)=0,~1\leqslant i\leqslant n-k \right \} \ne \emptyset 
	\end{align*}

:math:`\forall X \in \Omega` 以及 :math:`\forall \lambda=(\lambda_{1},\dots,\lambda_{n-k})\in \mathbb{R}^{n-k}` ，定义Lagrange函数:

.. math::
	\begin{align*}
	    L(X,\lambda )=f(X)=\sum_{j=1}^{n-k}\lambda _{j}\varphi_{j} (X)
	\end{align*}

如果点 :math:`X_{0}\in S` 为函数 :math:`f` 在 :math:`S` 上的条件极值点，则 :math:`\exists \lambda \in \mathbb{R}^{n-k}` 使得 :math:`(X_{0},\lambda)` 为 :math:`L` 的驻点。


求有界闭区域上的最值的方法：

1. 将问题转化为有界闭区域上的连续函数的最值问题，可能需要构造函数；
2. 求函数在区域内部的驻点并计算相应的值；
3. 将函数限制在边界上，确定Lagrange函数
   
.. math::
    \begin{align*}
        L=f(X)+\sum \lambda_{i}\varphi_{i}(X)
    \end{align*}

求相应的拉氏函数的驻点，并计算原来那个函数的相应值；

4. 比较上述值的大小，由此确定最值点。
   





含参积分及广义含参积分
==========================


极限次序可交换性
------------------

定理 : 极限与极限次序可交换性
    如果 :math:`f:\left[ a,b\right]\times \left[ c,d\right] \to \mathbb{R}` 为连续函数，则 :math:`\forall (x_{0},y_{0})\in [a,b]\times [c,d]` ，均有

.. math::
	\begin{align*}
	    \lim_{y\to y_{0}}\lim_{x\to x_{0}}f(x,y)=f(x_{0},y_{0})=\lim_{x\to x_{0}}\lim_{y\to y_{0}}f(x,y)
	\end{align*}




定义 : 含参变量积分
    假设 :math:`f:\left[ a,b\right]\times \left[ c,d\right] \to \mathbb{R}` 为函数，如果 :math:`\forall y\in [c,d]` ，下列积分

.. math::
	\begin{align*}
	    I(y)=\int_{a}^{b}f(x,y)\mathrm{d}x
	\end{align*}

均有定义，则称之为以 :math:`y` 为变量的含参变量积分。



定理 : 极限与积分次序可交换性
    如果 :math:`f:\left[ a,b\right]\times \left[ c,d\right] \to \mathbb{R}` 为连续函数，则 :math:`I:[c,d] \to \mathbb{R}` 也为连续函数，也就有

.. math::
	\begin{align*}
	    \lim_{y\to y_{0}}\int_{a}^{b}f(x,y)\mathrm{d}x=\int_{a}^{b}\lim_{y\to y_{0}}f(x,y)\mathrm{d}x
	\end{align*}


.. note:: 由于连续性为局部性质，因此定理中将 $[c,d]$ 换成开区间，相应结论依然成立。



定理 : 求导与积分次序可交换性
    如果 :math:`f:\left[ a,b\right]\times \left[ c,d\right] \to \mathbb{R}` 为连续函数使得偏导函数 :math:`\frac{\partial f}{\partial y}` 在 :math:`[a,b]\times [c,d]` 上存在且连续，则 :math:`I:[c,d]\to \mathbb{R}` 为连续可导且

.. math::
	\begin{align*}
	    I'(y)=\frac{\mathrm{d} }{\mathrm{d} y}\int_{a}^{b}f(x,y)\mathrm{d}x=\int_{a}^{b}\frac{\partial f}{\partial y}\left( x,y\right)\mathrm{d}x
	\end{align*}


.. note:: 由于连续性为局部性质，因此定理中将 $[c,d]$ 换成开区间，相应结论依然成立。




定理 : 
    假设 :math:`f:\left[ a,b\right]\times \left[ c,d\right] \to \mathbb{R}` 为连续函数使得偏导函数 :math:`\frac{\partial f}{\partial y}` 在 :math:`[a,b]\times [c,d]` 上存在且连续，而 :math:`\alpha,\beta :[c,d]\to [a,b]` 可导。 :math:`\forall y\in [c,d]` ，定义

.. math::
	\begin{align*}
	    J(y)=\int_{\alpha(y)}^{\beta(y)}f(x,y)\mathrm{d}x
	\end{align*}

则 :math:`J:[c,d]\to \mathbb{R}` 为可导函数且

.. math::
	\begin{align*}
	    J'(y)=\int_{\alpha(y)}^{\beta(y)}\frac{\partial f}{\partial y}\left(x,y\right)\mathrm{d}x +f\left(\beta(y),y\right)\beta'(y) -f\left( \alpha(y),y \right)\alpha'(y)
	\end{align*}



定理 : 积分与积分次序可交换性
    若 :math:`f:\left[ a,b\right]\times \left[ c,d\right] \to \mathbb{R}` 连续，则

.. math::
	\begin{align*}
	    \int_{c}^{d}\left( \int_{a}^{b}f(x,y)\mathrm{d}x\right)\mathrm{d}y=\int_{a}^{b}\left( \int_{c}^{d}f(x,y)\mathrm{d}y\right)\mathrm{d}x
	\end{align*}





广义含参变量积分
-------------------


广义含参变量积分的收敛性
^^^^^^^^^^^^^^^^^^^^^^^^


定义 : 
    若 :math:`\forall \varepsilon>0, \exists M \in[a, \omega)` 使 :math:`\forall A \in[M, \omega)` 以及 :math:`\forall y \in[c, d]` , 均有

.. math::
	\begin{align}
	\left|\int_{a}^{A} f(x, y) \mathrm{d} x-I(y)\right|<\varepsilon
	\end{align}

则我们称广义含参变量积分 :math:`\int_{a}^{\omega} f(x, y) \mathrm{d} x` 在区间 :math:`[c, d]` 上一致收敛到函数 :math:`I(y)` 。




定理 : Cauchy准则
    :math:`\int_{a}^{\omega}f(x,y)\mathrm{d}x` 在 :math:`[c,d]` 上为一致收敛，当且仅当 :math:`\forall \varepsilon>0,\exists M\in [a,\omega)` 使得 :math:`\forall A',A''\in [M,\omega),\forall y\in [c,d]` ，有 :math:`\left| \int_{A'}^{A''}f(x,y)\mathrm{d}x\right|<\varepsilon` 。


常利用Cauchy准则的否定形式来证明广义含参积分不一致收敛： :math:`\exists A'_{n},A''_{n}\in [a,\omega),\exists y_{n}\in [c,d]` 使得

.. math::
	\begin{align*}
	    \lim_{n\to \infty}A'_{n}=\lim_{n\to \infty}A''_{n}=\omega, \quad \left| \int_{A'_{n}}^{A''_{n}}f(x,y_{n})\mathrm{d}x \right|\geqslant \varepsilon_{0}
	\end{align*}

基本的步骤为：

1. 找到广义含参积分的奇点 :math:`\omega` , 选取 :math:`A'_{n},~A''_{n}` 能够趋于 :math:`\omega` ,常见的为 :math:`n,~2n \to +\infty` ;
2. 判断能够较大程度改变函数性态的参变量的值，选取能够趋于该值的 :math:`y_{n}` ，常见的有 :math:`\frac{1}{n}\to 0` ；
3. 代入积分式中，能积分求出来的就计算出来，不能计算的就考虑用积分不等式，只要说明结果不等于零即可。
   

证明广义含参积分一致收敛的方法：

1. 利用Weierstrass判别法：对被积函数取绝对值，然后将其放大为单变量函数后，使得该单变量广义积分收敛，就可以证明一致收敛；
2. 利用Abel定理：将被积函数分成两部分，其中一部分的广义含参积分一致收敛（常常是直接分离成单变量函数），另一部分有界且关于微元变量单调，就可以证明一致收敛；
3. 利用Dirchlet定理：将被积函数分成两部分，其中一部分的变上限积分有界，另一部分随奇点趋于零，且其关于微元变量单调，则可以证明一致收敛。
   

定理 : Weierstrass判别法
    假设 :math:`f:[a, \omega) \times[c, d] \rightarrow \mathbb{R}` 为连续函数, 而函数 :math:`F:[a, \omega) \rightarrow[0,+\infty)` 使 :math:`\forall(x, y) \in[a, \omega) \times[c, d]` , 我们均有 :math:`|f(x, y)| \leqslant F(x)` 。若 :math:`\int_{a}^{\omega} F(x) \mathrm{d} x` 收敛, 则 :math:`\int_{a}^{\omega} f(x, y) \mathrm{d} x` 关于 :math:`y \in[c, d]` 一致收敛.




定理 : 
    设 $f, g:[a, \omega) \times[c, d] \rightarrow \mathbb{R}$ 为函数使得 $\forall y \in[c, d], f(\cdot, y), g(\cdot, y)$ 在 $[a, \omega)$ 的任意的闭子区间上均可积，那么：

- (Abel) 如果 :math:`\int_{a}^{\omega} f(x, y) \mathrm{d} x` 关于 :math:`y \in[c, d]` 一致 收敛，而 :math:`g` 有界并且关于第一个变量单调, 那么 :math:`\int_{a}^{\omega} f(x, y) g(x, y) \mathrm{d} x` 关于 :math:`y \in[c, d]` 一致收敛。
- (Dirichlet) :math:`\forall y \in[c, d]` 以及 :math:`\forall A \in[a, \omega)` ，定义 :math:`F(A, y)=\int_{a}^{A} f(x, y) \mathrm{d} x` 。若 :math:`F` 有界， :math:`g` 关于第一个变量单调且 :math:`\lim \limits_{x \rightarrow \omega^{-}} g(x, y)=0` 关于 :math:`y \in[c, d]` 一致 成立, 则 :math:`\int_{a}^{\omega} f(x, y) g(x, y) \mathrm{d} x` 关于 :math:`y \in[c, d]` 一致收敛。
  



广义含参变量积分的分析性质
^^^^^^^^^^^^^^^^^^^^^^^^^^

定理 : 
    设 :math:`f:[a, \omega) \times[c, d] \rightarrow \mathbb{R}` 为连续函数，那么有：

- 极限与积分可交换性：若广义含参变量积分
  
.. math::
	\begin{align}
	I(y)=\int_{a}^{\omega} f(x, y) \mathrm{d} x
	\end{align}

关于 :math:`y \in[c, d]` 一致收敛, 则 :math:`I` 在 :math:`[c, d]` 上连续。

- 求导与积分可交换性：若 :math:`I(y)=\int_{a}^{\omega} f(x, y) \mathrm{d} x` 在区间 :math:`[c, d]` 上收敛， 偏导函数 :math:`\frac{\partial f}{\partial y}` 在 :math:`[a, \omega) \times[c, d]` 上连续并且使得 广义含参积分 :math:`\int_{a}^{\omega} \frac{\partial f}{\partial y}(x, y) \mathrm{d} x` 关于 :math:`y \in[c, d]` 为 一致收敛, 则 :math:`I` 在 :math:`[c, d]` 上连续可导且
  
.. math::
	\begin{align}
	I^{\prime}(y)=\int_{a}^{\omega} \frac{\partial f}{\partial y}(x, y) \mathrm{d} x
	\end{align}

- 积分与积分可交换性：若 :math:`I(y)=\int_{a}^{\omega} f(x, y) \mathrm{d} x` 关于 :math:`y \in[c, d]` 一致收敛，则 :math:`I` 在 :math:`[c, d]` 上可积且

.. math::
	\begin{align}
	\int_{c}^{d}\left(\int_{a}^{\omega} f(x, y) \mathrm{d} x\right) \mathrm{d} y=\int_{a}^{\omega}\left(\int_{c}^{d} f(x, y) \mathrm{d} y\right) \mathrm{d} x
	\end{align}


计算广义含参积分的方法：

1. 利用求导与积分可交换性：对被积函数的参变量求偏导，从而求出结果的导函数，或构成微分方程。前提是要证明原广义含参积分和求导后的广义含参积分均一致收敛；
2. 利用积分与积分可交换性：对于有两个参变量且有相同形式的可以考虑，转化为积分套积分。前提是证明转化得到的积分的含参广义积分一致收敛。





二次曲面及其分类
==================

空间曲面与方程
----------------

球面方程
^^^^^^^^

对于球心为 :math:`O(x_{0},y_{0},z_{0})` ，半径为 :math:`r` 的球面，对应的球面方程为

.. math::
	\begin{align}
	 (x-x_{0})^{2}+(y-y_{0})^{2}+(z-z_{0})^{2}=r^{2}
	\end{align}

展开可以得到二次方程 :math:`x^{2}+y^{2}+z^{2}+ax+by+cz+d=0` 表示球面。

球面的参数方程为：

.. math::
	\begin{align}
	\left\{\begin{array}{lll}
	x=r\cos u\sin v \\
	y=r\cos u\cos v \\
	z=r\sin u
	\end{array}\right.
	\end{align}

其中 :math:`u\in [-\frac{\pi }{2},\frac{\pi }{2}],v\in [0,2\pi ]` 。


圆柱面方程
^^^^^^^^^^

圆柱面的一般方程为：

.. math::
	\begin{align}
	x^{2}+y^{2}=r^{2}
	\end{align}

.. note:: 这里不含 :math:`z` 表示 :math:`z` 不受约束，可以任意取值。

圆柱面的参数方程为：

.. math::
	\begin{align}
	\left \{\begin{array}{lll}
	x=r\cos u\\
	y=r\sin u\\
	z=v
	\end{array}\right . ,
	\quad u\in [0,2\pi ],v\in \mathbb{R}
	\end{align}


抛物柱面
^^^^^^^^

抛物柱面的一般方程为：

.. math::
	\begin{align}
	x=\frac{a}{b^{2}}y^{2}
	\end{align}

抛物柱面的参数方程为：

.. math::
	\begin{align}
	\left \{\begin{array}{lll}
	x=au^{2}\\
	y=bu\\
	z=v
	\end{array}\right . ,
	\quad u\in (e,f),v\in \mathbb{R}
	\end{align}


旋转曲面方程
^^^^^^^^^^^^

设 :math:`Oxy` 平面内有一段曲线 :math:`C: f(x, y)=0, y \geq 0` 将C绕 :math:`x` 轴旋转一周, 所得到的曲面叫旋转面.该旋转面的方程为：设 :math:`S` 上点 :math:`P(x, y, z)` 是经曲线 :math:`C` 上点 :math:`\left(x_{0}, y_{0}, 0\right)` 旋转而得到的, 则

.. math::
	\begin{align}
	\left\{\begin{array}{ll}
	x=x_{0} \\ 
	\sqrt{y^{2}+z^{2}}=y_{0}
	\end{array}\right.
	\end{align}

于是 :math:`P` 满足的方程为： :math:`f\left(x, \sqrt{y^{2}+z^{2}}\right)=0` 。




常见的二次曲面及其标准方程
--------------------------

定义 : 二次曲面
    设 :math:`f(x,y,z)` 为二次多项式，称 :math:`f(x,y,z)=0` 表示的曲面为二次曲面。


椭球面
^^^^^^

椭球面的标准方程为：

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}+\frac{z^{2}}{c^{2}}=1\quad(a,b,c>0)
	\end{align}

用平面截线法来作图：此平面与平面 :math:`z=z_{0}` 的交线为

.. math::
	\begin{align}
	C_{Z_{0}}:
	\left \{\begin{array}{ll}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=1-\frac{z_{0}^{2}}{c^{2}}\\
	z=z_{0}   
	\end{array}\right .
	\end{align}

- 当 :math:`\left|z_{0}\right|>c` 时，为虚椭圆( :math:`\mathbb{R}^{3}` 中不存在)；
- 当 :math:`\left|z_{0}\right|=c` 时，为一个点 :math:`(0,0,c)` 或 :math:`(0,0,-c)` ；
- 当 :math:`\left|z_{0}\right|<c` 时, 为椭圆。且随 :math:`z_{0}` 的增加, 椭圆 :math:`C_{z_{0}}` 先逐渐变大, 再逐渐变小；
- 当 :math:`z_{0}=0` 时，在 :math:`xOy` 平面上取得最大的椭圆： :math:`\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=1, z=0` 。


单叶双曲面
^^^^^^^^^^
单叶双曲面的标准方程为：

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}-\frac{z^{2}}{c^{2}}=1\quad(a,b,c>0)
	\end{align}

用平面 :math:`z=z_{0}` 截得曲线为平行于 :math:`xOy` 平面的一族椭圆：

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=1+\frac{z_{0}}{c^{2}}
	\end{align}

用平面 :math:`x=x_{0}` 截得曲线为平行于 :math:`yOz` 平面的一族双曲线（包含其渐近线）:

.. math::
	\begin{align}
	\frac{y^{2}}{b^{2}}-\frac{z^{2}}{c^{2}}=1-\frac{x_{0}^{2}}{a^{2}}
	\end{align}


双叶双曲面
^^^^^^^^^^

双叶双曲面的标准方程为：

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}-\frac{z^{2}}{c^{2}}=-1\quad(a,b,c>0)
	\end{align}

用平面 :math:`z=z_{0}` 截曲面，得到

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=\frac{z_{0}^{2}}{c^{2}}-1
	\end{align}

用平面 :math:`x=x_{0}` 截曲面，得到

.. math::
	\begin{align}
	\frac{z^{2}}{c^{2}}-\frac{y^{2}}{b^{2}}=1+\frac{x_{0}^{2}}{a^{2}}
	\end{align}

用平面 :math:`y=y_{0}` 截曲面，得到

.. math::
	\begin{align}
	\frac{z^{2}}{c^{2}}-\frac{x^{2}}{a^{2}}=1+\frac{y_{0}^{2}}{b^{2}}
	\end{align}


锥面
^^^^^^

锥面的标准方程为：

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}-\frac{z^{2}}{c^{2}}=0\quad(a,b,c>0)
	\end{align}

用平面 :math:`z=z_{0}` 截曲面，得到

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=\frac{z_{0}^{2}}{c^{2}}
	\end{align}

用平面 :math:`x=x_{0}` 截曲面，得到

.. math::
	\begin{align}
	\frac{z^{2}}{c^{2}}-\frac{y^{2}}{b^{2}}=\frac{x_{0}^{2}}{a^{2}}
	\end{align}

实际上，单叶双曲面与双叶双曲面具有渐进面，正是锥面。两族 :math:`a:b:c` 固定不变的单叶双曲面与双叶双曲面有共同的渐进锥面。


椭圆抛物面
^^^^^^^^^^

椭圆抛物面的标准方程为：

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=z\quad(a,b>0)
	\end{align}

用平面 :math:`z=z_{0}` 截曲面，得到

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=z_{0}
	\end{align}

用平面 :math:`x=x_{0}` 截曲面，得到

.. math::
	\begin{align}
	z=\frac{y^{2}}{b^{2}}+\frac{x_{0}^{2}}{a^{2}}
	\end{align}

这是开口向 :math:`z` 轴正方向的抛物线，形状固定，而顶点位置改变。用平面 :math:`y=y_{0}` 截平面类似处理。



双曲抛物面
^^^^^^^^^^

双曲抛物面的标准方程为：

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}-\frac{y^{2}}{b^{2}}=z \quad (a,b>0)
	\end{align}

用平面 :math:`x=x_{0}` 截曲面，得到

.. math::
	\begin{align}
	z=-\frac{y^{2}}{b^{2}}+\frac{x_{0}^{2}}{a^{2}}
	\end{align}

这是一族开口向 :math:`z` 轴负方向的抛物线。

用平面 :math:`y=y_{0}` 截曲面，得到

.. math::
	\begin{align}
	z=\frac{x^{2}}{a^{2}}-\frac{y_{0}^{2}}{b^{2}}
	\end{align}

这是一族开口向 :math:`z` 轴正方向的抛物线。

用平面 :math:`z=z_{0}` 截曲面，得到

.. math::
	\begin{align}
	\frac{x^{2}}{a^{2}}-\frac{y^{2}}{b^{2}}=z_{0}
	\end{align}

这是一族双曲线（含渐近线）。


直纹面
^^^^^^

有一类曲面能够通过直线/线段的移动来得到，称为直纹面。特别的，单叶双曲面和双曲抛物面（马鞍面）均为直纹面。下面证明马鞍面为直纹面：

**证明** 设马鞍面的方程为： :math:`\frac{x^{2}}{a^{2}}-\frac{y^{2}}{b^{2}}=z\quad(a,b>0)` ，将其改写为

.. math::
	\begin{align}
	(\frac{x}{a}+\frac{y}{b})(\frac{x}{a}-\frac{y}{b})=z
	\end{align}

令 :math:`(\frac{x}{a}+\frac{y}{b})=\lambda` ，得到直线方程

.. math::
	\begin{align}
	\left \{\begin{array}{ll}
	(\frac{x}{a}+\frac{y}{b})=\lambda \\
	\lambda (\frac{x}{a}-\frac{y}{b})=z
	\end{array}\right .
	\end{align}

当 :math:`\lambda` 取不同数时，上式表示一族运动的曲线，从而产生了马鞍面。



重积分
========

n重积分的概念及其性质
-----------------------

定义 : Jordan可测集
    若 :math:`\Omega \subset \mathbb{R}^{n}` 为有界集且使得其示性函数 :math:`1_{\omega}` 为Riemann可积，则称 :math:`\omega` 为Jordan可测集。此时还称 :math:`\int_{\Omega }1_{\Omega }(X)\mathrm{d}X` 为 :math:`\Omega` 的体积或测度，记作 :math:`|\Omega|` 。

Riemann积分的基本性质：

- 有界性：若 :math:`f\in \mathscr{R}(\Omega )` ，则 :math:`f` 为有界函数。
- 线性性：
  
.. math::
	\begin{align}
	\int_{\Omega }\big(af_{1}(X)+bf_{2}(X)\big)\mathrm{d}X=a\int_{\Omega }f_{1}(X)\mathrm{d}X+b\int_{\Omega }f_{2}(X)\mathrm{d}X
	\end{align}

- 区间可加性：设 :math:`\Omega=\Omega _{1}\cup \Omega _{2}` ，且 :math:`\Omega_{1},\Omega_{2}` 没有公共的内点，则

.. math::
	\begin{align}
	\int_{\Omega }f(X)\mathrm{d}X=\int_{\Omega _{1}}f(X)\mathrm{d}X+\int_{\Omega _{2}}f(X)\mathrm{d}X
	\end{align}

- 保号性：如果 :math:`f\in \mathscr{R}(\Omega )` 使得 :math:`\forall X \in \Omega` ，均有 :math:`f(X)\geqslant 0` ，则 :math:`\int_{\Omega }f(X)\mathrm{d}X\geqslant 0` ；若 :math:`f\in \mathscr{C}(\Omega )` 非负且恒不为零，则有 :math:`\int_{\Omega }f(X)\mathrm{d}X>0` 。
- 保序性：若 :math:`f,g\in\mathscr{R}(\Omega )` 使得 :math:`\forall X\in \Omega` 均有 :math:`f(X) \leqslant g(X)` ，则
  
.. math::
	\begin{align}
	\int_{\Omega }f(X)\mathrm{d}X\leqslant \int_{\Omega }g(X)\mathrm{d}X
	\end{align}

- 绝对值不等式：若 :math:`f\in\mathscr{R}(\Omega )` ，则 :math:`|f|\in\mathscr{R}(\Omega )` 且
  
.. math::
	\begin{align}
	\left| \int_{\Omega }f(X)\mathrm{d}X \right | \leqslant \int_{\Omega }|f(X)|\mathrm{d}X
	\end{align}

- 积分上下界：若 :math:`f\in \mathscr{R}(\Omega )` ，:math:`M,m` 为其上、下界，则
  
.. math::
	\begin{align}
	m|\Omega |\leqslant \int_{\Omega }f(X)\mathrm{d}X \leqslant M|\Omega |
	\end{align}

- 积分中值定理：若 :math:`\Omega` 为有界的闭连通集，而 :math:`f\in\mathscr{C}(\Omega)` ，则 :math:`\exists X_{0}\in \Omega` 使得

.. math::
	\begin{align}
	\int_{\Omega }f(X)\mathrm{d}X =f(X_{0})|\Omega |
	\end{align}

进而可知， :math:`\forall Y\in\operatorname{Int}\Omega` 有

.. math::
	\begin{align}
	f(Y)=\lim_{r\to 0^{+}}\frac{1}{\big|\bar{B}(Y,r) \big|} \int_{\bar{B}(Y,r)}f(X)\mathrm{d}X 
	\end{align}



二重积分的计算
--------------


累次积分法
^^^^^^^^^^

**例题** 计算 :math:`\iint\limits _{D}xy~\mathrm{d}x\mathrm{d}y` ，其中 :math:`D` 表示由抛物线 :math:`x=y^{2}` 与直线 :math:`x-y-2=0` 围成的闭区域。

**解** 首先找到边界点，联立方程 :math:`\left \{ \begin{array}{ll}x=y^{2} \\ x-y-2=0\end{array} \right.` 得到两个边界点 :math:`(1,-1)` 和 :math:`(4,2)` ，再找到实际围成的闭区域 :math:`\left \{ \begin{array}{ll}x\geqslant y^{2} \\ x-y-2\leqslant 0\end{array} \right.` ，选择以 :math:`y` 为自由变量，则将 :math:`x` 用 :math:`y` 的不等式限制住，于是得到积分区域为

.. math::
	\begin{align*}
	    D=\left \{ (x,y)\in\mathbb{R}^{2} ~\big|~~ y^{2}\leqslant x\leqslant  y+2,~-1\leqslant y\leqslant 2 \right \} 
	\end{align*}

进而可得

.. math::
	\begin{align*}
	    \iint\limits_{D}xy~\mathrm{d}x\mathrm{d}y
	    =\int_{-1}^{2}\mathrm{d}y\int_{y^{2}}^{y+2}xy\mathrm{d}x
	    =\frac{45}{8} 
	\end{align*}


交换积分次序
^^^^^^^^^^^^

**例题** 计算 :math:`I=\int_{0}^{1}\mathrm{d}x\int_{x}^{1}e^{-y^{2}}\mathrm{d}y` 。

**解** 根据累次积分的上下限重新写出积分区域：

.. math::
	\begin{align*}
	    D=\left \{ (x,y)\in\mathbb{R}^{2} ~\big|~~0\leqslant x\leqslant 1,~x\leqslant y\leqslant 1 \right \} 
	\end{align*}

通过交换自由变量重写累次积分得到

.. math::
	\begin{align*}
	    I=\iint\limits _{D}e^{-y^{2}}\mathrm{d}x\mathrm{d}y
	    =\int_{0}^{1}\mathrm{d}y\int_{0}^{y}e^{-y^{2}}\mathrm{d}y
	    =\frac{1}{2}(1-e^{-1})
	\end{align*}



对称性在积分中的应用
^^^^^^^^^^^^^^^^^^^^

当积分区域 :math:`D` 关于 :math:`x` 轴对称时：

- 如果有 :math:`f(x,-y)=-f(x,y)` ，则 :math:`\iint\limits _{D}f(x,y)\mathrm{d}x\mathrm{d}y=0` 。
- 如果有 :math:`f(x,-y)=f(x,y)` ，则
  
.. math::
	\begin{align}
	\iint\limits _{D}f(x,y)\mathrm{d}x\mathrm{d}y=2\iint\limits _{D'}f(x,y)\mathrm{d}x\mathrm{d}y
	\end{align}

其中 :math:`D'` 为 :math:`D` 位于 :math:`x` 轴上侧或下侧的部分。

当积分区域 :math:`D` 关于 :math:`y` 轴对称时：

- 若 :math:`f(-x,y)=-f(x,y)` ，则有 :math:`\iint\limits _{D}f(x,y)\mathrm{d}x\mathrm{d}y=0` 。
- 若 :math:`f(-x,y)=f(x,y)` ，则有
  
.. math::
    \begin{align*}
        \iint\limits _{D}f(x,y)\mathrm{d}x\mathrm{d}y=2\iint\limits _{D'}f(x,y)\mathrm{d}x\mathrm{d}y
    \end{align*}

其中 :math:`D'` 为 :math:`D` 位于 :math:`y` 轴左侧或右侧的部分。


当积分区域 :math:`D` 关于原点对称时：

如果有 :math:`f(-x,-y)=-f(x,y)` ，则有 :math:`\iint\limits _{D}f(x,y)\mathrm{d}x\mathrm{d}y=0` 。






极坐标变换
^^^^^^^^^^

定理 : 极坐标变换
    :math:`\forall r\in[0,+\infty ),~\forall \theta\in[0,2\pi]` ，令 :math:`\left \{\begin{array}{ll}x=r\cos\theta \\ y=r\sin \theta \end{array}\right.` ，则有

.. math::
	\begin{align*}
	    \frac{D(x,y)}{D(r,\theta )} =
	\begin{vmatrix}
	 \cos\theta  & -r\sin\theta \\
	 \sin \theta  & r\cos\theta 
	\end{vmatrix}=r\geqslant 0
	\end{align*}

于是

.. math::
	\begin{align*}
	    \iint\limits _{g(D_{1})}f(x,y)\mathrm{d}x\mathrm{d}y=\iint\limits _{D_{1}}f\big(r\cos\theta ,r\sin\theta \big)r~\mathrm{d}r\mathrm{d}\theta
	\end{align*}



其他类型的坐标变换
^^^^^^^^^^^^^^^^^^

**例题** 计算由抛物线 :math:`y^{2}=px,~y^{2}=qx` 与双曲线 :math:`xy=a,~xy=b` 合起来所围成的平面区域 :math:`\Omega` 的面积，其中 :math:`q>p>0,~b>a>0` 。

**解** 根据积分区域边界 :math:`\left \{ \begin{array}{llll}y^{2}=px \\y^{2}=qx \\xy=a \\xy=b\end{array} \right.` ，可以知道积分区域满足 :math:`\left \{ \begin{array}{llll}y^{2}\leqslant px \\y^{2}\geqslant qx \\xy\geqslant a \\xy\leqslant b\end{array} \right.` 。

作变换 :math:`u=\frac{y^{2}}{x},~v=xy` ，则 :math:`\Omega` 变为

.. math::
	\begin{align*}
	     \Omega_{1}=\left \{ (u,v) ~\big|~ p\leqslant u\leqslant q,~a\leqslant v\leqslant b \right \} 
	\end{align*}

而 :math:`\frac{D(u,v)}{D(x,y)}=\begin{vmatrix}-\frac{y^{2}}{x^{2}}  & \frac{2y}{x} \\ y & x\end{vmatrix}=-\frac{3y^{2}}{x}` ，于是有 :math:`\frac{D(x,y)}{D(u,v)}=-\frac{x}{3y^{2}}=-\frac{1}{3u}` 由此可知所求面积为

.. math::
	\begin{align*}
	    S
	    =\iint\limits _{\Omega _{1}}\Big|\frac{D(x,y)}{D(u,v)} \Big|\mathrm{d}u\mathrm{d}v
	    =\iint\limits _{\Omega _{1}}\frac{1}{3u}\mathrm{d}u\mathrm{d}v
	    =\int_{a}^{b}\mathrm{d}v\int_{p}^{q}\frac{1}{3u}\mathrm{d}u
	    =\frac{1}{3}(b-a)\ln\frac{q}{p}
	\end{align*}





二重积分的几何意义
^^^^^^^^^^^^^^^^^^

**例题** 计算椭圆形的圆柱面 :math:`4x^{2}+y^{2}=1` 与平面 :math:`z=1-y` 以及 :math:`z=0` 所围成的立体的体积。

**解** 描述高的函数是 :math:`z=1-y` ，于是积分区域由 :math:`4x^{2}+y^{2}\leqslant 1` 决定，考虑让 :math:`x` 作为自由变量，则 :math:`-\sqrt{1-4x^{2}} \leqslant y\leqslant \sqrt{1-4x^{2}}` ，因此

.. math::
	\begin{align*}
	    D=\left \{ (x,y)\in\mathbb{R}^{2} ~\big|~ -\frac{1}{2}\leqslant x\leqslant \frac{1}{2},~-\sqrt{1-4x^{2}}\leqslant y\leqslant \sqrt{1-4x^{2}} \right \} 
	\end{align*}

于是所求立体的体积为

.. math::
	\begin{align*}
	    V=\iint\limits _{D}(1-y)\mathrm{d}x\mathrm{d}y
	    =\int_{-\frac{1}{2}}^{\frac{1}{2} }\mathrm{d}x\int_{-\sqrt{1-4x^{2}} }^{\sqrt{1-4x^{2}} }(1-y)\mathrm{d}y
	    =\frac{\pi}{2} 
	\end{align*}



三重积分的计算
--------------

累次积分法
^^^^^^^^^^

**例题** 计算 :math:`I=\iiint\limits_{\Omega }(x+y)\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，其中

.. math::
	\begin{align*}
	    \Omega =\left \{ (x,y,z) ~\big|~ x+y+z\leqslant 1,~~x,y,z\geqslant 0\right \} 
	\end{align*}

**解** 让 :math:`x` 作为第一自由变量， :math:`y` 作为第二变量，根据所围成的积分区域形成的不等关系，可以得到积分区域为 :math:`\left \{\begin{array}{lll}0\leqslant x\leqslant 1 \\ 0\leqslant y\leqslant 1-x \\ 0\leqslant z\leqslant 1-x-y \end{array}\right.` 于是

.. math::
	\begin{align*}
	    I&=\int_{0}^{1}\mathrm{d}x\int_{0}^{1-x}\mathrm{d}y\int_{0}^{1-x-y}(x+y)\mathrm{d}z \\
	    &=\int_{0}^{1}\mathrm{d}x\int_{0}^{1-x}(1-x-y)(x+y)\mathrm{d}y \\
	    &=\int_{0}^{1}(\frac{1}{6}-\frac{x^{2}}{2}+\frac{x^{3}}{3})\mathrm{d}x=\frac{1}{12} 
	\end{align*}



柱坐标变换
^^^^^^^^^^

定理 : 广义柱坐标变换
    考虑广义柱坐标变换（其中 :math:`a,b>0` ）：

.. math::
	\begin{align*}
	\left \{ \begin{array}{lll}
	x=ar\cos\theta  \\
	y=br\sin\theta  \\
	z=z
	\end{array} \right. 
	\quad (r\geqslant 0,~0\leqslant \theta <2\pi,~z\in\mathbb{R} )
	\end{align*}

该变换连续可导，且有

.. math::
	\begin{align*}
	\frac{D(x,y,z)}{D(r,\theta ,z)} =
	\begin{vmatrix}
	 a\cos\theta  & -ar\sin\theta  & 0\\
	 b\sin\theta  & br\cos\theta  & 0\\
	 0 & 0 & 1
	\end{vmatrix}=abr
	\end{align*}

假设 :math:`\Omega\subset \mathbb{R}^{3}` 为Jordan可测集，且在广义柱坐标系下变为 :math:`\Omega_{1}` ，则有

.. math::
	\begin{align*}
	    \iiint\limits _{\Omega }f(x,y,z)~\mathrm{d}x\mathrm{d}y\mathrm{d}z=\iiint\limits _{\Omega _{1}}f(ar\cos\theta ,br\sin\theta ,z)abr~\mathrm{d}r\mathrm{d}\theta\mathrm{d}z
	\end{align*}

当 :math:`a=b=1` 时，得到标准柱坐标变换。



球坐标变换
^^^^^^^^^^

定理 : 球坐标变换
    考虑球坐标变换

.. math::
	\begin{align*}
	    \left \{\begin{array}{lll}
	    x=r\sin\varphi \cos\theta  \\
	    y=r\sin\varphi \sin\theta  \\
	    z=r\cos\varphi 
	    \end{array}\right.
	\quad (r\geqslant 0,~0\leqslant \varphi \leqslant \pi ,~0\leqslant \theta <2\pi )
	\end{align*}

该变换连续可导，且有

.. math::
	\begin{align*}
	\frac{D(x,y,z)}{D(r,\theta ,\varphi)} =
	\begin{vmatrix}
	 \sin\varphi \cos\theta & r\cos\varphi \cos\theta & -r\sin\varphi \sin\theta \\
	 \sin\varphi \sin\theta & r\cos\varphi \sin\theta & r\sin\varphi \cos\theta \\
	 \cos\varphi  & -r\sin\varphi  & 0
	\end{vmatrix}=r^{2}\sin\varphi 
	\end{align*}

设 :math:`\Omega \subset \mathbb{R}^{3}` 为Jordan可测集，且在球坐标系下变为 :math:`\Omega_{1}` ，则有

.. math::
	\begin{align*}
	    \iiint \limits _{\Omega }f(x,y,z)~\mathrm{d}x\mathrm{d}y\mathrm{d}z
	    &=\iiint \limits _{\Omega_{1} }f(r\sin\varphi \cos\theta,r\sin\varphi \sin\theta ,r\cos\varphi )\bigg|\frac{D(x,y,z)}{D(r,\theta,\varphi )}\bigg|\mathrm{d}r\mathrm{d}\varphi\mathrm{d}\theta \\
	    &=\iiint \limits _{\Omega_{1} }f(r\sin\varphi \cos\theta,r\sin\varphi \sin\theta ,r\cos\varphi )r^{2}\sin\varphi \mathrm{d}r\mathrm{d}\varphi\mathrm{d}\theta
	\end{align*}

广义球坐标变换满足

.. math::
	\begin{align*}
	    \left \{ \begin{array}{lll}
	x=ar\sin\varphi\cos\theta ,\\
	y=br\sin\varphi\sin\theta ,\\
	z=cr\cos\theta ,
	\end{array} \right.
	\qquad 
	\left | \frac{D(x,y,z)}{D(r,\theta ,\varphi)}  \right | =abcr^{2}\sin\varphi
	\end{align*}



对称性在积分中的应用
^^^^^^^^^^^^^^^^^^^^

**例题** 计算 :math:`\iiint\limits_{\Omega}z^{2}~\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，其中 :math:`\Omega =\left \{ (x,y,z) ~\big|~ x^{2}+y^{2}+z^{2}\leqslant R^{2} \right \}` 。

**解** 由对称性可知

.. math::
	\begin{align*}
	    \iiint \limits _{\Omega }x^{2}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\iiint \limits _{\Omega }y^{2}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\iiint \limits _{\Omega }z^{2}\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{align*}

进而利用球坐标变换可得

.. math::
	\begin{align*}
	    \iiint \limits _{\Omega }z^{2}\mathrm{d}x\mathrm{d}y\mathrm{d}z
	    &=\frac{1}{3} \iiint \limits _{\Omega }(x^{2}+y^{2}+z^{2})\mathrm{d}x\mathrm{d}y\mathrm{d}z \\
	    &=\frac{1}{3}\int_{0}^{2\pi}\mathrm{d}\theta\int_{0}^{\pi}\mathrm{d}\varphi\int_{0}^{R}r^{2}\cdot(r^{2}\sin\theta )\mathrm{d}r \\
	    &=\frac{2\pi}{3}\bigg(\int_{0}^{R}r^{4}\mathrm{d}r\bigg) \bigg(\int_{0}^{\pi}\sin\theta \mathrm{d}\theta \bigg) \\
	    &=\frac{4}{15}\pi R^{5} 
	\end{align*}



**例题** 计算 :math:`\iiint\limits _{x^{2}+y^{2}+z^{2}\leqslant 2z}(ax+by+cz)\mathrm{d}x\mathrm{d}y\mathrm{d}z` 。

**解** 由对称性可知

.. math::
	\begin{align*}
	    \iiint\limits _{x^{2}+y^{2}+z^{2}\leqslant 2z}(ax+by+cz)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	    &=\iiint\limits _{x^{2}+y^{2}+(z-1)^{2}\leqslant 1}\big(ax+by+c(z-1)+c\big)\mathrm{d}x\mathrm{d}y\mathrm{d}z \\
	    &=\iiint\limits _{x^{2}+y^{2}+(z-1)^{2}\leqslant 1}c~\mathrm{d}x\mathrm{d}y\mathrm{d}z \\
	    &=\frac{4}{3}\pi c
	\end{align*}



其他类型的坐标变换
^^^^^^^^^^^^^^^^^^

**例题** 求 :math:`\iiint \limits _{\Omega }(x+y+z)\cos(x+y+z)^{2}\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，其中

.. math::
	\begin{align*}
	    \Omega =\left \{ (x,y,z) ~\big|~ 0\leqslant x-y\leqslant 1,~0\leqslant x-z\leqslant 1,~ 0\leqslant x+y+z\leqslant 1 \right \} 
	\end{align*}

**解** 作变量替换 :math:`\left \{\begin{array}{lll}u=x-y \\ v=x-z \\ w=x+y+z\end{array} \right.` ，在此变换下，积分区域变为

.. math::
	\begin{align*}
	    \Omega _{1}=\left \{ (u,v,w) ~\big|~ 0\leqslant u \leqslant 1,~0\leqslant v\leqslant 1,~0\leqslant w\leqslant 1\right \} 
	\end{align*}

同时有

.. math::
	\begin{align*}
	\frac{D(u,v,w)}{D(x,y,z)} =
	\begin{vmatrix}
	 1 & -1 & 0\\
	 1 & 0 & -1\\
	 1 & 1 & 1
	\end{vmatrix}=3
	\end{align*}

于是 :math:`\frac{D(x,y,z)}{D(u,v,w)}=\frac{1}{3}` ，进而得到

.. math::
	\begin{align*}
	    &\quad \iiint \limits _{\Omega }(x+y+z)\cos(x+y+z)^{2}\mathrm{d}x\mathrm{d}y\mathrm{d}z \\
	    &=\int_{0}^{1}\mathrm{d}w\int_{0}^{1}\mathrm{d}v\int_{0}^{1}w\cos(w^{2})\mathrm{d}u
	    =\frac{1}{3}\int_{0}^{1}w\cos(w^{2})\mathrm{d}w \\
	    &=\frac{1}{6}\sin(w^{2}) \bigg|_{0}^{1}
	    =\frac{1}{6} \sin 1
	\end{align*}



重积分的应用
------------

物体的重心/质心/形心问题
^^^^^^^^^^^^^^^^^^^^^^^^

设 :math:`\Omega \subset \mathbb{R}^{n}` 中分布有质量，在点 :math:`X` 处的密度为 :math:`\rho(X)` ，重心为 :math:`\bar{X}=(\bar{x}_{1},\cdots,\bar{x}_{n})` ，则

.. math::
	\begin{align*}
	    \bar{x}_{j}=\frac{\underset{\Omega }{\int\cdots\int}x_{j}\rho(x_{1},\cdots,x_{n})\mathrm{d}x_{1}\cdots\mathrm{d}x_{n}}{\underset{\Omega }{\int\cdots\int}\rho(x_{1},\cdots,x_{n})\mathrm{d}x_{1}\cdots\mathrm{d}x_{n}}
	\end{align*}

当 :math:`\rho\equiv 1` 时，将质心称为形心。



曲面的面积问题
^^^^^^^^^^^^^^

设空间曲面 :math:`\Sigma` 的参数方程为

.. math::
	\begin{align*}
	\left \{\begin{array}{lll}
	x=x(u,v)  \\
	y=y(u,v)  \\
	z=z(u,v) 
	\end{array}\right.
	\quad  (u,v)\in D
	\end{align*}

其中 :math:`D\subset \mathbb{R}^{2}` 为Jordan可测集，而 :math:`x,y,z` 为连续可导函数使得 :math:`\frac{\partial (x,y,z)}{\partial (u,v)}` 的秩为 :math:`2` 。根据曲面参数方程 :math:`\vec{f}(x,y,z)` 定义

.. math::
	\begin{align*}
	    & E=\left \| \frac{\partial \vec{f}}{\partial u}\right \| ^{2}=(\frac{\partial x}{\partial u})^{2}+(\frac{\partial y}{\partial u})^{2}+(\frac{\partial z}{\partial u})^{2} \\
	    & G=\left \| \frac{\partial \vec{f}}{\partial v} \right \| ^{2}
	    =(\frac{\partial x}{\partial v})^{2}+(\frac{\partial y}{\partial v})^{2}+(\frac{\partial z}{\partial v})^{2} \\
	    & F=\frac{\partial \vec{f}}{\partial u}\cdot \frac{\partial \vec{f}}{\partial v}
	    =\frac{\partial x}{\partial u}\frac{\partial x}{\partial v}+\frac{\partial y}{\partial u}\frac{\partial y}{\partial v}+\frac{\partial z}{\partial u}\frac{\partial z}{\partial v}
	\end{align*}

则曲面的面积为

.. math::
	\begin{align*}
	    S=\iint\limits_{D}\sqrt{EG-F^{2}}\mathrm{d}u\mathrm{d}v
	\end{align*}



对于一些特殊的曲面参数表示可以得到简化：

- 设曲面 :math:`\Sigma` 的方程为 :math:`z=z(x,y)` ，则面积为

.. math::
	\begin{align}
	S=\iint\limits_{D}\sqrt{1+(\frac{\partial z}{\partial x})^{2}+(\frac{\partial z}{\partial y})^{2}}\mathrm{d}x\mathrm{d}y
	\end{align}

- 设曲面 :math:`\Sigma` 的方程为 :math:`x=x(y,z)` ，则面积为

.. math::
	\begin{align}
	S=\iint\limits_{D}\sqrt{1+(\frac{\partial x}{\partial y})^{2}+(\frac{\partial x}{\partial z})^{2}}\mathrm{d}y\mathrm{d}z
	\end{align}

- 设曲面 :math:`\Sigma` 的方程为 :math:`y=y(x,z)` ，则面积为

.. math::
	\begin{align}
	S=\iint\limits_{D}\sqrt{1+(\frac{\partial y}{\partial x})^{2}+(\frac{\partial y}{\partial z})^{2}}\mathrm{d}x\mathrm{d}z
	\end{align}





曲线积分与曲面积分
==================


第一类曲线积分
--------------


定义 : 
    假设 :math:`L\subset \mathbb{R}^{3}` 为空间曲线，对任意的整数 :math:`n\geqslant 1` 将 :math:`L` 分割成 :math:`n` 段，定义 :math:`f` 在曲线 :math:`L` 上的第一类曲线积分为

.. math::
	\begin{align*}
	    \int_{L}f(x,y,z)\mathrm{d}\ell=\lim_{d\to 0}\sum_{j=1}^{n}f(X_{j})|\overline{P_{j-1}P_{j}}|
	\end{align*}


若 :math:`L\subset \mathbb{R}^{2}` ，可将之看成 :math:`\mathbb{R}^{3}` 中的曲线，由此定义的第一类曲线积分记作 :math:`\int_{L}f(x,y)\mathrm{d}\ell` ，该曲线积分给出了柱面

.. math::
	\begin{align*}
	    z=f(x,y),\quad (x,y)\in L
	\end{align*}

的面积。


定理 : 
    假设 :math:`L\subset \mathbb{R}^{3}` 为分段光滑曲线，点 :math:`X\in L` 处的密度为 :math:`\rho(X)` ，设 :math:`L` 的质心为 :math:`(\bar{x},\bar{y},\bar{z})` ，则

.. math::
	\begin{align*}
	    & \bar{x}=\frac{\int_{L}x\rho(x,y,z)\mathrm{d}\ell}{\int_{L}\rho(x,y,z)\mathrm{d}\ell} \\
	    & \bar{y}=\frac{\int_{L}y\rho(x,y,z)\mathrm{d}\ell}{\int_{L}\rho(x,y,z)\mathrm{d}\ell} \\
	    & \bar{z}=\frac{\int_{L}z\rho(x,y,z)\mathrm{d}\ell}{\int_{L}\rho(x,y,z)\mathrm{d}\ell}
	\end{align*}




定理 : 
    设分段光滑曲线 :math:`L` 的参数方程为

.. math::
	\begin{align*}
	    \left\{\begin{array}{lll}
	        x=x(t)   \\
	        y=y(t)   \\
	        z=z(t)
	    \end{array}\right. ,
	    \quad t\in[\alpha,\beta]
	\end{align*}

则其弧微分为

.. math::
	\begin{align*}
	    \mathrm{d}\ell=\sqrt{\big(x'(t)\big)^{2}+\big(y'(t)\big)^{2}+\big(z'(t)\big)^{2}}\mathrm{d}t
	\end{align*}

从而有

.. math::
	\begin{align*}
	    \int_{L}f(x,y,z)\mathrm{d}\ell=
	    \int_{\alpha}^{\beta}f\big(x(t),y(t),z(t)\big)\sqrt{\big(x'(t)\big)^{2}+\big(y'(t)\big)^{2}+\big(z'(t)\big)^{2}}\mathrm{d}t
	\end{align*}



若曲线 :math:`L\subset \mathbb{R}^{2}` 由方程 :math:`y=y(x),~x\in[a,b]` 给出，则有

.. math::
	\begin{align*}
	    \int_{L}f(x,y)\mathrm{d}\ell=\int_{a}^{b}f\big(x,y(x)\big)\sqrt{1+\big(y'(x)\big)^{2}}\mathrm{d}x
	\end{align*}

若曲线 :math:`L\subset \mathbb{R}^{2}` 由方程 :math:`x=x(y),~y\in[c,d]` 给出，则有

.. math::
	\begin{align*}
	    \int_{L}f(x,y)\mathrm{d}\ell=\int_{c}^{d}f\big(x(y),y\big)\sqrt{\big(x'(y)\big)^{2}+1}\mathrm{d}y
	\end{align*}




第一类曲面积分
--------------


定理 : 
    设分片光滑曲面 :math:`S` 的参数方程为

.. math::
	\begin{align*}
	    \left\{\begin{array}{lll}
	        x=x(u,v)   \\
	        y=y(u,v)   \\
	        z=z(u,v)
	    \end{array}\right.  ,
	    \quad (u,v)\in D
	\end{align*}

其中 :math:`D\subset \mathbb{R}^{2}` 为Jordan可测集，则面积微元为

.. math::
	\begin{align*}
	    \mathrm{d}\sigma=\sqrt{EG-F^{2}}\mathrm{d}u\mathrm{d}v
	\end{align*}

其中

.. math::
	\begin{align*}
	    & E=\Big(\frac{\partial x}{\partial u}\Big)^{2}+\Big(\frac{\partial y}{\partial u}\Big)^{2}+\Big(\frac{\partial z}{\partial u}\Big)^{2} \\
	    & G=\Big(\frac{\partial x}{\partial v}\Big)^{2}+\Big(\frac{\partial y}{\partial v}\Big)^{2}+\Big(\frac{\partial z}{\partial v}\Big)^{2} \\
	    & F=\frac{\partial x}{\partial u}\frac{\partial x}{\partial v}+\frac{\partial y}{\partial u}\frac{\partial y}{\partial v}+\frac{\partial z}{\partial u}\frac{\partial z}{\partial v}
	\end{align*}

于是有

.. math::
	\begin{align*}
	    \iint\limits_{S}f(x,y,z)\mathrm{d}\sigma=\iint\limits_{D}f\big(x(u,v),y(u,v),z(u,v)\big)\sqrt{EG-F^{2}}\mathrm{d}u\mathrm{d}v
	\end{align*}


特别地，若曲面 :math:`S` 由方程 :math:`z=z(x,y),~(x,y)\in D` 给出，则有

.. math::
	\begin{align*}
	    \iint\limits_{S}f(x,y,z)\mathrm{d}\sigma=\iint\limits_{D}f\big(x,y,z(x,y)\big)\sqrt{1+\Big(\frac{\partial z}{\partial x}\Big)^{2}+\Big(\frac{\partial z}{\partial y}\Big)^{2}}\mathrm{d}x\mathrm{d}y
	\end{align*}



第二类曲线积分
--------------


定义 : 第二类曲线积分
    将空间曲线 :math:`L` 分割成 :math:`n` 小段，记

.. math::
	\begin{align*}
	    P_{j}=(x_{j},y_{j},z_{j})~(0\leqslant j \leqslant n),
	    \quad \vec{\ell}=(x,y,z),
	    \quad d=\max\limits_{1\leqslant j\leqslant n}|\overline{P_{j-1}P_{j}} |
	\end{align*}

定义向量值函数 :math:`\vec{F}` 沿曲线 :math:`L` 由点 :math:`A` 到点 :math:`B` 的第二列曲线积分为

.. math::
	\begin{align*}
	    & \quad  \int_{L(A)}^{(B)}\vec{F}(\vec{\ell} )\cdot \mathrm{d}\vec{\ell}
	    =\lim\limits _{d\to 0} \sum\limits _{j=1}^{n}\vec{F}(X_{j}) \cdot \overrightarrow{P_{j-1}P_{j}} \\
	    &=\lim\limits _{d\to 0}\sum\limits _{j=1}^{n}\Big(F_{1}(X_{j})(x_{j}-x_{j-1})+F_{2}(X_{j})(y_{j}-y_{j-1})+F_{3}(X_{j})(z_{j}-z_{j-1})\Big)
	\end{align*}



曲线积分可以写成

.. math::
	\begin{align*}
	    \int_{L(A)}^{(B)}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
	    =\int_{L(A)}^{(B)}F_{1}(x,y,z)\mathrm{d}x+\int_{L(A)}^{(B)}F_{2}(x,y,z)\mathrm{d}y+\int_{L(A)}^{(B)}F_{3}(x,y,z)\mathrm{d}z
	\end{align*}

若 :math:`L\subset \mathbb{R}^{2}` 为平面曲线，则可写成

.. math::
	\begin{align*}
	    \int_{L(A)}^{(B)}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
	    =\int_{L(A)}^{(B)}F_{1}(x,y)\mathrm{d}x+\int_{L(A)}^{(B)}F_{2}(x,y)\mathrm{d}y
	\end{align*}



第二类曲线积分的性质
^^^^^^^^^^^^^^^^^^^^

对于只涉及到被积函数的性质，第二类曲线积分与定积分相应的性质类似。

而涉及积分路径的性质有：

- 路径的有向性：
  
.. math::
    \begin{align*}
        \int_{L(A)}^{(B)}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
        =-\int_{L(B)}^{(A)}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
    \end{align*}

- 对路径的可加性：设 :math:`A_{1},A_{2},A_{3}\in L` ，则
  
.. math::
    \begin{align*}
        \int_{L(A_{1})}^{(A_{3})}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
        =\int_{L(A_{1})}^{(A_{2})}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}+\int_{L(A_{2})}^{(A_{3})}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
    \end{align*}
  
- 若 :math:`L` 为封闭曲线，规定其逆时针方向为正向，此时考虑“日”字形曲线结构，有
  
.. math::
    \begin{align*}
        \oint_{L^{+}}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
        =\oint_{L_{1}^{+}}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}+\oint_{L_{2}^{+}}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
    \end{align*}




第二类曲线积分的计算
^^^^^^^^^^^^^^^^^^^^

定理 : 
    设分段光滑曲线 :math:`L` 的参数方程为

.. math::
	\begin{align*}
	    \left\{\begin{array}{lll}
	        x=x(t)   \\
	        y=y(t)   \\
	        z=z(t)
	    \end{array}\right. ,~t\in [\alpha,\beta]
	\end{align*}

其中 :math:`A,B` 所对应的参数分别为 :math:`\alpha,\beta` ，则

.. math::
	\begin{align*}
	    \int_{L(A)}^{(B)}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
	    =&\int_{\alpha}^{\beta}F_{1}\big(x(t),y(t),z(t)\big)x'(t)\mathrm{d}t
	    +\int_{\alpha}^{\beta}F_{2}\big(x(t),y(t),z(t)\big)y'(t)\mathrm{d}t \\
	    &+\int_{\alpha}^{\beta}F_{3}\big(x(t),y(t),z(t)\big)z'(t)\mathrm{d}t
	\end{align*}

特别地，如果 :math:`L\subset\mathbb{R}^{2}` 为平面曲线且其方程为 :math:`y=y(x)` ，而 :math:`A,B` 的横坐标分别为 :math:`a,b` ，则

.. math::
	\begin{align*}
	    \int_{L(A)}^{(B)}\vec{F}(\vec{\ell})\cdot \mathrm{d}\vec{\ell}
	    =\int_{a}^{b}F_{1}\big(x,y(x)\big)\mathrm{d}x+\int_{a}^{b}F_{2}\big(x,y(x)\big)y'(x)\mathrm{d}x
	\end{align*}


第一、二类曲线积分之间的关系
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

定理 : 
    设路径 :math:`L\subset \mathbb{R}^{3}` 是起点为 :math:`A` ，终点为 :math:`B` 的分段光滑曲线，其参数方程为

.. math::
	\begin{align*}
	    \vec{\ell}(t)=\Big(x(t),y(t),z(t)\Big),~t\in[a,b]
	\end{align*}

而 :math:`\vec{F}=(F_{1},F_{2},F_{3})` ，设 :math:`L` 在点 :math:`P` 处的单位切向量为

.. math::
	\begin{align*}
	    \vec{\tau}^{0}(P)=\Big(\cos\alpha ,~\cos\beta,~\cos\gamma \Big) 
	\end{align*}

其中

.. math::
	\begin{align*}
	    & \cos\alpha \Big(\vec{\ell}(t)\Big)=\frac{x'(t)}{\sqrt{\big(x'(t)\big)^{2}+\big(y'(t)\big)^{2}+\big(z'(t)\big)^{2}} }  \\
	    & \cos\beta \Big(\vec{\ell}(t)\Big)=\frac{y'(t)}{\sqrt{\big(x'(t)\big)^{2}+\big(y'(t)\big)^{2}+\big(z'(t)\big)^{2}} }  \\
	    & \cos\gamma  \Big(\vec{\ell}(t)\Big)=\frac{z'(t)}{\sqrt{\big(x'(t)\big)^{2}+\big(y'(t)\big)^{2}+\big(z'(t)\big)^{2}} }  
	\end{align*}

于是第一类曲线积分和第二类曲线积分之间满足

.. math::
	\begin{align*}
	    \int_{L(A)}^{(B)}\vec{F} (\vec{\ell} )\cdot\mathrm{d}\vec{\ell}=\int_{L}(\vec{F}\cdot \vec{\tau}^{0}  )_{(x,y,z)}\mathrm{d}\ell=\int_{a}^{b}(\vec{F}\cdot\vec{\tau}  )\mathrm{d}t
	\end{align*}

其中 :math:`\vec{\tau}=\big(x'(t),y'(t),z'(t)\big)` 。




第二类曲面积分
--------------

曲面的定向
^^^^^^^^^^


定义 : 
    设 :math:`S\subset \mathbb{R}^{3}` 为 :math:`\mathscr{C}^{(1)}` 光滑正则曲面，参数方程为

.. math::
	\begin{align*}
	\left \{ \begin{array}{lll}
	x=x(u,v) \\
	y=y(u,v) \\
	z=z(u,v)
	\end{array} \right. ,
	\quad (u,v)\in D\subset \mathbb{R}^{2} 
	\end{align*}

其中 :math:`x(u,v),~y(u,v),~z(u,v)` 连续可微且法向量

.. math::
	\begin{align*}
	\vec{n}_{\pm}=\pm 
	\begin{pmatrix}
	\frac{\partial x}{\partial u} \\
	\frac{\partial y}{\partial u} \\
	\frac{\partial z}{\partial u}
	\end{pmatrix} \times 
	\begin{pmatrix}
	\frac{\partial x}{\partial v} \\
	\frac{\partial y}{\partial v} \\
	\frac{\partial z}{\partial v}
	\end{pmatrix}=\pm 
	\begin{pmatrix}
	\frac{D(y,z)}{D(u,v)}  \\
	\frac{D(z,x)}{D(u,v)}  \\
	\frac{D(x,y)}{D(u,v)} 
	\end{pmatrix}.
	\end{align*}

如果在任意点 :math:`P\in S` 处可确定单位法方向 :math:`\vec{n}^{0} (P)` 使得 :math:`\vec{n}^{0}` 在连接 :math:`P_{0}` 的任意的光滑曲线上连续，则称 :math:`S` 为可定向曲面。




第二类曲面积分的概念
^^^^^^^^^^^^^^^^^^^^

定义 : 第二类曲面积分
    在分割的小块 :math:`S_{j}` 上取点 :math:`X_{j}` ，并令 :math:`\vec{S}_{j}=\vec{n}_{S}^{0}(X_{j})|S_{j}|` ，记 :math:`d` 为所有 :math:`S_{j}` 的直径中的最大者，定义 :math:`\vec{F}` 在定向曲面 :math:`S^{+}` 上的第二类曲面积分为

.. math::
	\begin{align*}
	    \iint\limits _{S^{+}}\vec{F}(x,y,z) \cdot \mathrm{d}\vec{\sigma }=\lim\limits _{d\to 0}\sum\limits _{j=1}^{k}\vec{F}(X_{j})\cdot \vec{S}_{j}   
	\end{align*}



第一、二类曲面积分之间的关系
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

第一类曲面积分与第二类积分曲面积分满足关系

.. math::
	\begin{align*}
	    \iint\limits _{S^{+}}\vec{F}(x,y,z)\cdot \mathrm{d}\vec{\sigma}
	    =\iint\limits _{S^{+}}\Big(F_{1}(x,y,z)\mathrm{d}y\wedge \mathrm{d}z
	    +F_{2}(x,y,z)\mathrm{d}z\wedge \mathrm{d}x
	    +F_{3}(x,y,z)\mathrm{d}x\wedge \mathrm{d}y\Big)
	\end{align*}

其中

.. math::
	\begin{align*}
	    \mathrm{d}y\wedge \mathrm{d}z=\cos \alpha \mathrm{d}\sigma
	    \quad
	    \mathrm{d}z\wedge \mathrm{d}x=\cos\beta\mathrm{d}\sigma
	    \quad
	    \mathrm{d}x\wedge \mathrm{d}y=\cos \gamma \mathrm{d}\sigma
	\end{align*}

同时，在形式上可以认为 :math:`\mathrm{d}\vec{\sigma }=\vec{n}_{S(x,y,z)}^{0}\mathrm{d}\sigma` 。




第二类曲面积分的计算
^^^^^^^^^^^^^^^^^^^^^^

定理 : 
    设 :math:`S\subset \mathbb{R}^{3}` 为 :math:`\mathscr{C}^{(1)}` 光滑正则曲面，参数方程为

.. math::
	\begin{align*}
	\left \{ \begin{array}{lll}
	x=x(u,v) \\
	y=y(u,v) \\
	z=z(u,v)
	\end{array} \right. ,
	\quad (u,v)\in D\subset \mathbb{R}^{2} 
	\end{align*}

其中 :math:`D` 为Jordan可测， :math:`x,y,z` 为连续可微，且

.. math::
	\begin{align*}
	\vec{n}=
	\begin{pmatrix}
	\frac{\partial x}{\partial u} \\
	\frac{\partial y}{\partial u} \\
	\frac{\partial z}{\partial u}
	\end{pmatrix} \times 
	\begin{pmatrix}
	\frac{\partial x}{\partial v} \\
	\frac{\partial y}{\partial v} \\
	\frac{\partial z}{\partial v}
	\end{pmatrix}=
	\begin{pmatrix}
	\frac{D(y,z)}{D(u,v)}  \\
	\frac{D(z,x)}{D(u,v)}  \\
	\frac{D(x,y)}{D(u,v)} 
	\end{pmatrix}\ne \vec{0} 
	\end{align*}

于是 :math:`\mathrm{d}\vec{\sigma }=\pm \vec{n}_{(u,v)}\mathrm{d}u\mathrm{d}v` ，由此可得

.. math::
	\begin{align*}
	    \iint\limits _{S^{+}}\vec{F}(x,y,z) \cdot \mathrm{d}\vec{\sigma}
	    =\pm\iint\limits _{D}\vec{F}\big(\vec{r}(u,v)\big)\cdot \vec{n}(u,v)\mathrm{d}u\mathrm{d}v
	\end{align*}





由混合积 :math:`\vec{F}\cdot(\vec{r}'_{u}\times \vec{r}'_{v})` 的表达式可知

.. math::
	\begin{align*}
	    \iint\limits _{S^{+}}\vec{F}(x,y,z) \cdot\mathrm{d}\vec{\sigma}
	    =\pm\iint\limits _{D}
		\begin{vmatrix}
		 F_{1} & F_{2} & F_{3} \\
		 \frac{\partial x}{\partial u} & \frac{\partial y}{\partial u} & \frac{\partial z}{\partial u} \\
		 \frac{\partial x}{\partial v} & \frac{\partial y}{\partial v} & \frac{\partial z}{\partial v}
		\end{vmatrix}_{(u,v)}\mathrm{d}u\mathrm{d}v
	\end{align*}

形式上有

.. math::
	\begin{align*}
	    & \mathrm{d}y\wedge \mathrm{d}z=\pm\frac{D(y,z)}{D(u,v)}\mathrm{d}u\mathrm{d}v  \\
	    & \mathrm{d}z\wedge \mathrm{d}x=\pm\frac{D(z,x)}{D(u,v)}\mathrm{d}u\mathrm{d}v  \\
	    & \mathrm{d}x\wedge \mathrm{d}y=\pm\frac{D(x,y)}{D(u,v)}\mathrm{d}u\mathrm{d}v
	\end{align*}


计算第二类曲面积分的步骤：

1. 给出定向曲面 :math:`S^{+}` 的参数方程，有时需要将 :math:`S` 分片，在每片上给出各自的参数表示；
2. 在曲面上任取一个定点 :math:`P_{0}` ，并将相应的参数记作 :math:`(u_{0},v_{0})` ，计算 :math:`S^{+}` 在该点处的方向向量；
3. 利用参数方程来计算法向量
   
.. math::
    \begin{align*}
        \vec{n}_{(u_{0},v_{0})} =\vec{r}'_{u}\times \vec{r}'_{v}\bigg|_{(u_{0},v_{0})} 
    \end{align*}

4. 将 :math:`\vec{n}_{(u_{0},v_{0})}` 与 :math:`S^{+}` 在点 :math:`P_{0}` 处的方向进行比较，以便确定二重积分前的正负号。






平面向量场Green公式
-------------------

Green公式
^^^^^^^^^

定义 : 单连通集
    若 :math:`\Omega` 中任意闭曲线所围的区域仍包含在 :math:`\Omega` 中，也即 :math:`\Omega` 中的任意闭曲线可连续地收缩成为一点，则称 :math:`\Omega \subset \mathbb{R}^{2}` 为单连通集。



定义 : 散度和旋度
    对于平面向量场 :math:`\vec{F}(x,y)=\begin{pmatrix}F_{1}(x,y) \\ F_{2}(x,y)\end{pmatrix}` ，其在点 :math:`(x,y)` 处的散度和旋度分别定义为

.. math::
	\begin{align*}
	    \operatorname{div}\vec{F}=\frac{\partial F_{1}}{\partial x}+\frac{\partial F_{2}}{\partial y}  
	    \quad
	    \operatorname{rot}\vec{F}=\frac{\partial F_{2}}{\partial x}-\frac{\partial F_{1}}{\partial y} 
	\end{align*}


.. note:: 

	- 矢量的散度的物理含义为：该矢量离开指定封闭空间的通量，也是通量强度。
	- 矢量的旋度的物理含义为：该矢量在指定空间内进入和离开的总和，也是环流量强度。




形式上可以视为

.. math::
	\begin{align*}
	\operatorname{div}\vec{F}=
	\begin{pmatrix}
	\frac{\partial }{\partial x} \\
	\frac{\partial }{\partial y}
	\end{pmatrix}\cdot 
	\begin{pmatrix}
	F_{1} \\
	F_{2}
	\end{pmatrix}
	\quad
	 \operatorname{rot}\vec{F}=
	\begin{vmatrix}
	\frac{\partial }{\partial x} & F_{1} \\
	\frac{\partial }{\partial y} & F_{2}
	\end{vmatrix}
	\end{align*}



定义 : 
    对于区域 :math:`\Omega` 的边界曲线 :math:`\partial\Omega` ，其切向量定义为

.. math::
	\begin{align*}
	\vec{T}^{0} \mathrm{d}\ell=
	\binom{\mathrm{d}x}{\mathrm{d}y} 
	\end{align*}

其法向量定义为

.. math::
	\begin{align*}
	\vec{n}^{0}\mathrm{d}\ell=
	\binom{\mathrm{d}y}{-\mathrm{d}x}  
	\end{align*}



定理 : Green公式
    假设 :math:`\Omega \subset \mathbb{R}^{2}` 为单连通的有界闭区域，其边界 :math:`\partial \Omega` 为分段光滑闭曲线，该曲线的正向为逆时针方向，记 :math:`\vec{n}^{0}` 为 :math:`\partial\Omega` 的单位法向量。如果 :math:`\vec{F}=(F_{1},F_{2})^{T}:\Omega \to \mathbb{R}^{2}` 为连续可导的向量值函数，则

.. math::
	\begin{align*}
	 & \iint\limits _{\Omega }\operatorname{div}\vec{F}\mathrm{d}x\mathrm{d}y = \oint_{\partial \Omega }\vec{F}\cdot\vec{n}^{0}\mathrm{d}\ell \\
	 & \iint\limits _{\Omega }\operatorname{rot}\vec{F}\mathrm{d}x\mathrm{d}y =\oint_{\partial \Omega }\vec{F}\cdot \vec{T}^{0}\mathrm{d}\ell
	\end{align*}

形式上可以视为

.. math::
	\begin{align*}
	    & \iint\limits _{\Omega}
		\begin{pmatrix}
		\frac{\partial }{\partial x} \\
		\frac{\partial }{\partial y}
		\end{pmatrix}\cdot 
		\begin{pmatrix}
		F_{1} \\
		F_{2}
		\end{pmatrix}\mathrm{d}x\mathrm{d}y
		=\oint_{\partial\Omega}
		\begin{vmatrix}
		 F_{1} & \mathrm{d}x \\
		 F_{2} & \mathrm{d}y
		\end{vmatrix} \\
		& \iint\limits _{\Omega }
		\begin{vmatrix}
		 \frac{\partial }{\partial x} & F_{1} \\
		 \frac{\partial }{\partial y} & F_{2}
		\end{vmatrix}\mathrm{d}x\mathrm{d}y
		=\oint_{\partial \Omega }
		\begin{pmatrix}
		F_{1} \\
		F_{2}
		\end{pmatrix}\cdot 
		\begin{pmatrix}
		\mathrm{d}x \\
		\mathrm{d}y
		\end{pmatrix}
	\end{align*}



.. note:: 需要特别指出的是，使用Green公式时，曲线的正向应该是逆时针方向。如果曲线沿顺时针方向，那么需要添加一个负号。




定理 : 由Green公式计算曲面面积
    设 :math:`L\subset \mathbb{R}^{2}` 为光滑的简单闭曲线，所围的区域为 :math:`\Omega` ，而 :math:`L` 的单位外法向量为 :math:`\vec{n}^{0}` ，则所围区域的面积为

.. math::
	\begin{align*}
	    |\Omega|=\frac{1}{2}\oint_{L}(x,y)^{T}\cdot\vec{n}^{0} \mathrm{d}\ell
	    ==\frac{1}{2}\oint_{L}
	    \begin{pmatrix}
		x \\
		y \\
		\end{pmatrix} \cdot 
		\begin{pmatrix}
		\mathrm{d}y \\
		-\mathrm{d}x
		\end{pmatrix}
	\end{align*}

也即

.. math::
	\begin{align*}
	    |\Omega |=\frac{1}{2}\int_{a}^{b}\Big(x(t)y'(t)-y(t)x'(t)\Big)\mathrm{d}t
	\end{align*}



对于复连通区域，规定沿其边界的正方向行走时，上述区域在其边界的左边，则有：


定理 : 
    假设 :math:`\Omega \subset \mathbb{R}^{2}` 为复连通的有界闭区域，其边界 :math:`\partial \Omega` 为分段光滑闭曲线，且其方向取正向。若 :math:`\vec{F}=(F_{1},F_{2})^{T}:\Omega \to \mathbb{R}^{2}` 为连续可导的向量值函数，则

.. math::
	\begin{align*}
	    \oint_{\partial \Omega ^{+}}F_{1}\mathrm{d}y-F_{2}\mathrm{d}x=\iint\limits _{\Omega }\Big(\frac{\partial F_{1}}{\partial x}+\frac{\partial F_{2}}{\partial y}\Big)\mathrm{d}x\mathrm{d}y
	\end{align*}

.. math::
	\begin{align*}
	    \oint_{\partial \Omega ^{+}}F_{1}\mathrm{d}x+F_{2}\mathrm{d}y=\iint\limits _{\Omega }\Big(\frac{\partial F_{2}}{\partial x}-\frac{\partial F_{1}}{\partial y}\Big)\mathrm{d}x\mathrm{d}y
	\end{align*}



平面第二类曲线积分与路径的无关性
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

定理 : 
    假设 :math:`\Omega \subset \mathbb{R}^{2}` 为单连通开区域，而函数 :math:`\vec{F}=(F_{1},F_{2}) ^{T}` 在 :math:`\Omega` 上连续可导。于是，下列叙述等价：

- :math:`\forall (x,y)\in \Omega` ，均有 :math:`\operatorname{rot}\vec{F}=0` ，也即 :math:`\frac{\partial F_{2}}{\partial x}\left ( x,y \right )=\frac{\partial F_{1}}{\partial y}\left ( x,y \right )` ;
- :math:`\forall A,B\in\Omega` ， :math:`\int_{L(A)}^{(B)}\vec{F}\cdot \mathrm{d}\vec{\ell}` 仅与 :math:`A,B` 有关，而与 :math:`\Omega` 中连接 :math:`A,B` 的分段光滑曲线 :math:`L` 无关；
- 存在函数 :math:`U:\Omega \to \mathbb{R}` 使得 :math:`\forall (x,y)\in \Omega` 均有
  
.. math::
    \begin{align*}
        \mathrm{d}U(x,y)=F_{1}(x,y)\mathrm{d}x+F_{2}(x,y)\mathrm{d}y
    \end{align*}


.. note:: 只有 :math:`(1)\Rightarrow (2)` 才需要单连通区域，可以找到反例： :math:`\frac{x\mathrm{d}y-y\mathrm{d}x}{x^{2}+y^{2}}` 与相应的 :math:`\oint\limits _{x^{2}+y^{2}=1}\frac{x\mathrm{d}y-y\mathrm{d}x}{x^{2}+y^{2}} =2\pi` 。




定理 : 
    设 :math:`\Omega \subset \mathbb{R}^{2}` 为开区域，函数 :math:`\vec{F} =(F_{1},F_{2})^{T}` 在 :math:`\Omega` 上连续，并且使得 :math:`F_{1}\mathrm{d}x+F_{2}\mathrm{d}y` 在 :math:`\Omega` 上有原函数 :math:`U` ，则 :math:`\forall (x_{1},y_{1}),(x_{2},y_{2})\in \Omega` 均有

.. math::
	\begin{align*}
	    \int_{(x_{1},y_{1})}^{(x_{2},y_{2})}F_{1}\mathrm{d}x+F_{2}\mathrm{d}y=U(x_{2},y_{2})-U(x_{1},y_{1})=U\bigg|_{(x_{1},y_{1})}^{(x_{2},y_{2})}
	\end{align*}




空间向量场、Gauss公式和Stokes公式
-----------------------------------


定理 : Gauss公式
    设 :math:`\Omega \subset \mathbb{R}^{3}` 为有界闭区域，其边界 :math:`\partial \Omega` 为分片光滑可定向曲面且以外侧为正向，而 :math:`\vec{F}=(F_{1},F_{2},F_{3})^{T}\in\mathscr{C}^{(1)}(\Omega )` ，则

.. math::
	\begin{align*}
	    \iint\limits_{\partial\Omega^{+}}\vec{F}\cdot\mathrm{d}\vec{\sigma} =\iiint\limits _{\Omega }\left ( \frac{\partial F_{1}}{\partial x}+\frac{\partial F_{2}}{\partial y}+\frac{\partial F_{3}}{\partial z} \right ) \mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{align*}

其中令 :math:`\operatorname{div}\vec{F}=\vec{\nabla}\cdot\vec{F}=\frac{\partial F_{1}}{\partial x}+\frac{\partial F_{2}}{\partial y}+\frac{\partial F_{3}}{\partial z}` 称为向量场 :math:`\vec{F}` 的散度。



.. note:: 

	将Green公式、Gauss公式与Stokes公式的统一起来可以得到

	.. math::
		\begin{align*}
		    & \oint\limits _{\partial \Omega }\vec{F}\cdot\vec{n}^{0}\mathrm{d}\ell =\iint\limits _{\Omega }\vec{\nabla}\cdot \vec{F}\mathrm{d}\sigma \\
		    & \oint\limits _{\partial \Omega }\vec{F}\cdot\mathrm{d}\vec{\ell}=\iint\limits _{\Omega } \vec{\nabla}\times   \vec{F}\mathrm{d}\sigma \\
		    & \iint\limits _{\partial \Omega^{+} }\vec{F} \cdot\vec{n}^{0}\mathrm{d}\sigma  =\iiint\limits _{\Omega }\vec{\nabla}\cdot \vec{F}\mathrm{d}\sigma \\
		    & \oint\limits _{\partial S^{+}}\vec{F}\cdot\mathrm{d}\vec{\ell} =\iint\limits _{S^{+}}\left (  \vec{\nabla}\times   \vec{F} \right ) \cdot\mathrm{d}\vec{\sigma}
		\end{align*}

	其中

	.. math::
		\begin{align*}
		    & \mathrm{d}\vec{\ell}=(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)^{T},
		    \quad
		    \vec{n}^{0}\mathrm{d}\ell=\left ( \mathrm{d}y,-\mathrm{d}x \right ) ^{T}  \\
		    & \mathrm{d}\vec{\sigma}=\vec{n}^{0}\mathrm{d}\sigma =
		    \begin{pmatrix}
		    \mathrm{d}y\wedge \mathrm{d}z \\
		    \mathrm{d}z\wedge \mathrm{d}y \\
		    \mathrm{d}x\wedge \mathrm{d}y
		    \end{pmatrix} \\
		    & \operatorname{div}\vec{F}=\vec{\nabla}\cdot\vec{F}=\frac{\partial F_{1}}{\partial x}+\frac{\partial F_{2}}{\partial y}+\frac{\partial F_{3}}{\partial z} \\
		    & \operatorname{rot}\vec{F}=\vec{\nabla}\times \vec{F}=
		    \begin{vmatrix}
		     i & \frac{\partial }{\partial x} & F_{1} \\
		     j & \frac{\partial }{\partial y} & F_{2}\\
		     k & \frac{\partial }{\partial z} & F_{3}
		    \end{vmatrix}
		\end{align*}







定理 : 积分路径无关性
    设 :math:`\Omega \subset \mathbb{R}^{3}` 为单连通区域，向量值函数 :math:`\vec{F}=(F_{1},F_{2},F_{3})^{T}\in\mathscr{C}^{(1)}(\Omega )` ，则下列结论等价：

- :math:`\operatorname{rot}\vec{F}=\vec{\nabla}\times \vec{F}=\vec{0}` ；
- 对 :math:`\Omega` 中任意分段光滑闭曲线 :math:`L` ，都有 :math:`\oint_{L}\vec{F}\cdot\mathrm{d}\vec{\ell}=0` ；
- :math:`\forall A,B\in\Omega` 以及 :math:`\Omega` 中连接 :math:`A,B` 的分段光滑曲线 :math:`L` ，积分 :math:`\int_{L(A)}^{(B)}\vec{F}\cdot\mathrm{d}\vec{\ell}` 与 :math:`L` 的选取无关；
- 存在函数 :math:`U:\Omega \to \mathbb{R}` 使得
  
.. math::
    \begin{align*}
        \mathrm{d}U=F_{1}\mathrm{d}x+F_{2}\mathrm{d}y+F_{3}\mathrm{d}z
    \end{align*}

此时有

.. math::
	\begin{align*}
	    \int_{L(A)}^{(B)}\vec{F}\cdot\mathrm{d}\vec{\ell}=U(B)-U(A)=U\bigg|_{A}^{B}
	\end{align*}





定义 : 
    若用 :math:`\vec{i},\vec{j},\vec{k}` 表示 :math:`\mathbb{R}^{3}` 的标准基底，则

.. math::
	\begin{align*}
	    \vec{\nabla}=\frac{\partial }{\partial x}\vec{i}+\frac{\partial }{\partial y}\vec{j}+\frac{\partial }{\partial z}\vec{k}    
	\end{align*}

于是有

.. math::
	\begin{align*}
	    \text{梯度：}& \overrightarrow{\operatorname{grad} }f=\vec{\nabla}f=\frac{\partial f}{\partial x}\vec{i}+\frac{\partial f}{\partial y}\vec{j}+\frac{\partial f}{\partial z}\vec{k}    \\
	    \text{散度：}& \operatorname{div}\vec{F}=\vec{\nabla}\cdot\vec{F}=\frac{\partial F_{1}}{\partial x}+\frac{\partial F_{2}}{\partial y}+\frac{\partial F_{3}}{\partial z}   \\
	    \text{旋度：}& \operatorname{rot}\vec{F}=\vec{\nabla}\times \vec{F}     
	\end{align*}



定义 : 
    设 :math:`\vec{F}=(F_{1},F_{2},F_{3})^{T}` 为向量值函数.

- 若存在 :math:`U` 使得 :math:`\vec{\nabla}U=\vec{F}` ，则称 :math:`\vec{F}` 为梯度场或有势场或保守场，函数 :math:`U` 称为 :math:`\vec{F}` 的势函数.
- 若存在向量值函数 :math:`\vec{V}` 使得 :math:`\vec{F}=\vec{\nabla}\times \vec{V}` ，则称 :math:`\vec{F}` 为旋度场.
- 若 :math:`\vec{\nabla}\cdot\vec{F}=0` ，则称 :math:`\vec{F}` 为无源场.
- 若 :math:`\vec{\nabla }\times \vec{F}=\vec{0}` ，则称 :math:`\vec{F}` 为无旋场. 
  


定理 : 
    设 :math:`\Omega \subset \mathbb{R}^{3}` 为单连通区域， :math:`\vec{F}:\Omega \to \mathbb{R}^{3}` 为连续可导向量值函数.

- :math:`\vec{\nabla}\times \vec{F}=\vec{0}` 当且仅当有函数 :math:`U` 使 :math:`\vec{\nabla}U=\vec{F}` ，即向量场无旋当且仅当为梯度场.
- :math:`\vec{\nabla}\cdot\vec{F}=0` 当且仅当存在向量值函数 :math:`\vec{V}` 使得 :math:`\vec{\nabla}\times \vec{V}=\vec{F}` ，即向量场无源当且仅当为旋度场.





