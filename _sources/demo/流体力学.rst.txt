********
流体力学
********

流体的基本特性就是易流动性。流体在静止时不能承受剪切力以抵抗剪切变形，只有在运动状态下，当流体质点之间有相对运动时，才能抵抗剪切形变形。只要有剪切力的作用，不论剪切力多么微小，流体就不会静止下来，将产生连续不断的变形，这就是流体易流动性的表现。

流体的真实结构时由彼此之间有间隙并在进行复杂的微观运动的大量流体分子所组成的凝聚态。从微观上看，流体是不连续体，其分子运动是不规则的。而从宏观上看，流体的运动特性可以呈现出空间上的连续性，这些流体分子行为的统计平均值是稳定的。这种宏观上足够小、微观上足够大的微体积内所有的流体分子组成的流体团称为 **流体质点** 。

**连续介质假设** 认为，流体质点只占据一个空间几何点，流体区域由流体质点连续组成，占满空间而没有间隙，而且定义在流体质点上的物理性质和运动要素是空间连续变化的。连续介质假设还与时间尺度相关联，我们可以在宏观上足够短、微观上足够长的时间段里得到一个流体质点内分子行为的统计平均值，宏观上把这个足够短的微小的时间段看成是一个时刻，这样流体物理性质和运动要素即可视为在时间上也是连续变化的。

基本概念
========

惯性
------

惯性是物体所具有的反抗原有运动状态的物理性质，度量其的物理量为质量。当物体受到其他物体的作用力而改变运动状态时，此物体反抗改变原有运动状态而 **作用于施力物体上的反作用力** 称为 **惯性力** 。设物体质量为 :math:`m` ，加速度为 :math:`\mathbf{a}` ，则惯性力 :math:`\mathbf{F}` 为

.. math::
	\begin{align}
	\mathbf{F} = -m\mathbf{a}
	\end{align}

负号表示惯性力方向与物体的加速度方向相反。

流体单位体积内所具有的质量称为密度，以 :math:`\rho` 表示，单位为 :math:`\mathrm{kg/m^{3}}` 。对于均质流体，设其体积为 :math:`V` ，质量为 :math:`m` ，则密度为 :math:`\rho = \frac{m}{V}` 。对于非均质流体，根据连续介质假设，若流体微团的体积为 :math:`\Delta V` ，质量为 :math:`\Delta m` ，则密度为

.. math::
	\begin{align}
	\rho = \lim_{\Delta V \to 0} \frac{\Delta m}{\Delta V} 
	\end{align}

其中 :math:`\Delta V \to 0` 表示流体微团趋于流体质点。此时密度是定义在流体质点上的。

.. note:: 流体密度将随着温度和压强变化。液体的密度随温度和压强的变化很微小，在常温常压下可以视为常数；气体的密度随温度和压强的变化比较显著，涉及到流体的压缩性及膨胀性。在一个标准大气压下，空气和水的密度都是随温度升高而减小。




流体的粘滞性、粘性系数
-------------------------

粘滞性和牛顿内摩擦定律
^^^^^^^^^^^^^^^^^^^^^^^^^

流体具有易流动性，静止时不能承受剪切力以抵抗剪切形变，但是在运动状态下，流体就具有抵抗剪切变形的能力，这就是 **粘滞性** ，简称粘性。在剪切变形的过程中，流体层之间发生相对运动，由于流体具有粘滞性，流体层之间会出现成对的切力（内摩擦力）， 其阻碍了相对运动，从而影响流体的运动状况和变形的速度。

.. note:: 流体的粘滞性导致流体在运动过程中克服内摩擦力而做功，是流体运动中机械能量损失的根源。

定理 : 牛顿内摩擦定律
    流体沿某一固体表面作平行直线运动，流层间内摩擦力 :math:`T` 的大小与流体性质有关，并与流速梯度 :math:`\frac{\mathrm{d} u}{\mathrm{d} y}` 和接触面积 :math:`A` 有关，而与接触面上的压力无关：

.. math::
	\begin{align}
	T = \mu A \frac{\mathrm{d} u}{\mathrm{d} y}
	\end{align}

其中 :math:`\mu` 为表征流体粘滞性的比例系数，称为 **动力粘滞系数** 或 **动力粘度** ，单位为 :math:`\mathrm{Pa \cdot s}` ； :math:`A` 为流层间的接触面积； :math:`\frac{\mathrm{d} u}{\mathrm{d} y}` 为流体运动横向速度梯度。

如果用 :math:`\tau` 来表示单位面积上的内摩擦力，即切应力，则有

.. math::
	\begin{align}
	\tau = \frac{T}{A} = \mu \frac{\mathrm{d} u}{\mathrm{d} y}
	\end{align}

流体的粘滞性还可以用 **运动粘滞系数** :math:`\nu` 表示，或简称 **运动粘度** ，单位为 :math:`\mathrm{m^{2}/s}` ，它与动力粘性系数的关系为

.. math::
	\begin{align}
	\nu = \frac{\mu}{\rho} 
	\end{align}

.. note:: 

	粘性与流体种类相关，且随其温度和压力的而变化。对于常见的流体如水、空气等，由于粘性随压力的变化不大，一般可以忽略其变化，因此温度是影响流体粘性的主要因素。不过，温度对气体和液体的粘性影响规律不同，可以从分子微观运动的角度来解释：粘性是流体分子间的吸引力和分子不规则热运动而产生动量交换的结果，温度升高，分子间的引力降低，分子间热运动增强，动量交换率增大；而温度降低，分子间的引力增大，分子间热运动减弱，动量交换率减小。

	- 对于气体来说，分子间距较大，吸引力对粘性影响很小，而热运动产生的动量交换率随温度升高而加剧，因此气体的粘性随温度升高而加大。
	- 对于液体来说，由于其分子间距较小，吸引力其主要作用，因此液体的粘性随温度升高而降低。



理想流体
^^^^^^^^^^

在实际工程和某些理论研究中，有时可以不考虑粘性的影响，即切应力很小可以忽略，也就引入了没有粘滞性的流体 **理想流体** 的概念。对理想流体运动的分析成果可以近似反映粘性作用不大的实际流动情况。理想流体是一种假想的流体，如远离固体边壁边界层的流动，其剪切变形速度很小，切应力可以忽略，就可以将流体按理想流体处理。而在实际流动中，固体壁面边界层内的流体变形速度很大，一般不能忽略流体粘性作用。


牛顿流体与非牛顿流体
^^^^^^^^^^^^^^^^^^^^^^^

实际流体运动的切应力与剪切变形速度的关系并不都符合牛顿内摩擦定律。如果流体的粘滞系数 :math:`\mu` 值恒定不变，流体的切应力与剪切变形速度符合牛顿内摩擦定律，这类流体称为 **牛顿流体** 。其他不符合牛顿内摩擦定律的流体统称为 **非牛顿流体** ，可以区分为：

- 膨胀性流体：粘性系数不是常数，随剪切变形的增大而增大，如淀粉浆等属于这类流体。
- 伪塑性流体：粘性系数不是常数，随剪切变形的增大而减小，如橡胶液等属于这类流体。
- 理想宾汉流体：当切应力达到某一数值时才开始发生剪切变形，而切应力与剪切变形速度也是线性关系，如泥浆等属于这类流体。
  

流体的压缩性及膨胀性
----------------------

流体在压力的作用下会发生体积压缩变形，同时其内部将产生一种企图恢复原状的内力（弹性力）来抵抗体积压缩变形，在除去压力后能恢复原状，这种性质称为流体的 **压缩性** ，或称为 **弹性** 。

流体的压缩性的大小一般用 **体积压缩系数** 来表示。压缩系数是在一定温度下，单位压强作用下流体体积的相对减小值。由于压缩过程中流体质量保持不变，压缩系数也等于单位压强作用下流体密度的相对增加值，即

.. math::
	\begin{align}
	\alpha _{p} = - \frac{\frac{\mathrm{d} V}{V}}{\mathrm{d} p} = \frac{\frac{\mathrm{d} \rho}{\rho} }{\mathrm{d} p }  
	\end{align}

其中 :math:`\alpha_{p}` 为体积压缩系数， :math:`V` 为流体体积， :math:`p` 为压强， :math:`\rho` 为流体密度。


工程上也经常采用流体的 **体积弹性模量** :math:`K` 来表示流体的压缩性，它是体积压缩系数的倒数，即

.. math::
	\begin{align}
	K = \frac{1}{\alpha _{p}} = -V\frac{\mathrm{d} p}{\mathrm{d} V} = \rho \frac{\mathrm{d} p}{\mathrm{d} \rho}  
	\end{align}


在流体受热的情况下，体积膨胀，密度减小，温度下降则恢复原状，这种性质被称为流体的 **膨胀性** 。液体膨胀性用 **体积膨胀系数** :math:`\alpha _{V}` 表示，其定义为：在一定压强作用下，单位温度升高引起的体积变化率（或者反映密度的变化率），即

.. math::
	\begin{align}
	\alpha _{V} = \frac{\mathrm{dV}/V}{\mathrm{d} T} = - \frac{\mathrm{d} \rho/\rho}{\mathrm{d} T}  
	\end{align}

体积膨胀系数的单位为 :math:`\mathrm{K^{-1}}` ，它的大小反映了液体膨胀的强弱。


对于压缩性和膨胀性很小的流体，可以忽略压强和温度变化的影响，认为密度保持不变，称其为 **不可压缩流体** 。通常将液体看做不可压缩流体。气体具有较为显著的压缩性和膨胀性，通常将气体称为 **可压缩流体** ，在正常环境中，常见气体的密度、压强和温度三者的关系满足 **理想气体状态方程** ：

.. math::
	\begin{align}
	\frac{p}{\rho} = RT 
	\end{align}

其中 :math:`p` 为气体的绝对压强， :math:`\rho` 为气体的密度， :math:`T` 为气体热力学温度， :math:`R` 为气体常数。

.. note:: 在常温常压下，对于低速气流，如流速远小于声速的情况下，其密度变化不大，可以忽略压缩性的影响，按不可压缩流体来进行计算。



液体的表面张力特性
--------------------

液体具有尽量缩小其表面的趋势，在宏观上可以认为沿液体表面作用有张力，称为 **表面张力** 。表面张力的方向与液体表面相切，它使液体表面拉紧收缩，从而对液体的运动状况产生影响。

表面张力的大小可以用液体表面单位长度上受到的张力即 **表面张力系数** :math:`\sigma` 表示，其单位为 :math:`\mathrm{N/m}` ：

.. math::
	\begin{align}
	\sigma = \frac{\Delta T}{\Delta L} 
	\end{align}

其中 :math:`\Delta L` 是在自由表面上画出的一段长度， :math:`\Delta T` 是在其两侧自由表面的流体相互作用的拉力。  

.. note:: 同一种液体的表面张力系数随温度升高而减小；不同种类的液体和接触面，表面张力系数也会不同。由于表面张力为局部受力现象，一般 :math:`\sigma` 的值不大，可以忽略不计，只有在液体表面有较大的曲率时才考虑其影响。

插入液体的直径很小的管中及透水物质的孔隙中液体所发生的毛细现象就是表面张力的结果。管中及孔隙中的液体由于毛细管作用表面成凸形或凹形。毛细管中液体上升或下降的高度可以根据表面张力的大小来确定。设液面与管壁的接触角为 :math:`\theta` ，管的直径为 :math:`d` ，液体密度为 :math:`\rho` ，表面张力系数为 :math:`\sigma` ，根据液体重量与表面张力的垂直分量相平衡，可以得到

.. math::
	\begin{align}
	\pi d \sigma \cos \theta = \pi (\frac{d}{2})^{2} \rho g h
	\quad \Rightarrow \quad
	h = \frac{4\sigma \cos \theta}{\rho g d} 
	\end{align}

其中，接触角 :math:`\theta` 与液、气的种类和关闭的材料等因素有关。


质量力
--------

质量力是指作用在流体的每个质点上，其大小和流体的质量成正比的力。对于均质流体，质量力也必然和受作用流体的体积成正比，所以质量力又称为 **体积力** 。最常见的质量力是重力和惯性力。

单位质量的流体所受的质量力称为单位质量力。设作用在质量为 :math:`\Delta m` 的流体上的总质量力为 :math:`\Delta F` ，则单位质量力为

.. math::
	\begin{align}
	\mathbf{f} = \lim_{\Delta m \to 0}\frac{\Delta \mathbf{F}}{\Delta m} = \lim_{\Delta V \to 0} \frac{\Delta \mathbf{F}}{\rho\Delta V}  
	\end{align}

其中 :math:`\rho` 为流体密度， :math:`\Delta m \to 0` 和 :math:`\Delta V \to 0` 表示流体微团趋于流体质点。

单位质量力 :math:`\mathbf{f}` 在直角坐标系中的三个分量用 :math:`X,Y,Z` 表示，则

.. math::
	\begin{align}
	\mathbf{f} = X\mathbf{i} + Y \mathbf{j} + Z\mathbf{k}
	\end{align}

其中 :math:`\mathbf{i},\mathbf{j},\mathbf{k}` 分别表示x、y、z轴方向的单位矢量。

单位质量力及其分量都具有加速度的量纲 :math:`\mathrm{LT^{-2}}` 。当流体所受的质量力只有重力时，则在z轴铅锤向上的直角坐标系中质量力的三个分量分别为

.. math::
	\begin{align}
	X = 0, \quad Y=0, \quad Z=-g
	\end{align}

其中负号表示重力的方向是铅锤向下的，正好与z轴方向相反。



表面力
---------

表面力是流体内部各部分之间或流体和其他物体之间通过邻接表面作用在流体上的力，其大小和受力作用的表面面积成正比。由于流体内部不能承受拉力，所以表面力又可以分为垂直于作用面的压力和平行于作用面的切力。

如果在隔离体表面上取一个包含A点的微小面积 :math:`\Delta A` ，作用在 :math:`\Delta A` 上的法向力为 :math:`\Delta P` ，切向力为 :math:`\Delta T` ，则 :math:`\Delta A` 的单位面积上的平均压力（平均压强、平均压应力） :math:`\overline{p}` 和平均切力（平均切应力） :math:`\overline{\tau}` 分别为

.. math::
	\begin{align}
	\overline{p} = \frac{\Delta P}{\Delta A}, \qquad \overline{\tau} = \frac{\Delta T}{\Delta A}    
	\end{align}

若 :math:`\Delta A` 面积无限缩小至A点，根据连续介质假设，可以取其极限值，则A点的压强和切应力为

.. math::
	\begin{align}
	p = \lim_{\Delta A \to 0 }\frac{\Delta P}{\Delta A}, \qquad \tau = \lim_{\Delta A \to 0}\frac{\Delta T}{\Delta A}  
	\end{align}

在国际单位制中，压强和切应力的单位均为 :math:`\mathrm{Pa}` 。






体积通量和质量通量
-------------------

体积通量的物理意义为单位时间内流经某个网格单元面流体的体积，单位为 :math:`\mathrm{m}^{3}/\mathrm{s}` 。质量通量的物理意义为单位时间内流经某个网格单元面流体的质量，单位为 :math:`\mathrm{kg}/\mathrm{s}` 。对于不可压缩流体，通常选择体积通量；对于可压缩流体，通常选择质量通量。

体积通量在数学上是很好理解的，即每单位时间流经某个网格单元面多少立方米的流体：

.. math::
	\begin{align}
	\phi_{f}=\boldsymbol{U}_{f}\cdot \boldsymbol{S}_{f}
	\end{align}

其中 :math:`\phi_{f}` 表示网格单元面 :math:`\boldsymbol{S}_{f}` 上的通量， :math:`\boldsymbol{S}_{f}` 称为面矢量， :math:`\boldsymbol{U}_{f}` 是定义在网格单元面上的速度。在 :math:`\phi_{f}` 的基础上除以网格面积，就得到每单位时间每单位面积流经的体积：

.. math::
	\begin{align}
	\frac{\phi_{f}}{|\boldsymbol{S}_{f}|}=\boldsymbol{U}_{f}\cdot \frac{\boldsymbol{S}_{f}}{|\boldsymbol{S}_{f}|}=\boldsymbol{U}_{f}\cdot\boldsymbol{n}_{f}
	\end{align}

面矢量 :math:`\boldsymbol{S}_{f}` 的大小为 :math:`|\boldsymbol{S}_{f}|=\sqrt{S_{x}^{2}+S_{y}^{2}+S_{z}^{2}}` ，其中 :math:`S_{x},S_{y},S_{z}` 表示面矢量的分量。类似的可知， :math:`\rho_{f}\boldsymbol{U}_{f}\cdot \boldsymbol{S}_{f}` 表示每单位时间经过某个网格面多少千克流体。

上面引入的面法向矢量 :math:`\boldsymbol{n}_{f}=\frac{\boldsymbol{S}_{f}}{|\boldsymbol{S}_{f}|}` 定义了面的法向，每个网格单元都会分别对应一个面矢量和面法向矢量。除了边界面，网格的内部面也存在面矢量。两个网格连接面的矢量 :math:`\boldsymbol{S}` 垂直于网格面，大小等于面的面积；而常用的近似矢量是由宿主网格指向相邻网格，而连接宿主网格体心和相邻网格体心的矢量方向在非正交的情况下并不相同，这就会导致梯度计算存在差异，也就需要非正交修正算法。


扩散通量
--------

通常用 :math:`D` 表示扩散系数，那么每单位时间每单位面积由于扩散导致的通量可以表示为

.. math::
	\begin{align}
	\boldsymbol{J}=D\nabla \phi
	\end{align}

由于在一些情况下，各个方向由于扩散系数的不同会导致呈现各向异性扩散，且一般情况下各个方向的梯度也不相同，因此扩散通量为一个分量不同的矢量。扩散通量的驱动因素是变量的梯度。类似的，每单位时间由于扩散导致的通量可以表示为

.. math::
	\begin{align}
	\boldsymbol{J}_{f}\cdot \boldsymbol{S}_{f}=D(\nabla \phi)_{f}\cdot \boldsymbol{S}_{f}=D(\nabla \phi)_{f}\cdot \frac{\boldsymbol{S}_{f}}{|\boldsymbol{S}_{f}|} |\boldsymbol{S}_{f}|
	\end{align}

其中 :math:`(\nabla \phi)_{f}\cdot \frac{\boldsymbol{S}_{f}}{|\boldsymbol{S}_{f}|}` 表示面法向梯度。上述公式可以整理为

.. math::
	\begin{align}
	(\nabla \phi)_{f}\cdot \boldsymbol{n}_{f}=\frac{\boldsymbol{J}_{f}\cdot \boldsymbol{n}_{f}}{D} 
	\end{align}

上述公式通常可以用于施加边界条件。


速度散度
--------

体积通量 :math:`\phi_{f}` 是单位时间内流经某个面的流体体积，在此基础上乘以时间 :math:`\Delta t` 则表示体积为 :math:`V` 的流动控制体。由于其中的面 :math:`\mathrm{d}\boldsymbol{S}` 以 :math:`\boldsymbol{U}` 的速度移动，因此在 :math:`Delta t` 时间内体积的变化量为

.. math::
	\begin{align}
	\mathrm{d}V_{f}=\phi_{f}\Delta t=\boldsymbol{U}_{f}\cdot\mathrm{d}\boldsymbol{S}_{f}\Delta t  
	\end{align}






流体静力学
============

流体静力学研究流体在静止状态下的受力平衡规律。流体的静止状态指的是流体质点相对于参考坐标系没有运动，流体内部质点之间均不存在相对运动，有两种情况：

- 参考坐标系固定在地球上，流体相对地球没有运动；
- 流体相对于地球运动（如沿直线作等加速运动或等角速旋转运动容器内的流体），但相对于容器不运动，若将参考坐标系固定在容器上，流体仍是静止的，称为相对静止或相对平衡。
  
流体静力学中，将流体内的压应力称为 **流体静压强** ，处于流动状态的流体内部的压强称为 **流体动压强** 。有些情况下，流体动压强的分布规律也可以认为与流体静压强相同或相近。


流体静压强及其特性
---------------------

在静止流体中，围绕某点取一个面积为 :math:`\Delta A` 的微小作用面，设作用在其上的压力为 :math:`\Delta P` ，则该点的流体静压强 :math:`p` 就是面积 :math:`\Delta A` 趋于无穷小时，单位面积上平均压力的极限值：

.. math::
	\begin{align}
	p = \lim_{\Delta A \to 0} \frac{\Delta P}{\Delta A} 
	\end{align}

在国际单位制中，静压强 :math:`p` 的单位为 :math:`\mathrm{N/m^{2}}` 或 :math:`\mathrm{Pa}` 。

流体静压强有两个基本性质：

1. 流体静压强的方向沿作用面的内法线方向。
2. 静止流体中任一点上流体静压强的大小与作用面的方位无关，即同一点上各个方向的流体静压强的大小相等。
   
**证明** 第一个性质可以从流体的基本特征推出——静止流体中既不能承受切应力，也不能承受拉应力，否则将会发生流动，因此压强作用方向只能和作用面的内法线方向一致，即静止流体中只存在压应力。

关于第二个性质，可以设在静止流体中任意取一个点C，以此为顶点构造一个微小直角四面体。为方便起见，取三个正交面与坐标平面方向一致，棱长分别为 :math:`\mathrm{d}x` 、 :math:`\mathrm{d}y` 、 :math:`\mathrm{d}z` ，任意方向倾斜面的面积为 :math:`\mathrm{d}A_{n}` ，其外法线 :math:`\mathbf{n}` 的方向余弦为 :math:`\cos(\mathbf{n},x)` 、 :math:`\cos(\mathbf{n},y)` 、 :math:`\cos(\mathbf{n},z)` ，于是有面积关系：

.. math::
	\begin{align}
	\mathrm{d}A_{n} \cos(\mathbf{n},x) = \frac{1}{2}\mathrm{d}y\mathrm{d}z , \quad
	\mathrm{d}A_{n} \cos(\mathbf{n},y) = \frac{1}{2}\mathrm{d}x\mathrm{d}z , \quad
	\mathrm{d}A_{n} \cos(\mathbf{n},z) = \frac{1}{2}\mathrm{d}x\mathrm{d}y
	\end{align}

四面体受力包括表面力和质量力。因为静止流体中不存在切应力，所以表面力只有四个面上的压力，其与各面平均压强的关系为：

.. math::
	\begin{align}
	P_{x} = p_{x}\cdot \frac{1}{2}\mathrm{d}y\mathrm{d}z, \quad 
	P_{y} = p_{y}\cdot \frac{1}{2}\mathrm{d}x\mathrm{d}z, \quad 
	P_{z} = p_{z}\cdot \frac{1}{2}\mathrm{d}x\mathrm{d}y, \quad 
	P_{n}=p_{n}\cdot \mathrm{d}A_{n} 
	\end{align}

以 :math:`X` 、 :math:`Y` 、 :math:`Z` 分别表示单位质量力在对应坐标轴方向的分量，四面体内流体的质量为 :math:`\frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，它所受的质量力 :math:`\mathbf{F}` 在各坐标轴方向的分量可以表示为

.. math::
	\begin{align}
	F_{x}=(\frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\cdot X, \quad
	F_{y}=(\frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\cdot Y, \quad
	F_{z}=(\frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\cdot Z
	\end{align}

根据平衡条件，四面体处于静止状态下，各个方向上的作用力之和均为零。以x方向为例，即

.. math::
	\begin{align}
	P_{x} - P_{n}\cos(\mathbf{n},x) + F_{x} = 0
	\end{align}

将 :math:`P_{x}` 、 :math:`P_{n}` 、 :math:`F_{x}` 的表达式代入上式后得到

.. math::
	\begin{align}
	\frac{1}{2}p_{x}\mathrm{d}y\mathrm{d}z - \frac{1}{2}p_{n}\mathrm{d}y\mathrm{d}z + \frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z \cdot X = 0
	\end{align}

当 :math:`\mathrm{d}x` 、 :math:`\mathrm{d}y` 、 :math:`\mathrm{d}z` 趋于零，四面体向C点无限缩小时，上式等号左侧第三项为高阶小量，可以忽略，从而得到 :math:`p_{x} = p_{n}` 。y轴和z轴方向上的情况以此类推，从而得到

.. math::
	\begin{align}
	p_{x} = p_{y} = p_{z} = p_{n}
	\end{align}

而在上述对微元体的分析当中，倾斜面的方向 :math:`\mathbf{n}` 是任意的，因此上式说明在同一点上各个方向的流体静压强均相等，与作用面的方位无关。因此，静止流体中任一点应力状态可以用流体静压强表示，它只是该点坐标的连续函数，即 :math:`p=p(x,y,z)` 。





流体平衡微分方程
-------------------

流体平衡基本关系式的建立
^^^^^^^^^^^^^^^^^^^^^^^^^^

在静止的流体中取一微元正六面体，其中心在任意点 :math:`M` ，各边分别与坐标轴平行，边长为 :math:`\mathrm{d}x,\mathrm{d}y,\mathrm{d}z` 。作用于此流体微元六面体的力有两种，首先是六面体上的表面力，即周围流体对它施加的压力，这取决于六面体各面上的压强。设六面体中心点 :math:`M(x,y,z)` 的压强为 :math:`p(x,y,z)` ，由连续介质假设可知压强是坐标的连续函数。当坐标有微小变化时，压强也发生变化，并可以用泰勒级数表示为

.. math::
	\begin{align}
	p(x+\Delta x,y+\Delta y,z+\Delta z) 
	=& p(x,y,z)
	+\Big( \frac{\partial p}{\partial x}\Delta x+\frac{\partial p}{\partial y}\Delta y+\frac{\partial p}{\partial z}\Delta z \Big) \\
	&+ \frac{1}{2!} \Big( 
	  \frac{\partial ^{2}p}{\partial x^{2}}\Delta x^{2}
	  + \frac{\partial ^{2}p}{\partial y^{2}}\Delta y^{2}
	  + \frac{\partial ^{2}p}{\partial z^{2}}\Delta z^{2}
	  + 2\frac{\partial ^{2}p}{\partial x\partial y}\Delta x\Delta y
	  + 2\frac{\partial ^{2}p}{\partial y\partial z}\Delta y\Delta z
	  + 2\frac{\partial ^{2}p}{\partial z\partial x}\Delta z\Delta x
	  \Big)
	+ \cdots
	\end{align}

当忽略二阶以上的各项时，沿x方向作用于微元六面体边界面中心处的压强分别为 :math:`p+\frac{\partial p}{\partial x}\frac{\mathrm{d} x}{2}` 和 :math:`p-\frac{\partial p}{\partial x}\frac{\mathrm{d} x}{2}` ，而由于受压面是一微小面积，上述压强可以认为是所在面的平均压强，因此沿x方向的压力的合力为

.. math::
	\begin{align}
	(p-\frac{\partial p}{\partial x}\frac{\mathrm{d} x}{2})\mathrm{d}y\mathrm{d}z  -(p+\frac{\partial p}{\partial x}\frac{\mathrm{d} x}{2})\mathrm{d}y\mathrm{d}z
	= -\frac{\partial p}{\partial x}\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{align}

然后考虑作用于六面体的质量力。以 :math:`X,Y,Z` 分别表示单位质量力在 :math:`x,y,z` 轴方向的分量， :math:`\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z` 表示六面体的质量，则质量力分量分别为 :math:`\rho\mathrm{d}x\mathrm{d}y\mathrm{d}zX, \rho\mathrm{d}x\mathrm{d}y\mathrm{d}zY, \rho\mathrm{d}x\mathrm{d}y\mathrm{d}zZ` 。

因为微小六面体处于平衡状态，它受到的表面力与质量力必须平衡，以x方向为例，则有

.. math::
	\begin{align}
	-\frac{\partial p}{\partial x}\mathrm{d}x\mathrm{d}y\mathrm{d}z + \rho\mathrm{d}x\mathrm{d}y\mathrm{d}zX = 0
	\quad \Rightarrow \quad 
	\frac{1}{\rho}\frac{\partial p}{\partial x}-X=0 
	\end{align}

y,z方向同理，于是可以得到矢量形式的 **流体平衡微分方程** （或称欧拉平衡微分方程）：

.. math::
	\begin{align}
	\nabla p = \rho \mathbf{f}
	\end{align}



平衡流体压强分布规律
^^^^^^^^^^^^^^^^^^^^^^^

在给定质量力的作用下，设微分位移矢量 :math:`\mathrm{d}\mathbf{r}=(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)` ，则对流体平衡微分方程两边乘以该微分位移矢量并积分则有

.. math::
	\begin{align}
	\int \nabla p \cdot \mathrm{d}\mathbf{r} = \int \rho \mathbf{f} \cdot \mathrm{d}\mathbf{r}
	\quad \Rightarrow \quad 
	p = \rho W + \text{const}
	\end{align}

其中 :math:`W(x,y,z)` 为 **质量力势函数** ，而其中的常数const可以通过流体表面或内部某点已知的势函数 :math:`W_{0}` 和压强 :math:`p_{0}` 来确定，从而有

.. math::
	\begin{align}
	p = p_{0} + \rho(W - W_{0})
	\end{align}

该式说明了平衡流体压强的分布规律，如果质量力势函数已知就能计算任一点处的压强。同时可以看到，在平衡状态下，常密度流体中任一点的压强变化一定会等值地传递到流体的其他各点上，称之为 **帕斯卡原理** 。


等压面
^^^^^^^^^

静止流体中压强相等的各点所构成的面称为等压面。在等压面上，压强 :math:`p` 为常数，若取等压面的切平面上沿任意方向的微小位移矢量 :math:`\mathrm{d}\mathbf{r}` ，则有

.. math::
	\begin{align}
	\nabla p \cdot \mathrm{d}\mathbf{r} = \rho \mathbf{f} \cdot \mathrm{d}\mathbf{r} = 0  
	\end{align}

可以看到，在平衡的不可压缩均质流体中，等压面同时也是等势面。同时，流体质点沿等压面移动时质量力做功为零，而质量力和位移都不等于零，因此质量力必定垂直于等压面，于是可根据质量力的方向来判断等压面的形状。




重力场中液体静压强的分布
--------------------------

重力作用下的液体平衡方程
^^^^^^^^^^^^^^^^^^^^^^^^^^^

对于重力场中的静止流体，设液体自由面（液面）上的压强为 :math:`p_{0}` ，单位质量力为 :math:`\mathbf{f} = (0,0,-g)` ，于是根据流体平衡微分方程可以得到

.. math::
	\begin{align}
	\int \nabla p \cdot \mathrm{d}\mathbf{r} = \int \rho \mathbf{f} \cdot \mathrm{d}\mathbf{r} 
	\quad \Rightarrow \quad 
	p = -\rho gz + \text{const} 
	\end{align}

利用液面上 :math:`z=0,p=p_{0}` 的条件可以得到 :math:`\text{const} = p_{0}` 。而对于液体中的各点来说，用各点在液面下的深度 :math:`h` 来代替z轴方向更方便，于是将 :math:`z=-h,\text{const}=p_{0}` 得到

.. math::
	\begin{align}
	p = p_{0} + \rho gh
	\end{align}

上式就是重力作用下的液体平衡方程，称为液体静力学基本方程。需要注意，该结论只适用于质量力只有重力、同一物性的静止连续的液体。




压强的度量
^^^^^^^^^^^^^

以没有气体存在的完全真空为零算起的压强值称为 **绝对压强** ，记为 :math:`p_{\text{abs}}` 。在实际大多数情况下都会受到大气压强 :math:`p_{a}` 的作用，因此以当地大气压强作为压强计量的基准点较为方便，这样的压强值称为 **相对压强** ，记为 :math:`p_{r}` ，满足关系：

.. math::
	\begin{align}
	p_{r} = p_{\text{abs}} - p_{a}
	\end{align}

实际情况下，压强不可能低于绝对真空状态的压强，因此绝对压强的数值总是正的，而相对压强的数值可正可负。当所计量的压强低于当地大气压强时，相对压强值为负，称为负压状态或真空状态。将真空状态下的差值称为 **真空值** ，记为 :math:`p_{v}` ，满足关系：

.. math::
	\begin{align}
	p_{v} = p_{a} - p_{\text{abs}}
	\end{align}


+--------------+------------+--------------------------+-----------------------------------------------------------------------------------------+
| 压强量度方法 | 单位名称   | 单位符号                 | 单位换算关系                                                                            |
+==============+============+==========================+=========================================================================================+
| 应力单位法   | 帕         | :math:`\mathrm{Pa}`      | :math:`1~\mathrm{Pa}=1~\mathrm{N/m^{2}}`                                                |
+--------------+------------+--------------------------+-----------------------------------------------------------------------------------------+
| 液柱高度法   | 米水柱     | :math:`\mathrm{mH_{2}O}` | :math:`1~\mathrm{mH_{2}O}=9.8\times10^{3}~\mathrm{Pa}`                                  |
+              +------------+--------------------------+-----------------------------------------------------------------------------------------+
|              | 毫米汞柱   | :math:`\mathrm{mmHg}`    | :math:`1~\mathrm{mmHg} =13.6~\mathrm{mmH_{2}O}=133.3~\mathrm{Pa}`                       |
+--------------+------------+--------------------------+-----------------------------------------------------------------------------------------+
| 工程大气压法 | 工程大气压 | :math:`\mathrm{at}`      | :math:`1~\mathrm{at}=10~\mathrm{mH_{2}O}=736~\mathrm{mmHg}=9.8\times10^{4}~\mathrm{Pa}` |
+--------------+------------+--------------------------+-----------------------------------------------------------------------------------------+





水头与单位势能
^^^^^^^^^^^^^^^^^

重力场中的液体平衡方程稍微移项整理后可以得到另外一个形式：

.. math::
	\begin{align}
	z + \frac{p}{\rho g} = \text{const} 
	\end{align}

上式表明，在重力场的静止液体内部所有点上的 :math:`z + \frac{p}{\rho g}` 值总是一个常数。

如果在容器壁的任一点1处开一个小孔，接上上端与大气相通的玻璃管（测压管），则在1点压强的作用下测压管的液面将上升到某一高度。任意选取一个高度基准面，则测压管的液面到基准面的高度由 :math:`z_{1}` 和 :math:`\frac{p_{1}}{\rho g}` 两部分组成，其中 :math:`z_{1}` 称为 **位置水头** ， :math:`\frac{p_{1}}{\rho g}` 称为压强水头，而 :math:`z_{1}+\frac{p_{1}}{\rho g}` 称为测管水头。再在任一点2处开另一个小孔，则1、2两根测压管的液面是相齐平的，即

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} = z_{2} + \frac{p_{2}}{\rho g}  
	\end{align}

由于液体中的1、2两点是任意选取的，所以上式表明重力场中静止液体内所有各点的测量水头都是相等的。

位置水头、压强水头和测管水头具有明确的能量含义。如果物体的重量为 :math:`G` ，把该物体从基准面位移到高度 :math:`z` 后，该物体所具有的位能为 :math:`G\cdot z` ，对该物体的单位重量而言的位能则为 :math:`\frac{G\cdot z}{G}=z` 。所以，上式中 :math:`z` 表示单位重量液体相对于基准面的位置势能，也称之为 **单位位能** （简称位能）。与此相类似，压强水头 :math:`\frac{p}{\rho g}` 表示单位重量液体相对于大气压强基准点所具有的压强势能，称之为 **单位压能** （简称压能）。测管水头 :math:`z+\frac{p}{\rho g}` 表示了单位重量液体的总势能，即位能与压能之和（简称单位势能）。





作用在平面上的液体的总压力
-----------------------------

有一任意形状平面A'B'，倾斜放置在静止液体中，与水平液面的夹角为 :math:`\alpha` ，平面面积为 :math:`A` 。选择平面A'B'的延伸面与水平液面的交线为x轴，Oxy坐标平面与平面A'B'在同一平面。在平面A'B'上任取一微小面积 :math:`\mathrm{d}A` ，其中心点在液面以下的深度为 :math:`h` ，在 :math:`y` 轴上的距离为 :math:`y` ，并设该微小面积上的压强为 :math:`p` ，则作用在整个平面上的总压力为

.. math::
	\begin{align}
	P=\int_{A}p\mathrm{d}A = \int_{A}\rho gh\mathrm{d}A=\int_{A}\rho gy\sin\alpha \mathrm{d}A=\rho g\sin\alpha \int_{A}y\mathrm{d}A   
	\end{align}

其中 :math:`\int_{A}y\mathrm{d}A` 是平面A'B'对Ox轴的静面矩，其大小等于面积 :math:`A` 与形心 :math:`C` 的坐标 :math:`y_{C}` 的乘积，于是

.. math::
	\begin{align}
	P =\rho g \sin\alpha \cdot y_{C}A = \rho g h_{C}A = p_{C}A
	\end{align}

其中， :math:`h_{C}` 为形心 :math:`C` 在液面下的深度， :math:`p_{C}` 为形心 :math:`C` 上的压强。上式表明，静止液体作用于任意形状平面上的总压力等于该平面的面积与其形心点静压强的乘积。而形心点的静压强就是整个作用面的平均压强。

根据合力矩定理（合力对任一轴的力矩等于各分力对该轴的力矩之和），可以得到总压力 :math:`P` 作用点 :math:`D` （压力中心）的坐标 :math:`x_{D},y_{D}` 。对Ox轴取力矩，则有

.. math::
	\begin{align}
	P \cdot y_{D} = \int_{A}y\mathrm{d}P = \int_{A}y\cdot\rho gh\mathrm{d}A 
	              = \int_{A}y\cdot \rho gy\sin\alpha \mathrm{d}A = \rho g\sin\alpha \int_{A}y^{2}\mathrm{d}A 
	\end{align}


其中 :math:`\int_{A}y^{2}\mathrm{d}A` 为平面A'B'对Ox轴的惯性矩，用符号 :math:`I_{xo}` 表示。化简整理上式得到

.. math::
	\begin{align}
	y_{D} = \frac{\rho g\sin\alpha I_{xo}}{P} = \frac{\rho g\sin\alpha I_{xo}}{\rho g\sin\alpha y_{C}A} = \frac{I_{xo}}{y_{C}A}  
	\end{align}


根据惯性矩平行移轴公式 :math:`I_{xo}=I_{xC}+y_{C}^{2}A` ，可以将平面上静压力对Ox轴的惯性矩 :math:`I_{xo}` 换算成惯性矩 :math:`I_{xC}` （相对于通过受压面形心C且平行于Ox轴的一条轴线的惯性矩），所以上式可以改写为

.. math::
	\begin{align}
	y_{D} = \frac{I_{xC} + y_{C}^{2}A}{y_{C}A} = y_{C} + \frac{I_{xC}}{y_{C}A}  
	\end{align}

压力中心D和受压面形心点C在y方向之间的距离为

.. math::
	\begin{align}
	e = y_{D} - y_{C} = \frac{I_{xC}}{y_{C}A} 
	\end{align}

上式表明压力中心D总是位于平面形心点C的下方。


常见平面的 :math:`A` 、 :math:`y_{C}` 和 :math:`I_{xC}` 值如下：

+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 名称   | 面积 :math:`A`              | 形心位置 :math:`y_{C}`                | 惯性矩 :math:`I_{xC}`                                 |
+========+=============================+=======================================+=======================================================+
| 矩形   | :math:`bh`                  | :math:`\frac{h}{2}`                   | :math:`\frac{bh^{3}}{12}`                             |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 三角形 | :math:`\frac{bh}{2}`        | :math:`\frac{2}{3}h`                  | :math:`\frac{bh^{3}}{36}`                             |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 梯形   | :math:`\frac{h(a+b)}{2}`    | :math:`\frac{h}{3}(\frac{a+2b}{a+b})` | :math:`\frac{h^{3}}{36}(\frac{a^{2}+4ab+b^{2}}{a+b})` |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 圆     | :math:`\pi r^{2}`           | :math:`r`                             | :math:`\frac{\pi r^{4}}{4}`                           |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 半圆   | :math:`\frac{\pi r^{2}}{2}` | :math:`\frac{4r}{3\pi}`               | :math:`\frac{9\pi^{2}-64}{72\pi}r^{4}`                |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+





作用在曲面上的液体总压力
--------------------------

考虑具有水平母线的柱面（二维曲面）的情况。设二维曲面A'B'，其左侧承受液体静压强，母线平行于Oy轴，曲面面积为 :math:`A` 。在曲面A'B'上、深度为 :math:`h` 的位置处取一微小面积 :math:`\mathrm{d}A` ，则作用在此微小面积的液体压力为 :math:`\mathrm{d}P = p\mathrm{d}A=\rho gh\mathrm{d}A` ，方向垂直于面积 :math:`\mathrm{d}A` ，并水平线成 :math:`\theta` 角。此微小压力可以分解为水平和垂直分力：

.. math::
	\begin{align}
	& \mathrm{d}P_{x} = \mathrm{d}P\cos\theta =\rho gh\mathrm{d}A\cos\theta =\rho gh\mathrm{d}A_{x} \\
	& \mathrm{d}P_{z} = \mathrm{d}P\sin\theta = \rho gh\mathrm{d}A\sin\theta = \rho gh\mathrm{d}A_{z}      
	\end{align}

其中 :math:`\mathrm{d}A_{x}` 是 :math:`\mathrm{d}A` 在铅垂面yOz上的投影， :math:`\mathrm{d}A_{z}` 是 :math:`\mathrm{d}A` 在水平面xOy上的投影。

作用在整个曲面上的水平分力为

.. math::
	\begin{align}
	P_{x} = \int_{A_{x}}\rho gh\mathrm{d}A_{x} = \rho g\int_{A_{x}}h\mathrm{d}A_{x} 
	\end{align}

与求作用在平面上的液体的总压力类似， :math:`\int_{A_{x}}h\mathrm{d}A_{x}` 表示曲面A'B'在铅垂面上的投影面积 :math:`A_{x}` 对水平轴（Oy轴）的静面矩。若 :math:`A_{x}` 的形心在液面下的深度为 :math:`h_{C}` ，则 :math:`\int_{A_{x}}h\mathrm{d}A_{x}=h_{C}A_{x}` ，从而有

.. math::
	\begin{align}
	P_{x}=\rho gh_{C}A_{x}
	\end{align}

上式表明作用于曲面A'B'上的总压力的水平分力等于作用于该曲面的铅锤投影面上的总压力，可以按照确定平面总压力的方法来确定 :math:`P_{x}` 。

作用在整个曲面上的垂直分力为

.. math::
	\begin{align}
	P_{z} = \int_{A_{z}} \rho gh\mathrm{d}A_{z} = \rho g\int_{A_{z}} h\mathrm{d}A_{z} 
	\end{align}

其中 :math:`h\mathrm{d}A_{z}` 代表了微小面积与它在自由液面延长面上的投影 :math:`\mathrm{d}A_{z}` 之间的柱体体积，而 :math:`\int_{A_{z}} h\mathrm{d}A_{z}` 就是整个曲面A'B'与其在自由液面（或延长面）上的投影之间的柱体体积。该柱体称为曲面A'B'的 **压力体** ，其体积以 :math:`V_{p}` 来表示，即 :math:`V_{p}=\int_{A_{z}} h\mathrm{d}A_{z}` ，于是

.. math::
	\begin{align}
	P_{z} = \rho gV_{p}
	\end{align}

可以看到，作用于曲面A'B'上的总压力 :math:`P` 的垂直分力 :math:`P_{z}` 等于其压力体内充满液体时的重量。 :math:`P_{z}` 的作用线一定通过压力体的重心。

.. attention:: :math:`P_{z}` 的方向取决于液体、压力体与受压曲面间的相对位置。可以通过实际作用在曲面上的总压力总是指向曲面，根据深度不同对应的压力大小不同，来判断其垂直分力合成后最终应该是向上还是向下。复杂压力体会出现部分区域相互抵消的情况。

求出了水平分力 :math:`P_{x}` 和垂直分力 :math:`P_{z}` 后，就可以确定作用在曲面上的总压力为

.. math::
	\begin{align}
	P=\sqrt{P_{x}^{2}+P_{z}^{2}}, \qquad \alpha =\arctan\frac{P_{z}}{P_{x}}  
	\end{align}

.. note:: :math:`P` 的作用线必定通过 :math:`P_{x}` 和 :math:`P_{z}` 的作用线的交点，不过这个交点不一定在曲面上。


作用于潜体或浮体（物体全部或部分浸没于液体中）的压力问题是曲面压力的特例。此时，作用在物体上的水平分力 :math:`P_{x},P_{y}` 均为零，而作用于物体的铅锤总压力 :math:`P_{z}` 方向向上，满足

.. math::
	\begin{align}
	P_{z} = \rho gV
	\end{align}

压力体体积 :math:`V` 就是浸没体积，铅锤力作用线通过物体被浸没部分体积的几何中心（浮心），这就是 **阿基米德原理** 。



液体的相对平衡
----------------

如果装在容器中的液体随容器相对于地球在运动，但液体内部各质点之间以及液体与容器之间没有相对运动，若把坐标系取在容器上，则液体相对于所取的坐标系而言，也处于静止状态，称为相对静止或相对平衡。下面以等角速度旋转容器内液体的相对平衡为例进行说明。

盛有液体的开口圆柱形容器以等角速度绕其中心铅锤轴旋转，由于液体的粘滞作用，经过一段时间后，整个液体随容器以同样的角速度旋转。液体与容器以及液体内部各层之间无相对运动，液面形成一个漏斗形的旋转抛物面。将坐标系取在运动着的容器上，原点取在旋转轴与容器底面的交点上，z轴垂直向上。

根据达朗贝尔原理，作用在每一流体质点上的质量力除重力以外，还要考虑惯性力，对于等角速度旋转运动来说，离心惯性力为

.. math::
	\begin{align}
	\mathbf{F} = m\omega^{2}\mathbf{r}
	\end{align}

其中 :math:`m` 为质点质量， :math:`\omega` 为角速度， :math:`\mathbf{r}` 为该点所在位置的向径，其数值为 :math:`r=\sqrt{x^{2}+y^{2}}` 。而单位质量的离心惯性力在x轴和y轴方向的投影分别为

.. math::
	\begin{align}
	X=\omega^{2}r\cos\alpha =\omega^{2}x, \qquad Y=\omega^{2}r\sin\alpha =\omega^{2}y
	\end{align}

再考虑重力的单位质量力分量为 :math:`Z=-g` ，从而得到 :math:`\mathbf{f} = (\omega^{2}x,\omega^{2}y,-g)` ，进而根据流体平衡方程得到

.. math::
	\begin{align}
	\int \nabla p \cdot \mathrm{d}\mathbf{s} = \int \rho \mathbf{f} \cdot \mathrm{d}\mathbf{s}
	\quad \Rightarrow \quad 
	p = \rho(\frac{1}{2}\omega^{2}x^{2}+\frac{1}{2}\omega^{2}y^{2}-gz)+\text{const}
	  = \rho(\frac{1}{2} \omega^{2}r^{2}-gz)+\text{const}  
	\end{align}

由边界条件 :math:`r=0,z=z_{0},p=p_{0}` 可以确定积分常数 :math:`\text{const}=p_{0}+\rho gz_{0}` ，得到液面下任一点处的压强为

.. math::
	\begin{align}
	p=p_{0}+\rho\Big( \frac{1}{2}\omega^{2}r^{2}+(z_{0}-z)g \Big)
	 =p_{0}+\rho g\Big( \frac{\omega^{2}r^{2}}{2g}+(z_{0}-z) \Big)
	\end{align}

若液面压强为大气压强，用相对压强表示时有 :math:`p_{0}=p_{a}=0` ，则

.. math::
	\begin{align}
	p = \rho g\Big( \frac{\omega^{2}r^{2}}{2g}+(z_{0}-z) \Big)
	\end{align}

该式表示相对平衡的液体内压强分布规律。


同时注意到，如果令 :math:`p` 为某一常数，整理后可以得到等压面方程：

.. math::
	\begin{align}
	\frac{\omega ^{2}r^{2}}{2g}-z=\text{const}
	\end{align}

该式表明等压面是一族旋转抛物面。而对于某一固定半径位置，不难得到压强与任一点在自由液面下的淹没深度之间的关系为 :math:`p=p_{0} + \rho gh` ，也即相对平衡液体在铅锤方向压强分布规律与静止液体相同。






流体运动学
=============

流体运动的描述方法
--------------------

拉格朗日法
^^^^^^^^^^^^^

拉格朗日法时质点系法，其基本思想是跟踪每个流体质点的运动全过程，记录它们在运动过程中位移的时间历程，通过对全部流体质点的跟踪过程，获得流体的总体运动情况。拉格朗日法的特点是：跟着所选定的流体质点，观察它的位移。

通常用流体质点在初始时刻 :math:`t=t_{0}` 的空间位置坐标 :math:`(a,b,c)` 作为区分不同流体质点的标记。 :math:`(a,b,c)` 取不同的值表示不同的流体质点。 :math:`a,b,c` 和 :math:`t` 称为 **拉格朗日变量** ，则位移是拉格朗日变量的函数：

.. math::
	\begin{align}
	\mathbf{r} = \mathbf{r}(a,b,c,t)
	\end{align}

上式给出了任意一个标记为 :math:`(a,b,c)` 的流体质点在任意一个时刻 :math:`t` 的空间位置，也就描述了流体的整体运动。流体在运动过程中其他运动要素和物理量的时间历程也可以用拉格朗日法进行描述。

.. note:: 

	拉格朗日法着眼于流体质点，物理意义直观，但是在跟踪流体质点的过程中，时间和质点所在空间位置会同时发生变化，带来数学处理上的困难，所以拉格朗日法通常只在一些对流体质点运动特别关注的问题中被采用。


欧拉法
^^^^^^^^

欧拉法是空间点法，是一种场的描述方法，也叫流场法。欧拉法不去追究各流体质点的运动过程，而把着眼点放在空间点，观察先后流经这一空间点的各个流体质点的运动情况。通过对流场所占据的全部空间点的观察过程的综合，获得整个流动的时间、空间变化规律。欧拉法的特点是在选定的空间点上观察流经它的流体质点的运动情况。

在欧拉法中，将空间点的位置坐标 :math:`(x,y,z)` 和时间 :math:`t` 称为 **欧拉变量** ，通过建立定义在某空间和空间域上的流速矢量场

.. math::
	\begin{align}
	\mathbf{U}=\mathbf{U}(x,y,z,t)
	\end{align}

来描述流体的运动。流速 :math:`\mathbf{U}(x,y,z,t)` 是在 :math:`t` 时刻占据空间点 :math:`(x,y,z)` 的那个流体质点的速度矢量。流体的其他运动要素和物理特性也都可以用相应的时间和空间域上场的形式来表达。

也可以这样来理解欧拉法：将时间看作参数，先取定 :math:`t` ，让 :math:`(x,y,z)` 变化，表示在同一瞬时观察流场的空间变化情况；然后再变动 :math:`t` 的取值，从而获得流动随时间和空间的变化规律。如果流场中物理量的空间分布不随时间变化，其欧拉表达式中将不含时间 :math:`t` ，这样的流场称为恒定流。



流体质点的加速度、物质导数
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

速度是同一流体质点的位移对时间的变化率，加速度则是同一流体质点的速度对时间的变化率，这个过程必须跟定流体质点，也即在拉格朗日观点下进行。

如果流动是用拉格朗日法进行描述的，流体质点速度和加速度只需要将位移矢量直接对时间求一、二阶导数即可（求导时 :math:`a,b,c` 作为参数不变，表示跟定流体质点）：

.. math::
	\begin{align}
	& \mathbf{U}(a,b,c,t) = \frac{\mathrm{d}\mathbf{r}(a,b,c,t)}{\mathrm{d}t}=\frac{\partial \mathbf{r}(a,b,c,t)}{\partial t}  \\
	& \mathbf{a}(a,b,c,t) = \frac{\mathrm{d}\mathbf{U}(a,b,c,t)}{\mathrm{d}t}=\frac{\partial \mathbf{U}(a,b,c,t)}{\partial t} =\frac{\partial^{2} \mathbf{r}(a,b,c,t)}{\partial t^{2}}  
	\end{align}

而如果流动是用欧拉法进行描述的，由于求加速度需要跟定流体质点，此时 :math:`x,y,z` 是流体质点在运动过程中先后经过的位置，也就成为了 :math:`t` 的函数，所以该流体质点的速度应该写成

.. math::
	\begin{align}
	\mathbf{U}=\mathbf{U}\big(x(t),y(t),z(t),t\big)
	\end{align}

其中位置坐标 :math:`x,y,z` 对 :math:`t` 的导数等于对应速度矢量的分量。质点加速度是质点速度对时间的全导数，根据复合函数求导法则可以得到

.. math::
	\begin{align}
	\mathbf{a} = \frac{\mathrm{d} \mathbf{U}}{\mathrm{d} t}
	= \frac{\partial \mathbf{U}}{\partial t} + \frac{\partial \mathbf{U}}{\partial x}\frac{\mathrm{d} x}{\mathrm{d} t} +\frac{\partial \mathbf{U}}{\partial y}\frac{\mathrm{d} y}{\mathrm{d} t}+\frac{\partial \mathbf{U}}{\partial z} \frac{\mathrm{d} z}{\mathrm{d} t} 
	=\frac{\partial \mathbf{U}}{\partial t}+u_{x}\frac{\partial \mathbf{U}}{\partial x}+u_{y}\frac{\partial \mathbf{U}}{\partial y} +u_{z}\frac{\partial \mathbf{U}}{\partial z}       
	\end{align}

也即

.. math::
	\begin{align}
	\mathbf{a} = \frac{\partial \mathbf{U}}{\partial t} + (\mathbf{U} \cdot \nabla)\mathbf{U}
	\end{align}

可以看到，在欧拉法中质点加速度 :math:`\frac{\mathrm{d} \mathbf{U}}{\mathrm{d} t}` 由两部分组成： :math:`\frac{\partial \mathbf{U}}{\partial t}` 为固定空间点，由时间变化引起的加速度，称为 **时变加速度** ； :math:`(\mathbf{U} \cdot \nabla)\mathbf{U}` 为同一时刻，由流场的空间位置变化引起的加速度，称为 **位变加速度** 。

其他定义在流体质点上的物理量对时间的导数，也可以用相同的求法。因此可以把

.. math::
	\begin{align}
	\frac{\mathrm{D} }{\mathrm{D} t} \equiv \Big( \frac{\partial }{\partial t} +\mathbf{U}\cdot \nabla \Big)
	\end{align}

看作是一个算子，表示求 **物质导数** （material derivative）， :math:`\frac{\partial }{\partial t}` 表示求 **时变导数** （当地导数或局部导数）， :math:`\mathbf{U}\cdot \nabla` 表示 **位变导数** （迁移导数或对流导数）。

.. note:: 时变导数是由流场随时间变化的不恒定性引起的，而位变导数是由流场随空间变化的不均匀性引起的。



雷诺输运理论（Reynolds Transport Theorem）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

推导过程中规定的记号如下：

+------------------------+---------------------------------------------------------------------------------------+
| 符号                   | 含义                                                                                  |
+========================+=======================================================================================+
| :math:`B`              | 流体的任意物理属性（如质量、动量或能量等）                                            |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`b`              | 单位质量的流体所具有的 :math:`B` 的大小，即 :math:`b=\frac{\mathrm{d}B}{\mathrm{d}m}` |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`V(t)`           | 控制体的控制体积                                                                      |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`\mathbf{U}`     | 流体的流速                                                                            |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`\mathbf{U}_{s}` | 控制体表面的变形速度                                                                  |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`\mathbf{U}_{r}` | 流体流入或流出控制体的相对速度，即 :math:`\mathbf{U}_{r}=\mathbf{U}-\mathbf{U}_{s}`   |
+------------------------+---------------------------------------------------------------------------------------+

雷诺输运理论指出，控制体内 :math:`B` 随时间的变化率满足

.. math::
	\begin{align}
	\Big(\frac{\mathrm{d}B}{\mathrm{d}t}\Big)_{MV}
	= \frac{\mathrm{d}}{\mathrm{d}t}\Big( \int_{V(t)}b\rho~\mathrm{d}V\Big)
	+ \int_{\partial V(t)}b\rho \mathbf{U}_{r}\cdot \mathrm{d}\mathbf{S}
	\end{align}


对于一个固定的控制体，它的变形速度为 :math:`\mathbf{U}_{s}=\mathbf{0}` ，并且其体积也将独立于时间 :math:`t` ，于是

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}t}\Big( \int_{V(t)}b\rho~\mathrm{d}V\Big)
	= \int_{V}\frac{\partial }{\partial t}(b\rho)\mathrm{d}V  
	\end{align}

.. math::
	\begin{align}
	\int_{\partial V(t)}b\rho \mathbf{U}_{r}\cdot \mathrm{d}\mathbf{S}
	= \int_{\partial V}b\rho \mathbf{U}\cdot \mathrm{d}\mathbf{S}
	= \int_{V}\nabla \cdot (\rho\mathbf{U}b)~\mathrm{d}V 
	\end{align}

综上即可得到

.. math::
	\begin{align}
	\Big(\frac{\mathrm{d}B}{\mathrm{d}t}\Big)_{MV}
	= \int_{V}\Big(\frac{\partial }{\partial t}(\rho b) + \nabla \cdot (\rho\mathbf{U}b)\Big)\mathrm{d}V
	\end{align}

同时还可以改写成包含物质导数的形式：

.. math::
	\begin{align}
	\Big(\frac{\mathrm{d}B}{\mathrm{d}t}\Big)_{MV}
	= \int_{V}\Big(\frac{D }{D t}(\rho b) + \rho b\nabla \cdot \mathbf{U}\Big)\mathrm{d}V
	\end{align}





有关流场的几个基本概念
------------------------

恒定流与非恒定流
^^^^^^^^^^^^^^^^^^

若流场中各空间点上的任何运动要素不随时间变化，称流动为 **恒定流** ，否则称为 **非恒定流** 。在恒定流中，所有物理量的欧拉表达式中将不含时间，它们只是空间位置坐标的函数，时变导数为零，如恒定流的速度场、压力场、密度场：

.. math::
	\begin{align}
	\mathbf{U}=\mathbf{U}(x,y,z), \qquad p=p(x,y,z), \qquad \rho=\rho(x,y,z)
	\end{align}

.. math::
	\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} =0, \qquad \frac{\partial p}{\partial t}=0, \qquad \frac{\partial \rho}{\partial t}=0  
	\end{align}


.. note:: 实际工程中，多数系统在正常运行时，其中的流动参数不随时间变化，或随时间变化缓慢，可以作为恒定流处理。




迹线和流线
^^^^^^^^^^^^^

迹线是流体质点运动的轨迹，它是与拉格朗日观点相对应的概念。拉格朗日法中位移表达式 :math:`\mathbf{r}=\mathbf{r}(a,b,c,t)` 即为迹线的参数方程。而在欧拉观点下求迹线，因为需要跟定流体质点，此时欧拉变数 :math:`x,y,z` 成为 :math:`t` 的函数，所以迹线的微分方程为

.. math::
	\begin{align}
	\mathrm{d}\mathbf{r} = \mathbf{U}\big(x(t),y(t),z(t),t\big)\mathrm{d}t 
	\end{align}

这是由三个一阶常微分方程组成的方程组，未知变量为质点位置坐标 :math:`(x,y,z)` ，它是 :math:`t` 的函数。给定初始时刻质点的位置坐标，就可以积分得到迹线。


流线是流速场的矢量线，是某瞬时对应的流场中的一条曲线，该瞬时位于曲线上的流体质点的速度矢量都和该曲线相切。流线是与欧拉观点相对应的概念，可以形象化地描绘流场的空间分布。

在流线上某点取微元矢量 :math:`\mathrm{d}\mathbf{l}=\mathrm{d}x\mathbf{i}+\mathrm{d}y\mathbf{j}+\mathrm{d}z\mathbf{k}` ，根据定义，它应该与该点的速度矢量方向一致，所以

.. math::
	\begin{align}
	\mathbf{U} \times \mathrm{d}\mathbf{l} = 0
	\end{align}

也即

.. math::
	\begin{align}
	\frac{\mathrm{d} x}{u_{x}(x,y,z,t)} = \frac{\mathrm{d} y}{u_{y}(x,y,z,t)}=\frac{\mathrm{d} z}{\mathrm{u}_{z} (x,y,z,t)}   
	\end{align}

这就是直角坐标系中的流线微分方程。它包含两个独立方程，其中 :math:`t` 是参数。求解流线微分方程可以得到两族曲面，它们的交线就是流线族。

.. note:: 根据流线的定义可以推断：一般情况下，流线不能相交也不能转折。流线只在一些特殊点相交，如流速为零的点（驻点）、流速无穷大的点（奇点）以及流线相切点。在非恒定流情况下，流线一般会随时间变化；在恒定流情况下，流线不随时间变化，流体质点将沿着流线走，迹线与流线重合。




流管和流量
^^^^^^^^^^^^^

在流场中，取一条不与流线重合的封闭曲线 :math:`L` ，在同一时刻过 :math:`L` 上每一点作流线，由这些流线围成的管状曲面称为流管。这是一个瞬时概念，且在对应瞬时，流体不可能通过流管表面流出或流入。

与流动方向正交的流管横断面称为 **过流断面** 。过流断面为面积微元的流管称为 **元流管** ，其中的流称为 **元流** 。过流断面为有限面积的流管中的流动称为 **总流** 。总流可以看作是无数个元流的集合。总流的过流断面一般为曲面。

通过流场中某曲面 :math:`A` 的流速通量

.. math::
	\begin{align}
	Q_{A} = \iint\limits_{A}\mathbf{U} \cdot \mathbf{n}~\mathrm{d}A 
	\end{align}

称为 **流量** 。其中 :math:`\mathbf{U}` 是曲面 :math:`A` 上各点的流速矢量， :math:`\mathbf{n}` 是单位法线矢量。 :math:`Q` 的物理意义是单位时间通过该曲面的流体体积，所以也称为 **体积流量** ，单位为 :math:`\mathrm{m^{3}/s}` 。类似可以定义 **质量流量** （单位为 :math:`\mathrm{kg/s}` ）：

.. math::
	\begin{align}
	Q_{m} = \iint\limits_{A}\rho\mathbf{U}\cdot \mathbf{n}~\mathrm{d}A
	\end{align}


.. note:: 流量计算中曲面 :math:`A` 的法线指向必须明确，指向相反流量将反号。闭曲面的法向一般指所围区域的外法向。


总流过流断面上的流速与法向一致，所以通过过流断面 :math:`A` 的流量大小为 :math:`Q=\iint\limits_{A}u~\mathrm{d}A` ，其中 :math:`u` 为流速的大小。定义体积流量与断面面积之比

.. math::
	\begin{align}
	v = \frac{Q}{A} = \frac{\iint_{A}\mathbf{U}\cdot \mathbf{n}~\mathrm{d}A}{A}
	\end{align}

为断面平均流速。它是过流断面上不均匀流速 :math:`u` 的一个平均值，假设过流断面上各点流速大小均等于 :math:`v` ，方向与实际流动方向相同，则通过的流量与以不均匀流速 :math:`u` 流过此断面的实际流量相等。





均匀流、非均匀流；渐变流、急变流
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

把位变导数为零的流场中的流动称为 **均匀流** ，否则为 **非均匀流** 。均匀流的位变加速度 :math:`(\mathbf{U} \cdot \nabla )\mathbf{U}=0` ，速度矢量沿着流线不变。均匀流的流线一定是相互平行的直线，而非均匀流的流线要么是曲线，要么是不相平行的直线。

.. note:: 恒定均匀流的时变加速度和位变加速度都为零，即流体质点的惯性力为零，将作匀速直线运动。若总流为均匀流，那么其过流面是平面。

由于均匀流是一个绝对的概念，在工程实际中其判别标准难以完全满足，所以将接近于均匀流的流动称为 **渐变流** 。渐变流是流线虽不平行，但夹角较小或流线虽有弯曲但曲率较小的流动。反之，流线间夹角较大或流线弯曲的曲率较大的流动为 **急变流** 。



系统和控制体
^^^^^^^^^^^^^^^

由确定的流体质点组成的集合称为 **系统** 。系统在运动过程中，其空间位置、体积、形状都会随时间变化，但与外界没有物质交换。有限体积的系统叫做流体团；微分体积的系统叫做 **流体微团** ，指从有限体积的运动流体团中隔离出来的，在空间只占据一个体积微元、具有线性尺度效应的流体团；最小的系统时流体质点，它没有体积，仅占据一个空间点。

有流体流过的固定不变的空间区域称为 **控制体** ，其边界叫做控制面。不同的时间控制体将被不同的系统所占据。按大小可以划分为有限体积控制体、微元控制体和场点，它们可以分别被流体团、流体微团和流体质点所占据。

站在系统的角度观察和描述流体的运动及物理量的变化是拉格朗日方法的特征；而站在控制体的角度观察和描述流体的运动及物理量的变化是欧拉方法的特征。





流体微团运动的分析
--------------------

亥姆霍兹速度分解定理
^^^^^^^^^^^^^^^^^^^^^^

先对流体微团内一点 :math:`\hat{M}(x+\mathrm{d}x,y+\mathrm{d}y,z+\mathrm{d}z)` 的流速分量 :math:`\hat{u}_{x}` 以邻近点 :math:`M(x,y,z)` 为基点作如下一阶泰勒展开：

.. math::
	\begin{align}
	\hat{u}_{x} &\approx u_{x} + \frac{\partial u_{x}}{\partial x}\mathrm{d}x + \frac{\partial u_{x}}{\partial y}\mathrm{d}y + \frac{\partial u_{x}}{\partial z}\mathrm{d}z  \\
	&= u_{x} + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial x}+\frac{\partial u_{x}}{\partial x} \Big)\mathrm{d}x 
	         + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y}+\frac{\partial u_{y}}{\partial x} \Big)\mathrm{d}y
	         + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z}+\frac{\partial u_{z}}{\partial x} \Big)\mathrm{d}z
	         + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y}-\frac{\partial u_{y}}{\partial x} \Big)\mathrm{d}y
	         + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z}-\frac{\partial u_{z}}{\partial x} \Big)\mathrm{d}z  
	\end{align}

采用符号

.. math::
	\begin{align}
	& \varepsilon_{xx}=\frac{1}{2}\Big( \frac{\partial u_{x}}{\partial x}+\frac{\partial u_{x}}{\partial x} \Big)
	&& \varepsilon_{xy}=\frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y}+\frac{\partial u_{y}}{\partial x} \Big)
	&&& \varepsilon_{xz}=\frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z}+\frac{\partial u_{z}}{\partial x} \Big)
	\end{align}

.. math::
	\begin{align}
	& \omega_{x}=\frac{1}{2}\Big( \frac{\partial u_{z}}{\partial y} - \frac{\partial u_{y}}{\partial z} \Big) 
	&& \omega_{y}=\frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z} - \frac{\partial u_{z}}{\partial x} \Big) 
	&&& \omega_{z}=\frac{1}{2}\Big( \frac{\partial u_{y}}{\partial x} - \frac{\partial u_{x}}{\partial y}  \Big)
	\end{align}

则原式可以改写成

.. math::
	\begin{align}
	\hat{u}_{x}=u_{x} + \varepsilon_{xx}\mathrm{d}x + \varepsilon_{xy}\mathrm{d}y + \varepsilon _{xz}\mathrm{d}z - \omega_{z}\mathrm{d}y + \omega_{y}\mathrm{d}z 
	\end{align}

上式等号右边各项均为在基点 :math:`M` 处取值。同理可以得到另外两个分量的表达式：

.. math::
	\begin{align}
	& \hat{u}_{y} = u_{y} + \varepsilon_{yx}\mathrm{d}x + \varepsilon_{yy}\mathrm{d}y + \varepsilon_{yz}\mathrm{d}z - \omega_{x}\mathrm{d}z + \omega_{z}\mathrm{d}x  \\
	& \hat{u}_{z} = u_{z} + \varepsilon_{zx}\mathrm{d}x + \varepsilon_{zy}\mathrm{d}y + \varepsilon_{zz}\mathrm{d}z - \omega_{y}\mathrm{d}x + \omega_{x}\mathrm{d}y
	\end{align}


再合并成矢量表达式得到流体微元中任意两点间速度关系的一般形式，即 **亥姆霍兹速度分解定理** ：

.. math::
	\begin{align}
	\hat{\mathbf{U}} = \mathbf{U} + \boldsymbol{\varepsilon} \cdot \mathrm{d}\mathbf{r} + \boldsymbol{\omega} \times \mathrm{d}\mathbf{r}
	\end{align}

其中 **流体的变形速率张量** :math:`\boldsymbol{\varepsilon}` 为

.. math::
	\begin{align}
	\boldsymbol{\varepsilon}=
	\begin{bmatrix}
	 \varepsilon_{xx} & \varepsilon_{xy} & \varepsilon_{xz} \\
	 \varepsilon_{yx} & \varepsilon_{yy} & \varepsilon_{yz} \\
	 \varepsilon_{zx} & \varepsilon_{zy} & \varepsilon_{zz}
	\end{bmatrix} =
	\begin{bmatrix}
	 \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial x}+\frac{\partial u_{x}}{\partial x} \Big) &
	 \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y}+\frac{\partial u_{y}}{\partial x} \Big) & 
	 \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z}+\frac{\partial u_{z}}{\partial x} \Big) \\
	 \frac{1}{2}\Big( \frac{\partial u_{y}}{\partial x}+\frac{\partial u_{x}}{\partial y} \Big)  &
	 \frac{1}{2}\Big( \frac{\partial u_{y}}{\partial y}+\frac{\partial u_{y}}{\partial y} \Big)  &
	 \frac{1}{2}\Big( \frac{\partial u_{y}}{\partial z}+\frac{\partial u_{z}}{\partial y} \Big)  \\
	 \frac{1}{2}\Big( \frac{\partial u_{z}}{\partial x}+\frac{\partial u_{x}}{\partial z} \Big)  &
	 \frac{1}{2}\Big( \frac{\partial u_{z}}{\partial y}+\frac{\partial u_{y}}{\partial z} \Big)  &
	 \frac{1}{2}\Big( \frac{\partial u_{z}}{\partial z}+\frac{\partial u_{z}}{\partial z} \Big)
	\end{bmatrix}
	\end{align}

**流体的平均旋转角速度矢量** :math:`\boldsymbol{\omega}` 为

.. math::
	\begin{align}
	\boldsymbol{\omega} = (\omega_{x},\omega_{y},\omega_{z})
	= \Big[ 
	  \frac{1}{2}\Big( \frac{\partial u_{z}}{\partial y} - \frac{\partial u_{y}}{\partial z} \Big),
	  \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z} - \frac{\partial u_{z}}{\partial x} \Big),
	  \frac{1}{2}\Big( \frac{\partial u_{y}}{\partial x} - \frac{\partial u_{x}}{\partial y} \Big)
	  \Big]
	\end{align}


.. note:: 

	容易发现，变形速度张量满足 :math:`\varepsilon_{xy}=\varepsilon_{yx},\varepsilon_{xz}=\varepsilon_{zx},\varepsilon_{yz}=\varepsilon_{zy}` ，所以它是一个二阶对称张量，主对角线上三个元素是 **线变形速率** ，其余的是 **角变形速率** 。同时可以发现，变形速率张量可以用流速场的梯度来表示，即 :math:`\boldsymbol{\varepsilon}=\frac{1}{2}(\nabla\mathbf{U}+\nabla\mathbf{U}^{T})` 。

	旋转角速度矢量恰好是流速场旋度矢量的一般，即 :math:`\boldsymbol{\omega} = \frac{1}{2} \nabla \times \mathbf{U}` 。

	于是亥姆霍兹速度分解定理还可以如下表述：

	.. math::
		\begin{align}
		\hat{\mathbf{U}} = \mathbf{U} + \frac{1}{2}(\nabla\mathbf{U}^{T}+\nabla\mathbf{U})\cdot \mathrm{d}\mathbf{r} + (\frac{1}{2}\nabla\times \mathbf{U}) \times\mathrm{d}\mathbf{r}   
		\end{align}


- :math:`\hat{\mathbf{U}}` 是 :math:`\hat{M}` 点的流速；
- :math:`\mathbf{U}` 是 :math:`M` 点的流速，代表随基点的平移；
- :math:`\boldsymbol{\varepsilon}\cdot \mathrm{d}\mathbf{r}` 是流体变形引起的两点相对运动速度，包括线变形和角变形，代表变形运动；
- :math:`\boldsymbol{\omega}\times\mathrm{d}\mathbf{r}` 是流体平均旋转角速度引起的两点相对运动速度，代表绕基点的转动。



有旋流动和无旋流动
^^^^^^^^^^^^^^^^^^^^^

判断流动是否无旋的充分必要条件是流体的平均旋转角速度矢量 :math:`\boldsymbol{\omega}` 或旋度矢量 :math:`\nabla \times \mathbf{U}` 是否为零。把 :math:`\boldsymbol{\omega}=0` 或 :math:`\nabla \times \mathbf{U}=0` 的流动称为 **无旋流动** ，否则称为 **有旋流动** 。

注意到无旋流动的流速场条件 :math:`\nabla \times \mathbf{U}=0` 写成分量形式满足

.. math::
	\begin{align}
	\frac{\partial u_{z}}{\partial y}=\frac{\partial u_{y}}{\partial z}, \quad \frac{\partial u_{x}}{\partial z}=\frac{\partial u_{z}}{\partial x}, \quad \frac{\partial u_{y}}{\partial x}=\frac{\partial u_{x}}{\partial y}      
	\end{align}

上式是使 :math:`u_{x}\mathrm{d}x+u_{y}\mathrm{d}y+u_{z}\mathrm{d}z` 成为某个函数 :math:`\varphi` 的全微分的充分必要条件，因此无旋流动必然存在一个标量场 :math:`\varphi(x,y,z)` ，它与速度场之间满足关系：

.. math::
	\begin{align}
	\nabla \varphi = \mathbf{U}
	\end{align}

该标量场称为 **流速场的势函数** ，简称 **速度势** 。存在速度势是有势流动区别于有旋流动的基本特征，因为速度势的梯度就是流速矢量，所以用求解标量场 :math:`\varphi` 代替求解矢量场 :math:`\mathbf{U}` 可以大大简化分析过程。

.. attention:: 有旋流动和有势流动的判别仅在于流速场的旋度是否为零，不涉及流动是恒定还是非恒定，是均匀流还是非均匀流，也不涉及流线是直线还是曲线。






连续性方程
-------------


微分形式的连续性方程
^^^^^^^^^^^^^^^^^^^^^^^^

接下来从空间位置固定的无穷小微团角度出发来推导连续性方程。欧拉观点下，质量守恒意味着固定无穷小微团质量的变化=流入无穷小微团质量-流出无穷小微团质量，也即位置固定无穷小微团质量的变化率=(流入无穷小微团质量-流出无穷小微团质量)的变化率。

流体微团的体积可以表示为 :math:`\mathrm{d}V=\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，结合密度 :math:`\rho` 则得到对应的无穷小微团质量为 :math:`\mathrm{d}m=\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z` 。根据质量变化率的定义，其可以表示为

.. math::
	\begin{align}
	\frac{\partial \mathrm{d}m }{\partial t}=\frac{\partial \rho \mathrm{d}x\mathrm{d}y\mathrm{d}z }{\partial t}=\frac{\partial \rho}{\partial t}\mathrm{d}x\mathrm{d}y\mathrm{d}z   
	\end{align}

下面考虑笛卡尔坐标系下无穷小微团的流入和流出。先说明 :math:`x` 方向上的通量。定义无穷小微团立方体左侧单位面积的质量为 :math:`\rho u` ，同时也是单位时间内流入单位面积的质量，而立方体左侧的面积为 :math:`\mathrm{d}y\mathrm{d}z` ，因此得到单位时间内流入的质量为 :math:`\rho u\mathrm{d}y\mathrm{d}z` 。对于立方体右侧的面，在已知立方体左侧面 :math:`\rho u` 的定义的时候，可以通过泰勒公式求出单位时间内流出立方体右侧的单位面积的质量为 :math:`\rho u+\frac{\partial \rho u}{\partial x}\mathrm{d}x` 。同样的，立方体右侧面的面积为 :math:`\mathrm{d}y\mathrm{d}z` ，因此有单位时间内流出的质量约为

.. math::
	\begin{align}
	\left ( \rho u + \frac{\partial \rho u}{\partial x} \mathrm{d}x \right ) \mathrm{d}y\mathrm{d}z  
	\end{align}

.. note:: 
	
	这里利用的是带步长表示的泰勒公式，即对于一个函数， :math:`x_{0}` 点的值为 :math:`f(x_{0})` ，那么函数在 :math:`x_{0}+h` 的值通过下面方程求得

	.. math::
		\begin{align}
		f(x_{0}+h)=f(x_{0})+f'(x_{0})h+O(h)\approx f(x_{0})+f'(x_{0})h
		\end{align}

	在上述推导的情景中， :math:`h` 为 :math:`dx` ，求导操作变为 :math:`\rho u` 在 :math:`x` 方向的偏导。因为忽略了无穷小量 :math:`O(h)` ，所以结果是约等于。

.. attention:: 因为使用了泰勒公式，假定了函数是连续可微的，然而当存在激波之类的问题时该假定不成立，这种情况下需要从积分的角度来推导连续性方程。


结合无穷小微团单位时间的流出质量和无穷小单位时间的流入质量，就可以得到单位时间内 :math:`x` 方向的净质量变化率为

.. math::
	\begin{align}
	\rho u\mathrm{d}y\mathrm{d}z - \left ( \rho u + \frac{\partial \rho u}{\partial x}\mathrm{d}x\right ) \mathrm{d}y\mathrm{d}z = -\frac{\partial \rho u}{\partial x}\mathrm{d}x\mathrm{d}y\mathrm{d}z  
	\end{align}

同理可以得到 :math:`y` 方向的净质量变化率为 :math:`-\frac{\partial \rho v}{\partial y}\mathrm{d}x\mathrm{d}y\mathrm{d}z` ， :math:`z` 方向的净质量变化率为 :math:`-\frac{\partial \rho w}{\partial z}\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，将各个方向的质量变化率加起来就得到总质量变化率为 :math:`-\left ( \frac{\partial \rho u}{\partial x} + \frac{\partial \rho v}{\partial y} + \frac{\partial \rho w}{\partial z}  \right )\mathrm{d}x\mathrm{d}y\mathrm{d}z` 。回到最开始质量变化率的定义，即可得到连续性方程：

.. math::
	\begin{align}
	\frac{\partial \rho}{\partial t}\mathrm{d}x\mathrm{d}y\mathrm{d}z = -\left ( \frac{\partial \rho u}{\partial x} + \frac{\partial \rho v}{\partial y} + \frac{\partial \rho w}{\partial z}  \right )\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\quad \Rightarrow \quad 
	\frac{\partial \rho}{\partial t} + \frac{\partial \rho u}{\partial x} + \frac{\partial \rho v}{\partial y} + \frac{\partial \rho w}{\partial z} =0
	\end{align}

也即

.. math::
	\begin{align}
	\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho\mathbf{U})=0 
	\end{align}


.. note:: 

	对于恒定流，由于 :math:`\frac{\partial \rho}{\partial t}=0` ，所以连续性方程化简为

	.. math::
		\begin{align}
		\nabla \cdot (\rho\mathbf{U})=0
		\end{align}

	对于不可压缩流体的流动（不管是恒定或非恒定），则有

	.. math::
		\begin{align}
		\nabla \cdot \mathbf{U} = 0
		\end{align}

	上式表示速度场的散度为零，称这样的速度场是无源场或管形场。

.. note:: 速度场的散度是流体微团在三个互相垂直方向上的线变形速率之和，也是流体微团的体积膨胀率。连续性方程表明不可压缩流体微团在三个互相垂直方向上的线变形速率的总和必须为零，如果在一个方向上有拉伸，则必定有另一个方向上的压缩，在运动过程中其体积不会发生变化。







积分形式的连续性方程
^^^^^^^^^^^^^^^^^^^^^^^^

下面考虑从空间位置固定的有限控制体推导连续性方程。有限控制体和无穷小微团的关系可以理解为，有限控制体包含着很多的无穷小微团，因此有限控制体中的量都需要用积分来进行计算。对于空间位置固定的有限控制体，其质量为 :math:`\int \rho~\mathrm{d}V` ，则对应的质量变化率为 :math:`\frac{\partial }{\partial t}\int \rho~\mathrm{d}V` 。在有限控制体表面上的面微元的通量可以定义为 :math:`\rho \boldsymbol{U}\cdot \mathrm{d}\boldsymbol{S}` ，那么整个有限控制体的净通量可以表示为 :math:`-\int_{\boldsymbol{S}}\rho \boldsymbol{U}\cdot \mathrm{d}\boldsymbol{S}` ，从而就有

.. math::
	\begin{align}
	\frac{\partial }{\partial t}\int _{V}\rho~\mathrm{d}V + \int_{\boldsymbol{S}}\rho\boldsymbol{U}\cdot\mathrm{d}\boldsymbol{S}=0  
	\end{align}

.. note:: 封闭面的面矢量 :math:`\boldsymbol{S}` 一般指向外部，因此考虑到需要的是流入减去流出的通量，所以净通量在表示的时候引入了负号。

假定函数是光滑连续的，则使用高斯定律，上述方程就可以化简为

.. math::
	\begin{align}
	\frac{\partial \rho}{\partial t}+\nabla \cdot \rho \boldsymbol{U}=0
	\end{align}


此外，对原积分形式连续性方程对时间做积分，就得到另一种积分形式的连续性方程：

.. math::
	\begin{align}
	\int_{t}^{t+\Delta t}\frac{\partial }{\partial t}\int_{V}\rho~\mathrm{d}V\mathrm{d}\tau + \int_{t}^{t+\Delta t}\int_{\boldsymbol{S}}\rho\boldsymbol{U}\cdot\mathrm{d}\boldsymbol{S}\mathrm{d}\tau=0
	\end{align}

.. math::
	\begin{align}
	\int_{V}\rho(t+\Delta t)\mathrm{d}V-\int_{V}\rho(t)\mathrm{d}V=-\int_{t}^{t+\Delta t}\left ( \int_{\boldsymbol{S}}\rho(\tau)\boldsymbol{U}(\tau)\cdot \mathrm{d}\boldsymbol{S}  \right )\mathrm{d}\tau 
	\end{align}

上述方程左侧表示在体积 :math:`V` 上时间间隔 :math:`\Delta t` 上质量的变化；右侧则考虑通量的变化形式，同样表示体积 :math:`V` 上时间间隔 :math:`\Delta t` 上质量的变化。如果知道右侧 :math:`\rho(t')\boldsymbol{U}(t')` 的精确值，那么结果就是精确的。该方程主要用于双曲系统来推导高阶通量格式，例如HLL格式，其通过 :math:`V` 将黎曼扇区域进行包围并假定 :math:`\rho(t')\boldsymbol{U}(t')` 的近似值即可获得网格面上的通量。



恒定总流的连续性方程
^^^^^^^^^^^^^^^^^^^^^^^

在恒定总流中取出一段上游过流断面 :math:`A_{1}` 和下游过流断面 :math:`A_{2}` 之间的总流管作为控制体，考察流经其中的恒定总流。在恒定条件下，总流管的形状、位置不随时间变化。总流内的流体是不存在空隙的连续介质，其密度分布恒定，所以这段总流管内的流体质量也不随时间变化。没有流体通过总流管侧壁流入或流出，流体只能通过两个过流断面进出控制体。

根据质量守恒，在单位时间内通过 :math:`A_{1}` 流入控制体的流体质量等于通过 :math:`A_{2}` 流出控制体的流体质量，即

.. math::
	\begin{align}
	\iint\limits_{A_{1}}\rho u~\mathrm{d}A=\iint\limits_{A_{2}}\rho u~\mathrm{d}A  
	\end{align}

这就是恒定条件下 **总流的连续方程** ，表明通过恒定总流两个过流断面的质量流量相等。

如果流体不可压，则 :math:`\rho=\text{const}` ，从而

.. math::
	\begin{align}
	\iint\limits_{A_{1}}u~\mathrm{d}A=\iint\limits_{A_{2}}u~\mathrm{d}A  
	\quad\Rightarrow \quad 
	Q_{1}=Q_{2}  
	\quad \text{or} \quad 
	A_{1}v_{1}=A_{2}v_{2} 
	\end{align}

也即通过两个过流断面的体积流量相等，称为 **不可压缩流体恒定总流的连续方程** 。可以看到，在同一恒定流股中，当沿流程过流断面发生变化时，流速也必定随之变化，并且符合断面平均流速与过流断面面积成反比的关系。断面大的地方流速小，断面小的地方流速大。或者说流线密集的地方流速大，流线稀疏的地方流速小。





流体动力学基础
================

运动流体的应力状态
---------------------

在运动中的流体中，既可能有压应力又可能有切应力。把流体在运动状态下的压应力称为 **流体动压强** 。在运动的理想流体里，由于没有粘滞性的作用，虽然有质点的相对运动，也不会产生切应力，因此在运动的流体中只有流体动压强，而且可以用分析流体静压强特性的方法推论：任一点的流体动压强在各方向上的大小都相等，和流体静压强有同样的特性。

在运动的实际流体中，取一个流体微团来分析它的应力效应，由于粘滞性作用，既有压应力又有切应力。任一点处的应力是矢量，而且还与作用面方向有关，可以用二阶张量来表示：

.. math::
	\begin{align}
	\boldsymbol{\sigma} = 
	\begin{bmatrix}
	 \sigma_{xx} & \sigma_{xy} & \sigma_{xz} \\
	 \sigma_{yx} & \sigma_{yy} & \sigma_{yz} \\
	 \sigma_{zx} & \sigma_{zy} & \sigma_{zz}
	\end{bmatrix}
	\end{align}

其中每个分量的两个角标的含义是：前一个表示作用面的法向方向；后一个表示应力分量的投影方向。

.. note:: 应力张量是对称的，因为只有其为对称的（净扭矩为零）才能防止发生旋转。

根据应力张量 :math:`\boldsymbol{\sigma}` 可以得到任意方位作用面上的应力：

.. math::
	\begin{align}
	\boldsymbol{\sigma}_{n} = \mathbf{n} \cdot \boldsymbol{\sigma}=
	\begin{bmatrix}
	\sigma_{xx}n_{x}+\sigma_{yx}n_{y}+\sigma_{zx}n_{z} \\
	\sigma_{xy}n_{x}+\sigma_{yy}n_{y}+\sigma_{zy}n_{z} \\
	\sigma_{xz}n_{x}+\sigma_{yz}n_{y}+\sigma_{zz}n_{z}
	\end{bmatrix}
	\end{align}

应力张量主对角线上三个元素之和 :math:`\sigma_{xx}+\sigma_{yy}+\sigma_{zz}` 是坐标变换中的不变量，即其值不随坐标轴的转动而改变。任意三个相互垂直的作用面上的法应力之和都是相同的，于是可以定义 **流体动压强** 为

.. math::
	\begin{align}
	p = -\frac{1}{3}(\sigma_{xx}+\sigma_{yy}+\sigma_{zz})
	\end{align}

它只取决于场点位置，而与作用面的方位无关，所以运动流体中存在一个标量场性质的动压强场。

.. attention:: 流体动压强 :math:`p` 并不是任意方位作用面上真正的压应力 :math:`-p_{m}` 。

可以将应力张量写成

.. math::
	\begin{align}
	\boldsymbol{\sigma} = 
	\begin{bmatrix}
	 \sigma_{xx}+p & \sigma_{xy} & \sigma_{xz} \\
	 \sigma_{yx} & \sigma_{yy}+p & \sigma_{yz} \\
	 \sigma_{zx} & \sigma_{zy} & \sigma_{zz}+p
	\end{bmatrix}
	- p
	\begin{bmatrix}
	 1 & 0 & 0 \\
	 0 & 1 & 0 \\
	 0 & 0 & 1
	\end{bmatrix}
	=\boldsymbol{\tau}-p\mathbf{I}
	\end{align}

其中 :math:`\boldsymbol{\tau}` 称为 **偏应力张量** ，其主对角线上三个元素 :math:`\tau_{xx},\tau_{yy},\tau_{zz}` 称为 **粘性附加法应力** ，它们的和为零；其他则为切应力。偏应力张量完全是由粘性引起的，理想流体的偏应力张量为零。


对于牛顿流体，其定义剪切应力（偏应力）和形变率为线性的关系，进一步加上不可压缩的条件（忽略体膨胀率）则有 **广义牛顿内摩擦定律** ：

.. math::
	\begin{align}
	\boldsymbol{\tau} = 2\mu\boldsymbol{\varepsilon}=\mu(\nabla\mathbf{U}+\nabla\mathbf{U}^{T})
	\end{align}


.. note:: 

	可压缩流体完整的形式为

	.. math::
		\begin{align}
		\boldsymbol{\tau} = \mu(\nabla\mathbf{U}+\nabla\mathbf{U}^{T})-\lambda(\nabla\cdot \mathbf{U})\mathbf{I}
		\end{align}

	其中 :math:`\lambda` 为体积粘度（第二粘度系数）。Stokes认为 :math:`\lambda=\frac{2}{3}\mu` 。加上不可压缩流体速度场散度为零 :math:`\nabla\cdot\mathbf{U}=0` 即可化简得到上式。




流体运动微分方程（动量方程）
------------------------------

根据动量守恒定律可以得到欧拉观点下的动量方程。在流场中取出一个空间六面体微元作为控制体，其边长为 :math:`\mathrm{d}x,\mathrm{d}y,\mathrm{d}z` 。首先讨论该微元内流体在x方向的受力情况，作用于六面体表面沿x方向的表面力有

- 前后一对面元法向力： :math:`-\sigma_{xx}\mathrm{d}y\mathrm{d}z + \Big( \sigma_{xx}+\frac{\partial \sigma_{xx}}{\partial x}\mathrm{d}x \Big)\mathrm{d}y\mathrm{d}z` ；
- 左右一对面切向力： :math:`-\sigma_{yx}\mathrm{d}x\mathrm{d}z + \Big( \sigma_{yx}+\frac{\partial \sigma_{yx}}{\partial y}\mathrm{d}y \Big)\mathrm{d}x\mathrm{d}z` ；
- 上下一对面切向力： :math:`-\sigma_{zx}\mathrm{d}x\mathrm{d}y + \Big( \sigma_{zx}+\frac{\partial \sigma_{zx}}{\partial z}\mathrm{d}z \Big)\mathrm{d}x\mathrm{d}y` 。
  
将上述力相加得到沿x方向的总表面力为

.. math::
	\begin{align}
	\Big( \frac{\partial \sigma_{xx}}{\partial x} + \frac{\partial \sigma_{yx}}{\partial y} + \frac{\partial \sigma_{zx}}{\partial z}\Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	= \Big( \frac{\partial (\tau_{xx}-p)}{\partial x} + \frac{\partial \tau_{yx}}{\partial y} + \frac{\partial \tau_{zx}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	= \Big( -\frac{\partial p}{\partial x} + \frac{\partial \tau_{xx}}{\partial x} +  \frac{\partial \tau_{yx}}{\partial y} + \frac{\partial \tau_{zx}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{align}

其他方向的总表面力同理，最终可以得到

.. math::
	\begin{align}
	\mathbf{F} = 
	\begin{bmatrix}
	\Big( -\frac{\partial p}{\partial x} + \frac{\partial \tau_{xx}}{\partial x} +  \frac{\partial \tau_{yx}}{\partial y} + \frac{\partial \tau_{zx}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z \\
	\Big( -\frac{\partial p}{\partial y} + \frac{\partial \tau_{xy}}{\partial x} +  \frac{\partial \tau_{yy}}{\partial y} + \frac{\partial \tau_{zy}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z \\
	\Big( -\frac{\partial p}{\partial z} + \frac{\partial \tau_{xz}}{\partial x} +  \frac{\partial \tau_{yz}}{\partial y} + \frac{\partial \tau_{zz}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{bmatrix}
	= (-\nabla p + \nabla \cdot \boldsymbol{\tau})\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{align}


流体微团的质量可以表示为 :math:`\mathrm{d}m=\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，同时流体微团的加速度为 :math:`\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}=\frac{\partial \mathbf{U}}{\partial t}+(\mathbf{U}\cdot \nabla)\mathbf{U}` ，于是动量方程为（同时考虑质量力）：

.. math::
	\begin{align}
	(\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}=(-\nabla p + \nabla \cdot \boldsymbol{\tau})\mathrm{d}x\mathrm{d}y\mathrm{d}z + (\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\mathbf{f}
	\end{align}

也即

.. math::
	\begin{align}
	\rho\Big(\frac{\partial \mathbf{U}}{\partial t}+\mathbf{U}\cdot\nabla\mathbf{U} \Big)=-\nabla p +\nabla\cdot \boldsymbol{\tau} +\rho\mathbf{f}
	\end{align}


上式为动量方程的非守恒形式，因为上述动量方程是从空间位置移动的无穷小微团进行推导的。非守恒控制方程可以通过结合连续性方程转化为守恒的控制方程：将连续性方程左右同时乘以 :math:`\mathbf{U}` 得到

.. math::
	\begin{align}
	\mathbf{U}\frac{\partial \rho}{\partial t}+\mathbf{U}\nabla\cdot(\rho\mathbf{U})=0
	\end{align}

与非守恒形式的动量方程相加得到

.. math::
	\begin{align}
	\mathbf{U}\frac{\partial \rho}{\partial t} + \rho\frac{\partial \mathbf{U}}{\partial t}  + \mathbf{U} \nabla \cdot (\rho\mathbf{U}) +\rho\mathbf{U}\cdot \nabla\mathbf{U}=-\nabla p+\nabla\cdot \boldsymbol{\tau}+\rho\mathbf{f}
	\end{align}

根据导数的四则运算法则和nabla算子的运算法则可以得到守恒形式的动量方程：

.. math::
	\begin{align}
	\frac{\partial \rho\mathbf{U}}{\partial t} + \nabla \cdot (\rho\mathbf{U}\mathbf{U}) = -\nabla p + \nabla\cdot \boldsymbol{\tau} + \rho\mathbf{f}
	\end{align}

.. note:: 

	也可以借助雷诺输运理论来推导出上式：

	.. math::
		\begin{align}
		\Big(\frac{\mathrm{d}(m\mathbf{U})}{\mathrm{d}t} \Big)_{MV} = \int_{V}\Big(\frac{\partial \rho\mathbf{U}}{\partial t} + \nabla\cdot(\rho\mathbf{UU}) \Big)\mathrm{d}V = \int_{V}(-\nabla p + \nabla \cdot \boldsymbol{\tau})~\mathrm{d}V + \int_{V}\rho \mathbf{f}~\mathrm{d}V 
		\end{align}


考虑不可压缩牛顿流体，将广义牛顿内摩擦定律代入上式，并且由于不可压缩密度恒定为常量可以在等式两边同除，得到

.. math::
	\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} + \nabla\cdot(\mathbf{U}\mathbf{U}) = -\frac{1}{\rho}\nabla p + \nabla \cdot \big( \nu(\nabla\mathbf{U}+\nabla\mathbf{U}^{T}) \big)  + \mathbf{f}
	\end{align}


根据一个标量可以任意交换偏导次序以及在不可压缩流中速度场散度为零，可以发现

.. math::
	\begin{align}
	\nabla \cdot (\nabla \mathbf{U}^{T}) =
	\nabla \cdot 
	\begin{bmatrix}
	 \frac{\partial u_{x}}{\partial x} & \frac{\partial u_{x}}{\partial y} & \frac{\partial u_{x}}{\partial z} \\
	 \frac{\partial u_{y}}{\partial x} & \frac{\partial u_{y}}{\partial y} & \frac{\partial u_{y}}{\partial z} \\
	 \frac{\partial u_{z}}{\partial x} & \frac{\partial u_{z}}{\partial y} & \frac{\partial u_{z}}{\partial z}
	\end{bmatrix}
	=
	\begin{bmatrix}
	\frac{\partial }{\partial x}(\frac{\partial u_{x}}{\partial x}) + \frac{\partial }{\partial y}(\frac{\partial u_{y}}{\partial x}) + \frac{\partial }{\partial z}(\frac{\partial u_{z}}{\partial x}) \\
	\frac{\partial }{\partial x}(\frac{\partial u_{x}}{\partial y}) + \frac{\partial }{\partial y}(\frac{\partial u_{y}}{\partial y}) + \frac{\partial }{\partial z}(\frac{\partial u_{z}}{\partial y}) \\
	\frac{\partial }{\partial x}(\frac{\partial u_{x}}{\partial z}) + \frac{\partial }{\partial y}(\frac{\partial u_{y}}{\partial z}) + \frac{\partial }{\partial z}(\frac{\partial u_{z}}{\partial z})
	\end{bmatrix}
	=
	\begin{bmatrix}
	\frac{\partial }{\partial x}(\frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} + \frac{\partial u_{z}}{\partial z} )  \\
	\frac{\partial }{\partial y}(\frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} + \frac{\partial u_{z}}{\partial z} )  \\
	\frac{\partial }{\partial z}(\frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} + \frac{\partial u_{z}}{\partial z} )
	\end{bmatrix}
	= \mathbf{0}
	\end{align}


因此，不可压缩粘性流体的动量方程最终可以写为

.. math::
	\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} + \nabla \cdot (\mathbf{U}\mathbf{U}) = -\frac{1}{\rho}\nabla p + \nabla \cdot (\nu\nabla\mathbf{U}) + \mathbf{f} 
	\end{align}


对于理想流体的情况，由于不存在粘性即 :math:`\nu=0` ，流体中没有切应力，从而动量方程简化为

.. math::
	\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} + \nabla \cdot (\mathbf{U}\mathbf{U}) = -\frac{1}{\rho}\nabla p + \mathbf{f}
	\end{align}


对于可压缩流体，重新代入正确的 :math:`\boldsymbol{\tau}` 的表达式，可以得到完整的动量方程：

.. math::
	\begin{align}
	\frac{\partial \rho\mathbf{U}}{\partial t} 
	+ \nabla \cdot (\rho\mathbf{U}\mathbf{U}) 
	= -\nabla p 
	+ \nabla \cdot \Big( \mu (\nabla\mathbf{U}+\nabla\mathbf{U}^{T})-\frac{2}{3}\mu(\nabla\cdot\mathbf{U})\mathbf{I} \Big)
	+ \rho\mathbf{f}
	\end{align}

.. attention:: 其中的 :math:`\nabla\mathbf{U}^{T}` 并不能化简，因为可压缩流体的 :math:`\nabla \cdot \mathbf{U} \ne 0` 。






能量方程
----------

根据能量守恒定律，可以定义绝热系统的总能量是一个常数，单位为 :math:`\mathrm{J} = \mathrm{N\cdot m} = \mathrm{kg \cdot m^{2} \cdot s^{-2}}` 。涉及到的能量相关量包括：

+-----------------+----------+---------------------------------------------------------------------------------------------------+
| 符号            | 含义     | 解释                                                                                              |
+=================+==========+===================================================================================================+
| :math:`\hat{E}` | 总能     | 控制体所具有的总能量                                                                              |
+-----------------+----------+---------------------------------------------------------------------------------------------------+
| :math:`e`       | 比内能   | 单位质量的内能                                                                                    |
+-----------------+----------+---------------------------------------------------------------------------------------------------+
| :math:`K`       | 比机械能 | 单位质量的动能，可以定义为 :math:`K=\frac{1}{2} [\mathbf{U} ] ^{2}`                               |
+-----------------+----------+---------------------------------------------------------------------------------------------------+
| :math:`E`       | 比能     | 单位质量的总能量，即 :math:`E = K + e` ，同时满足 :math:`E=\frac{\mathrm{d}\hat{E}}{\mathrm{d}m}` |
+-----------------+----------+---------------------------------------------------------------------------------------------------+
| :math:`h`       | 比焓     | 单位质量的焓                                                                                      |
+-----------------+----------+---------------------------------------------------------------------------------------------------+


热力学第一定律表明，物体内能的增加等于物体吸热的能量变化和对物体所作的功的总和。考虑一单位体积控制体，其内部包含固定的流体微团，跟随这一控制体查看其所含能量的时间变化率 :math:`\Big(\frac{\mathrm{d}\hat{E}}{\mathrm{d}t} \Big)_{MV}` 。定义 **热通量** :math:`\mathbf{q}` 表示单位时间、单位面积能量，是一个矢量场，单位为 :math:`\mathrm{w/m^{2}}` 或 :math:`\mathrm{kg/s^{3}}` 。热通量用来表征温度导致的每单位时间单位面积的能量变化，其与温度梯度直接相关，满足关系

.. math::
	\begin{align}
	\mathbf{q} = -k\nabla T
	\end{align}

其中 :math:`k` 表示热导率。由于热通量导致控制体在单位时间的能量变化可以如下表示：

.. math::
	\begin{align}
	\int_{\partial V}\mathbf{q} \cdot \mathrm{d}\mathbf{S} 
	= \int_{V}\nabla \cdot \mathbf{q}~\mathrm{d}V 
	= \int_{V}\nabla \cdot (-k\nabla T)~\mathrm{d}V 
	\end{align}

.. note:: 由于 :math:`\mathrm{d}\mathbf{S}` 指向流体微团表面外侧，所以上式表述的是流体微团向外输出的能量，即流体微团所减少的能量。

除了热通量引起能量的变化之外，应力做功也会引起能量变化。应力张量做功所对应的功率可以如下进行表示：

.. math::
	\begin{align}
	\int_{\partial V}\boldsymbol{\sigma} \cdot \mathbf{U} \cdot \mathrm{d}\mathbf{S}
	= \int_{\partial V} \mathrm{d}\mathbf{F} \cdot \mathbf{U}
	= \int_{\partial V}\mathrm{d}P
	= \int_{V}\nabla\cdot(\boldsymbol{\sigma} \cdot \mathbf{U})~\mathrm{d}V 
	\end{align}

其中的 :math:`P` 表示应力张量做功的功率（也即通过做功给流体微团单位时间输入的能量），同时可以将应力张量分解为压力贡献和粘性贡献：

.. math::
	\begin{align}
	\nabla \cdot (\boldsymbol{\sigma} \cdot \mathbf{U})
	= \nabla \cdot \big( (\boldsymbol{\tau} - p\mathbf{I}) \cdot \mathbf{U} \big)
	= \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U}) - \nabla \cdot (p\mathbf{U})
	\end{align}

综上，能量方程可以表示为

.. math::
	\begin{align}
	\Big(\frac{\mathrm{d}\hat{E}}{\mathrm{d}t} \Big)_{MV}
	= \int_{V}\Big(\frac{\partial }{\partial t}(\rho E) + \nabla \cdot (\rho\mathbf{U}E)\Big)\mathrm{d}V
	= -\int_{V}\nabla\cdot\mathbf{q}~\mathrm{d}V
	+ \int_{V}\nabla \cdot (\sigma \cdot \mathbf{U})~\mathrm{d}V 
	\end{align}

.. math::
	\begin{align}
	\frac{\partial \rho E}{\partial t} + \nabla \cdot (\rho\mathbf{U}E)
	= \nabla \cdot (k\nabla T) 
	+ \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U}) 
	- \nabla \cdot (p\mathbf{U})
	\end{align}


将比能分解为 :math:`E = e + K` 即可得到 **比能方程** ：

.. math::
	\begin{align}
	\frac{\partial \rho e}{\partial t} 
	+ \nabla \cdot (\rho\mathbf{U}e)
	+ \frac{\partial \rho K}{\partial t}
	+ \nabla \cdot (\rho\mathbf{U}K)
	- \nabla \cdot (k\nabla T)
	+ \nabla \cdot (p\mathbf{U}) 
	= \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U})
	\end{align}


进一步地，利用焓等式 :math:`e = h-p/\rho` 代入上式则可以得到 **比焓方程** ：

.. math::
	\begin{align}
	\frac{\partial \rho h}{\partial t} 
	+ \nabla \cdot (\rho\mathbf{U}h) 
	+ \frac{\partial \rho K}{\partial t}
	+ \nabla \cdot (\rho\mathbf{U}K)
	- \nabla \cdot (k\nabla T)
	- \frac{\partial p}{\partial t}
	= \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U}) 
	\end{align}


.. note:: 

	在OpenFOAM中，热通量项通常并不与温度变量建立起来关系，而是与比内能 :math:`e` 建立关系：

	.. math::
		\begin{align}
		\mathbf{q} = -\alpha_{\text{eff}}\nabla e
		\end{align}

	其中 :math:`\alpha_{\text{eff}}` 表示层流热扩散系数以及湍流热扩散系数之和。



对于不可压缩或者弱可压缩情况，考虑其动量方程的形式为

.. math::
	\begin{align}
	\rho\frac{\mathrm{D}\mathbf{U}}{\mathrm{D}t} = \nabla \cdot \boldsymbol{\tau} - \nabla p
	\end{align}

在方程两边同时点乘速度可以得到

.. math::
	\begin{align}
	\rho\frac{\mathrm{D}\mathbf{U}}{\mathrm{D}t}\cdot \mathbf{U}
	= \rho\frac{\mathrm{D}(\frac{1}{2}u^{2})}{\mathrm{D}t}
	= \rho\frac{\mathrm{D}K}{\mathrm{D}t}
	= (\nabla \cdot \boldsymbol{\tau}) \cdot \mathbf{U} - \mathbf{U} \cdot \nabla p   
	\end{align}

上式与比能方程相减则得到

.. math::
	\begin{align}
	\frac{\partial \rho e}{\partial t} 
	+ \nabla \cdot (\rho \mathbf{U}e) 
	+ p\nabla \cdot \mathbf{U}
	- \nabla \cdot (k\nabla T)
	= \boldsymbol{\tau} : \nabla \mathbf{U}
	\end{align}

对于不可压缩或弱可压缩的情况， :math:`\boldsymbol{\tau} : \nabla \mathbf{U}` 可以忽略，因此最终得到 **比内能方程** ：

.. math::
	\begin{align}
	\frac{\partial \rho e}{\partial t} 
	+ \nabla \cdot (\rho \mathbf{U}e) 
	+ p\nabla \cdot \mathbf{U}
	- \nabla \cdot (k\nabla T)
	= 0
	\end{align}



理想流体恒定元流的能量方程
-----------------------------


伯努利积分（理想流体恒定流动沿流线的积分）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

将理想流体的动量方程写成如下形式：

.. math::
	\begin{align}
	\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t} = \mathbf{f} - \frac{1}{\rho}\nabla p  
	\end{align}

在流线上沿流动方向取一段弧长 :math:`(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)` 。因为恒定流动的流线不随时间变化，所以流体质点将沿着流线运动，迹线与流线重合，流线上的一段弧长也是流体质点的一段位移 :math:`\mathrm{d}\mathbf{r} = (\mathrm{d}x,\mathrm{d}y,\mathrm{d}z) = \mathbf{U}\mathrm{d}t` ，将其乘在上式的两边则得到

.. math::
	\begin{align}
	\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t} \cdot \mathbf{U}\mathrm{d}t = (\mathbf{f} - \frac{1}{\rho}\nabla p)\cdot\mathrm{d}\mathbf{r} 
	\end{align}

.. math::
	\begin{align}
	\mathrm{d}\mathbf{U} \cdot \mathbf{U} = \mathbf{f}\cdot \mathrm{d}\mathbf{r} - \frac{1}{\rho}\nabla p \cdot \mathrm{d}\mathbf{r}  
	\end{align}

.. math::
	\begin{align}
	\mathrm{d}(\frac{u^{2}}{2}) = \mathrm{d}W - \frac{1}{\rho}\mathrm{d}p
	\end{align}

其中 :math:`u` 是流速大小， :math:`W` 为质量力势函数。考虑到不可压缩流体的密度是常量，可以放入全微分当中，于是对上式积分即得到 **伯努利积分** ：

.. math::
	\begin{align}
	W - \frac{p}{\rho} - \frac{u^{2}}{2} = C_{l}  
	\end{align}

其中 :math:`W` 是质量力势函数， :math:`\rho` 是不可压缩流体的密度， :math:`C_{l}` 称为流线常数（不同的流线可以有各自的积分常数）。上式表明，在理想流体的恒定流动中，同一流线上各点的 :math:`(W - \frac{p}{\rho} - \frac{u^{2}}{2})` 值时一个常数。

对于质量力只有重力的情况下，重力的势函数为 :math:`W=-gz` ，代入伯努利积分得到

.. math::
	\begin{align}
	gz + \frac{p}{\rho} + \frac{u^{2}}{2} = C_{l}
	\quad \text{or} \quad 
	z + \frac{p}{\rho g} + \frac{u^{2}}{2g} = C_{l}      
	\end{align}

如果对同一流线上任意两点利用上式即得到 **伯努利方程** ：

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} + \frac{u_{1}^{2}}{2g} = z_{2} + \frac{p_{2}}{\rho g} + \frac{u_{2}^{2}}{2g}
	\end{align}

伯努利方程表示能量的平衡关系，每项的物理意义表示单位重量流体所具有的某种能量：

- :math:`z` 是单位重量流体所具有的 **位置势能** （单位位置势能），从位置高程的基准面算起。用几何高度来表示则称为 **位置水头** ；
- :math:`\frac{p}{\rho g}` 是单位重量流体所具有的 **压强势能** （单位压强势能），用相对压强计算。用几何高度来表示则称为 **压强水头** ；
- :math:`z + \frac{p}{\rho g}` 是单位重量流体所具有的 **总势能** （单位总势能）。用几何高度来表示则称为 **测压管水头** ；
- :math:`\frac{u^{2}}{2g}` 是单位重量流体所具有的 **动能** （单位动能）。用几何高度来表示则称为 **速度水头** ；
- :math:`z + \frac{p}{\rho g} + \frac{u^{2}}{2g}` 是单位重量流体的 **总机械能** （单位机械能）。用几何高度来表示则称为 **总水头线** 。





欧拉积分（理想流体恒定有势流动的积分）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

伯努利积分的成立条件是：理想流体、恒定、不可压缩、质量力有势，在此基础上进一步加上无旋的条件即可导出欧拉积分。恒定条件下理想流体运动方程的x方向分量的式子为

.. math::
	\begin{align}
	u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{x}}{\partial y} + u_{z}\frac{\partial u_{x}}{\partial z}
	= X - \frac{1}{\rho}\frac{\partial p}{\partial x}
	\end{align}

由无旋条件可知 :math:`\frac{\partial u_{x}}{\partial y}=\frac{\partial u_{y}}{\partial x}` 和 :math:`\frac{\partial u_{x}}{\partial z}=\frac{\partial u_{z}}{\partial x}` ，从而上式可以进一步整理：

.. math::
	\begin{align}
	X - \frac{1}{\rho}\frac{\partial p}{\partial x}
	= u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{y}}{\partial x} + u_{z}\frac{\partial u_{z}}{\partial x}
	= \frac{\partial }{\partial x}\Big( \frac{u_{x}^{2}+u_{y}^{2}+u_{z}^{2}}{2} \Big)
	= \frac{\partial }{\partial x}(\frac{u^{2}}{2}) 
	\end{align}

同理可以y,z方向的式子：

.. math::
	\begin{align}
	& \frac{\partial }{\partial y}(\frac{u^{2}}{2}) = Y - \frac{1}{\rho}\frac{\partial p}{\partial y} \\
	& \frac{\partial }{\partial z}(\frac{u^{2}}{2}) = Z - \frac{1}{\rho}\frac{\partial p}{\partial z}
	\end{align}

将流场内任取的一段微元弧长 :math:`(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)` 的三个分量分别乘以上式的两边并将三式相加，得到

.. math::
	\begin{align}
	\frac{\partial }{\partial x}(\frac{u^{2}}{2})\mathrm{d}x 
	+ \frac{\partial }{\partial y}(\frac{u^{2}}{2})\mathrm{d}y
	+ \frac{\partial }{\partial z}(\frac{u^{2}}{2})\mathrm{d}z
	= X\mathrm{d}x + Y\mathrm{d}y + Z\mathrm{d}z
	-\frac{1}{\rho}\Big( \frac{\partial p}{\partial x}\mathrm{d}x + \frac{\partial p}{\partial y}\mathrm{d}y + \frac{\partial p}{\partial z}\mathrm{d}z   \Big) 
	\end{align}

在质量力有势和流体不可压缩的条件下，上式可以写成

.. math::
	\begin{align}
	\mathrm{d}(\frac{u^{2}}{2}) = \mathrm{d}W - \mathrm{d}(\frac{p}{\rho})
	\quad \text{or} \quad 
	\mathrm{d}\Big( W - \frac{p}{\rho} - \frac{u^{2}}{2} \Big) = 0
	\end{align}

对上式积分即可得到 **欧拉积分** ：

.. math::
	\begin{align}
	W - \frac{p}{\rho} - \frac{u^{2}}{2} = C
	\end{align}

其中 :math:`W` 是质量力势函数， :math:`\rho` 是不可压缩流体的密度，积分常数 :math:`C` 称为通用常数。上式表明，在理想不可压缩流体的恒定有势流动中，流场中各点的 :math:`(W - \frac{p}{\rho} - \frac{u^{2}}{2})` 值是一个常数。

在质量力只是重力的情况下，欧拉积分的具体形式为

.. math::
	\begin{align}
	gz + \frac{p}{\rho} + \frac{u^{2}}{2} = C
	\quad \text{or} \quad 
	z + \frac{p}{\rho g} + \frac{u^{2}}{2g} = C
	\end{align}





恒定总流的能量方程
---------------------

总流是无数元流的累加，单位时间内通过总流过流断面 :math:`A` 的流体，其总机械能是通过各元流过流断面 :math:`\mathrm{d}A` 三相机械能的总和。元流的体积流量是 :math:`\mathrm{d}Q=u\mathrm{d}A` ，单位时间里通过元流过流断面的流体重量是 :math:`\rho g\mathrm{d}Q` ，则单位时间内通过总流过流断面的总能量为

.. math::
	\begin{align}
	\iint\limits_{A}\Big( z + \frac{p}{\rho g} + \frac{u^{2}}{2g} \Big)\rho g\mathrm{d}Q
	\end{align}

由理想流体恒定元流的能量方程可知，单位时间里通过元流各过流断面的总能量相等，那么在理想流体恒定总流中，单位时间里通过总流各过流断面的总能量也一定相等，即上式等于一个常数。

在总流过流断面上三项单位能量是不均匀的，所以要用在断面上积分的形式来表示单位时间里通过总流过流断面的总能量。下面尝试用断面平均势能和断面平均流速表示的断面机械能平均值，来将总流能量方程一维化。首先将势能与动能的积分分开考虑：

.. math::
	\begin{align}
	\iint\limits_{A}\Big( z + \frac{p}{\rho g} + \frac{u^{2}}{2g} \Big)\rho g\mathrm{d}Q
	= \iint\limits_{A}\Big( z + \frac{p}{\rho g}\Big)\rho g\mathrm{d}Q
	+ \iint\limits_{A}\Big( \frac{u^{2}}{2g} \Big)\rho g\mathrm{d}Q 
	\end{align}


对于断面平均势能，先考察均匀流的过流断面上势能的分布情况。根据动量方程，现在所考虑的恒定均匀流满足时变加速度与位变加速度均为零，即没有惯性力项，只有重力、压差力和粘性力，于是

.. math::
	\begin{align}
	-g\mathbf{k} - \frac{1}{\rho}\nabla p + \nu \nabla^{2}\mathbf{U} = 0
	\quad \Rightarrow \quad 
	-\nabla\Big( gz + \frac{p}{\rho} \Big) + \nu\nabla^{2}\mathbf{U} = 0
	\end{align}

其中将重力加速度写成 :math:`-g\nabla z` 就固定了z轴时铅锤向上的坐标轴。因为均匀流的流线是平行直线，流速都沿着同一方向，其过流断面是平面。现在用 :math:`Ox_{1}yz_{1}` 坐标轴来描述该过流断面，规定 :math:`x_{1}` 轴指向流速方向， :math:`Oyz_{1}` 为过流断面平面，且 :math:`Oyz_{1}` 平面与 :math:`Oyz` 平面有一个夹角 :math:`\theta` ，即两个坐标系是绕 :math:`y` 轴旋转 :math:`\theta` 角的关系。在 :math:`Ox_{1}yz_{1}` 坐标系中应用上述动量方程，得到分量形式：

.. math::
	\begin{align}
	& -\frac{\partial }{\partial x_{1}}\Big( gz + \frac{p}{\rho} \Big) + \nu\nabla^{2}u_{x_{1}} = 0 \\
	& -\frac{\partial }{\partial y}\Big( gz + \frac{p}{\rho} \Big) = 0 \\
	& -\frac{\partial }{\partial z_{1}}\Big( gz + \frac{p}{\rho} \Big) = 0
	\end{align}

从 :math:`y,z_{1}` 分量的式子可以看出，在过流断面（ :math:`Oyz_{1}` 平面）上有

.. math::
	\begin{align}
	gz + \frac{p}{\rho} = \text{const}
	\quad \text{or} \quad 
	z + \frac{p}{\rho g} = \text{const}     
	\end{align}

即在恒定均匀流的过流断面上势能是常数。这可以解释为均匀流的过流断面上粘性力的分量为零，只有压差与重力之间的平衡，所以流体动压强按照流体静压强的规律分布。

.. attention:: 只能在同一过流断面上应用上述结论，因为 :math:`x_{1}` 方向的运动方程里有粘性力项，所以沿着流动方向流体动压强分布不同于流体静压强，导致不同过流断面上势能可能是不同的常数。

渐变流可以近似于均匀流，所以渐变流过流断面上的势能 :math:`z + \frac{p}{\rho g}` 也可视为常数，于是势能积分可以改写成

.. math::
	\begin{align}
	\iint\limits_{A}\Big( z + \frac{p}{\rho g}\Big)\rho g\mathrm{d}Q
	= \Big( z + \frac{p}{\rho g}\Big)\rho gQ
	\end{align}

动能项 :math:`\frac{u^{2}}{2g}` 在过流断面上是不均匀的，如果要用断面平均流速 :math:`v` 来代替，那么就需要乘上一个修正系数 :math:`\alpha` 才能作为平均值，从而动能积分可以写成

.. math::
	\begin{align}
	\iint\limits_{A}\Big( \frac{u^{2}}{2g} \Big)\rho g\mathrm{d}Q 
	= \frac{\alpha v^{2}}{2}\rho Q 
	\end{align}

也即有这样的关系： :math:`\frac{\rho}{2}\iint\limits_{A}u^{3}\mathrm{d}A = \frac{\rho}{2}\alpha v^{3}A` ，从而得到 **动能修正系数** 的表达式为

.. math::
	\begin{align}
	\alpha  = \frac{\iint\limits_{A}u^{3}\mathrm{d}A}{v^{3}A} 
	\end{align}

该系数是一个大于 :math:`1.0` 的系数，其大小取决于断面上的流速分布。流速分布越均匀， :math:`\alpha` 越接近于 :math:`1.0` ；流速分布越不均匀， :math:`\alpha` 的数值越大。

综上，单位时间里总流通过渐变流段中过流断面的总能量为 :math:`\rho gQ \Big( z + \frac{p}{\rho} + \frac{\alpha v^{2}}{2g} \Big)` ，进而得到单位重量流体的总机械能为

.. math::
	\begin{align}
	H = z + \frac{p}{\rho} + \frac{\alpha v^{2}}{2g}
	\end{align}



对理想不可压缩流体总流，不考虑流动中的机械能损失，单位时间里通过总流各过流断面的总能量相同，而由连续方程决定了重量流量 :math:`\rho gQ` 沿程不变，所以在任意两个分别位于总流的渐变流段中的过流断面满足 **理想不可压流体恒定总流的能量方程** ：

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha _{1}v_{1}^{2}}{2g}
	= z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha _{2}v_{2}^{2}}{2g}   
	\end{align}



.. attention:: 

	恒定总流能量方程在应用时必须满足相应的条件：

	- 流动必须是恒定流，并且流体是不可压缩的。
	- 作用于流体上的质量力只有重力。
	- 所取的上下游两个断面应该在渐变流段中，以符合断面上位置势能加压强势能为常数的条件。但是在两个断面之间流动可以不是渐变流。断面应该选在已知条件较多的位置。在渐变流断面上取任何一点的势能值都能作为整个断面的平均值，为了简便通常取管道中心点或河渠水面点。
	- 两断面间没有能量的输入或输出。
	- 两断面间没有流量的流入或流出。



对于流体是气体的情况，一般将上式转换成压强量纲，即

.. math::
	\begin{align}
	p_{1\text{abs}} + \rho gz_{1} + \frac{\rho\alpha _{1}v_{1}^{2}}{2}
	= p_{2\text{abs}} + \rho gz_{2} + \frac{\rho\alpha _{2}v_{2}^{2}}{2} + p_{w1-2}
	\end{align}

其中 :math:`\rho` 为气体的密度， :math:`p_{w1-2}` 为断面间的压强损失， :math:`p_{1\text{abs}},p_{2\text{abs}}` 分别是两断面上的绝对压强。设1-1断面 :math:`z_{1}` 高程处的大气压强为 :math:`p_{a}` ，外部空气的密度为 :math:`\rho_{a}` ，则2-2断面 :math:`z_{2}` 高程处的大气压强为 :math:`p_{a}-\rho_{a}g(z_{2}-z_{1})` ，所以 :math:`p_{1\text{abs}}=p_{a}+p_{1}` ， :math:`p_{2\text{abs}}=p_{a}-\rho_{a}g(z_{2}-z_{1})+p_{2}` ，从而代入上式得到 **以相对压强计算的气流能量方程式** ：

.. math::
	\begin{align}
	p_{1} + \frac{\rho\alpha _{1}v_{1}^{2}}{2} + (\rho_{a}-\rho)g(z_{2}-z_{1})
	= p_{2} + \frac{\rho\alpha _{2}v_{2}^{2}}{2} + p_{w1-2}  
	\end{align}

其中 :math:`p_{1},p_{2}` 称为 **静压** ， :math:`\frac{\rho\alpha _{1}v_{1}^{2}}{2},\frac{\rho\alpha _{2}v_{2}^{2}}{2}` 称为 **动压** ， :math:`(\rho_{a}-\rho)g` 为单位体积气体所受的有效浮力， :math:`(z_{2}-z_{1})` 为气体沿浮力方向升高的距离， :math:`(\rho_{a}-\rho)g(z_{2}-z_{1})` 为1-1断面相对于2-2断面单位体积气体的位能，称为 **位压** 。



恒定总流能量方程的几何表示（水头线）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

与元流一样，恒定总流能量方程的各项也都是长度量纲，所以可以将它们几何表示出来，画成水头线。总流水头线的画法和元流水头线是相仿的，其中位置水头线一般为总流断面中心线。另外，由于实际流体的流动总是有水头损失的，所以总水头线肯定会沿程下降，定义水头线的斜率为 **水力坡度** ：

.. math::
	\begin{align}
	J = -\frac{\mathrm{d} H}{\mathrm{d} s}=\frac{\mathrm{d}h_{w}}{\mathrm{d}s}  
	\end{align}

其中 :math:`s` 是流程长度， :math:`h_{w}` 为相应的水头损失。

同样的，测压管水头线是沿程各断面测压管水头 :math:`H_{p}=z+\frac{p}{\rho g}` 的连线。可以定义单位长度流程上测压管水头的减小值为测压管水头线坡度（测管坡度）：

.. math::
	\begin{align}
	J_{p} = -\frac{\mathrm{d}H_{p}}{\mathrm{d} s} = -\frac{\mathrm{d} }{\mathrm{d}s}(z+\frac{p}{\rho g} )  
	\end{align}



恒定总流的动量方程
---------------------

元流的质量流量是 :math:`\rho\mathrm{d}Q=\rho u\mathrm{d}A` ，单位时间里通过元流过流断面的动量为 :math:`\mathbf{U}\rho\mathrm{d}Q` ，将它在总流过流断面上积分得到单位时间里通过总流过流断面的动量应该为 :math:`\iint\limits_{A}\rho u \mathbf{U}\mathrm{d}A` 。根据恒定总流的动量守恒原理，应该有

.. math::
	\begin{align}
	\iint\limits_{A_{2}}\rho u\mathbf{U}\mathrm{d}A
	-  \iint\limits_{A_{1}}\rho u\mathbf{U}\mathrm{d}A
	= \sum \mathbf{F}
	\end{align}

在总流过流断面上速度大小 :math:`u` 一般是不均匀的，速度 :math:`\mathbf{U}` 的方向也一般是不一致的，为了进行一维简化，就要使用断面平均流速来化简。假设断面 :math:`A` 是在渐变流段中的一个过流断面，则断面上各点的 :math:`\mathbf{U}` 方向一致，用断面平均流速为 :math:`v` ，定义 :math:`\mathbf{v}` 的大小为 :math:`v` ，方向为 :math:`\mathbf{U}` 的方向，此时总流过断面的动量通量修改成

.. math::
	\begin{align}
	\iint\limits_{A}\rho v\mathbf{v}\mathrm{d}A 
	\end{align}

它和精确的动量通量方向一致，但是大小并不相等，因此需要引入一个 **动量修正系数** :math:`\alpha_{0}` 使动量通量的大小写成

.. math::
	\begin{align}
	\iint\limits_{A}\rho u^{2}\mathrm{d}A = \rho \alpha _{0}v^{2}A 
	\end{align}

从而可以得到该动量修正系数的表达式为

.. math::
	\begin{align}
	\alpha _{0} = \frac{\iint\limits_{A}u^{2}\mathrm{d}A}{v^{2}A} 
	\end{align}

它是一个大于1的数，其大小取决于断面上的流速分布。

于是 **恒定总流的动量方程** 就可以写成

.. math::
	\begin{align}
	\rho(\alpha _{02}v_{2}\mathbf{v}_{2}A_{2} - \alpha _{01}v_{1}\mathbf{v}_{1}A_{1})=\sum\mathbf{F}
	\quad \Rightarrow \quad 
	\rho Q(\alpha _{02}\mathbf{v}_{2}-\alpha _{01}\mathbf{v}_{1})=\sum\mathbf{F}
	\end{align}

上式中的 :math:`\sum\mathbf{F}` 包括：上游水流作用于断面1-1上的流体动压力 :math:`\sigma_{1}` ，下游水流作用于断面2-2上的流体动压力 :math:`\sigma_{2}` ，重力 :math:`G` 和总流侧壁边界对这段水流的总作用力 :math:`R'` 。其中只有重力是质量力，其他都是表面力。



.. attention:: 

	- 要合理地选择总流段的上下游断面，使得控制体正好包括需要确定水流作用力的边界，同时所选断面宜位于渐变流区域，以便计算流体动压力，并取动量修正系数，用断面平均流速表示过流断面的动量。
	- 方程中应该包括作用于控制体内流体的所有外力：两断面上的压力、重力、四周边界对液流的作用力。
	- 动量方程左侧是流出下游断面的动量通量减去流入上游断面的动量通量，不要弄反。
	- 动量方程是矢量式，具体应用时要选择合适的坐标系进行投影分析其分量。对于未知的边界作用力可以先假定一个方向，根据结果正负号来修正方向。






有旋流动和有势流动
====================

有旋流动
----------

涡量、涡线、涡管、涡通量
^^^^^^^^^^^^^^^^^^^^^^^^^^

流体微团有平均旋转角速度的流动为有旋流动，定量描述有旋流动的物理量为 **涡量** :math:`\boldsymbol{\Omega}` ，它就是速度矢量的旋度，即

.. math::
	\begin{align}
	\boldsymbol{\Omega} = \nabla \times \mathbf{U} = 2\boldsymbol{\omega}
	\end{align}

其物理意义是：流场中某点涡量的大小是以该点为基点的平均旋转角速度的两倍，涡量的方向与微团的瞬时转动轴重合。

在已知流动速度场的情况下，通过计算速度场的旋度就可以得到涡量场。 **涡线** 是涡量场的矢量线，是某瞬时对应的流场中的一条曲线，该瞬时曲线上每一点的涡量都和该曲线相切。在涡线上某点取微元矢量 :math:`\mathrm{d}\mathbf{l}=(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)` ，根据定义它应该与该点的涡量方向一致，所以

.. math::
	\begin{align}
	\boldsymbol{\Omega} \times \mathrm{d}\mathbf{l} = 0 
	\end{align}

上式就是直角坐标系的涡线微分方程，它包含两个独立方程，求解它可以得到两族曲线，它们的交线就是涡线族。涡线具有瞬时的概念，不同瞬时有不同的形状，而在恒定流动中它的形状保持不变。

在流场中，取一条不与涡线重合的封闭曲线 :math:`L` ，在同一时刻过 :math:`L` 上每一点作涡线，由这些涡线围成的管状曲面称为 **涡管** 。与涡线一样，涡管是瞬时概念。截面积无限小的涡管为元涡管。如果涡管周围流体的涡量皆为零，则称该涡管为孤立涡管。

通过流场中某曲面 :math:`A` 的涡量通量

.. math::
	\begin{align}
	I = \iint\limits_{A}\boldsymbol{\Omega} \cdot \mathbf{n}~\mathrm{d}A 
	\end{align}

简称为 **涡通量** 。通过涡管中任一截面的涡通量称为该涡管的涡管强度。


速度环量、斯托克斯定理
^^^^^^^^^^^^^^^^^^^^^^^^

**速度环量** 是速度矢量沿着有向曲线 :math:`AB` 的线积分，表示为

.. math::
	\begin{align}
	\Gamma_{AB} = \int_{AB}\mathbf{U} \cdot \mathrm{d}\mathbf{L} 
	\end{align}

其中 :math:`\mathrm{d}\mathbf{L}` 是 :math:`AB` 上的微元段矢量，由起点 :math:`A` 指向终点 :math:`B` 的方向为正方向。速度环量具有瞬时的概念，根据同一瞬时在 :math:`AB` 上的速度分布来计算，即积分时 :math:`t` 作为参变量。速度环量是标量，其正负号与有向线段正方向的定义有关。

速度环量表示在某瞬时所有在 :math:`AB` 曲线上的质点沿 :math:`AB` 运动的趋势，而沿封闭曲线 :math:`C` 的速度环量则表示某瞬时所有在 :math:`C` 上的质点沿 :math:`C` 的旋转量：

.. math::
	\begin{align}
	\Gamma_{C} = \oint_{C}\mathbf{U}\cdot\mathrm{d}\mathbf{L}
	\end{align}

涡通量与速度环量都能表征漩涡强度，它们之间存在关系为，沿包围单连通面域的有限封闭围线的速度环量等于通过此单连通面域的涡通量，即 **斯托克斯定理** ：

.. math::
	\begin{align}
	\oint_{L}\mathbf{U}\cdot\mathrm{d}\mathbf{L} 
	= \iint\limits_{A}\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A}
	= \iint\limits_{A}(\nabla\times\mathbf{U})\cdot \mathrm{d}\mathbf{A} 
	\end{align}


斯托克斯定理可以推广到多连通域。以双连通域为例， :math:`L` 为物体表面周线， :math:`C` 为包围物体的任一封闭曲线，两个曲线所围区域 :math:`A` 就是一个双连通域，通过割缝并考虑积分路径相反相消的情况，即可得到双连通域内涡通量等于沿该域外周线的速度环量和沿内周线的速度环量之差：

.. math::
	\begin{align}
	\iint\limits_{A}\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A} = \Gamma_{C} - \Gamma_{L} 
	\end{align}

根据斯托克斯定理可以分析流场中只有一个孤立涡管的情况。设孤立涡管的涡管强度为 :math:`I` ，在该涡管外任一围绕涡管的封闭曲线 :math:`C` ，作一曲面张于 :math:`C` 上并与涡管的交线为 :math:`L` ，它们所围部分曲面为 :math:`A` ，从而

.. math::
	\begin{align}
	\Gamma_{C}-\Gamma_{L} = \iint\limits_{A}\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A} = 0
	\end{align}

而 :math:`\Gamma_{L}=I` ，进而推出 :math:`\Gamma_{C}=I` ，也就是说，孤立涡管外任一围绕其的封闭曲线的速度环量等于该孤立涡管的涡管强度。






旋涡随空间的变化规律
^^^^^^^^^^^^^^^^^^^^^^^

某一时刻在涡量场内任取一涡管，在涡管任取两个截面 :math:`A_{1},A_{2}` ，它们与侧面 :math:`A'` 组成封闭曲面 :math:`A` ，封闭曲线包围的体积为 :math:`V` 。由高斯定理可以得到

.. math::
	\begin{align}
	\iint\limits_{A}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A} 
	= \iiint\limits_{V}\nabla \cdot \boldsymbol{\Omega}\mathrm{d}V 
	= \iiint\limits_{V}\nabla \cdot (\nabla \times \mathbf{U})\mathrm{d}V
	= 0
	\end{align}

因此涡量场在任何时刻都是无源场，分解为各面的通量表示（注意到侧面 :math:`A'` 的涡通量为零）则有

.. math::
	\begin{align}
	\iint\limits_{A_{1}}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A}_{1}
	+ \iint\limits_{A_{2}}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A}_{2}
	= 0
	\end{align}

将 :math:`A_{1}` 的外法向改为内法向 :math:`A_{1}'` 则有

.. math::
	\begin{align}
	\iint\limits_{A_{1}}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A}_{1}'
	= \iint\limits_{A_{2}}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A}_{2}
	\quad \Rightarrow \quad 
	I_{1}=I_{2}
	\end{align}

可以看到，在同一时刻，同一涡管上任一截面的涡通量即涡管强度保持不变，即为 **涡管强度守恒定理** 。对于涡管元，取截面 :math:`\delta A` 的法线方向与涡矢量一致，认为截面上的涡矢量为常矢量，则

.. math::
	\begin{align}
	\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A} = \Omega\delta A=\text{const}   
	\end{align}

由涡管强度守恒定理可以得到结论：涡管截面不可能收缩为零，即涡管不能在流体中终止或开始（否则 :math:`\boldsymbol{\Omega}` 将趋于无穷大，是不可能的）。因此涡管的存在形式只可能有两种：

1. 涡管本身成封闭形；
2. 涡管的两端位于流体边界面上（自由表面或固体表面上），或者伸展到无穷远。




旋涡随时间的变化规律
^^^^^^^^^^^^^^^^^^^^^^

**流体线** 指在运动中始终由某些确定的流体质点所组成的线。设 :math:`t` 时刻，封闭流体线 :math:`L` 在空间占有 :math:`ABA` 位置，沿此曲线的速度环量为

.. math::
	\begin{align}
	\Gamma = \oint_{L}\mathbf{U}\cdot\delta\mathbf{L}
	\end{align}

其中 :math:`\delta` 表示对空间的微分，与对时间的微分 :math:`\mathrm{d}` 进行区分。经过 :math:`\Delta t` 时段后，组成 :math:`L` 的全部流体质点一起在空间移动到新的位置 :math:`A'B'A'` 而形成新的流体线 :math:`L'` ，此时沿封闭曲线 :math:`L'` 的速度环量为

.. math::
	\begin{align}
	\Gamma' = \oint_{L'}\mathbf{U}\cdot\delta\mathbf{L}
	\end{align}

速度环量对时间的变化率定义为 :math:`\frac{\mathrm{d}\Gamma}{\mathrm{d}t}=\lim\limits_{\Delta t\to 0}\frac{\Gamma'-\Gamma}{\Delta t}` ，可以如下进行推导：

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}
	= \frac{\mathrm{d} }{\mathrm{d}t}\oint_{L}\mathbf{U}\cdot\delta\mathbf{L}
	= \oint_{L}\frac{\mathrm{d} }{\mathrm{d}t}(\mathbf{U}\cdot\delta\mathbf{L})
	= \oint_{L}\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}\cdot\delta\mathbf{L}
	+ \oint_{L}\mathbf{U}\cdot \frac{\mathrm{d}(\delta \mathbf{L})}{\mathrm{d}t}
	\end{align}

对于上式的第二项，它由于封闭曲线形状变化而产生，可以从由两端点位移作差进行定义的 :math:`\delta\mathbf{L}` 进行解释：

.. math::
	\begin{align}
	\Delta(\delta\mathbf{L})
	= \delta\mathbf{L}_{2} - \delta\mathbf{L}_{1}
	= [(\mathbf{r}_{2} + \mathbf{U}_{2}\Delta t) - (\mathbf{r}_{1} + \mathbf{U}_{1}\Delta t)] - (\mathbf{r}_{2} - \mathbf{r}_{1})
	= \mathbf{U}_{2}\Delta t - \mathbf{U}_{1}\Delta t
	\end{align}

.. math::
	\begin{align}
	\frac{\mathrm{d}(\delta\mathbf{L})}{\mathrm{d}t}
	= \lim\limits_{\Delta t \to 0}\frac{\Delta (\delta\mathbf{L})}{\Delta t}
	= \lim\limits_{\Delta t \to 0}\frac{\mathbf{U}_{2}\Delta t - \mathbf{U}_{1}\Delta t}{\Delta t} 
	= \mathbf{U}_{2} - \mathbf{U}_{1}
	= \delta\mathbf{U}
	\end{align}

将此结果代入原式得到

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}
	= \oint_{L}\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}\cdot\delta\mathbf{L}
	  + \oint_{L}\mathbf{U}\cdot \delta\mathbf{U}
	= \oint_{L}\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}\cdot\delta\mathbf{L}
	  + \oint_{L}\delta\frac{u^{2}}{2} 
	\end{align}

其中 :math:`u` 是速度大小，又因为速度是空间的单值函数，沿封闭曲线的变化值为零，所以 :math:`\oint_{L}\delta\frac{u^{2}}{2}=0` ，从而得到

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}=\oint_{L}\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}\cdot\delta\mathbf{L}
	\end{align}


根据理想流体的动量方程，有 :math:`\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}=\mathbf{f} - \frac{1}{\rho}\nabla p` ，代入上式则得到

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}
	= \int_{L}\Big( \mathbf{f} - \frac{1}{\rho}\nabla p \Big) \cdot \delta\mathbf{L}
	= \int_{L}\Big( \mathbf{f}\cdot \delta\mathbf{L} - \frac{1}{\rho}\nabla p\cdot \delta\mathbf{L} \Big)
	\end{align}

因为 :math:`\mathbf{f}` 有势，所以其沿封闭曲线的积分为零，即 :math:`\int_{L}\mathbf{f}\cdot \delta\mathbf{L}=0` 。

对于正压流体流场，密度仅仅是压强的函数，可以定义压力函数 :math:`P(p)=\int\frac{\mathrm{d}p}{\rho(p)}` ，于是 :math:`-\frac{1}{\rho}\nabla p = -\nabla P` ，所以

.. math::
	\begin{align}
	\int_{L}-\frac{1}{\rho}\nabla p \cdot \delta\mathbf{L}
	= \int_{L}-\nabla P \cdot \delta\mathbf{L}
	= \int_{L}- \delta P
	= 0 
	\end{align}

代入原式即可得到 **开尔文定理（汤姆逊定理）** ：

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}=0
	\quad \Rightarrow \quad 
	\Gamma = \text{const}  
	\end{align}

上式表明，速度环量随时间变化有三个因素：质量力无势、流体斜压（流体密度不仅取决于压强还依赖于其他变量，如温度等）以及粘性作用。如果这三个因素都不存在，则速度环量将不随时间变化。

在质量力有势，正压、理想流体中旋涡具有如下的动力学性质：

- 旋涡不生不灭定理：在质量力有势，正压、理想流体的流动中，若在某时刻某一部分流体内没有旋涡，则在以前和以后的任何时候，该部分流体内也不会有旋涡。反之，如果某一时刻某一部分流体内有旋涡，则在以前和以后的任何时刻，该部分流体内都有旋涡。
- 涡管及涡管强度保持性定理（亥姆霍兹定理）：在有势质量力作用下，正压、理想流体的流动中，某时刻组成涡管的流体质点将永远组成涡管，而且涡管强度在运动过程中保持不变。




旋涡的诱导速度
------------------

旋涡的诱导速度是孤立的旋涡带动周围无界不可压缩流体的速度。诱导速度是由流体的粘性作用引起的，粘性作用保证了旋涡与周围流体分界面上以及整个流场中速度的连续分布，因此可以在分析诱导速度分布时用速度连续假设来代替粘性作用，并仍将实际流体当作理想流体来处理，这样得出的结果与实际情况比较符合。

曲线涡的诱导速度、毕奥-萨伐公式
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

若涡线集中在一根涡管元上，此涡管元可以近似看成几何上的一条曲线，称为曲线涡，且满足当线涡的截面积 :math:`\Delta A` 趋于零时涡量趋于无穷，但是却使涡通量保持有限值，即

.. math::
	\begin{align}
	\lim\limits_{\Delta A\to 0} \int_{\Delta A}\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A}
	= \Gamma = \text{const}  
	\end{align}

在线涡上取一微元矢量 :math:`\mathrm{d}\mathbf{L}` ，其轴线为 :math:`\mathrm{d}\mathbf{L}` 的方向， :math:`\mathbf{r}` 为该微元中心到所求点的矢径，则该微元段对任一点 :math:`A` 的诱导速度满足 **毕奥-萨伐公式** ：

.. math::
	\begin{align}
	\mathrm{d}\mathbf{U} = \frac{\Gamma}{4\pi}\frac{\mathrm{d}\mathbf{L}\times\mathbf{r}}{r^{3}}   
	\end{align}

可以看到，曲线涡微元段 :math:`\mathrm{d}\mathbf{L}` 对任意点所诱导的速度 :math:`\mathrm{d}\mathbf{U}` 大小与涡量 :math:`\Gamma` 成正比，与矢径距离 :math:`r` 的平方成反比，方向垂直于 :math:`\mathrm{d}\mathbf{L}` 与 :math:`\mathbf{r}` 所在平面，按右手螺旋法则确定。

整个曲线涡对 :math:`A` 点的诱导速度为

.. math::
	\begin{align}
	\mathbf{U} = \int_{L}\frac{\Gamma}{4\pi}\frac{\mathrm{d}\mathbf{L}\times\mathbf{r}}{r^{3}}
	= \frac{\Gamma}{4\pi}\int_{L}\frac{\mathrm{d}\mathbf{L}\times\mathbf{r}}{r^{3}}   
	\end{align}

于是诱导速度的大小为

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{4\pi}\int_{L}\frac{r\mathrm{d}L\sin\alpha }{r^{3}}=\frac{\Gamma}{4\pi}\int_{L}\frac{\sin\alpha \mathrm{d}L }{r^{2}}    
	\end{align}

其中 :math:`\alpha` 为 :math:`\mathrm{d}\mathbf{L}` 与 :math:`\mathbf{r}` 的夹角。

.. note:: 根据上式，曲线涡对自身有诱导作用，变曲率曲线涡将在流体中运动，并在运动过程不断改变自己的形状。



直线涡的诱导速度
^^^^^^^^^^^^^^^^^^^^^^^

设 :math:`AB` 有限长直线涡的涡量方向自左向右，在 :math:`AB` 上取任意微元段矢量 :math:`\mathrm{d}\mathbf{l}` ，任意点 :math:`M` 至线涡的垂直距离为 :math:`R` ， :math:`AB` 直线涡对任意点 :math:`M` 的诱导速度 :math:`\mathbf{U}` 的大小为

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{4\pi}\int_{A}^{B}\frac{\sin\theta\mathrm{d}l}{r^{2}}  
	\end{align}

根据几何关系可以得到

.. math::
	\begin{align}
	r=\frac{R}{\sin\theta}, \qquad \mathrm{d}l\sin\theta \approx r\mathrm{d}\theta  
	\end{align}

将这些几何关系代入上式则得到

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{4\pi}\int_{\theta_{1}}^{\theta_{2}}\frac{\sin\theta\mathrm{d}\theta }{R} 
	= \frac{\Gamma}{4\pi R}(\cos\theta_{1}-\cos\theta_{2})  
	\end{align}

其中 :math:`\theta_{1},\theta_{2}` 分别是 :math:`AB` 与矢径 :math:`AM` 、 :math:`BM` 的夹角。诱导速度方向垂直于纸面向外。

对于半无限长的直线涡，即 :math:`A` 端伸展至无穷远，且 :math:`BM\perp AB` ，于是有 :math:`\theta_{1}=0,\theta_{2}=\frac{\pi}{2}` ，代入上式得到

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{4\pi R} 
	\end{align}

对于两端延伸至无限长的直线涡，则有 :math:`\theta_{1}=0,\theta_{2}=\pi` ，代入上式得到

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{2\pi R} 
	\end{align}

它所诱导的流场是平面流动，在流动平面上看，无限长直线涡成为一个平面点涡，集中了全部涡量。

.. note:: 诱导速度场对点涡自身无意义，点涡是一个奇点，在其他所有的点，诱导速度场都是无旋的。绕任何一条包围该平面点涡的闭曲线一周，速度环量都等于 :math:`\Gamma` ，而绕任何一条不包围该平面点涡的闭曲线一周，速度环量都等于零。


两个以上的直线涡组成的涡系，它对任意点的诱导速度由涡的独立作用原理确定：

- 涡系决定的诱导速度场是每个涡诱导速度场的几何和；
- 每一个涡的运动速度等于其他涡在该涡心的诱导速度几何和。
  




自由旋涡、强迫旋涡及其组合涡的压强分布
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**兰肯涡** 是一种平面组合涡，其中心部分是以涡心为圆心的圆，其中的速度与离涡心的距离成正比，涡量为常数；外围部分的速度与距离成反比，流动有势，涡量为零。它的中心部分的流体就像刚体一样旋转，需要有外力不断推动，称为 **强迫旋涡** 。外围部分的流体在运动的开始时由中心部分的转动通过粘性作用形成，在流动稳定后，无需再加入能量，粘性也不再发挥作用，这部分流动称为 **自由旋涡** 。


设组合涡中心部分的半径为 :math:`r_{0}` ，其边缘速度为 :math:`u_{0}` ，则速度环量为 :math:`\Gamma=2\pi r_{0}u_{0}` 。外围部分流体的流动是无旋的，因此沿任意半径为 :math:`r` 的圆周其速度环量也应该等于 :math:`\Gamma` ，于是无旋流动区的速度为

.. math::
	\begin{align}
	u = \frac{\Gamma}{2\pi r} = u_{0}\frac{r_{0}}{r}  
	\end{align}

无旋流动区是恒定的，可以用欧拉积分，不考虑质量力的作用，在无旋流动区的任意点都有

.. math::
	\begin{align}
	p + \frac{\rho u^{2}}{2}=C 
	\end{align}

当 :math:`r\to\infty` 时， :math:`u_{\infty}=0` ， :math:`p=p_{\infty}` ，代入上式得到 :math:`C=p_{\infty}` ，进而可以得到

.. math::
	\begin{align}
	p = p_{\infty} - \frac{\rho u^{2}}{2}
	= p_{\infty}-\frac{\rho\Gamma^{2}}{8\pi^{2}r^{2}}
	= p_{\infty} - \frac{\rho u_{0}^{2}r_{0}^{2}}{2r^{2}}
	\quad (r \geq r_{0})
	\end{align}


对于旋涡中心部分，流动为有旋流动，流体质点的速度满足 :math:`\mathbf{U}=\boldsymbol{\omega} \times \mathbf{r}` 。考虑理想恒定流动的动量方程，不考虑质量力的作用，有

.. math::
	\begin{align}
	\mathbf{U} \cdot \nabla\mathbf{U} = -\frac{1}{\rho}\nabla p 
	\end{align}

而按右手法则可知 :math:`u_{x}=-\omega y, u_{y}=\omega x` ，因此

.. math::
	\begin{align}
	\frac{\partial u_{x}}{\partial x}=0, \quad 
	\frac{\partial u_{x}}{\partial y}=-\omega, \quad 
	\frac{\partial u_{y}}{\partial x}=\omega, \quad 
	\frac{\partial u_{y}}{\partial y}=0    
	\end{align}

代入上式得到

.. math::
	\begin{align}
	\omega^{2}\mathbf{r}=\frac{1}{\rho}\nabla p 
	\end{align}

进而可以得到

.. math::
	\begin{align}
	\int \omega^{2}\mathbf{r} \cdot \mathrm{d}\mathbf{r} 
	= \int \frac{1}{\rho}\nabla p \cdot \mathrm{d}\mathbf{r}
	\quad \Rightarrow \quad
	\int \omega^{2}\mathrm{d}(\frac{r^{2}}{2})
	= \int \frac{1}{\rho}~\mathrm{d}p
	\quad \Rightarrow \quad 
	p = \frac{\rho\omega^{2}r^{2}}{2} + C = \frac{\rho u^{2}}{2} + C  
	\end{align}


利用边界 :math:`r=r_{0}` 处 :math:`p=p_{\infty}-\frac{\rho u_{0}^{2}}{2}=p_{0}` 和 :math:`u=u_{0}` 条件代入得到

.. math::
	\begin{align}
	p = \frac{\rho u^{2}}{2} + p_{0} - \frac{\rho u_{0}^{2}}{2}
	= p_{\infty} + \frac{\rho u^{2}}{2} - \rho u_{0}^{2}
	= p_{\infty} + \frac{\rho \omega^{2}r^{2}}{2} - \rho\omega^{2}r_{0}^{2}
	\quad (r \leq r_{0})
	\end{align}


.. note:: 

	- 当 :math:`r>r_{0}` 时，速度随 :math:`r` 的减小按双曲线规律增加，而压强则减小，在 :math:`r=r_{0}` 处压强降低到
	  
	.. math::
		\begin{align}
		p_{0} = p_{\infty} - \frac{\rho\Gamma^{2}}{8\pi^{2}r_{0}^{2}}=p_{\infty} - \frac{\rho u_{0}^{2}}{2}  
		\end{align}

	- 当 :math:`r<r_{0}` 时，压强按抛物线规律分布，在中心点 :math:`r=0` 处压强为最小值
	  
	.. math::
		\begin{align}
		p_{c} = p_{\infty} - \rho\omega^{2}r_{0}^{2} = p_{\infty} - \rho u_{0}^{2}
		\end{align}



有势流动
-----------

速度势函数
^^^^^^^^^^^^

速度势函数 :math:`\varphi` 是与空间及时间有关的标量函数，满足

.. math::
	\begin{align}
	\mathbf{U} = \nabla \varphi
	\end{align}

即速度矢量是速度势函数的梯度。可以通过积分运算由速度确定速度势：

.. math::
	\begin{align}
	\int_{M_{0}}^{M}\mathbf{U}\cdot\mathrm{d}\mathbf{r}
	= \int_{M_{0}}^{M}\nabla\varphi\cdot\mathrm{d}\mathbf{r}
	= \int_{M_{0}}^{M}\mathrm{d}\varphi 
	= \varphi_{M} - \varphi_{M_{0}}
	\end{align}

其中 :math:`M` 和 :math:`M_{0}` 为某时刻流场中的任意点， :math:`M_{0}` 作为已知点其 :math:`\varphi` 值可以任意给定。

速度势函数具有下列性质：

- :math:`\varphi` 可以加上任意常数而不影响对流速场的描述，因为在微分运算求流速场时常数会被消去。
- 满足 :math:`\varphi` 为常数的曲面称为等势面，它的法线方向即 :math:`\nabla\varphi` 的方向和速度矢量的方向重合。
- 在单连通域中任意两点 :math:`A` 、 :math:`B` 的速度势之差等于沿两点之间任意曲线的速度环量，因为在单连通域中 :math:`\varphi_{A}-\varphi_{B}=\int_{B}^{A}\mathbf{U}\cdot\mathrm{d}\mathbf{r}` 与积分路径无关。
- 在不可压缩流体中，速度势函数满足拉普拉斯方程，也即不可压缩流体的速度势函数是调和函数： :math:`\nabla\cdot\mathbf{U}=\nabla\cdot(\nabla\varphi)=\nabla^{2}\varphi=0` 。
- 速度势函数在不可压缩流体内部不可能有极大值与极小值，极值只能出现在边界上。
  


不可压缩流体的流函数
^^^^^^^^^^^^^^^^^^^^^^

对于不可压缩流体的平面流动，其连续性方程可以写为

.. math::
	\begin{align}
	\frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y}=0
	\quad \Rightarrow \quad 
	\frac{\partial u_{x}}{\partial x} - \frac{\partial (-u_{y})}{\partial y} = 0 
	\end{align}

上式是 :math:`u_{x}\mathrm{d}y-u_{y}\mathrm{d}x` 可以写成全微分的充分必要条件。于是，定义不可压缩流体平面流动的 **流函数** :math:`\psi` 满足

.. math::
	\begin{align}
	\mathrm{d}\psi = u_{x}\mathrm{d}y - u_{y}\mathrm{d}x
	\end{align}

其中流函数与流速之间满足 :math:`\frac{\partial \psi}{\partial x}=-u_{y}` 和 :math:`\frac{\partial \psi}{\partial y}=u_{x}` 的关系。


对于平面流动，流线方程可以简化为

.. math::
	\begin{align}
	\frac{\mathrm{d}x}{u_{x}}=\frac{\mathrm{d}y}{u_{y}}
	\end{align}

也即在流线上一定满足

.. math::
	\begin{align}
	\mathrm{d}\psi = -u_{y}\mathrm{d}x + u_{x}\mathrm{d}y = 0
	\quad \Rightarrow \quad 
	\psi = \text{const}
	\end{align}

因此， **等流函数线就是流线** ，等流函数线的切线与速度矢量方向一致。




在一不可压缩流体的平面，任取 :math:`A` 、 :math:`B` 两点的流函数数值分别为 :math:`\psi_{A}` 、 :math:`\psi_{B}` ，通过两点间任意连线的线流量是 :math:`q=\int_{A}^{B}\mathrm{d}q` 。在 :math:`AB` 线上任取线段 :math:`\mathrm{d}s` ，通过 :math:`\mathrm{d}s` 的线流量为

.. math::
	\begin{align}
	\mathrm{d}q = \mathbf{U} \cdot \mathbf{n}~\mathrm{d}s  
	\end{align}

其中 :math:`\mathbf{U}` 为通过 :math:`AB` 线的流速， :math:`\mathbf{n}` 为小线段 :math:`\mathrm{d}s` 的法向单位向量。根据几何关系以及速度势函数定义，可以得到

.. math::
	\begin{align}
	\mathbf{n} = (\frac{\mathrm{d}y}{\mathrm{d}s}, \frac{\mathrm{d}x}{\mathrm{d}s})
	, \quad 
	\mathbf{U}=(\frac{\partial \psi}{\partial y}, -\frac{\partial \psi}{\partial x} ) 
	\end{align}

代入上式则得到

.. math::
	\begin{align}
	\mathrm{d}q = \mathbf{U}\cdot\mathbf{n}\mathrm{d}s 
	= (\frac{\partial \psi}{\partial y}\frac{\mathrm{d}y}{\mathrm{d}s} 
	  + \frac{\partial \psi}{\partial x}\frac{\mathrm{d}x}{\mathrm{d}s})\mathrm{d}s
	= \frac{\partial \psi}{\partial y}\mathrm{d}y + \frac{\partial \psi}{\partial x}\mathrm{d}x  
	= \mathrm{d}\psi 
	\end{align}


也即

.. math::
	\begin{align}
	q = \int_{A}^{B}\mathrm{d}q = \int_{A}^{B}\mathrm{d}\psi = \psi_{B} - \psi_{A} 
	\end{align}


可以看到，**任意两流线间的流量等于这两条流线的势函数值之差** ，或者说，过任意两点连线的流量等于这两点的流函数值之差。


此外，与速度势函数类似，在有势流动中，流函数 :math:`\psi` 也满足拉普拉斯方程，也是调和函数，因此其在流体内部也不可能有极大值和极小值：

.. math::
	\begin{align}
	\nabla \times \mathbf{U} = 0
	\quad \Rightarrow \quad 
	-\frac{\partial }{\partial x}\Big(\frac{\partial \psi}{\partial x} \Big) - \frac{\partial }{\partial y}\Big(\frac{\partial \psi}{\partial y} \Big) =0
	\quad \Rightarrow \quad 
	\nabla^{2}\psi = 0
	\end{align}



复势、复速度
^^^^^^^^^^^^^^^^

在不可压缩平面势流中，速度势函数 :math:`\varphi` 和流函数 :math:`\psi` 同时存在，而且满足 **柯西-黎曼条件** ：

.. math::
	\begin{align}
	& u_{x} = \frac{\partial \varphi}{\partial x} = \frac{\partial \psi}{\partial y} \\
	& u_{y} = \frac{\partial \varphi}{\partial y} = -\frac{\partial \psi}{\partial x}   
	\end{align}

根据上式，可以得到

.. math::
	\begin{align}
	\frac{\partial \varphi}{\partial x}\Big(-\frac{\partial \psi}{\partial x} \Big) 
	= \frac{\partial \psi}{\partial y}\Big( \frac{\partial \varphi}{\partial y}  \Big) 
	\quad \Rightarrow \quad 
	\frac{\partial \varphi}{\partial x}\frac{\partial \psi}{\partial x} + \frac{\partial \varphi}{\partial y}\frac{\partial \psi}{\partial y}=0
	\end{align}

上式表明曲线 :math:`\varphi(x,y)` 和曲线 :math:`\psi(x,y)` 正交，也即 **流线（等流函数线）和等势线是互相正交的两族曲线** ，所以等势线也是过流断面线。


由于不可压缩流体平面势流中速度势函数 :math:`\varphi` 和流函数 :math:`\psi` 是满足柯西-黎曼条件的一对调和函数（共轭调和函数），因此它们可以构成一个解析的复变函数，称为 **复势** ：

.. math::
	\begin{align}
	W(z) = \varphi(x,y) + \mathrm{i}\psi(x,y)
	\end{align}

它的实部代表速度势，虚部代表流函数。它可以相差一任意常数，而不影响求解的流速场。任何一个不可压缩平面势流必然具有一个确定的复势，反之，一个确定的复势则代表某一个不可压缩平面势流。如果已知平面势流的复势，便可以求得流场中任意点处的速度，称复势的导数为 **复速度** ：

.. math::
	\begin{align}
	\overline{V} = \frac{\mathrm{d}W}{\mathrm{d}z} 
	= u_{x} - \mathrm{i}u_{y} 
	= |\mathbf{U}|\mathrm{e}^{-\mathrm{i}\theta}
	\end{align}


复速度沿封闭围线 :math:`C` 的积分，其实部为沿该封闭围线的速度环量，而虚部则为通过围线 :math:`C` 的通量：

.. math::
	\begin{align}
	\int_{C}\overline{V}\mathrm{d}z 
	= \int_{C}\frac{\mathrm{d}W}{\mathrm{d}z}\mathrm{d}z 
	= \int_{C}\mathrm{d}W 
	= \int_{C}\mathrm{d}\varphi  + \mathrm{i}\int_{C}\mathrm{d}\psi 
	= \Gamma + \mathrm{i}q    
	\end{align}




势流叠加原理
^^^^^^^^^^^^^^^

由于势流的基本方程——拉普拉斯方程是一个线性齐次方程，因此几个速度势 :math:`\varphi_{1},\varphi_{2},\cdots,\varphi_{k}` 为已知的简单势流，叠加起来可以得到一个较复杂的势流，它的速度势 :math:`\varphi` 等于被叠加的简单势流的速度势之和：

.. math::
	\begin{align}
	\varphi = \varphi_{1} + \varphi_{2} + \cdots + \varphi_{k}
	\end{align}


叠加所得势流在任一点的流速矢量等于被叠加势流在该点的流速矢量之和，即

.. math::
	\begin{align}
	\mathbf{U} = \nabla \varphi 
	= \nabla (\varphi_{1}+\varphi_{2}) 
	= \nabla\varphi_{1}+\nabla\varphi_{2}
	= \mathbf{U}_{1} + \mathbf{U}_{2}
	\end{align}


.. note:: 

	同理，叠加所得势流的流函数也等于被叠加势流的流函数之和，即

	.. math::
		\begin{align}
		\psi = \psi_{1} + \psi_{2}
		\end{align}




流动阻力和能量损失
====================

流动阻力和能量损失的形式
--------------------------

在边界沿程不变（包括边壁形状、尺寸、流动方向均不变）的均匀流段上，流动阻力就只有沿程不变的摩擦阻力，称为 **沿程阻力** 。克服沿程阻力所产生的能量损失，称为 **沿程损失** 。沿程损失均匀分布在整个流段上，与流程的长度成比例。流程损失用水头损失表示时，称为沿程水头损失 :math:`h_{f}` ；对于气体流动，沿程损失用压强损失表示时，称为沿程压强损失 :math:`p_{f}` 。

根据实验结果，有计算圆管沿程水头损失的Darcy-Weisbach公式：

.. math::
	\begin{align}
	& h_{f} = \lambda \frac{l}{d}\frac{v^{2}}{2g} \\
	& p_{f} = \lambda \frac{l}{d}\frac{\rho v^{2}}{2}    
	\end{align}

其中 :math:`l` 为管长， :math:`d` 为管径， :math:`v` 为断面平均速度， :math:`g` 为重力加速度， :math:`\rho` 为流体速度， :math:`\lambda` 为沿程损失（阻力）系数。沿程阻力系数并不是一个确定的常数，一般由实验给出的经验或半经验公式来确定。




在边壁形状沿程急剧变化，流速分布急剧调整的局部区段上，集中产生的流动阻力称为 **局部阻力** 。克服局部阻力引起的能量损失称为 **局部损失** 。同样，局部损失用水头损失表示时，称为局部水头损失 :math:`h_{j}` ；对于气体流动，局部损失用压强损失表示时，称为局部压强损失 :math:`p_{j}` 。

局部水头损失计算公式为

.. math::
	\begin{align}
	& h_{j} = \zeta \frac{v^{2}}{2g} \\
	& p_{j} = \zeta \frac{\rho v^{2}}{2}  
	\end{align}

其中 :math:`\zeta` 为局部损失（阻力）系数，一般由实验确定； :math:`v` 为断面平均流速； :math:`\rho` 为流体密度； :math:`g` 为重力加速度。

整个管道（或渠道）的水头损失 :math:`h_{w}` 等于各管道（或各流段）的沿程水头损失和所有局部水头损失的总和，即

.. math::
	\begin{align}
	& h_{w} = \sum h_{f} + \sum h_{j} \\
	& p_{w} = \sum p_{f} + \sum p_{j}
	\end{align}

.. note:: 

	压强损失与水头损失的关系为：

	.. math::
		\begin{align}
		p_{w}=\rho gh_{w}, \quad p_{f}=\rho gh_{f}, \quad p_{j}=\rho gh_{j}
		\end{align}




粘性流体的两种流态
---------------------

对任何边界形状、任何实际流体和其他流动，都可以发现存在有两种流态——层流和紊流。 **层流** 的流动特征是流体质点相互不掺混，作分层有规则的线状运动； **紊流** 流动特征是流体质点互相掺混，作无规则运动。

对于圆管流动，可以用一个无量纲数 **雷诺数** 来判断流动的流态：

.. math::
	\begin{align}
	\text{Re} = \frac{vd\rho}{\mu} = \frac{vd}{\nu}   
	\end{align}

与临界流速相对应的雷诺数，称为 **临界雷诺数** :math:`\text{Re}_{c}` 表示。实验表明，尽管当管径或流动介质不同时临界流速 :math:`v_{c}` 不一样，但对于任何管径和任何牛顿流体，判别流态的临界雷诺数都是相同的。在工程实际中，圆管流动的临界雷诺数取

.. math::
	\begin{align}
	\text{Re}_{c} = \frac{v_{c}d}{\nu} = 2000  
	\end{align}



对于非圆管流动及明渠水流，同样可以用雷诺数判别流态，但要引入一个综合反映断面大小和几何形状对流动影响的特征长度，代替圆管流雷诺数中的直径，这个特征长度就是 **水力半径** ：

.. math::
	\begin{align}
	R = \frac{A}{\chi } 
	\end{align}

其中 :math:`A` 为过流断面面积， :math:`\chi` 为过流断面上流体与固体边界接触部分的周长，称为湿周。例如，对于矩形断面明渠流动的水力半径为

.. math::
	\begin{align}
	R = \frac{A}{\chi } = \frac{bh}{b+2h} 
	\end{align}



.. attention:: 

	对于直径为 :math:`d` 的圆管流，相应的水力半径为

	.. math::
		\begin{align}
		R=\frac{\frac{1}{4}\pi d^{2}}{\pi d} = \frac{d}{4}
		\end{align}

	以水力半径为特征长度，相应的临界雷诺数为

	.. math::
		\begin{align}
		\text{Re}_{cR} = \frac{v_{c}R}{\nu} = 500  
		\end{align}

	可以看到，采用不同的特征长度，会有不同的临界雷诺数。




沿程损失与切应力之间的关系
----------------------------

均匀流基本方程
^^^^^^^^^^^^^^^^^

取圆管中恒定均匀流段1到2断面，作用在该流段上的外力有两端压力、壁面对流段的摩擦阻力和重力，三者之间沿轴线的平衡方程为

.. math::
	\begin{align}
	p_{1}A - p_{2}A + \rho gAl\cos\alpha  - \tau_{0}\chi l = 0
	\end{align}

其中 :math:`\tau_{0}` 为单位壁面上的摩擦阻力，即壁面切应力； :math:`\chi` 为湿周。将 :math:`l\cos\alpha =z_{1}-z_{2}` 代入上式，并各项除以 :math:`\rho gA` 整理得到

.. math::
	\begin{align}
	\Big( z_{1}+\frac{p_{1}}{\rho g} \Big) - \Big( z_{2}+\frac{p_{2}}{\rho g} \Big) = \frac{\tau_{0}\chi l}{\rho gA} 
	\end{align}

列1-1、2-2断面伯努利方程，化简得到

.. math::
	\begin{align}
	\Big( z_{1}+\frac{p_{1}}{\rho g} \Big) - \Big( z_{2}+\frac{p_{2}}{\rho g} \Big) = h_{f}
	\end{align}

联立上面两个方程，可以得到 **均匀流基本方程** ：

.. math::
	\begin{align}
	& h_{f} = \frac{\tau_{0}\chi l}{\rho g A} = \frac{\tau_{0}l}{\rho g R} \\
	& \tau_{0} = \rho gR\frac{h_{f}}{l} = \rho g R J  
	\end{align}


.. note:: 

	- 对于明渠均匀流，按照上述步骤列出流动方向力的平衡方程，同样可以得到上述均匀流基本方程，所以该方程对有压流和无压流均适用。
	- 由于均匀流基本方程只是根据在恒定均匀流段上外力平衡方程求得的，并没有反映产生沿程水头损失的物理本质，没有涉及流体质点的运动状态，因此该方程对层流和紊流均适用。



阻力速度
^^^^^^^^^^^

为建立沿程阻力系数 :math:`\lambda` 与壁面切应力 :math:`\tau_{0}` 的关系，将Darcy-Weisbach公式和圆管水力半径 :math:`R=\frac{d}{4}` 代入均匀流基本方程得到

.. math::
	\begin{align}
	\tau_{0} = \rho g RJ = \rho g \frac{d}{4} \frac{h_{f}}{l} = \rho g\frac{d}{4}\lambda \frac{1}{d}\frac{v^{2}}{2g} = \rho\frac{\lambda }{8}v^{2}      
	\end{align}

.. math::
	\begin{align}
	\sqrt{\frac{\tau_{0}}{\rho}} = v\sqrt{\frac{\lambda }{8}}
	\end{align}

定义 :math:`v_{*}=\sqrt{\frac{\tau_{0}}{\rho}}` ，它具有速度的量纲，是反映壁面切应力大小的一个流速，所以称之为 **阻力速度** ，于是

.. math::
	\begin{align}
	v_{*} = v\sqrt{\frac{\lambda }{8}}
	\end{align}




圆管中的层流运动
------------------

流体在圆管中作层流运动，各流层间切应力服从牛顿内摩擦定律，即

.. math::
	\begin{align}
	\tau = \mu\frac{\mathrm{d}u}{\mathrm{d}y} = \mu\frac{\mathrm{d}u}{\mathrm{d}(r_{0}-r)} = -\mu\frac{\mathrm{d}u}{\mathrm{d}r} 
	\end{align}

将上式代入圆管中均匀流基本方程得到

.. math::
	\begin{align}
	-\mu\frac{\mathrm{d}u}{\mathrm{d}r} = \rho g\frac{r}{2}J
	\quad \Rightarrow \quad 
	\mathrm{d}u = -\frac{\rho gJ}{2\mu}r~\mathrm{d}r     
	\end{align}

其中 :math:`\rho` 、 :math:`g` 和 :math:`\mu` 都是常数，在均匀流过流断面上 :math:`J` 也是常数，从而对上式积分得到

.. math::
	\begin{align}
	u = -\frac{\rho gJ}{4\mu}r^{2} + C 
	\end{align}

当 :math:`r=r_{0}` 时 :math:`u=0` ，从而求得 :math:`C = \frac{\rho gJ}{4\mu}r_{0}^{2}` ，代回上式即可得到 **圆管层流运动过流断面上的流速分布** ：

.. math::
	\begin{align}
	u = \frac{\rho gJ}{4\mu}(r_{0}^{2} - r^{2})
	\end{align}

可以看到，圆管层流运动过流断面上的流速分布是一个旋转抛物面。将 :math:`r=0` 代入上式得到 **管轴处的最大流速** 为

.. math::
	\begin{align}
	u_{\max} = \frac{\rho gJ}{4\mu}r_{0}^{2} 
	\end{align}

**圆管层流流量** 为

.. math::
	\begin{align}
	Q = \int_{A}u~\mathrm{d}A 
	= \int_{0}^{r_{0}}\frac{\rho gJ}{4\mu}(r_{0}^{2} - r^{2})2\pi r~\mathrm{d}r
	= \frac{\rho gJ}{8\mu}\pi r_{0}^{4} 
	\end{align}

**圆管层流的平均流速** 为

.. math::
	\begin{align}
	v = \frac{Q}{A} = \frac{Q}{\pi r_{0}^{2}} = \frac{\rho gJ}{8\mu}r_{0}^{2} = \frac{1}{2}u_{\max} 
	\end{align}

进而可以计算出圆管层流的动能修正系数 :math:`\alpha` 和动量修正系数 :math:`\alpha_{0}` ：

.. math::
	\begin{align}
	\alpha = \frac{\int_{A}u^{3}\mathrm{d}A}{v^{3}A}
	= \frac{\int_{0}^{r_{0}}\Big( \frac{\rho gJ}{4\mu}(r_{0}^{2}-r^{2})\Big)^{3}2\pi r~\mathrm{d}r}{\Big( \frac{\rho gJ}{8\mu}r_{0}^{2} \Big)^{3}\pi r_{0}^{2}}  
	= 2
	\end{align}

.. math::
	\begin{align}
	\alpha = \frac{\int_{A}u^{2}\mathrm{d}A}{v^{2}A}
	= \frac{\int_{0}^{r_{0}}\Big( \frac{\rho gJ}{4\mu}(r_{0}^{2}-r^{2})\Big)^{2}2\pi r~\mathrm{d}r}{\Big( \frac{\rho gJ}{8\mu}r_{0}^{2} \Big)^{2}\pi r_{0}^{2}}  
	= 1.33
	\end{align}




沿程水头损失的计算
^^^^^^^^^^^^^^^^^^^^

将 :math:`r_{0}=\frac{d}{2}` ， :math:`J=\frac{h_{f}}{l}` 代入圆管层流的平均流速表达式，整理得到

.. math::
	\begin{align}
	h_{f} = \frac{32\mu lv}{\rho gd^{2}}
	\end{align}

上式从理论上证明了层流沿程水头损失与断面平均流速一次方成正比。进一步将上式写成计算沿程损失的一般形式：

.. math::
	\begin{align}
	h_{f} = \lambda \frac{l}{d}\frac{v^{2}}{2g} = \frac{32\mu l}{\rho gd^{2}}v = \frac{64}{\text{Re}}\frac{l}{d}\frac{v^{2}}{2g}     
	\end{align}

对比系数可以得到圆管层流的沿程阻力系数的计算表达式：

.. math::
	\begin{align}
	\lambda = \frac{64}{\text{Re}} 
	\end{align}


上式表明，圆管层流的沿程阻力系数只是雷诺数的函数，与壁面粗糙度无关。





湍流运动简介
--------------

湍流中不断产生无数大小不等、转向不同的涡体。涡体是具有旋转运动的流体团，而且无规则地运动，使湍流显现出以下特征。

流体质点在流动过程中不断相互掺混，质点掺混使得流场中固定空间点上的各种运动要素，如流速压强等都随时间不断波动，这种波动称为 **脉动** 。湍流脉动具有如下的一些特点：

- 随机性：脉动是一个随机过程，脉动值时大时小，方向有正有负，但总是围绕一个平均值波动。
- 三维性：脉动总是三维的，即虽然主流的流动只沿一个方向，却都产生三个方向的脉动速度，其中沿主流流动方向的脉动量最大，而以既垂直于主流流动方向又垂直于固体边壁面方向的脉动量最小。
- 脉动量的数值有时候很大，不能当做微量进行处理。其变化量可以是最大值的几分之一，甚至三分之一或二分之一。
  

湍流运动的时均化
^^^^^^^^^^^^^^^^^^^

湍流的脉动现象十分复杂，脉动的幅度和频率变化无明显的规律性，是一种随机性质的波动，因此广泛采用的方法是时间平均法，将湍流流动视作两种流动的叠加： **时间平均流动** 和 **脉动流动** 。

将 :math:`u_{x}` 对某一时段 :math:`T` 平均，即

.. math::
	\begin{align}
	\overline{u_{x}} = \frac{1}{T}\int_{0}^{T}u_{x}~\mathrm{d}t
	\end{align}

只要所取的时间 :math:`T` 不是很短，在 :math:`T` 时段内瞬时量的时间变化过程能够代表该量所有可能出现得状态特征， :math:`\overline{u_{x}}` 值便与 :math:`T` 的长短无关， :math:`\overline{u_{x}}` 就是该点 :math:`x` 方向的 **时均流速** 。


定义了时均流速，瞬时流速就等于时均流速与脉动流速的叠加，即

.. math::
	\begin{align}
	u_{x} = \overline{u_{x}} + u_{x}'
	\end{align}

其中 :math:`u_{x}'` 为该点在 :math:`x` 方向的 **脉动流速** 。脉动流速随时间而变化，在时间段 :math:`T` 内，脉动流速的时均值为零，即

.. math::
	\begin{align}
	\overline{u_{x}'} = \frac{1}{T}\int_{0}^{T}u_{x}'~\mathrm{d}t = 0
	\end{align}

类似地，垂直于主流方向的脉动流速时均值也为零，即 :math:`\overline{u_{y}'}=0,\overline{u_{z}'}=0` 。但是，脉动流速的均方值不等于零，即

.. math::
	\begin{align}
	\overline{u_{x}'^{2}} = \frac{1}{T}\int_{0}^{T}u_{x}'^{2} ~\mathrm{d}t
	\end{align}

y,z方向的脉动流速的均方值也类似表示为 :math:`\overline{u_{y}'^{2}},\overline{u_{z}'^{2}}` 。常用湍流强度 :math:`N` 来表示湍流的程度：

.. math::
	\begin{align}
	N = \frac{\sqrt{\frac{1}{3}(\overline{u_{x}'^{2}} + \overline{u_{y}'^{2}} + \overline{u_{z}'^{2}})} }{\overline{u_{x}}} 
	\end{align}



+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| 符号                 | 含义         | 解释                                                                                                                   |
+======================+==============+========================================================================================================================+
| :math:`u`            | 瞬时流速     | 某一空间点在某一时刻的实际流速，在湍流流态下随时间脉动                                                                 |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`\overline{u}` | 时均流速     | 某一空间点的瞬时流速在时段 :math:`T` 内的时间平均值，即 :math:`\overline{u}=\frac{1}{T}\int_{0}^{T}u\mathrm{d}t`       |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`u'`           | 脉动流速     | 某一空间点的瞬时流速与时均流速的差值                                                                                   |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`v`            | 断面平均流速 | 过流断面上所有点的时均流速（层流时即为真实流速）的断面平均值，即 :math:`v=\frac{1}{A}\int_{A}\overline{u}~\mathrm{d}A` |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`p`            | 瞬时压强     | 某一空间点在某一时刻的实际压强，在湍流流态下随时间脉动                                                                 |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`\overline{p}` | 时均压强     | 某一空间点的瞬时压强在时段 :math:`T` 内的时间平均值，即 :math:`\overline{p}=\frac{1}{T}\int_{0}^{T}p\mathrm{d}t`       |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`p'`           | 脉动压强     | 某一空间点的瞬时压强与时均压强的差值                                                                                   |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+



湍流切应力
^^^^^^^^^^^^^

在湍流流动中，切应力由两部分组成：

(1) 因为流层相对运动而产生的时均粘性切应力 :math:`\overline{\tau_{1}}` ，仍然符合牛顿内摩擦定律，即
    
.. math::
	\begin{align}
	\overline{\tau_{1}} = \mu\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}
	\end{align}

其中 :math:`\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}` 为时均流速梯度。

(2) 因为湍流脉动、上下层质点相互掺混，在相邻流层间产生了动量交换，从而在流层分界面上形成了湍流 **附加切应力** :math:`\overline{\tau_{2}}` 。
    

普朗克混合长度理论，为计算平面恒定均匀湍流切应力建立了一个简易、可行的计算模型：设二维恒定均匀湍流，流向与 :math:`x` 轴平行，如图所示，A点沿 :math:`x` 方向的瞬时流速为 :math:`u_{x}=\overline{u_{x}} + u_{x}'` ，横向脉动流速为 :math:`u_{y}'` ，由于横向脉动，该处质点以 :math:`u_{y}'` 速度通过流层间的微小面积 :math:`\Delta A` 进入邻层，从而把本身所具有的动量传递给邻层，在 :math:`\Delta t` 时段内，通过 :math:`\Delta A` ，随质点转移的动量为

.. math::
	\begin{align}
	\Delta K = \Delta m (\overline{u_{x}} + u_{x}') = \rho \Delta A \cdot u_{y}'\Delta t (\overline{u_{x}} + u_{x}')
	\end{align}

根据质点动量定律，沿 :math:`x` 方向（即流动方向）质点栋梁的变化 :math:`\Delta K` 等于 :math:`\Delta t` 时段内作用在 :math:`\Delta A` 面上的切力 :math:`\Delta T` 的冲量，即

.. math::
	\begin{align}
	& \Delta T \cdot \Delta t = \rho \Delta A \cdot u_{y}'\Delta t (\overline{u_{x}} + u_{x}') \\
	& \tau_{2} = \frac{\Delta T}{\Delta A} =  \rho  u_{y}'(\overline{u_{x}} + u_{x}')
	\end{align}

取切应力的平均值则为

.. math::
	\begin{align}
	\overline{\tau_{2}} = \frac{1}{T}\int_{0}^{T}\rho  u_{y}'(\overline{u_{x}} + u_{x}')\mathrm{d}t
	= \rho \Big( \frac{1}{T}\int_{0}^{T}u_{y}'\overline{u_{x}}\mathrm{d}t + \frac{1}{T}\int_{0}^{T}u_{y}'u_{x}'\mathrm{d}t\Big)  
	\end{align}

而由于

.. math::
	\begin{align}
	\frac{1}{T}\int_{0}^{T}u_{y}'\overline{u_{x}}\mathrm{d}t
	= \frac{1}{T} \overline{u_{x}} \int_{0}^{T}u_{y}'\mathrm{d}t=0
	\end{align}

因此化简得到附加切应力的大小的表达式：

.. math::
	\begin{align}
	\overline{\tau_{2}} = \rho\frac{1}{T}\int_{0}^{T}u_{x}'u_{y}'\mathrm{d}t = \rho\overline{u_{x}'u_{y}'}  
	\end{align}

其中 :math:`\overline{u_{x}'u_{y}'}` 表示脉动流速乘积的时均值。


下面考虑附加切应力的方向。设流动的流速梯度 :math:`\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}` 为正值：

- 当 :math:`u_{y}'` 为正时，质量从下层传递到上层，因下层的时均流速小于上层，有减缓上层流体运动的作用，在大多数情况下可以认为 :math:`u_{x}'` 为负值，可以得到 :math:`u_{y}'u_{x}'` 为负值。
- 当 :math:`u_{y}'` 为负时，质量从上往下传递，由于上层的时均流速较大，所以其 :math:`u_{x}'` 可以认为是正值，又可以得到 :math:`u_{y}'u_{x}'` 为负值。
  
为了让附加切应力 :math:`\overline{\tau_{2}}` 与粘性切应力的表示方式一致以正值出现，所以应该在原表达式加上负号，即得到用脉动流速表示的 **湍流附加切应力** ：

.. math::
	\begin{align}
	\overline{\tau_{2}} = -\rho\overline{u_{x}'u_{y}'}
	\end{align}

上式表明，湍流附加切应力只与流体密度和脉动速度有关，而与流体粘性无关。 **湍流切应力** 应该是粘性切应力与附加切应力之和，即

.. math::
	\begin{align}
	\overline{\tau} = \overline{\tau_{1}} + \overline{\tau_{2}} = \mu\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} -\rho\overline{u_{x}'u_{y}'}
	\end{align}


由于 :math:`u_{x}'` 、 :math:`u_{y}'` 是随时间无规则变化的，不容易确定，需要把用脉动流速表示的附加切应力转化为以时均流速表示的形式。普朗特比拟气体分子自由程的概念，提出混合长度理论解决了这个问题。混合长度理论假设为：

(1) 流体质点因横向脉动流速作用，在横向运动到相距为 :math:`l'` 的空间距离上，才同周围质点发生动量交换，并且假定该质点在横向运动过程中动量保持不变，直到新的位置时，才与周围的流体质点相混合。距离为 :math:`l'` 的两个流层的时均流速之差为
    
.. math::
	\begin{align}
	\Delta \overline{u_{x}} = \overline{u_{x}}(y+l') - \overline{u_{x}}(y)
	= \overline{u_{x}}(y) + l'\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} - \overline{u_{x}}(y)
	= l'\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}
	\end{align}

(2) 脉动流速 :math:`u_{x}'` 与这两个流层的时均流速差 :math:`\Delta \overline{u_{x}}` 成正比，即 :math:`u_{x}' = \pm c_{1}l'\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}` 。
(3) 横向脉动流速 :math:`u_{y}'` 与纵向脉动流速 :math:`u_{x}'` 成比例，但是符号相反，即 :math:`u_{y}' = \mp c_{2}l'\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}` 。
    
根据前面的假设就可以得到

.. math::
	\begin{align}
	\overline{\tau_{2}} = -\rho\overline{u_{x}'u_{y}'}
	= \rho c_{1}c_{2}(l')^{2}\Big( \frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} \Big)^{2}
	\end{align}

令 :math:`l^{2}=c_{1}c_{2}(l')^{2}` ，则得到 **用时均流速表示的附加切应力公式** ：

.. math::
	\begin{align}
	\overline{\tau_{2}} = \rho l^{2} \Big( \frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} \Big)^{2}
	\end{align}

其中 :math:`l` 称为 **混合长度** 。据此可以得到简化的湍流切应力为

.. math::
	\begin{align}
	\overline{\tau} = \overline{\tau_{1}} + \overline{\tau_{2}}
	= \mu\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} + \rho l^{2} \Big( \frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} \Big)^{2}
	\end{align}

上式中两部分切应力的大小随湍流情况而有所不同。在雷诺数较小，湍流较弱时，前者占主导地位；随着雷诺数增大，湍流程度增大，后者逐渐加大；当雷诺数很大时，湍流充分发展，前者可以忽略不计。



湍流断面流速分布
^^^^^^^^^^^^^^^^^^^

普朗特为了推出湍流的断面流速分布，进一步做出下面两个假定：

(1) 壁面附近的切应力等于壁面上的切应力，即 :math:`\tau = \tau_{0}` 。
(2) 混合长度 :math:`l` 与质点到壁面的距离 :math:`y` 成正比，即 :math:`l=\kappa y` ，其中 :math:`\kappa` 为卡门通用常数，实验表明 :math:`\kappa\approx 0.4` 。
    
将上述假设代入简化的湍流切应力表达式则有

.. math::
	\begin{align}
	\tau_{0} = \rho (\kappa y)^{2} \Big( \frac{\mathrm{d}u}{\mathrm{d}y} \Big)^{2}
	\quad \Rightarrow \quad 
	\mathrm{d}u = \frac{1}{\kappa}\sqrt{\frac{\tau_{0}}{\rho}}\frac{\mathrm{d}y}{y}   
	\end{align}

其中 :math:`\tau_{0}` 为定值，阻力速度 :math:`v_{*}=\sqrt{\frac{\tau_{0}}{\rho}}` 为常数，从而可以对上式积分得到 **湍流断面流速分布的对数公式** ：

.. math::
	\begin{align}
	u = \frac{v_{*}}{\kappa}\ln y + \text{const}
	\end{align}

.. note:: 虽然上式是根据壁面附近的条件推导出来的，但是实验研究表明，该式适用于除了粘性底层以外的整个过流断面。

.. attention:: 

	该理论的基本假设不够严谨，如认为流体质点经过混合长度之后，才一次性与周围质点进行动量交换，然而由于流体是连续介质，质点在横向运动过程中不断地与周围质点进行动量交换。又如公式中的常数 :math:`\kappa` 、 :math:`\text{const}` 等都需要实验确定。但尽管如此，这一理论是从湍流的基本特征出发，同时推导简单，理论结果与实验比较一致，所以仍是工程上广泛应用的湍流阻力理论。



湍流核心与粘性底层
^^^^^^^^^^^^^^^^^^^^^

以圆管湍流为例。由于湍流运动中流体质点的横向掺混，断面速度呈对数分布形式，与层流的抛物线分布对比，湍流过流断面上时均流速分布要均匀地多。实验表明圆管湍流过流断面上的流速分布大致可以分为三个区域：

- 紧贴管壁的一层流体粘附在壁面上（满足粘性流体壁面上无滑移条件），使得紧靠壁面很薄的流层内，速度由零很快增至一定值，速度梯度很大，因而粘性切应力起主导作用，其流态基本上属于层流。同时，由于壁面限制了质点横向掺混，脉动速度和附加切应力趋于消失。所以，紧靠壁面存在一个粘性切应力起主导作用的薄层，称为 **粘性底层** 。
- 由于湍流脉动、质点相互掺混，产生动量交换的结果，使得离边壁不远处到管中心的绝大部分区域时均流速分布比较均匀，流体处于湍流运动状态，湍流附加切应力起出道作用，这一区域称为 **湍流核心** 。
- 在湍流核心和粘性底层之间存在着范围很小的过渡层。因为其实际意义不大，可以不加考虑。
  
在粘性底层内，流速分布近似为直线，壁面切应力满足

.. math::
	\begin{align}
	\tau_{0} = \mu\frac{\mathrm{d}u}{\mathrm{d}y}\approx \mu\frac{u}{y}
	\end{align}

将 :math:`\mu=\rho\nu` 代入上式，整理得到

.. math::
	\begin{align}
	u = \frac{\tau_{0}}{\rho}\frac{y}{\nu}
	\end{align}

考虑到阻力速度 :math:`v_{*}=\sqrt{\frac{\tau_{0}}{\rho}}` ，则粘性底层的速度分布可以写成

.. math::
	\begin{align}
	\frac{u}{v_{*}} = \frac{v_{*}y}{\nu}
	\end{align}

.. note:: 其中 :math:`\frac{u}{v_{*}}` 也常记为 :math:`u^{+}` ； :math:`\frac{v_{*}y}{\nu}` 也常记为 :math:`y^{+}` 。

注意到 :math:`y^{+}` 是某一雷诺数。当 :math:`y<\delta_{0}` 是为层流，而当 :math:`y \to \delta_{0}` 时， :math:`\frac{v_{*}y}{\nu}` 等于某一数值的临界雷诺数。实验表明此数值为 :math:`\frac{v_{*}y}{\nu}=11.6` ，由此可以得到

.. math::
	\begin{align}
	\delta_{0} = 11.6\frac{\nu}{v_{*}}
	\end{align}

将之前推导的阻力速度的表达式 :math:`v_{*} = v\sqrt{\frac{\lambda }{8}}` 代入上式，即可得到 **粘性底层理论厚度的计算公式** ：

.. math::
	\begin{align}
	\delta_{0} = 11.6\frac{\nu}{v\sqrt{\frac{\lambda }{8}}} = \frac{32.8d}{\text{Re}\sqrt{\lambda } }  
	\end{align}

实际厚度要比理论厚度小一些。上式表明， :math:`\delta_{0}` 随 :math:`Re` 的增加而减小。




湍流沿程损失的分析与计算
---------------------------


尼古拉兹实验
^^^^^^^^^^^^^^^

计算湍流沿程损失，关键是如何确定沿程阻力系数 :math:`\lambda` 值。为了探索湍流沿程阻力系数的变化规律，验证和发展普朗特混合长度理论，尼古拉兹在人工均匀砂砾粗糙管道中进行了系统的沿程阻力系数和断面流速分布的测定工作，称之为尼古拉兹实验。

湍流的阻力是由粘性切应力和附加切应力形成的。壁面的每个粗糙点都将成为不断产生并向管流中输送旋涡而引起湍动的源泉，所以管壁粗糙也是影响 :math:`\lambda` 值的一个重要因素。也就是说，对于湍流来说，沿程阻力系数 :math:`\lambda` 值不仅与 :math:`\text{Re}` 有关，而且还与管壁粗糙度有关。壁面粗糙一般包括粗糙突起的高度、形状、疏密和排列等许多因素。为了便于分析粗糙的影响，尼古拉兹在实验中采用了一种简化的粗糙模型—— **人工粗糙** ，即用经过筛选的均匀砂粒，紧密地贴在管道的内部上，这样粗糙特性可以认为是一致的，相关衡量指标为：

+----------------------------------------+--------------------------------------------------------------------------+
| 符号                                   | 含义                                                                     |
+========================================+==========================================================================+
| :math:`k_{s}`                          | 用砂粒的突起高度（砂粒直径）表示壁面的粗糙，称为 **绝对粗糙度**          |
+----------------------------------------+--------------------------------------------------------------------------+
| :math:`k_{s}/d` 或 :math:`k_{s}/r_{0}` | 绝对粗糙度与管径或半径之比称为相对粗糙度，表示不同直径管道管壁粗糙的影响 |
+----------------------------------------+--------------------------------------------------------------------------+


从以上分析可以看出，雷诺数和相对粗糙度是沿程阻力系数的两个影响因素，即

.. math::
	\begin{align}
	\lambda = f(\text{Re}, k_{s}/d)
	\end{align}


尼古拉兹应用类似雷诺实验的装置，但是采用的是人工粗糙管进行实验，实验管道相对粗糙度的变化范围为 :math:`\frac{k_{s}}{d}=\frac{1}{30}\sim \frac{1}{1014}` ，对于每一根管道实测不同流量的断面平均流速 :math:`v` 和沿程水头损失 :math:`h_{f}` 计算出雷诺数和沿程阻力系数：

.. math::
	\begin{align}
	& \text{Re} = \frac{v d}{\nu} \\
	& \lambda = \frac{d}{l}\frac{2g}{v^{2}}h_{f}
	\end{align}

将其点绘制在对数坐标纸上，就得到了 :math:`\lambda = f(\text{Re}, k_{s}/d)` 曲线，即尼古拉兹实验曲线图。根据该曲线图，可以将沿程阻力分为5个阻力区：

+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 沿程阻力区 | 含义                                                                                                                                                                                   |
+============+========================================================================================================================================================================================+
| 层流区     | 当 :math:`Re<2000` 时，不同相对粗糙管的实验点都落在同一根直线上，表明 :math:`\lambda` 仅随 :math:`Re` 变化而与相对粗糙度无关，并且满足 :math:`\lambda=64/Re`                           |
+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 临界区     | 在 :math:`Re=2000\sim4000` 范围内，不同相对粗糙管的实验点都落在同一条曲线上， :math:`\lambda` 仅随 :math:`Re` 变化而与相对粗糙度无关。此层是层流向湍流的过渡区，范围很窄且实用意义不大 |
+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 湍流光滑区 | 在 :math:`Re>4000` 以后，不同相对粗糙管的实验点都落在同一条曲线上，表明 :math:`\lambda` 仅随 :math:`Re` 变化而与相对粗糙度无关。                                                       |
|            | 但是随着 :math:`Re` 增大，相对粗糙度大的管道，实验点在 :math:`Re` 较低时便偏离了光滑区曲线；相对粗糙度小的管道，在 :math:`Re` 较大时才偏离光滑区曲线。                                 |
+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 湍流过渡区 | 不同相对粗糙管的实验点分别落在不同的曲线上，形成一簇波状曲线，表明 :math:`\lambda` 既与 :math:`Re` 有关也与相对粗糙度有关。                                                            |
+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 湍流粗糙区 | 不同相对粗糙管的实验点分别落在一些与横坐标平行的直线上，表明 :math:`\lambda` 只与相对粗糙度有关而与 :math:`Re` 无关。                                                                  |
|            | 在这个阻力区，对于一定的管道，相对粗糙度是定值， :math:`\lambda` 是常数，可以得到沿程水头损失与流速平方成正比，因此该区也称为阻力平方区。                                              |
+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+



.. note:: 

	可以用粘性底层的厚度是否能掩盖粗糙突起的高度，来解释湍流为何分为三个阻力区并具有不同的 :math:`\lambda` 变化规律：

	- 在湍流光滑区，粘性底层的厚度 :math:`\delta` 显著地大于粗糙突起的高度，粗糙突起完全被掩盖在粘性底层内，对湍流核心的流动几乎没有影响，就好像在完全光滑的壁面上流动一样，因此 :math:`\lambda` 只与 :math:`Re` 而与相对粗糙度无关。
	- 在湍流过渡区，随着 :math:`Re` 增大，粘性底层的厚度变薄，接近粗糙突起的高度，粗糙影响到湍流核心区的流动，加大了核心区的湍动强度，增加了流动阻力和能量损失，这时 :math:`\lambda` 不仅与 :math:`Re` 有关并且与相对粗糙度有关。
	- 在湍流粗糙区，粘性底层更薄，粗糙突起几乎全部暴露在湍流核心之中，成为产生附加切应力的主要原因，而 :math:`Re` 的影响已经微不足道，所以此时 :math:`\lambda` 只与相对粗糙度有关而与 :math:`Re` 无关。
	  


粘性底层的厚度为 :math:`\delta = 11.6\frac{\nu}{v_{*}}` ，将其两边同时除以绝对粗糙度 :math:`k_{s}` 得到

.. math::
	\begin{align}
	\frac{\delta}{k_{s}} = 11.6\frac{\nu}{v_{*}k_{s}} = 11.6\frac{1}{Re_{*}}
	\end{align}

其中 :math:`Re_{*}=\frac{v_{*}k_{s}}{\nu}` 称为 **粗糙雷诺数** ，可以作为人工粗糙管阻力分区的判别标准。根据尼古拉兹实验，人工粗糙管湍流三个阻力区的判别标准为：

- 湍流光滑区： :math:`Re_{*}\leq 5` 或 :math:`\frac{\delta}{k_{s}} \leq 0.4` 。
- 湍流过渡区： :math:`5 < Re_{*} \leq 70` 或 :math:`0.4 < \frac{\delta}{k_{s}} \leq 6` 。
- 湍流粗糙区： :math:`Re_{*} > 70` 或 :math:`\frac{\delta}{k_{s}} > 6` 。
  



人工粗糙管沿程阻力系数的半经验公式
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

在 **湍流光滑区** 中，流速分布分为粘性底层和湍流核心两部分。粘性底层的流速为线性分布，满足

.. math::
	\begin{align}
	u = \frac{\tau_{0}}{\mu}y \quad(y\leq \delta) 
	\end{align}

在湍流核心的流速分布为对数分布，满足

.. math::
	\begin{align}
	u = \frac{v_{*}}{\kappa}\ln y + C 
	\end{align}

由边界条件 :math:`y=\delta, u=u_{b}` 代入上式得到

.. math::
	\begin{align}
	C = u_{b} - \frac{v_{*}}{\kappa}\ln\delta
	\end{align}

根据 :math:`u_{b}=\frac{\tau_{0}}{\mu}\delta` 以及 :math:`v_{*}=\sqrt{\frac{\tau_{0}}{\rho}}` 可以得到

.. math::
	\begin{align}
	\delta = \frac{u_{b}\nu \rho}{\tau_{0}} = \frac{u_{b}}{v_{*}^{2}}\nu  
	\end{align}

将 :math:`C` 和 :math:`\delta` 代回湍流核心流速分布式，整理得到

.. math::
	\begin{align}
	\frac{u}{v_{*}}=\frac{1}{\kappa}\ln\frac{v_{*}y}{\nu} + \frac{u_{b}}{v_{*}} - \frac{1}{\kappa}\ln\frac{u_{b}}{v_{*}}
	\end{align}

令 :math:`C_{1}=\frac{u_{b}}{v_{*}} - \frac{1}{\kappa}\ln\frac{u_{b}}{v_{*}}` ，并根据尼古拉兹实验，取 :math:`\kappa=0.4` ， :math:`C_{1}=5.5` ，同时把自然对数换算成常用对数，即可得到 **湍流光滑区流速分布公式** ：

.. math::
	\begin{align}
	\frac{u}{v_{*}} = 5.75\lg\frac{v_{*}y}{\nu} + 5.5
	\end{align}


.. note:: 

	湍流光滑区的流速分布除了上述半经验公式之外，尼古拉兹根据实验结果还提出了一个更为简便的指数公式：

	.. math::
		\begin{align}
		\frac{u}{u_{\max}} = \Big(\frac{y}{r_{0}}\Big)^{n}
		\end{align}

	其中 :math:`u_{\max}` 为管轴处的最大流速， :math:`r_{0}` 为圆管半径， :math:`n` 为随雷诺数变化的指数。


由于粘性底层很薄，计算流量的时候可以忽略不计，于是

.. math::
	\begin{align}
	v = \frac{Q}{A} = \frac{\int_{A}u~\mathrm{d}A}{A} = \frac{\int_{0}^{r_{0}}u\cdot 2\pi r~\mathrm{d}r}{\pi r_{0}^{2}}
	\end{align}

其中 :math:`u` 以半经验公式代入，积分即可得到 **湍流光滑区的断面平均流速公式** ：

.. math::
	\begin{align}
	v = v_{*}5.75\lg\frac{v_{*}r_{0}}{\nu} + 1.75 
	\end{align}


以 :math:`v_{*}=v\sqrt{\frac{\lambda}{8}}` 代入上式，整理可以得到 :math:`\frac{1}{\sqrt{\lambda}} = 2.03\lg(Re\sqrt{\lambda }) - 0.9` 。根据尼古拉兹实验，将式中的常数分别修正为 :math:`2.0` 和 :math:`0.8` ，于是就得到 **尼古拉兹光滑管公式** ：

.. math::
	\begin{align}
	\frac{1}{\sqrt{\lambda}} = 2\lg(Re\sqrt{\lambda }) - 0.8
	\quad \text{or} \quad 
	\frac{1}{\sqrt{\lambda }} = 2\lg\frac{Re\sqrt{\lambda }}{2.51}  
	\end{align}



在 **湍流粗糙区** ，粘性底层厚度远小于壁面粗糙突起的高度，粘性底层已经没有实际意义，整个断面上流速分布都可以认为符合对数分布，即

.. math::
	\begin{align}
	u = \frac{v_{*}}{\kappa}\ln y + C 
	\end{align}

其中 :math:`C` 与管壁粗糙度有关，采用边界条件 :math:`y=k_{s}, u=u_{s}` 代入上式得到

.. math::
	\begin{align}
	C = \frac{u_{s}}{v_{*}} - \frac{1}{\kappa}\ln k_{s}  
	\end{align}

将 :math:`C` 代回流速分布式，整理得到

.. math::
	\begin{align}
	\frac{u}{v_{*}} = \frac{1}{\kappa}\ln\frac{y}{k_{s}} + \frac{u_{s}}{v_{*}} = \frac{1}{\kappa}\ln\frac{y}{k_{s}} + C_{2}
	\end{align}

其中 :math:`C_{2}=\frac{u_{s}}{v_{*}}` 。根据尼古拉兹实验，取 :math:`\kappa = 0.4, C_{2}=8.48` ，代入上式，并把自然对数换算成常用对数，便得到 **湍流粗糙区流速分布半经验公式** ：

.. math::
	\begin{align}
	\frac{u}{v_{*}} = 5.75\ln\frac{y}{k_{s}} + 8.48  
	\end{align}

将上式代入 :math:`v = \frac{Q}{A} = \frac{\int_{A}u~\mathrm{d}A}{A} = \frac{\int_{0}^{r_{0}}u\cdot 2\pi r~\mathrm{d}r}{\pi r_{0}^{2}}` ，积分可以得到 **湍流粗糙区断面平均流速公式** ：

.. math::
	\begin{align}
	\frac{v}{v_{*}} = 5.75\ln\frac{r_{0}}{k_{s}} + 4.75
	\end{align}

将 :math:`v_{*}=v\sqrt{\frac{\lambda}{8}}` 代入上式，整理得到 :math:`\frac{1}{\sqrt{\lambda }} = 2.03\lg\frac{r_{0}}{k_{s}} + 1.68` ，根据尼古拉兹实验，将式中常数分别修正为 :math:`2.0` 和 :math:`1.74` ，于是得到 **尼古拉兹粗糙管公式** ：

.. math::
	\begin{align}
	\frac{1}{\sqrt{\lambda }} = 2\lg\frac{r_{0}}{k_{s}} + 1.74
	\quad \text{or} \quad 
	\frac{1}{\sqrt{\lambda }} = 2\lg\frac{3.7d}{k_{s}}
	\end{align}



非圆管道的沿程损失计算
^^^^^^^^^^^^^^^^^^^^^^^^

对于非圆形断面的管道，圆管流动的沿程阻力计算公式、沿程阻力系数公式以及雷诺数仍然适用，但是要把公式里的直径 :math:`d` 换为当量直径 :math:`d_{e}` 。

由于水力半径是综合反映过流断面大小和几何形状对流动影响的物理量，如果非圆形管道的水力半径等于某圆管的水力半径，当其他条件相同时，可以认为这两个管道的沿程损失是相等的。因此，和非圆形管道水力半径相等的圆管直径称为该非圆形管道的 **当量直径** :math:`d_{e}` 。和圆形管道相类比，非圆形管道当量直径是水力半径的4倍，即

.. math::
	\begin{align}
	d_{e} = 4R = 4\frac{A}{\chi}
	\end{align}


.. attention:: 

	应用当量直径来计算非圆形管道的沿程损失并不适用于所有情况，主要表现为以下两个方面：

	1. 断面形状同圆管差异很大的非圆管，如长缝形（ :math:`b/a>8` ）、狭环形（ :math:`d_{2}<3d_{1}` ）、星形断面，应用当量直径计算存在较大误差。
	2. 由于层流的流速分布和湍流不一样，流动阻力和沿程损失不像湍流那样集中在管壁附近，所以在层流中应用当量直径进行计算也会造成较大误差。



管道和明流的局部损失
----------------------

流体在流经阀门、弯管等部件时，均匀流动受到破坏，流速的大小、方向和分布发生变化。在较短范围内，由于流动的急剧调整而集中产生的流动阻力称为 **局部阻力** ，所产生的能量损失称为 **局部损失** 。局部损失产生的主要原因有：

1. 主流与边壁分离形成旋涡区是产生局部损失的主要原因。
2. 流动方向的变化形成二次流，也将产生一定的能量损失。
   
和沿程损失一样，局部损失一般也用流速水头的倍数来表示，局部损失计算公式为

.. math::
	\begin{align}
	h_{j} = \zeta \frac{v^{2}}{2g} 
	\end{align}

其中 :math:`\zeta` 为局部阻力系数， :math:`v` 为与 :math:`\zeta` 对应的断面平均流速。理论上局部阻力系数应该与局部阻碍处的雷诺数和边界情况有关，但是实际上流动受到局部阻碍的强烈扰动，较早地进入了阻力平方区， :math:`\zeta` 与 :math:`Re` 无关，只决定于局部阻碍的形状。

下面进行突扩管局部损失的分析。设突然扩大同轴管如图所示，列出扩大前断面1-1和扩大后流速分布与湍流脉动已经接近均匀流状态的断面2-2的伯努利方程，忽略两断面间的沿程损失，则有

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha _{1}v_{1}^{2}}{2g} = z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha _{2}v_{2}^{2}}{2g} + h_{j} 
	\end{align}

于是得到

.. math::
	\begin{align}
	h_{j} = \Big(z_{1}+\frac{p_{1}}{\rho g} \Big) - \Big( z_{2} + \frac{p_{2}}{\rho g} \Big) + \frac{\alpha _{1}v_{1}^{2} - \alpha_{2}v_{2}^{2}}{2g}
	\end{align}

对 :math:`AB` 、2-2断面和两断面间侧壁面所构成的控制体，列出流动方向的动量方程为

.. math::
	\begin{align}
	\sum \mathbf{F} = \rho Q (\beta_{2}v_{2} - \beta_{1}v_{1})
	\end{align}

其中 :math:`\sum \mathbf{F}` 包括：

- 作用在 :math:`AB` 面上的压力 :math:`P_{AB}` （受压面积是 :math:`A_{2}` ），其中环形部分位于旋涡区，实验观察表明这个环形面积的压强基本符合静压强分布规律，故 :math:`P_{AB}=p_{1}A_{2}` ；
- 作用在2-2断面上的压力 :math:`P_{2}=p_{2}A_{2}` ；
- 重力在管轴上的投影 :math:`G\cos\theta = \rho gA_{2}(z_{1}-z_{2})` ；
- 管壁上的摩擦阻力忽略不计。
  
将各项力代入动量方程，得到

.. math::
	\begin{align}
	p_{1}A_{2} - p_{2}A_{2} + \rho g A_{2}(z_{1}-z_{2}) = \rho Q(\beta_{2}v_{2} - \beta_{1}v_{1})
	\end{align}

将 :math:`Q = v_{2}A_{2}` 代入上式，并在等号两边同时除以 :math:`\rho g A_{2}` ，整理得到

.. math::
	\begin{align}
	\Big(z_{1}+\frac{p_{1}}{\rho g} \Big) - \Big( z_{2} + \frac{p_{2}}{\rho g} \Big) = \frac{v_{2}}{g}(\beta_{2}v_{2}-\beta_{1}v_{1}) 
	\end{align}

将上式代回沿程损失的表达式，对于湍流近似取 :math:`\alpha_{1}=\alpha_{2}=1,\beta_{1}=\beta_{2}=1` ，整理得到 **Borda公式** ：

.. math::
	\begin{align}
	h_{j} = \frac{(v_{1}-v_{2})^{2}}{2g} 
	\end{align}

为了将上式变为局部损失的一般形式，只需要将 :math:`v_{2}=v_{1}\frac{A_{1}}{A_{2}}` 或者 :math:`v_{1}=v_{2}\frac{A_{2}}{A_{1}}` 代入，即可得到

.. math::
	\begin{align}
	h_{j} = \Big(1-\frac{A_{1}}{A_{2}} \Big)^{2}\frac{v_{1}^{2}}{2g} = \zeta_{1}\frac{v_{1}^{2}}{2g}
	\quad \text{or} \quad 
	h_{j} = \Big(\frac{A_{2}}{A_{1}}-1 \Big)^{2}\frac{v_{2}^{2}}{2g} = \zeta_{2}\frac{v_{2}^{2}}{2g}
	\end{align}



.. note:: 

	可以看到，突然扩大的局部阻力系数为

	.. math::
		\begin{align}
		\zeta_{1}=\Big(1-\frac{A_{1}}{A_{2}} \Big)^{2}
		\quad \text{or} \quad
		\zeta_{2}=\Big(\frac{A_{2}}{A_{1}}-1 \Big)^{2}
		\end{align}

	当流体从管道流入断面很大的容器中，或者气体流入大气时，有 :math:`\frac{A_{1}}{A_{2}}\approx 0, \zeta_{1}=1` ，这时突然扩大的特殊情况，称为 **出口阻力系数** 。






量纲分析和相似原理
=====================

量纲可以分为基本量纲和诱导量纲。 **基本量纲** 是相互独立的量纲，即一个基本量纲不能从其他基本量纲中推导出来，也就不依赖于其他基本量纲。对于力学问题，通常将长度量纲 :math:`L` 、质量量纲 :math:`M` 和时间量纲 :math:`T` 作为基本量纲。 **诱导量纲** 是由基本量纲推导出来的其他物理量的量纲，力学中任何一个物理量 :math:`x` 的量纲都可以用三个基本量纲的指数乘积形式表示，即 **量纲公式** ：

.. math::
	\begin{align}
	\mathrm{dim}x = L^{\alpha }T^{\beta}M^{\gamma}
	\end{align}


.. note:: 有量纲的量只能作简单的代数运算，只有无量纲化后才能进行超越函数的运算。




量纲分析法
-------------

瑞利法
^^^^^^^^^

瑞利法的基本原理是某一物理过程与 :math:`n` 个物理量有关，即

.. math::
	\begin{align}
	f(x_{1}.x_{2},\cdots,x_{n})=0
	\end{align}

其中某个物理量 :math:`x_{i}` 可以表示为其他物理量的指数乘积形式：

.. math::
	\begin{align}
	x_{i} = kx_{1}^{a}x_{2}^{b}\cdots x_{n-1}^{m}
	\end{align}

其量纲式为

.. math::
	\begin{align}
	\mathrm{dim}x_{i} = k \cdot \mathrm{dim}(x_{1}^{a}x_{2}^{b}\cdots x_{n-1}^{m})
	\end{align}

将上式中各物理量的量纲按照量纲公式表示为基本量纲的指数乘积形式，并根据量纲和谐原理确定出待定指数 :math:`a,b,\cdots,m` ，即可求得该物理过程的方程式，不过系数 :math:`k` 仍需要通过实验和分析加以确定。




π定理
^^^^^^^^

如果某一物理过程包含有 :math:`n` 个物理量，可以表示为如下函数关系：

.. math::
	\begin{align}
	f(x_{1}.x_{2},\cdots,x_{n})=0
	\end{align}

其中有 :math:`m` 个基本物理量，则该物理过程可以由 :math:`n` 个物理量构成的 :math:`(n-m)` 个无量纲组合量所表达的关系式来描述，即 :math:`\pi` 定理：

.. math::
	\begin{align}
	F(\pi_{1},\pi_{2},\cdots,\pi_{n-m})=0
	\end{align}

该定理的运用步骤如下：

1. 找出对物理过程有影响的 :math:`n` 个独立因素物理量，写成 :math:`f(x_{1}.x_{2},\cdots,x_{n})=0` 形式。
2. 从 :math:`n` 个物理量中选取 :math:`m` 个相互独立的基本物理量。对于不可压缩流体运动，一般取 :math:`m=3` 。设 :math:`x_{1},x_{2},x_{3}` 为所选的基本物理量，由量纲公式可得
   
.. math::
	\begin{align}
	& \mathrm{dim}x_{1} = L^{\alpha_{1}}T^{\beta_{1}}M^{\gamma_{1}} \\
	& \mathrm{dim}x_{2} = L^{\alpha_{2}}T^{\beta_{2}}M^{\gamma_{2}} \\
	& \mathrm{dim}x_{3} = L^{\alpha_{3}}T^{\beta_{3}}M^{\gamma_{3}}
	\end{align}

满足 :math:`x_{1},x_{2},x_{3}` 量纲独立的条件是量纲式中的指数行列式不等于零，即

.. math::
	\begin{align}
	\begin{vmatrix}
	 \alpha_{1} & \beta_{1} & \gamma_{1} \\
	 \alpha_{2} & \beta_{2} & \gamma_{2} \\
	 \alpha_{3} & \beta_{3} & \gamma_{3}
	\end{vmatrix}
	\ne 0
	\end{align}

3. 基本物理量依次与其余量组合成 :math:`n-m` 个无量纲 :math:`\pi` 项：
   
.. math::
	\begin{align}
	& \pi_{1} = \frac{x_{4}}{x_{1}^{a_{1}}x_{2}^{b_{1}}x_{3}^{c_{1}}} \\
	& \pi_{2} = \frac{x_{5}}{x_{1}^{a_{2}}x_{2}^{b_{2}}x_{3}^{c_{2}}} \\
	& \vdots \\
	& \pi_{n-3} = \frac{x}{x_{1}^{a_{n-3}}x_{2}^{b_{n-3}}x_{3}^{c_{n-3}}}
	\end{align}

4. 根据量纲和谐原理，求出各 :math:`\pi` 项的待定指数 :math:`a_{i},b_{i},c_{i}` 。
5. 写出描述该物理过程的关系式：
   
.. math::
	\begin{align}
	F(\pi_{1},\pi_{2},\cdots,\pi_{n-3})=0
	\end{align}



流动相似原理
---------------

模型试验就是根据相似原理，将需要进行试验的实际流动区域制作成相似的小比例尺的模型，根据模型试验的结果，推测原型可能发生的现象。

力学相似
^^^^^^^^^^^

流体力学相似包括四个方面：几何相似、运动相似、动力相似、初始条件和边界条件的相似。

**几何相似** 是指原型和模型两个流场的几何形状相似，即两个流场相应的线段长度成比例，相应的夹角相等。如果以 :math:`l` 表示某一线段的长度， :math:`\theta` 表示两条线段的夹角，以角标 :math:`p` 表示原型， :math:`m` 表示模型，则有

.. math::
	\begin{align}
	\lambda _{l} = \frac{l_{p}}{l_{m}}
	\qquad
	\theta_{p} = \theta_{m} 
	\end{align}

其中 :math:`\lambda_{l}` 为 **长度比尺** ，由此可以推得相应的面积比尺和体积比尺，即

.. math::
	\begin{align}
	\lambda_{A} = \frac{A_{p}}{A_{m}} = \frac{l_{p}^{2}}{l_{m}^{2}} = \lambda_{l}^{2} 
	\qquad 
	\lambda_{V} = \frac{V_{p}}{V_{m}} = \frac{l_{p}^{3}}{l_{m}^{3}} = \lambda_{l}^{3}
	\end{align}


.. note:: 

	- 严格来说，原型和模型表面粗糙度也应该具有相同的长度比尺，但在实际上往往只能近似做到这一点。
	- 几何相似是力学相似的前提，只有在几何相似的流动中才有可能存在相应的点，才有可能进一步探究对应点上其他物理量的相似问题。
	  

**运动相似** 是指两个流场相应点的速度方向相同，大小成比例，即

.. math::
	\begin{align}
	\lambda_{u} = \frac{u_{p}}{u_{m}} 
	\end{align}

其中 :math:`\lambda_{u}` 称为 **速度比尺** 。由于原型和模型各个相应点速度成比例，则相应断面的平均流速也必然具有同样比尺，即

.. math::
	\begin{align}
	\lambda_{v} = \frac{v_{p}}{v_{m}} = \frac{u_{p}}{u_{m}} = \lambda _{u}  
	\end{align}

将 :math:`v=l/t` 的关系代入上式可以得到

.. math::
	\begin{align}
	\lambda_{v} = \frac{l_{p}/t_{p}}{l_{m}/t_{m}} = \frac{l_{p}}{l_{m}}\frac{t_{m}}{t_{p}} = \frac{\lambda _{l}}{\lambda _{t}}  
	\end{align}

其中 :math:`\lambda_{t}=\frac{t_{p}}{t_{m}}` 为 **时间比尺** ，它表示模型和原型要实现相似所需要的时间之比。

速度相似就就意味着各相应点的加速度也是相似的，即

.. math::
	\begin{align}
	\lambda_{a} = \frac{a_{p}}{a_{m}} = \frac{\lambda_{l}}{\lambda_{t}^{2}} = \frac{\lambda_{v}}{\lambda_{t}} = \frac{\lambda_{v}^{2}}{\lambda_{l}}    
	\end{align}

其中 :math:`\lambda_{a}` 为 **加速度比尺** 。由此可见，只要速度相似，加速度也必然相似，反之亦然。


**动力相似** 是指两个流动各个相应点上，其质点所受到的各种作用力均维持一定的比例关系。根据达朗贝尔原理，对于任一运动的质点，设想加在该质点上的惯性力与质点所受到各种作用力相平衡，这些力构成一封闭的力多边形。从这个意义上说，动力相似表征为流体相应点上的力多边形相似，相应边（同名力）成比例。

一般影响流体运动的作用力主要有粘滞力、重力、压力，对于有些流动还需要考虑弹性力或表面张力。若分别用 :math:`T` 、 :math:`G` 、 :math:`P` 、 :math:`E` 、 :math:`S` 、 :math:`I` 代表粘滞力、重力、压力、弹性力、表面张力、惯性力，则有

.. math::
	\begin{align}
	\frac{T_{p}}{T_{m}} = \frac{G_{p}}{G_{m}} = \frac{P_{p}}{P_{m}} = \frac{E_{p}}{E_{m}} = \frac{S_{p}}{S_{m}} = \frac{I_{p}}{I_{p}}      
	\end{align}

也即

.. math::
	\begin{align}
	\lambda_{T} = \lambda_{G} = \lambda_{P} = \lambda_{E} = \lambda_{S} = \lambda_{I}
	\end{align}


**初始条件和边界条件的相似** 是保证两个流动相似的充分条件，正如初始条件和边界条件是微分方程的定解条件一样。对于非恒定流，初始条件是必需的；对于恒定流，初始条件则失去了实际意义。边界条件相似是指两个流动相应边界性质相同，如固体边界上的法线流速都为零；自由液面上液体压强均等于大气压强等。



相似准则
^^^^^^^^^^

两个流动要实现动力相似，作用在相应质点上的各种作用力的比尺就要满足一定的约束关系，这种约束关系称为 **相似准则** 。作用在流体质点上的力可以分为两类，一类是企图维持原有运动状态的力，如惯性力 :math:`I` ；另一类是企图改变其运动状态的力，如重力 :math:`G` 、粘滞力 :math:`T` 、动水压力 :math:`P` 等。流动的变化就是惯性力与其他各种作用力相互作用的结果。因此，各种力之间的比例关系应该以惯性力为一方来相互比较，在两个相似的流动中，这种比例关系应该保持不变。

惯性力满足 :math:`I=ma=\rho l^{3}a = \rho l^{2}v^{2}` ，则惯性力比尺为

.. math::
	\begin{align}
	\lambda_{l} = \frac{I_{p}}{I_{m}} = \lambda_{\rho}\lambda_{l}^{3}\lambda_{a} = \lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} 
	\end{align}

其中 :math:`\lambda_{\rho}` 为密度比尺。如果某一企图改变运动状态的力为 :math:`F` ，则两个流动相似时 :math:`F` 之比为 :math:`\lambda_{F}=\frac{F_{p}}{F_{m}}` 。根据动力相似有

.. math::
	\begin{align}
	\lambda _{I} = \lambda_{F}
	\quad \Rightarrow \quad
	\frac{\rho_{p}l_{p}^{2}v_{p}^{2}}{\rho_{m}l_{m}^{2}v_{m}^{2}} = \frac{F_{p}}{F_{m}}
	\quad \text{or} \quad 
	\frac{F_{p}}{\rho_{p}l_{p}^{2}v_{p}^{2}} = \frac{F_{m}}{\rho_{m}l_{m}^{2}v_{m}^{2}}      
	\end{align}

其中 :math:`\frac{F}{\rho l^{2}v^{2}}` 是一个无量纲数，称为 **牛顿数** ，以 :math:`Ne` 表示，则有

.. math::
	\begin{align}
	(Ne)_{p} = (Ne)_{m}
	\end{align}

上式表明两个流动相似时牛顿数应当相等，这称为 **牛顿相似准则** 。

但是，在模型试验中很难做到两个流动相应作用点上各种力都维持同样的比尺，不过在某一具体流动中起主导作用的力往往只有一种，因此在模型试验中只要让这种力满足相似即可。不同单项力相似将可以导出不同的动力相似准则。


雷诺准则
""""""""""""

当粘滞力作用为主时，由牛顿内摩擦定律可得

.. math::
	\begin{align}
	& F = T = \mu A\frac{\mathrm{d} u}{\mathrm{d} y} , \\
	& \lambda_{F} = \lambda_{T} = \frac{T_{p}}{T_{m}} = \frac{\mu_{p} A_{p}\frac{\mathrm{d} u_{p}}{\mathrm{d} y_{p}}}{\mu_{m} A_{m}\frac{\mathrm{d} u_{m}}{\mathrm{d} y_{m}}} = \lambda _{\rho}\lambda_{\nu}\lambda_{l}\lambda_{v}
	\end{align}

其中 :math:`\lambda_{\nu}` 为 **运动粘度比尺** 。于是有

.. math::
	\begin{align}
	\lambda_{I}=\lambda_{F}=\lambda_{T}
	\quad \Rightarrow \quad
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{\rho}\lambda_{\nu}\lambda_{l}\lambda_{v}
	\quad \Rightarrow \quad
	\frac{\lambda_{v}\lambda_{l}}{\lambda_{\nu}} = 1
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{v_{p}l_{p}}{\nu_{p}} = \frac{v_{m}l_{m}}{\nu_{m}}
	\quad \Rightarrow \quad 
	(Re)_{p} = (Re)_{m}  
	\end{align}

其中 :math:`Re=\frac{vd}{\nu}` 为雷诺数。上式表明两个流动的惯性力和粘滞力成比例，则这两个流动相应的雷诺数相等，称为 **雷诺准则** ，或者称为 **粘滞力相似准则** 。


弗劳德准则
""""""""""""""

当重力作用为主时，此时

.. math::
	\begin{align}
	& F = G = mg = \rho l^{3} g \\
	& \lambda_{F} = \lambda_{G} = \lambda_{\rho} \lambda_{l}^{3} \lambda_{g}
	\end{align}

其中 :math:`\lambda_{g}` 为 **重力加速度比尺** 。于是有

.. math::
	\begin{align}
	\lambda_{I} = \lambda_{F} = \lambda_{G}
	\quad \Rightarrow \quad 
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{\rho} \lambda_{l}^{3} \lambda_{g}
	\quad \Rightarrow \quad 
	\frac{\lambda_{v}}{\sqrt{\lambda_{l}\lambda_{g}}} = 1
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{v_{p}}{\sqrt{l_{p}g_{p}}} =  \frac{v_{m}}{\sqrt{l_{m}g_{m}}}
	\quad \Rightarrow \quad 
	(Fr)_{p} = (Fr)_{m}
	\end{align}

其中 :math:`Fr = \frac{v}{\sqrt{lg}}` 是一个无量纲数，称为 **弗劳德数** 。上式表明两个流动的惯性力和重力成比例，则它们的弗劳德数相等，称为 **弗劳德准则** ，或者称为 **重力相似准则** 。


欧拉准则
""""""""""""

如果企图改变原有运动状态的力为流体动压力时，则

.. math::
	\begin{align}
	& F = P = pA \\
	& \lambda_{F} = \lambda_{P} = \lambda_{p}\lambda_{l}^{2}
	\end{align}

其中 :math:`\lambda_{p}` 为压强比尺。于是有

.. math::
	\begin{align}
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{p}\lambda_{l}^{2}
	\quad \Rightarrow \quad 
	\frac{\lambda_{p}}{\lambda_{\rho}\lambda_{v}^{2}} = 1 
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{p_{p}}{\rho_{p}v_{p}^{2}} = \frac{p_{m}}{\rho_{m}v_{m}^{2}}
	\quad \Rightarrow \quad 
	(Eu)_{p} = (Eu)_{m}
	\end{align}

其中 :math:`Eu=\frac{p}{\rho v^{2}}` 为一无量纲量，称为 **欧拉数** 。上式表明两个流动的惯性力和流体动压力成比例，则它们的欧拉数相等，称为 **欧拉准则** ，或称为 **压力相似准则** 。

.. note:: 

	在大多数流动中，对流动起主要作用的是压强差 :math:`\Delta p` 而不是压强的绝对值，欧拉数也因此常用相应点的压强差来代替压强，即 :math:`Eu=\frac{\Delta p}{\rho v^{2}}`



韦伯准则
""""""""""""

当作用力主要为表明张力时，则

.. math::
	\begin{align}
	& F = S = \sigma l \\
	& \lambda_{F} = \lambda_{S} = \lambda_{\sigma}\lambda_{l}
	\end{align}

其中 :math:`\lambda_{\sigma}` 为表面张力比尺。于是有

.. math::
	\begin{align}
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{\sigma}\lambda_{l}
	\quad \Rightarrow \quad 
	\frac{\lambda_{\rho}\lambda_{l}\lambda_{v}^{2}}{\lambda_{\sigma}} = 1 
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{\rho_{p}l_{p}v_{p}^{2}}{\sigma_{p}} = \frac{\rho_{m}l_{m}v_{m}^{2}}{\sigma_{m}}
	\quad \Rightarrow \quad 
	(We)_{p} = (We)_{m}
	\end{align}

其中 :math:`We = \frac{\rho lv^{2}}{\sigma}` 为一无量纲量，称为 **韦伯数** 。上式表明两个流动的惯性力和表明张力成比例，则它们的韦伯数相等，称为 **韦伯准则** ，或者称为 **表面张力相似准则** 。


柯西准则
""""""""""""

对于可压缩流，当作用力主要为弹性力时，则

.. math::
	\begin{align}
	& F = E = Kl^{2} \\
	& \lambda _{F} = \lambda_{E} = \lambda_{K}\lambda_{l}^{2}
	\end{align}

其中 :math:`E` 为弹性力， :math:`K` 为体积弹性模量。于是有

.. math::
	\begin{align}
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{K}\lambda_{l}^{2}
	\quad \Rightarrow \quad 
	\frac{\lambda_{\rho}\lambda_{v}^{2}}{\lambda_{K}} = 1 
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{\rho_{p}v_{p}^{2}}{K_{p}} =  \frac{\rho_{m}v_{m}^{2}}{K_{m}}
	\quad \Rightarrow \quad 
	(Ca)_{p} = (Ca)_{m}
	\end{align}

其中 :math:`Ca=\frac{\rho v^{2}}{K}` 是一个无量纲数，称为 **柯西数** 。上式表明两个流动的惯性力和弹性力成比例，则它们的柯西数相等，称为 **柯西准则** ，或者称为 **弹性力相似准则** 。

对于气体来说，音速 :math:`a=\sqrt{\frac{K}{\rho}}` ，代入柯西准则方程并化简开方则得到

.. math::
	\begin{align}
	\frac{v_{p}}{a_{p}} = \frac{v_{m}}{a_{m}}
	\quad \Rightarrow \quad 
	(M)_{p} = (M)_{m}  
	\end{align}

其中 :math:`M=\frac{v}{a}` 是一个无量纲数，称为 **马赫数** 。上式表明两个流动的惯性力和弹性力成比例，则它们的马赫数也相等，称为 **马赫准则** 。





边界层理论基础及绕流运动
===========================


边界层的基本概念
-------------------

在实际流动中，由于流体具有粘性，紧贴在固体壁面的流体与固体壁面之间将没有相对运动。如果假设固体不动，无论流体运动的雷诺数多大，固体壁面上流体的速度也应该为零，而固体壁面附近沿法线方向流速迅速增大，存在较大的流速梯度，而且雷诺数越大，避免附近的流速梯度越大，存在有流速梯度的流体层越薄。因此在固壁附近的流层中，粘性力不能忽略，流体同时受到粘性力和惯性力作用。把固壁存在较大流速梯度的流动薄层称为 **边界层** 。

普朗特提出了边界层理论的假定，将高雷诺数流动分成了两个不同的流动区域：

1. 在固壁附近边界层以内的流动，粘性力和惯性力同阶，必须考虑粘性的作用，为有旋运动。
2. 边界层以外的流动，可以忽略粘性作用而近似按照理想流体处理。
   
一般约定在纵向的流速与层外流速 :math:`u_{0}` 相差 :math:`1\%` 的地方，即 :math:`u_{x}=0.99u_{0}` 处作为边界层的边缘。由边界层外缘到物面的垂直距离定义为边界层的名义厚度，简称为 **边界层厚度** :math:`\delta` 。边界层的厚度一般较物体的特征长度要小很多，即 :math:`\frac{\delta}{L}\ll 1` 。

边界层内流动是粘性流动，同样也存在两种流动形态，也即边界层有 **层流边界层** 和 **湍流边界层** 的区别。对于平板绕流，从平板前缘起自层流开始，随 :math:`x` 的增加，边界层厚度逐渐增加，壁面对流体扰动的稳定作用逐渐减弱，直到发生流态转捩的边界层内形成湍流。

.. note:: 影响边界层从层流边界层发展成为湍流边界层的因素很多而且很复杂，所以层流与湍流的转捩不是在某个断面突然发生的，而是在一个过渡区内完成的。

转捩点主要依靠实验来确定，对于平板边界层，定义边界层内的雷诺数为

.. math::
	\begin{align}
	Re_{x} = \frac{U_{0}x}{\nu} 
	\end{align}

由层流边界层转变为湍流边界层的点 :math:`x=x_{c}` 称为 **转捩点** ，则转捩临界雷诺数为 :math:`Re_{c} = \frac{U_{0}x_{c}}{\nu}` 。对于光滑平板来讲， :math:`Re_{c}` 的范围为 :math:`3\times10^{5} \sim 3\times10^{6}` 。影响临界雷诺数的主要因素是固体边界的粗糙情况、来流的湍流强度以及边界层外流动的压强分布。目前确定临界雷诺数的数值主要依靠实验，一般取 :math:`Re_{c}=5\times10^{5}` 。

.. note:: 在湍流边界层内，最靠近平板的地方 :math:`\frac{\mathrm{d}u_{x}}{\mathrm{d}y}` 很大，粘滞切应力仍起主要作用，使得流动形态仍然是层流，所以在湍流边界层中，紧贴平板边界也有一层极薄的粘性底层。


在解决实际问题时，不仅需要定义边界层名义厚度，还需要定义一些能够表示明确物理意义的厚度，并由此说明边界层的基本特性：


**边界层位移厚度** :math:`\delta_{1}` ，也称边界层流量排挤厚度，是指由于边界层的存在，使外部流动按理想流体处理时其流动的虚拟边界向壁面以外移动的距离。

单位时间内通过边界层某一断面的流体若为理想流体，其质量流量应为 :math:`\int_{0}^{\delta}\rho u_{0}~\mathrm{d}y` ，其中 :math:`u_{0}` 为该断面边界层外边缘流动的速度。而对于实际粘性流体，边界层内实际通过的流体质量为 :math:`\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` ，两个流量的差即为由于流体粘性而减少的流量，这部分流量将从边界层内排挤到层外，相当于在边界层外流动中增加了一层速度为 :math:`u_{0}` 而厚度为 :math:`\delta_{1}` 的流体，可以表示为

.. math::
	\begin{align}
	\rho u_{0}\delta_{1} = \int_{0}^{\delta}\rho u_{0}~\mathrm{d}y - \int_{0}^{\delta}\rho u_{x}~\mathrm{d}y
	\quad \Rightarrow \quad
	\delta_{1} = \int_{0}^{\delta}\Big( 1 - \frac{u_{x}}{u_{0}} \Big)\mathrm{d}y
	\end{align}



**边界层动量损失厚度** :math:`\delta_{2}` 是指由于边界层的存在，边界层内损失的动量折合成按理想流体处理时具有相同动量的等效厚度。

单位时间内通过边界层某一断面的流体质量流量为 :math:`\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` ，实际具有的动量为 :math:`\int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y` 。如果是理想流体，则应该具有的动量为 :math:`u_{0}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` 。两个动量的差即为由于流体粘性而产生的动量损失，这部分动量损失相当于以流速 :math:`u_{0}` 通过厚度为 :math:`\delta_{2}` 的理想流体所具有的动量，即

.. math::
	\begin{align}
	\rho u_{0}^{2}\delta_{2} = u_{0}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y - \int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y
	\quad \Rightarrow \quad
	\delta_{2} = \int_{0}^{\delta}\frac{u_{x}}{u_{0}}\Big( 1-\frac{u_{x}}{u_{0}} \Big)\mathrm{d}y 
	\end{align}


边界层内位移厚度与动量损失厚度的比值，为 **边界层形状系数** ，以 :math:`H` 表示，即

.. math::
	\begin{align}
	H = \frac{\delta_{1}}{\delta_{2}} 
	\end{align}


**边界层能量损失厚度** 是指由于边界层的存在，边界层内所损失的能量折合成按理想流体处理时具有相同能量的等效厚度。

单位时间内通过边界层某一断面的流体质量流量为 :math:`\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` ，实际具有的动能为 :math:`\int_{0}^{\delta}\rho u_{x}\cdot u_{x}^{2}~\mathrm{d}y` 。如果是理想流体，则应该具有的动能为 :math:`u_{0}^{2}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` 。两个动能的差即为由于流体粘性而产生的动能损失，这部分动能损失相当于以流速 :math:`u_{0}` 通过厚度为 :math:`\delta_{3}` 的理想流体所具有的动能，即

.. math::
	\begin{align}
	\rho u_{0}\delta_{3} \cdot u_{0}^{2} = u_{0}^{2}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y - \int_{0}^{\delta}\rho u_{x}\cdot u_{x}^{2}~\mathrm{d}y
	\quad \Rightarrow \quad
	\delta_{3} = \int_{0}^{\delta}\frac{u_{x}}{u_{0}}\Big( 1-\frac{u_{x}^{2}}{u_{0}^{2}} \Big)~\mathrm{d}y 
	\end{align}



边界层微分方程
-----------------

对于二维恒定流动，例如在无限空间中水平放置的平板，可以不考虑质量力作用，则动量方程和连续性方程写为

.. math::
	\begin{align}
	& u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{x}}{\partial y} = -\frac{1}{\rho}\frac{\partial p}{\partial x} + \nu\Big( \frac{\partial^{2}u_{x}}{\partial x^{2}}+\frac{\partial^{2}u_{x}}{\partial y^{2}} \Big) \\
	& u_{x}\frac{\partial u_{y}}{\partial x} + u_{y}\frac{\partial u_{y}}{\partial y} = -\frac{1}{\rho}\frac{\partial p}{\partial y} + \nu\Big( \frac{\partial^{2}u_{y}}{\partial x^{2}}+\frac{\partial^{2}u_{y}}{\partial y^{2}} \Big) \\
	& \frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} = 0  
	\end{align}

对上述方程的各项进行数量级分析。首先将各项无量纲化，长度均除以 :math:`x` 方向的特征长度 :math:`L` ，流速均除以未扰动的来流流速 :math:`U_{0}` ，得到下列无量纲量：

.. math::
	\begin{align}
	x^{0}=\frac{x}{L}, \quad 
	y^{0}=\frac{y}{L}, \quad 
	u_{x}^{0}=\frac{u_{x}}{U_{0}}, \quad 
	u_{y}^{0}=\frac{u_{y}}{U_{0}}, \quad 
	p^{0}=\frac{p}{\rho U_{0}^{2}}     
	\end{align}

同时认为 :math:`\rho=\text{const},\mu=\text{const},g=\text{const}` ，将上面无量纲量代入动量方程和连续性方程各项。对于x方向的各项则有：

.. math::
	\begin{align}
	& u_{x}\frac{\partial u_{x}}{\partial x} 
	= U_{0}\Big(\frac{u_{x}}{U_{0}}\Big)\frac{\partial \Big(\cfrac{u_{x}}{U_{0}}\Big)U_{0}}{\partial \Big(\cfrac{x}{L}\Big)L}
	= \frac{U_{0}^{2}}{L} u_{x}^{0}\frac{\partial u_{x}^{0}}{\partial x^{0}} 
	\\
	& u_{y}\frac{\partial u_{x}}{\partial y} 
	= U_{0}\Big(\frac{u_{y}}{U_{0}}\Big)\frac{\partial \Big(\cfrac{u_{x}}{U_{0}}\Big)U_{0}}{\partial \Big(\cfrac{y}{L}\Big)L}
	= \frac{U_{0}^{2}}{L} u_{y}^{0}\frac{\partial u_{x}^{0}}{\partial y^{0}}
	\\
	& \frac{1}{\rho}\frac{\partial p}{\partial x} 
	= \frac{1}{\rho}\frac{\partial \Big(\cfrac{p}{\rho U_{0}^{2}}\Big) \rho U_{0}^{2}}{\partial \Big(\cfrac{x}{L}\Big)L} 
	= \frac{U_{0}^{2}}{L}\frac{\partial p^{0}}{\partial x^{0}}
	\\
	& \nu\frac{\partial ^{2}u_{x}}{\partial x^{2}}
	= \frac{\mu}{\rho}\frac{\partial ^{2}\Big(\cfrac{u_{x}}{U_{0}}\Big)U_{0}}{\partial \Big(\cfrac{x}{L}\Big)^{2}L^{2}}
	= \frac{\mu}{\rho}\frac{U_{0}}{L^{2}}\frac{\partial ^{2}u_{x}^{0}}{\partial x^{0^{2}}}
	\\
	& \nu\frac{\partial ^{2}u_{x}}{\partial y^{2}}
	= \frac{\mu}{\rho}\frac{\partial ^{2}\Big(\cfrac{u_{x}}{U_{0}}\Big)U_{0}}{\partial \Big(\cfrac{y}{L}\Big)^{2}L^{2}}
	= \frac{\mu}{\rho}\frac{U_{0}}{L^{2}}\frac{\partial ^{2}u_{x}^{0}}{\partial y^{0^{2}}}
	\end{align}


代入动量方程中并两边同时除以 :math:`\frac{U_{0}^{2}}{L}` 则得到

.. math::
	\begin{align}
	u_{x}^{0}\frac{\partial u_{x}^{0}}{\partial x^{0}}
	+ u_{y}^{0}\frac{\partial u_{x}^{0}}{\partial y^{0}}
	= -\frac{\partial p^{0}}{\partial x^{0}} 
	+ \frac{\nu}{U_{0}L}\Big(\frac{\partial ^{2}u_{x}^{0}}{\partial x^{0^{2}}} + \frac{\partial ^{2}u_{x}^{0}}{\partial y^{0^{2}}}\Big)
	\end{align}

其中 :math:`\frac{\nu}{U_{0}L}=\frac{1}{Re}` 。用同样的方法，可以将y方向动量方程和连续性方程也进行无量纲化，得到

.. math::
	\begin{align}
	& u_{x}^{0}\frac{\partial u_{x}^{0}}{\partial x^{0}}
	+ u_{y}^{0}\frac{\partial u_{x}^{0}}{\partial y^{0}}
	= -\frac{\partial p^{0}}{\partial x^{0}}
	+ \frac{1}{Re} \Big(\frac{\partial ^{2}u_{x}^{0}}{\partial x^{0^{2}}} + \frac{\partial ^{2}u_{x}^{0}}{\partial y^{0^{2}}}\Big)
	\\
	& u_{x}^{0}\frac{\partial u_{y}^{0}}{\partial x^{0}}
	+ u_{y}^{0}\frac{\partial u_{y}^{0}}{\partial y^{0}}
	= -\frac{\partial p^{0}}{\partial y^{0}}
	+ \frac{1}{Re} \Big(\frac{\partial ^{2}u_{y}^{0}}{\partial x^{0^{2}}} + \frac{\partial ^{2}u_{y}^{0}}{\partial y^{0^{2}}}\Big)
	\\
	& \frac{\partial u_{x}^{0}}{\partial x^{0}} + \frac{\partial u_{y}^{0}}{\partial y^{0}} = 0 
	\end{align}


由于限于研究边界层内的流动，定义无量纲的边界层厚度 :math:`\delta^{0}=\delta/L \ll 1` ，于是可以建立用它进行衡量的量级分析：

.. math::
	\begin{align}
	x^{0}=\frac{x}{L} \sim O(1), \quad 
	y^{0}=\frac{y}{L} \sim O(\delta^{0}), \quad 
	u_{x}^{0}=\frac{u_{x}}{U_{0}} \sim O(1), \quad 
	\frac{\partial u_{x}^{0}}{\partial x^{0}} \sim O(1), \quad 
	\frac{\partial u_{x}^{0}}{\partial y^{0}} \sim O\Big(\frac{1}{\delta^{0}}\Big)    
	\end{align}

结合无量纲的连续性方程 :math:`\frac{\partial u_{x}^{0}}{\partial x^{0}} + \frac{\partial u_{y}^{0}}{\partial y^{0}} = 0` 可以进一步得到

.. math::
	\begin{align}
	\frac{\partial u_{y}^{0}}{\partial y^{0}} \sim O(1), \quad 
	u_{y}^{0} \sim O(\delta^{0}), \quad 
	\frac{\partial^{2} u_{x}^{0}}{\partial x^{0^{2}}} \sim O(1), \quad 
	\frac{\partial^{2} u_{x}^{0}}{\partial y^{0^{2}}} \sim O\Big(\frac{1}{\delta^{0^{2}}} \Big)
	\end{align}

在边界层中假定动量方程的惯性项与粘性项具有同一量级。在粘性项中，如果是平板或曲率很小的曲面，由于沿流动方向的速度变化率很小，所以有 :math:`\frac{\partial^{2}u_{x}}{\partial x^{2}}\ll \frac{\partial ^{2}u_{x}}{\partial y^{2}}` ，可以忽略 :math:`\frac{\partial^{2}u_{x}}{\partial x^{2}}` 项，并且忽略 :math:`\frac{\partial p}{\partial x}` 的量级影响，于是按照量纲分析得到

.. math::
	\begin{align}
	\frac{u^{2}}{L}\propto \nu\frac{u}{\delta^{2}}
	\quad \Rightarrow \quad 
	\frac{u}{L\nu}\propto \frac{1}{\delta^{2}}
	\quad \Rightarrow \quad 
	\frac{Lu}{\nu}\propto \frac{1}{\delta^{2}/L^{2}}=\frac{1}{\delta^{0^{2}}}
	\quad \Rightarrow \quad 
	Re \sim O(\frac{1}{\delta^{0^{2}}})
	\end{align}

针对无量纲的动量方程和连续性方程，把所有量级小于1的项忽略不计，于是得到

.. math::
	\begin{align}
	& u_{x}^{0}\frac{\partial u_{x}^{0}}{\partial x^{0}} + u_{y}^{0}\frac{\partial u_{x}^{0}}{\partial y^{0}} = -\frac{\partial p^{0}}{\partial x^{0}} + \frac{1}{Re}\frac{\partial ^{2}u_{x}^{0}}{\partial y^{0^{2}}} \\
	& \frac{\partial u_{x}^{0}}{\partial x^{0}} + \frac{\partial u_{y}^{0}}{\partial y^{0}} = 0 
	\end{align}

将上式恢复成有量纲的物理量，即可得到边界微分方程，也称为 **普朗特边界层方程** ：

.. math::
	\begin{align}
	& u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{x}}{\partial y} = -\frac{1}{\rho}\frac{\partial p}{\partial x} + \frac{\mu}{\rho}\frac{\partial ^{2}u_{x}}{\partial y^{2}} \\
	& \frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} = 0      
	\end{align}

其边界条件为(1) :math:`y=0,u_{x}=0,u_{y}=0` ；(2) :math:`y=\infty,u_{x}=u_{0}` 。也可以近似写为 :math:`y=\delta,u_{x}=u_{0}` 。 :math:`u_{0}` 为边界层外边界上的势流流速。


.. note:: 由 :math:`\frac{\partial p}{\partial y}\to 0` 可知，沿着固体边界的外法线，边界层内的压强基本上不变，它等于边界层外边界上的压强。


.. note:: 
	
	如果边界层内的流动为湍流时，普朗特边界层方程的第一条式子应该改写成

	.. math::
		\begin{align}
		u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{x}}{\partial y} = -\frac{1}{\rho}\frac{\partial p}{\partial x} + \frac{1}{\rho}\frac{\partial }{\partial y}\Big( \mu\frac{\partial u_{x}}{\partial y} - \rho\overline{u_{x}'u_{y}'}\Big)  
		\end{align}


.. note:: 上述内容不仅适用于平板边界层，对于具有曲率的边界，只要曲率较为平缓，没有突然的变化， :math:`x` 坐标沿着曲面边界， :math:`y` 坐标沿曲面外法线方向，则上述方程式和论述也是适用的。




边界层的动量积分方程
-----------------------

假定流体绕一物体的曲面流动，在物体边界附近产生一层很薄的边界层。沿曲面取为 :math:`x` 轴，沿物体表面法线方向取为 :math:`y` 轴。在物体表面取一个单位宽度边界层的微段 :math:`ABCD` ，如图所示， :math:`BD` 长为 :math:`\mathrm{d}x` ， :math:`AC` 为边界层外边界， :math:`AB` 、 :math:`CD` 垂直于物体表面。为了使问题简化，假设：

1. 因为边界层很薄，质量力可以忽略不计；
2. 流动为恒定平面流动；
3. 由于 :math:`\mathrm{d}x` 极小， :math:`BD` 和 :math:`AC` 均可以视为直线。
   
:math:`AB,CD,AC` 面的单位时间质量通量分别为

.. math::
	\begin{align}
	& \phi_{m_{AB}} = \int_{0}^{\delta}\rho u_{x}~\mathrm{d}y \\
	& \phi_{m_{CD}} = \phi_{m_{AB}} + \frac{\partial \phi_{m_{AB}}}{\partial x}\mathrm{d}x = \int_{0}^{\delta}\rho u_{x}~\mathrm{d}y + \frac{\partial }{\partial x}\Big(\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y \Big)\mathrm{d}x \\
	& \phi_{m_{AC}} = \phi_{m_{CD}} - \phi_{m_{AB}} = \frac{\partial }{\partial x}\Big(\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y \Big)\mathrm{d}x 
	\end{align}

:math:`AB,CD,AC` 面的单位时间动量通量分别为

.. math::
	\begin{align}
	& \phi_{AB} = \int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y \\
	& \phi_{CD} = \phi_{AB} + \frac{\partial \phi_{AB}}{\partial x}\mathrm{d}x = \int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y + \frac{\partial }{\partial x}\Big(\int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y \Big)\mathrm{d}x \\
	& \phi_{AC} = \phi_{m_{AC}} \cdot u_{0} = u_{0}\frac{\partial }{\partial x}\Big(\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y \Big)\mathrm{d}x
	\end{align}


.. attention:: 其中 :math:`u_{0}` 为边界层外边界上的流速在 :math:`x` 轴上的分量，并认为在 :math:`AC` 面上各点都相等。


对于微段 :math:`ABCD` 上的受力，因为忽略了质量力所以只有表面力。由于边界层内 :math:`\frac{\partial p}{\partial y}=0` ，因而 :math:`AB` 面和 :math:`CD` 面上压强是均匀分布的。设 :math:`AB` 面上的压强为 :math:`p` ，则由泰勒级数展开得到作用在 :math:`CD` 面上的压强为 :math:`p+\frac{\partial p}{\partial x}\mathrm{d}x` 。作用在 :math:`AC` 面上的压强一般是不均匀的，则可以根据A点和C点压强取其平均值 :math:`p + \frac{1}{2}\frac{\partial p}{\partial x}\mathrm{d}x` 。关于摩擦阻力，设固体表面对流体作用的切应力为 :math:`\tau_{0}` ，而由于边界层外可以当作理想流体，所以在边界层外边界 :math:`AC` 面上没有切应力。如此，各表面力在 :math:`x` 轴方向的分量之和为

.. math::
	\begin{align}
	\sum F_{x} = p\delta - \Big(p + \frac{\partial p}{\partial x}\mathrm{d}x \Big)(\delta + \mathrm{d}\delta ) + \Big(p + \frac{1}{2}\frac{\partial p}{\partial x}\mathrm{d}x \Big)\mathrm{d}s \cdot \sin\theta - \tau_{0}\mathrm{d}x 
	\end{align}

同时考虑到 :math:`\mathrm{d}s \cdot \sin\theta = \mathrm{d}\delta` ，并忽略高阶微量，且依据 :math:`\frac{\partial p}{\partial y}=0` 可知 :math:`p` 与 :math:`y` 无关，可以用全微分代替偏微分，则上式最终化简为

.. math::
	\begin{align}
	\sum F_{x} = -\frac{\mathrm{d} p}{\mathrm{d} x}\mathrm{d}x \cdot \delta - \tau_{0}\mathrm{d}x   
	\end{align}

根据动量方程可以得到

.. math::
	\begin{align}
	\phi_{CD} - \phi_{AB} - \phi_{AC} = \sum F_{x}
	\end{align}

代入各项也即得到 **边界层动量积分方程** ，也称卡门动量积分方程：

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y - u_{0}\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y = -\delta\frac{\mathrm{d}p}{\mathrm{d}x} - \tau_{0}    
	\end{align}


.. note:: 上式适用于层流边界层和湍流边界层，只是不同的流态要采用不同的 :math:`\tau_{0}` 计算式。


.. note:: 

	对于上式，当 :math:`\rho` 为常数时，仍有 :math:`\delta,p,u_{0},u_{x},\tau_{0}` 五个未知数，其中 :math:`u_{0}` 可以通过势流理论求得， :math:`p` 可以按伯努利方程求得，还剩下三个未知数。因此，要解边界层动量积分方程还需要两个补充方程，即

	1. 边界层内流速分布关系式 :math:`u_{x}=f_{1}(y)` ；
	2. 切应力 :math:`\tau_{0}` 与边界层厚度 :math:`\delta` 的关系式 :math:`\tau_{0}=f_{2}(\delta)` 。
	   
	而 :math:`\tau_{0}=f_{2}(\delta)` 可以根据边界层内流速分布的关系式得到，所以通常在解边界层动量方程时，先假定流速分布 :math:`u_{x}=f_{1}(y)` ，这个假定越接近实际则所得结果越正确。




平板边界层的近似计算
----------------------

设有一极薄的静止光滑平板顺流放置于二维恒定均匀流场中，如图所示。以平板上游端为坐标原点，取平面表面为 :math:`x` 轴，来流流速为 :math:`U_{0}` 且平行于 :math:`x` 轴，平板长度为 :math:`L` 。依据平板末端的雷诺数 :math:`Re_{L}=\frac{LU_{0}}{\nu}` 与临界雷诺数 :math:`Re_{c}` 对比，可以将光滑平板边界层的计算分为三种情况：

1. 当 :math:`Re_{L}<Re_{c}` ，即 :math:`L<x_{c}` 时，整个平板边界层内流动状态为层流，这种边界层为层流边界层；
2. 当 :math:`Re_{L}>Re_{c}` ，即 :math:`L>x_{c}` 时，在平板前端仍保持为层流，在转捩点 :math:`x_{c}` 以后为湍流，在层流和湍流之间还有一个过渡段。这种边界层称为混合边界层；
3. 当 :math:`Re_{L}\gg Re_{c}` ，即 :math:`L\gg x_{c}` 时， :math:`x_{c}` 的数值相对于 :math:`L` 变得很小，即混合边界层中层流部分退所谓平板前端很小一部分，对整个边界层的计算作用很小。这时可以假设整个边界层都是湍流状态，称为湍流边界层。
   
当流体以均匀速度 :math:`U_{0}` 沿平板方向作恒定流动时，由于平板很薄，边界层外部流动不受平板的影响，因此边界层外边界的边界条件是：

1. 外边界上的流速 :math:`u_{0}` 处处相等，且等于来流速度，即 :math:`u_{0}=U_{0}` ， :math:`\frac{\mathrm{d}u_{0}}{\mathrm{d}x}=0` ；
2. 边界层外按理想流体处理，由于流速不变，所以边界层外边界上的压强也处处相等，即 :math:`\frac{\mathrm{d}p}{\mathrm{d}x}=0` 。
   



平板上层流边界层的计算
^^^^^^^^^^^^^^^^^^^^^^^^^

平板上层流边界层第一个补充方程为边界层内的流速分布关系式 :math:`u_{x}=f_{1}(y)` 。假定层流边界层内的流速分布与圆管流中的层流流速分布相同，即

.. math::
	\begin{align}
	u = u_{m}\Big(1-\frac{r^{2}}{r_{0}^{2}}\Big)
	\end{align}

将上式应用于平板上的边界层时，管流中的 :math:`r_{0}` 对应于边界层中的 :math:`\delta` ， :math:`r` 对应为 :math:`(\delta - y)` ， :math:`u_{m}` 对应为 :math:`U_{0}` ， :math:`u` 对应为 :math:`u_{x}` ，如此上式就可以改写为

.. math::
	\begin{align}
	u_{x} = U_{0}\Big[ 1 - \frac{(\delta - y)^{2}}{\delta^{2}} \Big] = \frac{2U_{0}}{\delta}\Big(y - \frac{y^{2}}{2\delta} \Big) 
	\end{align}

第二个补充方程为平板上切应力与边界层厚度的关系式 :math:`\tau_{0}=f_{2}(\delta)` 。由于层流符合牛顿内摩擦定律，所以求平板上的切应力只要将上式代入牛顿内摩擦定律并取 :math:`y=0` 即可得到

.. math::
	\begin{align}
	\tau_{0} = -\mu\frac{\mathrm{d}u_{x}}{\mathrm{d}y}\bigg|_{y=0} = -\mu\frac{\mathrm{d}}{\mathrm{d}y}\Big[\frac{2U_{0}}{\delta} \Big(y-\frac{y^{2}}{2\delta} \Big)\Big] \bigg|_{y=0}
	\end{align}

上式中的负号表示切应力和 :math:`x` 轴方向相反。现在去掉负号，取绝对值并整理化简得到

.. math::
	\begin{align}
	\tau_{0} = \mu\frac{2U_{0}}{\delta}
	\end{align}


将以上所得的两个补充方程代入到边界层的动量积分方程，得到

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}\Big[\frac{2U_{0}}{\delta}\Big(y-\frac{y^{2}}{2\delta} \Big)\Big]^{2}\mathrm{d}y
	- U_{0}\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}\frac{2U_{0}}{\delta}\Big(y-\frac{y^{2}}{2\delta} \Big)\mathrm{d}y
	= - \frac{2\mu U_{0}}{\rho \delta}  
	\end{align}

化简上式得到

.. math::
	\begin{align}
	\frac{1}{15}U_{0} \frac{\mathrm{d}\delta}{\mathrm{d}x} = \frac{\mu}{\rho \delta}  
	\end{align}

积分得到

.. math::
	\begin{align}
	\frac{1}{15}\frac{U_{0}}{\mu}\frac{\rho\delta^{2}}{2} = x+C   
	\end{align}

积分常数 :math:`C` 由边界条件确定。当 :math:`x=0,\delta=0` 得到 :math:`C=0` ，又 :math:`\nu=\frac{\mu}{\rho}` ，上式即可化简得到 **平板上层流边界层厚度沿x轴方向的变化规律** ：

.. math::
	\begin{align}
	\delta = 5.477\sqrt{\frac{\nu x}{U_{0}}} 
	\end{align}

将上式代入到切应力补充方程，化简后可以得到 **平板上层流边界层切应力沿x方向的变化规律** ：

.. math::
	\begin{align}
	\tau_{0} = 0.365\sqrt{\frac{\mu\rho U_{0}^{3}}{x}} 
	\end{align}

作用在平板上一面的摩擦阻力 :math:`F_{f}` 为

.. math::
	\begin{align}
	F_{f} = \int_{0}^{L}\tau_{0}b~\mathrm{d}x = \int_{0}^{L}0.365\sqrt{\frac{\mu\rho U_{0}^{3}}{x}}~\mathrm{d}x = 0.73b\sqrt{\mu \rho U_{0}^{3}L}
	\end{align}

其中 :math:`b` 为平板宽度， :math:`L` 为平板的长度。

.. note:: 如果要求流体对平板两面的总摩擦阻力时，只需要将上式乘以2即可。

通常将绕流摩擦阻力的计算式写成单位体积来流的动能 :math:`\rho U_{0}^{2}/2` 与某一面积的乘积，在乘以摩阻系数的形式，即

.. math::
	\begin{align}
	F_{f} = C_{f}\frac{\rho U_{0}^{2}}{2}A_{f} 
	\end{align}

其中 :math:`C_{f}` 为无量纲摩阻系数， :math:`\rho` 为流体密度， :math:`U_{0}` 为流体来流速度， :math:`A_{f}` 通常指切应力作用的面积或某一有代表性的投影面面积，这里指平板面积，即 :math:`A_{f}=bL` 。通过对比系数可以得到

.. math::
	\begin{align}
	C_{f} = 1.46\sqrt{\frac{\mu}{\rho U_{0}L}} = 1.46\sqrt{\frac{\nu}{U_{0}L}} = \frac{1.46}{\sqrt{Re_{L}} }   
	\end{align}

其中 :math:`Re_{L}=\frac{U_{0}L}{\nu}` 为以板长 :math:`L` 为特征长度的雷诺数。



.. note:: 

	有布拉修斯从普朗特边界层方程求得的，并与实验结果吻合较好的解为

	.. math::
		\begin{align}
		& \delta = 5\sqrt{\frac{\nu x}{U_{0}} } \\
		& F_{f} = 0.664b\sqrt{\mu \rho U_{0}^{3}L} \\
		& C_{f} = \frac{1.328}{\sqrt{Re_{L}}}   
		\end{align}

	上面三个式子适用于 :math:`Re_{L}<3\times10^{5} \sim 10^{6}` 的情况。


平板上湍流边界层的计算
^^^^^^^^^^^^^^^^^^^^^^^^^

由于脉动而产生的附加切应力在湍流边界层内如何计算尚不清楚，补充方程目前还不能从理论上推导出来，不过，普朗特假设沿平板边界层内的湍流运动与管内湍流运动没有显著的差别，因此第一个补充方程可以借用圆管湍流光滑区的速度分布指数公式

.. math::
	\begin{align}
	u = u_{m}\Big(\frac{y}{r_{0}}\Big)^{1/7}
	\end{align}

将上式应用于平板上边界层时，管流中的 :math:`r_{0}` 对应于边界层中的 :math:`\delta` ， :math:`u_{m}` 对应于 :math:`U_{0}` ， :math:`u` 对应于 :math:`u_{x}` ，上式可以写为

.. math::
	\begin{align}
	u_{x} = U_{0}\Big(\frac{y}{\delta}\Big)^{1/7}
	\end{align}

为了寻找第二个补充方程 :math:`\tau_{0}=f_{2}(\delta)` ，先根据管流中切应力公式 :math:`\tau_{0}=\frac{\lambda}{8}\rho v^{2}` 和计算湍流光滑区 :math:`\lambda` 值的布拉修斯公式 :math:`\lambda=\frac{0.3164}{Re^{1/4}}` ，求得光滑区切应力公式为

.. math::
	\begin{align}
	\tau_{0} = \frac{\lambda }{8}\rho v^{2} = \frac{\rho v^{2}}{8}\frac{0.3164}{Re^{1/4}} = 0.0332\rho v^{7/4}\Big(\frac{\nu}{r_{0}} \Big)^{1/4}
	\end{align}

其中的 :math:`v` 为圆管内的平均流速。为了用于平板边界层，还需要将上式用来流速度 :math:`U_{0}` 表示，也就需要继续推导管流中的平均流速与最大流速的关系式，即

.. math::
	\begin{align}
	v = \frac{Q}{A} = \frac{\int_{0}^{r_{0}}u~\mathrm{d}A}{\pi r_{0}^{2}} = \frac{\int_{0}^{r_{0}}u_{m}(\frac{y}{r_{0}})^{1/7}\cdot 2\pi r~\mathrm{d}r}{\pi r_{0}^{2}}  
	\end{align}

因为 :math:`r=r_{0}-y` ， :math:`\mathrm{d}r=-\mathrm{dy}` ，代入上式积分后得到

.. math::
	\begin{align}
	v = 0.817u_{m}
	\end{align}

将上式代入光滑区切应力公式，且管流中的 :math:`u_{m}` 对应为 :math:`U_{0}` ， :math:`r_{0}` 对应为 :math:`\delta` ，则得到平板上切应力与边界层厚度的关系式为

.. math::
	\begin{align}
	\tau_{0} = 0.0233\rho U_{0}^{2}\Big(\frac{\nu}{\delta U_{0}}\Big)^{1/4}
	\end{align}

接下来，首先将速度分布补充方程代入边界层动量积分方程，得到

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}U_{0}^{2}\Big(\frac{y}{\delta}\Big)^{2/7}\mathrm{d}y - U_{0}\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}U_{0}\Big(\frac{y}{\delta}\Big)^{1/7}\mathrm{d}y = -\frac{\tau_{0}}{\rho}  
	\end{align}

积分并移项后得到

.. math::
	\begin{align}
	\frac{7}{72}\rho U_{0}^{2}\mathrm{d}\delta = \tau_{0}\mathrm{d}x  
	\end{align}

再将切应力分布补充方程代入上式，得到

.. math::
	\begin{align}
	\frac{7}{72}\rho U_{0}^{2}\mathrm{d}\delta = 0.0233\rho U_{0}^{2}\Big(\frac{\nu}{\delta U_{0}}\Big)^{1/4}\mathrm{d}x
	\end{align}

积分并移项后得到

.. math::
	\begin{align}
	(\frac{7}{72})(\frac{4}{5})\delta^{5/4} = 0.0233\Big(\frac{\nu}{U_{0}}\Big)^{1/4}x + C
	\end{align}

其中 :math:`C` 为积分常数。根据边界条件 :math:`x=0,\delta=0` 代入上式可以得到 :math:`C=0` ，即可得到 **光滑平板上湍流边界层厚度沿x方向的变化规律** ：

.. math::
	\begin{align}
	(\frac{7}{72})(\frac{4}{5})\delta^{5/4} = 0.0233\Big(\frac{\nu}{U_{0}}\Big)^{1/4}x
	\quad \Rightarrow \quad 
	\delta = 0.381\Big(\frac{\nu}{U_{0}x} \Big)^{1/5}x = 0.381\frac{x}{Re_{x}^{1/5}} 
	\end{align}

将上式带入切应力与边界层厚度的关系式，得到 **光滑平板上湍流边界层切应力沿x方向的变化规律** ：

.. math::
	\begin{align}
	\tau_{0} = 0.0296\rho U_{0}^{2}\Big(\frac{\nu}{U_{0}x}\Big)^{1/5}
	\end{align}

作用在平板上一面的摩擦阻力 :math:`F_{f}` 为

.. math::
	\begin{align}
	F_{f} = \int_{0}^{L}\tau_{0}b~\mathrm{d}x = 0.037\rho U_{0}^{2}bL\Big(\frac{\nu}{U_{0}L}\Big)^{1/5}
	\end{align}

.. note:: 如果要求平板两面的总摩擦阻力，只需要将上式乘以2即可得到。

将上式与标准形式 :math:`F_{f}=C_{f}\frac{\rho U_{0}^{2}}{2}A_{f}` 对比系数可以得到摩阻系数为

.. math::
	\begin{align}
	C_{f} = 0.074\Big(\frac{\nu}{U_{0}L}\Big)^{1/5} = \frac{0.074}{Re_{L}^{1/5}}
	\end{align}


.. attention:: 以上各式适用于 :math:`Re=3\times10^{5} \sim 10^{7}` 。当 :math:`Re > 10^{7}` 时，流速分布的七分之一次方定律已经不适用，这时应该按对数分布规律进行计算。

.. note:: 

	实验表明，光滑平板上湍流边界层的流速分布与管流的对数流速分布稍有不同，应该为

	.. math::
		\begin{align}
		u = v_{*}\Big(5.85\lg\frac{yv_{0}}{\nu} + 5.56 \Big)
		\end{align}

	由此计算得到的摩阻系数为

	.. math::
		\begin{align}
		C_{f} = \frac{0.455}{(\lg Re_{L})^{2.58}} 
		\end{align}

	上式适用范围可以达到 :math:`Re_{L} = 10^{9}` 。



平板上混合边界层的计算
^^^^^^^^^^^^^^^^^^^^^^^^^

由于混合边界层内流动情况非常复杂，在计算混合边界层时作了两个假定：

1. 在大雷诺数情况下，层流边界层转变为湍流边界层是在 :math:`x_{c}` 处突然发生的，没有过渡段；
2. 混合边界层的湍流边界层可以看作是从平板的首端开始的湍流边界层的一部分。
   
根据以上两个假定，普朗特建议，可以认为整个光滑平板上混合边界层的摩擦阻力，由转捩点前层流边界层的摩擦阻力和转捩点后湍流边界层的摩擦阻力两部分组成，即

.. math::
	\begin{align}
	C_{fm}\frac{\rho U_{0}^{2}}{2}bL = C_{fl} \frac{\rho U_{0}^{2}}{2} bx_{c} + C_{ft}\frac{\rho U_{0}^{2}}{2}b (L -x_{c})
	\end{align}

其中 :math:`C_{fm},C_{fl},C_{ft}` 分别为混合边界层、层流边界层、湍流边界层的摩阻系数， :math:`x_{c}` 为转捩点到平板前端的距离。由上式可以得到

.. math::
	\begin{align}
	C_{fm} = C_{ft} - (C_{ft} - C_{fl})\frac{x_{c}}{L} = C_{ft} - (C_{ft} - C_{fl})\frac{Re_{c}}{Re_{L}}
	\end{align}

当 :math:`3\times10^{5} \le Re_{L} \le 10^{7}` 时，将层流边界层、湍流边界层的摩阻系数表达式代入上式，得到 **平板混合边界层的摩阻系数** ：

.. math::
	\begin{align}
	C_{fm} = \frac{0.074}{Re_{L}^{1/5}} - \Big(\frac{0.074}{Re_{c}^{1/5}} - \frac{1.46}{Re_{c}^{1/2}} \Big)\frac{Re_{c}}{Re_{L}} = \frac{0.074}{Re_{L}^{1/5}} - \frac{A}{Re_{L}}
	\end{align}

其中 :math:`A = 0.074 Re_{c}^{4/5} - 1.46 Re_{c}^{1/2}` 。








