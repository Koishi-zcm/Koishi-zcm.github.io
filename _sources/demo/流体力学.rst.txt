********
流体力学
********

流体的基本特性就是易流动性。流体在静止时不能承受剪切力以抵抗剪切变形，只有在运动状态下，当流体质点之间有相对运动时，才能抵抗剪切形变形。只要有剪切力的作用，不论剪切力多么微小，流体就不会静止下来，将产生连续不断的变形，这就是流体易流动性的表现。

流体的真实结构时由彼此之间有间隙并在进行复杂的微观运动的大量流体分子所组成的凝聚态。从微观上看，流体是不连续体，其分子运动是不规则的。而从宏观上看，流体的运动特性可以呈现出空间上的连续性，这些流体分子行为的统计平均值是稳定的。这种宏观上足够小、微观上足够大的微体积内所有的流体分子组成的流体团称为 **流体质点** 。

**连续介质假设** 认为，流体质点只占据一个空间几何点，流体区域由流体质点连续组成，占满空间而没有间隙，而且定义在流体质点上的物理性质和运动要素是空间连续变化的。连续介质假设还与时间尺度相关联，我们可以在宏观上足够短、微观上足够长的时间段里得到一个流体质点内分子行为的统计平均值，宏观上把这个足够短的微小的时间段看成是一个时刻，这样流体物理性质和运动要素即可视为在时间上也是连续变化的。

基本概念
========

惯性
------

惯性是物体所具有的反抗原有运动状态的物理性质，度量其的物理量为质量。当物体受到其他物体的作用力而改变运动状态时，此物体反抗改变原有运动状态而 **作用于施力物体上的反作用力** 称为 **惯性力** 。设物体质量为 :math:`m` ，加速度为 :math:`\mathbf{a}` ，则惯性力 :math:`\mathbf{F}` 为

.. math::
	\begin{align}
	\mathbf{F} = -m\mathbf{a}
	\end{align}

负号表示惯性力方向与物体的加速度方向相反。

流体单位体积内所具有的质量称为密度，以 :math:`\rho` 表示，单位为 :math:`\mathrm{kg/m^{3}}` 。对于均质流体，设其体积为 :math:`V` ，质量为 :math:`m` ，则密度为 :math:`\rho = \frac{m}{V}` 。对于非均质流体，根据连续介质假设，若流体微团的体积为 :math:`\Delta V` ，质量为 :math:`\Delta m` ，则密度为

.. math::
	\begin{align}
	\rho = \lim_{\Delta V \to 0} \frac{\Delta m}{\Delta V} 
	\end{align}

其中 :math:`\Delta V \to 0` 表示流体微团趋于流体质点。此时密度是定义在流体质点上的。

.. note:: 流体密度将随着温度和压强变化。液体的密度随温度和压强的变化很微小，在常温常压下可以视为常数；气体的密度随温度和压强的变化比较显著，涉及到流体的压缩性及膨胀性。在一个标准大气压下，空气和水的密度都是随温度升高而减小。




流体的粘滞性、粘性系数
-------------------------

+--------------+--------------------------------------------------+-------------------------------------------------------------------------------------------------------+
| 概念         | 定义                                             | 备注                                                                                                  |
+==============+==================================================+=======================================================================================================+
| 动力粘滞系数 | 流体就具有抵抗剪切变形的能力，符号为 :math:`\mu` | 满足牛顿内摩擦定律 :math:`T=\mu A\frac{\mathrm{d}u}{\mathrm{d}y}` ，单位为 :math:`\mathrm{Pa\cdot s}` |
+--------------+--------------------------------------------------+-------------------------------------------------------------------------------------------------------+
| 运动粘滞系数 | 另一种定义粘性的量，符号为 :math:`\nu`           | 与动力粘滞系数的关系为 :math:`\nu = \frac{\mu}{\rho}`  ，单位为 :math:`m^{2}/s`                       |
+--------------+--------------------------------------------------+-------------------------------------------------------------------------------------------------------+
| 理想流体     | 忽略粘滞性的流体                                 | 是一种假想流体，不能用于壁面边界层处的流动                                                            |
+--------------+--------------------------------------------------+-------------------------------------------------------------------------------------------------------+
| 牛顿流体     | 切应力与剪切变形速度符合牛顿内摩擦定律的流体     | 流体的粘滞系数 :math:`\mu` 恒定不变                                                                   |
+--------------+--------------------------------------------------+-------------------------------------------------------------------------------------------------------+
| 非牛顿流体   | 切应力与剪切变形速度不符合牛顿内摩擦定律的流体   | 可以分为膨胀性流体、伪塑性流体、理想宾汉流体                                                          |
+--------------+--------------------------------------------------+-------------------------------------------------------------------------------------------------------+



粘滞性和牛顿内摩擦定律
^^^^^^^^^^^^^^^^^^^^^^^^^

流体具有易流动性，静止时不能承受剪切力以抵抗剪切形变，但是在运动状态下，流体就具有抵抗剪切变形的能力，这就是 **粘滞性** ，简称粘性。在剪切变形的过程中，流体层之间发生相对运动，由于流体具有粘滞性，流体层之间会出现成对的切力（内摩擦力）， 其阻碍了相对运动，从而影响流体的运动状况和变形的速度。

.. note:: 流体的粘滞性导致流体在运动过程中克服内摩擦力而做功，是流体运动中机械能量损失的根源。

定理 : 牛顿内摩擦定律
    流体沿某一固体表面作平行直线运动，流层间内摩擦力 :math:`T` 的大小与流体性质有关，并与流速梯度 :math:`\frac{\mathrm{d} u}{\mathrm{d} y}` 和接触面积 :math:`A` 有关，而与接触面上的压力无关：

.. math::
	\begin{align}
	T = \mu A \frac{\mathrm{d} u}{\mathrm{d} y}
	\end{align}

其中 :math:`\mu` 为表征流体粘滞性的比例系数，称为 **动力粘滞系数** 或 **动力粘度** ，单位为 :math:`\mathrm{Pa \cdot s}` ； :math:`A` 为流层间的接触面积； :math:`\frac{\mathrm{d} u}{\mathrm{d} y}` 为流体运动横向速度梯度。

如果用 :math:`\tau` 来表示单位面积上的内摩擦力，即切应力，则有

.. math::
	\begin{align}
	\tau = \frac{T}{A} = \mu \frac{\mathrm{d} u}{\mathrm{d} y}
	\end{align}

流体的粘滞性还可以用 **运动粘滞系数** :math:`\nu` 表示，或简称 **运动粘度** ，单位为 :math:`\mathrm{m^{2}/s}` ，它与动力粘性系数的关系为

.. math::
	\begin{align}
	\nu = \frac{\mu}{\rho} 
	\end{align}

.. note:: 

	粘性与流体种类相关，且随其温度和压力的而变化。对于常见的流体如水、空气等，由于粘性随压力的变化不大，一般可以忽略其变化，因此温度是影响流体粘性的主要因素。不过，温度对气体和液体的粘性影响规律不同，可以从分子微观运动的角度来解释：粘性是流体分子间的吸引力和分子不规则热运动而产生动量交换的结果，温度升高，分子间的引力降低，分子间热运动增强，动量交换率增大；而温度降低，分子间的引力增大，分子间热运动减弱，动量交换率减小。

	- 对于气体来说，分子间距较大，吸引力对粘性影响很小，而热运动产生的动量交换率随温度升高而加剧，因此 **气体的粘性随温度升高而加大** 。
	- 对于液体来说，由于其分子间距较小，吸引力其主要作用，因此 **液体的粘性随温度升高而降低** 。



理想流体
^^^^^^^^^^

在实际工程和某些理论研究中，有时可以不考虑粘性的影响，即切应力很小可以忽略，也就引入了没有粘滞性的流体 **理想流体** 的概念。对理想流体运动的分析成果可以近似反映粘性作用不大的实际流动情况。理想流体是一种假想的流体，如远离固体边壁边界层的流动，其剪切变形速度很小，切应力可以忽略，就可以将流体按理想流体处理。而在实际流动中，固体壁面边界层内的流体变形速度很大，一般不能忽略流体粘性作用。


牛顿流体与非牛顿流体
^^^^^^^^^^^^^^^^^^^^^^^

实际流体运动的切应力与剪切变形速度的关系并不都符合牛顿内摩擦定律。如果流体的粘滞系数 :math:`\mu` 值恒定不变，流体的切应力与剪切变形速度符合牛顿内摩擦定律，这类流体称为 **牛顿流体** 。其他不符合牛顿内摩擦定律的流体统称为 **非牛顿流体** ，可以区分为：

- 膨胀性流体：粘性系数不是常数，随剪切变形的增大而增大，如淀粉浆等属于这类流体。
- 伪塑性流体：粘性系数不是常数，随剪切变形的增大而减小，如橡胶液等属于这类流体。
- 理想宾汉流体：当切应力达到某一数值时才开始发生剪切变形，而切应力与剪切变形速度也是线性关系，如泥浆等属于这类流体。
  

流体的压缩性及膨胀性
----------------------

+--------------+--------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 概念         | 符号               | 备注                                                                                                                                                        |
+==============+====================+=============================================================================================================================================================+
| 体积压缩系数 | :math:`\alpha_{p}` | :math:`\alpha _{p} = - \frac{\frac{\mathrm{d} V}{V}}{\mathrm{d} p} = \frac{\frac{\mathrm{d} \rho}{\rho} }{\mathrm{d} p }` ，单位为 :math:`\mathrm{Pa^{-1}}` |
+--------------+--------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 体积弹性模量 | :math:`K`          | :math:`K = \frac{1}{\alpha _{p}} = -V\frac{\mathrm{d} p}{\mathrm{d} V} = \rho \frac{\mathrm{d} p}{\mathrm{d} \rho}` ，单位为 :math:`\mathrm{Pa}`            |
+--------------+--------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 体积膨胀系数 | :math:`\alpha_{V}` | :math:`\alpha _{V} = \frac{\mathrm{dV}/V}{\mathrm{d} T} = - \frac{\mathrm{d} \rho/\rho}{\mathrm{d} T}` ，单位为 :math:`\mathrm{K^{-1}}`                     |
+--------------+--------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+


流体在压力的作用下会发生体积压缩变形，同时其内部将产生一种企图恢复原状的内力（弹性力）来抵抗体积压缩变形，在除去压力后能恢复原状，这种性质称为流体的 **压缩性** ，或称为 **弹性** 。

流体的压缩性的大小一般用 **体积压缩系数** 来表示。压缩系数是在一定温度下，单位压强作用下流体体积的相对减小值。由于压缩过程中流体质量保持不变，压缩系数也等于单位压强作用下流体密度的相对增加值，即

.. math::
	\begin{align}
	\alpha _{p} = - \frac{\frac{\mathrm{d} V}{V}}{\mathrm{d} p} = \frac{\frac{\mathrm{d} \rho}{\rho} }{\mathrm{d} p }  
	\end{align}

其中 :math:`\alpha_{p}` 为体积压缩系数， :math:`V` 为流体体积， :math:`p` 为压强， :math:`\rho` 为流体密度。


工程上也经常采用流体的 **体积弹性模量** :math:`K` 来表示流体的压缩性，它是体积压缩系数的倒数，即

.. math::
	\begin{align}
	K = \frac{1}{\alpha _{p}} = -V\frac{\mathrm{d} p}{\mathrm{d} V} = \rho \frac{\mathrm{d} p}{\mathrm{d} \rho}  
	\end{align}


在流体受热的情况下，体积膨胀，密度减小，温度下降则恢复原状，这种性质被称为流体的 **膨胀性** 。液体膨胀性用 **体积膨胀系数** :math:`\alpha _{V}` 表示，其定义为：在一定压强作用下，单位温度升高引起的体积变化率（或者反映密度的变化率），即

.. math::
	\begin{align}
	\alpha _{V} = \frac{\mathrm{dV}/V}{\mathrm{d} T} = - \frac{\mathrm{d} \rho/\rho}{\mathrm{d} T}  
	\end{align}

体积膨胀系数的单位为 :math:`\mathrm{K^{-1}}` ，它的大小反映了液体膨胀的强弱。


对于压缩性和膨胀性很小的流体，可以忽略压强和温度变化的影响，认为密度保持不变，称其为 **不可压缩流体** 。通常将液体看做不可压缩流体。气体具有较为显著的压缩性和膨胀性，通常将气体称为 **可压缩流体** ，在正常环境中，常见气体的密度、压强和温度三者的关系满足 **理想气体状态方程** ：

.. math::
	\begin{align}
	\frac{p}{\rho} = RT 
	\end{align}

其中 :math:`p` 为气体的绝对压强， :math:`\rho` 为气体的密度， :math:`T` 为气体热力学温度， :math:`R` 为气体常数。

.. note:: 在常温常压下，对于低速气流，如流速远小于声速的情况下，其密度变化不大，可以忽略压缩性的影响，按不可压缩流体来进行计算。



液体的表面张力特性
--------------------

液体具有尽量缩小其表面的趋势，在宏观上可以认为沿液体表面作用有张力，称为 **表面张力** 。表面张力的方向与液体表面相切，它使液体表面拉紧收缩，从而对液体的运动状况产生影响。

表面张力的大小可以用液体表面单位长度上受到的张力即 **表面张力系数** :math:`\sigma` 表示，其单位为 :math:`\mathrm{N/m}` ：

.. math::
	\begin{align}
	\sigma = \frac{\Delta T}{\Delta L} 
	\end{align}

其中 :math:`\Delta L` 是在自由表面上画出的一段长度， :math:`\Delta T` 是在其两侧自由表面的流体相互作用的拉力。  

.. note:: 同一种液体的表面张力系数随温度升高而减小；不同种类的液体和接触面，表面张力系数也会不同。由于表面张力为局部受力现象，一般 :math:`\sigma` 的值不大，可以忽略不计，只有在液体表面有较大的曲率时才考虑其影响。

插入液体的直径很小的管中及透水物质的孔隙中液体所发生的毛细现象就是表面张力的结果。管中及孔隙中的液体由于毛细管作用表面成凸形或凹形。毛细管中液体上升或下降的高度可以根据表面张力的大小来确定。设液面与管壁的接触角为 :math:`\theta` ，管的直径为 :math:`d` ，液体密度为 :math:`\rho` ，表面张力系数为 :math:`\sigma` ，根据液体重量与表面张力的垂直分量相平衡，可以得到

.. math::
	\begin{align}
	\pi d \sigma \cos \theta = \pi (\frac{d}{2})^{2} \rho g h
	\quad \Rightarrow \quad
	h = \frac{4\sigma \cos \theta}{\rho g d} 
	\end{align}

其中，接触角 :math:`\theta` 与液、气的种类和关闭的材料等因素有关。


质量力
--------

质量力是指作用在流体的每个质点上，其大小和流体的质量成正比的力。对于均质流体，质量力也必然和受作用流体的体积成正比，所以质量力又称为 **体积力** 。最常见的质量力是重力和惯性力。

单位质量的流体所受的质量力称为单位质量力。设作用在质量为 :math:`\Delta m` 的流体上的总质量力为 :math:`\Delta F` ，则单位质量力为

.. math::
	\begin{align}
	\mathbf{f} = \lim_{\Delta m \to 0}\frac{\Delta \mathbf{F}}{\Delta m} = \lim_{\Delta V \to 0} \frac{\Delta \mathbf{F}}{\rho\Delta V}  
	\end{align}

其中 :math:`\rho` 为流体密度， :math:`\Delta m \to 0` 和 :math:`\Delta V \to 0` 表示流体微团趋于流体质点。

单位质量力 :math:`\mathbf{f}` 在直角坐标系中的三个分量用 :math:`X,Y,Z` 表示，则

.. math::
	\begin{align}
	\mathbf{f} = X\mathbf{i} + Y \mathbf{j} + Z\mathbf{k}
	\end{align}

其中 :math:`\mathbf{i},\mathbf{j},\mathbf{k}` 分别表示x、y、z轴方向的单位矢量。

单位质量力及其分量都具有加速度的量纲 :math:`\mathrm{LT^{-2}}` 。当流体所受的质量力只有重力时，则在z轴铅锤向上的直角坐标系中质量力的三个分量分别为

.. math::
	\begin{align}
	X = 0, \quad Y=0, \quad Z=-g
	\end{align}

其中负号表示重力的方向是铅锤向下的，正好与z轴方向相反。



表面力
---------

表面力是流体内部各部分之间或流体和其他物体之间通过邻接表面作用在流体上的力，其大小和受力作用的表面面积成正比。由于流体内部不能承受拉力，所以表面力又可以分为垂直于作用面的压力和平行于作用面的切力。

如果在隔离体表面上取一个包含A点的微小面积 :math:`\Delta A` ，作用在 :math:`\Delta A` 上的法向力为 :math:`\Delta P` ，切向力为 :math:`\Delta T` ，则 :math:`\Delta A` 的单位面积上的平均压力（平均压强、平均压应力） :math:`\overline{p}` 和平均切力（平均切应力） :math:`\overline{\tau}` 分别为

.. math::
	\begin{align}
	\overline{p} = \frac{\Delta P}{\Delta A}, \qquad \overline{\tau} = \frac{\Delta T}{\Delta A}    
	\end{align}

若 :math:`\Delta A` 面积无限缩小至A点，根据连续介质假设，可以取其极限值，则A点的压强和切应力为

.. math::
	\begin{align}
	p = \lim_{\Delta A \to 0 }\frac{\Delta P}{\Delta A}, \qquad \tau = \lim_{\Delta A \to 0}\frac{\Delta T}{\Delta A}  
	\end{align}

在国际单位制中，压强和切应力的单位均为 :math:`\mathrm{Pa}` 。






体积通量和质量通量
-------------------

体积通量的物理意义为单位时间内流经某个网格单元面流体的体积，单位为 :math:`\mathrm{m}^{3}/\mathrm{s}` 。质量通量的物理意义为单位时间内流经某个网格单元面流体的质量，单位为 :math:`\mathrm{kg}/\mathrm{s}` 。对于不可压缩流体，通常选择体积通量；对于可压缩流体，通常选择质量通量。

体积通量在数学上是很好理解的，即每单位时间流经某个网格单元面多少立方米的流体：

.. math::
	\begin{align}
	\phi_{f}=\boldsymbol{U}_{f}\cdot \boldsymbol{S}_{f}
	\end{align}

其中 :math:`\phi_{f}` 表示网格单元面 :math:`\boldsymbol{S}_{f}` 上的通量， :math:`\boldsymbol{S}_{f}` 称为面矢量， :math:`\boldsymbol{U}_{f}` 是定义在网格单元面上的速度。在 :math:`\phi_{f}` 的基础上除以网格面积，就得到每单位时间每单位面积流经的体积：

.. math::
	\begin{align}
	\frac{\phi_{f}}{|\boldsymbol{S}_{f}|}=\boldsymbol{U}_{f}\cdot \frac{\boldsymbol{S}_{f}}{|\boldsymbol{S}_{f}|}=\boldsymbol{U}_{f}\cdot\boldsymbol{n}_{f}
	\end{align}

面矢量 :math:`\boldsymbol{S}_{f}` 的大小为 :math:`|\boldsymbol{S}_{f}|=\sqrt{S_{x}^{2}+S_{y}^{2}+S_{z}^{2}}` ，其中 :math:`S_{x},S_{y},S_{z}` 表示面矢量的分量。类似的可知， :math:`\rho_{f}\boldsymbol{U}_{f}\cdot \boldsymbol{S}_{f}` 表示每单位时间经过某个网格面多少千克流体。

上面引入的面法向矢量 :math:`\boldsymbol{n}_{f}=\frac{\boldsymbol{S}_{f}}{|\boldsymbol{S}_{f}|}` 定义了面的法向，每个网格单元都会分别对应一个面矢量和面法向矢量。除了边界面，网格的内部面也存在面矢量。两个网格连接面的矢量 :math:`\boldsymbol{S}` 垂直于网格面，大小等于面的面积；而常用的近似矢量是由宿主网格指向相邻网格，而连接宿主网格体心和相邻网格体心的矢量方向在非正交的情况下并不相同，这就会导致梯度计算存在差异，也就需要非正交修正算法。


扩散通量
--------

通常用 :math:`D` 表示扩散系数，那么每单位时间每单位面积由于扩散导致的通量可以表示为

.. math::
	\begin{align}
	\boldsymbol{J}=D\nabla \phi
	\end{align}

由于在一些情况下，各个方向由于扩散系数的不同会导致呈现各向异性扩散，且一般情况下各个方向的梯度也不相同，因此扩散通量为一个分量不同的矢量。扩散通量的驱动因素是变量的梯度。类似的，每单位时间由于扩散导致的通量可以表示为

.. math::
	\begin{align}
	\boldsymbol{J}_{f}\cdot \boldsymbol{S}_{f}=D(\nabla \phi)_{f}\cdot \boldsymbol{S}_{f}=D(\nabla \phi)_{f}\cdot \frac{\boldsymbol{S}_{f}}{|\boldsymbol{S}_{f}|} |\boldsymbol{S}_{f}|
	\end{align}

其中 :math:`(\nabla \phi)_{f}\cdot \frac{\boldsymbol{S}_{f}}{|\boldsymbol{S}_{f}|}` 表示面法向梯度。上述公式可以整理为

.. math::
	\begin{align}
	(\nabla \phi)_{f}\cdot \boldsymbol{n}_{f}=\frac{\boldsymbol{J}_{f}\cdot \boldsymbol{n}_{f}}{D} 
	\end{align}

上述公式通常可以用于施加边界条件。


速度散度
--------

体积通量 :math:`\phi_{f}` 是单位时间内流经某个面的流体体积，在此基础上乘以时间 :math:`\Delta t` 则表示体积为 :math:`V` 的流动控制体。由于其中的面 :math:`\mathrm{d}\boldsymbol{S}` 以 :math:`\boldsymbol{U}` 的速度移动，因此在 :math:`Delta t` 时间内体积的变化量为

.. math::
	\begin{align}
	\mathrm{d}V_{f}=\phi_{f}\Delta t=\boldsymbol{U}_{f}\cdot\mathrm{d}\boldsymbol{S}_{f}\Delta t  
	\end{align}






流体静力学
============

流体静力学研究流体在静止状态下的受力平衡规律。流体的静止状态指的是流体质点相对于参考坐标系没有运动，流体内部质点之间均不存在相对运动，有两种情况：

- 参考坐标系固定在地球上，流体相对地球没有运动；
- 流体相对于地球运动（如沿直线作等加速运动或等角速旋转运动容器内的流体），但相对于容器不运动，若将参考坐标系固定在容器上，流体仍是静止的，称为相对静止或相对平衡。
  
流体静力学中，将流体内的压应力称为 **流体静压强** ，处于流动状态的流体内部的压强称为 **流体动压强** 。有些情况下，流体动压强的分布规律也可以认为与流体静压强相同或相近。


流体静压强及其特性
---------------------

在静止流体中，围绕某点取一个面积为 :math:`\Delta A` 的微小作用面，设作用在其上的压力为 :math:`\Delta P` ，则该点的流体静压强 :math:`p` 就是面积 :math:`\Delta A` 趋于无穷小时，单位面积上平均压力的极限值：

.. math::
	\begin{align}
	p = \lim_{\Delta A \to 0} \frac{\Delta P}{\Delta A} 
	\end{align}

在国际单位制中，静压强 :math:`p` 的单位为 :math:`\mathrm{N/m^{2}}` 或 :math:`\mathrm{Pa}` 。

流体静压强有两个基本性质：

1. 流体静压强的方向沿作用面的内法线方向。
2. 静止流体中任一点上流体静压强的大小与作用面的方位无关，即同一点上各个方向的流体静压强的大小相等。
   
**证明** 第一个性质可以从流体的基本特征推出——静止流体中既不能承受切应力，也不能承受拉应力，否则将会发生流动，因此压强作用方向只能和作用面的内法线方向一致，即静止流体中只存在压应力。

关于第二个性质，可以设在静止流体中任意取一个点C，以此为顶点构造一个微小直角四面体。为方便起见，取三个正交面与坐标平面方向一致，棱长分别为 :math:`\mathrm{d}x` 、 :math:`\mathrm{d}y` 、 :math:`\mathrm{d}z` ，任意方向倾斜面的面积为 :math:`\mathrm{d}A_{n}` ，其外法线 :math:`\mathbf{n}` 的方向余弦为 :math:`\cos(\mathbf{n},x)` 、 :math:`\cos(\mathbf{n},y)` 、 :math:`\cos(\mathbf{n},z)` ，于是有面积关系：

.. math::
	\begin{align}
	\mathrm{d}A_{n} \cos(\mathbf{n},x) = \frac{1}{2}\mathrm{d}y\mathrm{d}z , \quad
	\mathrm{d}A_{n} \cos(\mathbf{n},y) = \frac{1}{2}\mathrm{d}x\mathrm{d}z , \quad
	\mathrm{d}A_{n} \cos(\mathbf{n},z) = \frac{1}{2}\mathrm{d}x\mathrm{d}y
	\end{align}

四面体受力包括表面力和质量力。因为静止流体中不存在切应力，所以表面力只有四个面上的压力，其与各面平均压强的关系为：

.. math::
	\begin{align}
	P_{x} = p_{x}\cdot \frac{1}{2}\mathrm{d}y\mathrm{d}z, \quad 
	P_{y} = p_{y}\cdot \frac{1}{2}\mathrm{d}x\mathrm{d}z, \quad 
	P_{z} = p_{z}\cdot \frac{1}{2}\mathrm{d}x\mathrm{d}y, \quad 
	P_{n}=p_{n}\cdot \mathrm{d}A_{n} 
	\end{align}

以 :math:`X` 、 :math:`Y` 、 :math:`Z` 分别表示单位质量力在对应坐标轴方向的分量，四面体内流体的质量为 :math:`\frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，它所受的质量力 :math:`\mathbf{F}` 在各坐标轴方向的分量可以表示为

.. math::
	\begin{align}
	F_{x}=(\frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\cdot X, \quad
	F_{y}=(\frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\cdot Y, \quad
	F_{z}=(\frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\cdot Z
	\end{align}

根据平衡条件，四面体处于静止状态下，各个方向上的作用力之和均为零。以x方向为例，即

.. math::
	\begin{align}
	P_{x} - P_{n}\cos(\mathbf{n},x) + F_{x} = 0
	\end{align}

将 :math:`P_{x}` 、 :math:`P_{n}` 、 :math:`F_{x}` 的表达式代入上式后得到

.. math::
	\begin{align}
	\frac{1}{2}p_{x}\mathrm{d}y\mathrm{d}z - \frac{1}{2}p_{n}\mathrm{d}y\mathrm{d}z + \frac{1}{6}\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z \cdot X = 0
	\end{align}

当 :math:`\mathrm{d}x` 、 :math:`\mathrm{d}y` 、 :math:`\mathrm{d}z` 趋于零，四面体向C点无限缩小时，上式等号左侧第三项为高阶小量，可以忽略，从而得到 :math:`p_{x} = p_{n}` 。y轴和z轴方向上的情况以此类推，从而得到

.. math::
	\begin{align}
	p_{x} = p_{y} = p_{z} = p_{n}
	\end{align}

而在上述对微元体的分析当中，倾斜面的方向 :math:`\mathbf{n}` 是任意的，因此上式说明在同一点上各个方向的流体静压强均相等，与作用面的方位无关。因此，静止流体中任一点应力状态可以用流体静压强表示，它只是该点坐标的连续函数，即 :math:`p=p(x,y,z)` 。





流体平衡微分方程
-------------------

流体平衡基本关系式的建立
^^^^^^^^^^^^^^^^^^^^^^^^^^

在静止的流体中取一微元正六面体，其中心在任意点 :math:`M` ，各边分别与坐标轴平行，边长为 :math:`\mathrm{d}x,\mathrm{d}y,\mathrm{d}z` 。作用于此流体微元六面体的力有两种，首先是六面体上的表面力，即周围流体对它施加的压力，这取决于六面体各面上的压强。设六面体中心点 :math:`M(x,y,z)` 的压强为 :math:`p(x,y,z)` ，由连续介质假设可知压强是坐标的连续函数。当坐标有微小变化时，压强也发生变化，并可以用泰勒级数表示为

.. math::
	\begin{align}
	p(x+\Delta x,y+\Delta y,z+\Delta z) 
	=& p(x,y,z)
	+\Big( \frac{\partial p}{\partial x}\Delta x+\frac{\partial p}{\partial y}\Delta y+\frac{\partial p}{\partial z}\Delta z \Big) \\
	&+ \frac{1}{2!} \Big( 
	  \frac{\partial ^{2}p}{\partial x^{2}}\Delta x^{2}
	  + \frac{\partial ^{2}p}{\partial y^{2}}\Delta y^{2}
	  + \frac{\partial ^{2}p}{\partial z^{2}}\Delta z^{2}
	  + 2\frac{\partial ^{2}p}{\partial x\partial y}\Delta x\Delta y
	  + 2\frac{\partial ^{2}p}{\partial y\partial z}\Delta y\Delta z
	  + 2\frac{\partial ^{2}p}{\partial z\partial x}\Delta z\Delta x
	  \Big)
	+ \cdots
	\end{align}

当忽略二阶以上的各项时，沿x方向作用于微元六面体边界面中心处的压强分别为 :math:`p+\frac{\partial p}{\partial x}\frac{\mathrm{d} x}{2}` 和 :math:`p-\frac{\partial p}{\partial x}\frac{\mathrm{d} x}{2}` ，而由于受压面是一微小面积，上述压强可以认为是所在面的平均压强，因此沿x方向的压力的合力为

.. math::
	\begin{align}
	(p-\frac{\partial p}{\partial x}\frac{\mathrm{d} x}{2})\mathrm{d}y\mathrm{d}z  -(p+\frac{\partial p}{\partial x}\frac{\mathrm{d} x}{2})\mathrm{d}y\mathrm{d}z
	= -\frac{\partial p}{\partial x}\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{align}

然后考虑作用于六面体的质量力。以 :math:`X,Y,Z` 分别表示单位质量力在 :math:`x,y,z` 轴方向的分量， :math:`\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z` 表示六面体的质量，则质量力分量分别为 :math:`\rho\mathrm{d}x\mathrm{d}y\mathrm{d}zX, \rho\mathrm{d}x\mathrm{d}y\mathrm{d}zY, \rho\mathrm{d}x\mathrm{d}y\mathrm{d}zZ` 。

因为微小六面体处于平衡状态，它受到的表面力与质量力必须平衡，以x方向为例，则有

.. math::
	\begin{align}
	-\frac{\partial p}{\partial x}\mathrm{d}x\mathrm{d}y\mathrm{d}z + \rho\mathrm{d}x\mathrm{d}y\mathrm{d}zX = 0
	\quad \Rightarrow \quad 
	\frac{1}{\rho}\frac{\partial p}{\partial x}-X=0 
	\end{align}

y,z方向同理，于是可以得到矢量形式的 **流体平衡微分方程** （或称欧拉平衡微分方程）：

.. math::
	\begin{align}
	\nabla p = \rho \mathbf{f}
	\end{align}



平衡流体压强分布规律
^^^^^^^^^^^^^^^^^^^^^^^

在给定质量力的作用下，设微分位移矢量 :math:`\mathrm{d}\mathbf{r}=(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)` ，则对流体平衡微分方程两边乘以该微分位移矢量并积分则有

.. math::
	\begin{align}
	\int \nabla p \cdot \mathrm{d}\mathbf{r} = \int \rho \mathbf{f} \cdot \mathrm{d}\mathbf{r}
	\quad \Rightarrow \quad 
	p = \rho W + \text{const}
	\end{align}

其中 :math:`W(x,y,z)` 为 **质量力势函数** ，而其中的常数const可以通过流体表面或内部某点已知的势函数 :math:`W_{0}` 和压强 :math:`p_{0}` 来确定，从而有

.. math::
	\begin{align}
	p = p_{0} + \rho(W - W_{0})
	\end{align}

该式说明了平衡流体压强的分布规律，如果质量力势函数已知就能计算任一点处的压强。同时可以看到，在平衡状态下，常密度流体中任一点的压强变化一定会等值地传递到流体的其他各点上，称之为 **帕斯卡原理** 。


等压面
^^^^^^^^^

静止流体中压强相等的各点所构成的面称为等压面。在等压面上，压强 :math:`p` 为常数，若取等压面的切平面上沿任意方向的微小位移矢量 :math:`\mathrm{d}\mathbf{r}` ，则有

.. math::
	\begin{align}
	\nabla p \cdot \mathrm{d}\mathbf{r} = \rho \mathbf{f} \cdot \mathrm{d}\mathbf{r} = 0  
	\end{align}

可以看到，在平衡的不可压缩均质流体中，等压面同时也是等势面。同时，流体质点沿等压面移动时质量力做功为零，而质量力和位移都不等于零，因此质量力必定垂直于等压面，于是可根据质量力的方向来判断等压面的形状。




重力场中液体静压强的分布
--------------------------

重力作用下的液体平衡方程
^^^^^^^^^^^^^^^^^^^^^^^^^^^

对于重力场中的静止流体，设液体自由面（液面）上的压强为 :math:`p_{0}` ，单位质量力为 :math:`\mathbf{f} = (0,0,-g)` ，于是根据流体平衡微分方程可以得到

.. math::
	\begin{align}
	\int \nabla p \cdot \mathrm{d}\mathbf{r} = \int \rho \mathbf{f} \cdot \mathrm{d}\mathbf{r} 
	\quad \Rightarrow \quad 
	p = -\rho gz + \text{const} 
	\end{align}

利用液面上 :math:`z=0,p=p_{0}` 的条件可以得到 :math:`\text{const} = p_{0}` 。而对于液体中的各点来说，用各点在液面下的深度 :math:`h` 来代替z轴方向更方便，于是将 :math:`z=-h,\text{const}=p_{0}` 得到

.. math::
	\begin{align}
	p = p_{0} + \rho gh
	\end{align}

上式就是重力作用下的液体平衡方程，称为 **液体静力学基本方程** 。

.. attention:: 该结论只适用于质量力只有重力、同一物性的静止连续的液体。







压强的度量
^^^^^^^^^^^^^

+----------+------------------------+----------------------------------------------------------------------------------------+
| 概念     | 符号                   | 定义                                                                                   |
+==========+========================+========================================================================================+
| 绝对压强 | :math:`p_{\text{abs}}` | 以没有气体存在的完全真空为零算起的压强值                                               |
+----------+------------------------+----------------------------------------------------------------------------------------+
| 相对压强 | :math:`p_{r}`          | 以当地大气压强为压强计量的基准点，满足 :math:`p_{r} = p_{\text{abs}} - p_{\text{atm}}` |
+----------+------------------------+----------------------------------------------------------------------------------------+
| 真空值   | :math:`p_{v}`          | 真空状态下相对压强的负值，满足 :math:`p_{v} = p_{\text{atm}} - p_{\text{abs}}`         |
+----------+------------------------+----------------------------------------------------------------------------------------+



以没有气体存在的完全真空为零算起的压强值称为 **绝对压强** ，记为 :math:`p_{\text{abs}}` 。在实际大多数情况下都会受到大气压强 :math:`p_{a}` 的作用，因此以当地大气压强作为压强计量的基准点较为方便，这样的压强值称为 **相对压强** ，记为 :math:`p_{r}` ，满足关系：

.. math::
	\begin{align}
	p_{r} = p_{\text{abs}} - p_{a}
	\end{align}

实际情况下，压强不可能低于绝对真空状态的压强，因此绝对压强的数值总是正的，而相对压强的数值可正可负。当所计量的压强低于当地大气压强时，相对压强值为负，称为负压状态或真空状态。将真空状态下的差值称为 **真空值** ，记为 :math:`p_{v}` ，满足关系：

.. math::
	\begin{align}
	p_{v} = p_{a} - p_{\text{abs}}
	\end{align}


压强常采用的度量方式及常用单位的关系如下：

+--------------+------------+--------------------------+-----------------------------------------------------------------------------------------+
| 压强量度方法 | 单位名称   | 单位符号                 | 单位换算关系                                                                            |
+==============+============+==========================+=========================================================================================+
| 应力单位法   | 帕         | :math:`\mathrm{Pa}`      | :math:`1~\mathrm{Pa}=1~\mathrm{N/m^{2}}`                                                |
+--------------+------------+--------------------------+-----------------------------------------------------------------------------------------+
| 液柱高度法   | 米水柱     | :math:`\mathrm{mH_{2}O}` | :math:`1~\mathrm{mH_{2}O}=9.8\times10^{3}~\mathrm{Pa}`                                  |
+              +------------+--------------------------+-----------------------------------------------------------------------------------------+
|              | 毫米汞柱   | :math:`\mathrm{mmHg}`    | :math:`1~\mathrm{mmHg} =13.6~\mathrm{mmH_{2}O}=133.3~\mathrm{Pa}`                       |
+--------------+------------+--------------------------+-----------------------------------------------------------------------------------------+
| 工程大气压法 | 工程大气压 | :math:`\mathrm{at}`      | :math:`1~\mathrm{at}=10~\mathrm{mH_{2}O}=736~\mathrm{mmHg}=9.8\times10^{4}~\mathrm{Pa}` |
+--------------+------------+--------------------------+-----------------------------------------------------------------------------------------+





水头与单位势能
^^^^^^^^^^^^^^^^^

重力场中的液体平衡方程稍微移项整理后可以得到另外一个形式：

.. math::
	\begin{align}
	z + \frac{p}{\rho g} = \text{const} 
	\end{align}

上式表明，在重力场的静止液体内部所有点上的 :math:`z + \frac{p}{\rho g}` 值总是一个常数。

如果在容器壁的任一点1处开一个小孔，接上上端与大气相通的玻璃管（测压管），则在1点压强的作用下测压管的液面将上升到某一高度。任意选取一个高度基准面，则测压管的液面到基准面的高度由 :math:`z_{1}` 和 :math:`\frac{p_{1}}{\rho g}` 两部分组成，其中 :math:`z_{1}` 称为 **位置水头** ， :math:`\frac{p_{1}}{\rho g}` 称为 **压强水头** ，而 :math:`z_{1}+\frac{p_{1}}{\rho g}` 称为 **测管水头** 。再在任一点2处开另一个小孔，则1、2两根测压管的液面是相齐平的，即

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} = z_{2} + \frac{p_{2}}{\rho g}  
	\end{align}

由于液体中的1、2两点是任意选取的，所以上式表明重力场中静止液体内所有各点的测量水头都是相等的。

位置水头、压强水头和测管水头具有明确的能量含义。如果物体的重量为 :math:`G` ，把该物体从基准面位移到高度 :math:`z` 后，该物体所具有的位能为 :math:`G\cdot z` ，对该物体的单位重量而言的位能则为 :math:`\frac{G\cdot z}{G}=z` 。所以，上式中 :math:`z` 表示单位重量液体相对于基准面的位置势能，也称之为 **单位位能** （简称位能）。与此相类似，压强水头 :math:`\frac{p}{\rho g}` 表示单位重量液体相对于大气压强基准点所具有的压强势能，称之为 **单位压能** （简称压能）。测管水头 :math:`z+\frac{p}{\rho g}` 表示了单位重量液体的总势能，即位能与压能之和（简称单位势能）。





作用在平面上的液体的总压力
-----------------------------

有一任意形状平面A'B'，倾斜放置在静止液体中，与水平液面的夹角为 :math:`\alpha` ，平面面积为 :math:`A` 。选择平面A'B'的延伸面与水平液面的交线为x轴，Oxy坐标平面与平面A'B'在同一平面。在平面A'B'上任取一微小面积 :math:`\mathrm{d}A` ，其中心点在液面以下的深度为 :math:`h` ，在 :math:`y` 轴上的距离为 :math:`y` ，并设该微小面积上的压强为 :math:`p` ，则作用在整个平面上的总压力为

.. math::
	\begin{align}
	P=\int_{A}p\mathrm{d}A = \int_{A}\rho gh\mathrm{d}A=\int_{A}\rho gy\sin\alpha \mathrm{d}A=\rho g\sin\alpha \int_{A}y\mathrm{d}A   
	\end{align}

其中 :math:`\int_{A}y\mathrm{d}A` 是平面A'B'对Ox轴的静面矩，其大小等于面积 :math:`A` 与形心 :math:`C` 的坐标 :math:`y_{C}` 的乘积，于是

.. math::
	\begin{align}
	P =\rho g \sin\alpha \cdot y_{C}A = \rho g h_{C}A = p_{C}A
	\end{align}

其中， :math:`h_{C}` 为形心 :math:`C` 在液面下的深度， :math:`p_{C}` 为形心 :math:`C` 上的压强。上式表明，静止液体作用于任意形状平面上的总压力等于该平面的面积与其形心点静压强的乘积。而形心点的静压强就是整个作用面的平均压强。

根据合力矩定理（合力对任一轴的力矩等于各分力对该轴的力矩之和），可以得到总压力 :math:`P` 作用点 :math:`D` （压力中心）的坐标 :math:`x_{D},y_{D}` 。对Ox轴取力矩，则有

.. math::
	\begin{align}
	P \cdot y_{D} = \int_{A}y\mathrm{d}P = \int_{A}y\cdot\rho gh\mathrm{d}A 
	              = \int_{A}y\cdot \rho gy\sin\alpha \mathrm{d}A = \rho g\sin\alpha \int_{A}y^{2}\mathrm{d}A 
	\end{align}


其中 :math:`\int_{A}y^{2}\mathrm{d}A` 为平面A'B'对Ox轴的惯性矩，用符号 :math:`I_{xo}` 表示。化简整理上式得到

.. math::
	\begin{align}
	y_{D} = \frac{\rho g\sin\alpha I_{xo}}{P} = \frac{\rho g\sin\alpha I_{xo}}{\rho g\sin\alpha y_{C}A} = \frac{I_{xo}}{y_{C}A}  
	\end{align}


根据惯性矩平行移轴公式 :math:`I_{xo}=I_{xC}+y_{C}^{2}A` ，可以将平面上静压力对Ox轴的惯性矩 :math:`I_{xo}` 换算成惯性矩 :math:`I_{xC}` （相对于通过受压面形心C且平行于Ox轴的一条轴线的惯性矩），所以上式可以改写为

.. math::
	\begin{align}
	y_{D} = \frac{I_{xC} + y_{C}^{2}A}{y_{C}A} = y_{C} + \frac{I_{xC}}{y_{C}A}  
	\end{align}

压力中心D和受压面形心点C在y方向之间的距离为

.. math::
	\begin{align}
	e = y_{D} - y_{C} = \frac{I_{xC}}{y_{C}A} 
	\end{align}

上式表明压力中心D总是位于平面形心点C的下方。


常见平面的 :math:`A` 、 :math:`y_{C}` 和 :math:`I_{xC}` 值如下：

+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 名称   | 面积 :math:`A`              | 形心位置 :math:`y_{C}`                | 惯性矩 :math:`I_{xC}`                                 |
+========+=============================+=======================================+=======================================================+
| 矩形   | :math:`bh`                  | :math:`\frac{h}{2}`                   | :math:`\frac{bh^{3}}{12}`                             |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 三角形 | :math:`\frac{bh}{2}`        | :math:`\frac{2}{3}h`                  | :math:`\frac{bh^{3}}{36}`                             |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 梯形   | :math:`\frac{h(a+b)}{2}`    | :math:`\frac{h}{3}(\frac{a+2b}{a+b})` | :math:`\frac{h^{3}}{36}(\frac{a^{2}+4ab+b^{2}}{a+b})` |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 圆     | :math:`\pi r^{2}`           | :math:`r`                             | :math:`\frac{\pi r^{4}}{4}`                           |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+
| 半圆   | :math:`\frac{\pi r^{2}}{2}` | :math:`\frac{4r}{3\pi}`               | :math:`\frac{9\pi^{2}-64}{72\pi}r^{4}`                |
+--------+-----------------------------+---------------------------------------+-------------------------------------------------------+


上述推导是基于开放水域的，即上表面存在自由水面，并且使用相对压强。如果是在像管道那样的封闭空间，相对压强可能不仅由高度决定，或者改以绝对压强来考虑总压力和作用点时都不再仅仅由高度决定压强值。此时作用在整个平面上的总压力在结果上形式相同：

.. math::
	\begin{align}
	P = \int_{A}\mathrm{d}P = \int_{A}(p_{0} + \rho gh)~\mathrm{d}A = p_{0}A + \rho gh_{C}A = p_{C}A
	\end{align}

而总压力的作用点则发生变化：

.. math::
	\begin{align}
	P\cdot y_{D} = \int_{A}y~\mathrm{d}P
	= \int_{A}y \cdot (p_{0} + \rho gh)~\mathrm{d}A
	= p_{0}\int_{A}y~\mathrm{d}A + \rho g\sin\alpha \int_{A} y^{2}~\mathrm{d}A
	= p_{0}y_{C}A + \rho g \sin\alpha  I_{xo}
	\end{align}

.. math::
	\begin{align}
	y_{D} = \frac{p_{0}y_{C}A + \rho g \sin\alpha  I_{xo}}{P}
	= \frac{p_{0}y_{C}A + \rho g \sin\alpha I_{xo}}{p_{0}A + \rho g\sin\alpha y_{C}A}
	= \frac{p_{0}y_{C}A + \rho g \sin\alpha (I_{xC} + y_{C}^{2}A)}{p_{0}A + \rho g\sin\alpha y_{C}A} 
	= y_{C} + \frac{I_{xC}}{\cfrac{p_{0}A}{\rho g\sin\alpha } + y_{C}A} 
	\end{align}

可以看到，当参考高程位置的相对压强不为零时，或者改用绝对压强计算总压力作用点时，形心位置处的压强仍然是平面上的平均压强，但是总压力的作用点位置相对偏高，也即与形心点位置更加接近，并且与平面的倾斜角度有关。



作用在曲面上的液体总压力
--------------------------

考虑具有水平母线的柱面（二维曲面）的情况。设二维曲面A'B'，其左侧承受液体静压强，母线平行于Oy轴，曲面面积为 :math:`A` 。在曲面A'B'上、深度为 :math:`h` 的位置处取一微小面积 :math:`\mathrm{d}A` ，则作用在此微小面积的液体压力为 :math:`\mathrm{d}P = p\mathrm{d}A=\rho gh\mathrm{d}A` ，方向垂直于面积 :math:`\mathrm{d}A` ，并水平线成 :math:`\theta` 角。此微小压力可以分解为水平和垂直分力：

.. math::
	\begin{align}
	& \mathrm{d}P_{x} = \mathrm{d}P\cos\theta =\rho gh\mathrm{d}A\cos\theta =\rho gh\mathrm{d}A_{x} \\
	& \mathrm{d}P_{z} = \mathrm{d}P\sin\theta = \rho gh\mathrm{d}A\sin\theta = \rho gh\mathrm{d}A_{z}      
	\end{align}

其中 :math:`\mathrm{d}A_{x}` 是 :math:`\mathrm{d}A` 在铅垂面yOz上的投影， :math:`\mathrm{d}A_{z}` 是 :math:`\mathrm{d}A` 在水平面xOy上的投影。

作用在整个曲面上的水平分力为

.. math::
	\begin{align}
	P_{x} = \int_{A_{x}}\rho gh\mathrm{d}A_{x} = \rho g\int_{A_{x}}h\mathrm{d}A_{x} 
	\end{align}

与求作用在平面上的液体的总压力类似， :math:`\int_{A_{x}}h\mathrm{d}A_{x}` 表示曲面A'B'在铅垂面上的投影面积 :math:`A_{x}` 对水平轴（Oy轴）的静面矩。若 :math:`A_{x}` 的形心在液面下的深度为 :math:`h_{C}` ，则 :math:`\int_{A_{x}}h\mathrm{d}A_{x}=h_{C}A_{x}` ，从而有

.. math::
	\begin{align}
	P_{x}=\rho gh_{C}A_{x}
	\end{align}

上式表明作用于曲面A'B'上的总压力的水平分力等于作用于该曲面的铅锤投影面上的总压力，可以按照确定平面总压力的方法来确定 :math:`P_{x}` 。

作用在整个曲面上的垂直分力为

.. math::
	\begin{align}
	P_{z} = \int_{A_{z}} \rho gh\mathrm{d}A_{z} = \rho g\int_{A_{z}} h\mathrm{d}A_{z} 
	\end{align}

其中 :math:`h\mathrm{d}A_{z}` 代表了微小面积与它在自由液面延长面上的投影 :math:`\mathrm{d}A_{z}` 之间的柱体体积，而 :math:`\int_{A_{z}} h\mathrm{d}A_{z}` 就是整个曲面A'B'与其在自由液面（或延长面）上的投影之间的柱体体积。该柱体称为曲面A'B'的 **压力体** ，其体积以 :math:`V_{p}` 来表示，即 :math:`V_{p}=\int_{A_{z}} h\mathrm{d}A_{z}` ，于是

.. math::
	\begin{align}
	P_{z} = \rho gV_{p}
	\end{align}

可以看到，作用于曲面A'B'上的总压力 :math:`P` 的垂直分力 :math:`P_{z}` 等于其压力体内充满液体时的重量。 :math:`P_{z}` 的作用线一定通过压力体的重心。

.. attention:: :math:`P_{z}` 的方向取决于液体、压力体与受压曲面间的相对位置。可以通过实际作用在曲面上的总压力总是指向曲面，根据深度不同对应的压力大小不同，来判断其垂直分力合成后最终应该是向上还是向下。复杂压力体会出现部分区域相互抵消的情况。

.. note:: 

	如果参考水面的相对压强不为零，或者改用绝对压强来计算竖直方向的压力时，则为

	.. math::
		\begin{align}
		P_{z} = \int_{A_{z}}(p_{0} + \rho gh)~\mathrm{d}A_{z}
		= p_{0}A_{z} + \rho g V_{p}
		\end{align}



求出了水平分力 :math:`P_{x}` 和垂直分力 :math:`P_{z}` 后，就可以确定作用在曲面上的总压力为

.. math::
	\begin{align}
	P=\sqrt{P_{x}^{2}+P_{z}^{2}}, \qquad \alpha =\arctan\frac{P_{z}}{P_{x}}  
	\end{align}

.. note:: :math:`P` 的作用线必定通过 :math:`P_{x}` 和 :math:`P_{z}` 的作用线的交点，不过这个交点不一定在曲面上。


作用于潜体或浮体（物体全部或部分浸没于液体中）的压力问题是曲面压力的特例。此时，作用在物体上的水平分力 :math:`P_{x},P_{y}` 均为零，而作用于物体的铅锤总压力 :math:`P_{z}` 方向向上，满足

.. math::
	\begin{align}
	P_{z} = \rho gV
	\end{align}

压力体体积 :math:`V` 就是浸没体积，铅锤力作用线通过物体被浸没部分体积的几何中心（浮心），这就是 **阿基米德原理** 。





非惯性系下液体的相对平衡
----------------------------

如果装在容器中的液体随容器相对于地球在运动，但液体内部各质点之间以及液体与容器之间没有相对运动，若把坐标系取在容器上，则液体相对于所取的坐标系而言，也处于静止状态，称为相对静止或相对平衡。下面以等角速度旋转容器内液体的相对平衡为例进行说明。

盛有液体的开口圆柱形容器以等角速度绕其中心铅锤轴旋转，由于液体的粘滞作用，经过一段时间后，整个液体随容器以同样的角速度旋转。液体与容器以及液体内部各层之间无相对运动，液面形成一个漏斗形的旋转抛物面。将坐标系取在运动着的容器上，原点取在旋转轴与容器底面的交点上，z轴垂直向上。

根据达朗贝尔原理，作用在每一流体质点上的质量力除重力以外，还要考虑惯性力，对于等角速度旋转运动来说，离心惯性力为

.. math::
	\begin{align}
	\mathbf{F} = m\omega^{2}\mathbf{r}
	\end{align}

其中 :math:`m` 为质点质量， :math:`\omega` 为角速度， :math:`\mathbf{r}` 为该点所在位置的向径，其数值为 :math:`r=\sqrt{x^{2}+y^{2}}` 。而单位质量的离心惯性力在x轴和y轴方向的投影分别为

.. math::
	\begin{align}
	X=\omega^{2}r\cos\alpha =\omega^{2}x, \qquad Y=\omega^{2}r\sin\alpha =\omega^{2}y
	\end{align}

再考虑重力的单位质量力分量为 :math:`Z=-g` ，从而得到 :math:`\mathbf{f} = (\omega^{2}x,\omega^{2}y,-g)` ，进而根据流体平衡方程得到

.. math::
	\begin{align}
	\int \nabla p \cdot \mathrm{d}\mathbf{s} = \int \rho \mathbf{f} \cdot \mathrm{d}\mathbf{s}
	\quad \Rightarrow \quad 
	p = \rho(\frac{1}{2}\omega^{2}x^{2}+\frac{1}{2}\omega^{2}y^{2}-gz)+\text{const}
	  = \rho(\frac{1}{2} \omega^{2}r^{2}-gz)+\text{const}  
	\end{align}

由边界条件 :math:`r=0,z=z_{0},p=p_{0}` 可以确定积分常数 :math:`\text{const}=p_{0}+\rho gz_{0}` ，得到液面下任一点处的压强为

.. math::
	\begin{align}
	p=p_{0}+\rho\Big( \frac{1}{2}\omega^{2}r^{2}+(z_{0}-z)g \Big)
	 =p_{0}+\rho g\Big( \frac{\omega^{2}r^{2}}{2g}+(z_{0}-z) \Big)
	\end{align}

若液面压强为大气压强，用相对压强表示时有 :math:`p_{0}=p_{a}=0` ，则

.. math::
	\begin{align}
	p = \rho g\Big( \frac{\omega^{2}r^{2}}{2g}+(z_{0}-z) \Big)
	\end{align}

该式表示相对平衡的液体内压强分布规律。


同时注意到，如果令 :math:`p` 为某一常数，整理后可以得到等压面方程：

.. math::
	\begin{align}
	\frac{\omega ^{2}r^{2}}{2g}-z=\text{const}
	\end{align}

该式表明等压面是一族旋转抛物面。而对于某一固定半径位置，不难得到压强与任一点在自由液面下的淹没深度之间的关系为 :math:`p=p_{0} + \rho gh` ，也即相对平衡液体在铅锤方向压强分布规律与静止液体相同。

.. note:: 铅锤方向压强分布规律与静止液体相同这一结论对所有相对平衡液体都成立，除了上述的匀速旋转平衡，还有匀加速直线运动平衡等等。

.. attention:: 只有在铅锤方向上可以利用高度差计算压强差，当存在水平位置存在差别时仍然需要使用原本的压强分布规律来计算。






流体运动学
=============

流体运动的描述方法
--------------------

拉格朗日法
^^^^^^^^^^^^^

拉格朗日法时质点系法，其基本思想是跟踪每个流体质点的运动全过程，记录它们在运动过程中位移的时间历程，通过对全部流体质点的跟踪过程，获得流体的总体运动情况。拉格朗日法的特点是：跟着所选定的流体质点，观察它的位移。

通常用流体质点在初始时刻 :math:`t=t_{0}` 的空间位置坐标 :math:`(a,b,c)` 作为区分不同流体质点的标记。 :math:`(a,b,c)` 取不同的值表示不同的流体质点。 :math:`a,b,c` 和 :math:`t` 称为 **拉格朗日变量** ，则位移是拉格朗日变量的函数：

.. math::
	\begin{align}
	\mathbf{r} = \mathbf{r}(a,b,c,t)
	\end{align}

上式给出了任意一个标记为 :math:`(a,b,c)` 的流体质点在任意一个时刻 :math:`t` 的空间位置，也就描述了流体的整体运动。流体在运动过程中其他运动要素和物理量的时间历程也可以用拉格朗日法进行描述。

.. note:: 

	拉格朗日法着眼于流体质点，物理意义直观，但是在跟踪流体质点的过程中，时间和质点所在空间位置会同时发生变化，带来数学处理上的困难，所以拉格朗日法通常只在一些对流体质点运动特别关注的问题中被采用。


欧拉法
^^^^^^^^

欧拉法是空间点法，是一种场的描述方法，也叫流场法。欧拉法不去追究各流体质点的运动过程，而把着眼点放在空间点，观察先后流经这一空间点的各个流体质点的运动情况。通过对流场所占据的全部空间点的观察过程的综合，获得整个流动的时间、空间变化规律。欧拉法的特点是在选定的空间点上观察流经它的流体质点的运动情况。

在欧拉法中，将空间点的位置坐标 :math:`(x,y,z)` 和时间 :math:`t` 称为 **欧拉变量** ，通过建立定义在某空间和空间域上的流速矢量场

.. math::
	\begin{align}
	\mathbf{U}=\mathbf{U}(x,y,z,t)
	\end{align}

来描述流体的运动。流速 :math:`\mathbf{U}(x,y,z,t)` 是在 :math:`t` 时刻占据空间点 :math:`(x,y,z)` 的那个流体质点的速度矢量。流体的其他运动要素和物理特性也都可以用相应的时间和空间域上场的形式来表达。

也可以这样来理解欧拉法：将时间看作参数，先取定 :math:`t` ，让 :math:`(x,y,z)` 变化，表示在同一瞬时观察流场的空间变化情况；然后再变动 :math:`t` 的取值，从而获得流动随时间和空间的变化规律。如果流场中物理量的空间分布不随时间变化，其欧拉表达式中将不含时间 :math:`t` ，这样的流场称为恒定流。



流体质点的加速度、物质导数
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

速度是同一流体质点的位移对时间的变化率，加速度则是同一流体质点的速度对时间的变化率，这个过程必须跟定流体质点，也即在拉格朗日观点下进行。

如果流动是用拉格朗日法进行描述的，流体质点速度和加速度只需要将位移矢量直接对时间求一、二阶导数即可（求导时 :math:`a,b,c` 作为参数不变，表示跟定流体质点）：

.. math::
	\begin{align}
	& \mathbf{U}(a,b,c,t) = \frac{\mathrm{d}\mathbf{r}(a,b,c,t)}{\mathrm{d}t}=\frac{\partial \mathbf{r}(a,b,c,t)}{\partial t}  \\
	& \mathbf{a}(a,b,c,t) = \frac{\mathrm{d}\mathbf{U}(a,b,c,t)}{\mathrm{d}t}=\frac{\partial \mathbf{U}(a,b,c,t)}{\partial t} =\frac{\partial^{2} \mathbf{r}(a,b,c,t)}{\partial t^{2}}  
	\end{align}

而如果流动是用欧拉法进行描述的，由于求加速度需要跟定流体质点，此时 :math:`x,y,z` 是流体质点在运动过程中先后经过的位置，也就成为了 :math:`t` 的函数，所以该流体质点的速度应该写成

.. math::
	\begin{align}
	\mathbf{U}=\mathbf{U}\big(x(t),y(t),z(t),t\big)
	\end{align}

其中位置坐标 :math:`x,y,z` 对 :math:`t` 的导数等于对应速度矢量的分量。质点加速度是质点速度对时间的全导数，根据复合函数求导法则可以得到

.. math::
	\begin{align}
	\mathbf{a} = \frac{\mathrm{d} \mathbf{U}}{\mathrm{d} t}
	= \frac{\partial \mathbf{U}}{\partial t} + \frac{\partial \mathbf{U}}{\partial x}\frac{\mathrm{d} x}{\mathrm{d} t} +\frac{\partial \mathbf{U}}{\partial y}\frac{\mathrm{d} y}{\mathrm{d} t}+\frac{\partial \mathbf{U}}{\partial z} \frac{\mathrm{d} z}{\mathrm{d} t} 
	=\frac{\partial \mathbf{U}}{\partial t}+u_{x}\frac{\partial \mathbf{U}}{\partial x}+u_{y}\frac{\partial \mathbf{U}}{\partial y} +u_{z}\frac{\partial \mathbf{U}}{\partial z}       
	\end{align}

也即

.. math::
	\begin{align}
	\mathbf{a} = \frac{\partial \mathbf{U}}{\partial t} + (\mathbf{U} \cdot \nabla)\mathbf{U}
	\end{align}

可以看到，在欧拉法中质点加速度 :math:`\frac{\mathrm{d} \mathbf{U}}{\mathrm{d} t}` 由两部分组成： :math:`\frac{\partial \mathbf{U}}{\partial t}` 为固定空间点，由时间变化引起的加速度，称为 **时变加速度** ； :math:`(\mathbf{U} \cdot \nabla)\mathbf{U}` 为同一时刻，由流场的空间位置变化引起的加速度，称为 **位变加速度** 。

其他定义在流体质点上的物理量对时间的导数，也可以用相同的求法。因此可以把

.. math::
	\begin{align}
	\frac{\mathrm{D} }{\mathrm{D} t} \equiv \Big( \frac{\partial }{\partial t} +\mathbf{U}\cdot \nabla \Big)
	\end{align}

看作是一个算子，表示求 **物质导数** （material derivative）， :math:`\frac{\partial }{\partial t}` 表示求 **时变导数** （当地导数或局部导数）， :math:`\mathbf{U}\cdot \nabla` 表示 **位变导数** （迁移导数或对流导数）。

.. note:: 时变导数是由流场随时间变化的不恒定性引起的，而位变导数是由流场随空间变化的不均匀性引起的。



雷诺输运理论（Reynolds Transport Theorem）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

推导过程中规定的记号如下：

+------------------------+---------------------------------------------------------------------------------------+
| 符号                   | 含义                                                                                  |
+========================+=======================================================================================+
| :math:`B`              | 流体的任意物理属性（如质量、动量或能量等）                                            |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`b`              | 单位质量的流体所具有的 :math:`B` 的大小，即 :math:`b=\frac{\mathrm{d}B}{\mathrm{d}m}` |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`V(t)`           | 控制体的控制体积                                                                      |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`\mathbf{U}`     | 流体的流速                                                                            |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`\mathbf{U}_{s}` | 控制体表面的变形速度                                                                  |
+------------------------+---------------------------------------------------------------------------------------+
| :math:`\mathbf{U}_{r}` | 流体流入或流出控制体的相对速度，即 :math:`\mathbf{U}_{r}=\mathbf{U}-\mathbf{U}_{s}`   |
+------------------------+---------------------------------------------------------------------------------------+




雷诺输运理论指出，控制体内 :math:`B` 随时间的变化率满足

.. math::
	\begin{align}
	\Big(\frac{\mathrm{d}B}{\mathrm{d}t}\Big)_{MV}
	= \frac{\mathrm{d}}{\mathrm{d}t}\Big( \int_{V(t)}\rho b~\mathrm{d}V\Big)
	+ \int_{\partial V(t)}\rho b \mathbf{U}_{r}\cdot \mathrm{d}\mathbf{S}
	\end{align}


对于一个固定的控制体，它的变形速度为 :math:`\mathbf{U}_{s}=\mathbf{0}` ，并且其体积也将独立于时间 :math:`t` ，于是

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}t}\Big( \int_{V(t)}\rho b~\mathrm{d}V\Big)
	= \int_{V}\frac{\partial }{\partial t}(\rho b)\mathrm{d}V  
	\end{align}

.. math::
	\begin{align}
	\int_{\partial V(t)}\rho b \mathbf{U}_{r}\cdot \mathrm{d}\mathbf{S}
	= \int_{\partial V}\rho b \mathbf{U}\cdot \mathrm{d}\mathbf{S}
	= \int_{V}\nabla \cdot (\rho\mathbf{U}b)~\mathrm{d}V 
	\end{align}

综上即可得到

.. math::
	\begin{align}
	\Big(\frac{\mathrm{d}B}{\mathrm{d}t}\Big)_{MV}
	= \int_{V}\Big(\frac{\partial }{\partial t}(\rho b) + \nabla \cdot (\rho\mathbf{U}b)\Big)\mathrm{d}V
	\end{align}

同时还可以改写成包含物质导数的形式：

.. math::
	\begin{align}
	\Big(\frac{\mathrm{d}B}{\mathrm{d}t}\Big)_{MV}
	= \int_{V}\Big(\frac{D }{D t}(\rho b) + \rho b\nabla \cdot \mathbf{U}\Big)\mathrm{d}V
	\end{align}





有关流场的几个基本概念
------------------------

+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 概念     | 定义                                                                                               | 备注                                                                                                                                           |
+==========+====================================================================================================+================================================================================================================================================+
| 恒定流   | 流场中各空间点上的任何运动要素不随时间变化的流动                                                   | 物理量是空间位置的函数，时变导数为零                                                                                                           |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 非恒定流 | 流场中各空间点上的运动要素随时间变化的流动                                                         | 时变导数不为零                                                                                                                                 |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 迹线     | 流体质点运动的轨迹                                                                                 | 迹线微分方程为 :math:`\mathrm{d}\mathbf{r} = \mathbf{U}\big(x(t),y(t),z(t),t\big)\mathrm{d}t`                                                  |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 流线     | 流速场的矢量线，是某瞬时对应的流场中的一条曲线，该瞬时位于曲线上的流体质点的速度矢量都和该曲线相切 | 流线微分方程为 :math:`\frac{\mathrm{d} x}{u_{x}(x,y,z,t)} = \frac{\mathrm{d} y}{u_{y}(x,y,z,t)}=\frac{\mathrm{d} z}{\mathrm{u}_{z} (x,y,z,t)}` |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 过流断面 | 与流动方向正交的流管横断面                                                                         |                                                                                                                                                |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 均匀流   | 位变加速度为零，即 :math:`(\mathbf{U} \cdot \nabla )\mathbf{U}=0` 的流场中的流动                   | 沿着流线速度大小和方向均不变，其流线一定是相互平行的直线                                                                                       |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 非均匀流 | 位变加速度不为零的流场中的流动                                                                     | 其流线要么是曲线，要么是不相平行的直线                                                                                                         |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 渐变流   | 接近于均匀流的流动                                                                                 | 流线虽不平行但夹角较小，或者流线虽有弯曲但曲率较小                                                                                             |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| 急变流   | 位变加速度非常大的流动                                                                             | 流线间夹角较大，或者流线弯曲的曲率较大                                                                                                         |
+----------+----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+


恒定流与非恒定流
^^^^^^^^^^^^^^^^^^

若流场中各空间点上的任何运动要素不随时间变化，称流动为 **恒定流** ，否则称为 **非恒定流** 。在恒定流中，所有物理量的欧拉表达式中将不含时间，它们只是空间位置坐标的函数，时变导数为零，如恒定流的速度场、压力场、密度场：

.. math::
	\begin{align}
	\mathbf{U}=\mathbf{U}(x,y,z), \qquad p=p(x,y,z), \qquad \rho=\rho(x,y,z)
	\end{align}

.. math::
	\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} =0, \qquad \frac{\partial p}{\partial t}=0, \qquad \frac{\partial \rho}{\partial t}=0  
	\end{align}


.. note:: 实际工程中，多数系统在正常运行时，其中的流动参数不随时间变化，或随时间变化缓慢，可以作为恒定流处理。




迹线和流线
^^^^^^^^^^^^^

迹线是流体质点运动的轨迹，它是与拉格朗日观点相对应的概念。拉格朗日法中位移表达式 :math:`\mathbf{r}=\mathbf{r}(a,b,c,t)` 即为迹线的参数方程。而在欧拉观点下求迹线，因为需要跟定流体质点，此时欧拉变数 :math:`x,y,z` 成为 :math:`t` 的函数，所以迹线的微分方程为

.. math::
	\begin{align}
	\mathrm{d}\mathbf{r} = \mathbf{U}\big(x(t),y(t),z(t),t\big)\mathrm{d}t 
	\end{align}

这是由三个一阶常微分方程组成的方程组，未知变量为质点位置坐标 :math:`(x,y,z)` ，它是 :math:`t` 的函数。给定初始时刻质点的位置坐标，就可以积分得到迹线。


流线是流速场的矢量线，是某瞬时对应的流场中的一条曲线，该瞬时位于曲线上的流体质点的速度矢量都和该曲线相切。流线是与欧拉观点相对应的概念，可以形象化地描绘流场的空间分布。

在流线上某点取微元矢量 :math:`\mathrm{d}\mathbf{l}=\mathrm{d}x\mathbf{i}+\mathrm{d}y\mathbf{j}+\mathrm{d}z\mathbf{k}` ，根据定义，它应该与该点的速度矢量方向一致，所以

.. math::
	\begin{align}
	\mathbf{U} \times \mathrm{d}\mathbf{l} = 0
	\end{align}

也即

.. math::
	\begin{align}
	\frac{\mathrm{d} x}{u_{x}(x,y,z,t)} = \frac{\mathrm{d} y}{u_{y}(x,y,z,t)}=\frac{\mathrm{d} z}{\mathrm{u}_{z} (x,y,z,t)}   
	\end{align}

这就是直角坐标系中的流线微分方程。它包含两个独立方程，其中 :math:`t` 是参数。求解流线微分方程可以得到两族曲面，它们的交线就是流线族。


对于二维极坐标下的流动，速度表示为 :math:`u(r,\theta)` ，具有沿径向的分量 :math:`u_{r}` 以及沿圆周切向的分量 :math:`u_{\theta}` ，则其流线微分方程为

.. math::
	\begin{align}
	\frac{\mathrm{d} r}{u_{r}} = \frac{r\mathrm{d} \theta}{u_{\theta}}
	\end{align}


.. note:: 根据流线的定义可以推断：一般情况下，流线不能相交也不能转折。流线只在一些特殊点相交，如流速为零的点（驻点）、流速无穷大的点（奇点）以及流线相切点。在非恒定流情况下，流线一般会随时间变化；在恒定流情况下，流线不随时间变化，流体质点将沿着流线走，迹线与流线重合。








流管和流量
^^^^^^^^^^^^^

在流场中，取一条不与流线重合的封闭曲线 :math:`L` ，在同一时刻过 :math:`L` 上每一点作流线，由这些流线围成的管状曲面称为流管。这是一个瞬时概念，且在对应瞬时，流体不可能通过流管表面流出或流入。

与流动方向正交的流管横断面称为 **过流断面** 。过流断面为面积微元的流管称为 **元流管** ，其中的流称为 **元流** 。过流断面为有限面积的流管中的流动称为 **总流** 。总流可以看作是无数个元流的集合。总流的过流断面一般为曲面。

通过流场中某曲面 :math:`A` 的流速通量

.. math::
	\begin{align}
	Q_{A} = \iint\limits_{A}\mathbf{U} \cdot \mathbf{n}~\mathrm{d}A 
	\end{align}

称为 **流量** 。其中 :math:`\mathbf{U}` 是曲面 :math:`A` 上各点的流速矢量， :math:`\mathbf{n}` 是单位法线矢量。 :math:`Q` 的物理意义是单位时间通过该曲面的流体体积，所以也称为 **体积流量** ，单位为 :math:`\mathrm{m^{3}/s}` 。类似可以定义 **质量流量** （单位为 :math:`\mathrm{kg/s}` ）：

.. math::
	\begin{align}
	Q_{m} = \iint\limits_{A}\rho\mathbf{U}\cdot \mathbf{n}~\mathrm{d}A
	\end{align}


.. note:: 流量计算中曲面 :math:`A` 的法线指向必须明确，指向相反流量将反号。闭曲面的法向一般指所围区域的外法向。


总流过流断面上的流速与法向一致，所以通过过流断面 :math:`A` 的流量大小为 :math:`Q=\iint\limits_{A}u~\mathrm{d}A` ，其中 :math:`u` 为流速的大小。定义体积流量与断面面积之比

.. math::
	\begin{align}
	v = \frac{Q}{A} = \frac{\iint_{A}\mathbf{U}\cdot \mathbf{n}~\mathrm{d}A}{A}
	\end{align}

为断面平均流速。它是过流断面上不均匀流速 :math:`u` 的一个平均值，假设过流断面上各点流速大小均等于 :math:`v` ，方向与实际流动方向相同，则通过的流量与以不均匀流速 :math:`u` 流过此断面的实际流量相等。





均匀流、非均匀流；渐变流、急变流
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


将位变导数为零的流场中的流动称为 **均匀流** ，否则称为 **非均匀流** 。均匀流的位变加速度 :math:`(\mathbf{U} \cdot \nabla)\mathbf{U} = 0` ，速度矢量沿着流线不变。均匀流的流线一定是相互平行的直线，而非均匀流的流线要么是曲线，要么是不相平行的直线。

.. note:: 恒定均匀流的时变加速度和位变加速度都为零，即流体质点的惯性力为零，将作匀速直线运动。若总流为均匀流，那么其过流面是平面。

由于均匀流是一个绝对的概念，在工程实际中其判别标准难以完全满足，所以将接近于均匀流的流动称为 **渐变流** 。渐变流是流线虽然不平行但是夹角较小，或者流线虽有弯曲但是曲率较小的流动。反之，流线间夹角较大或流线弯曲的曲率较大的流动为 **急变流** 。


系统和控制体
^^^^^^^^^^^^^^^

由确定的流体质点组成的集合称为 **系统** 。系统在运动过程中，其空间位置、体积、形状都会随时间变化，但与外界没有物质交换。有限体积的系统叫做流体团；微分体积的系统叫做 **流体微团** ，指从有限体积的运动流体团中隔离出来的，在空间只占据一个体积微元、具有线性尺度效应的流体团；最小的系统时流体质点，它没有体积，仅占据一个空间点。

有流体流过的固定不变的空间区域称为 **控制体** ，其边界叫做控制面。不同的时间控制体将被不同的系统所占据。按大小可以划分为有限体积控制体、微元控制体和场点，它们可以分别被流体团、流体微团和流体质点所占据。

站在系统的角度观察和描述流体的运动及物理量的变化是拉格朗日方法的特征；而站在控制体的角度观察和描述流体的运动及物理量的变化是欧拉方法的特征。





流体微团运动的分析
--------------------

亥姆霍兹速度分解定理
^^^^^^^^^^^^^^^^^^^^^^

先对流体微团内一点 :math:`\hat{M}(x+\mathrm{d}x,y+\mathrm{d}y,z+\mathrm{d}z)` 的流速分量 :math:`\hat{u}_{x}` 以邻近点 :math:`M(x,y,z)` 为基点作如下一阶泰勒展开：

.. math::
	\begin{align}
	\hat{u}_{x} &\approx u_{x} + \frac{\partial u_{x}}{\partial x}\mathrm{d}x + \frac{\partial u_{x}}{\partial y}\mathrm{d}y + \frac{\partial u_{x}}{\partial z}\mathrm{d}z  \\
	&= u_{x} + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial x}+\frac{\partial u_{x}}{\partial x} \Big)\mathrm{d}x 
	         + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y}+\frac{\partial u_{y}}{\partial x} \Big)\mathrm{d}y
	         + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z}+\frac{\partial u_{z}}{\partial x} \Big)\mathrm{d}z
	         + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y}-\frac{\partial u_{y}}{\partial x} \Big)\mathrm{d}y
	         + \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z}-\frac{\partial u_{z}}{\partial x} \Big)\mathrm{d}z  
	\end{align}

采用符号

.. math::
	\begin{align}
	& \varepsilon_{xx}=\frac{1}{2}\Big( \frac{\partial u_{x}}{\partial x}+\frac{\partial u_{x}}{\partial x} \Big)
	&& \varepsilon_{xy}=\frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y}+\frac{\partial u_{y}}{\partial x} \Big)
	&&& \varepsilon_{xz}=\frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z}+\frac{\partial u_{z}}{\partial x} \Big)
	\end{align}

.. math::
	\begin{align}
	& \omega_{x}=\frac{1}{2}\Big( \frac{\partial u_{z}}{\partial y} - \frac{\partial u_{y}}{\partial z} \Big) 
	&& \omega_{y}=\frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z} - \frac{\partial u_{z}}{\partial x} \Big) 
	&&& \omega_{z}=\frac{1}{2}\Big( \frac{\partial u_{y}}{\partial x} - \frac{\partial u_{x}}{\partial y}  \Big)
	\end{align}

则原式可以改写成

.. math::
	\begin{align}
	\hat{u}_{x}=u_{x} + \varepsilon_{xx}\mathrm{d}x + \varepsilon_{xy}\mathrm{d}y + \varepsilon _{xz}\mathrm{d}z - \omega_{z}\mathrm{d}y + \omega_{y}\mathrm{d}z 
	\end{align}

上式等号右边各项均为在基点 :math:`M` 处取值。同理可以得到另外两个分量的表达式：

.. math::
	\begin{align}
	& \hat{u}_{y} = u_{y} + \varepsilon_{yx}\mathrm{d}x + \varepsilon_{yy}\mathrm{d}y + \varepsilon_{yz}\mathrm{d}z - \omega_{x}\mathrm{d}z + \omega_{z}\mathrm{d}x  \\
	& \hat{u}_{z} = u_{z} + \varepsilon_{zx}\mathrm{d}x + \varepsilon_{zy}\mathrm{d}y + \varepsilon_{zz}\mathrm{d}z - \omega_{y}\mathrm{d}x + \omega_{x}\mathrm{d}y
	\end{align}


再合并成矢量表达式得到流体微元中任意两点间速度关系的一般形式，即 **亥姆霍兹速度分解定理** ：

.. math::
	\begin{align}
	\hat{\mathbf{U}} = \mathbf{U} + \boldsymbol{\varepsilon} \cdot \mathrm{d}\mathbf{r} + \boldsymbol{\omega} \times \mathrm{d}\mathbf{r}
	\end{align}

其中 **流体的变形速率张量** :math:`\boldsymbol{\varepsilon}` 为

.. math::
	\begin{align}
	\boldsymbol{\varepsilon}=
	\begin{bmatrix}
	 \varepsilon_{xx} & \varepsilon_{xy} & \varepsilon_{xz} \\
	 \varepsilon_{yx} & \varepsilon_{yy} & \varepsilon_{yz} \\
	 \varepsilon_{zx} & \varepsilon_{zy} & \varepsilon_{zz}
	\end{bmatrix} =
	\begin{bmatrix}
	 \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial x}+\frac{\partial u_{x}}{\partial x} \Big) &
	 \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y}+\frac{\partial u_{y}}{\partial x} \Big) & 
	 \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z}+\frac{\partial u_{z}}{\partial x} \Big) \\
	 \frac{1}{2}\Big( \frac{\partial u_{y}}{\partial x}+\frac{\partial u_{x}}{\partial y} \Big)  &
	 \frac{1}{2}\Big( \frac{\partial u_{y}}{\partial y}+\frac{\partial u_{y}}{\partial y} \Big)  &
	 \frac{1}{2}\Big( \frac{\partial u_{y}}{\partial z}+\frac{\partial u_{z}}{\partial y} \Big)  \\
	 \frac{1}{2}\Big( \frac{\partial u_{z}}{\partial x}+\frac{\partial u_{x}}{\partial z} \Big)  &
	 \frac{1}{2}\Big( \frac{\partial u_{z}}{\partial y}+\frac{\partial u_{y}}{\partial z} \Big)  &
	 \frac{1}{2}\Big( \frac{\partial u_{z}}{\partial z}+\frac{\partial u_{z}}{\partial z} \Big)
	\end{bmatrix}
	\end{align}

**流体的平均旋转角速度矢量** :math:`\boldsymbol{\omega}` 为

.. math::
	\begin{align}
	\boldsymbol{\omega} = (\omega_{x},\omega_{y},\omega_{z})
	= \Big[ 
	  \frac{1}{2}\Big( \frac{\partial u_{z}}{\partial y} - \frac{\partial u_{y}}{\partial z} \Big),
	  \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial z} - \frac{\partial u_{z}}{\partial x} \Big),
	  \frac{1}{2}\Big( \frac{\partial u_{y}}{\partial x} - \frac{\partial u_{x}}{\partial y} \Big)
	  \Big]
	\end{align}


.. note:: 

	容易发现，变形速度张量满足 :math:`\varepsilon_{xy}=\varepsilon_{yx},\varepsilon_{xz}=\varepsilon_{zx},\varepsilon_{yz}=\varepsilon_{zy}` ，所以它是一个二阶对称张量，主对角线上三个元素是 **线变形速率** ，其余的是 **角变形速率** 。同时可以发现，变形速率张量可以用流速场的梯度来表示，即 :math:`\boldsymbol{\varepsilon}=\frac{1}{2}\big(\nabla\mathbf{U} + (\nabla\mathbf{U})^{T}\big)` 。

	旋转角速度矢量恰好是流速场旋度矢量的一半，即 :math:`\boldsymbol{\omega} = \frac{1}{2} \nabla \times \mathbf{U}` 。

	于是亥姆霍兹速度分解定理还可以如下表述：

	.. math::
		\begin{align}
		\hat{\mathbf{U}} = \mathbf{U} + \frac{1}{2}\big(\nabla\mathbf{U} + (\nabla\mathbf{U})^{T}\big)\cdot \mathrm{d}\mathbf{r} + \frac{1}{2}(\nabla\times \mathbf{U}) \times\mathrm{d}\mathbf{r}   
		\end{align}


- :math:`\hat{\mathbf{U}}` 是 :math:`\hat{M}` 点的流速；
- :math:`\mathbf{U}` 是 :math:`M` 点的流速，代表随基点的平移；
- :math:`\boldsymbol{\varepsilon}\cdot \mathrm{d}\mathbf{r}` 是流体变形引起的两点相对运动速度，包括线变形和角变形，代表变形运动；
- :math:`\boldsymbol{\omega}\times\mathrm{d}\mathbf{r}` 是流体平均旋转角速度引起的两点相对运动速度，代表绕基点的转动。



有旋流动和无旋流动
^^^^^^^^^^^^^^^^^^^^^

判断流动是否无旋的充分必要条件是流体的平均旋转角速度矢量 :math:`\boldsymbol{\omega}` 或旋度矢量 :math:`\nabla \times \mathbf{U}` 是否为零。把 :math:`\boldsymbol{\omega}=0` 或 :math:`\nabla \times \mathbf{U}=0` 的流动称为 **无旋流动** ，否则称为 **有旋流动** 。

注意到无旋流动的流速场条件 :math:`\nabla \times \mathbf{U}=0` 写成分量形式满足

.. math::
	\begin{align}
	\frac{\partial u_{z}}{\partial y}=\frac{\partial u_{y}}{\partial z}, \quad \frac{\partial u_{x}}{\partial z}=\frac{\partial u_{z}}{\partial x}, \quad \frac{\partial u_{y}}{\partial x}=\frac{\partial u_{x}}{\partial y}      
	\end{align}

上式是使 :math:`u_{x}\mathrm{d}x+u_{y}\mathrm{d}y+u_{z}\mathrm{d}z` 成为某个函数 :math:`\varphi` 的全微分的充分必要条件，因此无旋流动必然存在一个标量场 :math:`\varphi(x,y,z)` ，它与速度场之间满足关系：

.. math::
	\begin{align}
	\nabla \varphi = \mathbf{U}
	\end{align}

该标量场称为 **流速场的势函数** ，简称 **速度势** 。存在速度势是有势流动区别于有旋流动的基本特征，因为速度势的梯度就是流速矢量，所以用求解标量场 :math:`\varphi` 代替求解矢量场 :math:`\mathbf{U}` 可以大大简化分析过程。

.. attention:: 有旋流动和有势流动的判别仅在于流速场的旋度是否为零，不涉及流动是恒定还是非恒定，是均匀流还是非均匀流，也不涉及流线是直线还是曲线。






连续性方程
-------------


微分形式的连续性方程
^^^^^^^^^^^^^^^^^^^^^^^^

接下来从空间位置固定的无穷小微团角度出发来推导连续性方程。欧拉观点下，质量守恒意味着固定无穷小微团质量的变化=流入无穷小微团质量-流出无穷小微团质量，也即位置固定无穷小微团质量的变化率=(流入无穷小微团质量-流出无穷小微团质量)的变化率。

流体微团的体积可以表示为 :math:`\mathrm{d}V=\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，结合密度 :math:`\rho` 则得到对应的无穷小微团质量为 :math:`\mathrm{d}m=\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z` 。根据质量变化率的定义，其可以表示为

.. math::
	\begin{align}
	\frac{\partial \mathrm{d}m }{\partial t}=\frac{\partial \rho \mathrm{d}x\mathrm{d}y\mathrm{d}z }{\partial t}=\frac{\partial \rho}{\partial t}\mathrm{d}x\mathrm{d}y\mathrm{d}z   
	\end{align}

下面考虑笛卡尔坐标系下无穷小微团的流入和流出。先说明 :math:`x` 方向上的通量。定义无穷小微团立方体左侧单位面积的质量为 :math:`\rho u` ，同时也是单位时间内流入单位面积的质量，而立方体左侧的面积为 :math:`\mathrm{d}y\mathrm{d}z` ，因此得到单位时间内流入的质量为 :math:`\rho u\mathrm{d}y\mathrm{d}z` 。对于立方体右侧的面，在已知立方体左侧面 :math:`\rho u` 的定义的时候，可以通过泰勒公式求出单位时间内流出立方体右侧的单位面积的质量为 :math:`\rho u+\frac{\partial \rho u}{\partial x}\mathrm{d}x` 。同样的，立方体右侧面的面积为 :math:`\mathrm{d}y\mathrm{d}z` ，因此有单位时间内流出的质量约为

.. math::
	\begin{align}
	\left ( \rho u + \frac{\partial \rho u}{\partial x} \mathrm{d}x \right ) \mathrm{d}y\mathrm{d}z  
	\end{align}

.. note:: 
	
	这里利用的是带步长表示的泰勒公式，即对于一个函数， :math:`x_{0}` 点的值为 :math:`f(x_{0})` ，那么函数在 :math:`x_{0}+h` 的值通过下面方程求得

	.. math::
		\begin{align}
		f(x_{0}+h)=f(x_{0})+f'(x_{0})h+O(h)\approx f(x_{0})+f'(x_{0})h
		\end{align}

	在上述推导的情景中， :math:`h` 为 :math:`dx` ，求导操作变为 :math:`\rho u` 在 :math:`x` 方向的偏导。因为忽略了无穷小量 :math:`O(h)` ，所以结果是约等于。

.. attention:: 因为使用了泰勒公式，假定了函数是连续可微的，然而当存在激波之类的问题时该假定不成立，这种情况下需要从积分的角度来推导连续性方程。


结合无穷小微团单位时间的流出质量和无穷小单位时间的流入质量，就可以得到单位时间内 :math:`x` 方向的净质量变化率为

.. math::
	\begin{align}
	\rho u\mathrm{d}y\mathrm{d}z - \left ( \rho u + \frac{\partial \rho u}{\partial x}\mathrm{d}x\right ) \mathrm{d}y\mathrm{d}z = -\frac{\partial \rho u}{\partial x}\mathrm{d}x\mathrm{d}y\mathrm{d}z  
	\end{align}

同理可以得到 :math:`y` 方向的净质量变化率为 :math:`-\frac{\partial \rho v}{\partial y}\mathrm{d}x\mathrm{d}y\mathrm{d}z` ， :math:`z` 方向的净质量变化率为 :math:`-\frac{\partial \rho w}{\partial z}\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，将各个方向的质量变化率加起来就得到总质量变化率为 :math:`-\left ( \frac{\partial \rho u}{\partial x} + \frac{\partial \rho v}{\partial y} + \frac{\partial \rho w}{\partial z}  \right )\mathrm{d}x\mathrm{d}y\mathrm{d}z` 。回到最开始质量变化率的定义，即可得到连续性方程：

.. math::
	\begin{align}
	\frac{\partial \rho}{\partial t}\mathrm{d}x\mathrm{d}y\mathrm{d}z = -\left ( \frac{\partial \rho u}{\partial x} + \frac{\partial \rho v}{\partial y} + \frac{\partial \rho w}{\partial z}  \right )\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\quad \Rightarrow \quad 
	\frac{\partial \rho}{\partial t} + \frac{\partial \rho u}{\partial x} + \frac{\partial \rho v}{\partial y} + \frac{\partial \rho w}{\partial z} =0
	\end{align}

也即

.. math::
	\begin{align}
	\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho\mathbf{U})=0 
	\end{align}


.. note:: 

	对于恒定流，由于 :math:`\frac{\partial \rho}{\partial t}=0` ，所以连续性方程化简为

	.. math::
		\begin{align}
		\nabla \cdot (\rho\mathbf{U})=0
		\end{align}

	对于不可压缩流体的流动（不管是恒定或非恒定），则有

	.. math::
		\begin{align}
		\nabla \cdot \mathbf{U} = 0
		\end{align}

	上式表示速度场的散度为零，称这样的速度场是无源场或管形场。

.. note:: 速度场的散度是流体微团在三个互相垂直方向上的线变形速率之和，也是流体微团的体积膨胀率。连续性方程表明不可压缩流体微团在三个互相垂直方向上的线变形速率的总和必须为零，如果在一个方向上有拉伸，则必定有另一个方向上的压缩，在运动过程中其体积不会发生变化。







积分形式的连续性方程
^^^^^^^^^^^^^^^^^^^^^^^^

下面考虑从空间位置固定的有限控制体推导连续性方程。有限控制体和无穷小微团的关系可以理解为，有限控制体包含着很多的无穷小微团，因此有限控制体中的量都需要用积分来进行计算。对于空间位置固定的有限控制体，其质量为 :math:`\int \rho~\mathrm{d}V` ，则对应的质量变化率为 :math:`\frac{\partial }{\partial t}\int \rho~\mathrm{d}V` 。在有限控制体表面上的面微元的通量可以定义为 :math:`\rho \boldsymbol{U}\cdot \mathrm{d}\boldsymbol{S}` ，那么整个有限控制体的净通量可以表示为 :math:`-\int_{\boldsymbol{S}}\rho \boldsymbol{U}\cdot \mathrm{d}\boldsymbol{S}` ，从而就有

.. math::
	\begin{align}
	\frac{\partial }{\partial t}\int _{V}\rho~\mathrm{d}V + \int_{\boldsymbol{S}}\rho\boldsymbol{U}\cdot\mathrm{d}\boldsymbol{S}=0  
	\end{align}

.. note:: 封闭面的面矢量 :math:`\boldsymbol{S}` 一般指向外部，因此考虑到需要的是流入减去流出的通量，所以净通量在表示的时候引入了负号。

假定函数是光滑连续的，则使用高斯定律，上述方程就可以化简为

.. math::
	\begin{align}
	\frac{\partial \rho}{\partial t}+\nabla \cdot \rho \boldsymbol{U}=0
	\end{align}


此外，对原积分形式连续性方程对时间做积分，就得到另一种积分形式的连续性方程：

.. math::
	\begin{align}
	\int_{t}^{t+\Delta t}\frac{\partial }{\partial t}\int_{V}\rho~\mathrm{d}V\mathrm{d}\tau + \int_{t}^{t+\Delta t}\int_{\boldsymbol{S}}\rho\boldsymbol{U}\cdot\mathrm{d}\boldsymbol{S}\mathrm{d}\tau=0
	\end{align}

.. math::
	\begin{align}
	\int_{V}\rho(t+\Delta t)\mathrm{d}V-\int_{V}\rho(t)\mathrm{d}V=-\int_{t}^{t+\Delta t}\left ( \int_{\boldsymbol{S}}\rho(\tau)\boldsymbol{U}(\tau)\cdot \mathrm{d}\boldsymbol{S}  \right )\mathrm{d}\tau 
	\end{align}

上述方程左侧表示在体积 :math:`V` 上时间间隔 :math:`\Delta t` 上质量的变化；右侧则考虑通量的变化形式，同样表示体积 :math:`V` 上时间间隔 :math:`\Delta t` 上质量的变化。如果知道右侧 :math:`\rho(t')\boldsymbol{U}(t')` 的精确值，那么结果就是精确的。该方程主要用于双曲系统来推导高阶通量格式，例如HLL格式，其通过 :math:`V` 将黎曼扇区域进行包围并假定 :math:`\rho(t')\boldsymbol{U}(t')` 的近似值即可获得网格面上的通量。



恒定总流的连续性方程
^^^^^^^^^^^^^^^^^^^^^^^

在恒定总流中取出一段上游过流断面 :math:`A_{1}` 和下游过流断面 :math:`A_{2}` 之间的总流管作为控制体，考察流经其中的恒定总流。在恒定条件下，总流管的形状、位置不随时间变化。总流内的流体是不存在空隙的连续介质，其密度分布恒定，所以这段总流管内的流体质量也不随时间变化。没有流体通过总流管侧壁流入或流出，流体只能通过两个过流断面进出控制体。

根据质量守恒，在单位时间内通过 :math:`A_{1}` 流入控制体的流体质量等于通过 :math:`A_{2}` 流出控制体的流体质量，即

.. math::
	\begin{align}
	\iint\limits_{A_{1}}\rho u~\mathrm{d}A=\iint\limits_{A_{2}}\rho u~\mathrm{d}A  
	\end{align}

这就是恒定条件下 **总流的连续方程** ，表明通过恒定总流两个过流断面的质量流量相等。

如果流体不可压，则 :math:`\rho=\text{const}` ，从而

.. math::
	\begin{align}
	\iint\limits_{A_{1}}u~\mathrm{d}A=\iint\limits_{A_{2}}u~\mathrm{d}A  
	\quad\Rightarrow \quad 
	Q_{1}=Q_{2}  
	\quad \text{or} \quad 
	A_{1}v_{1}=A_{2}v_{2} 
	\end{align}

也即通过两个过流断面的体积流量相等，称为 **不可压缩流体恒定总流的连续方程** 。可以看到，在同一恒定流股中，当沿流程过流断面发生变化时，流速也必定随之变化，并且符合断面平均流速与过流断面面积成反比的关系。断面大的地方流速小，断面小的地方流速大。或者说流线密集的地方流速大，流线稀疏的地方流速小。





流体动力学
================

运动流体的应力状态
---------------------

在运动中的流体中，既可能有压应力又可能有切应力。把流体在运动状态下的压应力称为 **流体动压强** 。在运动的理想流体里，由于没有粘滞性的作用，虽然有质点的相对运动，也不会产生切应力，因此在运动的流体中只有流体动压强，而且可以用分析流体静压强特性的方法推论：任一点的流体动压强在各方向上的大小都相等，和流体静压强有同样的特性。

在运动的实际流体中，取一个流体微团来分析它的应力效应，由于粘滞性作用，既有压应力又有切应力。任一点处的应力是矢量，而且还与作用面方向有关，可以用二阶张量来表示：

.. math::
	\begin{align}
	\boldsymbol{\sigma} = 
	\begin{bmatrix}
	 \sigma_{xx} & \sigma_{xy} & \sigma_{xz} \\
	 \sigma_{yx} & \sigma_{yy} & \sigma_{yz} \\
	 \sigma_{zx} & \sigma_{zy} & \sigma_{zz}
	\end{bmatrix}
	\end{align}

其中每个分量的两个角标的含义是：前一个表示作用面的法向方向；后一个表示应力分量的投影方向。

.. note:: 应力张量是对称的，因为只有其为对称的（净扭矩为零）才能防止发生旋转。

根据应力张量 :math:`\boldsymbol{\sigma}` 可以得到任意方位作用面上的应力：

.. math::
	\begin{align}
	\boldsymbol{\sigma}_{n} =  \boldsymbol{\sigma} \cdot \mathbf{n} = (\boldsymbol{\sigma}^{T})\mathbf{n} = 
	\begin{bmatrix}
	\sigma_{xx}n_{x}+\sigma_{yx}n_{y}+\sigma_{zx}n_{z} \\
	\sigma_{xy}n_{x}+\sigma_{yy}n_{y}+\sigma_{zy}n_{z} \\
	\sigma_{xz}n_{x}+\sigma_{yz}n_{y}+\sigma_{zz}n_{z}
	\end{bmatrix}
	\end{align}

现在考虑这一应力张量与某个矢量 :math:`\mathbf{n}` 作用之后能保持结果方向不变，即

.. math::
	\begin{align}
	\boldsymbol{\sigma} \cdot \mathbf{n} = \lambda \mathbf{n}
	\quad \Rightarrow \quad
	(\boldsymbol{\sigma}^{T} - \lambda \mathbf{I})\mathbf{n} = 0
	\end{align}

上式是求解 :math:`\mathbf{n}` 的线性齐次代数方程组，存在非零解的充分必要条件是系数行列式为零：

.. math::
	\begin{align}
	\begin{vmatrix}
	\sigma_{xx} - \lambda  & \sigma_{yx} & \sigma_{zx} \\
	\sigma_{xy} & \sigma_{yy} - \lambda & \sigma_{zy} \\
	\sigma_{xz} & \sigma_{yz} & \sigma_{zz} - \lambda 
	\end{vmatrix} = 0
	\quad \Rightarrow \quad
	\lambda^{3} - I_{1}\lambda^{2} + I_{2}\lambda - I_{3} = 0
	\end{align}

其中

.. math::
	\begin{align}
	& I_{1} = \operatorname{trace}(\boldsymbol{\sigma})
	= \sigma_{xx} + \sigma_{yy} + \sigma_{zz} \\
	& I_{2} = \begin{vmatrix} \sigma_{yy} & \sigma_{yz} \\ \sigma_{zy} & \sigma_{zz} \end{vmatrix} 
	+ \begin{vmatrix} \sigma_{xx} & \sigma_{xz} \\ \sigma_{zx} & \sigma_{zz} \end{vmatrix}
	+ \begin{vmatrix} \sigma_{xx} & \sigma_{xy} \\ \sigma_{yx} & \sigma_{yy} \end{vmatrix}  \\
	& I_{3} = \operatorname{det}(\boldsymbol{\sigma}) 
	= \begin{vmatrix}
	\sigma_{xx} & \sigma_{xy} & \sigma_{xz} \\
	\sigma_{yx} & \sigma_{yy} & \sigma_{yz} \\
	\sigma_{zx} & \sigma_{zy} & \sigma_{zz}
	\end{vmatrix}
	\end{align}

由于上述特征方程是与坐标轴无关的方程，所以上面的三个系数分别称为张量 :math:`\boldsymbol{\sigma}` 的第一、第二、第三不变量。可以看到，应力张量主对角线上三个元素之和 :math:`\sigma_{xx}+\sigma_{yy}+\sigma_{zz}` 是坐标变换中的不变量，即其值不随坐标轴的转动而改变，也即任意三个相互垂直的作用面上的法应力之和都是相同的，于是可以定义 **流体动压强** 为

.. math::
	\begin{align}
	p = -\frac{1}{3}(\sigma_{xx}+\sigma_{yy}+\sigma_{zz})
	\end{align}

它只取决于场点位置，而与作用面的方位无关，所以运动流体中存在一个标量场性质的动压强场。

.. attention:: 
	
	- 流体动压强 :math:`p` 并不是任意方位作用面上真正的压应力 :math:`-p_{m}` 。
	- 在理想流体中，三个方向的法向应力相等，即 :math:`\sigma_{xx}=\sigma_{yy}=\sigma_{zz}` 。
	- 虽然静压强和动压强都有着与作用面方位无关、只取决于场点位置的特点，但是它们并不能认为是相同的，因为动压强是三个方向法向应力的平均值而不是真实压强。



可以将应力张量写成

.. math::
	\begin{align}
	\boldsymbol{\sigma} = 
	\begin{bmatrix}
	 \sigma_{xx}+p & \sigma_{xy} & \sigma_{xz} \\
	 \sigma_{yx} & \sigma_{yy}+p & \sigma_{yz} \\
	 \sigma_{zx} & \sigma_{zy} & \sigma_{zz}+p
	\end{bmatrix}
	- p
	\begin{bmatrix}
	 1 & 0 & 0 \\
	 0 & 1 & 0 \\
	 0 & 0 & 1
	\end{bmatrix}
	=\boldsymbol{\tau}-p\mathbf{I}
	\end{align}

其中 :math:`\boldsymbol{\tau}` 称为 **偏应力张量** ，其主对角线上三个元素 :math:`\tau_{xx},\tau_{yy},\tau_{zz}` 称为 **粘性附加法应力** ，它们的和为零；其他则为切应力。偏应力张量完全是由粘性引起的， **理想流体的偏应力张量为零** 。

根据线性本构理论，应力张量与应变率张量间的关系是线性的，即

.. math::
	\begin{align}
	\boldsymbol{\sigma} = a\boldsymbol{\varepsilon} + b\mathbf{I}
	\end{align}

对照一维情况的牛顿摩擦定律，有

.. math::
	\begin{align}
	\sigma_{xy} = 2\mu \cdot \frac{1}{2}\Big( \frac{\partial u_{x}}{\partial y} + \frac{\partial u_{y}}{\partial x} \Big) = 2\mu\varepsilon_{xy}
	\end{align}

由此可知 :math:`a = 2\mu` 。同时，stokes假设平均压应力等于当地压强（也即假设膨胀粘度为零），于是

.. math::
	\begin{align}
	\operatorname{trace}(\boldsymbol{\sigma}) = 2\mu (\nabla\cdot\mathbf{U}) + 3b = -3p 
	\end{align}

由此可知 :math:`b = -p - \frac{2}{3}\mu(\nabla\cdot\mathbf{U})` 。代入最初的式子，得到

.. math::
	\begin{align}
	\boldsymbol{\sigma} = -p\mathbf{I} + 2\mu\varepsilon - \frac{2}{3}\mu(\nabla\cdot\mathbf{U})\mathbf{I} 
	\end{align}

也即有 **广义牛顿内摩擦定律** ：

.. math::
	\begin{align}
	\boldsymbol{\tau} = 2\mu\boldsymbol{\varepsilon} - \frac{2}{3}\mu(\nabla\cdot\mathbf{U})\mathbf{I} = \mu\big(\nabla\mathbf{U}+(\nabla\mathbf{U})^{T}\big) - \frac{2}{3}\mu(\nabla\cdot\mathbf{U})\mathbf{I} 
	\end{align}

对于不可压缩流体，由于速度场散度为零 :math:`\nabla\cdot\mathbf{U}=0` ，所以对于不可压缩流体有

.. math::
	\begin{align}
	\boldsymbol{\tau} = 2\mu\boldsymbol{\varepsilon} = \mu\big(\nabla\mathbf{U}+(\nabla\mathbf{U})^{T}\big)
	\end{align}



流体运动微分方程（动量方程）
------------------------------

根据动量守恒定律可以得到欧拉观点下的动量方程。在流场中取出一个空间六面体微元作为控制体，其边长为 :math:`\mathrm{d}x,\mathrm{d}y,\mathrm{d}z` 。首先讨论该微元内流体在x方向的受力情况，作用于六面体表面沿x方向的表面力有

- 前后一对面元法向力： :math:`-\sigma_{xx}\mathrm{d}y\mathrm{d}z + \Big( \sigma_{xx}+\frac{\partial \sigma_{xx}}{\partial x}\mathrm{d}x \Big)\mathrm{d}y\mathrm{d}z` ；
- 左右一对面切向力： :math:`-\sigma_{yx}\mathrm{d}x\mathrm{d}z + \Big( \sigma_{yx}+\frac{\partial \sigma_{yx}}{\partial y}\mathrm{d}y \Big)\mathrm{d}x\mathrm{d}z` ；
- 上下一对面切向力： :math:`-\sigma_{zx}\mathrm{d}x\mathrm{d}y + \Big( \sigma_{zx}+\frac{\partial \sigma_{zx}}{\partial z}\mathrm{d}z \Big)\mathrm{d}x\mathrm{d}y` 。
  
将上述力相加得到沿x方向的总表面力为

.. math::
	\begin{align}
	\Big( \frac{\partial \sigma_{xx}}{\partial x} + \frac{\partial \sigma_{yx}}{\partial y} + \frac{\partial \sigma_{zx}}{\partial z}\Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	= \Big( \frac{\partial (\tau_{xx}-p)}{\partial x} + \frac{\partial \tau_{yx}}{\partial y} + \frac{\partial \tau_{zx}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	= \Big( -\frac{\partial p}{\partial x} + \frac{\partial \tau_{xx}}{\partial x} +  \frac{\partial \tau_{yx}}{\partial y} + \frac{\partial \tau_{zx}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{align}

其他方向的总表面力同理，最终可以得到

.. math::
	\begin{align}
	\mathbf{F} = 
	\begin{bmatrix}
	\Big( -\frac{\partial p}{\partial x} + \frac{\partial \tau_{xx}}{\partial x} +  \frac{\partial \tau_{yx}}{\partial y} + \frac{\partial \tau_{zx}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z \\
	\Big( -\frac{\partial p}{\partial y} + \frac{\partial \tau_{xy}}{\partial x} +  \frac{\partial \tau_{yy}}{\partial y} + \frac{\partial \tau_{zy}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z \\
	\Big( -\frac{\partial p}{\partial z} + \frac{\partial \tau_{xz}}{\partial x} +  \frac{\partial \tau_{yz}}{\partial y} + \frac{\partial \tau_{zz}}{\partial z} \Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{bmatrix}
	= (-\nabla p + \nabla \cdot \boldsymbol{\tau})\mathrm{d}x\mathrm{d}y\mathrm{d}z
	\end{align}


流体微团的质量可以表示为 :math:`\mathrm{d}m=\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z` ，同时流体微团的加速度为 :math:`\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}=\frac{\partial \mathbf{U}}{\partial t}+(\mathbf{U}\cdot \nabla)\mathbf{U}` ，于是动量方程为（同时考虑质量力）：

.. math::
	\begin{align}
	(\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}=(-\nabla p + \nabla \cdot \boldsymbol{\tau})\mathrm{d}x\mathrm{d}y\mathrm{d}z + (\rho\mathrm{d}x\mathrm{d}y\mathrm{d}z)\mathbf{f}
	\end{align}

也即

.. math::
	\begin{align}
	\rho\Big(\frac{\partial \mathbf{U}}{\partial t}+\mathbf{U}\cdot\nabla\mathbf{U} \Big)=-\nabla p +\nabla\cdot \boldsymbol{\tau} +\rho\mathbf{f}
	\end{align}


上式为动量方程的非守恒形式，因为上述动量方程是从空间位置移动的无穷小微团进行推导的。非守恒控制方程可以通过结合连续性方程转化为守恒的控制方程：将连续性方程左右同时乘以 :math:`\mathbf{U}` 得到

.. math::
	\begin{align}
	\mathbf{U}\frac{\partial \rho}{\partial t}+\mathbf{U}\nabla\cdot(\rho\mathbf{U})=0
	\end{align}

与非守恒形式的动量方程相加得到

.. math::
	\begin{align}
	\mathbf{U}\frac{\partial \rho}{\partial t} + \rho\frac{\partial \mathbf{U}}{\partial t}  + \mathbf{U} \nabla \cdot (\rho\mathbf{U}) +\rho\mathbf{U}\cdot \nabla\mathbf{U}=-\nabla p+\nabla\cdot \boldsymbol{\tau}+\rho\mathbf{f}
	\end{align}

根据导数的四则运算法则和nabla算子的运算法则可以得到守恒形式的动量方程：

.. math::
	\begin{align}
	\frac{\partial \rho\mathbf{U}}{\partial t} + \nabla \cdot (\rho\mathbf{U}\mathbf{U}) = -\nabla p + \nabla\cdot \boldsymbol{\tau} + \rho\mathbf{f}
	\end{align}

.. note:: 

	也可以借助雷诺输运理论来推导出上式：

	.. math::
		\begin{align}
		\Big(\frac{\mathrm{d}(m\mathbf{U})}{\mathrm{d}t} \Big)_{MV}
		= \int_{\partial V}\boldsymbol{\sigma} \cdot \mathrm{d}\mathbf{S} + \int_{V}\rho\mathbf{f}~\mathrm{d}V  
		\end{align}

	.. math::
		\begin{align}
		\int_{V}\Big(\frac{\partial \rho\mathbf{U}}{\partial t} + \nabla\cdot(\rho\mathbf{UU}) \Big)\mathrm{d}V = \int_{V}(\nabla \cdot \boldsymbol{\sigma})~\mathrm{d}V + \int_{V}\rho \mathbf{f}~\mathrm{d}V 
		\end{align}

	.. math::
		\begin{align}
		\int_{V}\Big(\frac{\partial \rho\mathbf{U}}{\partial t} + \nabla\cdot(\rho\mathbf{UU}) \Big)\mathrm{d}V
		= \int_{V}\nabla \cdot (\boldsymbol{\tau} - p\mathbf{I})~\mathrm{d}V
		+ \int_{V}\rho\mathbf{f}~\mathrm{d}V
		= \int_{V}(-\nabla p + \nabla \cdot \boldsymbol{\tau})~\mathrm{d}V
		+ \int_{V}\rho\mathbf{f}~\mathrm{d}V
		\end{align}


考虑不可压缩牛顿流体，将广义牛顿内摩擦定律代入上式，并且由于不可压缩密度恒定为常量可以在等式两边同除，得到

.. math::
	\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} + \nabla\cdot(\mathbf{U}\mathbf{U}) = -\frac{1}{\rho}\nabla p + \nabla \cdot \Big( \nu\big(\nabla\mathbf{U}+(\nabla\mathbf{U})^{T}\big) \Big)  + \mathbf{f}
	\end{align}


根据一个标量可以任意交换偏导次序以及在不可压缩流中速度场散度为零，可以发现

.. math::
	\begin{align}
	\nabla \cdot \big((\nabla \mathbf{U})^{T}\big) =
	\nabla \cdot 
	\begin{bmatrix}
	 \frac{\partial u_{x}}{\partial x} & \frac{\partial u_{x}}{\partial y} & \frac{\partial u_{x}}{\partial z} \\
	 \frac{\partial u_{y}}{\partial x} & \frac{\partial u_{y}}{\partial y} & \frac{\partial u_{y}}{\partial z} \\
	 \frac{\partial u_{z}}{\partial x} & \frac{\partial u_{z}}{\partial y} & \frac{\partial u_{z}}{\partial z}
	\end{bmatrix}
	=
	\begin{bmatrix}
	\frac{\partial }{\partial x}(\frac{\partial u_{x}}{\partial x}) + \frac{\partial }{\partial y}(\frac{\partial u_{y}}{\partial x}) + \frac{\partial }{\partial z}(\frac{\partial u_{z}}{\partial x}) \\
	\frac{\partial }{\partial x}(\frac{\partial u_{x}}{\partial y}) + \frac{\partial }{\partial y}(\frac{\partial u_{y}}{\partial y}) + \frac{\partial }{\partial z}(\frac{\partial u_{z}}{\partial y}) \\
	\frac{\partial }{\partial x}(\frac{\partial u_{x}}{\partial z}) + \frac{\partial }{\partial y}(\frac{\partial u_{y}}{\partial z}) + \frac{\partial }{\partial z}(\frac{\partial u_{z}}{\partial z})
	\end{bmatrix}
	=
	\begin{bmatrix}
	\frac{\partial }{\partial x}(\frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} + \frac{\partial u_{z}}{\partial z} )  \\
	\frac{\partial }{\partial y}(\frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} + \frac{\partial u_{z}}{\partial z} )  \\
	\frac{\partial }{\partial z}(\frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} + \frac{\partial u_{z}}{\partial z} )
	\end{bmatrix}
	= \mathbf{0}
	\end{align}


因此，不可压缩粘性流体的动量方程最终可以写为

.. math::
	\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} + \nabla \cdot (\mathbf{U}\mathbf{U}) = -\frac{1}{\rho}\nabla p + \nabla \cdot (\nu\nabla\mathbf{U}) + \mathbf{f} 
	\end{align}


对于理想流体的情况，由于不存在粘性即 :math:`\nu=0` ，流体中没有切应力，从而动量方程简化为

.. math::
	\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} + \nabla \cdot (\mathbf{U}\mathbf{U}) = -\frac{1}{\rho}\nabla p + \mathbf{f}
	\end{align}


对于可压缩流体，重新代入正确的 :math:`\boldsymbol{\tau}` 的表达式，可以得到完整的动量方程：

.. math::
	\begin{align}
	\frac{\partial \rho\mathbf{U}}{\partial t} 
	+ \nabla \cdot (\rho\mathbf{U}\mathbf{U}) 
	= -\nabla p 
	+ \nabla \cdot \Big( \mu \big(\nabla\mathbf{U}+(\nabla\mathbf{U})^{T}\big)-\frac{2}{3}\mu(\nabla\cdot\mathbf{U})\mathbf{I} \Big)
	+ \rho\mathbf{f}
	\end{align}

.. attention:: 其中的 :math:`(\nabla\mathbf{U})^{T}` 并不能化简，因为可压缩流体的 :math:`\nabla \cdot \mathbf{U} \ne 0` 。








理想流体恒定元流的能量方程
-----------------------------


伯努利积分（理想流体恒定流动沿流线的积分）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

将理想流体的动量方程写成如下形式：

.. math::
	\begin{align}
	\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t} = \mathbf{f} - \frac{1}{\rho}\nabla p  
	\end{align}

在流线上沿流动方向取一段弧长 :math:`(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)` 。因为恒定流动的流线不随时间变化，所以流体质点将沿着流线运动，迹线与流线重合，流线上的一段弧长也是流体质点的一段位移 :math:`\mathrm{d}\mathbf{r} = (\mathrm{d}x,\mathrm{d}y,\mathrm{d}z) = \mathbf{U}\mathrm{d}t` ，将其乘在上式的两边则得到

.. math::
	\begin{align}
	\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t} \cdot \mathbf{U}\mathrm{d}t = (\mathbf{f} - \frac{1}{\rho}\nabla p)\cdot\mathrm{d}\mathbf{r} 
	\end{align}

.. math::
	\begin{align}
	\mathrm{d}\mathbf{U} \cdot \mathbf{U} = \mathbf{f}\cdot \mathrm{d}\mathbf{r} - \frac{1}{\rho}\nabla p \cdot \mathrm{d}\mathbf{r}  
	\end{align}

.. math::
	\begin{align}
	\mathrm{d}(\frac{u^{2}}{2}) = \mathrm{d}W - \frac{1}{\rho}\mathrm{d}p
	\end{align}

其中 :math:`u` 是流速大小， :math:`W` 为质量力势函数。考虑到不可压缩流体的密度是常量，可以放入全微分当中，于是对上式积分即得到 **伯努利积分** ：

.. math::
	\begin{align}
	W - \frac{p}{\rho} - \frac{u^{2}}{2} = C_{l}  
	\end{align}

其中 :math:`W` 是质量力势函数， :math:`\rho` 是不可压缩流体的密度， :math:`C_{l}` 称为流线常数（不同的流线可以有各自的积分常数）。上式表明，在理想流体的恒定流动中，同一流线上各点的 :math:`(W - \frac{p}{\rho} - \frac{u^{2}}{2})` 值时一个常数。

对于质量力只有重力的情况下，重力的势函数为 :math:`W=-gz` ，代入伯努利积分得到

.. math::
	\begin{align}
	gz + \frac{p}{\rho} + \frac{u^{2}}{2} = C_{l}
	\quad \text{or} \quad 
	z + \frac{p}{\rho g} + \frac{u^{2}}{2g} = C_{l}      
	\end{align}

如果对同一流线上任意两点利用上式即得到 **伯努利方程** ：

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} + \frac{u_{1}^{2}}{2g} = z_{2} + \frac{p_{2}}{\rho g} + \frac{u_{2}^{2}}{2g}
	\end{align}

伯努利方程表示能量的平衡关系，每项的物理意义表示单位重量流体所具有的某种能量：

- :math:`z` 是单位重量流体所具有的 **位置势能** （单位位置势能），从位置高程的基准面算起。用几何高度来表示则称为 **位置水头** ；
- :math:`\frac{p}{\rho g}` 是单位重量流体所具有的 **压强势能** （单位压强势能），用相对压强计算。用几何高度来表示则称为 **压强水头** ；
- :math:`z + \frac{p}{\rho g}` 是单位重量流体所具有的 **总势能** （单位总势能）。用几何高度来表示则称为 **测压管水头** ；
- :math:`\frac{u^{2}}{2g}` 是单位重量流体所具有的 **动能** （单位动能）。用几何高度来表示则称为 **速度水头** ；
- :math:`z + \frac{p}{\rho g} + \frac{u^{2}}{2g}` 是单位重量流体的 **总机械能** （单位机械能）。用几何高度来表示则称为 **总水头线** 。

.. attention:: 

	伯努利方程的使用条件如下：

	- 流体要能够视为理想流体，即忽略粘性；
	- 流动为恒定流动，即时变加速度为零；
	- 考虑质量力且仅考虑重力的作用；
	- 要求流体为不可压缩流体，即密度为常数，在流体为气体时适用于马赫数小于0.3的情况；
	- 所选取的两个点需要在同一条流线上。




对于满足理想流体恒定流动的气体来说，一般不适合用水头来描述，所以对气体常使用下面形式的伯努利方程：

.. math::
	\begin{align}
	p + \frac{1}{2}\rho u^{2} + \rho g z = \text{const}
	\end{align}

其中 :math:`p` 称为 **静压** (static pressure)， :math:`\frac{1}{2}\rho u^{2}` 称为 **动压** (dynamic pressure)， :math:`\rho gz` 称为位压（很多时候可以忽略）。静压和动压的和称为 **滞止压强** (stagnation pressure) 。三项的和作为一个压强常数，一般称为 **总压** (total pressure)。


欧拉积分（理想流体恒定有势流动的积分）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

在伯努利积分的基础上进一步加上 **无旋** 的条件即可导出欧拉积分。恒定条件下理想流体运动方程的x方向分量的式子为

.. math::
	\begin{align}
	u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{x}}{\partial y} + u_{z}\frac{\partial u_{x}}{\partial z}
	= X - \frac{1}{\rho}\frac{\partial p}{\partial x}
	\end{align}

由无旋条件可知 :math:`\frac{\partial u_{x}}{\partial y}=\frac{\partial u_{y}}{\partial x}` 和 :math:`\frac{\partial u_{x}}{\partial z}=\frac{\partial u_{z}}{\partial x}` ，从而上式可以进一步整理：

.. math::
	\begin{align}
	X - \frac{1}{\rho}\frac{\partial p}{\partial x}
	= u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{y}}{\partial x} + u_{z}\frac{\partial u_{z}}{\partial x}
	= \frac{\partial }{\partial x}\Big( \frac{u_{x}^{2}+u_{y}^{2}+u_{z}^{2}}{2} \Big)
	= \frac{\partial }{\partial x}(\frac{u^{2}}{2}) 
	\end{align}

同理可以y,z方向的式子：

.. math::
	\begin{align}
	& \frac{\partial }{\partial y}(\frac{u^{2}}{2}) = Y - \frac{1}{\rho}\frac{\partial p}{\partial y} \\
	& \frac{\partial }{\partial z}(\frac{u^{2}}{2}) = Z - \frac{1}{\rho}\frac{\partial p}{\partial z}
	\end{align}

将流场内任取的一段微元弧长 :math:`(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)` 的三个分量分别乘以上式的两边并将三式相加，得到

.. math::
	\begin{align}
	\frac{\partial }{\partial x}(\frac{u^{2}}{2})\mathrm{d}x 
	+ \frac{\partial }{\partial y}(\frac{u^{2}}{2})\mathrm{d}y
	+ \frac{\partial }{\partial z}(\frac{u^{2}}{2})\mathrm{d}z
	= X\mathrm{d}x + Y\mathrm{d}y + Z\mathrm{d}z
	-\frac{1}{\rho}\Big( \frac{\partial p}{\partial x}\mathrm{d}x + \frac{\partial p}{\partial y}\mathrm{d}y + \frac{\partial p}{\partial z}\mathrm{d}z   \Big) 
	\end{align}

在质量力有势和流体不可压缩的条件下，上式可以写成

.. math::
	\begin{align}
	\mathrm{d}(\frac{u^{2}}{2}) = \mathrm{d}W - \mathrm{d}(\frac{p}{\rho})
	\quad \text{or} \quad 
	\mathrm{d}\Big( W - \frac{p}{\rho} - \frac{u^{2}}{2} \Big) = 0
	\end{align}

对上式积分即可得到 **欧拉积分** ：

.. math::
	\begin{align}
	W - \frac{p}{\rho} - \frac{u^{2}}{2} = C
	\end{align}

其中 :math:`W` 是质量力势函数， :math:`\rho` 是不可压缩流体的密度，积分常数 :math:`C` 称为通用常数。上式表明，在理想不可压缩流体的恒定有势流动中，流场中各点的 :math:`(W - \frac{p}{\rho} - \frac{u^{2}}{2})` 值是一个常数。

在质量力只是重力的情况下，欧拉积分的具体形式为

.. math::
	\begin{align}
	gz + \frac{p}{\rho} + \frac{u^{2}}{2} = C
	\quad \text{or} \quad 
	z + \frac{p}{\rho g} + \frac{u^{2}}{2g} = C
	\end{align}





恒定总流的能量方程
---------------------

理想不可压流体恒定总流的能量方程
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

总流是无数元流的累加，单位时间内通过总流过流断面 :math:`A` 的流体，其总机械能是通过各元流过流断面 :math:`\mathrm{d}A` 三相机械能的总和。元流的体积流量是 :math:`\mathrm{d}Q=u\mathrm{d}A` ，单位时间里通过元流过流断面的流体重量是 :math:`\rho g\mathrm{d}Q` ，则单位时间内通过总流过流断面的总能量为

.. math::
	\begin{align}
	\iint\limits_{A}\Big( z + \frac{p}{\rho g} + \frac{u^{2}}{2g} \Big)\rho g\mathrm{d}Q
	\end{align}

由理想流体恒定元流的能量方程可知，单位时间里通过元流各过流断面的总能量相等，那么在理想流体恒定总流中，单位时间里通过总流各过流断面的总能量也一定相等，即上式等于一个常数。

在总流过流断面上三项单位能量是不均匀的，所以要用在断面上积分的形式来表示单位时间里通过总流过流断面的总能量。下面尝试用断面平均势能和断面平均流速表示的断面机械能平均值，来将总流能量方程一维化。首先将势能与动能的积分分开考虑：

.. math::
	\begin{align}
	\iint\limits_{A}\Big( z + \frac{p}{\rho g} + \frac{u^{2}}{2g} \Big)\rho g\mathrm{d}Q
	= \iint\limits_{A}\Big( z + \frac{p}{\rho g}\Big)\rho g\mathrm{d}Q
	+ \iint\limits_{A}\Big( \frac{u^{2}}{2g} \Big)\rho g\mathrm{d}Q 
	\end{align}


对于断面平均势能，先考察均匀流的过流断面上势能的分布情况。根据动量方程，现在所考虑的恒定均匀流满足时变加速度与位变加速度均为零，即没有惯性力项，只有重力、压差力和粘性力，于是

.. math::
	\begin{align}
	-g\mathbf{k} - \frac{1}{\rho}\nabla p + \nu \nabla^{2}\mathbf{U} = 0
	\quad \Rightarrow \quad 
	-\nabla\Big( gz + \frac{p}{\rho} \Big) + \nu\nabla^{2}\mathbf{U} = 0
	\end{align}

其中将重力加速度写成 :math:`-g\nabla z` 就固定了z轴时铅锤向上的坐标轴。因为均匀流的流线是平行直线，流速都沿着同一方向，其过流断面是平面。现在用 :math:`Ox_{1}yz_{1}` 坐标轴来描述该过流断面，规定 :math:`x_{1}` 轴指向流速方向， :math:`Oyz_{1}` 为过流断面平面，且 :math:`Oyz_{1}` 平面与 :math:`Oyz` 平面有一个夹角 :math:`\theta` ，即两个坐标系是绕 :math:`y` 轴旋转 :math:`\theta` 角的关系。在 :math:`Ox_{1}yz_{1}` 坐标系中应用上述动量方程，得到分量形式：

.. math::
	\begin{align}
	& -\frac{\partial }{\partial x_{1}}\Big( gz + \frac{p}{\rho} \Big) + \nu\nabla^{2}u_{x_{1}} = 0 \\
	& -\frac{\partial }{\partial y}\Big( gz + \frac{p}{\rho} \Big) = 0 \\
	& -\frac{\partial }{\partial z_{1}}\Big( gz + \frac{p}{\rho} \Big) = 0
	\end{align}

从 :math:`y,z_{1}` 分量的式子可以看出，在过流断面（ :math:`Oyz_{1}` 平面）上有

.. math::
	\begin{align}
	gz + \frac{p}{\rho} = \text{const}
	\quad \text{or} \quad 
	z + \frac{p}{\rho g} = \text{const}     
	\end{align}

即在恒定均匀流的过流断面上势能是常数。这可以解释为均匀流的过流断面上粘性力的分量为零，只有压差与重力之间的平衡，所以流体动压强按照流体静压强的规律分布。

.. attention:: 只能在同一过流断面上应用上述结论，因为 :math:`x_{1}` 方向的运动方程里有粘性力项，所以沿着流动方向流体动压强分布不同于流体静压强，导致不同过流断面上势能可能是不同的常数。

渐变流可以近似于均匀流，所以渐变流过流断面上的势能 :math:`z + \frac{p}{\rho g}` 也可视为常数，于是势能积分可以改写成

.. math::
	\begin{align}
	\iint\limits_{A}\Big( z + \frac{p}{\rho g}\Big)\rho g\mathrm{d}Q
	= \Big( z + \frac{p}{\rho g}\Big)\rho gQ
	\end{align}

动能项 :math:`\frac{u^{2}}{2g}` 在过流断面上是不均匀的，如果要用断面平均流速 :math:`v` 来代替，那么就需要乘上一个修正系数 :math:`\alpha` 才能作为平均值，从而动能积分可以写成

.. math::
	\begin{align}
	\iint\limits_{A}\Big( \frac{u^{2}}{2g} \Big)\rho g\mathrm{d}Q 
	= \frac{\alpha v^{2}}{2}\rho Q 
	\end{align}

也即有这样的关系： :math:`\frac{\rho}{2}\iint\limits_{A}u^{3}\mathrm{d}A = \frac{\rho}{2}\alpha v^{3}A` ，从而得到 **动能修正系数** 的表达式为

.. math::
	\begin{align}
	\alpha  = \frac{\iint\limits_{A}u^{3}\mathrm{d}A}{v^{3}A} 
	\end{align}

该系数是一个大于 :math:`1.0` 的系数，其大小取决于断面上的流速分布。流速分布越均匀， :math:`\alpha` 越接近于 :math:`1.0` ；流速分布越不均匀， :math:`\alpha` 的数值越大。

综上，单位时间里总流通过渐变流段中过流断面的总能量为 :math:`\rho gQ \Big( z + \frac{p}{\rho} + \frac{\alpha v^{2}}{2g} \Big)` ，进而得到单位重量流体的总机械能为

.. math::
	\begin{align}
	H = z + \frac{p}{\rho} + \frac{\alpha v^{2}}{2g}
	\end{align}



对理想不可压缩流体总流，不考虑流动中的机械能损失，单位时间里通过总流各过流断面的总能量相同，而由连续方程决定了重量流量 :math:`\rho gQ` 沿程不变，所以在任意两个分别位于总流的渐变流段中的过流断面满足 **理想不可压流体恒定总流的能量方程** ：

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha _{1}v_{1}^{2}}{2g}
	= z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha _{2}v_{2}^{2}}{2g}   
	\end{align}



.. attention:: 

	恒定总流能量方程在应用时必须满足相应的条件：

	- 流动必须是恒定流，并且流体是不可压缩的。但是在引入沿程损失的概念后可以应用于具有粘性的不可压缩实际流体。
	- 作用于流体上的质量力只有重力。
	- 所取的上下游两个断面应该在渐变流段中，以符合断面上位置势能加压强势能为常数的条件。但是在两个断面之间流动可以不是渐变流。断面应该选在已知条件较多的位置。在渐变流断面上取任何一点的势能值都能作为整个断面的平均值，为了简便通常取管道中心点或河渠水面点。
	- 两断面间没有能量的输入或输出。
	- 两断面间没有流量的流入或流出。


以相对压强计算的气流能量方程
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


对于流体是气体的情况，一般将上式转换成压强量纲，即

.. math::
	\begin{align}
	p_{1\text{abs}} + \rho gz_{1} + \frac{\rho\alpha _{1}v_{1}^{2}}{2}
	= p_{2\text{abs}} + \rho gz_{2} + \frac{\rho\alpha _{2}v_{2}^{2}}{2} + p_{w1-2}
	\end{align}

其中 :math:`\rho` 为气体的密度， :math:`p_{w1-2}` 为断面间的压强损失， :math:`p_{1\text{abs}},p_{2\text{abs}}` 分别是两断面上的绝对压强。当两断面高度具有显著差异时其当地大气压将存在差异，于是设1-1断面 :math:`z_{1}` 高程处的大气压强为 :math:`p_{a}` ，外部空气的密度为 :math:`\rho_{a}` ，则2-2断面 :math:`z_{2}` 高程处的大气压强为 :math:`p_{a}-\rho_{a}g(z_{2}-z_{1})` ，所以 :math:`p_{1\text{abs}}=p_{a}+p_{1}` ， :math:`p_{2\text{abs}}=p_{a}-\rho_{a}g(z_{2}-z_{1})+p_{2}` ，从而代入上式得到 **以相对压强计算的气流能量方程式** ：

.. math::
	\begin{align}
	p_{1} + \rho gz_{1} + \frac{\rho\alpha_{1}v_{1}^{2}}{2}
	= p_{2} - \rho_{a}g(z_{2} - z_{1}) + \rho gz_{2} + \frac{\rho \alpha_{2}v_{2}^{2}}{2} + p_{w1-2}
	\end{align}

.. math::
	\begin{align}
	p_{1} + \frac{\rho\alpha _{1}v_{1}^{2}}{2} + (\rho_{a}-\rho)g(z_{2}-z_{1})
	= p_{2} + \frac{\rho\alpha _{2}v_{2}^{2}}{2} + p_{w1-2}  
	\end{align}

其中 :math:`p_{1},p_{2}` 称为 **静压** ， :math:`\frac{\rho\alpha _{1}v_{1}^{2}}{2},\frac{\rho\alpha _{2}v_{2}^{2}}{2}` 称为 **动压** ， :math:`(\rho_{a}-\rho)g` 为单位体积气体所受的有效浮力， :math:`(z_{2}-z_{1})` 为气体沿浮力方向升高的距离， :math:`(\rho_{a}-\rho)g(z_{2}-z_{1})` 为1-1断面相对于2-2断面单位体积气体的位能，称为 **位压** 。


有能量输入和输出的恒定总流能量方程
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

当管道中有水力机械对水流做功（如水泵）或水流对水力机械做功（如水轮机）时，就有水流能量的输入或输出，此时的恒定总流能量方程为

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha_{1}v_{1}^{2}}{2g} \pm H_{m}
	= z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha_{2}v_{2}^{2}}{2g} + h_{w1-2}
	\end{align}

其中 :math:`H_{m}` 为单位重量流体增加或减少的能量。

对于水泵管路系统，上式中的 :math:`H_{m}` 取正号，是单位重量的水流通过水泵后增加的能量，称为 **水泵扬程** 。对于一般的抽水水泵管路系统，取入口处断面1-1以及出口处断面2-2，则 :math:`z_{1} + \frac{p_{1}}{\rho g} = 0` ， :math:`z_{2} + \frac{p_{2}}{\rho g} = z` 。相对于管路中的流速， :math:`v_{1},v_{2}` 均可以忽略，即 :math:`\frac{\alpha_{1}v_{1}^{2}}{2g}\approx \frac{\alpha_{2}v_{2}^{2}}{2g} \approx 0` ，则此时的恒定总流能量方程改写成

.. math::
	\begin{align}
	H_{m} = z + h_{w1-2}
	\end{align}

其中 :math:`z` 是上下游的水面高差，也称为提水高度； :math:`h_{w1-2}` 是全部管路中的沿程水头损失，但是不包括水泵内的水头损失。


单位时间内电动机给予水泵的功称为轴功率。单位重量的水流从水泵实际获得的能量是 :math:`H_{m}` ，而每单位时间通过水泵的水流能量为 :math:`\rho gQ` ，所以水流在单位时间内实际获得的总能量为 :math:`\rho gQH_{m}` 。考虑到水流通过水泵时有水头损失，所以水泵所做的功要大于水流实际获得的能量。用一个小于1的水泵效率 :math:`\eta_{p}` 来反应水泵内的损失，则原动机单位时间对水泵做的功，也就是水泵的轴功率 :math:`N_{p}` 为

.. math::
	\begin{align}
	N_{p} = \frac{\rho g Q H_{m}}{\eta_{p}} 
	\end{align}


对于水轮管路系统， :math:`H_{m}` 则取负号，表示单位重量的水流给予水轮机的能量，称为水轮机的作用水头。对于一般的水轮机管路系统，取入水口断面1-1和出水口断面2-2，根据能量方程有

.. math::
	\begin{align}
	H_{m} = 
	\Big( z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha_{1}v_{1}^{2}}{2g} \Big)
	- \Big( z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha_{2}v_{2}^{2}}{2g} \Big)
	- h_{w1-2}
	\end{align}

其中

.. math::
	\begin{align}
	\Big( z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha_{1}v_{1}^{2}}{2g} \Big)
	- \Big( z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha_{2}v_{2}^{2}}{2g} \Big)
	= z
	\end{align}

所以

.. math::
	\begin{align}
	H_{m} = z - h_{w1-2}
	\end{align}

其中 :math:`z` 是上下游的水位差， :math:`h_{w1-2}` 是全部管路中的水头损失，但是不包括水轮机内的水头损失。

水轮机的功率又称为水轮机出力，它是水轮机主轴发出的功率。单位重量的水流给予水轮机的能量是 :math:`H_{m}` ，而每单位时间通过水轮机的水流重量为 :math:`\rho gQ` ，所以水流在单位时间内输出的总能量是 :math:`\rho g Q H_{m}` 。由于水轮机中同样有水头损失，水轮机出力要小于水流给予水轮机的功率，所以用一个小于1的水轮机效率 :math:`\eta_{t}` 来反映水轮机内的损失，则水轮机的功率 :math:`N_{t}` 为

.. math::
	\begin{align}
	N_{t} = \eta_{t}\rho gQH_{m}
	\end{align}


两断面间有分流或汇流的恒定总流能量方程
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

恒定总流能量方程是在上下游两个断面之间没有分流或汇流的条件下推导出来的，而实际管道中常常有分流或汇流，这时要用上下游断面之间全部重量流体的能量守恒原理写出能量方程。对于汇流的情况，上游断面1-1和2-2的流量分别为 :math:`Q_{1},Q_{2}` ，下游断面3-3的流量为 :math:`Q_{3}` ，由连续性方程容易得到 :math:`Q_{1} + Q_{2} = Q_{3}` 。单位时间通过1-1和2-2断面的能量分别为 :math:`\rho gQ_{1}\Big( z_{1} + \frac{p_{1}}{\rho g} + \frac{\rho \alpha_{1} v_{1}^{2}}{2g}\Big)` 和 :math:`\rho gQ_{2}\Big( z_{2} + \frac{p_{2}}{\rho g} + \frac{\rho \alpha_{2} v_{2}^{2}}{2g}\Big)` ，通过3-3断面的能量为 :math:`\rho gQ_{3}\Big( z_{3} + \frac{p_{3}}{\rho g} + \frac{\rho \alpha_{3} v_{3}^{2}}{2g}\Big)` ，流量为 :math:`Q_{1}` 的流股从1-1断面到3-3断面的能量损失为 :math:`\rho gQ_{1}h_{w1-3}` ，流量为 :math:`Q_{2}` 的流股从2-2断面到3-3断面的能量损失为 :math:`\rho gQ_{2}h_{w2-3}` ，根据总能量的平衡可知

.. math::
	\begin{align}
	\rho gQ_{1}\Big( z_{1} + \frac{p_{1}}{\rho g} + \frac{\rho \alpha_{1} v_{1}^{2}}{2g}\Big)
	+ \rho gQ_{2}\Big( z_{2} + \frac{p_{2}}{\rho g} + \frac{\rho \alpha_{2} v_{2}^{2}}{2g}\Big)
	= \rho gQ_{3}\Big( z_{3} + \frac{p_{3}}{\rho g} + \frac{\rho \alpha_{3} v_{3}^{2}}{2g}\Big)
	+ \rho gQ_{1}h_{w1-3}
	+ \rho gQ_{2}h_{w2-3}
	\end{align}

如果断面流速分布比较均匀，可以用单位重量流体的能量方程近似处理这类问题。例如汇流问题可以近似有

.. math::
	\begin{align}
	& z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha_{1}v_{1}^{2}}{2g} = z_{3} + \frac{p_{3}}{\rho g} + \frac{\alpha_{3}v_{3}^{2}}{2g} + h_{w1-3} \\
	& z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha_{2}v_{2}^{2}}{2g} = z_{3} + \frac{p_{3}}{\rho g} + \frac{\alpha_{3}v_{3}^{2}}{2g} + h_{w2-3}
	\end{align}

对于分流问题可以近似有

.. math::
	\begin{align}
	& z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha_{1}v_{1}^{2}}{2g} = z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha_{2}v_{2}^{2}}{2g} + h_{w1-2} \\
	& z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha_{1}v_{1}^{2}}{2g} = z_{3} + \frac{p_{3}}{\rho g} + \frac{\alpha_{3}v_{3}^{2}}{2g} + h_{w1-3}
	\end{align}





恒定总流能量方程的几何表示（水头线）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

与元流一样，恒定总流能量方程的各项也都是长度量纲，所以可以将它们几何表示出来，画成水头线。总流水头线的画法和元流水头线是相仿的，其中位置水头线一般为总流断面中心线。另外，由于实际流体的流动总是有水头损失的，所以总水头线肯定会沿程下降，定义水头线的斜率为 **水力坡度** ：

.. math::
	\begin{align}
	J = -\frac{\mathrm{d} H}{\mathrm{d} s}=\frac{\mathrm{d}h_{w}}{\mathrm{d}s}  
	\end{align}

其中 :math:`s` 是流程长度， :math:`h_{w}` 为相应的水头损失。

同样的，测压管水头线是沿程各断面测压管水头 :math:`H_{p}=z+\frac{p}{\rho g}` 的连线。可以定义单位长度流程上测压管水头的减小值为测压管水头线坡度（测管坡度）：

.. math::
	\begin{align}
	J_{p} = -\frac{\mathrm{d}H_{p}}{\mathrm{d} s} = -\frac{\mathrm{d} }{\mathrm{d}s}(z+\frac{p}{\rho g} )  
	\end{align}



恒定总流的动量方程
---------------------

元流的质量流量是 :math:`\rho\mathrm{d}Q=\rho u\mathrm{d}A` ，单位时间里通过元流过流断面的动量为 :math:`\mathbf{U}\rho\mathrm{d}Q` ，将它在总流过流断面上积分得到单位时间里通过总流过流断面的动量应该为 :math:`\iint\limits_{A}\rho u \mathbf{U}\mathrm{d}A` 。根据恒定总流的动量守恒原理，应该有

.. math::
	\begin{align}
	\iint\limits_{A_{2}}\rho u\mathbf{U}\mathrm{d}A
	-  \iint\limits_{A_{1}}\rho u\mathbf{U}\mathrm{d}A
	= \sum \mathbf{F}
	\end{align}

在总流过流断面上速度大小 :math:`u` 一般是不均匀的，速度 :math:`\mathbf{U}` 的方向也一般是不一致的，为了进行一维简化，就要使用断面平均流速来化简。假设断面 :math:`A` 是在渐变流段中的一个过流断面，则断面上各点的 :math:`\mathbf{U}` 方向一致，用断面平均流速为 :math:`v` ，定义 :math:`\mathbf{v}` 的大小为 :math:`v` ，方向为 :math:`\mathbf{U}` 的方向，此时总流过断面的动量通量修改成

.. math::
	\begin{align}
	\iint\limits_{A}\rho v\mathbf{v}\mathrm{d}A 
	\end{align}

它和精确的动量通量方向一致，但是大小并不相等，因此需要引入一个 **动量修正系数** :math:`\alpha_{0}` 使动量通量的大小写成

.. math::
	\begin{align}
	\iint\limits_{A}\rho u^{2}\mathrm{d}A = \rho \alpha _{0}v^{2}A 
	\end{align}

从而可以得到该动量修正系数的表达式为

.. math::
	\begin{align}
	\alpha _{0} = \frac{\iint\limits_{A}u^{2}\mathrm{d}A}{v^{2}A} 
	\end{align}

它是一个大于1的数，其大小取决于断面上的流速分布。

于是 **恒定总流的动量方程** 就可以写成

.. math::
	\begin{align}
	\rho(\alpha _{02}v_{2}\mathbf{v}_{2}A_{2} - \alpha _{01}v_{1}\mathbf{v}_{1}A_{1})=\sum\mathbf{F}
	\quad \Rightarrow \quad 
	\rho Q(\alpha _{02}\mathbf{v}_{2}-\alpha _{01}\mathbf{v}_{1})=\sum\mathbf{F}
	\end{align}

上式中的 :math:`\sum\mathbf{F}` 包括：上游水流作用于断面1-1上的流体动压力 :math:`\sigma_{1}` ，下游水流作用于断面2-2上的流体动压力 :math:`\sigma_{2}` ，重力 :math:`G` 和总流侧壁边界对这段水流的总作用力 :math:`R'` 。其中只有重力是质量力，其他都是表面力。



.. attention:: 

	- 要合理地选择总流段的上下游断面，使得控制体正好包括需要确定水流作用力的边界，同时所选断面宜位于渐变流区域，以便利用同一过流段断面处测压水头相等来计算流体动压力，并取动量修正系数，用断面平均流速表示过流断面的动量。
	- 方程中应该包括作用于控制体内流体的所有外力：两断面上的压力、重力、四周边界对液流的作用力。
	- 动量方程左侧是流出下游断面的动量通量减去流入上游断面的动量通量，不要弄反。
	- 动量方程是矢量式，具体应用时要选择合适的坐标系进行投影分析其分量。对于未知的边界作用力可以先假定一个方向，根据结果正负号来修正方向。



流体热力学
==============


状态方程
-----------

热力学变量及其关系
^^^^^^^^^^^^^^^^^^^^^

处于热力学平衡状态的系统可以用基本热力学变量压强 :math:`p` 和specific :math:`v` 来完全描述，一般来说我们只考虑 :math:`p-v-T` 系统，也即热力学状态方程包括三个关系：

.. math::
	\begin{align}
	T = T(p,v)
	,\qquad
	p = p(T,v)
	,\qquad
	v = v(T,p)
	\end{align}

上述关系对于不同的物质都会有所不同。对于热理想气体(thermolly ideal gases)，其关系可以用下面这个简单的方程描述：

.. math::
	\begin{align}
	T = \frac{pv}{R} 
	\end{align}

其中 :math:`R` 是一个常数，它的值取决于所考虑的特定气体。

热力学第一定律指出，对于一个非绝热系统，内能 :math:`e` 的变化量 :math:`\Delta e` 满足 :math:`\Delta e = \Delta W + \Delta Q` ，其中 :math:`\Delta W` 是对该系统做的功， :math:`\Delta Q` 是向该系统传入的热量。考虑对系统做功为 :math:`\mathrm{d}W = -p\mathrm{d}v` ，于是

.. math::
	\begin{align}
	\mathrm{d}Q = \mathrm{d}e + p\mathrm{d}v
	\end{align}

内能 :math:`e` 同样也可以通过热量状态方程与 :math:`p,v` 联系，于是就有 :math:`p-v-e` 关系：

.. math::
	\begin{align}
	e = e(p,v)
	,\qquad
	p = p(v,e)
	,\qquad
	v = v(e,p)
	\end{align}

对于热量理想气体(calorically ideal gas)则有简单的关系表达式：

.. math::
	\begin{align}
	e = \frac{p v}{\gamma - 1} = \frac{p}{\rho(\gamma - 1)}
	\end{align}

其中 :math:`\gamma` 是一个常数，其值由所考虑的特定气体决定。

对于给定的物质，其热力状态方程和热量状态方程是紧密联系的。两个方程对于完整描述一个系统的热力学过程是必要的。选择一个热力状态方程的确能够限制热量方程的选择，但是并不能决定它。注意到，在求解流体问题时一般只要求一个热量状态方程，比如 :math:`p=p(\rho, e)` ，除非需要温度 :math:`T` 来处理其他问题，这种情况下则需要显式地给出一个热力状态方程。


下面考虑熵(entropy)的相关情况。首先引入积分因子 :math:`1/T` ，于是

.. math::
	\begin{align}
	\mathrm{d}e + p\mathrm{d}v
	= \Big( \frac{\partial e}{\partial v} + p \Big)\mathrm{d}v
	  + \frac{\partial e}{\partial p}\mathrm{d}p
	\end{align}

于是热力学第二定律引入一个新的变量 :math:`s` ，称为熵(entropy)，满足关系式

.. math::
	\begin{align}
	T\mathrm{d}s = \mathrm{d}e + p\mathrm{d}v
	\end{align}

对于任意过程，熵的变化都满足 :math:`\Delta s = \Delta s_{0} + \Delta s_{i}` ，其中 :math:`\Delta s_{0}` 表示通过系统的边界进入系统的熵，而 :math:`\Delta s_{i}` 表示系统在过程中产生的熵。

.. note:: 关于系统内产生的熵，常见的例子是热传递以及粘性，在激波的内部结构中就会产生。

热力学第二定律指出，对于任何不可逆过程都有 :math:`\Delta s_{i} > 0` ，只有在可逆过程中满足 :math:`\Delta s_{i} = 0` 。


除了熵，另一个常用的变量是焓(specific enthalpy) :math:`h` ，它定义为

.. math::
	\begin{align}
	h = e + pv
	\end{align}

它可以与之前叙述的物理量建立联系，比如

.. math::
	\begin{align}
	\mathrm{d}e = T\mathrm{d}s - p\mathrm{d}v
	\end{align}

上式将内能看作 :math:`e = e(s,v)` ，同时通过取全微分容易得到 :math:`\mathrm{d}h = \mathrm{d}e + p\mathrm{d}v + v\mathrm{d}p` ，从而得到

.. math::
	\begin{align}
	\mathrm{d}h = T\mathrm{d}s + v\mathrm{d}p
	\end{align}

于是就得到关系 :math:`h=h(s,p)` 。这里得到的 :math:`e = e(s,v)` 和 :math:`h = h(s,p)` 关系被称为标准状态方程(canonical equations of state)，不同于热力状态方程或热量状态方程，标准状态方程每一个都能完整地描述热力学过程。

例如，给定 :math:`e = e(s,v)` 的关系，那么可以根据 :math:`\mathrm{d}e = T\mathrm{d}s - p\mathrm{d}v` 得到压强和温度分别为

.. math::
	\begin{align}
	p = -\Big( \frac{\partial e}{\partial v} \Big)_{s}
	,\qquad
	T = \Big( \frac{\partial e}{\partial s} \Big)_{v}
	\end{align}

在热力学中，由于变量的变化经常发生，所以通常在偏微分中明确指定自变量。对于上式，显然自变量为 :math:`s` 和 :math:`v` 。类似的，也可以根据 :math:`\mathrm{d}h = T\mathrm{d}s + v\mathrm{d}p` 得到

.. math::
	\begin{align}
	T = \Big( \frac{\partial h}{\partial s} \Big)_{p}
	,\qquad
	v = \Big( \frac{\partial h}{\partial p} \Big)_{s}
	\end{align}

亥姆霍兹自由能定义为

.. math::
	\begin{align}
	f = e - Ts
	\end{align}

相应能够得到一个标准状态方程 :math:`f = f(v,T)` ，由它可以得到

.. math::
	\begin{align}
	s = -\Big( \frac{\partial f}{\partial T} \Big)_{v}
	,\qquad
	p = -\Big( \frac{\partial f}{\partial v} \Big)_{T}
	\end{align}


如果热力状态方程 :math:`v = v(p,T)` 给定，那么可以进一步得到 **体积膨胀系数(volume expansivity, or expansion coefficient)** :math:`\alpha` 和 **等温压缩系数(isothermal compressibility)** :math:`\beta` ，分别定义为

.. math::
	\begin{align}
	\alpha = \frac{1}{v}\Big( \frac{\partial v}{\partial T} \Big)_{p}
	,\qquad
	\beta = - \frac{1}{v}\Big( \frac{\partial v}{\partial p} \Big)_{T}
	\end{align}

容易发现存在关系

.. math::
	\begin{align}
	\Big( \frac{\partial s}{\partial v} \Big)_{T}
	= \Big( \frac{\partial p}{\partial T} \Big)_{v}
	= \frac{\alpha}{\beta}
	,\qquad
	\Big( \frac{\partial e}{\partial v} \Big)_{T} = \frac{\partial T - \beta p}{\beta}
	\begin{align}


接下来引入定压比热容和定体比热容。一般来说，热量变化 :math:`\mathrm{d}Q` 与温度变化 :math:`\mathrm{d}T` 的比值 :math:`c = \mathrm{d}Q/\mathrm{d}T` 称为系统的比热容。对于定压过程，热量变化满足

.. math::
	\begin{align}
	\mathrm{d}Q = \mathrm{d}e + p\mathrm{d}v = \mathrm{d}e + \mathrm{d}(pv) = \mathrm{d}h
	\end{align}

于是 **定压比热容** 就变成了 :math:`c_{p} = \mathrm{d}Q/\mathrm{d}T = \mathrm{d}h/\mathrm{d}T` 。由于 :math:`\mathrm{d}p = 0` ，所以 :math:`\mathrm{d}h = T\mathrm{d}s` ，假设 :math:`h = h(T,p)` ，则

.. math::
	\begin{align}
	c_{p} = \Big( \frac{\partial h}{\partial T} \Big)_{p} = T \Big( \frac{\partial s}{\partial T} \Big)_{p}
	\end{align}

**定体比热容** 也可以得到类似的形式：

.. math::
	\begin{align}
	c_{v} = \Big( \frac{\partial e}{\partial T} \Big)_{v} = T \Big( \frac{\partial s}{\partial T} \Big)_{v}
	\end{align}

**声速(the speed of sound)** 是另一个重要的变量。对于粒子经历无约束热力学平衡的流动，我们定义一个新的状态变量 :math:`a` ，称为平衡声速或简称声速。给定一个热量状态方程

.. math::
	\begin{align}
	p = p(\rho, s)
	\end{align}

其中一个定义声速 :math:`a` 的方式为

.. math::
	\begin{align}
	a = \sqrt{\Big( \frac{\partial p}{\partial \rho} \Big)_{s}}
	\end{align}

这个基本定义可以使用之前建立的热力学关系进行转换。例如，给定热量状态方程 :math:`h = h(p,\rho)` ，根据 :math:`\mathrm{d}h = T\mathrm{d}s + v\mathrm{d}p` 可以得到

.. math::
	\begin{align}
	\Big( \frac{\partial h}{\partial p} \Big)_{\rho}\mathrm{d}p
	+ \Big( \frac{\partial h}{\partial \rho} \Big)_{p}\mathrm{d}\rho
	= T \mathrm{d}s
	+ \frac{1}{\rho}
	  \bigg[
	  \Big( \frac{\partial p}{\partial \rho} \Big)_{s}\mathrm{d}\rho
	  + \Big( \frac{\partial p}{\partial s} \Big)_{\rho}\mathrm{d}s
	  \bigg]
	\end{align}

令 :math:`\mathrm{d}s = 0` ，根据声速的定义式可以得到

.. math::
	\begin{align}
	a^{2} = - \frac{(\frac{\partial h}{\partial \rho})_{p}}{(\frac{\partial h}{\partial p})_{\rho} - \frac{1}{\rho}}
	\end{align}

对于热力理想气体有 :math:`h = h(T)` ，于是

.. math::
	\begin{align}
	a^{2} = \frac{(\frac{\partial h}{\partial T})_{p}(\frac{\partial T}{\partial \rho})_{p}}{(\frac{\partial h}{\partial T})_{p}(\frac{\partial T}{\partial p})_{\rho} - \frac{1}{\rho}}
	\end{align}


根据 :math:`c_{p} = \Big( \frac{\partial h}{\partial T} \Big)_{p}` ，同时如果热力理想气体状态方程 :math:`T = \frac{pV}{R}` 可以接受，则

.. math::
	\begin{align}
	a = \sqrt{\gamma(T)RT} = \sqrt{\frac{\gamma p}{\rho}}
	\end{align}

对于一般的物质，热量状态方程总是一个关于 :math:`\rho-p-e` 变量的函数关系。另外可能使用体积(specific volume) :math:`V = 1/\rho` 而不是使用密度 :math:`\rho` 。声速 :math:`a` 的具体表达形式决定于所选择的自变量，两个可能的选择一级其对应的表达式分别为

.. math::
	\begin{align}
	& p = p(\rho, e)
	,\quad
	a = \sqrt{\frac{p}{\rho^{2}}\frac{\partial p}{\partial e} + \frac{\partial p}{\partial \rho}}
	\\
	& e = e(\rho, p)
	,\quad
	a = \sqrt{\frac{p}{\rho^{2}(\frac{\partial e}{\partial p})} - (\frac{\partial e}{\partial \rho})/(\frac{\partial e}{\partial p})}
	\end{align}




理想气体
^^^^^^^^^^^

现在考虑气体满足理想热力状态方程

.. math::
	\begin{align}
	pV = nRT
	\end{align}

其中 :math:`V` 是体积， :math:`\tilde{R} = 8.134\times 10^{3}~\mathrm{J \cdot kmole^{-1} \cdot K^{-1}}` 是通用气体常数(Universal Gas Constant)， :math:`T` 是绝对温度。

一摩尔物质的质量为 :math:`\omega` 克，包含 :math:`6.02\times 10^{23}` 个粒子，其中 :math:`\omega` 是相对原子质量(relative atomic mass, RAM)或相对分子质量(relative molecular mass, RMM)； :math:`1~\mathrm{kmole} = \omega~\mathrm{kg}` 。 :math:`1~\mathrm{kmole}` 的物质包含 :math:`N_{A} = 6.02\times 10^{26}` 个粒子。常数 :math:`N_{A}` 称为阿伏伽德罗常数(Avogadro Number)。有时候这个常数会给成关于 :math:`1~\mathrm{mole}` 的粒子数。玻尔兹曼常数(Boltzmann Constant) :math:`k` 定义为 :math:`k = \tilde{R}N_{A}` ；理想气体热力状态方程中的 :math:`n` 是在体积 :math:`V` 中的kilomoles数，也即 :math:`n = N/N_{A}` ，其中 :math:`N` 是分子量。方程两边同时除以 :math:`m = n\omega` ，得到

.. math::
	\begin{align}
	pv = RT
	,\quad
	R = \frac{\tilde{R}}{\omega}
	\end{align}

其中 :math:`R` 称为Specific Gas Constant或简称Gas Constant。将理想气体热力状态方程改写成

.. math::
	\begin{align}
	v = v(T,p) = \frac{RT}{p}
	\end{align}

那么体积膨胀系数 :math:`\alpha` 和等温压缩系数 :math:`\beta` 就变成了

.. math::
	\begin{align}
	\alpha = \frac{1}{T}
	,\quad
	\beta = \frac{1}{p}
	\end{align}

将它们代入到 :math:`\Big(\frac{\partial e}{\partial v}\Big)_{T} = \frac{\alpha T - \beta p}{\beta}` 得到

.. math::
	\begin{align}
	\Big( \frac{\partial e}{\partial v}  \Big)_{T} = 0
	\end{align}

这意味着如果理想气体热力状态方程成立，那么内能 :math:`e` 是仅与温度有关的函数，即

.. math::
	\begin{align}
	e = e(T) = c_{v}T
	\end{align}

其中specific heat capacity :math:`c_{v}` 是一个常数，也称为热量理想气体(calorically ideal gas, or polytropic gas)。

可以利用一般表达式来联系 :math:`c_{p}` 和 :math:`c_{v}` ：

.. math::
	\begin{align}
	c_{p} = c_{v} + \frac{\alpha^{2}Tv}{\beta}
	\end{align}

对于热力理想气体，将 :math:`v = RT/p` 和 :math:`\alpha = 1/T, \beta = 1/p` 代入上式得到

.. math::
	\begin{align}
	c_{p} - c_{v} = R
	\end{align}

热稳定(thermal stability)的必要条件是 :math:`c_{v} > 0` ，机械稳定(mechanical stability)的必要条件是 :math:`\beta > 0` ，于是根据 :math:`c_{p} = c_{v} + \alpha^{2}Tv/\beta` 可知

.. math::
	\begin{align}
	c_{p} > c_{v} > 0
	\end{align}

比热容比(ratio of specific heats)或称绝热指数(adiabatic exponent) :math:`\gamma` 定义为

.. math::
	\begin{align}
	\gamma = \frac{c_{p}}{c_{v}}
	\end{align}

当它与 :math:`c_{p} - c_{v} = R` 结合起来就得到

.. math::
	\begin{align}
	c_{p} = \frac{\gamma R}{\gamma - 1}
	,\quad 
	c_{v} = \frac{R}{\gamma - 1}
	\end{align}

对于热量理想气体(calorically ideal gas, or polytropic gas)， :math:`\gamma` 是一个常数；对于热力理想气体(thermally ideal gas)， :math:`\gamma` 是一个关于温度的函数，即 :math:`\gamma = \gamma(T)` 。


为了确定热量状态方程(caloric EOS)就需要确定出定体比热容 :math:`c_{v}` 的表达式。分子理论(Molecular Theory)和能量均分原理(the principle of equipartition of energy)可以给出一个分子的specific internal energy的表达式。一般来说，一个分子无论多么复杂都有 :math:`M` 个自由度，其中3个是平动自由度，其他可能得自由度是旋转和振动。根据分子理论，如果与任何自由度相关的能量是一个二次函数，那么在适当的变量中表示该自由度方向的能量的平均值都会是 :math:`\frac{1}{2}kT` ，其中 :math:`k` 是Boltzmann constant。并且，根据能量均分原理，这对每个自由度都是一样的，因此一个分子的平均总能量是 :math:`\bar{e} = \frac{1}{2}MkT` ，从而对于 :math:`N` 个分子则可以得到specific internal energy的表达式：

.. math::
	\begin{align}
	e = N\bar{e} = \frac{1}{2}MNkT 
	\end{align}

进而可以得到

.. math::
	\begin{align}
	c_{v} = \Big(\frac{\partial e}{\partial T} \Big)_{v} = \frac{1}{2}MR
	,\quad
	c_{p} = \frac{M + 2}{2}R
	,\quad
	\gamma = \frac{M + 2}{M}   
	\end{align}


对于热力理想气体状态方程(thermal EOS for ideal gases)则有

.. math::
	\begin{align}
	e = \frac{1}{2}Mpv
	\end{align}

然而根据 :math:`c_{p} - c_{v} = R` 以及 :math:`c_{p} = \gamma R/(\gamma - 1)` ， :math:`c_{v} = R/(\gamma - 1)` 可知

.. math::
	\begin{align}
	M = \frac{2}{\gamma - 1}
	\end{align}

因此

.. math::
	\begin{align}
	e = \frac{pv}{\gamma - 1} = \frac{p}{(\gamma - 1)\rho}  
	\end{align}

对于 :math:`M=3` ，即具有三个平移自由度的单原子气体，用 :math:`R,M` 表示 :math:`c_{p},c_{v},\gamma` 的理论表达式是非常准确的。对于多原子气体，转动自由度和振动自由度对 :math:`M` 有贡献，但上述表达式与实验数据相比可能相当不准确，其对 :math:`T` 有很强的依赖性。然而，表达式 :math:`\gamma = \frac{M + 2}{M}` 针对极限情况 :math:`M=3` 和 :math:`M = \infty` 预测的不等式 :math:`1 < \gamma < 5/3` 是成立的。




能量方程
----------

根据能量守恒定律，可以定义绝热系统的总能量是一个常数，单位为 :math:`\mathrm{J} = \mathrm{N\cdot m} = \mathrm{kg \cdot m^{2} \cdot s^{-2}}` 。涉及到的能量相关量包括：

+-----------------+----------+---------------------------------------------------------------------------------------------------+
| 符号            | 含义     | 解释                                                                                              |
+=================+==========+===================================================================================================+
| :math:`\hat{E}` | 总能     | 控制体所具有的总能量                                                                              |
+-----------------+----------+---------------------------------------------------------------------------------------------------+
| :math:`e`       | 比内能   | 单位质量的内能                                                                                    |
+-----------------+----------+---------------------------------------------------------------------------------------------------+
| :math:`K`       | 比机械能 | 单位质量的动能，可以定义为 :math:`K=\frac{1}{2} [\mathbf{U} ] ^{2}`                               |
+-----------------+----------+---------------------------------------------------------------------------------------------------+
| :math:`E`       | 比能     | 单位质量的总能量，即 :math:`E = K + e` ，同时满足 :math:`E=\frac{\mathrm{d}\hat{E}}{\mathrm{d}m}` |
+-----------------+----------+---------------------------------------------------------------------------------------------------+
| :math:`h`       | 比焓     | 单位质量的焓                                                                                      |
+-----------------+----------+---------------------------------------------------------------------------------------------------+


热力学第一定律表明，物体内能的增加等于物体吸热的能量变化和对物体所作的功的总和。考虑一单位体积控制体，其内部包含固定的流体微团，跟随这一控制体查看其所含能量的时间变化率 :math:`\Big(\frac{\mathrm{d}\hat{E}}{\mathrm{d}t} \Big)_{MV}` 。定义 **热通量** :math:`\mathbf{q}` 表示单位时间、单位面积能量，是一个矢量场，单位为 :math:`\mathrm{w/m^{2}}` 或 :math:`\mathrm{kg/s^{3}}` 。热通量用来表征温度导致的每单位时间单位面积的能量变化，其与温度梯度直接相关，满足关系

.. math::
	\begin{align}
	\mathbf{q} = -k\nabla T
	\end{align}

其中 :math:`k` 表示热导率。由于热通量导致控制体在单位时间的能量变化可以如下表示：

.. math::
	\begin{align}
	\int_{\partial V}\mathbf{q} \cdot \mathrm{d}\mathbf{S} 
	= \int_{V}\nabla \cdot \mathbf{q}~\mathrm{d}V 
	= \int_{V}\nabla \cdot (-k\nabla T)~\mathrm{d}V 
	\end{align}

.. note:: 由于 :math:`\mathrm{d}\mathbf{S}` 指向流体微团表面外侧，所以上式表述的是流体微团向外输出的能量，即流体微团所减少的能量。

除了热通量引起能量的变化之外，应力做功也会引起能量变化。应力张量做功所对应的功率可以如下进行表示：

.. math::
	\begin{align}
	\int_{\partial V}\boldsymbol{\sigma} \cdot \mathbf{U} \cdot \mathrm{d}\mathbf{S}
	= \int_{\partial V} \mathrm{d}\mathbf{F} \cdot \mathbf{U}
	= \int_{\partial V}\mathrm{d}P
	= \int_{V}\nabla\cdot(\boldsymbol{\sigma} \cdot \mathbf{U})~\mathrm{d}V 
	\end{align}

其中的 :math:`P` 表示应力张量做功的功率（也即通过做功给流体微团单位时间输入的能量），同时可以将应力张量分解为压力贡献和粘性贡献：

.. math::
	\begin{align}
	\nabla \cdot (\boldsymbol{\sigma} \cdot \mathbf{U})
	= \nabla \cdot \big( (\boldsymbol{\tau} - p\mathbf{I}) \cdot \mathbf{U} \big)
	= \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U}) - \nabla \cdot (p\mathbf{U})
	\end{align}

综上，能量方程可以表示为

.. math::
	\begin{align}
	\Big(\frac{\mathrm{d}\hat{E}}{\mathrm{d}t} \Big)_{MV}
	= \int_{V}\Big(\frac{\partial }{\partial t}(\rho E) + \nabla \cdot (\rho\mathbf{U}E)\Big)\mathrm{d}V
	= -\int_{V}\nabla\cdot\mathbf{q}~\mathrm{d}V
	+ \int_{V}\nabla \cdot (\sigma \cdot \mathbf{U})~\mathrm{d}V 
	\end{align}

.. math::
	\begin{align}
	\frac{\partial \rho E}{\partial t} + \nabla \cdot (\rho\mathbf{U}E)
	= - \nabla \cdot \mathbf{q}
	+ \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U}) 
	- \nabla \cdot (p\mathbf{U})
	\end{align}

.. math::
	\begin{align}
	\frac{\partial \rho E}{\partial t}
	+ \nabla \cdot \Big(\rho\mathbf{U}(E + \frac{p}{\rho} )\Big)
	+ \nabla \cdot \mathbf{q}
	= \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U})
	\end{align}

将比能分解为 :math:`E = e + K` 即可得到 **比能方程** ：

.. math::
	\begin{align}
	\frac{\partial \big(\rho (e+K)\big)}{\partial t} 
	+ \nabla \cdot \Big(\rho\mathbf{U}(e + K - \frac{p}{\rho}) \Big)
	+ \nabla \cdot \mathbf{q}
	= \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U})
	\end{align}


进一步地，利用焓等式 :math:`e = h-p/\rho` 代入上式则可以得到 **比焓方程** ：

.. math::
	\begin{align}
	\frac{\partial \big(\rho (h+K)\big)}{\partial t}
	- \frac{\partial p}{\partial t}
	+ \nabla \cdot \Big(\rho\mathbf{U}(h + K) \Big)
	+ \nabla \cdot \mathbf{q}
	= \nabla \cdot (\boldsymbol{\tau} \cdot \mathbf{U})
	\end{align}


.. note:: 

	在OpenFOAM中，热通量项通常并不与温度变量建立起来关系，而是与比内能 :math:`e` 建立关系：

	.. math::
		\begin{align}
		\mathbf{q} = -\alpha_{\text{eff}}\nabla e
		\end{align}

	其中 :math:`\alpha_{\text{eff}}` 表示层流热扩散系数以及湍流热扩散系数之和。



对于不可压缩或者弱可压缩情况，考虑其动量方程的形式为

.. math::
	\begin{align}
	\rho\frac{\mathrm{D}\mathbf{U}}{\mathrm{D}t} = \nabla \cdot \boldsymbol{\tau} - \nabla p
	\end{align}

在方程两边同时点乘速度可以得到

.. math::
	\begin{align}
	\rho\frac{\mathrm{D}\mathbf{U}}{\mathrm{D}t}\cdot \mathbf{U}
	= \rho\frac{\mathrm{D}(\frac{1}{2}u^{2})}{\mathrm{D}t}
	= \rho\frac{\mathrm{D}K}{\mathrm{D}t}
	= (\nabla \cdot \boldsymbol{\tau}) \cdot \mathbf{U} - \mathbf{U} \cdot \nabla p   
	\end{align}

上式与比能方程相减则得到

.. math::
	\begin{align}
	\frac{\partial \rho e}{\partial t} 
	+ \nabla \cdot (\rho \mathbf{U}e) 
	+ p\nabla \cdot \mathbf{U}
	+ \nabla \cdot \mathbf{q}
	= \boldsymbol{\tau} : \nabla \mathbf{U}
	\end{align}

对于不可压缩或弱可压缩的情况， :math:`\boldsymbol{\tau} : \nabla \mathbf{U}` 可以忽略，因此最终得到 **比内能方程** ：

.. math::
	\begin{align}
	\frac{\partial \rho e}{\partial t} 
	+ \nabla \cdot (\rho \mathbf{U}e) 
	+ p\nabla \cdot \mathbf{U}
	+ \nabla \cdot \mathbf{q}
	= 0
	\end{align}





有旋流动和有势流动
====================

有旋流动
----------

涡量、涡线、涡管、涡通量
^^^^^^^^^^^^^^^^^^^^^^^^^^

流体微团有平均旋转角速度的流动为有旋流动，定量描述有旋流动的物理量为 **涡量** :math:`\boldsymbol{\Omega}` ，它就是速度矢量的旋度，即

.. math::
	\begin{align}
	\boldsymbol{\Omega} = \nabla \times \mathbf{U} = 2\boldsymbol{\omega}
	\end{align}

其物理意义是：流场中某点涡量的大小是以该点为基点的平均旋转角速度的两倍，涡量的方向与微团的瞬时转动轴重合。

在已知流动速度场的情况下，通过计算速度场的旋度就可以得到涡量场。 **涡线** 是涡量场的矢量线，是某瞬时对应的流场中的一条曲线，该瞬时曲线上每一点的涡量都和该曲线相切。在涡线上某点取微元矢量 :math:`\mathrm{d}\mathbf{l}=(\mathrm{d}x,\mathrm{d}y,\mathrm{d}z)` ，根据定义它应该与该点的涡量方向一致，所以

.. math::
	\begin{align}
	\boldsymbol{\Omega} \times \mathrm{d}\mathbf{l} = 0 
	\end{align}

上式就是直角坐标系的涡线微分方程，它包含两个独立方程，求解它可以得到两族曲线，它们的交线就是涡线族。涡线具有瞬时的概念，不同瞬时有不同的形状，而在恒定流动中它的形状保持不变。

在流场中，取一条不与涡线重合的封闭曲线 :math:`L` ，在同一时刻过 :math:`L` 上每一点作涡线，由这些涡线围成的管状曲面称为 **涡管** 。与涡线一样，涡管是瞬时概念。截面积无限小的涡管为元涡管。如果涡管周围流体的涡量皆为零，则称该涡管为孤立涡管。

通过流场中某曲面 :math:`A` 的涡量通量

.. math::
	\begin{align}
	I = \iint\limits_{A}\boldsymbol{\Omega} \cdot \mathbf{n}~\mathrm{d}A 
	\end{align}

简称为 **涡通量** 。通过涡管中任一截面的涡通量称为该涡管的 **涡管强度** ，为了方便起见，一般都会选择 :math:`\mathbf{n}` 是与 :math:`\boldsymbol{\Omega}` 同向的单位向量。


速度环量、斯托克斯定理
^^^^^^^^^^^^^^^^^^^^^^^^

**速度环量** 是速度矢量沿着有向曲线 :math:`AB` 的线积分，表示为

.. math::
	\begin{align}
	\Gamma_{AB} = \int_{AB}\mathbf{U} \cdot \mathrm{d}\mathbf{L} 
	\end{align}

其中 :math:`\mathrm{d}\mathbf{L}` 是 :math:`AB` 上的微元段矢量，由起点 :math:`A` 指向终点 :math:`B` 的方向为正方向。速度环量具有瞬时的概念，根据同一瞬时在 :math:`AB` 上的速度分布来计算，即积分时 :math:`t` 作为参变量。速度环量是标量，其正负号与有向线段正方向的定义有关。

速度环量表示在某瞬时所有在 :math:`AB` 曲线上的质点沿 :math:`AB` 运动的趋势，而沿封闭曲线 :math:`C` 的速度环量则表示某瞬时所有在 :math:`C` 上的质点沿 :math:`C` 的旋转量：

.. math::
	\begin{align}
	\Gamma_{C} = \oint_{C}\mathbf{U}\cdot\mathrm{d}\mathbf{L}
	\end{align}

涡通量与速度环量都能表征漩涡强度，它们之间存在关系为，沿包围单连通面域的有限封闭围线的速度环量等于通过此单连通面域的涡通量，即 **斯托克斯定理** ：

.. math::
	\begin{align}
	\oint_{L}\mathbf{U}\cdot\mathrm{d}\mathbf{L} 
	= \iint\limits_{A}\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A}
	= \iint\limits_{A}(\nabla\times\mathbf{U})\cdot \mathrm{d}\mathbf{A} 
	\end{align}


斯托克斯定理可以推广到多连通域。以双连通域为例， :math:`L` 为物体表面周线， :math:`C` 为包围物体的任一封闭曲线，两个曲线所围区域 :math:`A` 就是一个双连通域，通过割缝并考虑积分路径相反相消的情况，即可得到双连通域内涡通量等于沿该域外周线的速度环量和沿内周线的速度环量之差：

.. math::
	\begin{align}
	\iint\limits_{A}\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A} = \Gamma_{C} - \Gamma_{L} 
	\end{align}

根据斯托克斯定理可以分析流场中只有一个孤立涡管的情况。设孤立涡管的涡管强度为 :math:`I` ，在该涡管外任一围绕涡管的封闭曲线 :math:`C` ，作一曲面张于 :math:`C` 上并与涡管的交线为 :math:`L` ，它们所围部分曲面为 :math:`A` ，从而

.. math::
	\begin{align}
	\Gamma_{C}-\Gamma_{L} = \iint\limits_{A}\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A} = 0
	\end{align}

而 :math:`\Gamma_{L}=I` ，进而推出 :math:`\Gamma_{C}=I` ，也就是说，孤立涡管外任一围绕其的封闭曲线的速度环量等于该孤立涡管的涡管强度。






旋涡随空间的变化规律
^^^^^^^^^^^^^^^^^^^^^^^

某一时刻在涡量场内任取一涡管，在涡管任取两个截面 :math:`A_{1},A_{2}` ，它们与侧面 :math:`A'` 组成封闭曲面 :math:`A` ，封闭曲线包围的体积为 :math:`V` 。由高斯定理可以得到

.. math::
	\begin{align}
	\iint\limits_{A}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A} 
	= \iiint\limits_{V}\nabla \cdot \boldsymbol{\Omega}\mathrm{d}V 
	= \iiint\limits_{V}\nabla \cdot (\nabla \times \mathbf{U})\mathrm{d}V
	= 0
	\end{align}

因此涡量场在任何时刻都是无源场，分解为各面的通量表示（注意到侧面 :math:`A'` 的涡通量为零）则有

.. math::
	\begin{align}
	\iint\limits_{A_{1}}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A}_{1}
	+ \iint\limits_{A_{2}}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A}_{2}
	= 0
	\end{align}

将 :math:`A_{1}` 的外法向改为内法向 :math:`A_{1}'` 则有

.. math::
	\begin{align}
	\iint\limits_{A_{1}}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A}_{1}'
	= \iint\limits_{A_{2}}\boldsymbol{\Omega}\cdot\mathrm{d}\mathbf{A}_{2}
	\quad \Rightarrow \quad 
	I_{1}=I_{2}
	\end{align}

可以看到，在同一时刻，同一涡管上任一截面的涡通量即涡管强度保持不变，即为 **涡管强度守恒定理** 。对于涡管元，取截面 :math:`\delta A` 的法线方向与涡矢量一致，认为截面上的涡矢量为常矢量，则

.. math::
	\begin{align}
	\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A} = \Omega\delta A=\text{const}   
	\end{align}

由涡管强度守恒定理可以得到结论：涡管截面不可能收缩为零，即涡管不能在流体中终止或开始（否则 :math:`\boldsymbol{\Omega}` 将趋于无穷大，是不可能的）。因此涡管的存在形式只可能有两种：

1. 涡管本身成封闭形；
2. 涡管的两端位于流体边界面上（自由表面或固体表面上），或者伸展到无穷远。




旋涡随时间的变化规律
^^^^^^^^^^^^^^^^^^^^^^

**流体线** 指在运动中始终由某些确定的流体质点所组成的线。设 :math:`t` 时刻，封闭流体线 :math:`L` 在空间占有 :math:`ABA` 位置，沿此曲线的速度环量为

.. math::
	\begin{align}
	\Gamma = \oint_{L}\mathbf{U}\cdot\delta\mathbf{L}
	\end{align}

其中 :math:`\delta` 表示对空间的微分，与对时间的微分 :math:`\mathrm{d}` 进行区分。经过 :math:`\Delta t` 时段后，组成 :math:`L` 的全部流体质点一起在空间移动到新的位置 :math:`A'B'A'` 而形成新的流体线 :math:`L'` ，此时沿封闭曲线 :math:`L'` 的速度环量为

.. math::
	\begin{align}
	\Gamma' = \oint_{L'}\mathbf{U}\cdot\delta\mathbf{L}
	\end{align}

速度环量对时间的变化率定义为 :math:`\frac{\mathrm{d}\Gamma}{\mathrm{d}t}=\lim\limits_{\Delta t\to 0}\frac{\Gamma'-\Gamma}{\Delta t}` ，可以如下进行推导：

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}
	= \frac{\mathrm{d} }{\mathrm{d}t}\oint_{L}\mathbf{U}\cdot\delta\mathbf{L}
	= \oint_{L}\frac{\mathrm{d} }{\mathrm{d}t}(\mathbf{U}\cdot\delta\mathbf{L})
	= \oint_{L}\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}\cdot\delta\mathbf{L}
	+ \oint_{L}\mathbf{U}\cdot \frac{\mathrm{d}(\delta \mathbf{L})}{\mathrm{d}t}
	\end{align}

对于上式等号右侧的第二项，它由于封闭曲线形状变化而产生，可以从由两端点位移作差进行定义的 :math:`\delta\mathbf{L}` 进行解释：

.. math::
	\begin{align}
	\Delta(\delta\mathbf{L})
	= \delta\mathbf{L}_{2} - \delta\mathbf{L}_{1}
	= [(\mathbf{r}_{2} + \mathbf{U}_{2}\Delta t) - (\mathbf{r}_{1} + \mathbf{U}_{1}\Delta t)] - (\mathbf{r}_{2} - \mathbf{r}_{1})
	= \mathbf{U}_{2}\Delta t - \mathbf{U}_{1}\Delta t
	\end{align}

.. math::
	\begin{align}
	\frac{\mathrm{d}(\delta\mathbf{L})}{\mathrm{d}t}
	= \lim\limits_{\Delta t \to 0}\frac{\Delta (\delta\mathbf{L})}{\Delta t}
	= \lim\limits_{\Delta t \to 0}\frac{\mathbf{U}_{2}\Delta t - \mathbf{U}_{1}\Delta t}{\Delta t} 
	= \mathbf{U}_{2} - \mathbf{U}_{1}
	= \delta\mathbf{U}
	\end{align}

将此结果代入原式得到

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}
	= \oint_{L}\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}\cdot\delta\mathbf{L}
	  + \oint_{L}\mathbf{U}\cdot \delta\mathbf{U}
	= \oint_{L}\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}\cdot\delta\mathbf{L}
	  + \oint_{L}\delta\frac{u^{2}}{2} 
	\end{align}

其中 :math:`u` 是速度大小，又因为速度是空间的单值函数，沿封闭曲线的变化值为零，所以 :math:`\oint_{L}\delta\frac{u^{2}}{2}=0` ，从而得到

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}=\oint_{L}\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}\cdot\delta\mathbf{L}
	\end{align}


根据理想流体的动量方程，有 :math:`\frac{\mathrm{d}\mathbf{U}}{\mathrm{d}t}=\mathbf{f} - \frac{1}{\rho}\nabla p` ，代入上式则得到

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}
	= \oint_{L}\Big( \mathbf{f} - \frac{1}{\rho}\nabla p \Big) \cdot \delta\mathbf{L}
	= \oint_{L}\Big( \mathbf{f}\cdot \delta\mathbf{L} - \frac{1}{\rho}\nabla p\cdot \delta\mathbf{L} \Big)
	\end{align}

因为 :math:`\mathbf{f}` 有势，所以其沿封闭曲线的积分为零，即 :math:`\int_{L}\mathbf{f}\cdot \delta\mathbf{L}=0` 。

对于正压流体流场，密度仅仅是压强的函数，可以定义压力函数 :math:`P(p)=\int\frac{\mathrm{d}p}{\rho(p)}` ，于是 :math:`-\frac{1}{\rho}\nabla p = -\nabla P` ，所以

.. math::
	\begin{align}
	\oint_{L}-\frac{1}{\rho}\nabla p \cdot \delta\mathbf{L}
	= \oint_{L}-\nabla P \cdot \delta\mathbf{L}
	= \oint_{L}- \delta P
	= 0 
	\end{align}

代入原式即可得到 **开尔文定理（汤姆逊定理）** ：

.. math::
	\begin{align}
	\frac{\mathrm{d}\Gamma}{\mathrm{d}t}=0
	\quad \Rightarrow \quad 
	\Gamma = \text{const}  
	\end{align}

上式表明，速度环量随时间变化有三个因素：质量力无势、流体斜压（流体密度不仅取决于压强还依赖于其他变量，如温度等）以及粘性作用。如果这三个因素都不存在，则速度环量将不随时间变化。

在质量力有势，正压、理想流体中旋涡具有如下的动力学性质：

- 旋涡不生不灭定理：在质量力有势，正压、理想流体的流动中，若在某时刻某一部分流体内没有旋涡，则在以前和以后的任何时候，该部分流体内也不会有旋涡。反之，如果某一时刻某一部分流体内有旋涡，则在以前和以后的任何时刻，该部分流体内都有旋涡。
- 涡管及涡管强度保持性定理（亥姆霍兹定理）：在有势质量力作用下，正压、理想流体的流动中，某时刻组成涡管的流体质点将永远组成涡管，而且涡管强度在运动过程中保持不变。




旋涡的诱导速度
------------------

旋涡的诱导速度是孤立的旋涡带动周围无界不可压缩流体的速度。诱导速度是由流体的粘性作用引起的，粘性作用保证了旋涡与周围流体分界面上以及整个流场中速度的连续分布，因此可以在分析诱导速度分布时用速度连续假设来代替粘性作用，并仍将实际流体当作理想流体来处理，这样得出的结果与实际情况比较符合。

曲线涡的诱导速度、毕奥-萨伐公式
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

若涡线集中在一根涡管元上，此涡管元可以近似看成几何上的一条曲线，称为曲线涡，且满足当线涡的截面积 :math:`\Delta A` 趋于零时涡量趋于无穷，但是却使涡通量保持有限值，即

.. math::
	\begin{align}
	\lim\limits_{\Delta A\to 0} \int_{\Delta A}\boldsymbol{\Omega} \cdot \mathrm{d}\mathbf{A}
	= \Gamma = \text{const}  
	\end{align}

在线涡上取一微元矢量 :math:`\mathrm{d}\mathbf{L}` ，其轴线为 :math:`\mathrm{d}\mathbf{L}` 的方向， :math:`\mathbf{r}` 为该微元中心到所求点的矢径，则该微元段对任一点 :math:`A` 的诱导速度满足 **毕奥-萨伐公式** ：

.. math::
	\begin{align}
	\mathrm{d}\mathbf{U} = \frac{\Gamma}{4\pi}\frac{\mathrm{d}\mathbf{L}\times\mathbf{r}}{r^{3}}   
	\end{align}

可以看到，曲线涡微元段 :math:`\mathrm{d}\mathbf{L}` 对任意点所诱导的速度 :math:`\mathrm{d}\mathbf{U}` 大小与涡量 :math:`\Gamma` 成正比，与矢径距离 :math:`r` 的平方成反比，方向垂直于 :math:`\mathrm{d}\mathbf{L}` 与 :math:`\mathbf{r}` 所在平面，按右手螺旋法则确定。

整个曲线涡对 :math:`A` 点的诱导速度为

.. math::
	\begin{align}
	\mathbf{U} = \int_{L}\frac{\Gamma}{4\pi}\frac{\mathrm{d}\mathbf{L}\times\mathbf{r}}{r^{3}}
	= \frac{\Gamma}{4\pi}\int_{L}\frac{\mathrm{d}\mathbf{L}\times\mathbf{r}}{r^{3}}   
	\end{align}

于是诱导速度的大小为

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{4\pi}\int_{L}\frac{r\mathrm{d}L\sin\alpha }{r^{3}}=\frac{\Gamma}{4\pi}\int_{L}\frac{\sin\alpha \mathrm{d}L }{r^{2}}    
	\end{align}

其中 :math:`\alpha` 为 :math:`\mathrm{d}\mathbf{L}` 与 :math:`\mathbf{r}` 的夹角。

.. note:: 根据上式，曲线涡对自身有诱导作用，变曲率曲线涡将在流体中运动，并在运动过程不断改变自己的形状。



直线涡的诱导速度
^^^^^^^^^^^^^^^^^^^^^^^

设 :math:`AB` 有限长直线涡的涡量方向自左向右，在 :math:`AB` 上取任意微元段矢量 :math:`\mathrm{d}\mathbf{l}` ，任意点 :math:`M` 至线涡的垂直距离为 :math:`R` ， :math:`AB` 直线涡对任意点 :math:`M` 的诱导速度 :math:`\mathbf{U}` 的大小为

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{4\pi}\int_{A}^{B}\frac{\sin\theta\mathrm{d}l}{r^{2}}  
	\end{align}

根据几何关系可以得到

.. math::
	\begin{align}
	r=\frac{R}{\sin\theta}, \qquad \mathrm{d}l\sin\theta \approx r\mathrm{d}\theta  
	\end{align}

将这些几何关系代入上式则得到

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{4\pi}\int_{\theta_{1}}^{\theta_{2}}\frac{\sin\theta\mathrm{d}\theta }{R} 
	= \frac{\Gamma}{4\pi R}(\cos\theta_{1}-\cos\theta_{2})  
	\end{align}

其中 :math:`\theta_{1},\theta_{2}` 分别是 :math:`AB` 与矢径 :math:`AM` 、 :math:`BM` 的夹角。诱导速度方向垂直于纸面向外。

对于半无限长的直线涡，即 :math:`A` 端伸展至无穷远，且 :math:`BM\perp AB` ，于是有 :math:`\theta_{1}=0,\theta_{2}=\frac{\pi}{2}` ，代入上式得到

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{4\pi R} 
	\end{align}

对于两端延伸至无限长的直线涡，则有 :math:`\theta_{1}=0,\theta_{2}=\pi` ，代入上式得到

.. math::
	\begin{align}
	|\mathbf{U}| = \frac{\Gamma}{2\pi R} 
	\end{align}

它所诱导的流场是平面流动，在流动平面上看，无限长直线涡成为一个平面点涡，集中了全部涡量。

.. note:: 诱导速度场对点涡自身无意义，点涡是一个奇点，在其他所有的点，诱导速度场都是无旋的。绕任何一条包围该平面点涡的闭曲线一周，速度环量都等于 :math:`\Gamma` ，而绕任何一条不包围该平面点涡的闭曲线一周，速度环量都等于零。


两个以上的直线涡组成的涡系，它对任意点的诱导速度由涡的独立作用原理确定：

- 涡系决定的诱导速度场是每个涡诱导速度场的几何和；
- 每一个涡的运动速度等于其他涡在该涡心的诱导速度几何和。
  




自由旋涡、强迫旋涡及其组合涡的压强分布
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**兰肯涡** 是一种平面组合涡，其中心部分是以涡心为圆心的圆，其中的速度与离涡心的距离成正比，涡量为常数；外围部分的速度与距离成反比，流动有势，涡量为零。它的中心部分的流体就像刚体一样旋转，需要有外力不断推动，称为 **强迫旋涡** 。外围部分的流体在运动的开始时由中心部分的转动通过粘性作用形成，在流动稳定后，无需再加入能量，粘性也不再发挥作用，这部分流动称为 **自由旋涡** 。


设组合涡中心部分的半径为 :math:`r_{0}` ，其边缘速度为 :math:`u_{0}` ，则速度环量为 :math:`\Gamma=2\pi r_{0}u_{0}` 。外围部分流体的流动是无旋的，因此沿任意半径为 :math:`r` 的圆周其速度环量也应该等于 :math:`\Gamma` ，于是无旋流动区的速度为

.. math::
	\begin{align}
	u = \frac{\Gamma}{2\pi r} = u_{0}\frac{r_{0}}{r}  
	\end{align}

无旋流动区是恒定的，可以用欧拉积分，不考虑质量力的作用，在无旋流动区的任意点都有

.. math::
	\begin{align}
	p + \frac{\rho u^{2}}{2}=C 
	\end{align}

当 :math:`r\to\infty` 时， :math:`u_{\infty}=0` ， :math:`p=p_{\infty}` ，代入上式得到 :math:`C=p_{\infty}` ，进而可以得到

.. math::
	\begin{align}
	p = p_{\infty} - \frac{\rho u^{2}}{2}
	= p_{\infty}-\frac{\rho\Gamma^{2}}{8\pi^{2}r^{2}}
	= p_{\infty} - \frac{\rho u_{0}^{2}r_{0}^{2}}{2r^{2}}
	\quad (r \geq r_{0})
	\end{align}


对于旋涡中心部分，流动为有旋流动，流体质点的速度满足 :math:`\mathbf{U}=\boldsymbol{\omega} \times \mathbf{r}` 。考虑理想恒定流动的动量方程，不考虑质量力的作用，有

.. math::
	\begin{align}
	\mathbf{U} \cdot \nabla\mathbf{U} = -\frac{1}{\rho}\nabla p 
	\end{align}

而按右手法则可知 :math:`u_{x}=-\omega y, u_{y}=\omega x` ，因此

.. math::
	\begin{align}
	\frac{\partial u_{x}}{\partial x}=0, \quad 
	\frac{\partial u_{x}}{\partial y}=-\omega, \quad 
	\frac{\partial u_{y}}{\partial x}=\omega, \quad 
	\frac{\partial u_{y}}{\partial y}=0    
	\end{align}

代入上式得到

.. math::
	\begin{align}
	\omega^{2}\mathbf{r}=\frac{1}{\rho}\nabla p 
	\end{align}

进而可以得到

.. math::
	\begin{align}
	\int \omega^{2}\mathbf{r} \cdot \mathrm{d}\mathbf{r} 
	= \int \frac{1}{\rho}\nabla p \cdot \mathrm{d}\mathbf{r}
	\quad \Rightarrow \quad
	\int \omega^{2}\mathrm{d}(\frac{r^{2}}{2})
	= \int \frac{1}{\rho}~\mathrm{d}p
	\quad \Rightarrow \quad 
	p = \frac{\rho\omega^{2}r^{2}}{2} + C = \frac{\rho u^{2}}{2} + C  
	\end{align}


利用边界 :math:`r=r_{0}` 处 :math:`p=p_{\infty}-\frac{\rho u_{0}^{2}}{2}=p_{0}` 和 :math:`u=u_{0}` 条件代入得到

.. math::
	\begin{align}
	p = \frac{\rho u^{2}}{2} + p_{0} - \frac{\rho u_{0}^{2}}{2}
	= p_{\infty} + \frac{\rho u^{2}}{2} - \rho u_{0}^{2}
	= p_{\infty} + \frac{\rho \omega^{2}r^{2}}{2} - \rho\omega^{2}r_{0}^{2}
	\quad (r \leq r_{0})
	\end{align}


.. note:: 

	- 当 :math:`r>r_{0}` 时，速度随 :math:`r` 的减小按双曲线规律增加，而压强则减小，在 :math:`r=r_{0}` 处压强降低到
	  
	.. math::
		\begin{align}
		p_{0} = p_{\infty} - \frac{\rho\Gamma^{2}}{8\pi^{2}r_{0}^{2}}=p_{\infty} - \frac{\rho u_{0}^{2}}{2}  
		\end{align}

	- 当 :math:`r<r_{0}` 时，压强按抛物线规律分布，在中心点 :math:`r=0` 处压强为最小值
	  
	.. math::
		\begin{align}
		p_{c} = p_{\infty} - \rho\omega^{2}r_{0}^{2} = p_{\infty} - \rho u_{0}^{2}
		\end{align}



有势流动
-----------

速度势函数
^^^^^^^^^^^^

速度势函数 :math:`\varphi` 是与空间及时间有关的标量函数，满足

.. math::
	\begin{align}
	\mathbf{U} = \nabla \varphi
	\end{align}

即速度矢量是速度势函数的梯度。可以通过积分运算由速度确定速度势：

.. math::
	\begin{align}
	\int_{M_{0}}^{M}\mathbf{U}\cdot\mathrm{d}\mathbf{r}
	= \int_{M_{0}}^{M}\nabla\varphi\cdot\mathrm{d}\mathbf{r}
	= \int_{M_{0}}^{M}\mathrm{d}\varphi 
	= \varphi_{M} - \varphi_{M_{0}}
	\end{align}

其中 :math:`M` 和 :math:`M_{0}` 为某时刻流场中的任意点， :math:`M_{0}` 作为已知点其 :math:`\varphi` 值可以任意给定。

速度势函数具有下列性质：

- :math:`\varphi` 可以加上任意常数而不影响对流速场的描述，因为在微分运算求流速场时常数会被消去。
- 满足 :math:`\varphi` 为常数的曲面称为等势面，它的法线方向即 :math:`\nabla\varphi` 的方向和速度矢量的方向重合。
- 在单连通域中任意两点 :math:`A` 、 :math:`B` 的速度势之差等于沿两点之间任意曲线的速度环量，因为在单连通域中 :math:`\varphi_{A}-\varphi_{B}=\int_{B}^{A}\mathbf{U}\cdot\mathrm{d}\mathbf{r}` 与积分路径无关。
- 在不可压缩流体中，速度势函数满足拉普拉斯方程，也即不可压缩流体的速度势函数是调和函数： :math:`\nabla\cdot\mathbf{U}=\nabla\cdot(\nabla\varphi)=\nabla^{2}\varphi=0` 。
- 速度势函数在不可压缩流体内部不可能有极大值与极小值，极值只能出现在边界上。
  


不可压缩流体的流函数
^^^^^^^^^^^^^^^^^^^^^^

对于不可压缩流体的平面流动，其连续性方程可以写为

.. math::
	\begin{align}
	\frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y}=0
	\quad \Rightarrow \quad 
	\frac{\partial u_{x}}{\partial x} - \frac{\partial (-u_{y})}{\partial y} = 0 
	\end{align}

上式是 :math:`u_{x}\mathrm{d}y-u_{y}\mathrm{d}x` 可以写成全微分的充分必要条件。于是，定义不可压缩流体平面流动的 **流函数** :math:`\psi` 满足

.. math::
	\begin{align}
	\mathrm{d}\psi = u_{x}\mathrm{d}y - u_{y}\mathrm{d}x
	\end{align}

其中流函数与流速之间满足 :math:`\frac{\partial \psi}{\partial x}=-u_{y}` 和 :math:`\frac{\partial \psi}{\partial y}=u_{x}` 的关系。


.. note:: 

	对于二维极坐标的情况，则有




对于平面流动，流线方程可以简化为

.. math::
	\begin{align}
	\frac{\mathrm{d}x}{u_{x}}=\frac{\mathrm{d}y}{u_{y}}
	\end{align}

也即在流线上一定满足

.. math::
	\begin{align}
	\mathrm{d}\psi = -u_{y}\mathrm{d}x + u_{x}\mathrm{d}y = 0
	\quad \Rightarrow \quad 
	\psi = \text{const}
	\end{align}

因此， **等流函数线就是流线** ，等流函数线的切线与速度矢量方向一致。




在一不可压缩流体的平面，任取 :math:`A` 、 :math:`B` 两点的流函数数值分别为 :math:`\psi_{A}` 、 :math:`\psi_{B}` ，通过两点间任意连线的线流量是 :math:`q=\int_{A}^{B}\mathrm{d}q` 。在 :math:`AB` 线上任取线段 :math:`\mathrm{d}s` ，通过 :math:`\mathrm{d}s` 的线流量为

.. math::
	\begin{align}
	\mathrm{d}q = \mathbf{U} \cdot \mathbf{n}~\mathrm{d}s  
	\end{align}

其中 :math:`\mathbf{U}` 为通过 :math:`AB` 线的流速， :math:`\mathbf{n}` 为小线段 :math:`\mathrm{d}s` 的法向单位向量。根据几何关系以及速度势函数定义，可以得到

.. math::
	\begin{align}
	\mathbf{n} = (\frac{\mathrm{d}y}{\mathrm{d}s}, -\frac{\mathrm{d}x}{\mathrm{d}s})
	, \quad 
	\mathbf{U}=(\frac{\partial \psi}{\partial y}, -\frac{\partial \psi}{\partial x} ) 
	\end{align}

代入上式则得到

.. math::
	\begin{align}
	\mathrm{d}q = \mathbf{U}\cdot\mathbf{n}\mathrm{d}s 
	= (\frac{\partial \psi}{\partial y}\frac{\mathrm{d}y}{\mathrm{d}s} 
	  + \frac{\partial \psi}{\partial x}\frac{\mathrm{d}x}{\mathrm{d}s})\mathrm{d}s
	= \frac{\partial \psi}{\partial y}\mathrm{d}y + \frac{\partial \psi}{\partial x}\mathrm{d}x  
	= \mathrm{d}\psi 
	\end{align}

也即

.. math::
	\begin{align}
	q = \int_{A}^{B}\mathrm{d}q = \int_{A}^{B}\mathrm{d}\psi = \psi_{B} - \psi_{A} 
	\end{align}


可以看到，**任意两流线间的流量等于这两条流线的势函数值之差** ，或者说，过任意两点连线的流量等于这两点的流函数值之差。

.. note:: 同时，由过任意两点连线的弯曲走向可以判断出 :math:`\mathbf{n}` 的方向，进而可以根据 :math:`\psi_{B}` 和 :math:`\psi_{A}` 的大小关系确定 :math:`\mathbf{U}` 与 :math:`\mathbf{n}` 的夹角是锐角还是钝角，从而判断出流动方向。




此外，与速度势函数类似，在有势流动中，流函数 :math:`\psi` 也满足拉普拉斯方程，也是调和函数，因此其在流体内部也不可能有极大值和极小值：

.. math::
	\begin{align}
	\nabla \times \mathbf{U} = 0
	\quad \Rightarrow \quad 
	-\frac{\partial }{\partial x}\Big(\frac{\partial \psi}{\partial x} \Big) - \frac{\partial }{\partial y}\Big(\frac{\partial \psi}{\partial y} \Big) =0
	\quad \Rightarrow \quad 
	\nabla^{2}\psi = 0
	\end{align}



复势、复速度
^^^^^^^^^^^^^^^^

在不可压缩平面势流中，速度势函数 :math:`\varphi` 和流函数 :math:`\psi` 同时存在，而且满足 **柯西-黎曼条件** ：

.. math::
	\begin{align}
	& u_{x} = \frac{\partial \varphi}{\partial x} = \frac{\partial \psi}{\partial y} \\
	& u_{y} = \frac{\partial \varphi}{\partial y} = -\frac{\partial \psi}{\partial x}   
	\end{align}

根据上式，可以得到

.. math::
	\begin{align}
	\frac{\partial \varphi}{\partial x}\Big(-\frac{\partial \psi}{\partial x} \Big) 
	= \frac{\partial \psi}{\partial y}\Big( \frac{\partial \varphi}{\partial y}  \Big) 
	\quad \Rightarrow \quad 
	\frac{\partial \varphi}{\partial x}\frac{\partial \psi}{\partial x} + \frac{\partial \varphi}{\partial y}\frac{\partial \psi}{\partial y}=0
	\end{align}

上式表明曲线 :math:`\varphi(x,y)` 和曲线 :math:`\psi(x,y)` 正交，也即 **流线（等流函数线）和等势线是互相正交的两族曲线** ，所以等势线也是过流断面线。


由于不可压缩流体平面势流中速度势函数 :math:`\varphi` 和流函数 :math:`\psi` 是满足柯西-黎曼条件的一对调和函数（共轭调和函数），因此它们可以构成一个解析的复变函数，称为 **复势** ：

.. math::
	\begin{align}
	W(z) = \varphi(x,y) + \mathrm{i}\psi(x,y)
	\end{align}

它的实部代表速度势，虚部代表流函数。它可以相差一任意常数，而不影响求解的流速场。任何一个不可压缩平面势流必然具有一个确定的复势，反之，一个确定的复势则代表某一个不可压缩平面势流。如果已知平面势流的复势，便可以求得流场中任意点处的速度，称复势的导数为 **复速度** ：

.. math::
	\begin{align}
	\overline{V} = \frac{\mathrm{d}W}{\mathrm{d}z} 
	= u_{x} - \mathrm{i}u_{y} 
	= |\mathbf{U}|\mathrm{e}^{-\mathrm{i}\theta}
	\end{align}


复速度沿封闭围线 :math:`C` 的积分，其实部为沿该封闭围线的速度环量，而虚部则为通过围线 :math:`C` 的通量：

.. math::
	\begin{align}
	\int_{C}\overline{V}\mathrm{d}z 
	= \int_{C}\frac{\mathrm{d}W}{\mathrm{d}z}\mathrm{d}z 
	= \int_{C}\mathrm{d}W 
	= \int_{C}\mathrm{d}\varphi  + \mathrm{i}\int_{C}\mathrm{d}\psi 
	= \Gamma + \mathrm{i}q    
	\end{align}




势流叠加原理
^^^^^^^^^^^^^^^

由于势流的基本方程——拉普拉斯方程是一个线性齐次方程，因此几个速度势 :math:`\varphi_{1},\varphi_{2},\cdots,\varphi_{k}` 为已知的简单势流，叠加起来可以得到一个较复杂的势流，它的速度势 :math:`\varphi` 等于被叠加的简单势流的速度势之和：

.. math::
	\begin{align}
	\varphi = \varphi_{1} + \varphi_{2} + \cdots + \varphi_{k}
	\end{align}


叠加所得势流在任一点的流速矢量等于被叠加势流在该点的流速矢量之和，即

.. math::
	\begin{align}
	\mathbf{U} = \nabla \varphi 
	= \nabla (\varphi_{1}+\varphi_{2}) 
	= \nabla\varphi_{1}+\nabla\varphi_{2}
	= \mathbf{U}_{1} + \mathbf{U}_{2}
	\end{align}


.. note:: 

	同理，叠加所得势流的流函数也等于被叠加势流的流函数之和，即

	.. math::
		\begin{align}
		\psi = \psi_{1} + \psi_{2}
		\end{align}



直线等速流动
""""""""""""""""

在整个流场中速度为 :math:`U_{\infty}` 的均匀直线流动。用直角坐标表示，如果速度 :math:`U_{\infty}` 与 :math:`x` 轴的夹角为 :math:`\alpha` ，则 :math:`x,y` 轴向的流速分量分别为

.. math::
	\begin{align}
	& u_{x} = \frac{\partial \varphi}{\partial x} = \frac{\partial \psi}{\partial y} = U_{\infty}\cos\alpha \\
	& u_{y} = \frac{\partial \varphi}{\partial y} = - \frac{\partial \psi}{\partial x} = U_{\infty}\sin\alpha
	\end{align}

根据

.. math::
	\begin{align}
	\mathrm{d}\psi = \frac{\partial \psi}{\partial x}\mathrm{d}x + \frac{\partial \psi}{\partial y}\mathrm{d}y
	= - U_{\infty}\sin\alpha \mathrm{d}x + U_{\infty}\cos\alpha \mathrm{d}y
	\end{align}

积分得到

.. math::
	\begin{align}
	\psi = - U_{\infty} \sin\alpha x + U_{\infty} \cos\alpha y + C_{1}
	\end{align}

根据

.. math::
	\begin{align}
	\mathrm{d}\varphi = \frac{\partial \varphi}{\partial x}\mathrm{d}x + \frac{\partial \varphi}{\partial y}\mathrm{d}y
	= U_{\infty}\cos\alpha \mathrm{d}x + U_{\infty}\sin\alpha \mathrm{d}y
	\end{align}

积分得到

.. math::
	\begin{align}
	\varphi = U_{\infty}\cos\alpha x + U_{\infty} \sin\alpha y + C_{2}
	\end{align}

令过 :math:`O` 点的流线和等势线上的 :math:`\varphi` 值及 :math:`\psi` 值均为 :math:`0` ，则 :math:`C_{1}=C_{2}=0` 。故

.. math::
	\begin{align}
	\psi = - U_{\infty} x \sin\alpha + U_{\infty} y \cos\alpha
	\qquad
	\varphi = U_{\infty} x \cos\alpha + U_{\infty} y \sin\alpha
	\end{align}

显然流线与等势线都分别是一族平行直线，并互相垂直。相应的复势表达式为

.. math::
	\begin{align}
	W(z) = \varphi(x,y) + \mathrm{i}\psi(x,y)
	= U_{\infty}(\cos\alpha - \mathrm{i}\sin\alpha)(x+\mathrm{i}y)
	= U_{\infty} z e^{-\mathrm{i}z}
	= \overline{U}_{\infty} z
	\end{align}

可以看到复势为复数 :math:`z` 的线性函数，其系数为复速度 :math:`\overline{U}_{\infty}` 。


平面点源和点汇
"""""""""""""""""""""

考虑理想化的基本平面势流，平面点源(汇)是与流动平面垂直的一条直线，流体沿着与该线垂直的方向，以一定流量向四处均匀流出(流入)。该线在流动平面上表现为一个点。直线源(汇)单位长度上的流量 :math:`q` 称为平面点源(汇)的强度。

取极坐标系 :math:`(r,\theta)` ，以点源为原点、 :math:`r` 为半径的圆，由对称性说明只存在径向速度 :math:`u_{r}` ，并根据流动的连续性条件，流体通过任意半径 :math:`r` 圆柱面的流量应该相等，则

.. math::
	\begin{align}
	u_{r} = \frac{q}{2\pi r}
	,\qquad
	u_{\theta} = 0
	\end{align}

对于点源 :math:`q>0` ， :math:`u_{r} > 0` ，对于点汇 :math:`q < 0` ， :math:`u_{r} < 0` ，点源(汇)处流速为无穷大。故点源(汇)本身是一个奇点。点源(汇)的流场是有势并轴对称的。由

.. math::
	\begin{align}
	\mathrm{d}\varphi = \frac{\partial \varphi}{\partial r}\mathrm{d}r + \frac{\partial \varphi}{\partial \theta}\mathrm{d}\theta
	= u_{r}\mathrm{d}r = \frac{q}{2\pi r}\mathrm{d}r
	\end{align}

积分得到

.. math::
	\begin{align}
	\varphi = \frac{q}{2\pi}\ln r + C_{1}
	\end{align}

根据

.. math::
	\begin{align}
	\mathrm{d}\psi = \frac{\partial \psi}{\partial r}\mathrm{d}r + \frac{\partial \psi}{\partial \theta}\mathrm{d}\theta
	= r u_{r} \mathrm{d}\theta = \frac{q}{2\pi}\mathrm{d}\theta
	\end{align}

积分得到

.. math::
	\begin{align}
	\psi = \frac{q}{2\pi}\theta + C_{2}
	\end{align}

令 :math:`C_{1} = C_{2} = 0` ，得到

.. math::
	\begin{align}
	& \varphi = \frac{q}{2\pi}\ln r = \frac{q}{2\pi} \ln\sqrt{x^{2} + y^{2}} \\
	& \psi = \frac{q}{2\pi} \theta = \frac{q}{2\pi} \arctan \frac{y}{x}
	\end{align}

由上述结果可知，点源的等势线为 :math:`r=C` ，即一族半径不同的同心圆。流线为 :math:`\theta = C` ，是一族从圆心出发的半射线。点源(汇)的复势为

.. math::
	\begin{align}
	W(z) = \varphi + \mathrm{i}\psi = \frac{q}{2\pi}(\ln r + \mathrm{i}\theta) = \frac{q}{2\pi}\ln z
	\end{align}

上式表明平面点源(汇)的复势是复数 :math:`z` 的对数函数，其系数是实数 :math:`\frac{q}{2\pi}` 。其复速度可以由复势求导得到

.. math::
	\begin{align}
	\overline{V} = \frac{\mathrm{d}W}{\mathrm{d}z} = \frac{q}{2\pi z} = \frac{q}{2\pi r}e^{-\mathrm{i}\theta}
	\end{align}

其中 :math:`\theta` 为复平面 :math:`z` 点的辐角。复势在奇点处不解析，所以复速度沿着任一包围奇点的封闭围线 :math:`C` 的积分不为零，而得到

.. math::
	\begin{align}
	\int_{C} \overline{V}\mathrm{d}z = \int_{C} \frac{\mathrm{d}W}{\mathrm{d}z}\mathrm{d}z
	= \int_{C} \frac{q}{2\pi z} \mathrm{d}z = 2\pi\mathrm{i}\frac{q}{2\pi} = q\mathrm{i}
	\end{align}

表明其实部即速度环量为零，其虚部即流量为点源(汇)的强度，它反映了点源(汇)的奇点条件。




平面点涡
""""""""""""

单个直线涡的诱导流速场为一平面势流，该直线涡在流动平面上表现为一个点，取极坐标系 :math:`(r,\theta)` ，则位于原点强度为 :math:`\Gamma` （ :math:`\Gamma>0` 对应逆时针方向旋转）的点涡诱导的速度场为

.. math::
	\begin{align}
	u_{\theta} = \frac{\Gamma}{2\pi r}
	,\qquad
	u_{r} = 0
	\end{align}

原点处速度为无穷大，所以点涡本身为一奇点。涡外的流场是有势的，故又称为势涡。其速度势为

.. math::
	\begin{align}
	\varphi = \frac{\Gamma}{2\pi}\theta = \frac{\Gamma}{2\pi}\arctan\frac{y}{x}
	\end{align}

流函数为

.. math::
	\begin{align}
	\psi = - \frac{\Gamma}{2\pi}\ln r = -\frac{\Gamma}{2\pi} \ln\sqrt{x^{2} + y^{2}}
	\end{align}

相应的复势为

.. math::
	\begin{align}
	W(z) = - \frac{\Gamma}{2\pi} \mathrm{i} \ln z
	\end{align}

即点涡的复势是复数 :math:`z` 的对数函数，其系数为虚数 :math:`-\frac{\Gamma}{2\pi}\mathrm{i}` ，流线是以点涡为圆心的同心圆族，等势线是发自原点的射线族。点涡流场的复速度为

.. math::
	\begin{align}
	\overline{V} = \frac{\mathrm{d}W}{\mathrm{d}z} = - \frac{\Gamma}{2\pi z}\mathrm{i}
	\end{align}

复速度沿包围奇点任一封闭围线 :math:`C` 的积分为

.. math::
	\begin{align}
	\int_{C} \frac{\mathrm{d}W}{\mathrm{d}z} \mathrm{d}z
	= \int_{C} \frac{-\Gamma}{2\pi z}\mathrm{i}\mathrm{d}z
	= 2\pi \mathrm{i} \Big( \frac{-\Gamma}{2\pi}\mathrm{i} \Big)
	= \Gamma
	\end{align}

表明其实部即速度环量为点涡强度，而其虚部即流量为零。这反映了点涡的奇点条件。

.. note:: 

	平面点源和点涡都是孤立奇点，上面得到了单个奇点放置在原点处形成的势流场。当它们作为基本势流和其他势流叠加时不一定在原点位置，假设在 :math:`z_{0}(x_{0},y_{0})` 处。此时应将坐标轴平移，将原点移至 :math:`z_{0}(x_{0},y_{0})` ，在这个相对坐标系中使用已经推导得到的公式，用 :math:`x-x_{0}` 取代 :math:`x` ， :math:`y - y_{0}` 取代 :math:`y` ，用 :math:`z - z_{0}` 取代 :math:`z` 即可。








平面偶极子势流
"""""""""""""""""""""""""""""""""""

考虑等强度源和汇的叠加，即相距 :math:`\Delta h` 、强度值相等为 :math:`q` 的点源 :math:`A\Big(-\frac{\Delta h}{2}, 0\Big)` 和点汇 :math:`B\Big(\frac{\Delta h}{2}\Big)` 叠加后的流场，则其速度势和流函数分别为

.. math::
	\begin{align}
	& \varphi = \frac{q}{2\pi}\ln r_{A} - \frac{q}{2\pi}\ln r_{B} = \frac{q}{2\pi}\ln \frac{r_{A}}{r_{B}} \\
	& \psi = \frac{q}{2\pi}(\theta_{A} - \theta_{B}) = -\frac{q}{2\pi}\theta_{P}
	\end{align}

其中 :math:`\theta_{P}` 为动点 :math:`P` 与源汇连线之间的夹角。流线上 :math:`\psi = \text{constant}` ，即 :math:`\theta_{P} = C` ，由几何学知识可知流线是直径在 :math:`y` 轴上的一族共弦圆。等势线则是与它们正交的另一圆族，如图所示。

如果源汇之间的间距逐渐减小的同时，源汇的强度逐渐增大，满足

.. math::
	\begin{align}
	\lim_{\substack{\Delta h \to 0 \\ q \to \infty}} q \cdot \Delta h = m
	\end{align}

其中 :math:`m` 为有限常数值，这样的一对源汇称为偶极子。称 :math:`m` 为偶极子强度，并规定汇指向源的方向为偶极子的方向。

对于强度为 :math:`m` ，指向 :math:`-x` 方向的偶极子，如图所示，该偶极子的速度势

.. math::
	\begin{align}
	\varphi = \lim_{\substack{\Delta h \to 0 \\ q \to \infty}}\frac{q}{2\pi}\ln\frac{r_{A}}{r_{B}}
	= \lim_{\substack{\Delta h \to 0 \\ q \to \infty}}\frac{q}{2\pi}\ln\Big( 1 + \frac{r_{A} - r_{B}}{r_{B}} \Big)
	= \lim_{\substack{\Delta h \to 0 \\ q \to \infty}}\frac{q}{2\pi}\frac{r_{A} - r_{B}}{r_{B}}
	= \lim_{\substack{\Delta h \to 0 \\ q \to \infty}}\frac{q\Delta h}{2\pi}\frac{\cos\theta_{A}}{r_{B}}
	= \frac{m}{2\pi}\frac{\cos\theta}{r}
	= \frac{m}{2\pi}\frac{x}{x^{2}+y^{2}}
	\end{align}

令 :math:`\varphi = C_{1}` ，得到等势线方程为

.. math::
	\begin{align}
	\Big(x - \frac{m}{4\pi C_{1}}\Big)^{2} + y^{2} = \Big( \frac{m}{4\pi C_{1}} \Big)^{2}
	\end{align}

等势线是半径为 :math:`\frac{m}{4\pi C_{1}}` ，圆心为 :math:`\Big( \frac{m}{4\pi C_{1}}, 0 \Big)` ，且与 :math:`y` 轴在原点相切的圆族，如图所示。

偶极子的流函数为

.. math::
	\begin{align}
	\psi = \lim_{\substack{\Delta h \to 0 \\ q \to \infty}} -\frac{q}{2\pi}\theta_{p}
	= \lim_{\substack{\Delta h \to 0 \\ q \to \infty}} -\frac{q\Delta h}{2\pi}\frac{\sin\theta_{A}}{r_{B}}
	= -\frac{m}{2\pi}\frac{\sin\theta}{r}
	= -\frac{m}{2\pi}\frac{y}{x^{2} + y^{2}}
	\end{align}

令 :math:`\psi = C_{2}` ，得到流线方程为

.. math::
	\begin{align}
	x^{2} + \Big(y + \frac{m}{4\pi C_{2}}\Big)^{2} = \Big(\frac{m}{4\pi C_{2}}\Big)^{2}
	\end{align}

流线是半径为 :math:`\frac{m}{4\pi C_{2}}` ，圆心为 :math:`\Big(0, \frac{m}{4\pi C_{2}}\Big)` 且与 :math:`x` 轴在原点相切的圆族，如图所示。

平面偶极子的流速场用直角坐标系表示为

.. math::
	\begin{align}
	u_{x} = \frac{m}{2\pi}\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}}
	,\quad
	u_{y} = -\frac{m}{2\pi}\frac{2xy}{(x^{2} + y^{2})^{2}}
	\end{align}

用极坐标表示为

.. math::
	\begin{align}
	u_{r} = -\frac{m\cos\theta}{2\pi r^{2}}
	,\quad
	u_{\theta} = -\frac{m\sin\theta}{2\pi r^{2}}
	\end{align}

平面偶极子复势的表达式为

.. math::
	\begin{align}
	W(z) = \varphi + \mathrm{i}\psi
	= \frac{m}{2\pi r^{2}}(x - \mathrm{i}y)
	= \frac{m}{2\pi z}
	\end{align}

绕原点任意封闭围线上复速度的积分为零，表明绕原点任意封闭围线的速度环量和穿过该封闭围线的流量均为零。

.. note:: 如果偶极子方向与 :math:`x` 轴相同，则需要将以上得到的 :math:`-x` 方向偶极子的全部公式都改变符号。



二维钝头流线型半无穷体的绕流
"""""""""""""""""""""""""""""""""

考虑直线等流速与点源的叠加。设无穷远处均匀来流 :math:`U_{\infty}` 平行于 :math:`x` 轴，为了简便起见把点源放在原点位置，如图所示。该直线等速流的速度势和流函数为

.. math::
	\begin{align}
	& \varphi_{1} = U_{\infty}x = U_{\infty}r\cos\theta \\
	& \psi_{1} = U_{\infty}y = U_{\infty}r\sin\theta
	\end{align}

将它们分别与点源的速度势和流函数叠加得到

.. math::
	\begin{align}
	& \varphi = \varphi_{1} + \varphi_{2} = \frac{q}{2\pi}\ln r + U_{\infty}r\cos\theta \\
	& \psi = \psi_{1} + \psi_{2} = \frac{q}{2\pi}\theta + U_{\infty}r\sin\theta
	\end{align}

流速场为

.. math::
	\begin{align}
	& u_{r} = \frac{\partial\varphi}{\partial r} = \frac{q}{2\pi r} + U_{\infty}\cos\theta \\
	& u_{\theta} = \frac{1}{r}\frac{\partial \varphi}{\partial \theta} = -U_{\infty}\sin\theta
	\end{align}

令 :math:`\psi = 0` ，确定出零流线方程为

.. math::
	\begin{align}
	\frac{q}{2\pi}\theta = -U_{\infty}r\sin\theta
	\end{align}

当 :math:`\theta=0, \sin\theta=0` 时，无论 :math:`r` 是何值，方程都满足，所以通过原点的水平线 :math:`OA` 是零流线，如图所示。

流速等于零的驻点 :math:`S` 位置可以确定如下。根据

.. math::
	\begin{align}
	u_{\theta} = -U_{\infty}r\sin\theta = 0
	\end{align}

可知驻点 :math:`S` 的极角可以是 :math:`\theta=0` 或 :math:`\theta = \pi` 两种情况。再根据

.. math::
	\begin{align}
	u_{r} = \frac{q}{2\pi r} + U_{\infty}\cos\theta = 0
	\end{align}

得到

.. math::
	\begin{align}
	r = -\frac{q}{2\pi U_{\infty}\cos\theta}
	\end{align}

由于 :math:`\theta=0` 代入上式后 :math:`r` 将为负值，这是不可能的，因此只有 :math:`\theta=\pi` 的情况，代入上式得到

.. math::
	\begin{align}
	r = \frac{q}{2\pi U_{\infty}}
	\end{align}

表明驻点 :math:`S` 的直角坐标系坐标为 :math:`\Big(-\frac{q}{2\pi U_{\infty}}, 0\Big)` ，极坐标系坐标为 :math:`\Big(\frac{q}{2\pi U_{\infty}}, \pi\Big)` 。把驻点位置代入流函数表达式得到驻点处的流函数值为

.. math::
	\begin{align}
	\psi_{S} = \frac{q}{2\pi}\pi + U_{\infty}r\sin\pi = \frac{q}{2}
	\end{align}

则通过驻点的流线方程为

.. math::
	\begin{align}
	\psi = \frac{q}{2\pi}\theta + U_{\infty}r\sin\theta = \frac{q}{2}
	\end{align}

对于 :math:`\theta=\pi, \sin\theta=0` ，上式对任意 :math:`r` 值都满足，故 :math:`BS` 是 :math:`\psi = \frac{q}{2}` 流线的一部分。当 :math:`\theta=\frac{\pi}{2}` 或 :math:`\frac{3\pi}{2}` 时，流线相应的 :math:`r` 值为

.. math::
	\begin{align}
	r = \frac{1}{U_{\infty}\sin\theta}\frac{q}{2}(1 - \frac{\theta}{\pi}) = \frac{q}{4U_{\infty}}
	\end{align}

对应图中的C、D两点。流动对于 :math:`x` 轴是对称的，所以流线对于 :math:`x` 轴也是对称的，过驻点流线构成钝头流线型。在无穷远处，由于点源的影响消失，流线趋于与 :math:`x` 轴平行的直线。实际上，当 :math:`\theta \to 0` 时，过驻点流线上点的 :math:`y` 坐标值为 :math:`r\sin\theta \to \frac{q}{2U_{\infty}}` ，可见过驻点流线在下游无穷远处开口宽度为 :math:`\frac{q}{U_{\infty}}` 。

设想用一刚性薄片按照上述过驻点流线的形状弯成柱面，从垂直于流动平面的方向插入流场，将不会影响内外两部分流场的流动。这就是流线与固壁的等价原理。如果按过驻点流线的形状制成半无穷柱体放入流场相应位置，取代点源，此时内部流动将不再存在，但外部流动仍不会改变。所以点源对等速直线流动的影响与这个半无穷柱体对等速直线流动的影响是等价的。上面我们得到的流场也就是等速直线流动绕过半无穷柱体的绕流解。从这个意义上讲，点源这个抽象的流动变成了一个具体实在的概念。


圆柱绕流
""""""""""""

考虑等速直线流动与平面偶极子势流的叠加。假设直线等速流沿 :math:`x` 轴方向流速为 :math:`U_{\infty}` ，偶极子置于原点，如图所示。这两个流动叠加所得新的速度势和流函数为

.. math::
	\begin{align}
	& \varphi = U_{\infty}x + \frac{m}{2\pi}\frac{\cos\theta}{r}
	= \Big( U_{\infty}r + \frac{m}{2\pi}\frac{1}{r} \Big)\cos\theta \\
	& \psi = U_{\infty}y - \frac{m}{2\pi}\frac{\sin\theta}{r}
	= \Big( U_{\infty}r - \frac{m}{2\pi}\frac{1}{r} \Big)\sin\theta
	\end{align}

相应的复势为

.. math::
	\begin{align}
	W(z) = U_{\infty}z + \frac{m}{2\pi}\frac{1}{z}
	\end{align}

:math:`\psi = 0` 的流线方程为

.. math::
	\begin{align}
	\Big( U_{\infty}r - \frac{m}{2\pi r} \Big)\sin\theta = 0
	\quad\Rightarrow\quad
	\theta=0 ~~\text{or}~~
	\theta = \pi ~~\text{or}~~
	r = \sqrt{\frac{m}{2\pi U_{\infty}}}
	\end{align}

记 :math:`a = \sqrt{\frac{m}{2\pi U_{\infty}}}` ，则 :math:`x` 轴和圆周 :math:`r=a` 为零流线，这表明等速直线流 :math:`U_{\infty}` 和强度为 :math:`m` 的偶极子叠加后的流场在 :math:`r \ge a` 的区域中，相当于等速直线流 :math:`U_{\infty}` 对半径 :math:`a = \sqrt{\frac{m}{2\pi U_{\infty}}}` 的圆柱绕流，如图所示。于是，该流场的速度势和流函数可以改写为圆柱半径表达的形式：

.. math::
	\begin{align}
	& \varphi = U_{\infty}r \cos\theta \Big( 1 + \frac{a^{2}}{r^{2}} \Big) \\
	& \psi = U_{\infty}r \sin\theta \Big( 1 - \frac{a^{2}}{r^{2}} \Big)
	\end{align}

相应的复势为

.. math::
	\begin{align}
	W(z) = U_{\infty}\Big( z + \frac{a^{2}}{z} \Big)
	\end{align}

其流速场为

.. math::
	\begin{align}
	& u_{r} = \frac{\partial \varphi}{\partial r} = U_{\infty}\cos\theta \Big( 1 - \frac{a^{2}}{r^{2}} \Big) \\
	& u_{\theta} = \frac{1}{r}\frac{\partial \varphi}{\partial \theta} = -U_{\infty}\sin\theta \Big( 1 + \frac{a^{2}}{r^{2}} \Big)
	\end{align}

由此可以得到圆柱表面上的流速分布。当 :math:`r=a` 时，有

.. math::
	\begin{align}
	u_{r} = 0 ,\qquad u_{\theta} = -2U_{\infty}\sin\theta
	\end{align}

可以看到在圆柱表面 :math:`\theta=0` 和 :math:`\theta=\pi` 的点上， :math:`u_{\theta}=0` ，即为驻点，如图所示的 :math:`S_{1}` 和 :math:`S_{2}` 。而在 :math:`\theta = \pm \frac{\pi}{2}` 的点上 :math:`\sin\theta = \pm 1` ，流速的绝对值达到最大 :math:`u_{\max} = 2U_{\infty}` 。如果不计质量力，那么圆柱面上的压强分布满足

.. math::
	\begin{align}
	\frac{p}{\rho} + \frac{u^{2}}{2} = \frac{p}{\rho} + \frac{u_{\theta}^{2}}{2} = \frac{p_{\infty}}{\rho} + \frac{U_{\infty}^{2}}{2}
	\end{align}

.. math::
	\begin{align}
	p = p_{\infty} + \frac{\rho}{2}(U_{\infty}^{2} - u_{\theta}^{2}) = p_{\infty} + \frac{\rho U_{\infty}^{2}}{2}(1 - 4\sin^{2}\theta)
	\end{align}

或者以压强差分布的无量刚形式表示为

.. math::
	\begin{align}
	C_{p} = \frac{p - p_{\infty}}{\rho U_{\infty}^{2}/2} = 1 - 4\sin^{2}\theta
	\end{align}

称为压强系数。






流动阻力和能量损失
====================

流动阻力和能量损失的形式
--------------------------

在边界沿程不变（包括边壁形状、尺寸、流动方向均不变）的均匀流段上，流动阻力就只有沿程不变的摩擦阻力，称为 **沿程阻力** 。克服沿程阻力所产生的能量损失，称为 **沿程损失** 。沿程损失均匀分布在整个流段上，与流程的长度成比例。流程损失用水头损失表示时，称为沿程水头损失 :math:`h_{f}` ；对于气体流动，沿程损失用压强损失表示时，称为沿程压强损失 :math:`p_{f}` 。

根据实验结果，有计算圆管沿程水头损失的Darcy-Weisbach公式：

.. math::
	\begin{align}
	& h_{f} = \lambda \frac{l}{d}\frac{v^{2}}{2g} \\
	& p_{f} = \lambda \frac{l}{d}\frac{\rho v^{2}}{2}    
	\end{align}

其中 :math:`l` 为管长， :math:`d` 为管径， :math:`v` 为断面平均速度， :math:`g` 为重力加速度， :math:`\rho` 为流体速度， :math:`\lambda` 为沿程损失（阻力）系数。沿程阻力系数并不是一个确定的常数，一般由实验给出的经验或半经验公式来确定。




在边壁形状沿程急剧变化，流速分布急剧调整的局部区段上，集中产生的流动阻力称为 **局部阻力** 。克服局部阻力引起的能量损失称为 **局部损失** 。同样，局部损失用水头损失表示时，称为局部水头损失 :math:`h_{j}` ；对于气体流动，局部损失用压强损失表示时，称为局部压强损失 :math:`p_{j}` 。

局部水头损失计算公式为

.. math::
	\begin{align}
	& h_{j} = \zeta \frac{v^{2}}{2g} \\
	& p_{j} = \zeta \frac{\rho v^{2}}{2}  
	\end{align}

其中 :math:`\zeta` 为局部损失（阻力）系数，一般由实验确定； :math:`v` 为断面平均流速； :math:`\rho` 为流体密度； :math:`g` 为重力加速度。

整个管道（或渠道）的水头损失 :math:`h_{w}` 等于各管道（或各流段）的沿程水头损失和所有局部水头损失的总和，即

.. math::
	\begin{align}
	& h_{w} = \sum h_{f} + \sum h_{j} \\
	& p_{w} = \sum p_{f} + \sum p_{j}
	\end{align}

.. note:: 

	压强损失与水头损失的关系为：

	.. math::
		\begin{align}
		p_{w}=\rho gh_{w}, \quad p_{f}=\rho gh_{f}, \quad p_{j}=\rho gh_{j}
		\end{align}




粘性流体的两种流态
---------------------

对任何边界形状、任何实际流体和其他流动，都可以发现存在有两种流态——层流和湍流。 **层流** 的流动特征是流体质点相互不掺混，作分层有规则的线状运动； **湍流** 流动特征是流体质点互相掺混，作无规则运动。

对于圆管流动，可以用一个无量纲数 **雷诺数** 来判断流动的流态：

.. math::
	\begin{align}
	\text{Re} = \frac{vd\rho}{\mu} = \frac{vd}{\nu}   
	\end{align}

与临界流速相对应的雷诺数，称为 **临界雷诺数** :math:`\text{Re}_{c}` 表示。实验表明，尽管当管径或流动介质不同时临界流速 :math:`v_{c}` 不一样，但对于任何管径和任何牛顿流体，判别流态的临界雷诺数都是相同的。在工程实际中，圆管流动的临界雷诺数取

.. math::
	\begin{align}
	\text{Re}_{c} = \frac{v_{c}d}{\nu} = 2000  
	\end{align}



对于非圆管流动及明渠水流，同样可以用雷诺数判别流态，但要引入一个综合反映断面大小和几何形状对流动影响的特征长度，代替圆管流雷诺数中的直径，这个特征长度就是 **水力半径** ：

.. math::
	\begin{align}
	R = \frac{A}{\chi } 
	\end{align}

其中 :math:`A` 为过流断面面积， :math:`\chi` 为过流断面上流体与固体边界接触部分的周长，称为湿周。例如，对于矩形断面明渠流动的水力半径为

.. math::
	\begin{align}
	R = \frac{A}{\chi } = \frac{bh}{b+2h} 
	\end{align}



.. attention:: 

	对于直径为 :math:`d` 的圆管流，相应的水力半径为

	.. math::
		\begin{align}
		R=\frac{\frac{1}{4}\pi d^{2}}{\pi d} = \frac{d}{4}
		\end{align}

	以水力半径为特征长度，相应的临界雷诺数为

	.. math::
		\begin{align}
		\text{Re}_{cR} = \frac{v_{c}R}{\nu} = 500  
		\end{align}

	可以看到，采用不同的特征长度，会有不同的临界雷诺数。


.. note:: 

	至于一个流场的雷诺数对该流场本身的意义，可以尝试如下进行理解：将雷诺数的表达式改写成

	.. math::
		\begin{align}
		Re = \frac{vd}{\nu} = \frac{\rho vdV}{\mu V}  
		\end{align}

	其中 :math:`V` 是体积。从量纲上看，分子分母都是角动量。分子部分的角动量是惯性主导的，设想一个障碍挡住了层流，此时以障碍底端为中心，流体相对于障碍底端的角动量，就是惯性对旋涡形成的正面贡献；分母部分的角动量是粘性主导的，粘性抵消了速度梯度，抵消了角动量，对旋涡有着负面贡献。

	角动量因为惯性与几何形状而产生，又因为粘性而消失。当惯性胜过粘性时，多出来的角动量就会形成旋涡，否则表现为规矩的层流。但是旋涡不等于湍流，旋涡要发展成湍流还需要更多复杂条件，所以发生转捩的雷诺数并不是一个定值。




沿程损失与切应力之间的关系
----------------------------

均匀流基本方程
^^^^^^^^^^^^^^^^^

取圆管中恒定均匀流段1到2断面，作用在该流段上的外力有两端压力、壁面对流段的摩擦阻力和重力，三者之间沿轴线的平衡方程为

.. math::
	\begin{align}
	p_{1}A - p_{2}A + \rho gAl\cos\alpha  - \tau_{w}\chi l = 0
	\end{align}

其中 :math:`\tau_{w}` 为单位壁面上的摩擦阻力，即壁面切应力； :math:`\chi` 为湿周。将 :math:`l\cos\alpha =z_{1}-z_{2}` 代入上式，并各项除以 :math:`\rho gA` 整理得到

.. math::
	\begin{align}
	\Big( z_{1}+\frac{p_{1}}{\rho g} \Big) - \Big( z_{2}+\frac{p_{2}}{\rho g} \Big) = \frac{\tau_{w}\chi l}{\rho gA} 
	\end{align}

列1-1、2-2断面伯努利方程，化简得到

.. math::
	\begin{align}
	\Big( z_{1}+\frac{p_{1}}{\rho g} \Big) - \Big( z_{2}+\frac{p_{2}}{\rho g} \Big) = h_{f}
	\end{align}

联立上面两个方程，可以得到 **均匀流基本方程** ：

.. math::
	\begin{align}
	& h_{f} = \frac{\tau_{w}\chi l}{\rho g A} = \frac{\tau_{w}l}{\rho g R} \\
	& \tau_{w} = \rho gR\frac{h_{f}}{l} = \rho g R J  
	\end{align}


.. note:: 

	- 对于明渠均匀流，按照上述步骤列出流动方向力的平衡方程，同样可以得到上述均匀流基本方程，所以该方程对有压流和无压流均适用。
	- 由于均匀流基本方程只是根据在恒定均匀流段上外力平衡方程求得的，并没有反映产生沿程水头损失的物理本质，没有涉及流体质点的运动状态，因此该方程对层流和紊流均适用。



阻力速度
^^^^^^^^^^^

为建立沿程阻力系数 :math:`\lambda` 与壁面切应力 :math:`\tau_{w}` 的关系，将Darcy-Weisbach公式和圆管水力半径 :math:`R=\frac{d}{4}` 代入均匀流基本方程得到

.. math::
	\begin{align}
	\tau_{w} = \rho g RJ = \rho g \frac{d}{4} \frac{h_{f}}{l} = \rho g\frac{d}{4}\lambda \frac{1}{d}\frac{v^{2}}{2g} = \rho\frac{\lambda }{8}v^{2}
	\quad\Rightarrow\quad
	\sqrt{\frac{\tau_{w}}{\rho}} = v\sqrt{\frac{\lambda }{8}}    
	\end{align}

定义 :math:`u_{w}=\sqrt{\frac{\tau_{w}}{\rho}}` ，它具有速度的量纲，是反映壁面切应力大小的一个流速，所以称之为 **阻力速度** ，于是

.. math::
	\begin{align}
	u_{w} = \sqrt{\frac{\tau_{w}}{\rho}} = v\sqrt{\frac{\lambda }{8}}
	\end{align}




圆管中的层流运动
------------------

圆管层流的流速分布
^^^^^^^^^^^^^^^^^^^^^^

流体在圆管中作层流运动，各流层间切应力服从牛顿内摩擦定律，即

.. math::
	\begin{align}
	\tau = \mu\frac{\mathrm{d}u}{\mathrm{d}y} = \mu\frac{\mathrm{d}u}{\mathrm{d}(r_{0}-r)} = -\mu\frac{\mathrm{d}u}{\mathrm{d}r} 
	\end{align}

将上式代入圆管中均匀流基本方程得到

.. math::
	\begin{align}
	-\mu\frac{\mathrm{d}u}{\mathrm{d}r} = \rho g\frac{r}{2}J
	\quad \Rightarrow \quad 
	\mathrm{d}u = -\frac{\rho gJ}{2\mu}r~\mathrm{d}r     
	\end{align}

其中 :math:`\rho` 、 :math:`g` 和 :math:`\mu` 都是常数，在均匀流过流断面上 :math:`J` 也是常数，从而对上式积分得到

.. math::
	\begin{align}
	u = -\frac{\rho gJ}{4\mu}r^{2} + C 
	\end{align}

当 :math:`r=r_{0}` 时 :math:`u=0` ，从而求得 :math:`C = \frac{\rho gJ}{4\mu}r_{0}^{2}` ，代回上式即可得到 **圆管层流运动过流断面上的流速分布** ：

.. math::
	\begin{align}
	u = \frac{\rho gJ}{4\mu}(r_{0}^{2} - r^{2})
	\end{align}

可以看到，圆管层流运动过流断面上的流速分布是一个旋转抛物面。将 :math:`r=0` 代入上式得到 **管轴处的最大流速** 为

.. math::
	\begin{align}
	u_{\max} = \frac{\rho gJ}{4\mu}r_{0}^{2} 
	\end{align}

**圆管层流流量** 为

.. math::
	\begin{align}
	Q = \int_{A}u~\mathrm{d}A 
	= \int_{0}^{r_{0}}\frac{\rho gJ}{4\mu}(r_{0}^{2} - r^{2})2\pi r~\mathrm{d}r
	= \frac{\rho gJ}{8\mu}\pi r_{0}^{4} 
	\end{align}

**圆管层流的平均流速** 为

.. math::
	\begin{align}
	v = \frac{Q}{A} = \frac{Q}{\pi r_{0}^{2}} = \frac{\rho gJ}{8\mu}r_{0}^{2} = \frac{1}{2}u_{\max} 
	\end{align}

进而可以计算出圆管层流的动能修正系数 :math:`\alpha` 和动量修正系数 :math:`\alpha_{0}` ：

.. math::
	\begin{align}
	\alpha = \frac{\int_{A}u^{3}\mathrm{d}A}{v^{3}A}
	= \frac{\int_{0}^{r_{0}}\Big( \frac{\rho gJ}{4\mu}(r_{0}^{2}-r^{2})\Big)^{3}2\pi r~\mathrm{d}r}{\Big( \frac{\rho gJ}{8\mu}r_{0}^{2} \Big)^{3}\pi r_{0}^{2}}  
	= 2
	\end{align}

.. math::
	\begin{align}
	\alpha_{0} = \frac{\int_{A}u^{2}\mathrm{d}A}{v^{2}A}
	= \frac{\int_{0}^{r_{0}}\Big( \frac{\rho gJ}{4\mu}(r_{0}^{2}-r^{2})\Big)^{2}2\pi r~\mathrm{d}r}{\Big( \frac{\rho gJ}{8\mu}r_{0}^{2} \Big)^{2}\pi r_{0}^{2}}  
	= 1.33
	\end{align}




圆管层流沿程水头损失的计算
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

将 :math:`r_{0}=\frac{d}{2}` ， :math:`J=\frac{h_{f}}{l}` 代入圆管层流的平均流速表达式，整理得到

.. math::
	\begin{align}
	h_{f} = \frac{32\mu lv}{\rho gd^{2}}
	\end{align}

上式从理论上证明了层流沿程水头损失与断面平均流速一次方成正比。进一步将上式写成计算沿程损失的一般形式：

.. math::
	\begin{align}
	h_{f} = \lambda \frac{l}{d}\frac{v^{2}}{2g} = \frac{32\mu l}{\rho gd^{2}}v = \frac{64}{\text{Re}}\frac{l}{d}\frac{v^{2}}{2g}     
	\end{align}

对比系数可以得到圆管层流的沿程阻力系数的计算表达式：

.. math::
	\begin{align}
	\lambda = \frac{64}{\text{Re}} 
	\end{align}


上式表明，圆管层流的沿程阻力系数只是雷诺数的函数，与壁面粗糙度无关。






管道和明流的局部损失
----------------------

流体在流经阀门、弯管等部件时，均匀流动受到破坏，流速的大小、方向和分布发生变化。在较短范围内，由于流动的急剧调整而集中产生的流动阻力称为 **局部阻力** ，所产生的能量损失称为 **局部损失** 。局部损失产生的主要原因有：

1. 主流与边壁分离形成旋涡区是产生局部损失的主要原因。
2. 流动方向的变化形成二次流，也将产生一定的能量损失。
   
和沿程损失一样，局部损失一般也用流速水头的倍数来表示，局部损失计算公式为

.. math::
	\begin{align}
	h_{j} = \zeta \frac{v^{2}}{2g} 
	\end{align}

其中 :math:`\zeta` 为局部阻力系数， :math:`v` 为与 :math:`\zeta` 对应的断面平均流速。理论上局部阻力系数应该与局部阻碍处的雷诺数和边界情况有关，但是实际上流动受到局部阻碍的强烈扰动，较早地进入了阻力平方区， :math:`\zeta` 与 :math:`Re` 无关，只决定于局部阻碍的形状。

下面进行突扩管局部损失的分析。设突然扩大同轴管如图所示，列出扩大前断面1-1和扩大后流速分布与湍流脉动已经接近均匀流状态的断面2-2的伯努利方程，忽略两断面间的沿程损失，则有

.. math::
	\begin{align}
	z_{1} + \frac{p_{1}}{\rho g} + \frac{\alpha _{1}v_{1}^{2}}{2g} = z_{2} + \frac{p_{2}}{\rho g} + \frac{\alpha _{2}v_{2}^{2}}{2g} + h_{j} 
	\end{align}

于是得到

.. math::
	\begin{align}
	h_{j} = \Big(z_{1}+\frac{p_{1}}{\rho g} \Big) - \Big( z_{2} + \frac{p_{2}}{\rho g} \Big) + \frac{\alpha _{1}v_{1}^{2} - \alpha_{2}v_{2}^{2}}{2g}
	\end{align}

对 :math:`AB` 、2-2断面和两断面间侧壁面所构成的控制体，列出流动方向的动量方程为

.. math::
	\begin{align}
	\sum \mathbf{F} = \rho Q (\beta_{2}v_{2} - \beta_{1}v_{1})
	\end{align}

其中 :math:`\sum \mathbf{F}` 包括：

- 作用在 :math:`AB` 面上的压力 :math:`P_{AB}` （受压面积是 :math:`A_{2}` ），其中环形部分位于旋涡区，实验观察表明这个环形面积的压强基本符合静压强分布规律，故 :math:`P_{AB}=p_{1}A_{2}` ；
- 作用在2-2断面上的压力 :math:`P_{2}=p_{2}A_{2}` ；
- 重力在管轴上的投影 :math:`G\cos\theta = \rho gA_{2}(z_{1}-z_{2})` ；
- 管壁上的摩擦阻力忽略不计。
  
将各项力代入动量方程，得到

.. math::
	\begin{align}
	p_{1}A_{2} - p_{2}A_{2} + \rho g A_{2}(z_{1}-z_{2}) = \rho Q(\beta_{2}v_{2} - \beta_{1}v_{1})
	\end{align}

将 :math:`Q = v_{2}A_{2}` 代入上式，并在等号两边同时除以 :math:`\rho g A_{2}` ，整理得到

.. math::
	\begin{align}
	\Big(z_{1}+\frac{p_{1}}{\rho g} \Big) - \Big( z_{2} + \frac{p_{2}}{\rho g} \Big) = \frac{v_{2}}{g}(\beta_{2}v_{2}-\beta_{1}v_{1}) 
	\end{align}

将上式代回沿程损失的表达式，对于湍流近似取 :math:`\alpha_{1}=\alpha_{2}=1,\beta_{1}=\beta_{2}=1` ，整理得到 **Borda公式** ：

.. math::
	\begin{align}
	h_{j} = \frac{(v_{1}-v_{2})^{2}}{2g} 
	\end{align}

为了将上式变为局部损失的一般形式，只需要将 :math:`v_{2}=v_{1}\frac{A_{1}}{A_{2}}` 或者 :math:`v_{1}=v_{2}\frac{A_{2}}{A_{1}}` 代入，即可得到

.. math::
	\begin{align}
	h_{j} = \Big(1-\frac{A_{1}}{A_{2}} \Big)^{2}\frac{v_{1}^{2}}{2g} = \zeta_{1}\frac{v_{1}^{2}}{2g}
	\quad \text{or} \quad 
	h_{j} = \Big(\frac{A_{2}}{A_{1}}-1 \Big)^{2}\frac{v_{2}^{2}}{2g} = \zeta_{2}\frac{v_{2}^{2}}{2g}
	\end{align}



.. note:: 

	可以看到，突然扩大的局部阻力系数为

	.. math::
		\begin{align}
		\zeta_{1}=\Big(1-\frac{A_{1}}{A_{2}} \Big)^{2}
		\quad \text{or} \quad
		\zeta_{2}=\Big(\frac{A_{2}}{A_{1}}-1 \Big)^{2}
		\end{align}

	当流体从管道流入断面很大的容器中，或者气体流入大气时，有 :math:`\frac{A_{1}}{A_{2}}\approx 0, \zeta_{1}=1` ，这是突然扩大的特殊情况，称为 **出口阻力系数** 。




湍流运动
==========

湍流中不断产生无数大小不等、转向不同的涡体。涡体是具有旋转运动的流体团，而且无规则地运动。流体质点在流动过程中不断相互掺混，质点掺混使得流场中固定空间点上的各种运动要素，如流速压强等都随时间不断波动，这种波动称为 **脉动** 。湍流脉动具有如下的一些特点：

- 随机性：脉动是一个随机过程，脉动值时大时小，方向有正有负，但总是围绕一个平均值波动。
- 三维性：脉动总是三维的，即虽然主流的流动只沿一个方向，却都产生三个方向的脉动速度，其中沿主流流动方向的脉动量最大，而以既垂直于主流流动方向又垂直于固体边壁面方向的脉动量最小。
- 脉动量的数值有时候很大，不能当做微量进行处理。其变化量可以是最大值的几分之一，甚至三分之一或二分之一。
  
湍流是一种不规则的流动状态，其流动参数随时间和空间做紊乱变化，因而本质上是三维非稳态流动，且流动空间分布着无数大小和形状各不相同的旋涡。但湍流并非完全随机，其运动仍服从三大守恒定律，假设速度的一个分量是随机的，则另外两个分量一定会由三大守恒定律限制其脉动范围。通过观测，湍流带有旋转流动结构，即湍流涡(turbulence vortex)。

从物理结构上，可以把湍流看成由不同尺度的涡叠合而成的运动，这些涡的大小及旋转轴的方向分布是随机的。大尺度的涡主要由流动的边界条件所决定，其尺寸可以与流场的大小相比拟，主要受惯性影响，是引起低频脉动的原因；小尺度的涡主要由黏性力所决定，其尺寸可能为流场的千分之一量级，是引起高频脉动的原因。大尺度的涡拉伸破裂后形成小尺度的涡，较小尺度的涡拉伸破裂后形成更小尺度的涡。在充分发展的湍流区域内，大尺度的涡不断从主流获得能量，通过涡之间的相互作用，能量逐渐向小尺度的涡传递，最后由于流体黏性的作用，小尺度的涡不断消失，机械能转化为流体的热能。

湍流中湍流动能 :math:`k` 的传递是一种级联过程，由大涡传递给小涡，再传递给更小的涡，这样逐级地传递，直至最小的涡，最小的涡通过分子黏性把湍动能耗散成热，这一耗散过程在极短的时间内完成。当一个涡刚好能将从上一级传递给它的能量全部耗散成热时，这个涡就是最小尺度的涡。耗散率 :math:`\varepsilon` 刚好等于接收到的动能：

.. math::
	\begin{align}
	\varepsilon = - \frac{\mathrm{d} k}{\mathrm{d} t} 
	\end{align}

它只依赖于流体的分子粘性，即运动粘性系数 :math:`\nu` 。运用量纲分析， :math:`\varepsilon` 的量纲为 :math:`L^{2}T^{-3}` ， :math:`\nu` 的量纲为 :math:`L^{2}T^{-1}` 。最小涡的长度尺寸用 :math:`\eta` 来表示，速度尺度用 :math:`u_{\eta}` 来表示，时间尺度用 :math:`\tau_{\eta}` 来表示，可以得到

.. math::
	\begin{align}
	\eta = \Big(\frac{\nu^{3}}{\varepsilon}\Big)^{1/4}
	,\quad
	u_{\eta} = (\nu \varepsilon)^{1/4}
	,\quad
	\tau_{\eta} = \Big(\frac{\nu}{\varepsilon}\Big)^{1/2}
	\end{align}

.. note:: 这是Kolmogorov提出的泛平衡理论的前提， :math:`\eta` 、 :math:`u_{\eta}` 、 :math:`\tau_{\eta}` 分别为Kolmogorov长度尺寸、Kolmogorov速度尺寸和Kolmogorov时间尺寸。

利用Taylor假设，能量耗散率具有量级为：

.. math::
	\begin{align}
	\varepsilon \sim \frac{U^{3}}{L} 
	\end{align}

其中 :math:`U` 为湍流中最大涡的特征速度， :math:`L` 为湍流中最大涡的特征长度。 :math:`U` 和 :math:`L` 由流动的几何形状和尺寸决定。

湍流中充满各种尺寸的涡，湍流的谱响应具有广泛的波长和频率。如果想求解所有尺度的涡，那么在每个坐标方向上所需要的网格数目为：

.. math::
	\begin{align}
	N = \frac{L}{\eta} \sim L \Big(\frac{U^{3}/L}{\nu^{3}} \Big)^{1/4} = \Big( \frac{UL}{\nu} \Big)^{3/4} = Re^{3/4}
	\end{align}

其中 :math:`Re` 为湍流运动中与最大尺度相关联的雷诺数。在前面已经指出，湍流是三维有旋运动，则在空间上所需要的网格数量为 :math:`N^{3} \sim Re^{9/4}` 。在时间上，至少要考察大涡的一个运动周期 :math:`T = L/U` ，则至少需要的时间节点数为

.. math::
	\begin{align}
	N_{t} = \frac{T}{\tau_{\eta}} \sim \frac{L/U}{(\nu / \varepsilon)^{1/2}} \sim \frac{L}{U}\Big(\frac{U^{3}/L}{\nu} \Big)^{1/2} = \Big(\frac{UL}{\nu}\Big)^{1/2} = Re^{1/2}
	\end{align}

因此，通过直接求解三维非稳态NS方程组需要的节点个数为 :math:`N^{3}\cdot N_{t} \sim Re^{11/4}` 。



雷诺时均法
--------------------

湍流的脉动现象十分复杂，脉动的幅度和频率变化无明显的规律性，是一种随机性质的波动，因此广泛采用的方法是时间平均法，将湍流流动视作两种流动的叠加： **时间平均流动** 和 **脉动流动** 。

将 :math:`u_{x}` 对某一时段 :math:`T` 平均，即

.. math::
	\begin{align}
	\overline{u_{x}} = \frac{1}{T}\int_{0}^{T}u_{x}~\mathrm{d}t
	\end{align}

只要所取的时间 :math:`T` 不是很短，在 :math:`T` 时段内瞬时量的时间变化过程能够代表该量所有可能出现得状态特征， :math:`\overline{u_{x}}` 值便与 :math:`T` 的长短无关， :math:`\overline{u_{x}}` 就是该点 :math:`x` 方向的 **时均流速** 。


定义了时均流速，瞬时流速就等于时均流速与脉动流速的叠加，即

.. math::
	\begin{align}
	u_{x} = \overline{u_{x}} + u_{x}'
	\end{align}

其中 :math:`u_{x}'` 为该点在 :math:`x` 方向的 **脉动流速** 。脉动流速随时间而变化，在时间段 :math:`T` 内，脉动流速的时均值为零，即

.. math::
	\begin{align}
	\overline{u_{x}'} = \frac{1}{T}\int_{0}^{T}u_{x}'~\mathrm{d}t = 0
	\end{align}

类似地，垂直于主流方向的脉动流速时均值也为零，即 :math:`\overline{u_{y}'}=0,\overline{u_{z}'}=0` 。但是，脉动流速的均方值不等于零，即

.. math::
	\begin{align}
	\overline{u_{x}'u_{x}'} = \frac{1}{T}\int_{0}^{T}u_{x}'^{2} ~\mathrm{d}t
	\end{align}

y,z方向的脉动流速的均方值也类似表示为 :math:`\overline{u_{y}'u_{y}'},\overline{u_{z}'u_{z}'}` 。

单位质量流体湍流脉动的动能（湍动能），用 :math:`k` 表示：

.. math::
	\begin{align}
	k = \frac{1}{2}(\overline{u_{x}'u_{x}'} + \overline{u_{y}'u_{y}'} + \overline{u_{z}'u_{z}'}) 
	\end{align}

在比较湍流强度时，通常采用H.L.Dryden提出的湍流强度定义：任一瞬时，在空间点上湍流脉动速度的均方根值就是湍流运动在该点的强度，但由于脉动速度往往与平均速度大小有关，因此用相对量（相对湍流强度）来作为湍流强度的比较：

.. math::
	\begin{align}
	N = \frac{1}{U_{\infty}}\sqrt{\frac{1}{3}(\overline{u_{x}'u_{x}'} + \overline{u_{y}'u_{y}'} + \overline{u_{z}'u_{z}'})}
	= \frac{1}{U_{\infty}}\sqrt{\frac{2}{3}k}
	\end{align}

其中 :math:`U_{\infty}` 为表征稳态湍流特征的常值平均速度。

.. note:: 

	如果湍流为各向同性的，则有

	.. math::
		\begin{align}
		N = \frac{1}{U_{\infty}}\sqrt{\overline{u'^{2}}}
		\end{align}

	许多情况下虽然湍流不是均匀各向同性的，但是也用上式来定义其湍流强度。



.. note:: 

	两个瞬时值的时均基本计算关系如下：

	.. math::
		\begin{align}
		\phi = \overline{\phi} + \phi'
		,\quad 
		\varphi = \overline{\varphi} + \varphi'
		\end{align}

	.. math::
		\begin{align}
		\overline{\phi'} = 0
		,\quad 
		(\overline{\phi})' = 0
		,\quad 
		\overline{\overline{\phi}} = \overline{\phi}
		\end{align}

	.. math::
		\begin{align}
		\overline{\overline{\phi} + \phi'} = \overline{\phi}
		,\quad 
		\overline{\phi + \varphi} = \overline{\phi} + \overline{\varphi}
		\end{align}

	.. math::
		\begin{align}
		\overline{\phi\varphi} = \overline{\phi}\overline{\varphi} + \overline{\phi'\varphi'}
		,\quad 
		\overline{\overline{\phi}\varphi'} = 0
		,\quad 
		\overline{\phi'\varphi'} \ne 0
		,\quad 
		\overline{\overline{\phi}\overline{\varphi}} = \overline{\phi}\overline{\varphi}
		\end{align}

	.. math::
		\begin{align}
		\overline{\frac{\partial \phi}{\partial x_{i}} } = \frac{\partial \overline{\phi}}{\partial x_{i}}
		,\quad
		\overline{\frac{\partial \phi}{\partial t}} = \frac{\partial \overline{\phi}}{\partial t}
		,\quad 
		\overline{\frac{\partial^{2}\phi}{\partial x_{i}^{2}} } = \frac{\partial ^{2}\overline{\phi}}{\partial x_{i}^{2}}
		\end{align}

	.. math::
		\begin{align}
		\overline{\frac{\partial \phi'}{\partial x_{i}} } = 0
		,\quad 
		\overline{\frac{\partial \phi'}{\partial t}} = 0
		,\quad 
		\overline{\frac{\partial^{2}\phi'}{\partial x_{i}^{2}} } = 0
		\end{align}



+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| 符号                 | 含义         | 解释                                                                                                                   |
+======================+==============+========================================================================================================================+
| :math:`u`            | 瞬时流速     | 某一空间点在某一时刻的实际流速，在湍流流态下随时间脉动                                                                 |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`\overline{u}` | 时均流速     | 某一空间点的瞬时流速在时段 :math:`T` 内的时间平均值，即 :math:`\overline{u}=\frac{1}{T}\int_{0}^{T}u\mathrm{d}t`       |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`u'`           | 脉动流速     | 某一空间点的瞬时流速与时均流速的差值                                                                                   |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`v`            | 断面平均流速 | 过流断面上所有点的时均流速（层流时即为真实流速）的断面平均值，即 :math:`v=\frac{1}{A}\int_{A}\overline{u}~\mathrm{d}A` |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`p`            | 瞬时压强     | 某一空间点在某一时刻的实际压强，在湍流流态下随时间脉动                                                                 |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`\overline{p}` | 时均压强     | 某一空间点的瞬时压强在时段 :math:`T` 内的时间平均值，即 :math:`\overline{p}=\frac{1}{T}\int_{0}^{T}p\mathrm{d}t`       |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+
| :math:`p'`           | 脉动压强     | 某一空间点的瞬时压强与时均压强的差值                                                                                   |
+----------------------+--------------+------------------------------------------------------------------------------------------------------------------------+



湍流切应力
-------------

在湍流流动中，切应力由两部分组成：

(1) 因为流层相对运动而产生的时均粘性切应力 :math:`\overline{\tau_{1}}` ，仍然符合牛顿内摩擦定律，即
    
.. math::
	\begin{align}
	\overline{\tau_{1}} = \mu\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}
	\end{align}

其中 :math:`\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}` 为时均流速梯度。

(2) 因为湍流脉动、上下层质点相互掺混，在相邻流层间产生了动量交换，从而在流层分界面上形成了湍流 **附加切应力** :math:`\overline{\tau_{2}}` 。
    

普朗克混合长度理论，为计算平面恒定均匀湍流切应力建立了一个简易、可行的计算模型：设二维恒定均匀湍流，流向与 :math:`x` 轴平行，如图所示，A点沿 :math:`x` 方向的瞬时流速为 :math:`u_{x}=\overline{u_{x}} + u_{x}'` ，横向脉动流速为 :math:`u_{y}'` ，由于横向脉动，该处质点以 :math:`u_{y}'` 速度通过流层间的微小面积 :math:`\Delta A` 进入邻层，从而把本身所具有的动量传递给邻层，在 :math:`\Delta t` 时段内，通过 :math:`\Delta A` ，随质点转移的动量为

.. math::
	\begin{align}
	\Delta K = \Delta m (\overline{u_{x}} + u_{x}') = \rho \Delta A \cdot u_{y}'\Delta t (\overline{u_{x}} + u_{x}')
	\end{align}

根据质点动量定律，沿 :math:`x` 方向（即流动方向）质点栋梁的变化 :math:`\Delta K` 等于 :math:`\Delta t` 时段内作用在 :math:`\Delta A` 面上的切力 :math:`\Delta T` 的冲量，即

.. math::
	\begin{align}
	& \Delta T \cdot \Delta t = \rho \Delta A \cdot u_{y}'\Delta t (\overline{u_{x}} + u_{x}') \\
	& \tau_{2} = \frac{\Delta T}{\Delta A} =  \rho  u_{y}'(\overline{u_{x}} + u_{x}')
	\end{align}

取切应力的平均值则为

.. math::
	\begin{align}
	\overline{\tau_{2}} = \frac{1}{T}\int_{0}^{T}\rho  u_{y}'(\overline{u_{x}} + u_{x}')\mathrm{d}t
	= \rho \Big( \frac{1}{T}\int_{0}^{T}u_{y}'\overline{u_{x}}\mathrm{d}t + \frac{1}{T}\int_{0}^{T}u_{y}'u_{x}'\mathrm{d}t\Big)  
	\end{align}

而由于

.. math::
	\begin{align}
	\frac{1}{T}\int_{0}^{T}u_{y}'\overline{u_{x}}\mathrm{d}t
	= \frac{1}{T} \overline{u_{x}} \int_{0}^{T}u_{y}'\mathrm{d}t=0
	\end{align}

因此化简得到附加切应力的大小的表达式：

.. math::
	\begin{align}
	\overline{\tau_{2}} = \rho\frac{1}{T}\int_{0}^{T}u_{x}'u_{y}'\mathrm{d}t = \rho\overline{u_{x}'u_{y}'}  
	\end{align}

其中 :math:`\overline{u_{x}'u_{y}'}` 表示脉动流速乘积的时均值。


下面考虑附加切应力的方向。设流动的流速梯度 :math:`\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}` 为正值：

- 当 :math:`u_{y}'` 为正时，质量从下层传递到上层，因下层的时均流速小于上层，有减缓上层流体运动的作用，在大多数情况下可以认为 :math:`u_{x}'` 为负值，可以得到 :math:`u_{y}'u_{x}'` 为负值。
- 当 :math:`u_{y}'` 为负时，质量从上往下传递，由于上层的时均流速较大，所以其 :math:`u_{x}'` 可以认为是正值，又可以得到 :math:`u_{y}'u_{x}'` 为负值。
  
为了让附加切应力 :math:`\overline{\tau_{2}}` 与粘性切应力的表示方式一致以正值出现，所以应该在原表达式加上负号，即得到用脉动流速表示的 **湍流附加切应力** ：

.. math::
	\begin{align}
	\overline{\tau_{2}} = -\rho\overline{u_{x}'u_{y}'}
	\end{align}

上式表明，湍流附加切应力只与流体密度和脉动速度有关，而与流体粘性无关。 **湍流切应力** 应该是粘性切应力与附加切应力之和，即

.. math::
	\begin{align}
	\overline{\tau} = \overline{\tau_{1}} + \overline{\tau_{2}} = \mu\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} -\rho\overline{u_{x}'u_{y}'}
	\end{align}


由于 :math:`u_{x}'` 、 :math:`u_{y}'` 是随时间无规则变化的，不容易确定，需要把用脉动流速表示的附加切应力转化为以时均流速表示的形式。普朗特比拟气体分子自由程的概念，提出混合长度理论解决了这个问题。混合长度理论假设为：

(1) 流体质点因横向脉动流速作用，在横向运动到相距为 :math:`l'` 的空间距离上，才同周围质点发生动量交换，并且假定该质点在横向运动过程中动量保持不变，直到新的位置时，才与周围的流体质点相混合。距离为 :math:`l'` 的两个流层的时均流速之差为
    
.. math::
	\begin{align}
	\Delta \overline{u_{x}} = \overline{u_{x}}(y+l') - \overline{u_{x}}(y)
	= \overline{u_{x}}(y) + l'\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} - \overline{u_{x}}(y)
	= l'\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}
	\end{align}

(2) 脉动流速 :math:`u_{x}'` 与这两个流层的时均流速差 :math:`\Delta \overline{u_{x}}` 成正比，即 :math:`u_{x}' = \pm c_{1}l'\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}` 。
(3) 横向脉动流速 :math:`u_{y}'` 与纵向脉动流速 :math:`u_{x}'` 成比例，但是符号相反，即 :math:`u_{y}' = \mp c_{2}l'\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y}` 。
    
根据前面的假设就可以得到

.. math::
	\begin{align}
	\overline{\tau_{2}} = -\rho\overline{u_{x}'u_{y}'}
	= \rho c_{1}c_{2}(l')^{2}\Big( \frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} \Big)^{2}
	\end{align}

令 :math:`l^{2}=c_{1}c_{2}(l')^{2}` ，则得到 **用时均流速表示的附加切应力公式** ：

.. math::
	\begin{align}
	\overline{\tau_{2}} = \rho l^{2} \Big( \frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} \Big)^{2}
	\end{align}

其中 :math:`l` 称为 **混合长度** 。据此可以得到简化的湍流切应力为

.. math::
	\begin{align}
	\overline{\tau} = \overline{\tau_{1}} + \overline{\tau_{2}}
	= \mu\frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} + \rho l^{2} \Big( \frac{\mathrm{d}\overline{u_{x}}}{\mathrm{d}y} \Big)^{2}
	\end{align}

上式中两部分切应力的大小随湍流情况而有所不同。在雷诺数较小，湍流较弱时，前者占主导地位；随着雷诺数增大，湍流程度增大，后者逐渐加大；当雷诺数很大时，湍流充分发展，前者可以忽略不计。




雷诺时均方程(Reynolds-Averaged Navier-Stokes)
-------------------------------------------------

对连续性方程求时均，可以得到

.. math::
	\begin{align}
	\overline{\nabla \cdot (\rho\mathbf{U})}
	= \overline{\nabla \cdot (\rho\overline{\mathbf{U}}+\rho\mathbf{U}')}
	= \nabla \cdot (\overline{\rho\overline{\mathbf{U}} + \rho\mathbf{U}'})
	= \nabla \cdot (\rho \overline{\mathbf{U}})
	= 0
	\end{align}

.. note:: 

	流体的物性参数通常是温度 :math:`T` 和压强 :math:`p` 的函数，压强的影响一般可以被忽略。为了避免时均方程的复杂化，不再考虑物性参数中 与相关变量的关联项，直接用时均温度带入进行计算，因此密度不考虑脉动变化。


考虑动量方程，其每一项雷诺时均结果为：


.. math::
	\begin{align}
	\overline{\frac{\partial (\rho\mathbf{U})}{\partial t} }
	= \overline{\frac{\partial (\rho\overline{\mathbf{U}} + \rho\mathbf{U}')}{\partial t} }
	= \frac{\partial (\overline{\rho\overline{\mathbf{U}} + \rho\mathbf{U}'})}{\partial t}
	= \frac{\partial (\rho\overline{\mathbf{U}})}{\partial t} 
	\end{align}


.. math::
	\begin{align}
	\overline{\nabla \cdot (\rho\mathbf{UU})} & = \overline{\nabla \cdot \rho\big( (\overline{\mathbf{U}} + \mathbf{U}') \otimes (\overline{\mathbf{U}} + \mathbf{U}') \big)} \\
	&= \nabla \cdot \overline{\rho\big( \overline{\mathbf{U}}\otimes \overline{\mathbf{U}} + \mathbf{U}'\otimes \overline{\mathbf{U}} + \overline{\mathbf{U}} \otimes \mathbf{U}' + \mathbf{U}'\otimes \mathbf{U}' \big)} \\
	&= \nabla \cdot \rho(\overline{\mathbf{U}}\otimes \overline{\mathbf{U}}) + \nabla \cdot \rho(\overline{\mathbf{U}' \otimes \mathbf{U}'})
	\end{align}

.. math::
	\begin{align}
	\overline{-\nabla p + \rho\mathbf{f}}
	= -\nabla(\overline{\overline{p} + p'}) + \overline{\rho\overline{\mathbf{f}} + \rho\mathbf{f}'}
	= -\nabla\overline{p} + \rho\overline{\mathbf{f}}
	\end{align}

.. math::
	\begin{align}
	\overline{\nabla \cdot \boldsymbol{\tau}}
	= \overline{\nabla \cdot (\overline{\boldsymbol{\tau}} + \boldsymbol{\tau}')}
	= \nabla \cdot (\overline{\overline{\boldsymbol{\tau}} + \boldsymbol{\tau}'})
	= \nabla \cdot \overline{\boldsymbol{\tau}}
	= \nabla \cdot \Big\{ \mu \Big[ \nabla\overline{\mathbf{U}} + (\nabla\overline{\mathbf{U}})^{T} -\frac{2}{3}(\nabla \cdot \overline{\mathbf{U}})\mathbf{I}  \Big] \Big\}
	\end{align}


因此可以得到时均运动的动量方程：

.. math::
	\begin{align}
	\frac{\partial (\rho\overline{\mathbf{U}})}{\partial t}
	+ \nabla \cdot \rho(\overline{\mathbf{U}}\otimes \overline{\mathbf{U}})
	+ \nabla \cdot \rho(\overline{\mathbf{U}' \otimes \mathbf{U}'})
	= - \nabla\overline{p}
	+ \rho\overline{\mathbf{f}}
	+ \nabla \cdot \Big\{ \mu \Big[ \nabla\overline{\mathbf{U}} + (\nabla\overline{\mathbf{U}})^{T} -\frac{2}{3}(\nabla \cdot \overline{\mathbf{U}})\mathbf{I}  \Big] \Big\}
	\end{align}


与求时均之前的动量方程相比，多了一项 :math:`\nabla \cdot \rho(\overline{\mathbf{U}' \otimes \mathbf{U}'})` ，该项是动量方程中的对流项的非线性引起的，代表了脉动速度对平均流的影响。由于这一项的存在，脉动运动与平均运动之间会发生动量交换，使湍流的平均速度分布与相同条件下层流的速度分布不同。

将 :math:`\mathbf{R} = - \overline{\mathbf{U}'\otimes\mathbf{U}'}` 称为 **雷诺应力** 。容易得知雷诺应力是一个二阶对称张量：

.. math::
	\begin{align}
	\mathbf{R} = 
	\begin{bmatrix}
	\tau_{t_{xx}} & \tau_{t_{xy}} & \tau_{t_{xz}} \\
	\tau_{t_{yx}} & \tau_{t_{yy}} & \tau_{t_{yz}} \\
	\tau_{t_{zx}} & \tau_{t_{zy}} & \tau_{t_{zz}}
	\end{bmatrix} = 
	\begin{bmatrix}
	-\overline{u_{x}'u_{x}'} & -\overline{u_{x}'u_{y}'} & -\overline{u_{x}'u_{z}'} \\
	-\overline{u_{y}'u_{x}'} & -\overline{u_{y}'u_{y}'} & -\overline{u_{y}'u_{z}'} \\
	-\overline{u_{z}'u_{x}'} & -\overline{u_{z}'u_{y}'} & -\overline{u_{z}'u_{z}'}
	\end{bmatrix}
	\end{align}


于是雷诺时均动量方程常写成如下的形式：

.. math::
	\begin{align}
	\frac{\partial (\rho\overline{\mathbf{U}})}{\partial t}
	+ \nabla \cdot \rho(\overline{\mathbf{U}}\otimes \overline{\mathbf{U}})
	= - \nabla\overline{p}
	+ \rho\overline{\mathbf{f}}
	+ \nabla \cdot \Big\{ \mu \Big[ \nabla\overline{\mathbf{U}} + (\nabla\overline{\mathbf{U}})^{T} -\frac{2}{3}(\nabla \cdot \overline{\mathbf{U}})\mathbf{I}  \Big] + \rho\mathbf{R} \Big\}
	\end{align}


为了使雷诺时均方程组封闭，最早的想法就是对其中的关联项等表征湍流特性的量继续写输运方程，其中第一个就是雷诺应力。推导 **雷诺应力方程** (The Reynolds-Stress Equation)的出发点是瞬态的N-S方程和时均的雷诺方程，采用以下两种方程均可得到相同的结果：

**Method 1** ：

（1）分别写出关于瞬时速度分量 :math:`u_{i}` 和 :math:`u_{j}` 的NS方程；
（2）用 :math:`u_{i}` 乘以关于 :math:`u_{j}` 的NS方程，用 :math:`u_{j}` 乘以关于 :math:`u_{i}` 的NS方程，然后两式相加得到 :math:`(u_{i}u_{j})` 的方程；
（3）对上述方程进行雷诺时均，得到 :math:`(\overline{u_{i}u_{j}})` 的方程；
（4）用 :math:`\overline{u_{i}}` 乘以关于 :math:`\overline{u_{j}}` 的雷诺时均方程，用 :math:`\overline{u_{j}}` 乘以关于 :math:`\overline{u_{i}}` 的雷诺方程，然后两式相加得到 :math:`(\overline{u}_{i}\overline{u}_{j})` 的方程；
（5）用 :math:`(\overline{u_{i}u_{j}})` 的方程减去 :math:`(\overline{u}_{i}\overline{u}_{j})` 的方程，便得到 :math:`(\overline{u_{i}'u_{j}'})` 的方程。

**Method 2** ：

（1）定义NS算子为（经过了不可压缩流连续性方程化简）

.. math::
	\begin{align}
	\mathcal{N}(u_{i}) = \rho \frac{\partial u_{i}}{\partial t}
	+ \rho u_{k}\frac{\partial u_{i}}{\partial x_{k}}
	+ \frac{\partial p}{\partial x_{i}}
	- \mu \frac{\partial^{2}u_{i}}{\partial x_{k}\partial x_{k}}     
	\end{align}

（2）化简下面的式子即可得到 :math:`(\overline{u_{i}'u_{j}'})` 的方程：

.. math::
	\begin{align}
	\overline{u_{i}'\mathcal{N}(u_{j}) + u_{j}'\mathcal{N}(u_{i})} = 0
	\end{align}


最终得到雷诺应力方程的形式为

.. math::
	\begin{align}
	\frac{\partial R_{ij}}{\partial t}
	+ \overline{u_{k}}\frac{\partial R_{ij}}{\partial x_{k}}
	= - R_{ik}\frac{\partial \overline{u_{j}}}{\partial x_{k}}
	- R_{jk}\frac{\partial \overline{u_{i}}}{\partial x_{k}}
	+ \varepsilon_{ij}
	- \Pi_{ij}
	+ \frac{\partial }{\partial x_{k}}\Big( \nu \frac{\partial R_{ij}}{\partial x_{k}} + C_{ijk} \Big) 
	\end{align}

其中

.. math::
	\begin{align}
	& R_{ij} = - \overline{u_{i}'u_{j}'} \\
	& \Pi_{ij} = \overline{\frac{p'}{\rho}\Big( \frac{\partial u_{i}'}{\partial x_{j}} + \frac{\partial u_{j}'}{\partial x_{i}} \Big)} \\
	& \varepsilon_{ij} = 2\nu \overline{\frac{\partial u_{i}'}{\partial x_{k}} \frac{\partial u_{j}'}{\partial x_{k}}} \\
	& \rho C_{ijk} = \rho \overline{u_{i}'u_{j}'u_{k}'} + \overline{p'u_{i}'}\delta_{jk} + \overline{p'u_{j}'}\delta_{ik}
	\end{align}

上面得到了另外6个新方程，但是也额外产生了22个未知数。由于NS方程的非线性，当我们不断尝试提高阶数来增加方程数量的时候，未知数也会跟着增加，方程组也因此永远不会封闭。这也说明了雷诺平均方法是比较粗糙的简化，它丢失了NS方程中的许多信息。湍流建模的功能是根据已知的流动特性为未知的相关性设计近似，以便有足够数量的方程存在。



湍流的尺度
-------------

湍流密度
^^^^^^^^^^^

Kolmogorov尺度提供了估计最小湍流涡的长度、速度和时间尺度的方法。而积分长度尺度(integral length scale) :math:`\ell` 用来衡量能量承载涡。另外一个衡量湍流量的是涨落强度，使用雷诺应力的法向分量 :math:`\overline{u'}^{2}` ， :math:`\overline{v'^{2}}` 和 :math:`\overline{w'^{2}}` 来量化。这三个法向雷诺应力也可以认为是单位质量湍动速度场的动能在三个坐标方向的分量。这些雷诺应力通常用自由平均流速 :math:`U_{e}` 来标准化：

.. math::
	\begin{align}
	\hat{u} := \frac{\sqrt{\overline{u'^{2}}}}{U_{e}}
	,\quad
	\hat{v} := \frac{\sqrt{\overline{v'^{2}}}}{U_{e}}
	,\quad
	\hat{w} := \frac{\sqrt{\overline{w'^{2}}}}{U_{e}}
	\end{align}

它们被称为三个方向的湍流相对强度(relative intensities)分量。

对于不可压缩平板边界层三个方向的相对强度，他们的大部分边界层中的分布都呈现不同的值，这是因为湍流是各向异性的(anisotropic)。对于平板边界层，有大致的估计关系：

.. math::
	\begin{align}
	\overline{u'^{2}} : \overline{v'^{2}} : \overline{w'^{2}} = 4 : 2 : 3
	\end{align}

.. attention:: 这些比值在整个层里当然不是恒定的，也肯定不适用于受到压力梯度和压缩性强烈影响的边界层。

流向强度 :math:`\hat{u}=\sqrt{\overline{u'^{2}}}/U_{e}` 在非常接近表明的地方超过了10%，这与瞬时速度分布是一致的，也进一步说明了湍流波动不能充分地作为对平均值的小扰动来处理。

如果将三个法向雷诺应力相加并乘以二分之一，就得到了湍流动能(turbulence kinetic energy)，用符号 :math:`k` 表示，这是单位质量湍流流动的动能，也即定义为

.. math::
	\begin{align}
	k := \frac{1}{2}(\overline{u'^{2}} + \overline{v'^{2}} + \overline{w'^{2}}) = \frac{1}{2}\overline{u_{i}'u_{i}'}  
	\end{align}

目前许多的湍流模型都不能区分单个法向雷诺应力，湍流模型只提供 :math:`k` ，于是我们常常假设湍动或多或少是各向同性的(isotropic)，即 :math:`\overline{u'^{2}} \approx \overline{v'^{2}} \approx \overline{w'^{2}}` ，于是定义以百分比表示的相对湍流强度：

.. math::
	\begin{align}
	T' := 100 \sqrt{\frac{2}{3}\frac{k}{U_{e}^{2}}} 
	\end{align}



两点关联张量和相关尺度
^^^^^^^^^^^^^^^^^^^^^^^^

之前讨论的内容都是单点关联的(single-point correlations)，也即处理流场中一个点上的湍动关联。但是，湍流涡旋范围较大且持续时间长，因此它一般不能够完全仅通过当地流场特性来描述。因此，就需要引入两点关联(two-point correlations)以及相关的湍流运动的时间、长度尺度特性。

.. note:: 

	与气体的分子运动不同，湍流中任意一点的运动都会通过压力场影响遥远的其他点，并且仅仅通过单个流体粒子的平均值无法充分地描述这一过程。可以说，湍流运动比分子运动要没那么随机且更有组织性(organized)，要描述这一组织过程(organization)就需要基于位于不同地方的两个或更多粒子的流动变量的平均值。

在湍流的实验和理论研究中常用到的两点关联有两种。一种是时间上的分离，另一种是空间上的分离。这两种关联可以通过Taylor假设联系起来：

.. math::
	\begin{align}
	\frac{\partial }{\partial t} = -U\frac{\partial }{\partial x}  
	\end{align}

这意味着湍动以平均流的速度 :math:`U` 进行对流。只要湍动足够弱，能够避免引起对流速度的重大变化，那么Taylor假设就是有效的。这种关系使得能够从更容易测量的单点时间相关数据推断出更相关的两点空间相关信息。

考虑速度在流场中一个点、两个不同时间的关联，定义出自相关张量(autocorrelation tensor)为

.. math::
	\begin{align}
	\mathcal{R} _{ij}(\mathbf{x},t;t') = \overline{u_{i}'(\mathbf{x},t)u_{j}'(\mathbf{x},t+t')}
	\end{align}

也就是说，我们对空间中同一点的湍动量在不同时间点进行了时间平均。为了得到与单点数据的联系，注意到湍流动能是 :math:`\mathcal{R} _{ij}` 在 :math:`t'=0` 时的迹的一半，即

.. math::
	\begin{align}
	k(\mathbf{x},t) = \frac{1}{2}\mathcal{R}_{ii}(\mathbf{x},t;0)  
	\end{align}

一个衡量能量承载涡的时间尺度可以通过对在所有可能 :math:`t'` 时的 :math:`\mathcal{R}_{ii}` 进行积分得到，因此我们通过定义 :math:`\tau(\mathbf{x},t)` 来得到积分时间尺度(integral time scale)：

.. math::
	\begin{align}
	\tau(\mathbf{x},t) = \int_{0}^{\infty}\frac{\mathcal{R}_{ii}(\mathbf{x},t;t')}{2k(\mathbf{x},t)}~\mathrm{d}t' 
	\end{align}

对于涉及静止湍流的实验工作，即其平均值与时间无关的湍流，我们通常使用单个顺流分量 :math:`\mathcal{R}_{11}(\mathbf{x};t') = \overline{u'(\mathbf{x},t)u'(\mathbf{x},t+t')}` 。通过除以 :math:`\overline{u'^{2}}` 进行标准化，我们就得到了欧拉时间相关系数(Eulerian time-correlation coefficient)：

.. math::
	\begin{align}
	\mathcal{R}_{E}(\mathbf{x};t') := \frac{\overline{u'(\mathbf{x},t)u'(\mathbf{x},t+t')}}{\overline{u'^{2}(\mathbf{x})}} 
	\end{align}

根据定义，当 :math:`t'=0` 时有 :math:`\mathcal{R}_{E}=1` 。对于 :math:`t'` 比较大时，我们期望湍动不再产生关联，因此当 :math:`|t'|\to \infty` 时有 :math:`\mathcal{R}_{E} \to 0` 。最后，转换时间原点可以得到 :math:`\mathcal{R}_{11}(\mathbf{x};t') = \mathcal{R}_{11}(\mathbf{x};-t')` ，所以 :math:`R_{E}` 是关于 :math:`t'` 的奇函数。


我们可以通过欧拉时间相关系数在小时间位移 :math:`t'` 下的形状来确定另一个时间尺度。这一尺度主要由小的耗散涡决定。通过在 :math:`t'=0` 处进行泰勒展开可以得到

.. math::
	\begin{align}
	\mathcal{R}_{E}(\mathbf{x};t')
	1 + \frac{t'}{2}\Big( \frac{\partial^{2}\mathcal{R}_{E}}{\partial t'^{2}} \Big)_{t'=0} + \cdots
	\approx 1 - \Big( \frac{t'}{\tau_{E}} \Big)^{2}
	\end{align}

其中我们定义微时间尺度(micro-time scale) :math:`\tau_{E}` 为

.. math::
	\begin{align}
	\tau_{E} := \sqrt{\frac{-2}{(\partial ^{2}\mathcal{R}_{E}/\partial t'^{2})_{t'=0}}} 
	\end{align}


接下来讨论两点空间关联，考虑流动中位于两个不同位置的两个点，位置分别记为 :math:`\mathbf{x}` 和 :math:`\mathbf{x}+\mathbf{r}` ，然后进行时间平均，于是定义两点速度关联张量(two-point velocity correlation tensor)为

.. math::
	\begin{align}
	R_{ij}(\mathbf{x},t;\mathbf{r}) = \overline{u_{i}'(\mathbf{x},t)u_{j}'(\mathbf{x}+\mathbf{r},t)}
	\end{align}

这里的矢量 :math:`\mathbf{r}` 是流场中两点之间的位移矢量。与自相关张量(autocorrelation tensor)一样，湍流动能是位移为零时的 :math:`R_{ij}` 的迹的一半，即

.. math::
	\begin{align}
	k(\mathbf{x},t) = \frac{1}{2}R_{ij}(\mathbf{x},t;\mathbf{0})
	\end{align}


定义积分长度尺度(integral length scale) :math:`\ell` 为 :math:`R_{ii}` 沿所有位移的积分：

.. math::
	\begin{align}
	\ell (\mathbf{x},t) := \frac{3}{16}\int_{0}^{\infty}\frac{R_{ii}(\mathbf{x},t;r)}{k(\mathbf{x},t)}~\mathrm{d}r
	\end{align}

其中 :math:`r=|\mathbf{r}|` ， :math:`3/16` 是一个比例系数。

通过完全类似于分析两点时间相关性的方式，我们可以确定与最小涡流对应的长度尺度。定义静止湍流的纵向相关函数(longitudinal correlation function)为

.. math::
	\begin{align}
	f(x;r) := \frac{R_{11}(x;r)}{\overline{u'^{2}(x)}}
	\end{align}


构造函数 :math:`f(x;r)` 的紧密抛物线(osculating parabola)，就可以定义出泰勒微尺度(Taylor microscale)：

.. math::
	\begin{align}
	\lambda := \sqrt{\frac{-2}{(\partial ^{2}f/\partial x^{2})_{x=0}} } 
	\end{align}

根据泰勒假设(Taylor's hypothesis)，微时间尺度 :math:`\tau_{E}` 和泰勒微尺度 :math:`\lambda` 满足关系：

.. math::
	\begin{align}
	\lambda = U\tau_{E}
	\end{align}

当湍流为均匀、各向同性时，Taylor的分析表明，湍流动能满足

.. math::
	\begin{align}
	\frac{\mathrm{d} k}{\mathrm{d} t} = - \frac{10\nu k}{\lambda^{2}}
	\end{align}

为了得到泰勒微尺度 :math:`\lambda` 和Kolmogorov长度的关系，对于均匀的、各向同性的湍流， :math:`k` 的衰减速率就等于耗散率 :math:`\varepsilon` ，即

.. math::
	\begin{align}
	\frac{\mathrm{d} k}{\mathrm{d} t} = - \varepsilon
	\quad \Rightarrow \quad 
	\varepsilon = \frac{10\nu k}{\lambda^{2}} 
	\end{align}

当雷诺数不是非常小的时候，有 :math:`\varepsilon \sim k^{3/2}/\ell` ，通过添加比例系数可以更明确地进行估计：

.. math::
	\begin{align}
	\varepsilon \approx 0.09\frac{k^{3/2}}{\ell}
	\quad \Rightarrow \quad
	k \approx \Big(\frac{\varepsilon\ell}{0.09} \Big)^{2/3}
	\end{align}

然后根据Kolmogorov长度的定义 :math:`\eta = (\nu^{3}/\varepsilon)^{1/4}` ，结合上式就可以得到

.. math::
	\begin{align}
	\frac{\lambda }{\eta} \approx 7\Big(\frac{\ell}{\eta}\Big)^{1/3}
	\end{align}

由于 :math:`\ell/\eta` 必须至少为 :math:`10^{3}` 来得到明确的惯性附区(inertial subrange)，所以泰勒微尺度(Taylor microscale)就应当至少是Kolmogorov长度的 :math:`70` 倍。这一般位于惯性附区而远远超出最小涡流的范围。


.. note:: 

	为了理解为何泰勒微尺度是混合长度尺度，可以通过 :math:`\varepsilon = 10\nu k/\lambda^{2}` 来推导得到该长度尺度的表达式为

	.. math::
		\begin{align}
		\lambda  = \sqrt{\frac{10\nu k}{\varepsilon}} 
		\end{align}

	可以看到，这个长度尺度既包括反映大的能量涡的量 :math:`k` ，也包括小的耗散涡的量 :math:`\nu` 与 :math:`\varepsilon` 。因为泰勒微尺度通常来说对于大涡来说太小，而对耗散小涡来说又太大，因此它在湍流建模研究当中常常被忽略。微时间尺度 :math:`\tau_{E}` 也是同样的道理。




玻尔兹曼涡流粘度近似(Boussinesq eddy-viscosity approximation)
------------------------------------------------------------------

为了理解Boussinesq近似的动机，可以首先在分子水平上讨论动量输运(Molecular Transport of Momentum)。

.. attention:: 

	然而，要注意的是，分子和湍流涡流是根本不同的，湍流和分子混合之间的类比是错误的！不过尽管如此，用这个类比来说明检验湍流近似的前提的重要性还是很有用处的。

首先考虑剪切流，其中速度为 :math:`\mathbf{U}=U(y)\mathbf{i}` ，其中 :math:`\mathbf{i}` 是沿x方向的单位向量。注意到分子运动在大小和方向上是随机的，那么考虑部分随机分子穿过平面 :math:`y=0` 的动量通量就意味着原运动方向的动量损失，这就变现出切应力 :math:`t_{xy}` 。在分子层面上，我们将速度分解为

.. math::
	\begin{align}
	\mathbf{u} = \mathbf{U} + \mathbf{u}''
	\end{align}

其中 :math:`\mathbf{U}` 表示剪切流的平均速度， :math:`\mathbf{u}''` 表示分子的随机运动。任意物理量穿过面 :math:`y=0` 的瞬时通量都可以写成关于垂直该面的速度的关系，对于该剪切流这个法向速度定义为 :math:`v''` ，因此，穿过一个法向法向为y的微分面域 :math:`\mathrm{d}S` 的x方向瞬时动量通量 :math:`\mathrm{d}p_{xy}` 表示为

.. math::
	\begin{align}
	\mathrm{d}p_{xy} = \rho (U + u'')v''\mathrm{d}S  
	\end{align}

对所有分子进行整体平均，可以得到

.. math::
	\begin{align}
	\mathrm{d}P_{xy} = \overline{\rho u''v''}\mathrm{d}S 
	\end{align}

作用在 :math:`y=0` 处的应力定义为 :math:`\sigma_{xy} = \mathrm{d}P_{xy}/\mathrm{d}S` 。在流体研究中常分解为 :math:`\sigma_{ij}=p\delta_{ij}-t_{ij}` ，其中 :math:`p` 为压力， :math:`t_{ij}` 为粘性应力张量，因此

.. math::
	\begin{align}
	t_{xy} = -\overline{\rho u''v''}
	\end{align}

上式与雷诺应力张量非常相似，而这并非巧合，Tennekes和Lumley指出通过动量通量产生的应力总是可以写成这种形式。它与雷诺应力张量的唯一真正区别是，宏观层面上的湍流波动的 :math:`u'` 和 :math:`v'` 取代了随机分子波动的 :math:`u''` 和 :math:`v''` 。这种相似性是Boussinesq涡流粘度近似(Boussinesq eddy-viscosity approximation)的基础。

现在通过气体动理学理论来推导 :math:`t_{xy}` 与 :math:`U(y)` 和流体粘度 :math:`\mu` 的关系。首先考虑在+y方向上穿过单位面积的分子平均数量，对于理想气体，分子速度满足Maxwellian分布，于是所有运动方向都是可能的。分子速度的平均称为热速度(thermal velocity) :math:`v_{\text{th}}` ，它大约是空气中声速的4/3。平均来说，有一半的分子沿y轴正向运动，而另一半沿y轴负向运动，在y轴这一垂直分量的平均速度则为 :math:`v_{\text{th}}\cos\phi` ，其中 :math:`\phi` 为与垂线的夹角。在半球面上积分，得到平均垂直速度为 :math:`v_{\text{th}}/2` 。因此，在+y方向上穿过单位面积的分子数量为 :math:`nv_{\text{th}}/4` ，其中 :math:`n` 为单位体积的分子数量。

考虑分子从P点穿过 :math:`y=0` 平面发生的动量转移，这一运动过程位移长度为分子的平均自由程，于是每个分子从P点到 :math:`y=0` 后的动量损失为 :math:`m[U(0)-U(-\ell_{\text{mfp}})]` ，其中 :math:`m` 为分子质量， :math:`\ell_{\text{mfp}}` 为平均自由程(mean free path)。因此，从平面下方的动量通量为

.. math::
	\begin{align}
	\Delta P_{-} = \frac{1}{4}\rho v_{\text{th}}[U(0) - U(-\ell_{\text{mfp}})]
	\approx \frac{1}{4} \rho v_{\text{th}}\ell_{\text{mfp}}\frac{\mathrm{d} U}{\mathrm{d} y} 
	\end{align}


.. note:: 上式中 :math:`U(-\ell_{\text{mfp}})` 替换为了其泰勒展开的前两项，并且利用了关系 :math:`\rho = mn` 。

类似的，每个分子从 :math:`y=0` 平面上方的Q点带来的动量增加为 :math:`m[U(\ell_{\text{mfp}})-U(0)]` ，于是从上方的动量通量为

.. math::
	\begin{align}
	\Delta P_{+} = \frac{1}{4}\rho v_{\text{th}}[U(\ell_{\text{mfp}}) - U(0)]
	\approx \frac{1}{4}v_{\text{th}}\ell_{\text{mfp}}\frac{\mathrm{d} U}{\mathrm{d} y}  
	\end{align}

从而净剪切力为 :math:`\Delta P_{-}` 与 :math:`\Delta P_{+}` 的和，即

.. math::
	\begin{align}
	t_{xy} = \Delta P_{-} + \Delta P_{+} \approx \frac{1}{2}\rho v_{\text{th}}\ell_{\text{mfp}}\frac{\mathrm{d}U}{\mathrm{d}y} 
	\end{align}

因此可以得出，在理想气体中，由分子动量迁移引起的剪切力为

.. math::
	\begin{align}
	t_{xy} = \mu\frac{\mathrm{d} U}{\mathrm{d} y} 
	\end{align}

其中 :math:`\mu` 定义为分子粘度：

.. math::
	\begin{align}
	\mu = \frac{1}{2}\rho v_{\text{th}}\ell_{\text{mfp}}
	\end{align}

.. note:: 

	推导得到上面两个式子的过程中其实用到了许多近似，因此上式只是粗略地反映了分子运动的真实统计性质，不过Jeans通过精确分析得出 :math:`\mu = 0.499\rho v_{\text{th}}\ell_{\text{mfp}}` ，说明上式的近似程度还是足够精确的。但是需要注意的是，上述分析过程中我们用到了两个隐性的假设需要验证：

	**Assumption 1** ：上面的过程使用了泰勒展开前两项的线性项作为近似，要想这个近似是合理的，就要求 :math:`\ell_{\text{mfp}} |\mathrm{d^{2}}U/\mathrm{d}y^{2}| \ll |\mathrm{d}U / \mathrm{d} y|` 。长度量 :math:`L` 是平均流的长度尺度特征，定义为

	.. math::
		\begin{align}
		L := \frac{|\mathrm{d}U / \mathrm{d} y|}{|\mathrm{d^{2}}U/\mathrm{d}y^{2}|} 
		\end{align}

	因此，在Knudsen数 :math:`Kn` 非常小的情况下，应力与应变率的线性关系是成立的。Knudsen数定义为

	.. math::
		\begin{align}
		Kn = \ell_{\text{mfp}} / L \ll 1
		\end{align}

	对于大多数实际流动条件，平均自由程比平均流动的任何特征长度尺度小几个数量级。因此，上式几乎在所有地面工程问题都满足，两个值得注意的例外是高空飞行和微米级流动，例如在微型机械中遇到的流动。


	**Assumption 2** ：在计算分子穿过 :math:`y=0` 的概率时，我们在存在剪应力的情况仍假设了 :math:`\mathbf{u}''` 满足Maxwellian分布。这只有在分子在平均流的时间尺度上经历多次碰撞的情况下才成立，否则分子将没有足够的时间来适应平均流量的变化。碰撞之间的平均实践间隔为 :math:`\ell_{\text{mfp}}/v_{\text{th}}` ，平均流的特征时间尺度为 :math:`|\mathrm{d}U / \mathrm{d} y|^{-1}` ，因此我们也要求

	.. math::
		\begin{align}
		\ell_{\text{mfp}}  \ll \frac{v_{\text{th}}}{|\mathrm{d} U/\mathrm{d} y|} 
		\end{align}

	由于 :math:`v_{\text{th}}` 与声速在同一数量级，上式的右边也可以定义出另一个平均流长度尺度。如上所述，对于几乎所有工程上的流动，平均自由程都比这个尺度小几个数量级，因此上式也大部分时候是成立的。


混合长度假说(The Mixing-Length Hypothesis)
---------------------------------------------

混合长度假说由Prandtl提出，他给出了一个湍流运动的简化模型，在这个模型中，流体粒子结合成粘在一起的团块并作为一个整体移动。他指出，在之前提到的剪切流中，团块在y方向的一段距离内仍保持x方向的动量，这一段距离他称之为混合长度 :math:`\ell_{\text{mix}}` 。通过类比，用Prandtl提出的混合长度代替平均自由程来推导分子动量输运过程，就得到了

.. math::
	\begin{align}
	\rho \tau_{xy} = \frac{1}{2}\rho v_{\text{mix}}\ell_{\text{mix}}\frac{\mathrm{d} U}{\mathrm{d} y}
	\quad \Rightarrow \quad
	\tau_{xy} = \frac{1}{2}v_{\text{mix}}\ell_{\text{mix}}\frac{\mathrm{d} U}{\mathrm{d} y}  
	\end{align}

不过上面这个方程还不完备，因为混合速度 :math:`v_{\text{mix}}` 还没有定义。Prandtl进一步假设

.. math::
	\begin{align}
	v_{\text{mix}} = \text{constant} \cdot \ell_{\text{mix}}\Big| \frac{\mathrm{d} U}{\mathrm{d} y}  \Big| 
	\end{align}

于是通过类比，Prandtl的混合长度假说最终推出了

.. math::
	\begin{align}
	\tau_{xy} = \nu_{t}\frac{\mathrm{d} U}{\mathrm{d} y} 
	\end{align}

其中运动涡流粘度 :math:`\nu_{t}` 定义为

.. math::
	\begin{align}
	\nu_{t} = \ell_{\text{mix}}^{2}\Big| \frac{\mathrm{d} U}{\mathrm{d} y}  \Big|
	\end{align}

Prandtl进一步假设，对于固体边界附近的流动，壁面附近的切应力等于壁面上的切应力，即 :math:`\tau = \tau_{w}`；同时假设混合长度与到璧面的距离成正比，即 :math:`\ell_{\text{mix}}=\kappa y` ，其中 :math:`\kappa` 为卡门通用常数，实验表明 :math:`\kappa\approx 0.4` 。将上述假设代入简化的湍流切应力表达式则有


.. math::
	\begin{align}
	\tau_{w} = \rho (\kappa y)^{2} \Big( \frac{\mathrm{d}u}{\mathrm{d}y} \Big)^{2}
	\quad \Rightarrow \quad 
	\mathrm{d}u = \frac{1}{\kappa}\sqrt{\frac{\tau_{w}}{\rho}}\frac{\mathrm{d}y}{y}   
	\end{align}

其中 :math:`\tau_{w}` 为定值，于是阻力速度 :math:`u_{w}=\sqrt{\frac{\tau_{w}}{\rho}}` 为常数，从而可以对上式积分得到 **湍流断面流速分布的对数公式** ：

.. math::
	\begin{align}
	u = \frac{u_{w}}{\kappa}\ln y + \text{const}
	\end{align}

结果证明，在湍流壁面流动的有限部分这是一个相当好的近似，混合长度与边界层宽度 :math:`\delta` 成正比。但是，对于不同的流动会有不同的比例系数，只有需要提前得知才能求解。


.. note:: 虽然上式是根据壁面附近的条件推导出来的，但是实验研究表明，该式适用于除了粘性底层以外的整个过流断面。

.. note:: 

	上式可以直接通过量纲分析推导出来。假设分子的动量传输相对于湍流传输来说可以忽略，那么我们期望分子粘度在量纲分析中没有意义，于是在剪切流中唯一可用的其他参数是所假设的混合长度 :math:`\ell_{\text{mix}}` 和速度梯度 :math:`\mathrm{d}U/\mathrm{d}y` 。涡流粘度不能依赖于 :math:`U` ，否则会违反伽利略不变性(Galilean invariance)。


.. attention:: 

	该理论的基本假设不够严谨，如认为流体质点经过混合长度之后，才一次性与周围质点进行动量交换，然而由于流体是连续介质，质点在横向运动过程中不断地与周围质点进行动量交换。又如公式中的常数 :math:`\kappa` 、 :math:`\text{const}` 等都需要实验确定。但尽管如此，这一理论是从湍流的基本特征出发，同时推导简单，理论结果与实验比较一致，所以仍是工程上广泛应用的湍流阻力理论。



湍流能量方程(The Turbulence Energy Equation)
-----------------------------------------------

湍流能量方程将非局部效应(incorporate nonlocal effects)和流动历史效应(flow history effects)对涡流粘度的影响考虑在内。Prandtl假设出计算湍流的特征速度尺度 :math:`v_{\text{mix}}` ，因此避免了需要假设 :math:`v_{\text{mix}} \sim \ell_{\text{mix}}|\partial U/\partial y|` 的麻烦。他选择湍动单位质量的动能 :math:`k` 作为他的基本速度尺度，即

.. math::
	\begin{align}
	k = \frac{1}{2}\overline{u_{i}'u_{i}'} = \frac{1}{2}\Big( \overline{u'^{2}} + \overline{v'^{2}} + \overline{w'^{2}}\Big)  
	\end{align}

因此，根据 :math:`k` 和湍流长度尺度 :math:`\ell` 的量纲关系，可以得到运动涡流粘度满足

.. math::
	\begin{align}
	\nu_{T} = \text{constant} \cdot k^{1/2}\ell
	\end{align}

通过对雷诺应力张量求迹可以得到湍流动能：

.. math::
	\begin{align}
	\tau_{ii} = -\overline{u_{i}'u_{i}'} = -2k
	\end{align}

也就是说，雷诺应力张量的迹与单位体积湍动的动能成正比。 :math:`k` 严格来说应该是单位质量湍流动能(specific turbulence kinetic energy)，不过也常简称为湍流动能(turbulence kinetic energy)。

借助之前推导的雷诺应力方程，通过对方程两边求迹就可以得到关于 :math:`k` 的方程。对于不可压缩流，张量 :math:`\Pi_{ij}` 求迹之后就消去了，从而可以得到湍流动能的输运方程为

.. math::
	\begin{align}
	\underbrace{\frac{\partial k}{\partial t}}_{\text{unsteady term}} 
	+ \underbrace{\overline{u_{j}} \frac{\partial k}{\partial x_{j}}}_{\text{convection}}
	= \underbrace{\tau_{ij}\frac{\partial \overline{u_{i}}}{\partial x_{j}}}_{\text{Production}}
	- \underbrace{\varepsilon}_{\text{Dissipation}}
	+ \frac{\partial }{\partial x_{j}} \Big[
	\underbrace{\nu\frac{\partial k}{\partial x_{j}}}_{\text{Molecular Diffusion}}
	- \underbrace{\frac{1}{2}\overline{u_{i}'u_{i}'u_{j}'}}_{\text{Turbulent Transport}}
	- \underbrace{\frac{1}{\rho}\overline{p'u_{j}'}}_{\text{Pressure Diffusion}} \Big]
	\end{align}

各项的物理含义如下：

- 非稳态项和对流项：与 :math:`k` 的物质导数相似，表示 :math:`k` 跟随流体粒子的变化率；
- 产生项：表示动能从平均流动到湍流的转换率。由于 :math:`\tau_{ij}` 是对称的，所以可以将其改写为 :math:`\tau_{ij}S_{ij}` ，如此来看可以认为是平均应变率对湍流应力做功的速率；
- 耗散率：  :math:`\varepsilon` 定义为 :math:`\varepsilon = \nu \overline{\frac{\partial u_{i}'}{\partial x_{k}} \frac{\partial u_{i}'}{\partial x_{k}} }` ，表示湍流动能转换为热力学内能的速率，等于应变率的湍动部分克服湍流粘性应力做功的速率；
- 分子扩散项：表示由于流体自然分子传输过程造成的湍流能量扩散；
- 湍流输运项：表示通过流体湍动传递动能的速率；
- 压力扩散项：表示由压力和速度波动的相关性引起的另一种形式的湍流输送。

.. attention:: 

	该定义与之前耗散率的经典定义有所不同。耗散率的经典定义称为真实耗散率 :math:`\varepsilon_{\text{true}}` ，它与湍动应变率张量 :math:`s_{ik}'` 的平方成正比，即

	.. math::
		\begin{align}
		\varepsilon_{\text{true}} = 2\nu\overline{s_{ik}'s_{ik}'}
		,\qquad 
		s_{ik}' = \frac{1}{2}\Big( \frac{\partial u_{i}'}{\partial x_{k}} + \frac{\partial u_{k}'}{\partial x_{i}} \Big)
		\end{align}

	于是，对于不可压缩流，耗散率 :math:`\varepsilon` 满足关系

	.. math::
		\begin{align}
		\varepsilon = \varepsilon_{\text{true}} - \frac{\partial }{\partial x_{k}}\Big( \nu \overline{u_{i}'\frac{\partial u_{k}'}{\partial x_{i}} } \Big) 
		\end{align}

	在实践中， :math:`\varepsilon` 和 :math:`\varepsilon_{\text{true}}` 之间的差异很小，只有在梯度非常大的区域，比如激波或粘性壁区域，差异才相对显著。在粘性壁区域的情况，Bradshaw和Perot表明，最大差异仅为2%，因此可以忽略。


在该方程中，产生项、耗散项、湍流输运项和压力扩散项都包含未知量，为了使方程封闭，就需要进一步确定出它们的表达式。 :math:`k` 方程的常规封闭方法由Prandtl提出，他为方程的每一项都建立了模型参数，用封闭近似值来代替未知的相关性项。这个过程其实并不严格，且该封闭近似也并不比它们所基于的湍流数据好。我们希望找到能够使精确解成为可能的封闭近似。

（1）雷诺应力张量：我们假设Boussinesq近似是成立的，于是雷诺应力张量可以表示为

.. math::
	\begin{align}
	\tau_{ij} = 2\nu_{T}S_{ij} - \frac{2}{3}k\delta_{ij}
	\end{align}

其中 :math:`S_{ij}` 为平均应变率张量。上式右边第二项是为了满足 :math:`\tau_{ij}` 的迹的性质，也即由于对于不可压缩流有 :math:`S_{ii}=0` ，为了满足 :math:`\tau_{ii}=-2k` 就需要额外的这一项。

.. attention:: 

	严格来说，我们应该将上式作为 :math:`\nu_{T}` 的定义，那么在这个意义上，只要不显式地说明 :math:`\nu_{T}` 是标量，就没有近似过程。然而我们实际上假设 :math:`\nu_{T}` 是个标量，因此用“近似”这个词是合适的。

（2）湍流输运项和压力扩散项：对湍流输运一个标量的标准近似操作是将其近似为梯度扩散，类比分子输运过程，我们认为 :math:`-\overline{u_{j}'\phi'} \sim \nu_{T}\partial \overline{\phi}/\partial x_{j}` 。但是，压力扩散项没有相关的可以直接类比的东西，因此它一般与湍流输运项绑定在一起，将它们的和视作一种梯度输运过程。因此我们假设

.. math::
	\begin{align}
	\frac{1}{2}\overline{u_{i}'u_{i}'u_{j}'} + \frac{1}{\rho}\overline{p'u_{j}'} = -\frac{\nu_{T}}{\sigma_{k}}\frac{\partial k}{\partial x_{j}}
	\end{align}

其中 :math:`\sigma_{k}` 是一个封闭系数。假设方程左右两边的向量是平行的，那么该方程就定义了 :math:`\sigma_{k}` 。


（3）耗散项：确定耗散项的方式在湍流能量方程中并不是唯一的。需要注意的是，我们仍然有两个未知数，即湍流长度尺度 :math:`\ell` 和耗散率 :math:`\varepsilon` 。如果假设这两个量都是湍流的严格函数，不受分子粘度等自然流体性质的影响，那么根据量纲分析可以证明

.. math::
	\begin{align}
	\varepsilon \sim k^{3/2}/\ell
	\end{align}

因此，我们仍然需要一个关于湍流长度尺度的解决方法来封闭方程组，这就涉及到后续的一方程模型、两方程模型。


最终，综上近似方法代入到原湍流动能方程，最终得到如下形式：

.. math::
	\begin{align}
	\frac{\partial k}{\partial t}
	+ \overline{u_{j}}\frac{\partial k}{\partial x_{j}}
	= \tau_{ij}\frac{\partial \overline{u_{i}}}{\partial x_{j}}
	- \varepsilon
	+ \frac{\partial }{\partial x_{j}}\Big[ (\nu + \nu_{T}/\sigma_{k})\frac{\partial k}{\partial x_{j}}  \Big]   
	\end{align}

其中 :math:`\tau_{ij}` 为

.. math::
	\begin{align}
	\tau_{ij} = 2\nu_{T}S_{ij} - \frac{2}{3}k\delta_{ij}
	\end{align}




一方程模型(One-Equation Models)
----------------------------------

Prandti's One-Equation Model
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

为了最终完全封闭湍流动能方程，Prandtl假设耗散率满足之前分析出的量纲关系式 :math:`\varepsilon \sim k^{3/2}/\ell` 并引入封闭系数 :math:`C_{D}` ，从而使耗散率表示为

.. math::
	\begin{align}
	\varepsilon = C_{D}k^{3/2}/\ell
	\end{align}

这样，湍流长度尺度就是模型中唯一未确定的部分。因此，Prandti's One-Equation Model为

.. math::
	\begin{align}
	\frac{\partial k}{\partial t}
	+ \overline{u_{j}}\frac{\partial k}{\partial x_{j}}
	= \tau_{ij}\frac{\partial \overline{u_{i}}}{\partial x_{j}}
	- C_{D}\frac{k^{3/2}}{\ell}
	+ \frac{\partial }{\partial x_{j}}\Big[ (\nu + \nu_{T}/\sigma_{k})\frac{\partial k}{\partial x_{j}}  \Big]     
	\end{align}

其中

.. math::
	\begin{align}
	\tau_{ij} = 2\nu_{T}S_{ij} - \frac{2}{3}k\delta_{ij}
	,\qquad 
	\nu_{T} = k^{1/2}\ell = C_{D}k^{2}/\varepsilon 
	\end{align}

.. attention:: 

	上面的过程其实做了一个隐性的假设。在之前的讨论中，严格来说应该是 :math:`\nu_{T}=\text{constant}\cdot k^{1/2}\ell` ，而上面的过程令常数等于1。实际上，没有任何先天原因能保证之前假设的constant就真的应该是一个常数，在现实中 :math:`\nu_{T}` 是一个湍流量与一个平均流量的比值，比如 :math:`-\overline{u'v'}` 和 :math:`\partial \overline{u}/\partial y+\partial \overline{v}/\partial x` 的比值。因此， :math:`\nu_{T}` 在一般情况下并不会精确的跟随平均流尺度(比如 :math:`U_{e}` 和 :math:`\delta^{*}` )或湍流尺度(比如 :math:`k` 和 :math:`\ell` )。只有在平衡流，即湍流产生和湍流耗散之间的平衡与平均流和湍流尺度成正比的情况，两个尺度才能用于 :math:`\nu_{T}` 。否则就需要一个未知的混合尺度来描述。

在该模型实际应用之前，还需要确定长度尺度 :math:`\ell` 以及两个封闭系数 :math:`\sigma_{k}` 和 :math:`C_{D}` ，也即需要两个封闭系数和一个封闭函数。


Baldwin-Barth model
^^^^^^^^^^^^^^^^^^^^^

Baldwin-Barth模型是完备的，因为它不涉及可调函数或系数。虽然这不能保证它对给定应用程序的适用性，但它确实使其实现更加方便。这种类型的模型构成了湍流最简单的完整模型。

Kinematic Eddy Viscosity：

.. math::
	\begin{align}
	\nu_{T} = C_{\mu}\nu \tilde{R}_{T}D_{1}D_{2}
	\end{align}

Turbulence Reynolds Numbers：

.. math::
	\begin{align}
	\frac{\partial }{\partial t}\Big( \nu\tilde{R}_{T} \Big)
	+ \overline{u_{j}}\frac{\partial }{\partial x_{j}}\Big( \nu\tilde{R}_{T} \Big)
	= (C_{\varepsilon2}f_{2} - C_{\varepsilon1})\sqrt{\nu \tilde{R}_{T}P}
	+ (\nu + \nu_{T}/\sigma_{\varepsilon })\frac{\partial^{2}(\nu\tilde{R}_{T})}{\partial x_{k}\partial x_{k}}
	- \frac{1}{\sigma_{\varepsilon }}\frac{\partial \nu_{T}}{\partial x_{k}}\frac{\partial (\nu\tilde{R}_{T})}{\partial x_{k}}   
	\end{align}

Closure Coefficients and Auxiliary Relations：

.. math::
	\begin{align}
	C_{\varepsilon 1} = 1.2
	,\quad C_{\varepsilon 2} = 2.0
	,\quad C_{\mu} = 0.09
	,\quad A_{o}^{+} = 26
	,\quad A_{2}^{+} = 10
	\end{align}

.. math::
	\begin{align}
	\frac{1}{\sigma_{\varepsilon }} = (C_{\varepsilon2} - C_{\varepsilon 1})\frac{\sqrt{C_{\mu}} }{\kappa^{2}}
	,\qquad \kappa = 0.41
	\end{align}

.. math::
	\begin{align}
	P = \nu_{T} \Big[ 
	\Big( \frac{\partial \overline{u}_{i}}{\partial x_{j}} + \frac{\partial \overline{u_{j}}}{\partial x_{i}} \Big)\frac{\partial \overline{u_{i}}}{\partial x_{j}}
	- \frac{2}{3}\frac{\partial \overline{u_{k}}}{\partial x_{k}}\frac{\partial \overline{u_{k}}}{\partial x_{k}}
	 \Big]
	\end{align}

.. math::
	\begin{align}
	D_{1} = 1 - e^{-y^{+}/A_{o}^{+}}
	,\qquad 
	D_{2} = 1 - e^{-y^{+}/A_{2}^{+}}
	\end{align}

.. math::
	\begin{align}
	f_{2} = \frac{C_{\varepsilon 1}}{C_{\varepsilon 2}}
	+ \Big( 1 - \frac{C_{\varepsilon 1}}{C_{\varepsilon 2}} \Big)
	\Big( \frac{1}{\kappa y^{+}} + D_{1}D_{2} \Big)
	\cdot \Big[
	\sqrt{D_{1}D_{2}}
	+ \frac{y^{+}}{\sqrt{D_{1}D_{2}}}
	\Big( 
	\frac{D_{2}}{A_{o}^{+}} e^{-y^{+}/A_{o}^{+}}
	+ \frac{D_{1}}{A_{2}^{+}}e^{-y^{+}/A_{2}^{+}}
	\Big) 
	\Big]
	\end{align}


.. attention:: 

	Baldwin-Barth模型通过将耗散率表示为空间梯度的关系来避免了指定耗散长度 :math:`\ell` 的需求，也即该模型将耗散项改写成了

	.. math::
		\begin{align}
		\varepsilon_{\nu} = \frac{1}{\sigma_{\varepsilon }}\frac{\partial \nu_{T}}{\partial x_{k}}\frac{\partial (\nu\tilde{R}_{T})}{\partial x_{k}} 
		\end{align}

	也正因为这一封闭近似，当空间梯度消失的时候就会有 :math:`\varepsilon_{\nu}=0` ，因此涡流粘度不仅不会随着水流距离衰减，反而会在均一流中保持常数。这种不正确的特性会导致一些非物理的扩散结果。

	Baldwin-Barth模型预测的计算值和测量值之间的差异要比Spalart-Allmaras模型和更简单的代数模型大得多。差异如此之大(16个附呈边界层情况的平均差异为24%)，以至于将其用于边界层流动是不可取的。它对涡流粘度的自由流值也非常敏感，并且很难以有限差分形式进行构造(比如会产生病态矩阵)，因此最好不选用该模型。


Spalart-Allmaras model 
^^^^^^^^^^^^^^^^^^^^^^^^

Spalart-Allmaras模型也是用涡粘性来描述的。该模型包含8个封闭系数和3个封闭函数。其定义方程如下:

Kinematic Eddy Viscosity：

.. math::
	\begin{align}
	\nu_{T} = \tilde{\nu}f_{v1}
	\end{align}

Eddy Viscosity Equation：

.. math::
	\begin{align}
	\frac{\partial \tilde{\nu}}{\partial t}
	+ \overline{u_{j}}\frac{\partial \tilde{\nu}}{\partial x_{j}}
	= c_{b1}\tilde{S}\tilde{\nu}
	- c_{w1}f_{w}\Big(\frac{\tilde{\nu}}{d}\Big)^{2}
	+ \frac{1}{\sigma}\frac{\partial }{\partial x_{k}}\Big[ (\nu + \tilde{\nu})\frac{\partial \tilde{\nu}}{\partial x_{k}} \Big] 
	+ \frac{c_{b2}}{\sigma}\frac{\partial \tilde{\nu}}{\partial x_{k}}\frac{\partial \tilde{\nu}}{\partial x_{k}}
	\end{align}

Closure Coefficients and Auxiliary Relations：

.. math::
	\begin{align}
	c_{b1} = 0.1355
	,\quad c_{b2} = 0.622
	,\quad c_{v1} = 7.1
	,\quad \sigma = 2/3
	\end{align}

.. math::
	\begin{align}
	c_{w1} = \frac{c_{b1}}{\kappa^{2}} + \frac{1+c_{b2}}{\sigma}
	,\quad c_{w2} = 0.3
	,\quad c_{w3} = 2
	,\quad \kappa = 0.41 
	\end{align}

.. math::
	\begin{align}
	f_{v1} = \frac{\chi^{3}}{\chi^{3} + c_{v1}^{3}}
	,\quad f_{v2} = 1 - \frac{\chi}{1 + \chi f_{v1}}
	,\quad f_{w} = g \Big[ \frac{1 + c_{w3}^{6}}{g^{6} + c_{w3}^{6}} \Big]^{1/6}
	\end{align}

.. math::
	\begin{align}
	\chi = \frac{\tilde{\nu}}{\nu}
	,\quad g = r + c_{w2}(r^{6} - r)
	,\quad r = \frac{\tilde{\nu}}{\tilde{S}\kappa^{2}d^{2}}  
	\end{align}

.. math::
	\begin{align}
	\tilde{S} = S + \frac{\tilde{\nu}}{\kappa^{2}d^{2}}f_{v2}
	,\quad 
	S = \sqrt{2\Omega_{ij}\Omega_{ij}}
	\end{align}

其中 :math:`\Omega_{ij} = \frac{1}{2}(\partial \overline{u_{i}}/\partial x_{j} - \partial \overline{u_{j}}/\partial x_{i})` 是旋转张量， :math:`d` 为到最近表面的距离。虽然没有在这里列出，但模型还包括一个过渡修正，引入了四个额外的封闭系数和两个更多的经验函数。 

.. attention:: 

	该模型中涡流粘度方程的源项取决于到最近表面的距离 :math:`d` 以及 :math:`\tilde{\nu}` 的梯度。当 :math:`d\to \infty` 远离固体边界时，该模型同样也预测涡流粘度在均匀流中不衰减。

	经过实验对比，Spalart-Allmaras模型的预测对于许多工程应用来说是足够好的，特别是关于翼型和机翼的应用。但是，它不能够再现喷射扩散速率，这也表明该模型具有一些缺陷。虽然与混合长度模型相比，对流动之间关系进行调整的需求较小，但是Spalart-Allmaras模型不能很好地预测平面射流、圆形射流和径向射流的扩散速率。此外，虽然该模型对附加边界层的预测通常与代数模型的测量结果一样接近，但是它对Stratford incipient-separation case的表面摩擦预测值比测量结果要高几倍。最后，虽然它与后向台阶和小分离气泡翼型的实测再附长度非常接近，但是它对驱动流的预测分离气泡明显大于实测。



双方程模型(Two-Equation Models)
---------------------------------

两方程模型不仅提供了 :math:`k` 的计算方法，而且还提供了湍流长度尺度或等效尺度的计算方法。因此，双方程模型是完备的，可以在不了解湍流结构的前提下预测给定湍流的特性。

几乎所有双方程模型的基础都是Boussinesq近似 :math:`\tau_{ij} = 2\nu_{T}S_{ij} - \frac{2}{3}k\delta_{ij}` ，以及下面形式的湍流动能方程：

.. math::
	\begin{align}
	\frac{\partial k}{\partial t}
	+ \overline{u_{j}}\frac{\partial k}{\partial x_{j}}
	= \tau_{ij}\frac{\partial \overline{u_{i}}}{\partial x_{j}}
	- \varepsilon
	+ \frac{\partial }{\partial x_{j}}\Big[ (\nu + \nu_{T}/\sigma_{k})\frac{\partial k}{\partial x_{j}}  \Big]   
	\end{align}

正如之前提到的那样，我们定义湍流长度尺度 :math:`\ell` 与速度尺度 :math:`k^{1/2}` 相匹配的方式是任意的。例如，Kolmogorov指出需要引入第二个方程来计算比耗散率(specific dissipation rate) :math:`\omega` ，该量的量纲为 :math:`T^{-1}` 。通过量纲分析，可以确定涡流粘度、湍流长度尺度和耗散率满足

.. math::
	\begin{align}
	\nu_{T} \sim k/\omega 
	,\quad \ell \sim k^{1/2}/\omega 
	,\quad \varepsilon \sim \omega k
	\end{align}

chou提出直接为 :math:`\varepsilon` 建模，运动涡流粘性和湍流长度尺度分别满足

.. math::
	\begin{align}
	\nu_{T} \sim k^{2}/\varepsilon 
	,\quad 
	\ell \sim k^{3/2}/\varepsilon 
	\end{align}

Rotta首先提出了湍流长度尺度的输运方程，后来又提出了 :math:`k` 和 :math:`\ell` 乘积的方程，两个方程中都有

.. math::
	\begin{align}
	\nu_{T} \sim k^{1/2}/\ell 
	,\quad 
	\varepsilon \sim k^{3/2}/\ell
	\end{align}

Zeierman和Wolfshtein引入了 :math:`k` 的输运方程以及湍流耗散时间(turbulence dissipation time) :math:`\tau` 的输运方程。而湍流耗散时间本质上是Kolmogorov定义的比耗散率的倒数。并且Speziale、Abid和Anderson为 :math:`\tau` 建立了方程，对于这些模型有

.. math::
	\begin{align}
	\nu_{T} \sim k \tau 
	,\quad 
	\ell \sim k^{1/2}\tau 
	,\quad 
	\varepsilon \sim k/\tau
	\end{align}


.. attention:: 

	与单方程模型一样，没有根本的理由认为 :math:`\nu_{T}` 只取决于 :math:`k` 、 :math:`\ell` 、 :math:`\varepsilon` 或 :math:`\omega` 。一般来说，单个雷诺应力与平均应变率分量的比值同时取决于平均流动和湍流尺度。因此，双方程模型并不一定比单方程模型更适用于湍流流动，并且可以预见到对于许多非平衡湍流流动它也是不准确的。不仅如此，另一个微分方程的添加还会带来数值求解困难和各种意想不到的数学异常。


k-omega模型
^^^^^^^^^^^^^^








涡粘模型(Eddy Viscosity Model)
-----------------------------------

从数学形式上看，雷诺应力很像二阶应力张量。因此Boussinesq仿照分子粘性应力与速度变形率的关系，提出了关于涡粘性(eddy viscosity)的 **Boussinesq假设** ，认为雷诺应力与平均速度变形率成线性关系：

.. math::
	\begin{align}
	\mathbf{R}
	= \nu_{t} \Big( \nabla\overline{\mathbf{U}} + (\nabla\overline{\mathbf{U}})^{T} - \frac{2}{3}(\nabla\cdot\overline{\mathbf{U}})\mathbf{I} \Big) - \frac{2}{3}k\mathbf{I}
	\end{align}


其中 :math:`k` 为湍动能(turbulence kinetic energy)，定义为 :math:`k = \frac{1}{2}\overline{\mathbf{U}' \cdot \mathbf{U}'} = \frac{1}{2}(\overline{u_{x}'u_{x}'} + \overline{u_{y}'u_{y}'} + \overline{u_{z}'u_{z}'})` 。 :math:`\nu_{t}` 被称为 **湍流粘度** 或 **涡粘系数** ，它与一般流体粘度不同，它不是流体的固有物理属性，而是和当地的湍流强度有关。对于流场中不同位置的点，湍流粘度的值都不尽相同。

根据这一假设，将上式代入雷诺时均动量方程可以得到

.. math::
	\begin{align}
	\frac{\partial (\rho\overline{\mathbf{U}})}{\partial t}
	+ \nabla \cdot \rho(\overline{\mathbf{U}} \otimes \overline{\mathbf{U}})
	= -\nabla p^{*}
	+ \rho\overline{\mathbf{f}}
	+ \nabla \cdot \Big\{ \mu_{\text{eff}}\big[ \nabla\overline{\mathbf{U}} + (\nabla\overline{\mathbf{U}})^{T} - \frac{2}{3}(\nabla \cdot \overline{\mathbf{U}})\mathbf{I} \big] \Big\}
	\end{align}

其中 :math:`\mu_{\text{eff}} = \rho\nu + \rho\nu_{t}` ， :math:`p^{*} = \overline{p} + \frac{2}{3}\rho k` 。需要注意到上式中的压力 :math:`p^{*}` 包含湍动能 :math:`k` 的影响。

引入 **有效雷诺应力** 的概念，定义为

.. math::
	\begin{align}
	\mathbf{R}_{\text{eff}} = \nu_{\text{eff}}\Big[ \nabla\overline{\mathbf{U}} + (\nabla\overline{\mathbf{U}})^{T} - \frac{2}{3}(\nabla\cdot\overline{\mathbf{U}})\mathbf{I} \Big]
	\end{align}

其中 :math:`\nu_{\text{eff}}=\mu_{\text{eff}}/\rho = \nu + \nu_{t}`  。于是雷诺时均动量方程可以整理为

.. math::
	\begin{align}
	\frac{\partial (\rho\overline{\mathbf{U}})}{\partial t}
	+ \nabla \cdot \rho(\overline{\mathbf{U}} \otimes \overline{\mathbf{U}})
	= -\nabla \Big(p + \frac{2}{3}\rho k\Big)
	+ \nabla \cdot (\rho \mathbf{R}_{\text{eff}})
	+ \rho\overline{\mathbf{f}}
	\end{align}


类似于雷诺应力，其他变量 :math:`\phi` 的湍流脉动值附加项可以引入相应的湍流扩散系数，均用 :math:`\Gamma_{t}` 表示，则湍流脉动所传递的通量可以通过下列关系式与时均参数联系起来：

.. math::
	\begin{align}
	-\rho \overline{\mathbf{U}'\phi'} = \Gamma_{t}\nabla \phi'
	,\quad 
	\sigma = \frac{\mu_{t}}{\Gamma_{t}}
	\end{align}

而 :math:`\sigma` 常常可以近似为一个常数，称为湍流Prandtl数(当 :math:`\phi` 为温度时)或Schmidt数(当 :math:`\phi` 为质交换方程的组分时)。

涡粘模型一般通过求解额外的偏微分方程得到 :math:`\nu_{t}` ，并根据需要求解的方程数量将涡粘模型分为：零方程模型、一方程模型、两方程模型等。工业界常用的涡粘模型有一方程Spalart-Allmaras模型，两方程 :math:`k-\varepsilon` 及 :math:`k-\omega` 模型等。涡粘模型基于湍流各项同性假设，对于各向异性的复杂流动（如大曲率流动、强旋流、冲击流等）效果不佳。这时可采用雷诺应力模型（Reynolds Stress Model, RSM）在更高阶的应力上封闭RANS方程。



Spalart Allmaras 模型
^^^^^^^^^^^^^^^^^^^^^^^

参考 `Spalart Allmaras 模型 <https://marinecfd.xyz/post/spalart-allmaras/>`_ 。

Spalart-Allmaras （SA）湍流模型由 Spalart 和 Allmaras 提出，原始文献为 `A one-equation turbulence model for aerodynamic flows <https://arc.aiaa.org/doi/abs/10.2514/6.1992-439>`_ 。这是一个一方程模型，设计初衷是用于航空领域的壁面流。有如下特点：

- 只需求解一个输运方程，相比其他湍流模型计算速度快。
- 对逆压梯度问题结果较好。
- 无法准确模拟自由剪切流，如射流。
- 无法准确模拟均匀衰减、各项同性湍流。
  
SA 模型基于线性涡粘假设，湍流粘度按以下公式计算：

.. math::
	\begin{align}
	\nu_{t} = \tilde{\nu} f_{v1}
	\end{align}

其中 :math:`f_{v1}` 是一个关于湍流粘度比 :math:`\chi` 的函数，定义为

.. math::
	\begin{align}
	f_{v1} = \frac{\chi^{3}}{\chi^{3} + C_{v1}^{3}}
	\end{align}

湍流粘度比定义为

.. math::
	\begin{align}
	\chi = \tilde{\nu}/\nu
	\end{align}

而 :math:`\tilde{\nu}` 是需要通过输运方程求解的量，在原始文献中，关于 :math:`\tilde{\nu}` 的输运方程表示为

.. math::
	\begin{align}
	\frac{\partial \tilde{\nu}}{\partial t} = M(\tilde{\nu}) + P(\tilde{\nu}) + D(\tilde{\nu}) + T
	\end{align}

其中 :math:`P(\tilde{\nu})` 表示production：

.. math::
	\begin{align}
	P(\tilde{\nu}) = C_{b1}(1 - f_{t2})\tilde{S}\tilde{\nu}
	\end{align}

:math:`D(\tilde{\nu})` 表示wall destruction：

.. math::
	\begin{align}
	D(\tilde{\nu}) = \Big( C_{w1}f_{w} - \frac{C_{b1}}{\kappa^{2}}f_{t2}\Big)\Big(\frac{\tilde{\nu}}{d}\Big)^{2}
	\end{align}

:math:`T` 表示trip function：

.. math::
	\begin{align}
	T = f_{t1}\Delta \mathbf{U}^{2}
	\end{align}

因此，完整的关于 :math:`\tilde{\nu}` 的输运方程为

.. math::
	\begin{align}
	\frac{\partial \tilde{\nu}}{\partial t}
	+ \nabla\cdot(\tilde{\nu}\mathbf{U})
	= \frac{1}{\sigma}\Big[ \nabla \cdot \Big((\nu + \tilde{\nu})\nabla\tilde{\nu}\Big) + C_{b2}(\nabla\tilde{\nu})^{2} \Big]
	+ C_{b1}(1 - f_{t2})\tilde{S}\tilde{\nu}
	- \Big(C_{w1}f_{w} - \frac{C_{b1}}{\kappa^{2}}f_{t2} \Big)\Big(\frac{\tilde{\nu}}{d}\Big)^{2}
	+ f_{t1}\Delta \mathbf{U}^{2}
	\end{align}

在原始文献中， :math:`\tilde{S}` 的定义为

.. math::
	\begin{align}
	\tilde{S} := S + \frac{\tilde{\nu}}{\kappa^{2}d^{2}}f_{v2}
	\end{align}

其中 :math:`S` 的定义为

.. math::
	\begin{align}
	S = \sqrt{2}|\mathbf{S}|
	,\quad 
	\mathbf{S} = \frac{1}{2}\Big( \nabla\mathbf{U} + (\nabla\mathbf{U})^{T} \Big)  
	\end{align}

计算 :math:`\tilde{S}` 时用到的 :math:`f_{v2}` 定义为

.. math::
	\begin{align}
	f_{v2} = 1 - \frac{\chi}{1 + \chi f_{v1}} 
	\end{align}

wall destruction term中的 :math:`f_{w}` 定义为

.. math::
	\begin{align}
	f_{w} = g\Big( \frac{1 + C_{w3}^{6}}{g^{6} + C_{w3}^{6}} \Big)^{1/6}
	,\quad 
	g = r + C_{w2}(r^{6} - r)
	,\quad 
	r = \min\Big( \frac{\tilde{\nu}}{\tilde{S}\kappa^{2}d^{2}},10 \Big)
	\end{align}

各系数的默认值如下：

+----------------+----------------+----------------+----------------+-----------------------------------------------------------+----------------+----------------+----------------+---------------+
| :math:`\sigma` | :math:`\kappa` | :math:`C_{b1}` | :math:`C_{b2}` | :math:`C_{w1}`                                            | :math:`C_{w2}` | :math:`C_{w3}` | :math:`C_{v1}` | :math:`C_{s}` |
+================+================+================+================+===========================================================+================+================+================+===============+
| 0.66666        | 0.41           | 0.1355         | 0.622          | :math:`\frac{C_{b1}}{\kappa^{2}}+\frac{1+C_{b2}}{\sigma}` | 0.3            | 2.0            | 7.1            | 0.3           |
+----------------+----------------+----------------+----------------+-----------------------------------------------------------+----------------+----------------+----------------+---------------+


k-epsilon模型
^^^^^^^^^^^^^^

:math:`k-\epsilon` 模型有多个不同版本，对于不同版本的模型， :math:`k` 和 :math:`\varepsilon` 的输运方程都可以写成下面的通用形式：

.. math::
	\begin{align}
	& \frac{\mathrm{D}(\rho k)}{\mathrm{D}t}
	= P_{k} - \Phi_{k} + D_{k}^{\mu} + D_{k}^{T} \\
	& \frac{\mathrm{D}(\rho \varepsilon)}{\mathrm{D}t}
	= P_{\varepsilon} - \Phi_{\varepsilon } + D_{\varepsilon}^{\mu} + D_{\varepsilon}^{T} 
	\end{align}

其中 :math:`P` 是产生项(Production term)， :math:`\Phi` 是湮灭项(Destruction term)， :math:`D^{\mu}` 是粘性耗散项(Viscous dissipation term)， :math:`D^{T}` 是湍流耗散项(Turbulent dissipation term)。

标准 :math:`k-\epsilon` 模型是最常用的一种形式，原始文献出自Jones和Launder的 `The prediction of laminarization with a two-equation model of turbulence <https://www.researchgate.net/publication/223669472_The_prediction_of_laminarization_with_a_two-equation_model_of_turbulence>`_ 。该模型基于Boussinesq假设，用下面的形式估计湍流粘度与热扩散系数：

.. math::
	\begin{align}
	\mu_{t} = \rho C_{\mu}\frac{k^{2}}{\varepsilon}
	,\quad 
	\alpha = \frac{c_{p}\mu_{t}}{Pr_{t}}  
	\end{align}

其中 :math:`\varepsilon` 是粘性应力引起的单位质量的湍流动能耗散率，定义为

.. math::
	\begin{align}
	\varepsilon = \frac{1}{2}\frac{\mu}{\rho}\overline{[\nabla\mathbf{U}' + (\nabla\mathbf{U}')^{T}] : [\nabla\mathbf{U}' + (\nabla\mathbf{U}')^{T}]}
	= 2\nu \overline{\mathbf{S}' : \mathbf{S}'}
	\end{align}

湍流能量的产生项定义为

.. math::
	\begin{align}
	P_{k} = \rho\mathbf{R} : \nabla\mathbf{U}
	= \rho\nu_{t}\Big( \nabla\mathbf{U} + (\nabla\mathbf{U})^{T} - \frac{2}{3}(\nabla\cdot\mathbf{U})\mathbf{I} \Big) : \nabla\mathbf{U}
	\end{align}



.. note:: 

	- 热扩散系数的原始定义式为 :math:`\alpha = \frac{\kappa}{\rho c_{p}}` ，其中 :math:`\kappa` 为热导率， :math:`c_{p}` 为定压比热容。
	- :math:`\mathbf{S}` 为应变张量（或变形率），定义为 :math:`\mathbf{S} = \frac{1}{2} \Big(\nabla\mathbf{U} + (\nabla\mathbf{U})^{T}\Big)` 。
	- 张量运算符 :math:`:` 表示两个张量按位相乘并各项累加，最终得到一个标量。
	  



在该模型中， :math:`k` 方程右端各项的定义如下所示：

.. math::
	\begin{align}
	& P_{k} = P \\
	& \Phi_{k} = \rho\varepsilon \\
	& D_{k}^{\mu} = \nabla \cdot (\mu \nabla k) \\
	& D_{k}^{T} = \nabla \cdot \Big( \frac{\mu_{t}}{\sigma_{k}} \nabla k \Big)
	\end{align}

:math:`\omega` 方程右端各项的定义如下所示：

.. math::
	\begin{align}
	& P_{\varepsilon } = C_{\varepsilon 1}\frac{\varepsilon}{k}P \\
	& \Phi_{\varepsilon } = C_{\varepsilon 2}\frac{\rho\varepsilon^{2}}{k} \\
	& D_{k}^{\mu} = \nabla \cdot (\mu \nabla \varepsilon ) \\
	& D_{k}^{T} = \nabla \cdot \Big( \frac{\mu_{t}}{\sigma_{\varepsilon}}\nabla \varepsilon  \Big)
	\end{align}

将以上各项代入到湍流输运方程当中，整理后得到标准 :math:`k-\epsilon` 模型的输运方程：

.. math::
	\begin{align}
	\frac{\partial (\rho k)}{\partial t}
	+ \nabla \cdot(\rho \mathbf{U}k)
	= P - \rho\varepsilon 
	+ \nabla \cdot \Big[ (\mu + \frac{\mu_{t}}{\sigma_{k}})\nabla k \Big]
	\end{align}

.. math::
	\begin{align}
	\frac{\partial (\rho \varepsilon)}{\partial t}
	+ \nabla \cdot (\rho\mathbf{U}\varepsilon )
	= C_{\varepsilon 1} \frac{\varepsilon }{k}P
	- C_{\varepsilon 2} \frac{\rho\varepsilon^{2}}{k}
	+ \nabla \cdot \Big[ (\mu + \frac{\mu_{t}}{\sigma_{\varepsilon}})\nabla \varepsilon \Big] 
	\end{align}

标准 :math:`k-\varepsilon` 的模型常数如下：

+-----------------+---------------------------+---------------------------+--------------------+------------------------------+----------------+
| :math:`C_{\mu}` | :math:`C_{\varepsilon 1}` | :math:`C_{\varepsilon 2}` | :math:`\sigma_{k}` | :math:`\sigma_{\varepsilon}` | :math:`Pr_{t}` |
+=================+===========================+===========================+====================+==============================+================+
| 0.09            | 1.44                      | 1.92                      | 1.0                | 1.3                          | 0.9            |
+-----------------+---------------------------+---------------------------+--------------------+------------------------------+----------------+


.. attention:: 

	- k-epsilon模型最大的缺点是对于存在逆压梯度的流动预测不够准确。这主要是由于k-epsilon模型大部分情况下都会低估湍流动能耗散率，也就是预测的湍流尺度过高。
	- k-epsilon模型为一种高雷诺数模型，仅仅适用于高雷诺数流动。如果要应用于低雷诺数流动的情况，需要在壁面附加低雷诺数修增模型。
	- k-epsilon模型中的 :math:`C_{\mu}` 为常数，有文献认为使用一个变量来模化它能获得更好的结果。







k-omega模型
^^^^^^^^^^^^^^

:math:`\varepsilon` 方程可以变换到 :math:`\omega` 方程。Kolmogorov认为 :math:`\omega` 是单位体积、单位时间下的能量耗散，而Wilcox简单地认为其与 :math:`\varepsilon` 和 :math:`k` 的比值正相关，定义为

.. math::
	\begin{align}
	\omega := \frac{1}{C_{\mu}}\frac{\varepsilon }{k}
	\end{align}

其中 :math:`C_{\mu}=0.09` ，和 :math:`k-\omega` 模型中的常数 :math:`\beta^{*}` 意义相同。

对 :math:`\rho \omega` 取全微分，根据链式求导法则，有

.. math::
	\begin{align}
	\frac{\mathrm{D}(\rho\omega)}{\mathrm{D}t}
	&= \frac{1}{C_{\mu}}\frac{\mathrm{D}(\rho\varepsilon /k)}{\mathrm{D} t}
	= \frac{1}{C_{\mu}}\Big( \frac{1}{k}\frac{\mathrm{D}(\rho\varepsilon )}{\mathrm{D}t} - \frac{\varepsilon }{k^{2}}\frac{\mathrm{D}(\rho k) }{\mathrm{D} t} \Big)
	= \frac{1}{C_{\mu}k}\frac{\mathrm{D} (\rho\varepsilon )}{\mathrm{D} t} - \frac{\omega}{k}\frac{\mathrm{D} (\rho k)}{\mathrm{D} t} \\
	&= \Big( \frac{1}{C_{\mu}k}P_{\varepsilon } - \frac{\omega}{k}P_{k} \Big)
	- \Big( \frac{1}{C_{\mu}k}\Phi_{\varepsilon } - \frac{\omega}{k}\Phi_{k} \Big)
	+ \Big( \frac{1}{C_{\mu}k}D_{\varepsilon }^{\mu} - \frac{\omega}{k}D_{\varepsilon }^{\mu} \Big)
	+ \Big( \frac{1}{C_{\mu}k}D_{\varepsilon }^{T} - \frac{\omega}{k}D_{\varepsilon }^{T} \Big)
	\end{align}

下面分别对右端各项进行整理，分别给出产生项、湮灭项、粘性耗散项和湍流耗散项的表达式：

.. math::
	\begin{align}
	P_{\omega} = \frac{1}{C_{\mu}k}\Big( C_{1\varepsilon}\frac{\varepsilon}{k}P \Big) - \frac{\omega}{k}P
	= (C_{1\varepsilon } - 1)\frac{\omega}{k}P  
	\end{align}

.. math::
	\begin{align}
	\Phi_{\omega} = \frac{1}{C_{\mu}k}\Big( C_{2\varepsilon}\frac{\rho \varepsilon^{2}}{k} \Big) - \frac{\omega}{k}\rho\varepsilon = (C_{2\varepsilon}-1)C_{\mu}\rho\omega^{2} 
	\end{align}

.. math::
	\begin{align}
	D_{\omega}^{\mu} &= \frac{1}{C_{\mu}k}\nabla \cdot (\mu \nabla\varepsilon )
	- \frac{\omega}{k}\nabla \cdot (\mu \nabla k) \\
	&= \frac{1}{C_{\mu}k}\nabla \cdot \Big( \mu \nabla (C_{\mu}\omega k) \Big)
	- \frac{\omega}{k}\nabla \cdot (\mu \nabla k) \\
	&= \frac{1}{k} \nabla \cdot \Big( \mu \nabla (\omega k) \Big)
	- \frac{\omega}{k}\nabla \cdot (\mu \nabla k) \\
	&= \frac{\mu}{k}\nabla \cdot (k\nabla\omega + \omega \nabla k)
	- \frac{\mu\omega}{k}\nabla^{2}k \\
	&= \frac{\mu}{k}(2\nabla k \cdot \nabla \omega + k\nabla^{2}\omega + \omega \nabla^{2}k)
	- \frac{\mu\omega}{k}\nabla^{2}k \\
	&= \frac{2\mu}{k}(\nabla k \cdot \nabla \omega) + \mu \nabla^{2}\omega 
	\end{align}

.. math::
	\begin{align}
	D_{\omega}^{T} &= \frac{1}{C_{\mu}k}\nabla \cdot \Big( \frac{\mu_{t}}{\sigma_{\varepsilon}}\nabla\varepsilon  \Big)
	- \frac{\omega}{k}\nabla \cdot \Big( \frac{\mu_{t}}{\sigma_{k}}\nabla k \Big) \\
	&= \frac{1}{C_{\mu}k}\nabla \cdot \Big( \frac{\mu_{t}}{\sigma_{\varepsilon}}\nabla(C_{\mu}\omega k) \Big)
	- \frac{\omega}{k}\nabla \cdot \Big( \frac{\mu_{t}}{\sigma_{k}}\nabla k \Big) \\
	&= \frac{1}{\sigma_{\varepsilon}k}\nabla \cdot \Big( \mu_{t} \nabla (\omega k) \Big)
	- \frac{\omega}{\sigma_{k}k}\nabla \cdot \Big( \mu_{t}\nabla k \Big) \\
	&= \frac{1}{\sigma_{\varepsilon}k}\nabla \cdot \Big( \mu_{t} (k\nabla \omega + \omega \nabla k) \Big)
	- \frac{\omega}{\sigma_{k}k}\nabla \cdot \Big( \mu_{t}\nabla k \Big) \\
	&= \frac{1}{\sigma_{\varepsilon}k}\Big( 2\mu_{t}\nabla k\cdot\nabla \omega + \mu_{t}k\nabla^{2}\omega + \mu_{t}\omega\nabla^{2}k \Big)
	- \frac{\omega}{\sigma_{k}k}\nabla \cdot \Big( \mu_{t}\nabla k \Big) \\
	&= \frac{2\mu_{t}}{\sigma_{\varepsilon }k}(\nabla k \cdot \nabla \omega)
	+ \frac{1}{\sigma_{\varepsilon}}\nabla \cdot (\mu_{t}\nabla\omega)
	+ \Big( \frac{1}{\sigma_{\varepsilon }}- \frac{1}{\sigma_{k}}\Big) \frac{\omega }{k} \nabla \cdot (\mu_{t}\nabla k)
	\end{align}

将上面各项代入方程中即可得到完整形式的 :math:`\omega` 方程：

.. math::
	\begin{align}
	\frac{\partial (\rho\omega)}{\partial t}
	+ \nabla \cdot (\rho\mathbf{U}\omega)
	= (C_{1\varepsilon } - 1)\frac{\omega}{k}P 
	- (C_{2\varepsilon}-1)C_{\mu}\rho\omega^{2} 
	+ \frac{2\mu}{k}(\nabla k \cdot \nabla \omega)
	+ \mu \nabla^{2}\omega
	+ \frac{2\mu_{t}}{\sigma_{\varepsilon }k}(\nabla k \cdot \nabla \omega)
	+ \frac{1}{\sigma_{\varepsilon}}\nabla \cdot (\mu_{t}\nabla\omega)
	+ \Big( \frac{1}{\sigma_{\varepsilon }}- \frac{1}{\sigma_{k}}\Big) \frac{\omega }{k} \nabla \cdot (\mu_{t}\nabla k)
	\end{align}


文献 `Two-equation eddy-viscosity turbulence models for engineering applications <https://arc.aiaa.org/doi/abs/10.2514/3.12149>`_ 中提到了变换后的 :math:`\omega` 方程忽略了两项耗散项，分别是 :math:`\frac{2\mu}{k}(\nabla k \cdot \nabla \omega)` 和 :math:`\Big( \frac{1}{\sigma_{\varepsilon }}- \frac{1}{\sigma_{k}}\Big) \frac{\omega }{k} \nabla \cdot (\mu_{t}\nabla k)` 。

同时注意到 :math:`\mu_{t}` 与 :math:`k,\omega` 之间存在如下关系：

.. math::
	\begin{align}
	\mu_{t} = \frac{\rho k}{\omega} 
	\end{align}

因此方程中的交叉耗散项(Cross-diffusion term)可以进一步改写成

.. math::
	\begin{align}
	\frac{2\mu_{t}}{\sigma_{\varepsilon }k}(\nabla k \cdot \nabla \omega)
	= \frac{2\rho}{\sigma_{\varepsilon }}\frac{1}{\omega}(\nabla k \cdot \nabla \omega)
	\end{align}

同时再整合一下 :math:`\mu \nabla^{2}\omega + \frac{1}{\sigma_{\varepsilon}}\nabla \cdot (\mu_{t}\nabla\omega) = \nabla \cdot \Big[ \Big( \mu + \frac{\mu_{t}}{\sigma_{\varepsilon }} \Big)\nabla \omega \Big]` ，从而化简得到文献中的形式：

.. math::
	\begin{align}
	\frac{\partial (\rho\omega)}{\partial t}
	+ \nabla \cdot (\rho\mathbf{U}\omega)
	= (C_{1\varepsilon } - 1)\frac{\omega}{k}P
	- (C_{2\varepsilon}-1)C_{\mu}\rho\omega^{2}
	+ \nabla \cdot \Big[ \Big( \mu + \frac{\mu_{t}}{\sigma_{\varepsilon }}\Big)\nabla \omega \Big]
	+ \frac{2\rho}{\sigma_{\varepsilon }}\frac{1}{\omega}(\nabla k \cdot \nabla \omega)
	\end{align}

文献 `Reassessment of the scale-determining equation for advanced turbulence models <https://arc.aiaa.org/doi/abs/10.2514/3.10041>`_ 给出的Wilcox模型在 :math:`\omega` 方程中忽略了交叉耗散项，其 :math:`k` 和 :math:`\omega` 方程如下：

.. math::
	\begin{align}
	\frac{\partial (\rho k)}{\partial t}
	+ \nabla \cdot (\rho\mathbf{U}k)
	= P - \beta^{*}\rho \omega k
	+ \nabla \cdot \Big[ (\mu + \sigma^{*}\mu_{t})\nabla\omega \Big]
	\end{align}

.. math::
	\begin{align}
	\frac{\partial (\rho\omega)}{\partial t}
	+ \nabla \cdot (\rho\mathbf{U}\omega)
	= \gamma\frac{\omega}{k}P - \beta \rho\omega^{2}
	+ \nabla \cdot \Big[ (\mu + \sigma \mu_{t})\nabla\omega \Big]  
	\end{align}

其中的模型常数如下：

+---------------+-------------------+----------------+--------------------+----------------+--------------------+
| :math:`\beta` | :math:`\beta^{*}` | :math:`\gamma` | :math:`\gamma^{*}` | :math:`\sigma` | :math:`\sigma^{*}` |
+===============+===================+================+====================+================+====================+
| 3/40          | 9/100             | 5/9            | 1                  | 1/2            | 1/2                |
+---------------+-------------------+----------------+--------------------+----------------+--------------------+


.. attention:: 

	- k-omega模型相对于k-epsilon模型更适用于附加逆压梯度的壁面流动以及旋转机械。
	- k-omega模型本质是一个普适性模型，可以用来处理低雷诺数以及高雷诺数。在处理低雷诺数时，只要壁面网格足够细致，就不需要附加阻尼函数或低雷诺数壁面函数。
	- k-omega模型在壁面附近处，即使是低雷诺数流动，通常预测的 :math:`\omega` 也会趋向于无穷大。
	- k-omega模型对自由来流的边界条件比较敏感。






混合函数
^^^^^^^^^^^

为了实现标准 :math:`k-\varepsilon` 和 :math:`k-\omega` 模型的结合，需要设计混合函数。该混合函数需要实现如下效果：在近壁面处使用对逆压梯度效果较好的 :math:`k-\omega` 模型，在其他地方使用对来流参数不敏感的 :math:`k-\varepsilon` 模型。混合函数记为 :math:`F_{1}` ，其取值在 0-1 之间，在近壁面处的边界层内 :math:`F_{1}` 应该趋于1，在边界层外和远离壁面的区域内 :math:`F_{1}` 应该趋于0。

Menter采用正切函数来定义混合函数：

.. math::
	\begin{align}
	F_{1} = \tanh (\arg_{1}^{4})
	\end{align}

其中 :math:`\arg_{1}` 定义为

.. math::
	\begin{align}
	\arg_{1} = \min\Big( \max\big( \frac{\sqrt{k}}{C_{\mu}\omega y} ,\frac{500\nu}{y^{2}\omega} \big), \frac{4\rho\sigma_{\omega2}k}{CD_{k\omega}y^{2}}  \Big)
	\end{align}

在上式中，第一项为湍流长度尺度 :math:`L_{t}=\sqrt{k}/(C_{\mu}\omega)` 与壁面距离 :math:`y` 之比。在对数区内 :math:`L_{t}/y = 2.5` ；从对数区到在边界层边缘，该值逐渐变为0。第二项是限制项，确保 :math:`F_{1}` 在粘性底层不会变为0。第三项也是限制项，可以消除原始 :math:`k-\omega` 模型中 :math:`\omega` 方程对入流参数选取敏感的问题。

:math:`CD_{k\omega}` 为交叉耗散项，定义为

.. math::
	\begin{align}
	CD_{k\omega} = \max\Big( 2\rho \frac{1}{\sigma_{\varepsilon}}\frac{1}{\omega}(\nabla k \cdot \nabla\omega) , 10^{-20}\Big)
	\end{align}


k-omegaBSL模型
^^^^^^^^^^^^^^^^^^

BSL模型利用混合函数 :math:`F_{1}` 将 :math:`k-\omega` 模型和 :math:`k-\varepsilon` 模型变换后的输运方程混合，混合后的输运方程可以写为如下形式：

.. math::
	\begin{align}
	\frac{\partial (\rho k)}{\partial t}
	+ \nabla \cdot (\rho\mathbf{U}k)
	= P - \beta^{*}\rho\omega k
	+ \nabla \cdot \Big[ \Big( \mu + \big(F_{1}\sigma^{*} + (1-F_{1})\frac{1}{\sigma_{k}}\big)\mu_{t} \Big)\nabla k \Big] 
	\end{align}

.. math::
	\begin{align}
	\frac{\partial (\rho\omega)}{\partial t}
	+ \nabla\cdot(\rho\mathbf{U}\omega)
	= \Big( F_{1}\gamma + (1-F_{1})C_{1\varepsilon}\Big)\frac{\omega}{k}P
	- \Big( F_{1}\beta + (1-F_{1})C_{2\varepsilon} \Big)\rho\omega^{2}
	+ \nabla \cdot \Big[ \Big( \mu + \big( F_{1}\sigma + (1-F_{1})\frac{1}{\sigma_{\varepsilon}} \big)\mu_{t} \Big)\nabla \omega \Big]
	+ 2\rho\frac{1}{\sigma_{\varepsilon}}\frac{1}{\omega}(\nabla k\cdot \nabla \omega)
	\end{align}

.. note:: 其中湍流粘度采用的定义为 :math:`\mu_{t} = \rho k/\omega` 。


k-omegaSST模型
^^^^^^^^^^^^^^^^

SST模型改善了逆压梯度的预测能力。它大部分与BSL模型相同，除了部分模型常数和 :math:`\mu_{t}` 的定义。

在SST模型中， :math:`\sigma^{*}` 从原本的 :math:`0.5` 修改为了 :math:`0.85` ，其余模型常数保持不变。同时，SST模型重新定义了 :math:`\mu_{t}` ，采用的表达式为

.. math::
	\begin{align}
	\mu_{t} = \frac{\alpha_{1}\rho k}{\max(\alpha_{1} \omega , \Omega F_{2})} 
	\end{align}

其中 :math:`\alpha_{1} = 0.31` 是模型常数， :math:`\Omega` 是涡量大小， :math:`F_{2}` 是第二个混合函数，也采用正切函数形式：

.. math::
	\begin{align}
	F_{2} = \tanh(\arg_{2}^{2})
	\end{align}

其中的 :math:`\arg_{2}` 采用与 :math:`\arg_{1}` 类似的形式：

.. math::
	\begin{align}
	\arg_{2} = \max\Big(\frac{2\sqrt{k}}{0.09\omega y}, \frac{500\nu}{y^{2}\omega} \Big)
	\end{align}


.. note:: 原始文献中提到，由于 :math:`\mu_{t}` 被重新定义了，因此 :math:`\omega` 方程里的产生项中的 :math:`\omega/k` 不能写作 :math:`1/\mu_{t}` 。

.. attention:: 但是在推导交叉耗散项时仍然采用了 :math:`\mu_{t}` 的原始定义，不过可能这一项的影响不大，Menter没有提到这一点，仍然存在疑问。

Menter在 `Ten Years of Industrial Experience with the SST Turbulence Model <https://www.scirp.org/(S(lz5mqp453edsnp55rrgjct55))/reference/ReferencesPapers.aspx?ReferenceID=1305676>`_ 中对SST模型进行了修补改进，提出了SST2003模型，具体的修改如下：

:math:`CD_{k\omega}` 中限制器的值由 :math:`10^{-20}` 变为 :math:`10^{-10}` ，即

.. math::
	\begin{align}
	CD_{k\omega} = \max\Big( 2\rho\frac{1}{\sigma_{\varepsilon}}\frac{1}{\omega}(\nabla k \cdot \nabla \omega), 10^{-10}   \Big)
	\end{align}

:math:`k` 方程的产生项增加限制器，即

.. math::
	\begin{align}
	\tilde{P} = \min(P, 10\beta^{*}\rho k\omega)
	\end{align}

:math:`\mu_{t}` 中的涡量 :math:`\Omega` 改为速度应变率的不变测度 :math:`S` ，即

.. math::
	\begin{align}
	\mu_{t} = \frac{\alpha_{1}\rho k}{\max(\alpha_{1}\omega, SF_{2})} 
	\end{align}






湍流核心与粘性底层
-------------------

以圆管湍流为例。由于湍流运动中流体质点的横向掺混，断面速度呈对数分布形式，与层流的抛物线分布对比，湍流过流断面上时均流速分布要均匀地多。实验表明圆管湍流过流断面上的流速分布大致可以分为三个区域：

- 紧贴管壁的一层流体粘附在壁面上（满足粘性流体壁面上无滑移条件），使得紧靠壁面很薄的流层内，速度由零很快增至一定值，速度梯度很大，因而粘性切应力起主导作用，其流态基本上属于层流。同时，由于壁面限制了质点横向掺混，脉动速度和附加切应力趋于消失。所以，紧靠壁面存在一个粘性切应力起主导作用的薄层，称为 **粘性底层** 。
- 由于湍流脉动、质点相互掺混，产生动量交换的结果，使得离边壁不远处到管中心的绝大部分区域时均流速分布比较均匀，流体处于湍流运动状态，湍流附加切应力起出道作用，这一区域称为 **湍流核心** 。
- 在湍流核心和粘性底层之间存在着范围很小的过渡层。因为其实际意义不大，可以不加考虑。
  
在粘性底层内，流速分布近似为直线，壁面切应力满足

.. math::
	\begin{align}
	\tau_{w} = \mu\frac{\mathrm{d}u}{\mathrm{d}y}\approx \mu\frac{u}{y}
	\end{align}

将 :math:`\mu=\rho\nu` 代入上式，整理得到

.. math::
	\begin{align}
	u = \frac{\tau_{w}}{\rho}\frac{y}{\nu}
	\end{align}

考虑到阻力速度 :math:`u_{w}=\sqrt{\frac{\tau_{w}}{\rho}}` ，则粘性底层的速度分布可以写成

.. math::
	\begin{align}
	\frac{u}{u_{w}} = \frac{u_{w}y}{\nu}
	\quad\Rightarrow\quad
	u^{+} = y^{+}
	\end{align}

.. note:: 其中 :math:`\frac{u}{u_{w}}` 也常记为 :math:`u^{+}` ； :math:`\frac{u_{w}y}{\nu}` 也常记为 :math:`y^{+}` 。注意到 :math:`y^{+}` 是某一雷诺数。

当 :math:`y<\delta_{0}` 时为层流，而当 :math:`y \to \delta_{0}` 时， :math:`y^{+}=\frac{u_{w}y}{\nu}` 等于某一数值的临界雷诺数。实验表明此数值为 :math:`y^{+}=\frac{v_{*}y}{\nu}=11.6` ，由此可以得到

.. math::
	\begin{align}
	\delta_{0} = 11.6\frac{\nu}{u_{w}}
	\end{align}

将之前推导的阻力速度的表达式 :math:`u_{w} = v\sqrt{\frac{\lambda }{8}}` 代入上式，即可得到 **粘性底层理论厚度的计算公式** ：

.. math::
	\begin{align}
	\delta_{0} = 11.6\frac{\nu}{v\sqrt{\frac{\lambda }{8}}} = \frac{32.8d}{\text{Re}\sqrt{\lambda } }  
	\end{align}

实际厚度要比理论厚度小一些。上式表明， :math:`\delta_{0}` 随 :math:`Re` 的增加而减小。




湍流沿程损失的分析与计算
---------------------------


尼古拉兹实验
^^^^^^^^^^^^^^^

计算湍流沿程损失，关键是如何确定沿程阻力系数 :math:`\lambda` 值。为了探索湍流沿程阻力系数的变化规律，验证和发展普朗特混合长度理论，尼古拉兹在人工均匀砂砾粗糙管道中进行了系统的沿程阻力系数和断面流速分布的测定工作，称之为尼古拉兹实验。

湍流的阻力是由粘性切应力和附加切应力形成的。壁面的每个粗糙点都将成为不断产生并向管流中输送旋涡而引起湍动的源泉，所以管壁粗糙也是影响 :math:`\lambda` 值的一个重要因素。也就是说，对于湍流来说，沿程阻力系数 :math:`\lambda` 值不仅与 :math:`\text{Re}` 有关，而且还与管壁粗糙度有关。壁面粗糙一般包括粗糙突起的高度、形状、疏密和排列等许多因素。为了便于分析粗糙的影响，尼古拉兹在实验中采用了一种简化的粗糙模型—— **人工粗糙** ，即用经过筛选的均匀砂粒，紧密地贴在管道的内部上，这样粗糙特性可以认为是一致的，相关衡量指标为：

+----------------------------------------+--------------------------------------------------------------------------+
| 符号                                   | 含义                                                                     |
+========================================+==========================================================================+
| :math:`k_{s}`                          | 用砂粒的突起高度（砂粒直径）表示壁面的粗糙，称为 **绝对粗糙度**          |
+----------------------------------------+--------------------------------------------------------------------------+
| :math:`k_{s}/d` 或 :math:`k_{s}/r_{0}` | 绝对粗糙度与管径或半径之比称为相对粗糙度，表示不同直径管道管壁粗糙的影响 |
+----------------------------------------+--------------------------------------------------------------------------+


从以上分析可以看出，雷诺数和相对粗糙度是沿程阻力系数的两个影响因素，即

.. math::
	\begin{align}
	\lambda = f(\text{Re}, k_{s}/d)
	\end{align}


尼古拉兹应用类似雷诺实验的装置，但是采用的是人工粗糙管进行实验，实验管道相对粗糙度的变化范围为 :math:`\frac{k_{s}}{d}=\frac{1}{30}\sim \frac{1}{1014}` ，对于每一根管道实测不同流量的断面平均流速 :math:`v` 和沿程水头损失 :math:`h_{f}` 计算出雷诺数和沿程阻力系数：

.. math::
	\begin{align}
	& \text{Re} = \frac{v d}{\nu} \\
	& \lambda = \frac{d}{l}\frac{2g}{v^{2}}h_{f}
	\end{align}

将其点绘制在对数坐标纸上，就得到了 :math:`\lambda = f(\text{Re}, k_{s}/d)` 曲线，即尼古拉兹实验曲线图。根据该曲线图，可以将沿程阻力分为5个阻力区：

+------------+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 沿程阻力区 | 沿程阻力系数关系                     | 备注                                                                                                                                                                                                                      |
+============+======================================+===========================================================================================================================================================================================================================+
| 层流区     | :math:`\lambda = f_{1}(Re) = 64/Re`  | 当 :math:`Re<2000` 时，不同相对粗糙管的实验点都落在同一根直线上                                                                                                                                                           |
+------------+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 临界区     | :math:`\lambda = f_{2}(Re)`          | 在 :math:`Re=2000\sim4000` 范围内，不同相对粗糙管的实验点都落在同一条曲线上。此层是层流向湍流的过渡区，范围很窄且实用意义不大。                                                                                           |
+------------+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 湍流光滑区 | :math:`\lambda = f_{3}(Re)`          | 在 :math:`Re>4000` 以后，不同相对粗糙管的实验点都落在同一条曲线上。但是随着 :math:`Re` 增大，相对粗糙度大的管道，实验点在 :math:`Re` 较低时便偏离了光滑区曲线；相对粗糙度小的管道，在 :math:`Re` 较大时才偏离光滑区曲线。 |
+------------+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 湍流过渡区 | :math:`\lambda = f_{4}(Re, k_{s}/d)` | 此时不同相对粗糙管的实验点分别落在不同的曲线上，形成一簇波状曲线。                                                                                                                                                        |
+------------+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 湍流粗糙区 | :math:`\lambda = f_{5}(k_{s}/d)`     | 不同相对粗糙管的实验点分别落在一些与横坐标平行的直线上。在这个阻力区，对于一定的管道，相对粗糙度是定值， :math:`\lambda` 是常数，可以得到沿程水头损失与流速平方成正比，因此该区也称为阻力平方区。                         |
+------------+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+



.. note:: 

	可以用粘性底层的厚度是否能掩盖粗糙突起的高度，来解释湍流为何分为三个阻力区并具有不同的 :math:`\lambda` 变化规律：

	- 在湍流光滑区，粘性底层的厚度 :math:`\delta` 显著地大于粗糙突起的高度，粗糙突起完全被掩盖在粘性底层内，对湍流核心的流动几乎没有影响，就好像在完全光滑的壁面上流动一样，因此 :math:`\lambda` 只与 :math:`Re` 而与相对粗糙度无关。
	- 在湍流过渡区，随着 :math:`Re` 增大，粘性底层的厚度变薄，接近粗糙突起的高度，粗糙影响到湍流核心区的流动，加大了核心区的湍动强度，增加了流动阻力和能量损失，这时 :math:`\lambda` 不仅与 :math:`Re` 有关并且与相对粗糙度有关。
	- 在湍流粗糙区，粘性底层更薄，粗糙突起几乎全部暴露在湍流核心之中，成为产生附加切应力的主要原因，而 :math:`Re` 的影响已经微不足道，所以此时 :math:`\lambda` 只与相对粗糙度有关而与 :math:`Re` 无关。
	  

.. attention:: 

	在实际问题中常常使用的是莫迪图而不是尼古拉兹实验图，也就意味着在实际问题中认为，在湍流光滑区和湍流过渡区中均认为 :math:`\lambda` 随 :math:`Re` 的增大而减小。





粘性底层的厚度为 :math:`\delta = 11.6\frac{\nu}{u_{w}}` ，将其两边同时除以绝对粗糙度 :math:`k_{s}` 得到

.. math::
	\begin{align}
	\frac{\delta}{k_{s}} = 11.6\frac{\nu}{u_{w}k_{s}} = 11.6\frac{1}{Re_{*}}
	\end{align}

其中 :math:`Re_{*}=\frac{u_{w}k_{s}}{\nu}` 称为 **粗糙雷诺数** ，可以作为人工粗糙管阻力分区的判别标准。根据尼古拉兹实验，人工粗糙管湍流三个阻力区的判别标准为：

- 湍流光滑区： :math:`Re_{*}\leq 5` 或 :math:`\frac{\delta}{k_{s}} \leq 0.4` 。
- 湍流过渡区： :math:`5 < Re_{*} \leq 70` 或 :math:`0.4 < \frac{\delta}{k_{s}} \leq 6` 。
- 湍流粗糙区： :math:`Re_{*} > 70` 或 :math:`\frac{\delta}{k_{s}} > 6` 。
  



人工粗糙管沿程阻力系数的半经验公式
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

在 **湍流光滑区** 中，流速分布分为粘性底层和湍流核心两部分。粘性底层的流速为线性分布，满足

.. math::
	\begin{align}
	u = \frac{\tau_{w}}{\mu}y \quad(y\leq \delta) 
	\end{align}

在湍流核心的流速分布为对数分布，满足

.. math::
	\begin{align}
	u = \frac{u_{w}}{\kappa}\ln y + C 
	\end{align}

由边界条件 :math:`y=\delta, u=u_{b}` 代入上式得到

.. math::
	\begin{align}
	C = u_{b} - \frac{u_{w}}{\kappa}\ln\delta
	\end{align}

根据 :math:`u_{b}=\frac{\tau_{0}}{\mu}\delta` 以及 :math:`u_{w}=\sqrt{\frac{\tau_{w}}{\rho}}` 可以得到

.. math::
	\begin{align}
	\delta = \frac{u_{b}\nu \rho}{\tau_{w}} = \frac{u_{b}}{u_{w}^{2}}\nu  
	\end{align}

将 :math:`C` 和 :math:`\delta` 代回湍流核心流速分布式，整理得到

.. math::
	\begin{align}
	\frac{u}{u_{w}}=\frac{1}{\kappa}\ln\frac{u_{w}y}{\nu} + \frac{u_{b}}{u_{w}} - \frac{1}{\kappa}\ln\frac{u_{b}}{u_{w}}
	\end{align}

令 :math:`C_{1}=\frac{u_{b}}{u_{w}} - \frac{1}{\kappa}\ln\frac{u_{b}}{u_{w}}` ，并根据尼古拉兹实验，取 :math:`\kappa=0.4` ， :math:`C_{1}=5.5` ，同时把自然对数换算成常用对数，即可得到 **湍流光滑区流速分布公式** ：

.. math::
	\begin{align}
	\frac{u}{u_{w}} = 5.75\lg\frac{u_{w}y}{\nu} + 5.5
	\quad\Rightarrow\quad
	u^{+} = 5.75\lg y^{+} + 5.5
	\end{align}


.. note:: 

	湍流光滑区的流速分布除了上述半经验公式之外，尼古拉兹根据实验结果还提出了一个更为简便的指数公式：

	.. math::
		\begin{align}
		\frac{u}{u_{\max}} = \Big(\frac{y}{r_{0}}\Big)^{n}
		\end{align}

	其中 :math:`u_{\max}` 为管轴处的最大流速， :math:`r_{0}` 为圆管半径， :math:`n` 为随雷诺数变化的指数。


由于粘性底层很薄，计算流量的时候可以忽略不计，于是

.. math::
	\begin{align}
	v = \frac{Q}{A} = \frac{\int_{A}u~\mathrm{d}A}{A} = \frac{\int_{0}^{r_{0}}u\cdot 2\pi r~\mathrm{d}r}{\pi r_{0}^{2}}
	\end{align}

其中 :math:`u` 以半经验公式代入，积分即可得到 **湍流光滑区的断面平均流速公式** ：

.. math::
	\begin{align}
	v = u_{w}5.75\lg\frac{u_{w}r_{0}}{\nu} + 1.75 
	\end{align}


以 :math:`u_{w}=v\sqrt{\frac{\lambda}{8}}` 代入上式，整理可以得到 :math:`\frac{1}{\sqrt{\lambda}} = 2.03\lg(Re\sqrt{\lambda }) - 0.9` 。根据尼古拉兹实验，将式中的常数分别修正为 :math:`2.0` 和 :math:`0.8` ，于是就得到 **尼古拉兹光滑管公式** ：

.. math::
	\begin{align}
	\frac{1}{\sqrt{\lambda}} = 2\lg(Re\sqrt{\lambda }) - 0.8
	\quad \text{or} \quad 
	\frac{1}{\sqrt{\lambda }} = 2\lg\frac{Re\sqrt{\lambda }}{2.51}  
	\end{align}



在 **湍流粗糙区** ，粘性底层厚度远小于壁面粗糙突起的高度，粘性底层已经没有实际意义，整个断面上流速分布都可以认为符合对数分布，即

.. math::
	\begin{align}
	u = \frac{u_{w}}{\kappa}\ln y + C 
	\end{align}

其中 :math:`C` 与管壁粗糙度有关，采用边界条件 :math:`y=k_{s}, u=u_{s}` 代入上式得到

.. math::
	\begin{align}
	C = \frac{u_{s}}{u_{w}} - \frac{1}{\kappa}\ln k_{s}  
	\end{align}

将 :math:`C` 代回流速分布式，整理得到

.. math::
	\begin{align}
	\frac{u}{u_{w}} = \frac{1}{\kappa}\ln\frac{y}{k_{s}} + \frac{u_{s}}{u_{w}} = \frac{1}{\kappa}\ln\frac{y}{k_{s}} + C_{2}
	\end{align}

其中 :math:`C_{2}=\frac{u_{s}}{u_{w}}` 。根据尼古拉兹实验，取 :math:`\kappa = 0.4, C_{2}=8.48` ，代入上式，并把自然对数换算成常用对数，便得到 **湍流粗糙区流速分布半经验公式** ：

.. math::
	\begin{align}
	\frac{u}{u_{w}} = 5.75\ln\frac{y}{k_{s}} + 8.48  
	\end{align}

将上式代入 :math:`v = \frac{Q}{A} = \frac{\int_{A}u~\mathrm{d}A}{A} = \frac{\int_{0}^{r_{0}}u\cdot 2\pi r~\mathrm{d}r}{\pi r_{0}^{2}}` ，积分可以得到 **湍流粗糙区断面平均流速公式** ：

.. math::
	\begin{align}
	\frac{v}{u_{w}} = 5.75\ln\frac{r_{0}}{k_{s}} + 4.75
	\end{align}

将 :math:`u_{w}=v\sqrt{\frac{\lambda}{8}}` 代入上式，整理得到 :math:`\frac{1}{\sqrt{\lambda }} = 2.03\lg\frac{r_{0}}{k_{s}} + 1.68` ，根据尼古拉兹实验，将式中常数分别修正为 :math:`2.0` 和 :math:`1.74` ，于是得到 **尼古拉兹粗糙管公式** ：

.. math::
	\begin{align}
	\frac{1}{\sqrt{\lambda }} = 2\lg\frac{r_{0}}{k_{s}} + 1.74
	\quad \text{or} \quad 
	\frac{1}{\sqrt{\lambda }} = 2\lg\frac{3.7d}{k_{s}}
	\end{align}



非圆管道的沿程损失计算
^^^^^^^^^^^^^^^^^^^^^^^^

对于非圆形断面的管道，圆管流动的沿程阻力计算公式、沿程阻力系数公式以及雷诺数仍然适用，但是要把公式里的直径 :math:`d` 换为当量直径 :math:`d_{e}` 。

由于水力半径是综合反映过流断面大小和几何形状对流动影响的物理量，如果非圆形管道的水力半径等于某圆管的水力半径，当其他条件相同时，可以认为这两个管道的沿程损失是相等的。因此，和非圆形管道水力半径相等的圆管直径称为该非圆形管道的 **当量直径** :math:`d_{e}` 。和圆形管道相类比，非圆形管道当量直径是水力半径的4倍，即

.. math::
	\begin{align}
	d_{e} = 4R = 4\frac{A}{\chi}
	\end{align}


.. attention:: 

	应用当量直径来计算非圆形管道的沿程损失并不适用于所有情况，主要表现为以下两个方面：

	1. 断面形状同圆管差异很大的非圆管，如长缝形（ :math:`b/a>8` ）、狭环形（ :math:`d_{2}<3d_{1}` ）、星形断面，应用当量直径计算存在较大误差。
	2. 由于层流的流速分布和湍流不一样，流动阻力和沿程损失不像湍流那样集中在管壁附近，所以在层流中应用当量直径进行计算也会造成较大误差。




旋涡识别方法
--------------

Q准则
^^^^^^^^

:math:`Q` 定义为速度梯度张量的第二不变量(second invariant of velocity gradient)，即

.. math::
	\begin{align}
	Q = \begin{vmatrix} \frac{\partial u_{y}}{\partial y} & \frac{\partial u_{y}}{\partial z} \\ \frac{\partial u_{z}}{\partial y} & \frac{\partial u_{z}}{\partial z} \end{vmatrix}
	+ \begin{vmatrix} \frac{\partial u_{x}}{\partial x} & \frac{\partial u_{x}}{\partial z} \\ \frac{\partial u_{z}}{\partial x} & \frac{\partial u_{z}}{\partial z} \end{vmatrix}
	+ \begin{vmatrix} \frac{\partial u_{x}}{\partial x} & \frac{\partial u_{x}}{\partial y} \\ \frac{\partial u_{y}}{\partial x} & \frac{\partial u_{y}}{\partial y} \end{vmatrix}
	= \frac{1}{2}\Big[ \big( \operatorname{tr}(\nabla\mathbf{U}) \big)^{2} - \operatorname{tr}\big( (\nabla\mathbf{U})^{2} \big)  \Big]
	\end{align}


.. note:: 

	对于不可压缩流体，上式可以进一步化简。根据连续性方程，有

	.. math::
		\begin{align}
		\operatorname{tr}(\nabla\mathbf{U}) = \nabla\cdot\mathbf{U} = 0 
		\end{align}

	这就使得定义式等号右边第一项成了零，所以

	.. math::
		\begin{align}
		Q= -\frac{1}{2}\operatorname{tr}\big( (\nabla\mathbf{U})^{2} \big)  
		\end{align}


将速度梯度张量分解成对称张量和反对称张量两个部分：

.. math::
	\begin{align}
	\nabla\mathbf{U}
	= \frac{1}{2}\Big( \nabla\mathbf{U} + (\nabla\mathbf{U})^{T} \Big)
	+ \frac{1}{2}\Big( \nabla\mathbf{U} - (\nabla\mathbf{U})^{T} \Big) 
	\end{align}

上式中的对称张量记为 :math:`\boldsymbol{S}` ，称为 **应变张量** (strain rate tensor)；反对称张量记为 :math:`\boldsymbol{\Omega}` ，称为 **旋转张量** ：

.. math::
	\begin{align}
	\boldsymbol{S} = \frac{1}{2}\Big( \nabla\mathbf{U} + (\nabla\mathbf{U})^{T} \Big)
	,\quad 
	\boldsymbol{\Omega} = \frac{1}{2}\Big( \nabla\mathbf{U} - (\nabla\mathbf{U})^{T} \Big)
	\end{align}

于是，对于不可压缩流体的情况， :math:`Q` 可以改写为

.. math::
	\begin{align}
	Q = -\frac{1}{2}\operatorname{tr}\big( (\nabla\mathbf{U})^{2} \big)
	= -\frac{1}{2}\operatorname{tr}(\boldsymbol{S}^{2} + 2\boldsymbol{S\Omega} + \boldsymbol{\Omega}^{2})
	= -\frac{1}{2}\Big[ \operatorname{tr}(\boldsymbol{S}^{2}) + \operatorname{tr}(\boldsymbol{S\Omega}) + \operatorname{tr}(\boldsymbol{\Omega}^{2}) \Big] 
	\end{align}


根据对称张量和反对称张量的性质，有 :math:`\boldsymbol{S}=\boldsymbol{S}^{T}` ， :math:`\boldsymbol{\Omega}=-\boldsymbol{\Omega}^{T}` ，所以

.. math::
	\begin{align}
	\operatorname{tr}(\boldsymbol{S}^{2}) = \operatorname{tr}(\boldsymbol{S}^{T}\boldsymbol{S})
	,\quad 
	\operatorname{tr}(\boldsymbol{\Omega}^{2}) = - \operatorname{tr}(\boldsymbol{\Omega}^{T}\boldsymbol{\Omega})   
	\end{align} 

同时注意到有

.. math::
	\begin{align}
	\operatorname{tr}(\boldsymbol{S\Omega})
	= \operatorname{tr}\Big( \frac{1}{2}\big( \nabla\mathbf{U} + (\nabla\mathbf{U})^{T} \big) \frac{1}{2}\big( \nabla\mathbf{U} - (\nabla\mathbf{U})^{T} \big) \Big)
	= \operatorname{tr}\Big( \frac{1}{4}\big( (\nabla\mathbf{U})^{2} - ((\nabla\mathbf{U})^{T})^{2} \big) \Big)
	= 0
	\end{align}

于是 :math:`Q` 最终可以写作

.. math::
	\begin{align}
	Q = -\frac{1}{2}\Big[ \operatorname{tr}(\boldsymbol{S}^{T}\boldsymbol{S}) - \operatorname{tr}(\boldsymbol{\Omega}^{T}\boldsymbol{\Omega}) \Big]
	= \frac{1}{2}\Big[ \| \boldsymbol{\Omega} \|_{F}^{2} - \| \boldsymbol{S} \|_{F}^{2} \Big] 
	\end{align}

其中 :math:`\| \cdot \|_{F}` 为F-范数(Frobenius norm)，定义为 :math:`\| \mathbf{A} \|_{F} = \sqrt{\operatorname{tr}(\mathbf{A}^{T}\mathbf{A})}` 。上式是文献中通常采用的形式。

:math:`Q > 0` 表示旋转程度大于变形程度，认为该区域存在旋涡。 



lambda2准则
^^^^^^^^^^^^

将速度梯度 :math:`\nabla \mathbf{U}` 分解成对称张量 :math:`\mathbf{S}` 和 :math:`\boldsymbol{\Omega}` 两部分：

.. math::
	\begin{align}
	\nabla\mathbf{U}
	= \frac{1}{2}\Big( \nabla\mathbf{U} + (\nabla\mathbf{U})^{T} \Big)
	+ \frac{1}{2}\Big( \nabla\mathbf{U} - (\nabla\mathbf{U})^{T} \Big)
	= \mathbf{S} + \boldsymbol{\Omega}
	\end{align}

定义张量 :math:`\mathbf{A}` 为

.. math::
	\begin{align}
	\mathbf{A} = \mathbf{S}^{2} + \boldsymbol{\Omega}^{2}
	\end{align}

:math:`\lambda_{2}` 指的就是 :math:`\mathbf{A}` 的第二个特征值，记为 :math:`\lambda_{2}(\mathbf{A})` 。满足 :math:`\lambda_{2}(\mathbf{A}) < 0` 的区域被识别为涡旋区域。


量纲分析和相似原理
=====================

量纲可以分为基本量纲和诱导量纲。 **基本量纲** 是相互独立的量纲，即一个基本量纲不能从其他基本量纲中推导出来，也就不依赖于其他基本量纲。对于力学问题，通常将长度量纲 :math:`L` 、质量量纲 :math:`M` 和时间量纲 :math:`T` 作为基本量纲。 **诱导量纲** 是由基本量纲推导出来的其他物理量的量纲，力学中任何一个物理量 :math:`x` 的量纲都可以用三个基本量纲的指数乘积形式表示，即 **量纲公式** ：

.. math::
	\begin{align}
	\mathrm{dim}x = L^{\alpha }T^{\beta}M^{\gamma}
	\end{align}


.. note:: 有量纲的量只能作简单的代数运算，只有无量纲化后才能进行超越函数的运算。




量纲分析法
-------------

瑞利法
^^^^^^^^^

瑞利法的基本原理是某一物理过程与 :math:`n` 个物理量有关，即

.. math::
	\begin{align}
	f(x_{1}.x_{2},\cdots,x_{n})=0
	\end{align}

其中某个物理量 :math:`x_{i}` 可以表示为其他物理量的指数乘积形式：

.. math::
	\begin{align}
	x_{i} = kx_{1}^{a}x_{2}^{b}\cdots x_{n-1}^{m}
	\end{align}

其量纲式为

.. math::
	\begin{align}
	\mathrm{dim}x_{i} = k \cdot \mathrm{dim}(x_{1}^{a}x_{2}^{b}\cdots x_{n-1}^{m})
	\end{align}

将上式中各物理量的量纲按照量纲公式表示为基本量纲的指数乘积形式，并根据量纲和谐原理确定出待定指数 :math:`a,b,\cdots,m` ，即可求得该物理过程的方程式，不过系数 :math:`k` 仍需要通过实验和分析加以确定。




π定理
^^^^^^^^

如果某一物理过程包含有 :math:`n` 个物理量，可以表示为如下函数关系：

.. math::
	\begin{align}
	f(x_{1}.x_{2},\cdots,x_{n})=0
	\end{align}

其中有 :math:`m` 个基本物理量，则该物理过程可以由 :math:`n` 个物理量构成的 :math:`(n-m)` 个无量纲组合量所表达的关系式来描述，即 :math:`\pi` 定理：

.. math::
	\begin{align}
	F(\pi_{1},\pi_{2},\cdots,\pi_{n-m})=0
	\end{align}

该定理的运用步骤如下：

1. 找出对物理过程有影响的 :math:`n` 个独立因素物理量，写成 :math:`f(x_{1}.x_{2},\cdots,x_{n})=0` 形式。
2. 从 :math:`n` 个物理量中选取 :math:`m` 个相互独立的基本物理量。对于不可压缩流体运动，一般取 :math:`m=3` 。设 :math:`x_{1},x_{2},x_{3}` 为所选的基本物理量，由量纲公式可得
   
.. math::
	\begin{align}
	& \mathrm{dim}x_{1} = L^{\alpha_{1}}T^{\beta_{1}}M^{\gamma_{1}} \\
	& \mathrm{dim}x_{2} = L^{\alpha_{2}}T^{\beta_{2}}M^{\gamma_{2}} \\
	& \mathrm{dim}x_{3} = L^{\alpha_{3}}T^{\beta_{3}}M^{\gamma_{3}}
	\end{align}

满足 :math:`x_{1},x_{2},x_{3}` 量纲独立的条件是量纲式中的指数行列式不等于零，即

.. math::
	\begin{align}
	\begin{vmatrix}
	 \alpha_{1} & \beta_{1} & \gamma_{1} \\
	 \alpha_{2} & \beta_{2} & \gamma_{2} \\
	 \alpha_{3} & \beta_{3} & \gamma_{3}
	\end{vmatrix}
	\ne 0
	\end{align}

3. 基本物理量依次与其余量组合成 :math:`n-m` 个无量纲 :math:`\pi` 项：
   
.. math::
	\begin{align}
	& \pi_{1} = \frac{x_{4}}{x_{1}^{a_{1}}x_{2}^{b_{1}}x_{3}^{c_{1}}} \\
	& \pi_{2} = \frac{x_{5}}{x_{1}^{a_{2}}x_{2}^{b_{2}}x_{3}^{c_{2}}} \\
	& \vdots \\
	& \pi_{n-3} = \frac{x}{x_{1}^{a_{n-3}}x_{2}^{b_{n-3}}x_{3}^{c_{n-3}}}
	\end{align}

4. 根据量纲和谐原理，求出各 :math:`\pi` 项的待定指数 :math:`a_{i},b_{i},c_{i}` 。
5. 写出描述该物理过程的关系式：
   
.. math::
	\begin{align}
	F(\pi_{1},\pi_{2},\cdots,\pi_{n-3})=0
	\end{align}



流动相似原理
---------------

模型试验就是根据相似原理，将需要进行试验的实际流动区域制作成相似的小比例尺的模型，根据模型试验的结果，推测原型可能发生的现象。

力学相似
^^^^^^^^^^^

流体力学相似包括四个方面：几何相似、运动相似、动力相似、初始条件和边界条件的相似。

**几何相似** 是指原型和模型两个流场的几何形状相似，即两个流场相应的线段长度成比例，相应的夹角相等。如果以 :math:`l` 表示某一线段的长度， :math:`\theta` 表示两条线段的夹角，以角标 :math:`p` 表示原型， :math:`m` 表示模型，则有

.. math::
	\begin{align}
	\lambda _{l} = \frac{l_{p}}{l_{m}}
	\qquad
	\theta_{p} = \theta_{m} 
	\end{align}

其中 :math:`\lambda_{l}` 为 **长度比尺** ，由此可以推得相应的面积比尺和体积比尺，即

.. math::
	\begin{align}
	\lambda_{A} = \frac{A_{p}}{A_{m}} = \frac{l_{p}^{2}}{l_{m}^{2}} = \lambda_{l}^{2} 
	\qquad 
	\lambda_{V} = \frac{V_{p}}{V_{m}} = \frac{l_{p}^{3}}{l_{m}^{3}} = \lambda_{l}^{3}
	\end{align}


.. note:: 

	- 严格来说，原型和模型表面粗糙度也应该具有相同的长度比尺，但在实际上往往只能近似做到这一点。
	- 几何相似是力学相似的前提，只有在几何相似的流动中才有可能存在相应的点，才有可能进一步探究对应点上其他物理量的相似问题。
	  

**运动相似** 是指两个流场相应点的速度方向相同，大小成比例，即

.. math::
	\begin{align}
	\lambda_{u} = \frac{u_{p}}{u_{m}} 
	\end{align}

其中 :math:`\lambda_{u}` 称为 **速度比尺** 。由于原型和模型各个相应点速度成比例，则相应断面的平均流速也必然具有同样比尺，即

.. math::
	\begin{align}
	\lambda_{v} = \frac{v_{p}}{v_{m}} = \frac{u_{p}}{u_{m}} = \lambda _{u}  
	\end{align}

将 :math:`v=l/t` 的关系代入上式可以得到

.. math::
	\begin{align}
	\lambda_{v} = \frac{l_{p}/t_{p}}{l_{m}/t_{m}} = \frac{l_{p}}{l_{m}}\frac{t_{m}}{t_{p}} = \frac{\lambda _{l}}{\lambda _{t}}  
	\end{align}

其中 :math:`\lambda_{t}=\frac{t_{p}}{t_{m}}` 为 **时间比尺** ，它表示模型和原型要实现相似所需要的时间之比。

速度相似就就意味着各相应点的加速度也是相似的，即

.. math::
	\begin{align}
	\lambda_{a} = \frac{a_{p}}{a_{m}} = \frac{\lambda_{l}}{\lambda_{t}^{2}} = \frac{\lambda_{v}}{\lambda_{t}} = \frac{\lambda_{v}^{2}}{\lambda_{l}}    
	\end{align}

其中 :math:`\lambda_{a}` 为 **加速度比尺** 。由此可见，只要速度相似，加速度也必然相似，反之亦然。


**动力相似** 是指两个流动各个相应点上，其质点所受到的各种作用力均维持一定的比例关系。根据达朗贝尔原理，对于任一运动的质点，设想加在该质点上的惯性力与质点所受到各种作用力相平衡，这些力构成一封闭的力多边形。从这个意义上说，动力相似表征为流体相应点上的力多边形相似，相应边（同名力）成比例。

一般影响流体运动的作用力主要有粘滞力、重力、压力，对于有些流动还需要考虑弹性力或表面张力。若分别用 :math:`T` 、 :math:`G` 、 :math:`P` 、 :math:`E` 、 :math:`S` 、 :math:`I` 代表粘滞力、重力、压力、弹性力、表面张力、惯性力，则有

.. math::
	\begin{align}
	\frac{T_{p}}{T_{m}} = \frac{G_{p}}{G_{m}} = \frac{P_{p}}{P_{m}} = \frac{E_{p}}{E_{m}} = \frac{S_{p}}{S_{m}} = \frac{I_{p}}{I_{p}}      
	\end{align}

也即

.. math::
	\begin{align}
	\lambda_{T} = \lambda_{G} = \lambda_{P} = \lambda_{E} = \lambda_{S} = \lambda_{I}
	\end{align}


**初始条件和边界条件的相似** 是保证两个流动相似的充分条件，正如初始条件和边界条件是微分方程的定解条件一样。对于非恒定流，初始条件是必需的；对于恒定流，初始条件则失去了实际意义。边界条件相似是指两个流动相应边界性质相同，如固体边界上的法线流速都为零；自由液面上液体压强均等于大气压强等。



相似准则
^^^^^^^^^^

两个流动要实现动力相似，作用在相应质点上的各种作用力的比尺就要满足一定的约束关系，这种约束关系称为 **相似准则** 。作用在流体质点上的力可以分为两类，一类是企图维持原有运动状态的力，如惯性力 :math:`I` ；另一类是企图改变其运动状态的力，如重力 :math:`G` 、粘滞力 :math:`T` 、动水压力 :math:`P` 等。流动的变化就是惯性力与其他各种作用力相互作用的结果。因此，各种力之间的比例关系应该以惯性力为一方来相互比较，在两个相似的流动中，这种比例关系应该保持不变。

惯性力满足 :math:`I=ma=\rho l^{3}a = \rho l^{2}v^{2}` ，则惯性力比尺为

.. math::
	\begin{align}
	\lambda_{l} = \frac{I_{p}}{I_{m}} = \lambda_{\rho}\lambda_{l}^{3}\lambda_{a} = \lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} 
	\end{align}

其中 :math:`\lambda_{\rho}` 为密度比尺。如果某一企图改变运动状态的力为 :math:`F` ，则两个流动相似时 :math:`F` 之比为 :math:`\lambda_{F}=\frac{F_{p}}{F_{m}}` 。根据动力相似有

.. math::
	\begin{align}
	\lambda _{I} = \lambda_{F}
	\quad \Rightarrow \quad
	\frac{\rho_{p}l_{p}^{2}v_{p}^{2}}{\rho_{m}l_{m}^{2}v_{m}^{2}} = \frac{F_{p}}{F_{m}}
	\quad \text{or} \quad 
	\frac{F_{p}}{\rho_{p}l_{p}^{2}v_{p}^{2}} = \frac{F_{m}}{\rho_{m}l_{m}^{2}v_{m}^{2}}      
	\end{align}

其中 :math:`\frac{F}{\rho l^{2}v^{2}}` 是一个无量纲数，称为 **牛顿数** ，以 :math:`Ne` 表示，则有

.. math::
	\begin{align}
	(Ne)_{p} = (Ne)_{m}
	\end{align}

上式表明两个流动相似时牛顿数应当相等，这称为 **牛顿相似准则** 。

但是，在模型试验中很难做到两个流动相应作用点上各种力都维持同样的比尺，不过在某一具体流动中起主导作用的力往往只有一种，因此在模型试验中只要让这种力满足相似即可。不同单项力相似将可以导出不同的动力相似准则。


雷诺准则
""""""""""""

当粘滞力作用为主时，由牛顿内摩擦定律可得

.. math::
	\begin{align}
	& F = T = \mu A\frac{\mathrm{d} u}{\mathrm{d} y} , \\
	& \lambda_{F} = \lambda_{T} = \frac{T_{p}}{T_{m}} = \frac{\mu_{p} A_{p}\frac{\mathrm{d} u_{p}}{\mathrm{d} y_{p}}}{\mu_{m} A_{m}\frac{\mathrm{d} u_{m}}{\mathrm{d} y_{m}}} = \lambda _{\rho}\lambda_{\nu}\lambda_{l}\lambda_{v}
	\end{align}

其中 :math:`\lambda_{\nu}` 为 **运动粘度比尺** 。于是有

.. math::
	\begin{align}
	\lambda_{I}=\lambda_{F}=\lambda_{T}
	\quad \Rightarrow \quad
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{\rho}\lambda_{\nu}\lambda_{l}\lambda_{v}
	\quad \Rightarrow \quad
	\frac{\lambda_{v}\lambda_{l}}{\lambda_{\nu}} = 1
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{v_{p}l_{p}}{\nu_{p}} = \frac{v_{m}l_{m}}{\nu_{m}}
	\quad \Rightarrow \quad 
	(Re)_{p} = (Re)_{m}  
	\end{align}

其中 :math:`Re=\frac{vd}{\nu}` 为雷诺数。上式表明两个流动的惯性力和粘滞力成比例，则这两个流动相应的雷诺数相等，称为 **雷诺准则** ，或者称为 **粘滞力相似准则** 。


.. note:: 

	至于一个流场的雷诺数对该流场本身的意义，可以尝试如下进行理解：将雷诺数的表达式改写成

	.. math::
		\begin{align}
		Re = \frac{vd}{\nu} = \frac{\rho vdV}{\mu V}  
		\end{align}

	其中 :math:`V` 是体积。从量纲上看，分子分母都是角动量。分子部分的角动量是惯性主导的，设想一个障碍挡住了层流，此时以障碍底端为中心，流体相对于障碍底端的角动量，就是惯性对旋涡形成的正面贡献；分母部分的角动量是粘性主导的，粘性抵消了速度梯度，抵消了角动量，对旋涡有着负面贡献。

	角动量因为惯性与几何形状而产生，又因为粘性而消失。当惯性胜过粘性时，多出来的角动量就会形成旋涡，否则表现为规矩的层流。但是旋涡不等于湍流，旋涡要发展成湍流还需要更多复杂条件，所以发生转捩的雷诺数并不是一个定值。



弗劳德准则
""""""""""""""

当重力作用为主时，此时

.. math::
	\begin{align}
	& F = G = mg = \rho l^{3} g \\
	& \lambda_{F} = \lambda_{G} = \lambda_{\rho} \lambda_{l}^{3} \lambda_{g}
	\end{align}

其中 :math:`\lambda_{g}` 为 **重力加速度比尺** 。于是有

.. math::
	\begin{align}
	\lambda_{I} = \lambda_{F} = \lambda_{G}
	\quad \Rightarrow \quad 
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{\rho} \lambda_{l}^{3} \lambda_{g}
	\quad \Rightarrow \quad 
	\frac{\lambda_{v}}{\sqrt{\lambda_{l}\lambda_{g}}} = 1
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{v_{p}}{\sqrt{l_{p}g_{p}}} =  \frac{v_{m}}{\sqrt{l_{m}g_{m}}}
	\quad \Rightarrow \quad 
	(Fr)_{p} = (Fr)_{m}
	\end{align}

其中 :math:`Fr = \frac{v}{\sqrt{lg}}` 是一个无量纲数，称为 **弗劳德数** 。上式表明两个流动的惯性力和重力成比例，则它们的弗劳德数相等，称为 **弗劳德准则** ，或者称为 **重力相似准则** 。


欧拉准则
""""""""""""

如果企图改变原有运动状态的力为流体动压力时，则

.. math::
	\begin{align}
	& F = P = pA \\
	& \lambda_{F} = \lambda_{P} = \lambda_{p}\lambda_{l}^{2}
	\end{align}

其中 :math:`\lambda_{p}` 为压强比尺。于是有

.. math::
	\begin{align}
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{p}\lambda_{l}^{2}
	\quad \Rightarrow \quad 
	\frac{\lambda_{p}}{\lambda_{\rho}\lambda_{v}^{2}} = 1 
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{p_{p}}{\rho_{p}v_{p}^{2}} = \frac{p_{m}}{\rho_{m}v_{m}^{2}}
	\quad \Rightarrow \quad 
	(Eu)_{p} = (Eu)_{m}
	\end{align}

其中 :math:`Eu=\frac{p}{\rho v^{2}}` 为一无量纲量，称为 **欧拉数** 。上式表明两个流动的惯性力和流体动压力成比例，则它们的欧拉数相等，称为 **欧拉准则** ，或称为 **压力相似准则** 。

.. note:: 

	在大多数流动中，对流动起主要作用的是压强差 :math:`\Delta p` 而不是压强的绝对值，欧拉数也因此常用相应点的压强差来代替压强，即 :math:`Eu=\frac{\Delta p}{\rho v^{2}}`



韦伯准则
""""""""""""

当作用力主要为表明张力时，则

.. math::
	\begin{align}
	& F = S = \sigma l \\
	& \lambda_{F} = \lambda_{S} = \lambda_{\sigma}\lambda_{l}
	\end{align}

其中 :math:`\lambda_{\sigma}` 为表面张力比尺。于是有

.. math::
	\begin{align}
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{\sigma}\lambda_{l}
	\quad \Rightarrow \quad 
	\frac{\lambda_{\rho}\lambda_{l}\lambda_{v}^{2}}{\lambda_{\sigma}} = 1 
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{\rho_{p}l_{p}v_{p}^{2}}{\sigma_{p}} = \frac{\rho_{m}l_{m}v_{m}^{2}}{\sigma_{m}}
	\quad \Rightarrow \quad 
	(We)_{p} = (We)_{m}
	\end{align}

其中 :math:`We = \frac{\rho lv^{2}}{\sigma}` 为一无量纲量，称为 **韦伯数** 。上式表明两个流动的惯性力和表明张力成比例，则它们的韦伯数相等，称为 **韦伯准则** ，或者称为 **表面张力相似准则** 。


柯西准则
""""""""""""

对于可压缩流，当作用力主要为弹性力时，则

.. math::
	\begin{align}
	& F = E = Kl^{2} \\
	& \lambda _{F} = \lambda_{E} = \lambda_{K}\lambda_{l}^{2}
	\end{align}

其中 :math:`E` 为弹性力， :math:`K` 为体积弹性模量。于是有

.. math::
	\begin{align}
	\lambda_{\rho}\lambda_{l}^{2}\lambda_{v}^{2} = \lambda_{K}\lambda_{l}^{2}
	\quad \Rightarrow \quad 
	\frac{\lambda_{\rho}\lambda_{v}^{2}}{\lambda_{K}} = 1 
	\end{align}

上式也可以写成

.. math::
	\begin{align}
	\frac{\rho_{p}v_{p}^{2}}{K_{p}} =  \frac{\rho_{m}v_{m}^{2}}{K_{m}}
	\quad \Rightarrow \quad 
	(Ca)_{p} = (Ca)_{m}
	\end{align}

其中 :math:`Ca=\frac{\rho v^{2}}{K}` 是一个无量纲数，称为 **柯西数** 。上式表明两个流动的惯性力和弹性力成比例，则它们的柯西数相等，称为 **柯西准则** ，或者称为 **弹性力相似准则** 。

对于气体来说，音速 :math:`a=\sqrt{\frac{K}{\rho}}` ，代入柯西准则方程并化简开方则得到

.. math::
	\begin{align}
	\frac{v_{p}}{a_{p}} = \frac{v_{m}}{a_{m}}
	\quad \Rightarrow \quad 
	(M)_{p} = (M)_{m}  
	\end{align}

其中 :math:`M=\frac{v}{a}` 是一个无量纲数，称为 **马赫数** 。上式表明两个流动的惯性力和弹性力成比例，则它们的马赫数也相等，称为 **马赫准则** 。





边界层理论基础及绕流运动
===========================


边界层的基本概念
-------------------

在实际流动中，由于流体具有粘性，紧贴在固体壁面的流体与固体壁面之间将没有相对运动。如果假设固体不动，无论流体运动的雷诺数多大，固体壁面上流体的速度也应该为零，而固体壁面附近沿法线方向流速迅速增大，存在较大的流速梯度，而且雷诺数越大，避免附近的流速梯度越大，存在有流速梯度的流体层越薄。因此在固壁附近的流层中，粘性力不能忽略，流体同时受到粘性力和惯性力作用。把固壁存在较大流速梯度的流动薄层称为 **边界层** 。

普朗特提出了边界层理论的假定，将高雷诺数流动分成了两个不同的流动区域：

1. 在固壁附近边界层以内的流动，粘性力和惯性力同阶，必须考虑粘性的作用，为有旋运动。
2. 边界层以外的流动，可以忽略粘性作用而近似按照理想流体处理。
   
一般约定在纵向的流速与层外流速 :math:`u_{0}` 相差 :math:`1\%` 的地方，即 :math:`u_{x}=0.99u_{0}` 处作为边界层的边缘。由边界层外缘到物面的垂直距离定义为边界层的名义厚度，简称为 **边界层厚度** :math:`\delta` 。边界层的厚度一般较物体的特征长度要小很多，即 :math:`\frac{\delta}{L}\ll 1` 。

边界层内流动是粘性流动，同样也存在两种流动形态，也即边界层有 **层流边界层** 和 **湍流边界层** 的区别。对于平板绕流，从平板前缘起自层流开始，随 :math:`x` 的增加，边界层厚度逐渐增加，壁面对流体扰动的稳定作用逐渐减弱，直到发生流态转捩的边界层内形成湍流。

.. note:: 影响边界层从层流边界层发展成为湍流边界层的因素很多而且很复杂，所以层流与湍流的转捩不是在某个断面突然发生的，而是在一个过渡区内完成的。

转捩点主要依靠实验来确定，对于平板边界层，定义边界层内的雷诺数为

.. math::
	\begin{align}
	Re_{x} = \frac{U_{0}x}{\nu} 
	\end{align}

由层流边界层转变为湍流边界层的点 :math:`x=x_{c}` 称为 **转捩点** ，则转捩临界雷诺数为 :math:`Re_{c} = \frac{U_{0}x_{c}}{\nu}` 。对于光滑平板来讲， :math:`Re_{c}` 的范围为 :math:`3\times10^{5} \sim 3\times10^{6}` 。影响临界雷诺数的主要因素是固体边界的粗糙情况、来流的湍流强度以及边界层外流动的压强分布。目前确定临界雷诺数的数值主要依靠实验，一般取 :math:`Re_{c}=5\times10^{5}` 。

.. note:: 在湍流边界层内，最靠近平板的地方 :math:`\frac{\mathrm{d}u_{x}}{\mathrm{d}y}` 很大，粘滞切应力仍起主要作用，使得流动形态仍然是层流，所以在湍流边界层中，紧贴平板边界也有一层极薄的粘性底层。


在解决实际问题时，不仅需要定义边界层名义厚度，还需要定义一些能够表示明确物理意义的厚度，并由此说明边界层的基本特性：


**边界层位移厚度** :math:`\delta_{1}` ，也称边界层流量排挤厚度，是指由于边界层的存在，使外部流动按理想流体处理时其流动的虚拟边界向壁面以外移动的距离。

单位时间内通过边界层某一断面的流体若为理想流体，其质量流量应为 :math:`\int_{0}^{\delta}\rho u_{0}~\mathrm{d}y` ，其中 :math:`u_{0}` 为该断面边界层外边缘流动的速度。而对于实际粘性流体，边界层内实际通过的流体质量为 :math:`\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` ，两个流量的差即为由于流体粘性而减少的流量，这部分流量将从边界层内排挤到层外，相当于在边界层外流动中增加了一层速度为 :math:`u_{0}` 而厚度为 :math:`\delta_{1}` 的流体，可以表示为

.. math::
	\begin{align}
	\rho u_{0}\delta_{1} = \int_{0}^{\delta}\rho u_{0}~\mathrm{d}y - \int_{0}^{\delta}\rho u_{x}~\mathrm{d}y
	\quad \Rightarrow \quad
	\delta_{1} = \int_{0}^{\delta}\Big( 1 - \frac{u_{x}}{u_{0}} \Big)\mathrm{d}y
	\end{align}



**边界层动量损失厚度** :math:`\delta_{2}` 是指由于边界层的存在，边界层内损失的动量折合成按理想流体处理时具有相同动量的等效厚度。

单位时间内通过边界层某一断面的流体质量流量为 :math:`\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` ，实际具有的动量为 :math:`\int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y` 。如果是理想流体，则应该具有的动量为 :math:`u_{0}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` 。两个动量的差即为由于流体粘性而产生的动量损失，这部分动量损失相当于以流速 :math:`u_{0}` 通过厚度为 :math:`\delta_{2}` 的理想流体所具有的动量，即

.. math::
	\begin{align}
	\rho u_{0}^{2}\delta_{2} = u_{0}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y - \int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y
	\quad \Rightarrow \quad
	\delta_{2} = \int_{0}^{\delta}\frac{u_{x}}{u_{0}}\Big( 1-\frac{u_{x}}{u_{0}} \Big)\mathrm{d}y 
	\end{align}


边界层内位移厚度与动量损失厚度的比值，为 **边界层形状系数** ，以 :math:`H` 表示，即

.. math::
	\begin{align}
	H = \frac{\delta_{1}}{\delta_{2}} 
	\end{align}


**边界层能量损失厚度** 是指由于边界层的存在，边界层内所损失的能量折合成按理想流体处理时具有相同能量的等效厚度。

单位时间内通过边界层某一断面的流体质量流量为 :math:`\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` ，实际具有的动能为 :math:`\int_{0}^{\delta}\rho u_{x}\cdot u_{x}^{2}~\mathrm{d}y` 。如果是理想流体，则应该具有的动能为 :math:`u_{0}^{2}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y` 。两个动能的差即为由于流体粘性而产生的动能损失，这部分动能损失相当于以流速 :math:`u_{0}` 通过厚度为 :math:`\delta_{3}` 的理想流体所具有的动能，即

.. math::
	\begin{align}
	\rho u_{0}\delta_{3} \cdot u_{0}^{2} = u_{0}^{2}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y - \int_{0}^{\delta}\rho u_{x}\cdot u_{x}^{2}~\mathrm{d}y
	\quad \Rightarrow \quad
	\delta_{3} = \int_{0}^{\delta}\frac{u_{x}}{u_{0}}\Big( 1-\frac{u_{x}^{2}}{u_{0}^{2}} \Big)~\mathrm{d}y 
	\end{align}



边界层微分方程
-----------------

对于二维恒定流动，例如在无限空间中水平放置的平板，可以不考虑质量力作用，则动量方程和连续性方程写为

.. math::
	\begin{align}
	& u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{x}}{\partial y} = -\frac{1}{\rho}\frac{\partial p}{\partial x} + \nu\Big( \frac{\partial^{2}u_{x}}{\partial x^{2}}+\frac{\partial^{2}u_{x}}{\partial y^{2}} \Big) \\
	& u_{x}\frac{\partial u_{y}}{\partial x} + u_{y}\frac{\partial u_{y}}{\partial y} = -\frac{1}{\rho}\frac{\partial p}{\partial y} + \nu\Big( \frac{\partial^{2}u_{y}}{\partial x^{2}}+\frac{\partial^{2}u_{y}}{\partial y^{2}} \Big) \\
	& \frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} = 0  
	\end{align}

对上述方程的各项进行数量级分析。首先将各项无量纲化，长度均除以 :math:`x` 方向的特征长度 :math:`L` ，流速均除以未扰动的来流流速 :math:`U_{0}` ，得到下列无量纲量：

.. math::
	\begin{align}
	x^{0}=\frac{x}{L}, \quad 
	y^{0}=\frac{y}{L}, \quad 
	u_{x}^{0}=\frac{u_{x}}{U_{0}}, \quad 
	u_{y}^{0}=\frac{u_{y}}{U_{0}}, \quad 
	p^{0}=\frac{p}{\rho U_{0}^{2}}     
	\end{align}

同时认为 :math:`\rho=\text{const},\mu=\text{const},g=\text{const}` ，将上面无量纲量代入动量方程和连续性方程各项。对于x方向的各项则有：

.. math::
	\begin{align}
	& u_{x}\frac{\partial u_{x}}{\partial x} 
	= U_{0}\Big(\frac{u_{x}}{U_{0}}\Big)\frac{\partial \Big(\cfrac{u_{x}}{U_{0}}\Big)U_{0}}{\partial \Big(\cfrac{x}{L}\Big)L}
	= \frac{U_{0}^{2}}{L} u_{x}^{0}\frac{\partial u_{x}^{0}}{\partial x^{0}} 
	\\
	& u_{y}\frac{\partial u_{x}}{\partial y} 
	= U_{0}\Big(\frac{u_{y}}{U_{0}}\Big)\frac{\partial \Big(\cfrac{u_{x}}{U_{0}}\Big)U_{0}}{\partial \Big(\cfrac{y}{L}\Big)L}
	= \frac{U_{0}^{2}}{L} u_{y}^{0}\frac{\partial u_{x}^{0}}{\partial y^{0}}
	\\
	& \frac{1}{\rho}\frac{\partial p}{\partial x} 
	= \frac{1}{\rho}\frac{\partial \Big(\cfrac{p}{\rho U_{0}^{2}}\Big) \rho U_{0}^{2}}{\partial \Big(\cfrac{x}{L}\Big)L} 
	= \frac{U_{0}^{2}}{L}\frac{\partial p^{0}}{\partial x^{0}}
	\\
	& \nu\frac{\partial ^{2}u_{x}}{\partial x^{2}}
	= \frac{\mu}{\rho}\frac{\partial ^{2}\Big(\cfrac{u_{x}}{U_{0}}\Big)U_{0}}{\partial \Big(\cfrac{x}{L}\Big)^{2}L^{2}}
	= \frac{\mu}{\rho}\frac{U_{0}}{L^{2}}\frac{\partial ^{2}u_{x}^{0}}{\partial x^{0^{2}}}
	\\
	& \nu\frac{\partial ^{2}u_{x}}{\partial y^{2}}
	= \frac{\mu}{\rho}\frac{\partial ^{2}\Big(\cfrac{u_{x}}{U_{0}}\Big)U_{0}}{\partial \Big(\cfrac{y}{L}\Big)^{2}L^{2}}
	= \frac{\mu}{\rho}\frac{U_{0}}{L^{2}}\frac{\partial ^{2}u_{x}^{0}}{\partial y^{0^{2}}}
	\end{align}


代入动量方程中并两边同时除以 :math:`\frac{U_{0}^{2}}{L}` 则得到

.. math::
	\begin{align}
	u_{x}^{0}\frac{\partial u_{x}^{0}}{\partial x^{0}}
	+ u_{y}^{0}\frac{\partial u_{x}^{0}}{\partial y^{0}}
	= -\frac{\partial p^{0}}{\partial x^{0}} 
	+ \frac{\nu}{U_{0}L}\Big(\frac{\partial ^{2}u_{x}^{0}}{\partial x^{0^{2}}} + \frac{\partial ^{2}u_{x}^{0}}{\partial y^{0^{2}}}\Big)
	\end{align}

其中 :math:`\frac{\nu}{U_{0}L}=\frac{1}{Re}` 。用同样的方法，可以将y方向动量方程和连续性方程也进行无量纲化，得到

.. math::
	\begin{align}
	& u_{x}^{0}\frac{\partial u_{x}^{0}}{\partial x^{0}}
	+ u_{y}^{0}\frac{\partial u_{x}^{0}}{\partial y^{0}}
	= -\frac{\partial p^{0}}{\partial x^{0}}
	+ \frac{1}{Re} \Big(\frac{\partial ^{2}u_{x}^{0}}{\partial x^{0^{2}}} + \frac{\partial ^{2}u_{x}^{0}}{\partial y^{0^{2}}}\Big)
	\\
	& u_{x}^{0}\frac{\partial u_{y}^{0}}{\partial x^{0}}
	+ u_{y}^{0}\frac{\partial u_{y}^{0}}{\partial y^{0}}
	= -\frac{\partial p^{0}}{\partial y^{0}}
	+ \frac{1}{Re} \Big(\frac{\partial ^{2}u_{y}^{0}}{\partial x^{0^{2}}} + \frac{\partial ^{2}u_{y}^{0}}{\partial y^{0^{2}}}\Big)
	\\
	& \frac{\partial u_{x}^{0}}{\partial x^{0}} + \frac{\partial u_{y}^{0}}{\partial y^{0}} = 0 
	\end{align}


由于限于研究边界层内的流动，定义无量纲的边界层厚度 :math:`\delta^{0}=\delta/L \ll 1` ，于是可以建立用它进行衡量的量级分析：

.. math::
	\begin{align}
	x^{0}=\frac{x}{L} \sim O(1), \quad 
	y^{0}=\frac{y}{L} \sim O(\delta^{0}), \quad 
	u_{x}^{0}=\frac{u_{x}}{U_{0}} \sim O(1), \quad 
	\frac{\partial u_{x}^{0}}{\partial x^{0}} \sim O(1), \quad 
	\frac{\partial u_{x}^{0}}{\partial y^{0}} \sim O\Big(\frac{1}{\delta^{0}}\Big)    
	\end{align}

结合无量纲的连续性方程 :math:`\frac{\partial u_{x}^{0}}{\partial x^{0}} + \frac{\partial u_{y}^{0}}{\partial y^{0}} = 0` 可以进一步得到

.. math::
	\begin{align}
	\frac{\partial u_{y}^{0}}{\partial y^{0}} \sim O(1), \quad 
	u_{y}^{0} \sim O(\delta^{0}), \quad 
	\frac{\partial^{2} u_{x}^{0}}{\partial x^{0^{2}}} \sim O(1), \quad 
	\frac{\partial^{2} u_{x}^{0}}{\partial y^{0^{2}}} \sim O\Big(\frac{1}{\delta^{0^{2}}} \Big)
	\end{align}

在边界层中假定动量方程的惯性项与粘性项具有同一量级。在粘性项中，如果是平板或曲率很小的曲面，由于沿流动方向的速度变化率很小，所以有 :math:`\frac{\partial^{2}u_{x}}{\partial x^{2}}\ll \frac{\partial ^{2}u_{x}}{\partial y^{2}}` ，可以忽略 :math:`\frac{\partial^{2}u_{x}}{\partial x^{2}}` 项，并且忽略 :math:`\frac{\partial p}{\partial x}` 的量级影响，于是按照量纲分析得到

.. math::
	\begin{align}
	\frac{u^{2}}{L}\propto \nu\frac{u}{\delta^{2}}
	\quad \Rightarrow \quad 
	\frac{u}{L\nu}\propto \frac{1}{\delta^{2}}
	\quad \Rightarrow \quad 
	\frac{Lu}{\nu}\propto \frac{1}{\delta^{2}/L^{2}}=\frac{1}{\delta^{0^{2}}}
	\quad \Rightarrow \quad 
	Re \sim O(\frac{1}{\delta^{0^{2}}})
	\end{align}

针对无量纲的动量方程和连续性方程，把所有量级小于1的项忽略不计，于是得到

.. math::
	\begin{align}
	& u_{x}^{0}\frac{\partial u_{x}^{0}}{\partial x^{0}} + u_{y}^{0}\frac{\partial u_{x}^{0}}{\partial y^{0}} = -\frac{\partial p^{0}}{\partial x^{0}} + \frac{1}{Re}\frac{\partial ^{2}u_{x}^{0}}{\partial y^{0^{2}}} \\
	& \frac{\partial u_{x}^{0}}{\partial x^{0}} + \frac{\partial u_{y}^{0}}{\partial y^{0}} = 0 
	\end{align}

将上式恢复成有量纲的物理量，即可得到边界微分方程，也称为 **普朗特边界层方程** ：

.. math::
	\begin{align}
	& u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{x}}{\partial y} = -\frac{1}{\rho}\frac{\partial p}{\partial x} + \frac{\mu}{\rho}\frac{\partial ^{2}u_{x}}{\partial y^{2}} \\
	& \frac{\partial u_{x}}{\partial x} + \frac{\partial u_{y}}{\partial y} = 0      
	\end{align}

其边界条件为(1) :math:`y=0,u_{x}=0,u_{y}=0` ；(2) :math:`y=\infty,u_{x}=u_{0}` 。也可以近似写为 :math:`y=\delta,u_{x}=u_{0}` 。 :math:`u_{0}` 为边界层外边界上的势流流速。


.. note:: 由 :math:`\frac{\partial p}{\partial y}\to 0` 可知，沿着固体边界的外法线，边界层内的压强基本上不变，它等于边界层外边界上的压强。


.. note:: 
	
	如果边界层内的流动为湍流时，普朗特边界层方程的第一条式子应该改写成

	.. math::
		\begin{align}
		u_{x}\frac{\partial u_{x}}{\partial x} + u_{y}\frac{\partial u_{x}}{\partial y} = -\frac{1}{\rho}\frac{\partial p}{\partial x} + \frac{1}{\rho}\frac{\partial }{\partial y}\Big( \mu\frac{\partial u_{x}}{\partial y} - \rho\overline{u_{x}'u_{y}'}\Big)  
		\end{align}


.. note:: 上述内容不仅适用于平板边界层，对于具有曲率的边界，只要曲率较为平缓，没有突然的变化， :math:`x` 坐标沿着曲面边界， :math:`y` 坐标沿曲面外法线方向，则上述方程式和论述也是适用的。




边界层的动量积分方程
-----------------------

假定流体绕一物体的曲面流动，在物体边界附近产生一层很薄的边界层。沿曲面取为 :math:`x` 轴，沿物体表面法线方向取为 :math:`y` 轴。在物体表面取一个单位宽度边界层的微段 :math:`ABCD` ，如图所示， :math:`BD` 长为 :math:`\mathrm{d}x` ， :math:`AC` 为边界层外边界， :math:`AB` 、 :math:`CD` 垂直于物体表面。为了使问题简化，假设：

1. 因为边界层很薄，质量力可以忽略不计；
2. 流动为恒定平面流动；
3. 由于 :math:`\mathrm{d}x` 极小， :math:`BD` 和 :math:`AC` 均可以视为直线。
   
:math:`AB,CD,AC` 面的单位时间质量通量分别为

.. math::
	\begin{align}
	& \phi_{m_{AB}} = \int_{0}^{\delta}\rho u_{x}~\mathrm{d}y \\
	& \phi_{m_{CD}} = \phi_{m_{AB}} + \frac{\partial \phi_{m_{AB}}}{\partial x}\mathrm{d}x = \int_{0}^{\delta}\rho u_{x}~\mathrm{d}y + \frac{\partial }{\partial x}\Big(\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y \Big)\mathrm{d}x \\
	& \phi_{m_{AC}} = \phi_{m_{CD}} - \phi_{m_{AB}} = \frac{\partial }{\partial x}\Big(\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y \Big)\mathrm{d}x 
	\end{align}

:math:`AB,CD,AC` 面的单位时间动量通量分别为

.. math::
	\begin{align}
	& \phi_{AB} = \int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y \\
	& \phi_{CD} = \phi_{AB} + \frac{\partial \phi_{AB}}{\partial x}\mathrm{d}x = \int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y + \frac{\partial }{\partial x}\Big(\int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y \Big)\mathrm{d}x \\
	& \phi_{AC} = \phi_{m_{AC}} \cdot u_{0} = u_{0}\frac{\partial }{\partial x}\Big(\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y \Big)\mathrm{d}x
	\end{align}


.. attention:: 其中 :math:`u_{0}` 为边界层外边界上的流速在 :math:`x` 轴上的分量，并认为在 :math:`AC` 面上各点都相等。


对于微段 :math:`ABCD` 上的受力，因为忽略了质量力所以只有表面力。由于边界层内 :math:`\frac{\partial p}{\partial y}=0` ，因而 :math:`AB` 面和 :math:`CD` 面上压强是均匀分布的。设 :math:`AB` 面上的压强为 :math:`p` ，则由泰勒级数展开得到作用在 :math:`CD` 面上的压强为 :math:`p+\frac{\partial p}{\partial x}\mathrm{d}x` 。作用在 :math:`AC` 面上的压强一般是不均匀的，则可以根据A点和C点压强取其平均值 :math:`p + \frac{1}{2}\frac{\partial p}{\partial x}\mathrm{d}x` 。关于摩擦阻力，设固体表面对流体作用的切应力为 :math:`\tau_{0}` ，而由于边界层外可以当作理想流体，所以在边界层外边界 :math:`AC` 面上没有切应力。如此，各表面力在 :math:`x` 轴方向的分量之和为

.. math::
	\begin{align}
	\sum F_{x} = p\delta - \Big(p + \frac{\partial p}{\partial x}\mathrm{d}x \Big)(\delta + \mathrm{d}\delta ) + \Big(p + \frac{1}{2}\frac{\partial p}{\partial x}\mathrm{d}x \Big)\mathrm{d}s \cdot \sin\theta - \tau_{0}\mathrm{d}x 
	\end{align}

同时考虑到 :math:`\mathrm{d}s \cdot \sin\theta = \mathrm{d}\delta` ，并忽略高阶微量，且依据 :math:`\frac{\partial p}{\partial y}=0` 可知 :math:`p` 与 :math:`y` 无关，可以用全微分代替偏微分，则上式最终化简为

.. math::
	\begin{align}
	\sum F_{x} = -\frac{\mathrm{d} p}{\mathrm{d} x}\mathrm{d}x \cdot \delta - \tau_{0}\mathrm{d}x   
	\end{align}

根据动量方程可以得到

.. math::
	\begin{align}
	\phi_{CD} - \phi_{AB} - \phi_{AC} = \sum F_{x}
	\end{align}

代入各项也即得到 **边界层动量积分方程** ，也称卡门动量积分方程：

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}\rho u_{x}^{2}~\mathrm{d}y - u_{0}\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}\rho u_{x}~\mathrm{d}y = -\delta\frac{\mathrm{d}p}{\mathrm{d}x} - \tau_{0}    
	\end{align}


.. note:: 上式适用于层流边界层和湍流边界层，只是不同的流态要采用不同的 :math:`\tau_{0}` 计算式。


.. note:: 

	对于上式，当 :math:`\rho` 为常数时，仍有 :math:`\delta,p,u_{0},u_{x},\tau_{0}` 五个未知数，其中 :math:`u_{0}` 可以通过势流理论求得， :math:`p` 可以按伯努利方程求得，还剩下三个未知数。因此，要解边界层动量积分方程还需要两个补充方程，即

	1. 边界层内流速分布关系式 :math:`u_{x}=f_{1}(y)` ；
	2. 切应力 :math:`\tau_{0}` 与边界层厚度 :math:`\delta` 的关系式 :math:`\tau_{0}=f_{2}(\delta)` 。
	   
	而 :math:`\tau_{0}=f_{2}(\delta)` 可以根据边界层内流速分布的关系式得到，所以通常在解边界层动量方程时，先假定流速分布 :math:`u_{x}=f_{1}(y)` ，这个假定越接近实际则所得结果越正确。




平板边界层的近似计算
----------------------

设有一极薄的静止光滑平板顺流放置于二维恒定均匀流场中，如图所示。以平板上游端为坐标原点，取平面表面为 :math:`x` 轴，来流流速为 :math:`U_{0}` 且平行于 :math:`x` 轴，平板长度为 :math:`L` 。依据平板末端的雷诺数 :math:`Re_{L}=\frac{LU_{0}}{\nu}` 与临界雷诺数 :math:`Re_{c}` 对比，可以将光滑平板边界层的计算分为三种情况：

1. 当 :math:`Re_{L}<Re_{c}` ，即 :math:`L<x_{c}` 时，整个平板边界层内流动状态为层流，这种边界层为层流边界层；
2. 当 :math:`Re_{L}>Re_{c}` ，即 :math:`L>x_{c}` 时，在平板前端仍保持为层流，在转捩点 :math:`x_{c}` 以后为湍流，在层流和湍流之间还有一个过渡段。这种边界层称为混合边界层；
3. 当 :math:`Re_{L}\gg Re_{c}` ，即 :math:`L\gg x_{c}` 时， :math:`x_{c}` 的数值相对于 :math:`L` 变得很小，即混合边界层中层流部分退所谓平板前端很小一部分，对整个边界层的计算作用很小。这时可以假设整个边界层都是湍流状态，称为湍流边界层。
   
当流体以均匀速度 :math:`U_{0}` 沿平板方向作恒定流动时，由于平板很薄，边界层外部流动不受平板的影响，因此边界层外边界的边界条件是：

1. 外边界上的流速 :math:`u_{0}` 处处相等，且等于来流速度，即 :math:`u_{0}=U_{0}` ， :math:`\frac{\mathrm{d}u_{0}}{\mathrm{d}x}=0` ；
2. 边界层外按理想流体处理，由于流速不变，所以边界层外边界上的压强也处处相等，即 :math:`\frac{\mathrm{d}p}{\mathrm{d}x}=0` 。
   



平板上层流边界层的计算
^^^^^^^^^^^^^^^^^^^^^^^^^

平板上层流边界层第一个补充方程为边界层内的流速分布关系式 :math:`u_{x}=f_{1}(y)` 。假定层流边界层内的流速分布与圆管流中的层流流速分布相同，即

.. math::
	\begin{align}
	u = u_{m}\Big(1-\frac{r^{2}}{r_{0}^{2}}\Big)
	\end{align}

将上式应用于平板上的边界层时，管流中的 :math:`r_{0}` 对应于边界层中的 :math:`\delta` ， :math:`r` 对应为 :math:`(\delta - y)` ， :math:`u_{m}` 对应为 :math:`U_{0}` ， :math:`u` 对应为 :math:`u_{x}` ，如此上式就可以改写为

.. math::
	\begin{align}
	u_{x} = U_{0}\Big[ 1 - \frac{(\delta - y)^{2}}{\delta^{2}} \Big] = \frac{2U_{0}}{\delta}\Big(y - \frac{y^{2}}{2\delta} \Big) 
	\end{align}

第二个补充方程为平板上切应力与边界层厚度的关系式 :math:`\tau_{0}=f_{2}(\delta)` 。由于层流符合牛顿内摩擦定律，所以求平板上的切应力只要将上式代入牛顿内摩擦定律并取 :math:`y=0` 即可得到

.. math::
	\begin{align}
	\tau_{0} = -\mu\frac{\mathrm{d}u_{x}}{\mathrm{d}y}\bigg|_{y=0} = -\mu\frac{\mathrm{d}}{\mathrm{d}y}\Big[\frac{2U_{0}}{\delta} \Big(y-\frac{y^{2}}{2\delta} \Big)\Big] \bigg|_{y=0}
	\end{align}

上式中的负号表示切应力和 :math:`x` 轴方向相反。现在去掉负号，取绝对值并整理化简得到

.. math::
	\begin{align}
	\tau_{0} = \mu\frac{2U_{0}}{\delta}
	\end{align}


将以上所得的两个补充方程代入到边界层的动量积分方程，得到

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}\Big[\frac{2U_{0}}{\delta}\Big(y-\frac{y^{2}}{2\delta} \Big)\Big]^{2}\mathrm{d}y
	- U_{0}\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}\frac{2U_{0}}{\delta}\Big(y-\frac{y^{2}}{2\delta} \Big)\mathrm{d}y
	= - \frac{2\mu U_{0}}{\rho \delta}  
	\end{align}

化简上式得到

.. math::
	\begin{align}
	\frac{1}{15}U_{0} \frac{\mathrm{d}\delta}{\mathrm{d}x} = \frac{\mu}{\rho \delta}  
	\end{align}

积分得到

.. math::
	\begin{align}
	\frac{1}{15}\frac{U_{0}}{\mu}\frac{\rho\delta^{2}}{2} = x+C   
	\end{align}

积分常数 :math:`C` 由边界条件确定。当 :math:`x=0,\delta=0` 得到 :math:`C=0` ，又 :math:`\nu=\frac{\mu}{\rho}` ，上式即可化简得到 **平板上层流边界层厚度沿x轴方向的变化规律** ：

.. math::
	\begin{align}
	\delta = 5.477\sqrt{\frac{\nu x}{U_{0}}} 
	\end{align}

将上式代入到切应力补充方程，化简后可以得到 **平板上层流边界层切应力沿x方向的变化规律** ：

.. math::
	\begin{align}
	\tau_{0} = 0.365\sqrt{\frac{\mu\rho U_{0}^{3}}{x}} 
	\end{align}

作用在平板上一面的摩擦阻力 :math:`F_{f}` 为

.. math::
	\begin{align}
	F_{f} = \int_{0}^{L}\tau_{0}b~\mathrm{d}x = \int_{0}^{L}0.365\sqrt{\frac{\mu\rho U_{0}^{3}}{x}}~\mathrm{d}x = 0.73b\sqrt{\mu \rho U_{0}^{3}L}
	\end{align}

其中 :math:`b` 为平板宽度， :math:`L` 为平板的长度。

.. note:: 如果要求流体对平板两面的总摩擦阻力时，只需要将上式乘以2即可。

通常将绕流摩擦阻力的计算式写成单位体积来流的动能 :math:`\rho U_{0}^{2}/2` 与某一面积的乘积，在乘以摩阻系数的形式，即

.. math::
	\begin{align}
	F_{f} = C_{f}\frac{\rho U_{0}^{2}}{2}A_{f} 
	\end{align}

其中 :math:`C_{f}` 为无量纲摩阻系数， :math:`\rho` 为流体密度， :math:`U_{0}` 为流体来流速度， :math:`A_{f}` 通常指切应力作用的面积或某一有代表性的投影面面积，这里指平板面积，即 :math:`A_{f}=bL` 。通过对比系数可以得到

.. math::
	\begin{align}
	C_{f} = 1.46\sqrt{\frac{\mu}{\rho U_{0}L}} = 1.46\sqrt{\frac{\nu}{U_{0}L}} = \frac{1.46}{\sqrt{Re_{L}} }   
	\end{align}

其中 :math:`Re_{L}=\frac{U_{0}L}{\nu}` 为以板长 :math:`L` 为特征长度的雷诺数。



.. note:: 

	有布拉修斯从普朗特边界层方程求得的，并与实验结果吻合较好的解为

	.. math::
		\begin{align}
		& \delta = 5\sqrt{\frac{\nu x}{U_{0}} } \\
		& F_{f} = 0.664b\sqrt{\mu \rho U_{0}^{3}L} \\
		& C_{f} = \frac{1.328}{\sqrt{Re_{L}}}   
		\end{align}

	上面三个式子适用于 :math:`Re_{L}<3\times10^{5} \sim 10^{6}` 的情况。


平板上湍流边界层的计算
^^^^^^^^^^^^^^^^^^^^^^^^^

由于脉动而产生的附加切应力在湍流边界层内如何计算尚不清楚，补充方程目前还不能从理论上推导出来，不过，普朗特假设沿平板边界层内的湍流运动与管内湍流运动没有显著的差别，因此第一个补充方程可以借用圆管湍流光滑区的速度分布指数公式

.. math::
	\begin{align}
	u = u_{m}\Big(\frac{y}{r_{0}}\Big)^{1/7}
	\end{align}

将上式应用于平板上边界层时，管流中的 :math:`r_{0}` 对应于边界层中的 :math:`\delta` ， :math:`u_{m}` 对应于 :math:`U_{0}` ， :math:`u` 对应于 :math:`u_{x}` ，上式可以写为

.. math::
	\begin{align}
	u_{x} = U_{0}\Big(\frac{y}{\delta}\Big)^{1/7}
	\end{align}

为了寻找第二个补充方程 :math:`\tau_{0}=f_{2}(\delta)` ，先根据管流中切应力公式 :math:`\tau_{0}=\frac{\lambda}{8}\rho v^{2}` 和计算湍流光滑区 :math:`\lambda` 值的布拉修斯公式 :math:`\lambda=\frac{0.3164}{Re^{1/4}}` ，求得光滑区切应力公式为

.. math::
	\begin{align}
	\tau_{0} = \frac{\lambda }{8}\rho v^{2} = \frac{\rho v^{2}}{8}\frac{0.3164}{Re^{1/4}} = 0.0332\rho v^{7/4}\Big(\frac{\nu}{r_{0}} \Big)^{1/4}
	\end{align}

其中的 :math:`v` 为圆管内的平均流速。为了用于平板边界层，还需要将上式用来流速度 :math:`U_{0}` 表示，也就需要继续推导管流中的平均流速与最大流速的关系式，即

.. math::
	\begin{align}
	v = \frac{Q}{A} = \frac{\int_{0}^{r_{0}}u~\mathrm{d}A}{\pi r_{0}^{2}} = \frac{\int_{0}^{r_{0}}u_{m}(\frac{y}{r_{0}})^{1/7}\cdot 2\pi r~\mathrm{d}r}{\pi r_{0}^{2}}  
	\end{align}

因为 :math:`r=r_{0}-y` ， :math:`\mathrm{d}r=-\mathrm{dy}` ，代入上式积分后得到

.. math::
	\begin{align}
	v = 0.817u_{m}
	\end{align}

将上式代入光滑区切应力公式，且管流中的 :math:`u_{m}` 对应为 :math:`U_{0}` ， :math:`r_{0}` 对应为 :math:`\delta` ，则得到平板上切应力与边界层厚度的关系式为

.. math::
	\begin{align}
	\tau_{0} = 0.0233\rho U_{0}^{2}\Big(\frac{\nu}{\delta U_{0}}\Big)^{1/4}
	\end{align}

接下来，首先将速度分布补充方程代入边界层动量积分方程，得到

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}U_{0}^{2}\Big(\frac{y}{\delta}\Big)^{2/7}\mathrm{d}y - U_{0}\frac{\mathrm{d}}{\mathrm{d}x}\int_{0}^{\delta}U_{0}\Big(\frac{y}{\delta}\Big)^{1/7}\mathrm{d}y = -\frac{\tau_{0}}{\rho}  
	\end{align}

积分并移项后得到

.. math::
	\begin{align}
	\frac{7}{72}\rho U_{0}^{2}\mathrm{d}\delta = \tau_{0}\mathrm{d}x  
	\end{align}

再将切应力分布补充方程代入上式，得到

.. math::
	\begin{align}
	\frac{7}{72}\rho U_{0}^{2}\mathrm{d}\delta = 0.0233\rho U_{0}^{2}\Big(\frac{\nu}{\delta U_{0}}\Big)^{1/4}\mathrm{d}x
	\end{align}

积分并移项后得到

.. math::
	\begin{align}
	(\frac{7}{72})(\frac{4}{5})\delta^{5/4} = 0.0233\Big(\frac{\nu}{U_{0}}\Big)^{1/4}x + C
	\end{align}

其中 :math:`C` 为积分常数。根据边界条件 :math:`x=0,\delta=0` 代入上式可以得到 :math:`C=0` ，即可得到 **光滑平板上湍流边界层厚度沿x方向的变化规律** ：

.. math::
	\begin{align}
	(\frac{7}{72})(\frac{4}{5})\delta^{5/4} = 0.0233\Big(\frac{\nu}{U_{0}}\Big)^{1/4}x
	\quad \Rightarrow \quad 
	\delta = 0.381\Big(\frac{\nu}{U_{0}x} \Big)^{1/5}x = 0.381\frac{x}{Re_{x}^{1/5}} 
	\end{align}

将上式带入切应力与边界层厚度的关系式，得到 **光滑平板上湍流边界层切应力沿x方向的变化规律** ：

.. math::
	\begin{align}
	\tau_{0} = 0.0296\rho U_{0}^{2}\Big(\frac{\nu}{U_{0}x}\Big)^{1/5}
	\end{align}

作用在平板上一面的摩擦阻力 :math:`F_{f}` 为

.. math::
	\begin{align}
	F_{f} = \int_{0}^{L}\tau_{0}b~\mathrm{d}x = 0.037\rho U_{0}^{2}bL\Big(\frac{\nu}{U_{0}L}\Big)^{1/5}
	\end{align}

.. note:: 如果要求平板两面的总摩擦阻力，只需要将上式乘以2即可得到。

将上式与标准形式 :math:`F_{f}=C_{f}\frac{\rho U_{0}^{2}}{2}A_{f}` 对比系数可以得到摩阻系数为

.. math::
	\begin{align}
	C_{f} = 0.074\Big(\frac{\nu}{U_{0}L}\Big)^{1/5} = \frac{0.074}{Re_{L}^{1/5}}
	\end{align}


.. attention:: 以上各式适用于 :math:`Re=3\times10^{5} \sim 10^{7}` 。当 :math:`Re > 10^{7}` 时，流速分布的七分之一次方定律已经不适用，这时应该按对数分布规律进行计算。

.. note:: 

	实验表明，光滑平板上湍流边界层的流速分布与管流的对数流速分布稍有不同，应该为

	.. math::
		\begin{align}
		u = v_{*}\Big(5.85\lg\frac{yv_{0}}{\nu} + 5.56 \Big)
		\end{align}

	由此计算得到的摩阻系数为

	.. math::
		\begin{align}
		C_{f} = \frac{0.455}{(\lg Re_{L})^{2.58}} 
		\end{align}

	上式适用范围可以达到 :math:`Re_{L} = 10^{9}` 。



平板上混合边界层的计算
^^^^^^^^^^^^^^^^^^^^^^^^^

由于混合边界层内流动情况非常复杂，在计算混合边界层时作了两个假定：

1. 在大雷诺数情况下，层流边界层转变为湍流边界层是在 :math:`x_{c}` 处突然发生的，没有过渡段；
2. 混合边界层的湍流边界层可以看作是从平板的首端开始的湍流边界层的一部分。
   
根据以上两个假定，普朗特建议，可以认为整个光滑平板上混合边界层的摩擦阻力，由转捩点前层流边界层的摩擦阻力和转捩点后湍流边界层的摩擦阻力两部分组成，即

.. math::
	\begin{align}
	C_{fm}\frac{\rho U_{0}^{2}}{2}bL = C_{fl} \frac{\rho U_{0}^{2}}{2} bx_{c} + C_{ft}\frac{\rho U_{0}^{2}}{2}b (L -x_{c})
	\end{align}

其中 :math:`C_{fm},C_{fl},C_{ft}` 分别为混合边界层、层流边界层、湍流边界层的摩阻系数， :math:`x_{c}` 为转捩点到平板前端的距离。由上式可以得到

.. math::
	\begin{align}
	C_{fm} = C_{ft} - (C_{ft} - C_{fl})\frac{x_{c}}{L} = C_{ft} - (C_{ft} - C_{fl})\frac{Re_{c}}{Re_{L}}
	\end{align}

当 :math:`3\times10^{5} \le Re_{L} \le 10^{7}` 时，将层流边界层、湍流边界层的摩阻系数表达式代入上式，得到 **平板混合边界层的摩阻系数** ：

.. math::
	\begin{align}
	C_{fm} = \frac{0.074}{Re_{L}^{1/5}} - \Big(\frac{0.074}{Re_{c}^{1/5}} - \frac{1.46}{Re_{c}^{1/2}} \Big)\frac{Re_{c}}{Re_{L}} = \frac{0.074}{Re_{L}^{1/5}} - \frac{A}{Re_{L}}
	\end{align}

其中 :math:`A = 0.074 Re_{c}^{4/5} - 1.46 Re_{c}^{1/2}` 。






孔口、管嘴出流和有压管流
===========================

孔口出流
------------

在装有流体的容器器壁上开一孔口，流体从孔口外流，这种现象称为孔口出流。孔口出流计算的核心问题是应用流体运动的连续性原理和总流能量方程，以及流体流动的能量损失规律，计算给定条件下通过孔口的流量，也就是它的过流能力。由于孔口沿流动方向的边界长度很短，一般来说，能量损失主要是局部水头损失，沿程损失通常可以忽略。

薄壁小孔口恒定自由出流
^^^^^^^^^^^^^^^^^^^^^^^^^^^

薄壁孔口指具有尖锐边缘的孔口，液体与孔壁只有周线上接触，孔壁厚度不影响射流形态；小孔口指作用于孔口断面上各点的水头可以近似认为与形心点上的水头相等；自由出流指液体经过孔口流入大气中。设孔口为圆形，其直径为 :math:`d` ，孔口断面面积为 :math:`A` ，如果以通过孔口中心的水平面为基准面，则上游从基准面算起的水深为孔口的水头 :math:`H` 。

当水股从孔口出流时，由于惯性作用，水流流线不能在孔口处急剧改变流动方向，而是保持一定的曲度，因此水股出孔口后存在收缩现象，并在离孔口约 :math:`d/2` 处水流逐渐收缩到最小面积，该处过流断面称为 **收缩断面** 。收缩断面之后，液体在重力作用下下落。设孔口断面面积为 :math:`A` ，收缩断面面积为 :math:`A_{c}` ，则

.. math::
	\begin{align}
	\frac{A_{c}}{A} = \varepsilon < 1.0
	\end{align}

其中 :math:`\varepsilon` 称为 **收缩系数** 。对于薄壁圆形小孔口可以取 :math:`\varepsilon = 0.62` 。收缩断面处的流线可以认为是平行直线，所以该处为渐变流动。由于水股周围都是大气，收缩断面上各点压强可以认为等于大气压强。

为了推导孔口出流的基本公式，选取通过孔口形心的水平面为基准面，取过流断面1-1以及收缩断面c-c为控制断面列能量方程。假设收缩断面的平均流速为 :math:`v_{c}` ，则能量方程可以写为

.. math::
	\begin{align}
	H + \frac{\alpha_{0}v_{0}^{2}}{2g} = \frac{\alpha_{c}v_{c}^{2}}{2g} + h_{w}
	\end{align}

其中 :math:`h_{w}` 为过流断面1-1到c-c的水头损失。如果不计沿程水头损失，则有 :math:`h_{w} = h_{j} = \zeta_{c}\frac{v_{c}^{2}}{2g}` ，令作用水头 :math:`H_{0} = H + \frac{\alpha_{0}v_{0}^{2}}{2g}` ，代入上式，整理得到收缩断面流速

.. math::
	\begin{align}
	v_{c} = \frac{1}{\sqrt{\alpha_{c} + \zeta_{c}}}\sqrt{2gH_{0}} = \phi \sqrt{2gH_{0}}
	\end{align}

其中 :math:`\zeta_{c}` 为孔口局部阻力系数。如果 :math:`v_{0} \approx 0` ，则 :math:`H_{0} = H` 。 :math:`\phi = \frac{1}{\sqrt{\alpha_{c} + \zeta_{c}}}` 称为 **流速系数** ，为收缩断面实际流速 :math:`v_{c}` 与理想流体流速 :math:`\sqrt{2gH_{0}}` 之比。

.. note:: 实验研究表明，在大雷诺数情况下，薄壁圆形孔口的 :math:`\phi \approx 0.97` ，相应的局部阻力系数 :math:`\zeta_{c} = 0.06` 。

通过薄壁小孔口自由出流的流量为

.. math::
	\begin{align}
	Q = v_{c}A_{c} = \phi \varepsilon A \sqrt{2gH_{0}} = \mu A \sqrt{2gH_{0}}
	\end{align}

其中 :math:`\mu = \phi \varepsilon` 称为 **流量系数** 。上式即为孔口出流的基本关系式，它表明孔口的过流能力与作用在孔口上的水头 :math:`H_{0}` 的平方根成正比。

水股在流出孔口后有收缩现象，水股的收缩条件对孔口出流流量具有重要的影响。影响流股收缩的因素主要是孔口边缘的情况、孔口形状以及孔口在壁面上的位置。薄壁孔口的收缩系数最小，圆边孔口收缩系数较大，有时甚至等于 :math:`1` 。对于小孔口，实验证明孔口形状对流量系数 :math:`\mu` 的影响是微小的。因此，薄壁小孔口的流量系数 :math:`\mu` 主要取决于孔口在壁面上的位置。

当孔口离容器的其他各个壁面边界具有一定距离时，水股在四周各方向上均能发生收缩，称这种收缩为 **全部收缩** ；否则称为 **不全部收缩** 。全部收缩又可以进一步分类：当孔口离容器的其他各个壁面的距离足够大以后，水股在四周各方向上可以充分地收缩，收缩系数 :math:`\varepsilon` 和孔口离容器的其他各个壁面的距离无关，称这种收缩为 **完善收缩** ，否增称为 **不完善收缩** 。

对于不全部收缩孔口，其出流流束沿侧壁和底部的部分周界不发生收缩，使 :math:`\varepsilon` 增大，相应的 :math:`\mu` 值也将增大，可以按照下式计算

.. math::
	\begin{align}
	\mu' = \mu \Big( 1 + c\frac{S}{\chi} \Big)
	\end{align}

其中 :math:`\mu` 为全部收缩时的孔口流量系数； :math:`c` 为一系数，对于圆孔取 :math:`0.13` ，对于方孔取 :math:`0.15` ； :math:`S` 为未收缩部分的周长； :math:`\chi` 为孔口的全部周长。

全部收缩中，对于不完善收缩的孔口，由于有的孔边离侧壁的距离小于孔口边长的3倍，其相应边流束的收缩受侧壁的影响而减弱，使 :math:`\varepsilon` 增大，相应的 :math:`\mu` 值也将增大，可以按照下式计算

.. math::
	\begin{align}
	\mu'' = \mu \Big[ 1 + 0.64\Big(\frac{A}{A_{0}}\Big)^{2} \Big]
	\end{align}

其中 :math:`\mu` 为全部完善收缩时的孔口流量系数，对于薄壁圆形小孔口 :math:`\mu = \phi \varepsilon = 0.97 \times (0.62 \sim 0.64) = 0.60 \sim 0.62` ； :math:`A` 为孔口面积； :math:`A_{0}` 为孔口所在壁面的有水部分面积。


薄壁孔口恒定淹没出流
^^^^^^^^^^^^^^^^^^^^^^^

水通过孔口直接流入另一部分水体中，称为 **淹没出流** 。出流水股倍下游水位淹没以后，不同于自由出流的只是收缩断面c-c的压强不再是大气压强，而近似地等于下游水深所形成的静水压强。所以淹没后收缩断面的压强可以按照静水压强分布考虑。对于淹没出流，作用于孔口断面上各点的水头差均相等，因此不论是小孔口还是大孔口出流，其计算方法相同。

对过流断面1-1、2-2列能量方程得到

.. math::
	\begin{align}
	H_{1} + \frac{\alpha_{0}v_{0}^{2}}{2g} = H_{2} + \frac{\alpha_{2}v_{2}^{2}}{2g} + h_{j}
	\end{align}

其中 :math:`H_{1} - H_{2} = z` 为上、下游水面差； :math:`h_{j}` 为局部损失，包括水流经孔口的局部水头损失和经收缩断面后突然扩大的局部水头损失两项，即

.. math::
	\begin{align}
	h_{j} = (\zeta_{1} + \zeta_{2})\frac{v_{c}^{2}}{2g}
	\end{align}

其中 :math:`\zeta_{1}` 为孔口局部水头损失系数，与自由出流相同； :math:`\zeta_{2}` 为水流通过收缩断面突然扩大的局部阻力系数。考虑到断面2-2面积 :math:`A_{2} \gg A_{2}` ，所以 :math:`\zeta_{2} \approx 1.0` ，从而收缩断面的流速和流量分别为

.. math::
	\begin{align}
	v_{c} = \frac{\sqrt{2gz_{0}}}{\sqrt{1 + \zeta_{1}}} = \phi \sqrt{2gz_{0}}
	\end{align}

.. math::
	\begin{align}
	Q = A_{c}v_{c} = \varepsilon \phi A \sqrt{2gz_{0}} = \mu A \sqrt{2gz_{0}}
	\end{align}

其中 :math:`z_{0} = z + \frac{\alpha_{0}v_{0}^{2}}{2g} - \frac{\alpha_{2}v_{2}^{2}}{2g}` 。

.. note:: 

	比较淹没出流公式和自由出流公式可以发现，两式的形式相同，各项系数值也想通，但是作用水头不一样。自由出流的作用水头是以过收缩断面形心点的水平面为基准的上游总水头，而淹没出流时的作用水头为上、下游两断面总水头的差值，如果忽略两断面的流速水头，则作用水头为上、下游水面高差。

在工程实际中经常遇到气体经孔口流入大气的流动问题，这是一种典型的淹没孔口出流。在气体孔口出流计算中，常以压强差代替水头差，并且将流量表达式改写成如下形式

.. math::
	\begin{align}
	Q = \mu A \sqrt{\frac{2\Delta p_{0}}{\rho}}
	\end{align}

其中 :math:`\rho` 为气体的密度； :math:`\Delta p_{0}` 为孔口前后气体的全压差

.. math::
	\begin{align}
	\Delta p_{0} = (p_{1} - p_{2}) + \frac{\rho (\alpha_{1}v_{1}^{2} - \alpha_{2}v_{2}^{2})}{2}~\mathrm{N/m^{2}}
	\end{align}


管嘴出流
------------

水流通过短管在出口断面满管出流的现象称为 **管嘴出流** 。管嘴出流虽然有沿程损失，但是与局部损失相比相对较小，可以忽略不计，因此水头损失仍然只计局部损失。

流体经圆柱形管嘴或圆锥形管嘴流出时，由于液体的惯性作用，在管嘴内形成收缩断面，然后扩大并充满管嘴全断面流出。在收缩断面处，液流与管壁脱离形成环状真空区，由于该真空区的存在，对来流产生抽吸作用，从而提高了管嘴的过流能力。这也是管嘴出流与孔口出流的不同之处。

圆柱形外管嘴自由出流
^^^^^^^^^^^^^^^^^^^^^^^^^

在管嘴上游的开口容器中，取流线接近平行的断面1-1和管嘴出口断面2-2.以管嘴中心线所在的平面为基准面，对过流断面1-1、2-2写能量方程，得到

.. math::
	\begin{align}
	H + \frac{\alpha_{0}v_{0}^{2}}{2g} = \frac{\alpha_{2}v_{2}^{2}}{2g} + h_{w1-2}
	\end{align}

其中 :math:`h_{w1-2} = h_{j} = \zeta_{n}\frac{v_{n}^{2}}{2g}` ，令 :math:`H_{0} = H + \frac{\alpha_{0}v_{0}^{2}}{2g}` ，代入上式，整理得到管嘴出流流速

.. math::
	\begin{align}
	v_{2} = \frac{1}{\sqrt{\alpha_{2} + \zeta_{n}}}\sqrt{2gH_{0}} = \phi_{n}\sqrt{2gH_{0}}
	\end{align}

其中 :math:`\zeta_{n}` 为管嘴局部水头损失系数，相当于管道直角进口的局部损失系数； :math:`H_{0}` 为作用水头，如果 :math:`v_{0} \approx 0` 则 :math:`H_{0} \approx H` ；管嘴的流速系数为

.. math::
	\begin{align}
	\phi_{n} = \frac{1}{\sqrt{\alpha_{2} + \zeta_{n}}}
	\end{align}

通过管嘴的流量为

.. math::
	\begin{align}
	Q = v_{2}A = \phi_{n}A \sqrt{2gH_{0}} = \mu_{n}A\sqrt{2gH_{0}}
	\end{align}

上式在形式上与孔口出流的计算公式相同。因为管嘴为满管出流，出流水股基本上不发生收缩，所以流量系数 :math:`\mu_{n} = \phi_{n}` 。对于管道的锐缘进口 :math:`\zeta_{n} = 0.5` ，以它作为管嘴的局部水头损失系数，取 :math:`\alpha_{2}=1` ，则 :math:`\phi_{n}=\mu_{n} \approx 0.82 = 1.32\mu` 。因此，与孔口出流相比，在同一水头作用下，具有同样过流断面面积的管嘴比薄壁圆形孔口的过流能力大 :math:`32\%` 。

在孔口外加一管嘴，增加了水头损失，但泄流能力反而增加，这时由于收缩断面处真空作用的结果。对收缩断面c-c和出口断面2-2写能量方程

.. math::
	\begin{align}
	\frac{p_{c}}{\rho g} + \frac{\alpha_{c}v_{c}^{2}}{2g} = \frac{p_{a}}{\rho g} +\frac{\alpha_{2}v_{2}^{2}}{2g} + \zeta_{m}\frac{v_{2}^{2}}{2g} 
	\end{align}

其中 :math:`v_{c} = \frac{A}{A_{c}}v_{2} = \frac{1}{\varepsilon}v_{2}` 。局部水头损失主要发生在主流扩大上，由突扩局部水头损失系数表达式得到

.. math::
	\begin{align}
	\zeta_{m} = \Big(\frac{A}{A_{c}} - 1\Big)^{2} = \Big(\frac{1}{\varepsilon} - 1\Big)^{2}
	\end{align}

代入能量方程得到c-c断面真空度

.. math::
	\begin{align}
	h_{v} = \frac{p_{a} - p_{c}}{\rho g}
	= \Big[ \frac{\alpha_{c}}{\varepsilon^{2}} - \alpha - \Big(\frac{1}{\varepsilon} - 1\Big)^{2} \Big]\frac{v_{2}^{2}}{2g}
	= \Big[ \frac{\alpha_{c}}{\varepsilon^{2}} - \alpha - \Big(\frac{1}{\varepsilon} - 1\Big)^{2} \Big]\phi_{n}^{2}H_{0}
	\end{align}

将系数 :math:`\alpha_{c} = \alpha = 1` ， :math:`\varepsilon = 0.64` ， :math:`\phi_{n} = 0.82` 代入上式，得到收缩断面真空度为

.. math::
	\begin{align}
	h_{v} \approx 0.75H_{0}
	\end{align}

管嘴出流与孔口自由出流相比较，可以发现孔口自由出流的收缩断面在大气中，二管嘴出流的收缩断面为真空区，真空度达作用水头的 :math:`0.75` 倍，相当于把孔口出流的作用水头加大 :math:`75\%` ，这正是圆柱形外管嘴的流量比孔口自由出流的流量大的原因。

圆柱形外管嘴淹没出流
^^^^^^^^^^^^^^^^^^^^^^^^

如果管嘴被下游水位所淹没，液体经圆柱形外管淹没出流，对过流断面1-1、2-2写能量方程，类似于前面的分析可以得到管嘴淹没出流的流速和流量分别为

.. math::
	\begin{align}
	& v = \phi\sqrt{2gz_{0}} \\
	& Q = \mu A \sqrt{2gz_{0}}
	\end{align}

其中

.. math::
	\begin{align}
	z_{0} = H_{1} + \frac{\alpha_{0}v_{0}^{2}}{2g} - \Big( H_{2} + \frac{\alpha_{2}v_{2}^{2}}{2g} \Big)
	= z + \Big( \frac{\alpha_{0}v_{0}^{2}}{2g} - \frac{\alpha_{2}v_{2}^{2}}{2g} \Big)
	\end{align}

表示上、下游水头差；流速系数 :math:`\phi` 及流量系数 :math:`\mu` 的数值均同于管嘴自由出流。淹没出流时管嘴内收缩断面形心处的真空度为

.. math::
	\begin{align}
	h_{v} = \frac{p_{v}}{\rho g} \approx 0.75z_{0} - \Big( H_{2} + \frac{\alpha_{2}v_{2}^{2}}{2g} \Big)
	\end{align}

因此，如果管嘴被下游水位所淹没，则和孔口淹没出流一样，作用水头不是 :math:`H_{0}` 而是 :math:`z_{0}` 。

类似于上述推导，可以得到气体经管嘴流入大气的流量公式为

.. math::
	\begin{align}
	Q = \mu A \sqrt{2\Delta p_{0} / \rho}
	\end{align}

其中 :math:`\Delta p_{0}` 为管嘴前后气体的全压差； :math:`\rho` 为气体的密度。



孔口、管嘴变水头出流
-------------------------

在孔口或管嘴出流过程中，如果作用水头随时间变化，则出流流量也将随时间而变化，这时的孔口或管嘴出流为非恒定出流，又称变水头孔口或管嘴出流。工程实践中，非恒定孔口或管嘴出流所要解决的主要问题是如何确定容器充水或泄水所要的时间等。这里我们讨论的问题只限于容器中液面高度变化缓慢的准恒定情形，即在每一微小时段内可以近似认为液面高度不变，因而可以忽略惯性力的影响，采用恒定孔口出流的基本公式。

现在以截面积为 :math:`\Omega` 的柱形容器，水经过孔口变水头自由出流为例，假设孔口出流过程中，某时刻容器中水面高度为 :math:`h` ，在微小时段 :math:`\mathrm{d}t` 内，孔口流出水的体积

.. math::
	\begin{align}
	\mathrm{d}V = Q\mathrm{d}t = \mu A \sqrt{2gh} \mathrm{d}t
	\end{align}

这个体积应该等于该时刻水面下降 :math:`\mathrm{d}h` 容器减少的体积

.. math::
	\begin{align}
	\mathrm{d}V = -\Omega \mathrm{d}h
	\end{align}

由此得到

.. math::
	\begin{align}
	\mu A \sqrt{2gh}\mathrm{d}t = -\Omega\mathrm{d}h
	\quad\Rightarrow\quad
	\mathrm{d}t = -\frac{\Omega}{\mu A \sqrt{2gh}}\mathrm{d}h
	\end{align}

设在 :math:`t=0,t=T` 时刻容器内的水头分别为 :math:`H_{1},H_{2}` ，对上式进行积分可以得到

.. math::
	\begin{align}
	T = \int_{0}^{T}\mathrm{d}t
	= \int_{H_{1}}^{H_{2}} - \frac{\Omega}{\mu A \sqrt{2gh}}\mathrm{d}h
	= \frac{2\Omega}{\mu A \sqrt{2g}}(\sqrt{H_{1}} - \sqrt{H_{2}})
	\end{align}

令 :math:`H_{2}=0` ，即得到容器的放空时间

.. math::
	\begin{align}
	T_{0} = \frac{2\Omega \sqrt{H_{1}}}{\mu A \sqrt{2g}} = \frac{2\Omega H_{1}}{\mu A \sqrt{2gH_{1}}} = \frac{2V}{Q_{\max}}
	\end{align}

其中 :math:`V` 为容器放空的体积； :math:`Q_{\max}` 为起始时刻的最大流量。上式表明，变水头出流容器的放空时间，等于在起始水头 :math:`H_{1}` 作用下按照恒定情况流出同体积水所需时间的2倍。

.. note:: 如果容器侧壁上不是孔口，而是其他类型的管嘴或短管，上述各项计算公式仍然适用，只是流量系数不同而已。





