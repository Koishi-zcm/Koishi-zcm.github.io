<!DOCTYPE html>
<html class="writer-html4" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>计算流体力学有限体积法 &mdash; MyKnowledge MyKnowledge 文档</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="AutoCAD" href="AutoCAD.html" />
    <link rel="prev" title="稀薄气体动力学" href="稀薄气体动力学.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MyKnowledge
          </a>
              <div class="version">
                1.01
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="微积分.html">微积分</a></li>
<li class="toctree-l1"><a class="reference internal" href="线性代数.html">线性代数</a></li>
<li class="toctree-l1"><a class="reference internal" href="复变函数.html">复变函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="电路原理.html">电路原理</a></li>
<li class="toctree-l1"><a class="reference internal" href="数字电路.html">数字电路</a></li>
<li class="toctree-l1"><a class="reference internal" href="模拟电路.html">模拟电路</a></li>
<li class="toctree-l1"><a class="reference internal" href="数值分析与算法.html">数值分析与算法</a></li>
<li class="toctree-l1"><a class="reference internal" href="数理方程.html">数理方程</a></li>
<li class="toctree-l1"><a class="reference internal" href="流体力学.html">流体力学</a></li>
<li class="toctree-l1"><a class="reference internal" href="稀薄气体动力学.html">稀薄气体动力学</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">计算流体力学有限体积法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">扩散项的空间离散</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">在矩形计算域的二维扩散项</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">对离散方程的评价</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">零和规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">反号规则</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id7">边界条件</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dirichlet">Dirichlet边界条件</a></li>
<li class="toctree-l4"><a class="reference internal" href="#neumann">Neumann边界条件</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">混合边界条件</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">对称边界条件</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">界面扩散系数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">非笛卡尔正交网格</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">非正交非结构化网格</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id13">非正交性</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">最小修正法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">正交修正法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">过松弛法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17">梯度计算</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">非正交网格的线性方程</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id19">偏斜度</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">各向异性扩散</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">迭代解过程的欠松弛</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id22">梯度计算</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id23">笛卡尔网格中的梯度计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#green-gauss">Green-Gauss梯度</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#compact-stencil">Compact Stencil</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extended-stencil">Extended Stencil</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id24">最小二乘法梯度</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">将梯度插值到网格面</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id26">对流项的离散化</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id27">一维稳态对流扩散</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id28">解析解</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29">数值解</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id30">中心差分格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id31">一阶迎风格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id32">顺风格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id33">二阶迎风格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quick">QUICK格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fromm">FROMM格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flux-vector-splitting-methods">Flux Vector Splitting Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">数值稳定性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">均匀网格与非均匀网格的函数关系</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id36">稳态二维对流</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#notions-on-numerical-methods">Notions on Numerical Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selected-difference-schemes">Selected Difference Schemes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-first-order-upwind-scheme">The First Order Upwind Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lax-friedrichs-scheme">Lax-Friedrichs Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lax-wendroff-scheme">Lax-Wendroff Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#warming-beam-scheme">Warming-Beam Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fromm-scheme">Fromm Scheme</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#conservative-methods">Conservative Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#basic-definitions">Basic Definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#godunov-s-first-order-upwind-method">Godunov’s First-Order Upwind Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#godunov-s-method-for-burgers-s-equation">Godunov’s Method for Burgers’s Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conservative-form-of-difference-schemes">Conservative Form of Difference Schemes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#upwind-schemes-for-linear-systems">Upwind Schemes for Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-cir-scheme">The CIR Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#godunov-s-method">Godunov’s Method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-method-of-godunov-for-non-linear-systems">The Method of Godunov for Non-linear Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bases-of-godunov-s-method">Bases of Godunov’s Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-godunov-scheme">The Godunov Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#godunov-s-method-for-the-euler-equations">Godunov’s Method for the Euler Equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#evaluation-of-the-intercell-fluxes">Evaluation of the Intercell Fluxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-step-size">Time Step Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37">Boundary Conditions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#random-choice-and-related-methods">Random Choice and Related Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rcm-on-a-non-staggered-grid">RCM on a Non-Staggered Grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-scheme-for-non-linear-systems">The Scheme for Non-Linear Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#boundary-conditions-and-the-time-step-size">Boundary Conditions and the Time Step Size</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#a-random-choice-scheme-of-the-lax-friedrichs-type">A Random Choice Scheme of the Lax-Friedrichs Type</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#review-of-the-lax-friedrichs-scheme">Review of the Lax-Friedrichs Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-scheme">The Scheme</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-rcm-on-a-staggered-grid">The RCM on a Staggered Grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id38">The Scheme for Non-Linear Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-deterministic-first-order-centred-scheme-force">A Deterministic First-Order Centred Scheme (FORCE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#analysis-of-the-force-scheme">Analysis of the FORCE Scheme</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#random-numbers">Random Numbers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#van-der-corput-pseudo-random-numbers">Van der Corput Pseudo-Random Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#statistical-properties">Statistical Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#propagation-of-a-single-shock">Propagation of a Single Shock</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id39">Flux Vector Splitting Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-flux-vector-splitting-approach">The Flux Vector Splitting Approach</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#upwind-differencing">Upwind Differencing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-fvs-approach">The FVS Approach</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fvs-for-the-isothermal-equations">FVS for the Isothermal Equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#split-fluxes">Split Fluxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fvs-numerical-schemes">FVS Numerical Schemes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fvs-applied-to-the-euler-equations">FVS Applied to the Euler Equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#recalling-the-equations">Recalling the Equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-steger-warming-splitting">The Steger-Warming Splitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-van-leer-splitting">The van Leer Splitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advection-upstream-splitting-method-ausm">Advection Upstream Splitting Method (AUSM)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#approximate-state-riemann-solvers">Approximate-State Riemann Solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-riemann-problem-and-the-godunov-flux">The Riemann Problem and the Godunov Flux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tangential-velocity-components">Tangential Velocity Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sonic-rarefactions">Sonic Rarefactions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#primitive-variable-riemann-solvers-pvrs">Primitive Variable Riemann Solvers (PVRS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#approximations-based-on-the-exact-solver">Approximations Based on the Exact Solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-two-rarefaction-riemann-solver-trrs">A Two-Rarefaction Riemann Solver (TRRS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-two-shock-riemann-solver-tsrs">A Two-Shock Riemann Solver (TSRS)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#adaptive-riemann-solvers">Adaptive Riemann Solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#an-adaptive-iterative-riemann-solver-airs">An Adaptive Iterative Riemann Solver (AIRS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#an-adaptive-noniterative-riemann-solver-anrs">An Adaptive Noniterative Riemann Solver (ANRS)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-hll-and-hllc-riemann-solvers">The HLL and HLLC Riemann Solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-riemann-problem">The Riemann Problem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-godunov-flux">The Godunov Flux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#integral-relations">Integral Relations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-hll-approximate-riemann-solver">The HLL Approximate Riemann Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-hllc-approximate-riemann-solver">The HLLC Approximate Riemann Solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#useful-relations">Useful Relations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-hllc-flux-for-the-euler-equations">The HLLC Flux for the Euler Equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multidimensional-and-multicomponent-flow">Multidimensional and Multicomponent Flow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wave-speed-estimates">Wave-Speed Estimates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#direct-wave-speed-estimates">Direct Wave Speed Estimates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pressure-based-wave-speed-estimates">Pressure-Based Wave Speed Estimates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#contact-waves-and-passive-scalars">Contact Waves and Passive Scalars</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-riemann-solver-of-roe">The Riemann Solver of Roe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bases-of-the-roe-approach">Bases of the Roe Approach</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-exact-riemann-problem-and-the-godunov-flux">The Exact Riemann Problem and the Godunov Flux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#approximate-conservation-laws">Approximate Conservation Laws</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-approximate-riemann-problem-and-the-intercell-flux">The Approximate Riemann Problem and the Intercell Flux</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-original-roe-method">The Original Roe Method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-isothermal-equations">The Isothermal Equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-euler-equations">The Euler Equations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-roe-pike-method">The Roe-Pike Method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-approach">The Approach</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id40">The Isothermal Equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id43">The Euler Equations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#an-entropy-fix">An Entropy Fix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-entropy-problem">The Entropy Problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-harten-hymann-entropy-fix">The Harten-Hymann Entropy Fix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-star-region-speeds">The Star Region Speeds</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-riemann-solver-of-osher">The Riemann Solver of Osher</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#osher-s-scheme-for-a-general-system">Osher’s Scheme for a General System</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mathematical-bases">Mathematical Bases</a></li>
<li class="toctree-l4"><a class="reference internal" href="#osher-s-numerical-flux">Osher’s Numerical Flux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#osher-s-flux-for-the-single-wave-case">Osher’s Flux for the Single-Wave Case</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ausm-family-schemes">AUSM family schemes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ausm-formulation">AUSM formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ausm-scheme">AUSM+ scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ausm-up-scheme">AUSM+up scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#higher-order-extension">Higher-order extension</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#high-order-and-tvd-methods-for-scalar-equations">High-Order and TVD Methods for Scalar Equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-properties-of-selected-schemes">Basic Properties of Selected Schemes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#selected-schemes">Selected Schemes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accuracy">Accuracy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stability">Stability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#waf-type-high-order-schemes">WAF-Type High Order Schemes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-basic-waf-scheme">The Basic WAF Scheme</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#high-order-and-tvd-schemes-for-non-linear-systems">High-Order and TVD Schemes for Non-Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="#splitting-schemes-for-pdes-with-source-terms">Splitting Schemes for PDEs with Source Terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#methods-for-multi-dimensional-pdes">Methods for Multi-Dimensional PDEs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dimensional-splitting">Dimensional Splitting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lower-upper-symmetric-gauss-seidel-implicit-scheme-lu-sgs">Lower-Upper Symmetric Gauss-Seidel Implicit Scheme (LU-SGS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#temporal-discretization">Temporal Discretization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#explicit-time-stepping-schemes">Explicit Time-Stepping Schemes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#multistage-schemes-runge-kutta">Multistage Schemes (Runge-Kutta)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hybrid-multistage-schemes">Hybrid multistage schemes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#treatment-of-the-source-term">Treatment of the source term</a></li>
<li class="toctree-l4"><a class="reference internal" href="#determination-of-the-maximum-time-step">Determination of the maximum time step</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#implicit-time-stepping-schemes">Implicit Time-Stepping Schemes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#matrix-form-of-the-implicit-operator">Matrix form of the implicit operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#evaluation-of-the-flux-jacobian">Evaluation of the flux Jacobian</a></li>
<li class="toctree-l4"><a class="reference internal" href="#alternating-direction-implicit-scheme">Alternating direction implicit scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lower-upper-symmetric-gauss-seidel-scheme">Lower-Upper symmetric Gauss-Seidel Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#newton-krylov-method">Newton-Krylov method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#unified-gas-kinetic-scheme-ugks">Unified Gas-Kinetic Scheme (UGKS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kinetic-theory-and-discrete-ordinate-method">Kinetic theory and discrete ordinate method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unified-kinetic-scheme-for-all-flow-regimes">Unified kinetic scheme for all flow regimes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#determination-of-time-step">Determination of time step</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prandtl-number-fix">Prandtl number fix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="AutoCAD.html">AutoCAD</a></li>
<li class="toctree-l1"><a class="reference internal" href="C++.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="Latex.html">Latex</a></li>
<li class="toctree-l1"><a class="reference internal" href="Linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenFOAM.html">OpenFOAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenFOAM算例运行案例.html">OpenFOAM算例运行案例</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Salome.html">Salome</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solidworks.html">Solidworks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MyKnowledge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">计算流体力学有限体积法</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/demo/计算流体力学有限体积法.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="id1">
<h1>计算流体力学有限体积法<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<div class="section" id="id2">
<h2>扩散项的空间离散<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<div class="section" id="id3">
<h3>在矩形计算域的二维扩散项<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>如图所示的是一个由规则笛卡尔网格划分的简单矩形计算域，在这个计算域中将要离散下面这个稳定态扩散方程：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
- \nabla \cdot (\Gamma^{\phi} \nabla\phi) = Q^{\phi}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\phi\)</span> 表示一个标量变量（例如温度、质量分数、湍流动能等等）， <span class="math notranslate nohighlight">\(Q^{\phi}\)</span> 表示计算域中单位体积 <span class="math notranslate nohighlight">\(\phi\)</span> 的产生量， <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 表示扩散系数。</p>
<div class="figure align-center">
<img alt="../_images/二维均一笛卡尔网格.png" src="../_images/二维均一笛卡尔网格.png" />
</div>
<p>根据散度项的Gauss法离散，上面的方程可以离散为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\sum_{f\sim nb(C)} (-\Gamma^{\phi}\nabla\phi)_{f} \cdot\mathbf{S}_{f} = Q_{C}^{\phi} V_{C}
\end{align}\]</div>
<p>对于如图所示的网格，上式可以展开写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(- \Gamma^{\phi} \nabla\phi)_{e} \cdot \mathbf{S}_{e}
+ (- \Gamma^{\phi} \nabla\phi)_{w} \cdot \mathbf{S}_{w}
+ (- \Gamma^{\phi} \nabla\phi)_{n} \cdot \mathbf{S}_{n}
+ (- \Gamma^{\phi} \nabla\phi)_{s} \cdot \mathbf{S}_{s}
= Q_{C}^{\phi}V_{C}
\end{align}\]</div>
<p>对于如图所示的均一笛卡尔网格，网格面法向量可以如下表示</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{S}_{e} = + (\Delta y)_{e} \mathbf{i} = \| \mathbf{S}_{e} \| \mathbf{i} = S_{e}\mathbf{i},
&amp;&amp; \mathbf{S}_{w} = - (\Delta y)_{w} \mathbf{i} = - \| \mathbf{S}_{w} \| \mathbf{i} = -S_{w}\mathbf{i}, \\
&amp; \mathbf{S}_{n} = + (\Delta x)_{n} \mathbf{j} = \| \mathbf{S}_{n} \| \mathbf{j} = S_{n}\mathbf{j},
&amp;&amp; \mathbf{S}_{s} = - (\Delta x)_{s} \mathbf{j} = - \| \mathbf{S}_{s} \| \mathbf{j} = -S_{s}\mathbf{j}
\end{align}\end{split}\]</div>
<p>于是，对于右边的网格面，其扩散通量为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
- (\Gamma^{\phi}\nabla \phi)_{e} \cdot \mathbf{S}_{e}
= - \Gamma_{e}^{\phi} \Big( \frac{\partial \phi}{\partial x}\mathbf{i} + \frac{\partial \phi}{\partial y}\mathbf{j} \Big) \cdot S_{e} \mathbf{i}
= - \Gamma_{e}^{\phi}(\Delta y)_{e} \Big(\frac{\partial \phi}{\partial x} \Big)_{e}
\end{align}\]</div>
<p>根据之前讨论的单积分点离散守恒方程的内容，扩散通量可以写成如下通用形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
-(\Gamma^{\phi}\nabla\phi)_{e}\cdot\mathbf{S}_{e}
= \text{FluxT}_{e} = \text{FluxC}_{e}\phi_{C} + \text{FluxF}_{e}\phi_{F} + \text{FluxV}_{e}
\end{align}\]</div>
<p>为了确定 <span class="math notranslate nohighlight">\(\text{FluxC}_{e},\text{FluxF}_{e},\text{FluxV}_{e}\)</span> 这三个系数，就需要取一个剖面利用相邻两个单元来计算梯度。假设 <span class="math notranslate nohighlight">\(\phi\)</span> 在网格形心中线性分布，那么在 <span class="math notranslate nohighlight">\(e\)</span> 面上沿着 <span class="math notranslate nohighlight">\(\mathbf{i}\)</span> 方向的梯度可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big(\frac{\partial \phi}{\partial x} \Big)_{e} = \frac{\phi_{E} - \phi_{C}}{(\delta x)_{e}}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\((\delta x)_{e}\)</span> 是待求网格形心点与右侧相邻网格形心点的距离。将上式代入到 <span class="math notranslate nohighlight">\(e\)</span> 面的扩散项离散方程，得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{FluxT}_{e} = - \Gamma^{\phi} (\Delta y)_{e} \frac{\phi_{E} - \phi_{C}}{\delta x_{e}} = \Gamma^{\phi}_{e} \frac{(\Delta y)_{e}}{\delta x_{e}}(\phi_{C} - \phi_{E})
\end{align}\]</div>
<p>额外引入一个符号进行简化，定义</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{gDiff}_{e} = \frac{(\Delta y)_{e}}{\delta x_{e}} = \frac{\| \mathbf{S}_{e} \|}{\| \mathbf{d}_{CE} \|} = \frac{S_{e}}{d_{CE}}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\mathbf{d}_{CE}\)</span> 是单元C和E形心之间的距离向量。于是， <span class="math notranslate nohighlight">\(e\)</span> 面扩散通量的通用形式的系数就确定为了</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{FluxC}_{e} = \Gamma_{e}^{\phi}\text{gDiff}_{e} ,\quad
\text{FluxF}_{e} = -\Gamma_{e}^{\phi}\text{gDiff}_{e} ,\quad
\text{FluxV}_{e} = 0
\end{align}\]</div>
<p>类似的操作也可以应用于 <span class="math notranslate nohighlight">\(w,n,s\)</span> 面上，然后就得到</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \text{FluxT}_{w} = \text{FluxC}_{w}\phi_{C} + \text{FluxF}_{w}\phi_{N} + \text{FluxV}_{w} \\
&amp; \text{FluxT}_{n} = \text{FluxC}_{n}\phi_{C} + \text{FluxF}_{n}\phi_{N} + \text{FluxV}_{n} \\
&amp; \text{FluxT}_{s} = \text{FluxC}_{s}\phi_{C} + \text{FluxF}_{s}\phi_{N} + \text{FluxV}_{s}
\end{align}\end{split}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \text{FluxC}_{w} = \Gamma_{w}^{\phi}\text{gDiff}_{w} ,\quad \text{FluxF}_{w} = -\Gamma_{w}^{\phi}\text{gDiff}_{w} ,\quad \text{FluxV}_{w} = 0 \\
&amp; \text{FluxC}_{n} = \Gamma_{n}^{\phi}\text{gDiff}_{n} ,\quad \text{FluxF}_{n} = -\Gamma_{n}^{\phi}\text{gDiff}_{n} ,\quad \text{FluxV}_{n} = 0 \\
&amp; \text{FluxC}_{s} = \Gamma_{s}^{\phi}\text{gDiff}_{s} ,\quad \text{FluxF}_{s} = -\Gamma_{s}^{\phi}\text{gDiff}_{s} ,\quad \text{FluxV}_{s} = 0 \\
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{gDiif}_{w} = \frac{\| \mathbf{S}_{w} \|}{\| \mathbf{d}_{CW} \|} = \frac{(\Delta x)_{w}}{\delta y_{w}} = \frac{S_{w}}{d_{CW}}
,\quad
\text{gDiif}_{n} = \frac{\| \mathbf{S}_{n} \|}{\| \mathbf{d}_{CN} \|} = \frac{(\Delta x)_{n}}{\delta y_{n}} = \frac{S_{n}}{d_{CN}}
,\quad
\text{gDiif}_{s} = \frac{\| \mathbf{S}_{s} \|}{\| \mathbf{d}_{CS} \|} = \frac{(\Delta x)_{s}}{\delta y_{s}} = \frac{S_{s}}{d_{CS}}
\end{align}\]</div>
<p>将上述离散结果全部代入到扩散方程，则可以表示成如下的线性方程：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + \sum_{F\sim NB(C)}a_{F}\phi_{F} = b_{C}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{C} = \sum_{f\sim nb(C)}\text{FluxC}_{f} \\
&amp; a_{F} = \text{FluxF}_{f} = -\Gamma^{\phi}_{f} \text{gDiff}_{f} \\
&amp; b_{C} = Q_{C}^{\phi}V_{C} - \sum_{f\sim nb(C)}\text{FluxV}_{f}
\end{align}\end{split}\]</div>
<p>这里的 <span class="math notranslate nohighlight">\(F\)</span> 表示与单元C相邻的单元(E,W,N,S)， <span class="math notranslate nohighlight">\(f\)</span> 表示单元C的相邻面(e,w,n,s)。</p>
</div>
<div class="section" id="id4">
<h3>对离散方程的评价<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>一个合适的离散方法应该得到一个能够反映原始守恒方程所有特性的线性方程。之前介绍了离散方法的一些特性，接下来继续说明离散方程系数必须满足的两条规则。</p>
<div class="section" id="id5">
<h4>零和规则<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h4>
<p>回顾离散流程，第一个主要估计产生于变量 <span class="math notranslate nohighlight">\(\phi\)</span> 在横跨单元表面的单元形心之间的插值。有人会问为什么使用一阶方法而不使用更高阶的方法。为了回答这个问题，可以考虑一个一维无源传导方程，在这些条件下离散方程简化为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} = 0
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{E} = -\Gamma_{e}^{\phi}\text{gDiff}_{e} ,\quad
a_{W} = -\Gamma_{w}^{\phi}\text{gDiff}_{w} ,\quad
a_{C} = -(a_{E} + a_{W})
\end{align}\]</div>
<p>在没有源项的情况下， <span class="math notranslate nohighlight">\(\phi\)</span> 的变化仅仅出现在扩散中，并且满足Fourier’s law（椭圆方程）。因此， <span class="math notranslate nohighlight">\(\phi_{e}\)</span> 或 <span class="math notranslate nohighlight">\(\phi_{w}\)</span> 的值应该分别处于 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 与 <span class="math notranslate nohighlight">\(\phi_{E}\)</span> 之间和 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 与 <span class="math notranslate nohighlight">\(\phi_{W}\)</span> 之间，而线性方法是一定能够保证这件事的。当采用二阶方法时，可能会导致插值到面上的值高于或低于网格形心上的值，这是不符合物理规律的。对于其他更高阶的方法也是如此。如果需要绝对保证合乎物理的结果，那么就应该使用线性方法。另外，当网格大小减小时所采用的离散方法就会变得没那么重要，因为所有估计在网格单元趋于零的时候都会取到一个相同的解析值。更进一步地，在不考虑任何源项的情况下，多维温度扩散方程化简为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
- \nabla \cdot (\Gamma^{\phi}\nabla\phi) = 0
\end{align}\]</div>
<p>上式表明 <span class="math notranslate nohighlight">\(\phi\)</span> 和 <span class="math notranslate nohighlight">\(\phi + \text{const}\)</span> 都是上面的扩散方程的解。一个一致的离散方法应该反映出这个特性，也就是说，离散方程应该满足</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\left.\begin{array}{c}
a_{C}\phi_{C} + \sum\limits_{F \sim NB(C)} a_{F}\phi_{F} = 0 \\
a_{C}(\phi_{C} + \text{const}) + \sum\limits_{F \sim NB(C)}a_{F}(\phi_{F} + \text{const}) = 0
\end{array}\right\} \Rightarrow
a_{C} + \sum_{F \sim NB(C)}a_{F} = 0
\end{align}\end{split}\]</div>
<p>上述方程可以进一步将系数的关系写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C} = -\sum_{F \sim NB(C)}a_{F}
\quad \text{or}\quad
\sum_{F\sim NB(C)}\frac{a_{F}}{a_{C}} = -1
\end{align}\]</div>
<p>因此， <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 可以被视为相邻量的加权和，并且在无源项的时候它总是由相邻的 <span class="math notranslate nohighlight">\(\phi_{F}\)</span> 值限制有界。而当有源项的时候， <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 不必以这种方式限制有界，也就可以高于相邻值，但是这是完全符合物理的。超出值将由源项 <span class="math notranslate nohighlight">\(S_{C}^{\phi}\)</span> 的模相对于相邻节点系数 <span class="math notranslate nohighlight">\(a_{F}\)</span> 的大小来决定。</p>
</div>
<div class="section" id="id6">
<h4>反号规则<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h4>
<p>上面的论述也同时说明了系数 <span class="math notranslate nohighlight">\(a_{C}\)</span> 和 <span class="math notranslate nohighlight">\(a_{F}\)</span> 是反号的。这具有重要的物理意义，它表明当 <span class="math notranslate nohighlight">\(\phi_{F}\)</span> 增大/减小时， <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的值应当随之增大/减小。这基本上与有界性有关，这表明满足这个性质的充分条件是相邻系数和主系数的符号相反。如果不是，那么有界性性质可能就不成立。</p>
</div>
</div>
<div class="section" id="id7">
<h3>边界条件<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>我们都知道任何常微分方程或偏微分方程的解析解都需要给定合适的边界条件才能确定其中的常数。因此，即使控制方程是一样的，使用不同的边界条件也会得到完全不同的结果。数值解也遵循同样的道理，数值解遵循相同的约束，需要正确和准确地实现边界条件，因为由数值近似引入的这些条件的任何微小变化都会导致所考虑问题的错误解。边界条件将与被离散化的项相关。对于传导/扩散问题，会遇到狄利克雷、诺伊曼、混合和对称边界条件类型，下面将详细介绍。</p>
<p>边界条件应用于边界元素，边界元素在边界上有一个或多个面。 <span class="math notranslate nohighlight">\(\phi\)</span> 的离散值存储在边界单元的中心处和边界面的中心处。设 <span class="math notranslate nohighlight">\(C\)</span> 为如图所示边界元的形心，边界面的形心记为 <span class="math notranslate nohighlight">\(b\)</span> ，边界面的面向量 <span class="math notranslate nohighlight">\(S_{b}\)</span> 指向向外。与前面一样，单元格 <span class="math notranslate nohighlight">\(C\)</span> 的离散化过程产生</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\sum_{f \sim nb(C)}(\mathbf{J}^{\phi,D} \cdot \mathbf{S})_{f} = Q_{C}^{\phi}V_{C}
\end{align}\]</div>
<p>对内面通量还是跟之前所述的那样进行离散，而对边界通量进行的离散则需要构造对 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的线性化，也即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{J}_{b}^{\phi,D} \cdot \mathbf{S}_{b} = \text{FluxT}_{b} = -\Gamma_{b}^{\phi}(\nabla \phi)_{b} \cdot \mathbf{S}_{b} = \text{FluxC}_{b}\phi_{C} + \text{FluxV}_{b}
\end{align}\]</div>
<p>边界条件的定义包括指定未知的边界值 <span class="math notranslate nohighlight">\(\phi_{b}\)</span> ，或者指定边界通量 <span class="math notranslate nohighlight">\(\mathbf{J}_{b}^{\phi,D}\)</span> 。这样就导出了不同边界条件类型的扩散问题在边界元处的离散方程。</p>
<div class="section" id="dirichlet">
<h4>Dirichlet边界条件<a class="headerlink" href="#dirichlet" title="永久链接至标题">¶</a></h4>
<p>Dirichlet边界条件就是一种直接指定 <span class="math notranslate nohighlight">\(\phi\)</span> 在边界上的值的条件，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{b} = \phi_{\text{specified}}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/扩散项Dirichlet边界条件.png" src="../_images/扩散项Dirichlet边界条件.png" />
</div>
<p>对于如图的情况，有</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{FluxT}_{b} = -\Gamma_{b}^{\phi}(\nabla \phi)_{b} \cdot \mathbf{S}_{b}
= - \Gamma_{b}^{\phi} \frac{\| \mathbf{S}_{b} \|}{\| \mathbf{d}_{Cb} \|}(\phi_{b} - \phi_{C})
= \text{FluxC}_{b}\phi_{C} + \text{FluxV}_{b}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \text{FluxC}_{b} = \Gamma_{b}^{\phi}\text{gDiff}_{b} \\
&amp; \text{FluxV}_{b} = -\Gamma_{b}^{\phi}\text{gDiff}_{b}\phi_{b} \\
&amp; \text{gDiff}_{b} = \frac{S_{b}}{d_{Cb}}
\end{align}\end{split}\]</div>
<p>因此对于图中所示的 <span class="math notranslate nohighlight">\(C\)</span> 单元，系数 <span class="math notranslate nohighlight">\(a_{E}\)</span> 为零，离散方程化简为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{W}\phi_{W} + a_{N}\phi_{N} + a_{S}\phi_{S} = b_{C}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = 0 \\
&amp; a_{W} = \text{FluxF}_{w} = -\Gamma_{w}^{\phi}\text{gDiff}_{w} \\
&amp; a_{N} = \text{FluxF}_{n} = -\Gamma_{n}^{\phi}\text{gDiff}_{n} \\
&amp; a_{S} = \text{FluxF}_{s} = -\Gamma_{s}^{\phi}\text{gDiff}_{s} \\
&amp; a_{C} = \text{FluxC}_{b} + \sum_{f \sim nb(C)}\text{FluxC}_{f} = \text{FluxC}_{b} + (\text{FluxC}_{w} + \text{FluxC}_{n} + \text{FluxC}_{s}) \\
&amp; b_{C} = Q_{C}^{\phi}V_{C} - \Big( \text{FluxV}_{b} + \sum_{f \sim nb(C)}\text{FluxV}_{f} \Big)
\end{align}\end{split}\]</div>
<p>从上面的离散方程中可以看到如下的特点：</p>
<ol class="arabic simple">
<li>系数 <span class="math notranslate nohighlight">\(\text{FluxC}_{b}\)</span> 要比其他相邻系数更大，因为 <span class="math notranslate nohighlight">\(b\)</span> 更靠近 <span class="math notranslate nohighlight">\(C\)</span> 形心，也因此对 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 有更重要的影响。</li>
<li>系数 <span class="math notranslate nohighlight">\(a_{C}\)</span> 仍然是所有相邻系数的和（包括 <span class="math notranslate nohighlight">\(\text{FluxC}_{b}\)</span> ）。这意味着对于边界处的单元有 <span class="math notranslate nohighlight">\(\sum\limits_{F \sim NB(C)}|a_{F}|/|a_{C}| &lt; 1\)</span> ，给出了满足Scarborough判据的第二个必要条件，从而保证了线性方程组在任意一次迭代中的收敛性。</li>
<li><span class="math notranslate nohighlight">\(\text{FluxV}_{b}\)</span> 现在位于方程右手边，也就是 <span class="math notranslate nohighlight">\(b_{C}\)</span> 的一部分，因为它不包含任何未知数。</li>
</ol>
</div>
<div class="section" id="neumann">
<h4>Neumann边界条件<a class="headerlink" href="#neumann" title="永久链接至标题">¶</a></h4>
<p>如果在边界处指定了 <span class="math notranslate nohighlight">\(\phi\)</span> 的通量(或表面的法线梯度)则称为Neumann边界条件。在这种情况下，指定的通量满足</p>
<div class="math notranslate nohighlight">
\[\begin{align}
- (\Gamma^{\phi}\nabla\phi)_{b} \cdot \mathbf{i} = q_{b}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/扩散项Neumann边界条件.png" src="../_images/扩散项Neumann边界条件.png" />
</div>
<p>可以进一步表示成与扩散通量有关，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{J}_{b}^{\phi,D} \cdot \mathbf{S}_{b}
= - (\Gamma^{\phi}\nabla\phi)_{b} \cdot \| \mathbf{S}_{b} \| \mathbf{i}
= \text{FluxC}_{b}\phi_{C} + \text{FluxV}_{b}
= q_{b} \| \mathbf{S}_{b} \|
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \text{FluxC}_{b} = 0 \\
&amp; \text{FluxV}_{b} = q_{b}S_{b} = q_{b}(\Delta y)_{C}
\end{align}\end{split}\]</div>
<p>这里假设通量分量是正的，当它们的作用方向与所使用的坐标系相同。因此， <span class="math notranslate nohighlight">\(q_{b}\)</span> 将直接放入边界单元 <span class="math notranslate nohighlight">\(C\)</span> 的离散方程当中：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{W}\phi_{W} + a_{N}\phi_{N} + a_{S}\phi_{S} = b_{C}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = 0 \\
&amp; a_{W} = \text{FluxF}_{w} = -\Gamma_{w}^{\phi}\text{gDiff}_{w} \\
&amp; a_{N} = \text{FluxF}_{n} = -\Gamma_{n}^{\phi}\text{gDiff}_{n} \\
&amp; a_{S} = \text{FluxF}_{s} = -\Gamma_{s}^{\phi}\text{gDiff}_{s} \\
&amp; a_{C} = \sum_{f \sim nb(C)}\text{FluxC}_{f} = -(a_{W} + a_{N} + a_{S}) \\
&amp; b_{C} = Q_{C}^{\phi}V_{C} - \Big( \text{FluxV}_{b} + \sum_{f \sim nb(C)}\text{FluxV}_{f} \Big)
\end{align}\end{split}\]</div>
<p>从上面的离散方程可以看出如下特征：</p>
<ol class="arabic simple">
<li>Neumann边界条件不会对主导系数 <span class="math notranslate nohighlight">\(a_{C}\)</span> 产生贡献。</li>
<li>如果 <span class="math notranslate nohighlight">\(q_{b}\)</span> 和 <span class="math notranslate nohighlight">\(S_{C}^{\phi}\)</span> 都是零，那么 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 将被其相邻量限制有界。否则， <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 将可能超过或低于其相邻值 <span class="math notranslate nohighlight">\(\phi\)</span> ，这种情况是允许的。例如，如果 <span class="math notranslate nohighlight">\(\phi\)</span> 表示温度，那么 <span class="math notranslate nohighlight">\(q_{b}\)</span> 表示应用在边界上的热通量。因此，如果热量添加到边界上，那么在靠近边界的区域其温度要比内部区域要更高。</li>
<li>一旦 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 被计算出来，那么边界上的值 <span class="math notranslate nohighlight">\(\phi_{b}\)</span> 就可以如下计算</li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{b} = \frac{\Gamma_{b}^{\phi}\text{gDiff}_{b}\phi_{C} - q_{b}}{\Gamma_{b}^{\phi}\text{gDiff}_{b}}
\end{align}\]</div>
<ol class="arabic simple" start="4">
<li>Neumann条件可以被认为是有限体积法的自然边界条件，因为对于指定通量为零的情况，不需要对面进行任何离散化，而指定值为零(Dirichlet条件)仍然需要进行离散化。</li>
</ol>
</div>
<div class="section" id="id8">
<h4>混合边界条件<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h4>
<p>混合边界条件，如图所示，是指边界上的信息通过对流传递系数( <span class="math notranslate nohighlight">\(h_{\infty}\)</span> )和 <span class="math notranslate nohighlight">\(\phi\)</span> 周围值( <span class="math notranslate nohighlight">\(\phi_{\infty}\)</span> )给出的情况，可以表示为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{J}_{b}^{\phi,D} \cdot \mathbf{S}_{b}
= - (\Gamma^{\phi}\nabla\phi)_{b} \cdot \mathbf{i} S_{b}
= - h_{\infty} (\phi_{\infty} - \phi_{b})(\Delta y)_{C}
\end{align}\]</div>
<p>也可以展开写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
- \Gamma_{b}^{\phi}S_{b}\Big( \frac{\phi_{b} - \phi_{C}}{\delta x_{b}} \Big)
= - h_{\infty} (\phi_{\infty} - \phi_{b}) S_{b}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/扩散项混合边界条件.png" src="../_images/扩散项混合边界条件.png" />
</div>
<p>从上式我们可以得到 <span class="math notranslate nohighlight">\(\phi_{b}\)</span> 的表达式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{b} = \frac{h_{\infty}\phi_{\infty} + (\Gamma_{b}^{\phi}/\delta x_{b})\phi_{C}}{h_{\infty} + (\Gamma_{b}^{\phi}/\delta x_{b})}
\end{align}\]</div>
<p>将上式代入到最开始边界条件的定义式，通量方程就变成了</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{J}_{b}^{\phi,D} \cdot \mathbf{S}_{b}
= - \Big[ \frac{h_{\infty}(\Gamma_{b}^{\phi}/\delta x_{b})}{h_{\infty} + (\Gamma_{b}^{\phi}/\delta x_{b})}S_{b} \Big] (\phi_{\infty} - \phi_{C})
= \text{FluxC}_{b}\phi_{C} + \text{FluxV}_{b}
\end{align}\]</div>
<p>下面记 <span class="math notranslate nohighlight">\(R_{eq} = \frac{h_{\infty}(\Gamma_{b}^{\phi}/\delta x_{b})}{h_{\infty} + (\Gamma_{b}^{\phi}/\delta x_{b})}S_{b}\)</span> ，则其中</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{FluxC}_{b} = R_{eq} ,\quad
\text{FluxV}_{b} = -R_{eq}\phi_{\infty}
\end{align}\]</div>
<p>根据上式，在边界处的单元的离散方程就变成了如下形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{W}\phi_{W} + a_{N}\phi_{N} + a_{S}\phi_{S} = b_{C}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = 0 \\
&amp; a_{W} = \text{FluxF}_{w} = -\Gamma_{w}^{\phi}\text{gDiff}_{w} \\
&amp; a_{N} = \text{FluxF}_{n} = -\Gamma_{n}^{\phi}\text{gDiff}_{n} \\
&amp; a_{S} = \text{FluxF}_{s} = -\Gamma_{s}^{\phi}\text{gDiff}_{s} \\
&amp; a_{C} = \text{FluxC}_{b} + \sum_{f \sim nb(C)}\text{FluxC}_{f} = (\text{FluxC}_{b} + \text{FluxC}_{w} + \text{FluxC}_{n} + \text{FluxC}_{s}) \\
&amp; b_{C} = Q_{C}^{\phi}V_{C} - \Big( \text{FluxV}_{b} + \sum_{f \sim nb(C)}\text{FluxV}_{f} \Big)
\end{align}\end{split}\]</div>
</div>
<div class="section" id="id9">
<h4>对称边界条件<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h4>
<p>沿着对称边界，到标量变量边界的法向通量为零。因此，对称边界条件等价于通量值设为零的Neumann边界条件，也即 <span class="math notranslate nohighlight">\(\text{FluxC}_{b} = \text{FluxV}_{b} = 0\)</span> 。因此，对称边界条件的离散方程通过设置 <span class="math notranslate nohighlight">\(q_{b}=0\)</span> 得到，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{W}\phi_{W} + a_{N}\phi_{N} + a_{S}\phi_{S} = b_{C}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = 0 \\
&amp; a_{W} = \text{FluxF}_{w} = -\Gamma_{w}^{\phi}\text{gDiff}_{w} \\
&amp; a_{N} = \text{FluxF}_{n} = -\Gamma_{n}^{\phi}\text{gDiff}_{n} \\
&amp; a_{S} = \text{FluxF}_{s} = -\Gamma_{s}^{\phi}\text{gDiff}_{s} \\
&amp; a_{C} = \sum_{f \sim nb(C)}\text{FluxC}_{f} = - (a_{W} + a_{N} + a_{S}) \\
&amp; b_{C} = Q_{C}^{\phi}V_{C} - \sum_{f \sim nb(C)}\text{FluxV}_{f}
\end{align}\end{split}\]</div>
</div>
</div>
<div class="section" id="id10">
<h3>界面扩散系数<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<p>在上述离散方程中，我们分别使用了 <span class="math notranslate nohighlight">\(\Gamma_{e}^{\phi},\Gamma_{w}^{\phi},\Gamma_{n}^{\phi},\Gamma_{s}^{\phi}\)</span> 来表示 <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 在单元 <span class="math notranslate nohighlight">\(e,w,n,s\)</span> 面上的值。当扩散系数随位置变化的时候，网格形心将会存储这些数值，然后就需要根据这些形心处的值来计算网格界面值。当然，下面的讨论与均匀扩散系数的情况无关。</p>
<p>如果考虑能量方程，讨论可能会变得更清楚，在这种情况下，扩散系数代表所使用的材料的热传导系数而 <span class="math notranslate nohighlight">\(\phi\)</span> 表示温度。非均匀热传导发生在非均匀材料和/或热导率与温度有关的时候。在一般的关于 <span class="math notranslate nohighlight">\(\phi\)</span> 的微分方程中，扩散系数 <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 都将用相同的方式进行处理。在湍流中经常会遇到 <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 的显著变化，这里的 <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 可能表示湍流粘度或湍流传导性系数。因此，我们需要找到一个能够处理非均一 <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 的合适算法。</p>
<p>一种简单的处理方法就是利用单元 <span class="math notranslate nohighlight">\(C\)</span> 及其相邻单元的 <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 进行线性估计，因此，对于 <span class="math notranslate nohighlight">\(e\)</span> 面的插值可以这样得到：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Gamma_{e}^{\phi} = (1 -g_{e})\Gamma_{C}^{\phi} + g_{e}\Gamma_{E}^{\phi}
\end{align}\]</div>
<p>其中插值因子 <span class="math notranslate nohighlight">\(g_{e}\)</span> 是关于形心与插值面距离的比值，定义为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g_{e} = \frac{d_{Ce}}{d_{Ce} + d_{eE}}
\end{align}\]</div>
<p>因此，对于一个笛卡尔网格，如果网格面位于网格形心点的中间，那么 <span class="math notranslate nohighlight">\(g_{e}=0.5\)</span> ，并且 <span class="math notranslate nohighlight">\(\Gamma_{e}^{\phi}\)</span> 就是 <span class="math notranslate nohighlight">\(\Gamma_{C}^{\phi}\)</span> 和 <span class="math notranslate nohighlight">\(\Gamma_{E}^{\phi}\)</span> 的算术平均值。对于其他面的系数也可以类似得到：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g_{w} = \frac{d_{Cw}}{d_{Cw} + d_{wW}} ,\quad
g_{n} = \frac{d_{Cn}}{d_{Cn} + d_{nN}} ,\quad
g_{s} = \frac{d_{Cs}}{d_{Cs} + d_{sS}}
\end{align}\]</div>
<p>因此，只计算一次单元各网格面的系数就足够了。此外，使用距离而不是体积将导致相同的插值因子，因为这里的网格是笛卡尔的。</p>
<p>这种基本方法在某些情况下会导致相当不正确的结果，不能准确地处理，例如，复合材料中可能发生的传导率的突然变化。不过，有一种比这简单得多的选择。在开发这种替代方案时，我们认识到界面上的局部电导率值不是主要考虑的问题，相反，我们的主要目标是获得界面处扩散通量的良好表示。对于如图所示的一维问题，假设单元C由导热系数为 <span class="math notranslate nohighlight">\(\Gamma_{C}^{\phi}\)</span> 的材料组成，而单元E由导热系数为 <span class="math notranslate nohighlight">\(\Gamma_{E}^{\phi}\)</span> 的材料组成。对于C点与E点之间的非均质网格面，一维无源分析得到(假设界面E两侧的通量相同)：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{J}_{e}^{\phi,D} \cdot \mathbf{S}_{e}
= \frac{\phi_{C} - \phi_{e}}{\cfrac{(\delta x)_{Ce}}{\Gamma_{C}^{\phi}}}
= \frac{\phi_{e} - \phi_{E}}{\cfrac{(\delta x)_{eE}}{\Gamma_{E}^{\phi}}}
= \frac{\phi_{C} - \phi_{E}}{\cfrac{(\delta x)_{Ce}}{\Gamma_{C}^{\phi}} + \cfrac{(\delta x)_{eE}}{\Gamma_{E}^{\phi}}}
= \frac{\phi_{C} - \phi_{E}}{\cfrac{(\delta x)_{CE}}{\Gamma_{e}^{\phi}}}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/在单元面上的插值.png" src="../_images/在单元面上的插值.png" />
</div>
<p>由此得出平板的有效热传导率为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{(\delta x)_{CE}}{\Gamma_{e}^{\phi}}
= \frac{(\delta x)_{Ce}}{\Gamma_{C}^{\phi}} + \frac{(\delta x)_{eE}}{\Gamma_{E}^{\phi}}
\quad \Rightarrow \quad
\frac{1}{\Gamma_{e}^{\phi}} = \Big( \frac{1-g_{e}}{\Gamma_{E}^{\phi}} + \frac{g_{e}}{\Gamma_{C}^{\phi}}  \Big)
\end{align}\]</div>
<p>当网格面位于C和E的中间时，有 <span class="math notranslate nohighlight">\(g_{e}=0.5\)</span> ，上式就化简为了</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Gamma_{e}^{\phi} = \frac{2 \Gamma_{C}^{\phi} \Gamma_{E}^{\phi}}{\Gamma_{C}^{\phi} + \Gamma_{E}^{\phi}}
\end{align}\]</div>
<p>也就是说， <span class="math notranslate nohighlight">\(\Gamma_{e}^{\phi}\)</span> 是 <span class="math notranslate nohighlight">\(\Gamma_{C}^{\phi}\)</span> 和 <span class="math notranslate nohighlight">\(\Gamma_{E}^{\phi}\)</span> 的调和平均值，而不是开始所采用的算术平均值。</p>
<p>值得注意的是，非连续扩散系数的调和平均值插值仅适用于一维扩散。然而，它在多维情况下的应用具有重要的优势。如果使用这种类型的插值，在处理共轭界面时就不需要做任何特别的事情，固体和流体的网格被简单地视为相同区域的一部分，在网格质心处存储不同的扩散系数。通过将扩散系数计算为共享网格面质心处的调和平均值，可以正确计算出共轭界面处的扩散通量。</p>
</div>
<div class="section" id="id11">
<h3>非笛卡尔正交网格<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<p>现在让我们考虑一个没有沿着 <span class="math notranslate nohighlight">\(x,y\)</span> 坐标的正交网格，如图所示，这样的网格可以通过将之前的笛卡尔网格旋转某个角度得到。该网格的离散化方程应该与笛卡尔网格的离散化方程完全相同。对于相似的边界条件，应得到相同的解。</p>
<div class="figure align-center">
<img alt="../_images/非笛卡尔正交网格.png" src="../_images/非笛卡尔正交网格.png" />
</div>
<p>再次考虑稳态扩散方程</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nabla \cdot \mathbf{J}^{\phi,D} = Q^{\phi}
\end{align}\]</div>
<p>跟之前一样，它的离散形式为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\sum_{f \sim nb(C)} - (\Gamma^{\phi} \nabla\phi)_{f} \cdot \mathbf{S}_{f} = Q_{C}^{\phi}V_{C}
\end{align}\]</div>
<p>单独考虑在 <span class="math notranslate nohighlight">\(e\)</span> 面的离散，就得到了</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{J}_{e}^{\phi,D} \cdot \mathbf{S}_{e}
= - \Gamma_{e}^{\phi} (\nabla \phi \cdot \mathbf{n})_{e} S_{e}
= - \Gamma_{e}^{\phi} \Big( \frac{\partial \phi}{\partial n} \Big)_{e} S_{e}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\((\nabla \phi \cdot \mathbf{n})_{e} = \Big( \frac{\partial \phi}{\partial n} \Big)_{e}\)</span> 是 <span class="math notranslate nohighlight">\(\phi\)</span> 在 <span class="math notranslate nohighlight">\(e\)</span> 面上沿 <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> 方向的梯度。再次沿着 <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> 方向使用线性方法，该梯度就可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big( \frac{\partial \phi}{\partial n} \Big)_{e} = \frac{\phi_{E} - \phi_{C}}{d_{CE}}
\end{align}\]</div>
<p>其他项的离散化过程与笛卡尔网格一样，最终得到相同的离散化方程。</p>
</div>
<div class="section" id="id12">
<h3>非正交非结构化网格<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<div class="section" id="id13">
<h4>非正交性<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h4>
<p>在前面所述的网格构型中，通量都是与网格面正交的，然而一般来说，结构化含曲线的网格以及非结构网格都是非正交的。因此，面法向量 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 和连接相邻网格单元质心的向量 <span class="math notranslate nohighlight">\(\mathbf{CF}\)</span> 并不在同一直线上，如图所示。在这种情况下，面法向梯度就不能够写成关于 <span class="math notranslate nohighlight">\(\phi_{F}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的函数，因为它有一个垂直于 <span class="math notranslate nohighlight">\(\mathbf{CF}\)</span> 方向的分量。</p>
<div class="figure align-center">
<img alt="../_images/非正交网格系统中的网格单元关系.png" src="../_images/非正交网格系统中的网格单元关系.png" />
</div>
<p>所以，只有在正交网格的情况下，面法向梯度才能写成下面的形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\nabla \phi \cdot \mathbf{n})_{f}
= \Big( \frac{\partial \phi}{\partial n} \Big)_{f}
= \frac{\phi_{F} - \phi_{C}}{\| \mathbf{r}_{F} - \mathbf{r}_{C} \|}
= \frac{\phi_{F} - \phi_{C}}{d_{CF}}
\end{align}\]</div>
<p>在非正交网格中，就需要引入一个描述相邻网格质心方向的新的单位向量 <span class="math notranslate nohighlight">\(\mathbf{e}\)</span> ，它可以表示为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{e} = \frac{\mathbf{r}_{F} - \mathbf{r}_{C}}{\| \mathbf{r}_{F} - \mathbf{r}_{C} \|} = \frac{\mathbf{d}_{CF}}{d_{CF}}
\end{align}\]</div>
<p>那么，在 <span class="math notranslate nohighlight">\(\mathbf{e}\)</span> 方向的梯度就可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\nabla \phi \cdot \mathbf{e})_{f}
= \Big( \frac{\partial \phi}{\partial e} \Big)_{f}
= \frac{\phi_{F} - \phi_{C}}{\| \mathbf{r}_{F} - \mathbf{r}_{C} \|}
= \frac{\phi_{F} - \phi_{C}}{d_{CF}}
\end{align}\]</div>
<p>因此，为了实现非正交网格中通量的线性化，面法向量应该写成两个向量的和，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{S}_{f} = \mathbf{E}_{f} + \mathbf{T}_{f}
\end{align}\]</div>
<p>如此，面法向梯度就可以写成关于 <span class="math notranslate nohighlight">\(\phi_{F}\)</span> 、 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的函数加上修正项的形式，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\nabla \phi)_{f} \cdot \mathbf{S}_{f}
= (\nabla\phi)_{f} \cdot \mathbf{E}_{f} + (\nabla\phi)_{f} \cdot \mathbf{T}
= E_{f}\Big( \frac{\partial \phi}{\partial e} \Big)_{f} + (\nabla\phi)_{f} \cdot \mathbf{T}_{f}
= E_{f}\frac{\phi_{F} - \phi_{C}}{d_{CF}} + (\nabla \phi)_{f} \cdot \mathbf{T}_{f}
\end{align}\]</div>
<p>上式右侧第一项表示与正交网格类似的贡献项，右侧第二项称为交叉扩散项或非正交扩散项，这是由于网格非正交性造成的。分解 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 的方式是可选的，它们将会采用不同的非正交扩散项。</p>
</div>
<div class="section" id="id14">
<h4>最小修正法<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h4>
<p>如图所示，最小修正法(Minimum Correction Approach)采用 <span class="math notranslate nohighlight">\(\mathbf{E}_{f}\)</span> 和 <span class="math notranslate nohighlight">\(\mathbf{T}_{f}\)</span> 相互垂直的形式来分解 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 。当非正交性增加时， <span class="math notranslate nohighlight">\(\phi_{F},\phi_{C}\)</span> 对扩散通量的贡献减小。在这种情况下，向量 <span class="math notranslate nohighlight">\(\mathbf{E}_{f}\)</span> 可以这样表示：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{E}_{f} = (\mathbf{e} \cdot \mathbf{S}_{f})\mathbf{e} = (S_{f}\cos\theta)\mathbf{e}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/最小修正法的面法向量分解方式.png" src="../_images/最小修正法的面法向量分解方式.png" />
</div>
</div>
<div class="section" id="id15">
<h4>正交修正法<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h4>
<p>在正交修正法(Orthogonal Correction Approach)中，来自 <span class="math notranslate nohighlight">\(\phi_{F},\phi_{C}\)</span> 的贡献不论非正交角度如何，都与正交网格的情况保持相同，如图所示。为了实现这一点， <span class="math notranslate nohighlight">\(\mathbf{E}_{f}\)</span> 被定义为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{E}_{f} = S_{f}\mathbf{e}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/正交修正法的面法向量分解方式.png" src="../_images/正交修正法的面法向量分解方式.png" />
</div>
</div>
<div class="section" id="id16">
<h4>过松弛法<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h4>
<p>在过松弛法(Over-Relaxed Approach)中，来自 <span class="math notranslate nohighlight">\(\phi_{F},\phi_{C}\)</span> 的贡献的重要性被强制随着非正交性的增加而提高，如图所示。需要通过选择 <span class="math notranslate nohighlight">\(\mathbf{T}_{f}\)</span> 垂直于 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 来实现。 <span class="math notranslate nohighlight">\(\mathbf{E}_{f}\)</span> 通过下式进行计算：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{E}_{f} = \Big( \frac{S_{f}}{\cos\theta} \Big)\mathbf{e}
= \Big( \frac{S_{f}^{2}}{S_{f}\cos\theta} \Big)\mathbf{e}
= \frac{\mathbf{S}_{f} \cdot \mathbf{S}_{f}}{\mathbf{e} \cdot \mathbf{S}_{f}}\mathbf{e}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/过松弛法的面法向量分解方式.png" src="../_images/过松弛法的面法向量分解方式.png" />
</div>
<p>总的来说，在非正交网格中，网格单元的面扩散通量无法仅仅通过相邻两个单元质心的值计算得到，必须额外添加一项表示非正交性的贡献。这一额外添加的项称为交叉扩散项(cross diffusion)，计算方式有</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
(\nabla\phi)_{f} \cdot \mathbf{T}_{f}
= (\nabla\phi)_{f} \cdot (\mathbf{S}_{f} - \mathbf{E}_{f})
= \left \{ \begin{array}{l}
(\nabla \phi)_{f} \cdot (\mathbf{n} - \cos\theta \mathbf{e})S_{f} \quad \text{minimum correction} \\
(\nabla \phi)_{f} \cdot (\mathbf{n} - \mathbf{e})S_{f} \quad \text{normal correction} \\
(\nabla \phi)_{f} \cdot \Big( \mathbf{n} - \frac{1}{\cos\theta}\mathbf{e} \Big) \quad \text{over-relaxed}
\end{array} \right .
\end{align}\end{split}\]</div>
<p>对于正交网格， <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> 和 <span class="math notranslate nohighlight">\(\mathbf{e}\)</span> 共线，因此交叉扩散项为零。而当交叉扩散项不为零的时候，它不能够写成关于 <span class="math notranslate nohighlight">\(\phi_{F}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的函数，因此它将会作为源项添加到线性方程组当中。</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">交叉扩散项不能用节点值表示。由于这一事实，它将以延迟修正的方式处理，即使用当前梯度场计算其值，并将其作为源项添加到代数方程的右侧。</p>
</div>
</div>
<div class="section" id="id17">
<h4>梯度计算<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h4>
<p>在一维算域或多维正交算域中离散扩散项的时候，可以发现 <span class="math notranslate nohighlight">\(\phi\)</span> 的梯度可以显式地写成关于单元节点 <span class="math notranslate nohighlight">\(\phi\)</span> 值的函数。但是在非正交网格中，扩散项的计算要更加复杂，梯度的非正交分量无法线性化并写成关于单元节点值的形式，而是必须移到方程右边并显式地求值。这意味着要首先计算得到梯度然后才能计算非正交性在离散方程中的贡献。一种广泛使用的计算单元上梯度的方法是Green-Gauss定理，对于任何封闭体积 <span class="math notranslate nohighlight">\(V\)</span> ，总有：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{V}\nabla \phi~\mathrm{d}V = \oint_{\partial V}\phi~\mathrm{d}\mathbf{S}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\mathrm{d}\mathbf{S}\)</span> 是指向封闭曲面外侧的面积微元法向量。为了得到该方程的离散形式，考虑应用平均值定理：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\nabla \phi}V = \int_{V}\nabla\phi~\mathrm{d}V
\end{align}\]</div>
<p>联立上面两个方程即可得到单元C的平均梯度计算方法：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\nabla \phi_{C}} = \frac{1}{V_{C}}\oint_{\partial V_{C}}\phi_{f}\mathbf{S}_{f}
\end{align}\]</div>
<p>上式右侧对单元面的积分可以通过面心值与网格面面积相乘来估计，于是</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nabla\phi_{C} = \frac{1}{V_{C}}\sum_{f\sim nb(C)} \phi_{f}\mathbf{S}_{f}
\end{align}\]</div>
<p>单元面上的梯度可以通过加权平均单元质心处的梯度来得到，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nabla\phi_{f} = g_{C}\nabla\phi_{C} + g_{F}\nabla \phi_{F}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(g_{C},g_{F}\)</span> 是与网格面 <span class="math notranslate nohighlight">\(f\)</span> 相对于节点C和F的位置有关的几何插值因子。</p>
</div>
<div class="section" id="id18">
<h4>非正交网格的线性方程<a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h4>
<p>将网格面法向量 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 分解成 <span class="math notranslate nohighlight">\(\mathbf{E}_{f}\)</span> 和 <span class="math notranslate nohighlight">\(\mathbf{T}_{f}\)</span> 两个向量，并将其等效表达式代入到扩散通量半离散方程，得到</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\sum_{f\sim nb(C)}\Big( \mathbf{J}_{f}^{\phi,D}\cdot \mathbf{S}_{f} \Big)
&amp;= \sum_{f\sim nb(C)}\Big( -(\Gamma^{\phi}\nabla\phi)_{f} \cdot (\mathbf{E}_{f} + \mathbf{T}_{f}) \Big) \\
&amp;= \sum_{f\sim nb(C)}\Big( -(\Gamma^{\phi}\nabla\phi)_{f} \cdot \mathbf{E}_{f} \Big) + \sum_{f\sim nb(C)}\Big( -(\Gamma^{\phi}\nabla\phi)_{f}\cdot \mathbf{T}_{f} \Big) \\
&amp;= \sum_{f\sim nb(C)}\Big( -\Gamma_{f}^{\phi}E_{f}\frac{\phi_{F}-\phi_{C}}{d_{CF}} \Big) + \sum_{f\sim nb(C)}\Big( -(\Gamma^{\phi}\nabla\phi)_{f}\cdot \mathbf{T}_{f} \Big) \\
&amp;= \sum_{f\sim nb(C)}\Gamma_{f}^{\phi}\text{gDiff}_{f}(\phi_{C} - \phi_{F}) + \sum_{f\sim nb(C)}\Big( -(\Gamma^{\phi}\nabla\phi)_{f}\cdot \mathbf{T}_{f} \Big) \\
&amp;= \Big( \sum_{f\sim nb(C)}\text{FluxC}_{f} \Big)\phi_{C} + \sum_{f\sim nb(C)}(\text{FluxF}_{f}\phi_{F}) + \sum_{f\sim nb(C)}(\text{FluxV}_{f})
\end{align}\end{split}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\text{gDiff}_{f}\)</span> 是一个几何扩散系数，定义为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{gDiff}_{f} = \frac{E_{f}}{d_{CF}}
\end{align}\]</div>
<p>利用上述形式的扩散通量并展开，最终得到非结构化/结构化非正交网格的离散化扩散方程形式为：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + \sum_{F\sim NB(C)}a_{F}\phi_{F} = b_{C}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{F} = \text{FluxF}_{f} = -\Gamma_{f}^{\phi}\text{gDiff}_{f} \\
&amp; a_{C} = \sum_{f\sim nb(C)}\text{FluxC}_{f} = - \sum_{f\sim nb(C)}\text{FluxF}_{f} = \sum_{f\sim nb(C)}\Gamma_{f}^{\phi}\text{gDiff}_{f} \\
&amp; b_{C} = Q_{C}^{\phi}V_{C} - \sum_{f\sim nb(C)}(\text{FluxV}_{f}) = Q_{C}^{\phi}V_{C} + \sum_{f\sim nb(C)}\Big( (\Gamma^{\phi}\nabla\phi)_{f} \cdot \mathbf{T}_{f} \Big)
\end{align}\end{split}\]</div>
<div class="admonition attention">
<p class="first admonition-title">注意</p>
<p class="last">注意方程右边非正交项的符号变化。</p>
</div>
</div>
</div>
<div class="section" id="id19">
<h3>偏斜度<a class="headerlink" href="#id19" title="永久链接至标题">¶</a></h3>
<p>在计算关于 <span class="math notranslate nohighlight">\(\phi\)</span> 的离散方程时，总是要估计其在网格面上的值，而在网格面上的估计值应该是整个网格面上的平均值。在离散化过程的不同步骤中，总是假设变量在网格单元节点之间呈线性分布，当这一观点延续到变量沿面变化的时候，那么任何变量的面平均值都应该在网格面的面心处找到。通常的做法是使用线性插值到网格面，并且在网格面与连接相邻单元节点的直线之间的交点处来估计网格面的值。</p>
<p>但是，当网格倾斜时，单元间连线不一定穿过网格面的质心，如图所示， <span class="math notranslate nohighlight">\(CF\)</span> 连线在网格面上的交点为 <span class="math notranslate nohighlight">\(f'\)</span> ，与网格面的面心 <span class="math notranslate nohighlight">\(f\)</span> 并不重合。为了保证离散方法整体具有二阶精度，所有面的积分都需要在 <span class="math notranslate nohighlight">\(f\)</span> 处进行，因此需要找到从 <span class="math notranslate nohighlight">\(f'\)</span> 处的值修正得到 <span class="math notranslate nohighlight">\(f\)</span> 处的值的方法。</p>
<p>偏斜度修正(skewness correction)通过将 <span class="math notranslate nohighlight">\(f\)</span> 处的 <span class="math notranslate nohighlight">\(\phi\)</span> 展开为 <span class="math notranslate nohighlight">\(f'\)</span> 处的泰勒展开式来实现，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \phi_{f'} + (\nabla\phi)_{f'} \cdot \mathbf{d}_{f'f}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\mathbf{d}_{f'f}\)</span> 表示一个由交点 <span class="math notranslate nohighlight">\(f'\)</span> 指向面心 <span class="math notranslate nohighlight">\(f\)</span> 的向量。</p>
<div class="figure align-center">
<img alt="../_images/存在偏斜度的网格.png" src="../_images/存在偏斜度的网格.png" />
</div>
</div>
<div class="section" id="id20">
<h3>各向异性扩散<a class="headerlink" href="#id20" title="永久链接至标题">¶</a></h3>
<p>前面讨论的扩散方程都假设材料在各个方向上都具有相同的扩散系数，即认为介质是各向同性的。对于介质扩散系数与方向有关的情况，称为各项异性。如果材料是各项异性的，那么其半离散扩散方程为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\sum_{f\sim nb(C)}(-\boldsymbol{\kappa}^{\phi} \cdot \nabla\phi)_{f} \cdot \mathbf{S}_{f} = S_{C}^{\phi}V_{C}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\boldsymbol{\kappa}^{\phi}\)</span> 是一个二阶对称张量。考虑一个一般的三维情况，上式等号左边的项可以改写为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
(-\boldsymbol{\kappa}^{\phi} \cdot \nabla\phi)_{f} \cdot \mathbf{S}_{f}
&amp; = - \begin{bmatrix}
\boldsymbol{\kappa}_{11}^{\phi} &amp; \boldsymbol{\kappa}_{12}^{\phi} &amp; \boldsymbol{\kappa}_{13}^{\phi} \\
\boldsymbol{\kappa}_{21}^{\phi} &amp; \boldsymbol{\kappa}_{22}^{\phi} &amp; \boldsymbol{\kappa}_{23}^{\phi} \\
\boldsymbol{\kappa}_{31}^{\phi} &amp; \boldsymbol{\kappa}_{32}^{\phi} &amp; \boldsymbol{\kappa}_{33}^{\phi}
\end{bmatrix}_{f}
\begin{bmatrix}
\frac{\partial \phi}{\partial x} \\
\frac{\partial \phi}{\partial y} \\
\frac{\partial \phi}{\partial z}
\end{bmatrix}_{f}
\cdot \mathbf{S}_{f}
= - \begin{bmatrix}
\boldsymbol{\kappa}_{11}^{\phi}\frac{\partial \phi}{\partial x} + \boldsymbol{\kappa}_{12}^{\phi}\frac{\partial \phi}{\partial y} + \boldsymbol{\kappa}_{13}^{\phi}\frac{\partial \phi}{\partial z} \\
\boldsymbol{\kappa}_{21}^{\phi}\frac{\partial \phi}{\partial x} + \boldsymbol{\kappa}_{22}^{\phi}\frac{\partial \phi}{\partial y} + \boldsymbol{\kappa}_{23}^{\phi}\frac{\partial \phi}{\partial z} \\
\boldsymbol{\kappa}_{31}^{\phi}\frac{\partial \phi}{\partial x} + \boldsymbol{\kappa}_{32}^{\phi}\frac{\partial \phi}{\partial y} + \boldsymbol{\kappa}_{33}^{\phi}\frac{\partial \phi}{\partial z}
\end{bmatrix}_{f}
\begin{bmatrix}
S^{x} \\ S^{y} \\ S^{z}
\end{bmatrix}_{f}
\\
&amp; = - \begin{bmatrix}
\frac{\partial \phi}{\partial x} &amp; \frac{\partial \phi}{\partial y} &amp; \frac{\partial \phi}{\partial z}
\end{bmatrix}_{f}
\begin{bmatrix}
\boldsymbol{\kappa}_{11}^{\phi} &amp; \boldsymbol{\kappa}_{21}^{\phi} &amp; \boldsymbol{\kappa}_{31}^{\phi} \\
\boldsymbol{\kappa}_{12}^{\phi} &amp; \boldsymbol{\kappa}_{22}^{\phi} &amp; \boldsymbol{\kappa}_{32}^{\phi} \\
\boldsymbol{\kappa}_{13}^{\phi} &amp; \boldsymbol{\kappa}_{23}^{\phi} &amp; \boldsymbol{\kappa}_{33}^{\phi}
\end{bmatrix}_{f}
\begin{bmatrix}
S^{x} \\ S^{y} \\ S^{z}
\end{bmatrix}_{f}
= -(\nabla \phi)_{f} \cdot \Big[ (\boldsymbol{\kappa}^{\phi})^{T}\cdot \mathbf{S}\Big]_{f}
= -(\nabla \phi)_{f} \cdot \mathbf{S}_{f}'
\end{align}\end{split}\]</div>
<p>将其代入到原半离散方程中，即可得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\sum_{f\sim nb(C)}(-\nabla\phi)_{f} \cdot \mathbf{S}_{f}' = Q_{C}^{\phi}V_{C}
\end{align}\]</div>
<p>显然，上面的形式可以简单地通过将 <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 设为 <span class="math notranslate nohighlight">\(1\)</span> 并将 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 替换为 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 得到。这也就意味着同样的代码可以用于求解各向同性和各向异性的问题。</p>
</div>
<div class="section" id="id21">
<h3>迭代解过程的欠松弛<a class="headerlink" href="#id21" title="永久链接至标题">¶</a></h3>
<p>对于一般的扩散问题， <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 可能是关于未知因变量 <span class="math notranslate nohighlight">\(\phi\)</span> 的函数，网格也可能是高度非正交的，具有较大的需要使用延迟修正方法处理的交叉扩散项。因此，在迭代的过程中， <span class="math notranslate nohighlight">\(\phi\)</span> 的较大变化会会导致较大的源项以及较大的系数变化，这可能会导致迭代求解过程发散。这种发散通常是由于系数和交叉扩散项引入的非线性，使得源项受到尚未收敛的当前解场的高度影响。</p>
<p>为了促进收敛并稳定迭代求解过程，就需要减缓 <span class="math notranslate nohighlight">\(\phi\)</span> 在迭代过程中的变化，这通过欠松弛(under-relaxation)的技术来实现。引入欠松弛的方法有很多，这里先介绍其中一种。首先考虑一般的离散方程：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + \sum_{F\sim NB(C)}a_{F}\phi_{F} = b_{C}
\end{align}\]</div>
<p>上式可以改写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{C} = \frac{-\sum\limits_{F\sim NB(C)}a_{F}\phi_{F} + b_{C}}{a_{C}}
\end{align}\]</div>
<p>将 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 在前一次迭代得到的值记作 <span class="math notranslate nohighlight">\(\phi_{C}^{*}\)</span> 。如果将 <span class="math notranslate nohighlight">\(\phi_{C}^{*}\)</span> 添加到上式的右侧，则有</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{C} = \phi_{C}^{*}
+ \left ( \frac{-\sum\limits_{F\sim NB(C)}a_{F}\phi_{F} + b_{C}}{a_{C}} - \phi_{C}^{*} \right)
\end{align}\]</div>
<p>其中，括号内的表达式表示当前迭代对 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 产生的变化量。这个变化量可以通过引入松弛因子 <span class="math notranslate nohighlight">\(\lambda^{\phi}\)</span> 来修改，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{C} = \phi_{C}^{*}
+ \lambda ^{\phi}\left ( \frac{-\sum\limits_{F\sim NB(C)}a_{F}\phi_{F} + b_{C}}{a_{C}} - \phi_{C}^{*} \right)
\end{align}\]</div>
<p>将其写回一般离散方程的形式，得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{a_{C}}{\lambda^{\phi}}\phi_{C}
+ \sum_{F\sim NB(C)}a_{F}\phi_{F}
= b_{C}
+ \frac{(1-\lambda^{\phi})a_{C}}{\lambda^{\phi}}\phi_{C}^{\phi}
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">在收敛点上， <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{C}^{*}\)</span> 将会相等，与松弛因子的取值无关。并且在收敛点上， <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 满足原始离散方程。这是所有松弛方法都应当满足的特性。</p>
</div>
<p>根据松弛因子的取值，可以将方程分为欠松弛( <span class="math notranslate nohighlight">\(0&lt;\lambda^{\phi}&lt;1\)</span> )或过松弛( <span class="math notranslate nohighlight">\(\lambda^{\phi}&gt;1\)</span> )两种。在CFD中通常使用欠松弛方程。当松弛因子接近1时，表明几乎没有松弛操作；当松弛因子接近0时，将会产生非常强的欠松弛效果并使得迭代过程的变化及其缓慢。</p>
<div class="admonition attention">
<p class="first admonition-title">注意</p>
<p class="last">松弛因子的最优选择总是与问题相关的，没有通用的一种规则。影响松弛因子取值的因素包括所解决问题的类型、方程组的大小（计算域网格数量）、网格间距和拓展速率、采用的迭代方法等。通常来说，松弛因子是根据经验或初步计算结果来分配的。此外，没有必要在整个计算域使用相同的欠松弛值，并且在迭代过程中也可以取不同的值。</p>
</div>
<p>含松弛算法的离散方程可以简单地从原始离散方程得到，只需要修改对应系数：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C} \leftarrow \frac{a_{C}}{\lambda^{\phi}}
,\quad
b_{C} \leftarrow b_{C} + \frac{(1-\lambda^{\phi})a_{C}}{\lambda^{\phi}}\phi_{C}^{*}
\end{align}\]</div>
</div>
</div>
<div class="section" id="id22">
<h2>梯度计算<a class="headerlink" href="#id22" title="永久链接至标题">¶</a></h2>
<div class="section" id="id23">
<h3>笛卡尔网格中的梯度计算<a class="headerlink" href="#id23" title="永久链接至标题">¶</a></h3>
<p>对于如图所示的一维问题，使用均一网格离散，假设单元质心之间的变化时线性的，就可以得到在单元面e处的导数表达式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big(\frac{\mathrm{d}\phi}{\mathrm{d}x}\Big)_{e}
= \frac{\phi_{E} - \phi_{C}}{x_{E} - x_{C}}
= \frac{\phi_{E} - \phi_{C}}{\delta x_{e}}
\end{align}\]</div>
<p>类似的，在单元质心C处的导数也可以用相邻单元的值来表示：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big(\frac{\mathrm{d}\phi}{\mathrm{d}x}\Big)_{C}
= \frac{\phi_{e} - \phi_{w}}{x_{e} - x_{w}}
= \frac{\Big(\cfrac{\phi_{E}-\phi_{C}}{2}\Big)-\Big(\cfrac{\phi_{C}+\phi_{W}}{2}\Big)}{\Delta x_{C}}
= \frac{\phi_{E} - \phi_{W}}{2\Delta x_{C}}
\end{align}\]</div>
<p>上式常被称为一阶导的中心差分估计。</p>
<p>对于多维的笛卡尔网格，导数可以通过应用相同的原理沿各自的坐标方向来计算。例如，考虑如图所示的二维网格，使用上述的中心差分近似，得到x和y方向的偏导数为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big(\frac{\partial \phi}{\partial x}\Big)_{C}
= \frac{\phi_{E} - \phi_{W}}{x_{E} - x_{W}}
,\qquad
\Big(\frac{\partial \phi}{\partial y}\Big)_{C}
= \frac{\phi_{N} - \phi_{S}}{x_{N} - x_{S}}
\end{align}\]</div>
<p>对于三维网格，z方向也可以写出类似的式子。但是，在处理非结构化网格的时候，上述方法就不再适用，就需要寻找更加通用的计算梯度的方法。</p>
<div class="figure align-center">
<img alt="../_images/笛卡尔网格中的梯度计算.png" src="../_images/笛卡尔网格中的梯度计算.png" />
</div>
</div>
<div class="section" id="green-gauss">
<h3>Green-Gauss梯度<a class="headerlink" href="#green-gauss" title="永久链接至标题">¶</a></h3>
<p>这是计算梯度最广泛使用的方法之一。前一章已经介绍过，这里不再赘述。相反，我们将给出方程的最终形式，并介绍一些计算面值的附加方法。</p>
<p>如前一章所推导，体积为 <span class="math notranslate nohighlight">\(V_{C}\)</span> 的单元C质心处的梯度可以如下计算：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nabla \phi_{C} = \frac{1}{V_{C}}\sum_{f\sim nb(C)}\phi_{f}\mathbf{S}_{f}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(f\)</span> 表示网格面， <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 表示网格面法向量。在使用上述方程之前，还需要确定 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 的表示。有两种计算它的路线，一种是基于相邻单元网格面的紧凑模板；另一种是基于相邻单元顶点的更广域的模板，该拓展模板涉及的单元格数量大约是紧凑模板的两倍。对于隐式方法，紧凑模板更加方便，因为它能够得到更紧凑的雅可比矩阵。但是，广域模板为重建带来了更多的信息，因此结果再预期上是更加准确的。</p>
<div class="section" id="compact-stencil">
<h4>Compact Stencil<a class="headerlink" href="#compact-stencil" title="永久链接至标题">¶</a></h4>
<p>对于如图(a)(b)所示的二维和三维网格系统，一个简单的计算 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 的方式为使用两个网格单元的平均值。在这个情况下 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 可以如下计算：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = g_{C}\phi_{C} + (1-g_{C})\phi_{F}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(g_{C}\)</span> 为几何权重因子，定义为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g_{C} = \frac{\| \mathbf{r}_{F} - \mathbf{r}_{f} \|}{\| \mathbf{r}_{F} - \mathbf{r}_{C} \|} = \frac{d_{Ff}}{d_{FC}}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> 表示坐标向量， <span class="math notranslate nohighlight">\(d\)</span> 表示两点之间的距离。当网格面位于两个网格单元的中心时， <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 就能表示为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \frac{\phi_{C} + \phi_{F}}{2}
\end{align}\]</div>
<p>这种方法在二维和三维情况下很容易实现，所有涉及的操作都是基于网格面的，不需要额外的网格连接。在精度方面，上述关系仅仅在 <span class="math notranslate nohighlight">\(\mathbf{CF}\)</span> 和网格面 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 的交点与网格面 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 的面心重合时，即与高斯积分点 <span class="math notranslate nohighlight">\(f\)</span> 重合时，才能得到二阶逼近结果。因此，除了上述特殊情况之外，通常无法实现梯度的二阶精确表示。</p>
<div class="figure align-center">
<img alt="../_images/无偏斜度的网格梯度计算.png" src="../_images/无偏斜度的网格梯度计算.png" />
</div>
<p>一般的结构化非正交网格或非结构化网格通常不满足这种条件，如图(c)(d)所示。网格的偏斜度(skewness)导致 <span class="math notranslate nohighlight">\(\mathbf{CF}\)</span> 和网格面 <span class="math notranslate nohighlight">\(\mathbf{S}_{f}\)</span> 相交于点 <span class="math notranslate nohighlight">\(f'\)</span> ，与网格面质心点 <span class="math notranslate nohighlight">\(f\)</span> 不同。在这种情况下，需要对插值的 <span class="math notranslate nohighlight">\(\phi_{f'}\)</span> 进行修正来得到 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 。修正方程为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\phi_{f} &amp;= \phi_{f'} + \text{correction} \\
&amp;= \phi_{f'} + (\nabla\phi)_{f'} \cdot (\mathbf{r}_{f} - \mathbf{r}_{f'}) \\
&amp;= g_{C}\Big( \phi_{C} + (\nabla\phi)_{C} \cdot (\mathbf{r}_{f} - \mathbf{r}_{C}) \Big)
+ (1 - g_{C}) \Big( \phi_{F} + (\nabla\phi)_{F} \cdot (\mathbf{r}_{f} - \mathbf{r}_{F})\Big) \\
&amp;= \phi_{f'} + g_{C}(\nabla\phi)_{C} \cdot (\mathbf{r}_{f} - \mathbf{r}_{C})
+ (1 - g_{C}) (\nabla\phi)_{F} \cdot (\mathbf{r}_{f} - \mathbf{r}_{F})
\end{align}\end{split}\]</div>
<p>由于 <span class="math notranslate nohighlight">\(g_{C}\)</span> 依赖于 <span class="math notranslate nohighlight">\(f'\)</span> ，上式表明可以通过迭代来获得梯度的改进估计值。在每次迭代中，使用前一次迭代中计算的梯度结果来计算网格面的平均值，然后使用这些网格面平均值来计算梯度的新估计值。</p>
<div class="admonition attention">
<p class="first admonition-title">注意</p>
<p class="last">进行过多的迭代可能会导致数值振荡，因此通常不会进行两次以上的迭代。</p>
</div>
<div class="figure align-center">
<img alt="../_images/存在偏斜度的网格梯度计算.png" src="../_images/存在偏斜度的网格梯度计算.png" />
</div>
<p>在这种情况下，计算 <span class="math notranslate nohighlight">\(g_{C}\)</span> 需要确定 <span class="math notranslate nohighlight">\(\mathbf{CF}\)</span> 和网格面  <span class="math notranslate nohighlight">\(S_{f}\)</span> 的交点 <span class="math notranslate nohighlight">\(f'\)</span> 的位置。有三种方法可以实现这一目的：</p>
<p><strong>方法一</strong> ：在这个方法中， <span class="math notranslate nohighlight">\(f'\)</span> 认为就是 <span class="math notranslate nohighlight">\(\mathbf{CF}\)</span> 和网格面 <span class="math notranslate nohighlight">\(S_{f}\)</span> 的交点。引入网格面单位法向量 <span class="math notranslate nohighlight">\(\mathbf{n} = \mathbf{S}_{f} / \| \mathbf{S}_{f} \|\)</span> ，以及沿CF方向的单位向量 <span class="math notranslate nohighlight">\(\mathbf{e} = \mathbf{CF} / \| \mathbf{CF} \|\)</span> ， <span class="math notranslate nohighlight">\(f'\)</span> 点的位置可以利用 <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> 和线段 <span class="math notranslate nohighlight">\(ff'\)</span> 的正交性得到，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\mathbf{r}_{f} - \mathbf{r}_{f'}) \cdot \mathbf{n} = 0
\end{align}\]</div>
<p>并且，因为 <span class="math notranslate nohighlight">\(f'\)</span> 是在CF上的一个点，于是向量 <span class="math notranslate nohighlight">\(\mathbf{Cf'}\)</span> 可以用 <span class="math notranslate nohighlight">\(\mathbf{e}\)</span> 来表示：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{Cf'} = (\mathbf{r}_{f'} - \mathbf{r}_{C}) = k\mathbf{e}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(k\)</span> 是一个标量。联立上面两个式子得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{r}_{f'} = \frac{\mathbf{r}_{f} \cdot \mathbf{n}}{\mathbf{e} \cdot \mathbf{n}}\mathbf{e}
\end{align}\]</div>
<p>上式确定出了 <span class="math notranslate nohighlight">\(f'\)</span> 的位置，于是可以如下计算 <span class="math notranslate nohighlight">\(g_{C}\)</span> ：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g_{C} = \frac{\| \mathbf{r}_{F} - \mathbf{r}_{f'} \|}{\| \mathbf{r}_{F} - \mathbf{r}_{C} \|} = \frac{d_{Ff'}}{d_{FC}}
\end{align}\]</div>
<p>那么，计算过程包括以下步骤：在第一次迭代中，计算整个域的梯度场如下：</p>
<ol class="arabic simple">
<li>计算 <span class="math notranslate nohighlight">\(\phi_{f'}\)</span> ： <span class="math notranslate nohighlight">\(\phi_{f'} = g_{C}\phi_{C} + (1-g_{C})\phi_{F}\)</span> ；</li>
<li>计算 <span class="math notranslate nohighlight">\(\nabla\phi_{C}\)</span> ： <span class="math notranslate nohighlight">\(\nabla\phi_{C} = \frac{1}{V_{C}}\sum_{f\sim nb(C)}\phi_{f'}\mathbf{S}_{f}\)</span> ；</li>
</ol>
<p>从第二次迭代开始，按照以下步骤修正梯度场：</p>
<ol class="arabic simple" start="3">
<li>更新 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> ： <span class="math notranslate nohighlight">\(\phi_{f} = \phi_{f'} + g_{C}(\nabla\phi)_{C} \cdot (\mathbf{r}_{f} - \mathbf{r}_{C}) + (1 - g_{C})(\nabla\phi)_{F} \cdot (\mathbf{r}_{f} - \mathbf{r}_{F})\)</span> ；</li>
<li>更新 <span class="math notranslate nohighlight">\(\nabla\phi_{C}\)</span> ： <span class="math notranslate nohighlight">\(\nabla\phi_{C} = \frac{1}{V_{C}}\sum\limits_{f\sim nb(C)}\phi_{f}\mathbf{S}_{f}\)</span> ；</li>
<li>返回步骤3并重复。</li>
</ol>
<p><strong>方法二</strong> ：在该方法中将 <span class="math notranslate nohighlight">\(f'\)</span> 点取为CF的中点，如图所示，这样方程可以得到化简。在整个计算域的梯度计算过程如下：在第一次迭代中，计算整个域的梯度场如下：</p>
<ol class="arabic simple">
<li>计算 <span class="math notranslate nohighlight">\(\phi_{f'}\)</span> ： <span class="math notranslate nohighlight">\(\phi_{f'} = \frac{\phi_{C} - \phi_{F}}{2}\)</span> ；</li>
<li>计算 <span class="math notranslate nohighlight">\(\nabla\phi_{C}\)</span> ： <span class="math notranslate nohighlight">\(\nabla\phi_{C} = \frac{1}{V_{C}}\sum_{f\sim nb(C)}\phi_{f'}\mathbf{S}_{f}\)</span> ；</li>
</ol>
<p>从第二次迭代开始，按照以下步骤修正梯度场：</p>
<ol class="arabic simple" start="3">
<li>更新 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> ： <span class="math notranslate nohighlight">\(\phi_{f} = \phi_{f'} + 0.5 \times [(\nabla\phi)_{C} + (\nabla\phi)_{F}] \cdot [\mathbf{r}_{f} - 0.5\times (\mathbf{r}_{C} + \mathbf{r}_{F})]\)</span> ；</li>
<li>更新 <span class="math notranslate nohighlight">\(\nabla\phi_{C}\)</span> ： <span class="math notranslate nohighlight">\(\nabla\phi_{C} = \frac{1}{V_{C}}\sum\limits_{f\sim nb(C)}\phi_{f}\mathbf{S}_{f}\)</span> ；</li>
<li>返回步骤3并重复。</li>
</ol>
<div class="figure align-center">
<img alt="../_images/取f'为CF的中点.png" src="../_images/取f'为CF的中点.png" />
</div>
<p><strong>方法三</strong> ：该方法选取的 <span class="math notranslate nohighlight">\(f'\)</span> 使得 <span class="math notranslate nohighlight">\(ff'\)</span> 最短，也即 <span class="math notranslate nohighlight">\(ff'\)</span> 与 <span class="math notranslate nohighlight">\(CF\)</span> 垂直，如图所示。这能在第一次迭代计算梯度的时候提高精度。在这个情况下， <span class="math notranslate nohighlight">\(f'\)</span> 通过最小化 <span class="math notranslate nohighlight">\(f\)</span> 和 <span class="math notranslate nohighlight">\(f'\)</span> 的距离来计算得到。一般地， <span class="math notranslate nohighlight">\(\mathbf{r}_{f'}\)</span> 能够如下表示：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{r}_{f'} = \mathbf{r}_{C} + q(\mathbf{r}_{F} - \mathbf{r}_{C})
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(0&lt;q&lt;1\)</span> 。用 <span class="math notranslate nohighlight">\(d\)</span> 来表示距离 <span class="math notranslate nohighlight">\(ff'\)</span> ，则其平方可以表示为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
d^{2} &amp;= (\mathbf{r}_{f} - \mathbf{r}_{f'}) \cdot (\mathbf{r}_{f} - \mathbf{r}_{f'}) \\
      &amp;= [\mathbf{r}_{f} - \mathbf{r}_{C} - q(\mathbf{r}_{F} - \mathbf{r}_{C})] \cdot [\mathbf{r}_{f} - \mathbf{r}_{C} - q(\mathbf{r}_{F} - \mathbf{r}_{C})] \\
      &amp;= (\mathbf{r}_{f} - \mathbf{r}_{C}) \cdot (\mathbf{r}_{f} - \mathbf{r}_{C}) - 2q(\mathbf{r}_{f} - \mathbf{r}_{C}) \cdot (\mathbf{r}_{F} - \mathbf{r}_{C}) + q^{2}(\mathbf{r}_{F} - \mathbf{r}_{C}) \cdot (\mathbf{r}_{F} - \mathbf{r}_{C})
\end{align}\end{split}\]</div>
<p>求函数 <span class="math notranslate nohighlight">\(d^{2}\)</span> 关于 <span class="math notranslate nohighlight">\(q\)</span> 的最小值，得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (d^{2})}{\partial q} = 0
\quad \Rightarrow \quad
-2(\mathbf{r}_{f} - \mathbf{r}_{C})\cdot (\mathbf{r}_{F} - \mathbf{r}_{C}) + 2q(\mathbf{r}_{F} - \mathbf{r}_{C}) \cdot (\mathbf{r}_{F} - \mathbf{r}_{C}) = 0
\end{align}\]</div>
<p>求解上式可以得到 <span class="math notranslate nohighlight">\(q\)</span> 的表达式为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
q = -\frac{\mathbf{r}_{Cf} \cdot \mathbf{r}_{CF}}{\mathbf{r}_{CF} \cdot \mathbf{r}_{CF}}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/取f'令距离ff'最短.png" src="../_images/取f'令距离ff'最短.png" />
</div>
<p>在得知了 <span class="math notranslate nohighlight">\(q\)</span> 的值后，在整个计算域中梯度的计算过程如下：在第一次迭代中，计算整个域的梯度场如下：</p>
<ol class="arabic simple">
<li>计算 <span class="math notranslate nohighlight">\(\mathbf{r}_{f'}\)</span> ： <span class="math notranslate nohighlight">\(\mathbf{r}_{f'} = \mathbf{r}_{C} - \frac{\mathbf{r}_{Cf} \cdot \mathbf{r}_{CF}}{\mathbf{r}_{CF} \cdot \mathbf{r}_{CF}} (\mathbf{r}_{C} - \mathbf{r}_{F})\)</span> ；</li>
<li>计算 <span class="math notranslate nohighlight">\(g_{C}\)</span> ： <span class="math notranslate nohighlight">\(g_{C} = \| \mathbf{r}_{F} - \mathbf{r}_{f'} \| / \| \mathbf{r}_{F} - \mathbf{r}_{C} \|\)</span> ；</li>
<li>计算 <span class="math notranslate nohighlight">\(\phi_{f'}\)</span> ： <span class="math notranslate nohighlight">\(\phi_{f'} = \frac{\phi_{C} - \phi_{F}}{2}\)</span> ；</li>
<li>计算 <span class="math notranslate nohighlight">\(\nabla\phi_{C}\)</span> ： <span class="math notranslate nohighlight">\(\nabla\phi_{C} = \frac{1}{V_{C}}\sum_{f\sim nb(C)}\phi_{f'}\mathbf{S}_{f}\)</span> ；</li>
</ol>
<p>从第二次迭代开始，按照以下步骤修正梯度场：</p>
<ol class="arabic simple" start="5">
<li>计算 <span class="math notranslate nohighlight">\(\nabla\phi_{f'}\)</span> ： <span class="math notranslate nohighlight">\(\nabla\phi_{f'} = g_{C}\nabla\phi_{C} + (1 - g_{C})\nabla\phi_{F}\)</span></li>
<li>更新 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> ： <span class="math notranslate nohighlight">\(\phi_{f} = \phi_{f'} + 0.5 \times [(\nabla\phi)_{C} + (\nabla\phi)_{F}] \cdot [\mathbf{r}_{f} - 0.5\times (\mathbf{r}_{C} + \mathbf{r}_{F})]\)</span> ；</li>
<li>更新 <span class="math notranslate nohighlight">\(\nabla\phi_{C}\)</span> ： <span class="math notranslate nohighlight">\(\nabla\phi_{C} = \frac{1}{V_{C}}\sum\limits_{f\sim nb(C)}\phi_{f}\mathbf{S}_{f}\)</span> ；</li>
<li>返回步骤5并重复。</li>
</ol>
</div>
<div class="section" id="extended-stencil">
<h4>Extended Stencil<a class="headerlink" href="#extended-stencil" title="永久链接至标题">¶</a></h4>
<p>网格面面心 <span class="math notranslate nohighlight">\(f\)</span> 处的 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 值可以通过网格面顶点处的值的平均来计算。这就需要估计在顶点处的值，而在顶点节点的值可以通过围绕该顶点的网格质心处的值进行加权平均得到，如图所示。权重系数认为是顶点到网格质心距离的倒数，于是在顶点处的值可以表示为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{n} = \frac{\sum\limits_{k=1}^{NB(n)}\cfrac{\phi_{F_{k}}}{\| \mathbf{r}_{n} - \mathbf{r}_{F_{k}} \|}}{\sum\limits_{k=1}^{NB(n)}\cfrac{1}{\| \mathbf{r}_{n} - \mathbf{r}_{F_{k}} \|}}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(n\)</span> 表示顶点节点， <span class="math notranslate nohighlight">\(F_{k}\)</span> 表示相邻的网格质心节点， <span class="math notranslate nohighlight">\(NB(n)\)</span> 表示围绕顶点节点 <span class="math notranslate nohighlight">\(n\)</span> 的所有网格质心节点， <span class="math notranslate nohighlight">\(\| \mathbf{r}_{n} - \mathbf{r}_{F_{k}}\)</span> 表示顶点节点到相邻网格质心节点的距离。</p>
<div class="figure align-center">
<img alt="../_images/由临近网格质心值加权平均得到顶点值.png" src="../_images/由临近网格质心值加权平均得到顶点值.png" />
</div>
<p>一旦得到了顶点处的值 <span class="math notranslate nohighlight">\(\phi_{n}\)</span> ，那么面心上的值 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 就可以能够顺利得到。在二维情况下， <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 的计算方式为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \frac{\phi_{n_{1}} + \phi_{n_{2}}}{2}
\end{align}\]</div>
<p>于是在C处的梯度可以如下计算：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nabla\phi_{C} = \frac{1}{V_{C}}\sum_{f\sim nb(C)}\phi_{f}\mathbf{S}_{f}
= \frac{1}{V_{C}}\sum_{f\sim nb(C)}\Big( \frac{\phi_{n_{1}} + \phi_{n_{2}}}{2} \Big)_{f} \mathbf{S}_{f}
\end{align}\]</div>
<p>在三维情况下，计算要稍微复杂一些，因为面顶点的数量取决于网格面的类型。通过顶点值确定 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> 的方式为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \frac{\sum\limits_{k=1}^{nb(f)}\cfrac{\phi_{n_{k}}}{\| \mathbf{r}_{n_{k}} - \mathbf{r}_{f} \|}}{\sum\limits_{k=1}^{nb(f)}\cfrac{1}{\| \mathbf{r}_{n_{k}} - \mathbf{r}_{f} \|}}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(n\)</span> 表示网格面 <span class="math notranslate nohighlight">\(f\)</span> 的顶点数量。一旦计算出 <span class="math notranslate nohighlight">\(\phi_{f}\)</span> ，则可以通过下式计算出C处的梯度：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nabla\phi_{C} = \frac{1}{V_{C}}\sum_{f\sim nb(C)}\phi_{f}\mathbf{S}_{f}
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">这种方法的缺点之一是，来自网格面错误的一侧信息也会参与到变量的加权平均值。虽然这可以通过使用Cabello所讨论的迎风偏梯度来克服，但是基于迎风偏梯度的高阶算法不仅需要更高的内存开销来存储用于迎风偏梯度计算的单元信息，又增加了编码复杂度。</p>
</div>
</div>
</div>
<div class="section" id="id24">
<h3>最小二乘法梯度<a class="headerlink" href="#id24" title="永久链接至标题">¶</a></h3>
<p>使用最小二乘法来计算梯度在达到的计算精度阶数、所使用的stencil方面具有更大的灵活性。这种灵活性是有代价的，因为它需要对stencil terms进行适当的加权，而加权的计算增加了计算成本。</p>
<p>考虑一个控制体积以及它的相邻网格，在质心C和F之间的变量值可以表示为 <span class="math notranslate nohighlight">\((\phi_{F} - \phi_{C})\)</span> ，如果网格单元的梯度 <span class="math notranslate nohighlight">\((\nabla \phi_{C})\)</span> 是确定的，那么就有：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{F} = \phi_{C} + (\nabla\phi)_{C} \cdot (\mathbf{r}_{F} - \mathbf{r}_{C})
\end{align}\]</div>
<p>但是，除非计算域是线性的，否则网格单元梯度就不能被确定，因为C所具有的相邻单元比梯度向量的分量还要多。在最小二乘法中，梯度通过一个优化过程来确定，这个优化就是找到下面定义的 <span class="math notranslate nohighlight">\(G_{C}\)</span> 的最小值：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
G_{C} &amp;= \sum_{k=1}^{NB(C)}\Big( w_{k}\big(\phi_{F_{k}} - (\phi_{C} + \nabla\phi_{C} \cdot \mathbf{r}_{CF_{k}}) \big)^{2} \Big) \\
      &amp;= \sum_{k=1}^{NB(C)}\left \{ w_{k}\Big[ \Delta\phi_{k} - \Big( \Delta x_{k} (\frac{\partial \phi}{\partial x} )_{C} + \Delta y_{k}(\frac{\partial \phi}{\partial y} )_{C} + \Delta z_{k}(\frac{\partial \phi}{\partial z} )_{C} \Big) \Big]^{2} \right \}
\end{align}\end{split}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(w_{k}\)</span> 是权重因子。其他各项的具体含义为：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\phi_{k} = \phi_{F_{k}} - \phi_{C}
,\quad
\Delta x_{k} = \mathbf{r}_{CF_{k}} \cdot \mathbf{i}
,\quad
\Delta y_{k} = \mathbf{r}_{CF_{k}} \cdot \mathbf{j}
,\quad
\Delta z_{k} = \mathbf{r}_{CF_{k}} \cdot \mathbf{k}
\end{align}\]</div>
<p>函数 <span class="math notranslate nohighlight">\(G_{C}\)</span> 通过下面这个条件来实现最小化：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial G_{C}}{\partial \Big(\cfrac{\partial \phi}{\partial x} \Big)}
= \frac{\partial G_{C}}{\partial \Big(\cfrac{\partial \phi}{\partial y} \Big)}
= \frac{\partial G_{C}}{\partial \Big(\cfrac{\partial \phi}{\partial z} \Big)}
= 0
\end{align}\]</div>
<p>由上式得到含三个未知数的三个方程：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \sum_{k=1}^{NB(C)}\left \{ 2 w_{k}\Delta x_{k} \Big[-\Delta\phi_{k} + \Delta x_{k} (\frac{\partial \phi}{\partial x} )_{C} + \Delta y_{k}(\frac{\partial \phi}{\partial y} )_{C} + \Delta z_{k}(\frac{\partial \phi}{\partial z} )_{C} \Big] \right \} = 0 \\
&amp; \sum_{k=1}^{NB(C)}\left \{ 2 w_{k}\Delta y_{k} \Big[-\Delta\phi_{k} + \Delta x_{k} (\frac{\partial \phi}{\partial x} )_{C} + \Delta y_{k}(\frac{\partial \phi}{\partial y} )_{C} + \Delta z_{k}(\frac{\partial \phi}{\partial z} )_{C} \Big] \right \} = 0 \\
&amp; \sum_{k=1}^{NB(C)}\left \{ 2 w_{k}\Delta z_{k} \Big[-\Delta\phi_{k} + \Delta x_{k} (\frac{\partial \phi}{\partial x} )_{C} + \Delta y_{k}(\frac{\partial \phi}{\partial y} )_{C} + \Delta z_{k}(\frac{\partial \phi}{\partial z} )_{C} \Big] \right \} = 0
\end{align}\end{split}\]</div>
<p>上面的方程组可以写成矩阵形式：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\begin{bmatrix}
\sum\limits_{k=1}^{NB(C)}w_{k}\Delta x_{k}\Delta x_{k} &amp; \sum\limits_{k=1}^{NB(C)}w_{k}\Delta x_{k}\Delta y_{k} &amp; \sum\limits_{k=1}^{NB(C)}w_{k}\Delta x_{k}\Delta z_{k} \\
\sum\limits_{k=1}^{NB(C)}w_{k}\Delta y_{k}\Delta x_{k} &amp; \sum\limits_{k=1}^{NB(C)}w_{k}\Delta y_{k}\Delta y_{k} &amp; \sum\limits_{k=1}^{NB(C)}w_{k}\Delta y_{k}\Delta z_{k} \\
\sum\limits_{k=1}^{NB(C)}w_{k}\Delta z_{k}\Delta x_{k} &amp; \sum\limits_{k=1}^{NB(C)}w_{k}\Delta z_{k}\Delta y_{k} &amp; \sum\limits_{k=1}^{NB(C)}w_{k}\Delta z_{k}\Delta z_{k}
\end{bmatrix}
\begin{bmatrix}
\Big(\cfrac{\partial \phi}{\partial x} \Big)_{C} \\ \Big(\cfrac{\partial \phi}{\partial y} \Big)_{C} \\ \Big(\cfrac{\partial \phi}{\partial z} \Big)_{C}
\end{bmatrix}
=
\begin{bmatrix}
\sum\limits_{k=1}^{NB(C)}w_{k}\Delta x_{k}\Delta\phi_{k} \\
\sum\limits_{k=1}^{NB(C)}w_{k}\Delta y_{k}\Delta\phi_{k} \\
\sum\limits_{k=1}^{NB(C)}w_{k}\Delta z_{k}\Delta\phi_{k}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>上述方程组的解就是所要的梯度 <span class="math notranslate nohighlight">\((\nabla\phi)_{C}\)</span> 。一个解存在说明上述方程组左侧的系数矩阵不是奇异的。并且，权重因子 <span class="math notranslate nohighlight">\(w_{k}\)</span> 的选择将会影响最后计算出的梯度值。例如，如果所有相邻单元的 <span class="math notranslate nohighlight">\(w_{k}\)</span> 都设置为 <span class="math notranslate nohighlight">\(1\)</span> ，那么所有相邻单元在计算梯度的时候都会有相同的权重，无论它们距离C有多远。实际上，离C更远的点会有更重要的影响，因为误差函数更容易受到它们的误差的影响。</p>
<p>另一种设置 <span class="math notranslate nohighlight">\(w_{k}\)</span> 的方式就是使用CF距离的倒数，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
w_{k} = \frac{1}{| \mathbf{r}_{F_{k}} - \mathbf{r}_{C} |} = \frac{1}{\sqrt{\Delta x_{F_{x}}^{2} + \Delta y_{F_{k}}^{2} + \Delta z_{F_{k}}^{2}} }
\end{align}\]</div>
<p>也可以为上述距离倒数取上 <span class="math notranslate nohighlight">\(n\)</span> 次幂，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
w_{k} = \frac{1}{| \mathbf{r}_{F_{k}} - \mathbf{r}_{C} |^{n}} \qquad (n=1,2,3,\cdots)
\end{align}\]</div>
<p>实际上，基于散度的梯度计算方式是最小二乘法的一种特殊情形。这可以通过笛卡尔网格来说明，在这种情况下，最小二乘法所需求解的矩阵化简为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\begin{bmatrix}
x_{E} - x_{W} &amp; 0 &amp; 0 \\
0 &amp; y_{N} - y_{S} &amp; 0 \\
0 &amp; 0 &amp; z_{T} - z_{B}
\end{bmatrix}
\begin{bmatrix}
(\partial \phi / \partial x)_{C} \\
(\partial \phi / \partial y)_{C} \\
(\partial \phi / \partial z)_{C}
\end{bmatrix}
=
\begin{bmatrix}
\phi_{E} - \phi_{W} \\
\phi_{N} - \phi_{S} \\
\phi_{T} - \phi_{B}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>求解上述方程组，于是可以得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big(\frac{\partial \phi}{\partial x} \Big)_{C} = \frac{\phi_{E} - \phi_{W}}{x_{E} - x_{W}}
,\quad
\Big(\frac{\partial \phi}{\partial y} \Big)_{C} = \frac{\phi_{N} - \phi_{S}}{y_{N} - y_{S}}
,\quad
\Big(\frac{\partial \phi}{\partial z} \Big)_{C} = \frac{\phi_{T} - \phi_{B}}{z_{T} - z_{B}}
\end{align}\]</div>
<p>上面的结果表明基于散度的梯度是最小二乘法的特殊情形。最后，容易证明计算得到的梯度的精度至少是一阶的。这可以从泰勒展开式中看到：围绕节点C处的值 <span class="math notranslate nohighlight">\(\phi\)</span> 可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi(\mathbf{r}) - \phi(\mathbf{r}_{C}) = (\nabla\phi)_{C} \cdot (\mathbf{r} - \mathbf{r}_{C}) + O(\mathbf{r}^{2})
\end{align}\]</div>
<p>当求解 <span class="math notranslate nohighlight">\((\nabla\phi)_{C}\)</span> 时就有 <span class="math notranslate nohighlight">\(O(\mathbf{r})\)</span> 。</p>
</div>
<div class="section" id="id25">
<h3>将梯度插值到网格面<a class="headerlink" href="#id25" title="永久链接至标题">¶</a></h3>
<p>前面已经叙述过，在非结构网格中离散扩散项需要添加修正项，而修正项涉及到在网格面上的梯度值。因此，在这种情况下，梯度需要从网格质心处插值到网格面心处。如图所示，网格面上的梯度所涉及到的stencil可以从周围一圈的值等效到只与面相接的stencil。</p>
<div class="figure align-center">
<img alt="../_images/梯度插值到网格面涉及的stencil.png" src="../_images/梯度插值到网格面涉及的stencil.png" />
</div>
<p>如图所示，与网格面相接的网格单元C、F质心处的梯度值分别为 <span class="math notranslate nohighlight">\(\nabla\phi_{C}\)</span> 和 <span class="math notranslate nohighlight">\(\nabla\phi_{F}\)</span> ，插值到面上的梯度 <span class="math notranslate nohighlight">\(\overline{\nabla\phi_{f}}\)</span> 可以通过节点C、F处的值平均得到。取与网格面相接的单元作为stencil非常重要，因为这不能简单地通过平均来保证。除了平均之外，还需要迫使插值到面上的梯度在沿CF方向的值与通过节点CF定义的局部梯度相等，所以有</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nabla \phi_{f} = \overline{\nabla\phi_{f}} + \Big[ \frac{\phi_{F} - \phi_{C}}{d_{CF}} - (\overline{\nabla\phi_{f}} \cdot \mathbf{e}_{CF}) \Big]\mathbf{e}_{CF}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\nabla\phi_{f}} = g_{C}\nabla\phi_{C} + g_{F}\nabla\phi_{F}
,\quad
\mathbf{e}_{CF} = \frac{\mathbf{d}_{CF}}{d_{CF}}
,\quad
\mathbf{d}_{CF} = \mathbf{r}_{F} - \mathbf{r}_{C}
\end{align}\]</div>
<p>这个方法在结构化或非结构化网格都适用。对于非结构化网格，虽然用于网格面梯度的stencil可能不会减少，但是网格面梯度的计算仍然将基于横跨该网格面的网格节点。</p>
<div class="figure align-center">
<img alt="../_images/插值到网格面上的梯度计算方式.png" src="../_images/插值到网格面上的梯度计算方式.png" />
</div>
</div>
</div>
<div class="section" id="id26">
<h2>对流项的离散化<a class="headerlink" href="#id26" title="永久链接至标题">¶</a></h2>
<div class="section" id="id27">
<h3>一维稳态对流扩散<a class="headerlink" href="#id27" title="永久链接至标题">¶</a></h3>
<p>首先考虑简单的一维稳定对流扩散方程：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d} (\rho u\phi)}{\mathrm{d} x} - \frac{\mathrm{d} }{\mathrm{d} x}\Big( \Gamma^{\phi} \frac{\mathrm{d} \phi}{\mathrm{d} x} \Big) = 0
\end{align}\]</div>
<p>该方程具有解析解，因此可以与各种数值结果进行对比。</p>
<div class="section" id="id28">
<h4>解析解<a class="headerlink" href="#id28" title="永久链接至标题">¶</a></h4>
<p>对于一维稳态问题，其连续性方程为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d} (\rho u)}{\mathrm{d} x} = 0
\end{align}\]</div>
<p>上式表明 <span class="math notranslate nohighlight">\(\rho u\)</span> 是常数。于是，对一维稳定对流扩散方程的x进行积分得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho u\phi - \Gamma^{\phi}\frac{\mathrm{d} \phi}{\mathrm{d} x} = c_{1}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(c_{1}\)</span> 是积分常数，它的值与所使用的边界条件有关。整理上式可以得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d} \phi}{\mathrm{d} x} = \frac{\rho u}{\Gamma^{\phi}}\phi - \frac{c_{1}}{\Gamma^{\phi}}
\end{align}\]</div>
<p>进行一次变量代换，上式可以改写为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d} \Phi}{\mathrm{d} x} = \frac{\rho u}{\Gamma^{\phi}}\Phi
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Phi = \frac{\rho u}{\Gamma^{\phi}} \phi - \frac{c_{1}}{\Gamma^{\phi}}
\end{align}\]</div>
<p>分离变量并积分，上式的解为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d} \Phi}{\Phi} = \frac{\rho u}{\Gamma^{\phi}}\mathrm{d}x
\quad \Rightarrow \quad
\ln(\Phi) = \frac{\rho u}{\Gamma^{\phi}}x + c_{3}
\quad \Rightarrow \quad
\Phi = c_{2}e^{(\rho u/\Gamma^{\phi})x}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(c_{2}\)</span> 为另一个积分常数。将其代换回原变量，得到通解为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi = \frac{c_{2}\Gamma^{\phi}e^{(\rho u/\Gamma^{\phi})x} + c_{1}}{\rho u}
\end{align}\]</div>
<p>因此，W和E两点之间的解析解如图所示，且满足</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\phi - \phi_{W}}{\phi_{E} - \phi_{W}} = \frac{\exp(Pe_{L}\cfrac{x - x_{W}}{L}) - 1}{\exp(Pe_{L}) - 1}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 是基于长度 <span class="math notranslate nohighlight">\(L\)</span> 的Péclet数，它表示对流输运率和扩散输运率的比值，定义为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
Pe_{L} = \frac{\rho u L}{\Gamma^{\phi}} \qquad(L = x_{E} - x_{W})
\end{align}\]</div>
<p>对不同的 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 值计算上式，结果如图所示，可以看到，W和E之间的变化从纯扩散问题的线性轮廓变成了高 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 数时的阶梯形轮廓。</p>
<div class="figure align-center">
<img alt="../_images/一维稳态对流扩散问题.png" src="../_images/一维稳态对流扩散问题.png" />
</div>
</div>
<div class="section" id="id29">
<h4>数值解<a class="headerlink" href="#id29" title="永久链接至标题">¶</a></h4>
<p>对一维稳态对流扩散方程的离散可以从对一维单元积分得到，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{V_{c}}[\nabla \cdot (\rho\mathbf{U}\phi) - \nabla\cdot (\Gamma^{\phi}\nabla\phi)]~\mathrm{d}V = 0
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\mathbf{U} = u\mathbf{i}\)</span> 是速度矢量。对流方程可以写成对流通量与扩散通量的形式，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{V_{c}}\nabla \cdot (\mathbf{J}^{\phi,C} + \mathbf{J}^{\phi,D})~\mathrm{d}V = 0
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\mathbf{J}^{\phi,C} = \rho\mathbf{U}\phi\)</span> ， <span class="math notranslate nohighlight">\(\mathbf{J}^{\phi,D} = -\Gamma^{\phi}\nabla\phi\)</span> 。于是，根据散度定理，体积积分可以转换为表面积分，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{V_{c}}\nabla \cdot (\mathbf{J}^{\phi,C} + \mathbf{J}^{\phi,D})~\mathrm{d}V
= \int_{\partial V_{c}}(\mathbf{J}^{\phi,C} + \mathbf{J}^{\phi,D})\cdot \mathrm{d}\mathbf{S}
= \int_{\partial V_{c}}\Big[ \rho u\phi\mathbf{i} - \Gamma^{\phi}\frac{\mathrm{d}\phi}{\mathrm{d}x}\mathbf{i} \Big] \cdot \mathrm{d}\mathbf{S}
= 0
\end{align}\]</div>
<p>将表面积分替换为网格表面的通量求和，上式就变成了</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\sum_{f\sim nb(C)}\Big( \rho u\phi\mathbf{i} - \Gamma^{\phi}\frac{\mathrm{d}\phi}{\mathrm{d}x}\mathbf{i}\Big)_{f} \cdot \mathbf{S}_{f} = 0
\end{align}\]</div>
<p>注意到网格表面的速度矢量在单元的不同侧会反号，那么上式对于一个固定截面的情况下可以展开成下面的形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big[ (\rho u\Delta y\phi)_{e} - \Big( \Gamma^{\phi}\frac{\mathrm{d} \phi}{\mathrm{d} x}\Delta y \Big)_{e} \Big]
- \Big[ (\rho u\Delta y\phi)_{w} - \Big( \Gamma^{\phi}\frac{\mathrm{d} \phi}{\mathrm{d} x}\Delta y \Big)_{w} \Big]
= 0
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(u\)</span> 在网格面上的值是已知的，并且梯度可以用前面叙述的方法进行离散。问题是，如何根据相邻节点的值离散网格面的值 <span class="math notranslate nohighlight">\(\phi_{e}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{w}\)</span> 。用来确定这些网格面上的值的方法称为“对流格式”。</p>
</div>
</div>
<div class="section" id="id30">
<h3>中心差分格式<a class="headerlink" href="#id30" title="永久链接至标题">¶</a></h3>
<p>一个很直接的想法就是使用与扩散项类似的线性插值方法。因此，在给定网格面上的值 <span class="math notranslate nohighlight">\(\phi\)</span> 就可以如下计算：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi(x) = k_{0} + k_{1}(x - x_{C})
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(k_{0}\)</span> 和 <span class="math notranslate nohighlight">\(k_{1}\)</span> 是通过网格面相邻网格节点得到的常数。因此，对于网格面 <span class="math notranslate nohighlight">\(e\)</span> ，根据 <span class="math notranslate nohighlight">\(x=x_{E}\)</span> 处满足 <span class="math notranslate nohighlight">\(\phi=\phi_{E}\)</span> 以及 <span class="math notranslate nohighlight">\(x=x_{C}\)</span> 处满足 <span class="math notranslate nohighlight">\(\phi=\phi_{C}\)</span> 的条件，由上式分析 <span class="math notranslate nohighlight">\(x=x_{e}\)</span> 处的值得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{e} = \phi_{C} + \frac{\phi_{E} - \phi_{C}}{x_{E} - x_{C}}(x_{e} - x_{C})
\end{align}\]</div>
<p>这就是基本的中心差分格式，它可以通过泰勒二阶展开式得到，也就意味着它具有二阶精度。对于如图所示的均一网格，上式可以化简为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{e} = \frac{\phi_{C} + \phi_{E}}{2}
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/中心差分格式.png" src="../_images/中心差分格式.png" />
</div>
<p>因此，在经过上述的线性方式离散扩散项之后，那么方程第一项就可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho u\Delta y\phi)_{e} - \Big( \Gamma^{\phi}\frac{\mathrm{d} \phi}{\mathrm{d} x}\Delta y \Big)_{e}
= (\rho u\Delta y)_{e}\frac{\phi_{E} + \phi_{C}}{2} - \Big( \Gamma^{\phi}\frac{\Delta y}{\delta x} \Big)_{e} (\phi_{E} - \phi_{C})
= \text{FluxC}_{e}\phi_{C} + \text{FluxF}_{e}\phi_{E} + \text{FluxV}_{e}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{FluxC}_{e} = \Gamma^{\phi}_{e}\frac{\Delta y_{e}}{\delta x_{e}} + \frac{(\rho u\Delta y)_{e}}{2}
,\quad
\text{FluxF}_{e} = -\Gamma^{\phi}_{e}\frac{\Delta y_{e}}{\delta x_{e}} + \frac{(\rho u\Delta y)_{e}}{2}
,\quad
\text{FluxV}_{e} = 0
\end{align}\]</div>
<p>类似的，方程的第二项可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
- \Big[ (\rho u\Delta y\phi)_{w} - \Big( \Gamma^{\phi}\frac{\mathrm{d} \phi}{\mathrm{d} x}\Delta y \Big)_{w} \Big]
= - \Big[ (\rho u\Delta y)_{w}\frac{\phi_{W} + \phi_{C}}{2} - \Big( \Gamma^{\phi}\frac{\Delta y}{\delta x} \Big)_{w}(\phi_{C} - \phi_{W}) \Big]
= \text{FluxC}_{w}\phi_{C} + \text{FluxF}_{w}\phi_{W} + \text{FluxV}_{w}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{FluxC}_{w} = \Gamma^{\phi}_{w}\frac{\Delta y_{w}}{\delta x_{w}} - \frac{(\rho u\Delta y)_{w}}{2}
,\quad
\text{FluxF}_{w} = -\Gamma^{\phi}_{w}\frac{\Delta y_{w}}{\delta x_{w}} - \frac{(\rho u\Delta y)_{w}}{2}
,\quad
\text{FluxV}_{w} = 0
\end{align}\]</div>
<p>将上述方程全部代入到对流扩散方程中，得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} = 0
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = \text{FluxF}_{e} = -\Gamma^{\phi}_{e}\frac{\Delta y_{e}}{\delta x_{e}} + \frac{(\rho u\Delta y)_{e}}{2} \\
&amp; a_{W} = \text{FluxF}_{w} = -\Gamma^{\phi}_{w}\frac{\Delta y_{w}}{\delta x_{w}} - \frac{(\rho u\Delta y)_{w}}{2} \\
&amp; a_{C} = \text{FluxC}_{e} + \text{FluxC}_{w} = \Big( \frac{(\rho u\Delta y)_{e}}{2} + \Gamma^{\phi}_{e}\frac{\Delta y_{e}}{\delta x_{e}} \Big) + \Big( -\frac{(\rho u\Delta y)_{w}}{2} + \Gamma^{\phi}_{w}\frac{\Delta y_{w}}{\delta x_{w}}\Big)
\end{align}\end{split}\]</div>
<p>在这个一维问题中 <span class="math notranslate nohighlight">\(\Delta y_{e} = \Delta y_{w}\)</span> ，并且不失一般性地可以设为 <span class="math notranslate nohighlight">\(1\)</span> 。同时，根据连续性方程可知 <span class="math notranslate nohighlight">\((\rho u\Delta y)_{e} - (\rho u\Delta y)_{w} = 0\)</span> 。假设扩散系数是均一的，那么上面的离散方程系数就可以简化为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = - \frac{\Gamma^{\phi}}{x_{E} - x_{C}} + \frac{(\rho u)_{e}}{2} \\
&amp; a_{W} = - \frac{\Gamma^{\phi}}{x_{C} - x_{W}} - \frac{(\rho u)_{w}}{2} \\
&amp; a_{C} = - (a_{E} + a_{W})
\end{align}\end{split}\]</div>
<p>将上述系数代入到离散方程当中，那么 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的值满足</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\phi_{C} - \phi_{W}}{\phi_{E} - \phi_{W}} = \frac{a_{E}}{a_{E} + a_{W}}
\end{align}\]</div>
<p>如果网格是均一的，那么上述方程可以写成关于 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 的形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\phi_{C} - \phi_{W}}{\phi_{E} - \phi_{W}} = \frac{1}{2}\Big(1 - \frac{Pe_{L}}{2}\Big)
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(L\)</span> 是 <span class="math notranslate nohighlight">\((x_{E} - x_{W})\)</span> ，也就是两个单元的大小。</p>
<p>这个问题的解析解可以通过令 <span class="math notranslate nohighlight">\((x-x_{W})/L=0.5\)</span> 得到：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\phi_{C} - \phi_{W}}{\phi_{E} - \phi_{W}} = \frac{e^{Pe_{L}/2} - 1}{e^{Pe_{L}}-1}
\end{align}\]</div>
<p>如图所示，中心差分数值解与解析解在 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 值较低的时候非常接近，但是当 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 增大到一定值之后，中心差分格式的数值解就与解析解的结果有相当的差距而变得非物理。</p>
<div class="figure align-center">
<img alt="../_images/中心差分数值解与解析解的对比.png" src="../_images/中心差分数值解与解析解的对比.png" />
</div>
<p>这个非物理现象意味着中心差分格式在推导的时候存在非物理的假设。如图所示，C点的扩散过程对C点上游和下游条件的影响相同，而对流过程是一个高度定向的过程，仅仅在流动方向上传递特性。因此，对迎风和顺风节点赋予相同的权重的线性近似，在扩散项处理中是非常好的；但是，它不能描述处对流的方向偏好，对于对流项，阶跃方法更加合适，这就是原因所在。</p>
<p>因此，只要扩散过程是主要的传递机制，使用线性方法就能够得到符合物理的结果。但是，一旦对流过程压倒扩散过程，仍使用线性方法就会得到非物理结果。容易计算出发生这种情况的Péclet数的值——假设流动为x正方向，当系数 <span class="math notranslate nohighlight">\(a_{E}\)</span> 为正的时候就会导致非物理结果（如果流动为x负方向则考虑 <span class="math notranslate nohighlight">\(a_{W}\)</span> ）：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
- \Gamma^{\phi}_{e} \frac{\Delta y_{e}}{\delta x_{e}} + \frac{(\rho u\Delta y)_{e}}{2} &gt; 0
\quad \Rightarrow \quad
\frac{(\rho u)_{e}\delta x_{e}}{\Gamma^{\phi}_{e}} &gt; 2
\end{align}\]</div>
<p>定义网格的Péclet数为 <span class="math notranslate nohighlight">\(Pe = \frac{\rho u\delta x}{\Gamma^{\phi}}\)</span> ，其中对于均一网格来说就等于 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 的一般，于是上述条件就可以改写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
Pe &gt; 2
\end{align}\]</div>
<p>因此，对于网格Péclet数大于 <span class="math notranslate nohighlight">\(2\)</span> 的情况，离散化过程变得不再一致，因为现在相邻值的增加C处值的减小，而这反过来又将导致相邻值进一步增大，并且误差被放大。这个问题可以通过减小网格的大小来是单元Péclet数小于 <span class="math notranslate nohighlight">\(2\)</span> 来避免，然而对于许多实际情况，存储和计算需求的增加可能太大而无法承担。此外，对于纯对流流动（如欧拉流），则是根本不可行的，所以需要其他措施。</p>
<p>中心差分格式的截断误差在有限体积法中比较复杂，因为梯度的计算需要再网格表面插值而不是在网格中心节点插值。假设速度在各处都是已知的，网格是均一的且大小为 <span class="math notranslate nohighlight">\(\Delta x\)</span> ，那么中心差分近似就是对 <span class="math notranslate nohighlight">\((\phi_{e} - \phi_{w})\)</span> 计算的近似，可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\underbrace{(\phi_{e} - \phi_{w})}_{\text{Interpolated}}
= \frac{1}{2}(\phi_{E} + \phi_{C})
  - \frac{1}{2}(\phi_{C} + \phi_{W})
=  \underbrace{(\phi_{e} - \phi_{w})}_{\text{Exact}} + TE
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(TE\)</span> 表示截断误差。为了计算该截断误差，就需要下面的泰勒展开：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \phi_{W} = \phi_{w}
  - \frac{\Delta x}{2}\phi_{w}'
  + \frac{\Delta x^{2}}{8}\phi_{w}''
  - \frac{\Delta x^{3}}{48}\phi_{w}'''
  + \frac{\Delta x^{4}}{384}\phi_{w}^{iv}
  - \frac{\Delta x^{5}}{3840}\phi_{w}^{v}
  + \cdots
\\
&amp; \phi_{C} = \phi_{w}
  + \frac{\Delta x}{2}\phi_{w}'
  + \frac{\Delta x^{2}}{8}\phi_{w}''
  + \frac{\Delta x^{3}}{48}\phi_{w}'''
  + \frac{\Delta x^{4}}{384}\phi_{w}^{iv}
  + \frac{\Delta x^{5}}{3840}\phi_{w}^{v}
  + \cdots
\\
&amp; \phi_{C} = \phi_{e}
  - \frac{\Delta x}{2}\phi_{e}'
  + \frac{\Delta x^{2}}{8}\phi_{e}''
  - \frac{\Delta x^{3}}{48}\phi_{e}'''
  + \frac{\Delta x^{4}}{384}\phi_{e}^{iv}
  - \frac{\Delta x^{5}}{3840}\phi_{e}^{v}
  + \cdots
\\
&amp; \phi_{E} = \phi_{e}
  + \frac{\Delta x}{2}\phi_{e}'
  + \frac{\Delta x^{2}}{8}\phi_{e}''
  + \frac{\Delta x^{3}}{48}\phi_{e}'''
  + \frac{\Delta x^{4}}{384}\phi_{e}^{iv}
  + \frac{\Delta x^{5}}{3840}\phi_{e}^{v}
  + \cdots
\end{align}\end{split}\]</div>
<p>使用上述展开式，在面上的均值可以如下得到：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \frac{1}{2}(\phi_{E} + \phi_{C})
= \phi_{e} + \frac{\Delta x^{2}}{8}\phi_{e}'' + \frac{\Delta x^{4}}{384}\phi_{e}^{iv} + \cdots
\quad\Rightarrow\quad
\frac{\Delta x^{2}}{4}\phi_{e}''
= (\phi_{C} - 2\phi_{e} + \phi_{E}) - \frac{\Delta x^{4}}{192}\phi_{e}^{iv} + \cdots
\\
&amp; \frac{1}{2}(\phi_{C} + \phi_{W})
= \phi_{w} + \frac{\Delta x^{2}}{8}\phi_{w}'' + \frac{\Delta x^{4}}{384}\phi_{w}^{iv} + \cdots
\quad\Rightarrow\quad
\frac{\Delta x^{2}}{4}\phi_{w}'' = (\phi_{W} - 2\phi_{w} + \phi_{C}) - \frac{\Delta x^{4}}{192}\phi_{w}^{iv} + \cdots
\end{align}\end{split}\]</div>
<p>上面两个式子相减就得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{1}{2}(\phi_{E} + \phi_{C})
- \frac{1}{2}(\phi_{C} + \phi_{W})
= (\phi_{e} - \phi_{w})
+ \frac{\Delta x^{2}}{8}(\phi_{e}'' - \phi_{w}'')
+ \frac{\Delta x^{4}}{384}(\phi_{e}^{iv} - \phi_{w}^{iv})
+ \cdots
\end{align}\]</div>
<p>更进一步的， <span class="math notranslate nohighlight">\(\phi_{e}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{w}\)</span> 对 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的泰勒展开则分别为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \phi_{e} = \phi_{C}
  + \frac{\Delta x}{2}\phi_{C}'
  + \frac{\Delta x^{2}}{8}\phi_{C}''
  + \frac{\Delta x^{3}}{48}\phi_{C}'''
  + \frac{\Delta x^{4}}{384}\phi_{C}^{iv}
  + \frac{\Delta x^{5}}{3840}\phi_{C}^{v}
  + \cdots
\\
&amp; \phi_{w} = \phi_{C}
  - \frac{\Delta x}{2}\phi_{C}'
  + \frac{\Delta x^{2}}{8}\phi_{C}''
  - \frac{\Delta x^{3}}{48}\phi_{C}'''
  + \frac{\Delta x^{4}}{384}\phi_{C}^{iv}
  - \frac{\Delta x^{5}}{3840}\phi_{C}^{v}
  + \cdots
\end{align}\end{split}\]</div>
<p>另外， <span class="math notranslate nohighlight">\(\phi_{E}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{W}\)</span> 也可以展开成 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的序列：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \phi_{E} = \phi_{C}
  + \Delta x\phi_{C}'
  + \frac{\Delta x^{2}}{2}\phi_{C}''
  + \frac{\Delta x^{3}}{6}\phi_{C}'''
  + \frac{\Delta x^{4}}{24}\phi_{C}^{iv}
  + \frac{\Delta x^{5}}{120}\phi_{C}^{v}
  + \cdots
\\
&amp; \phi_{W} = \phi_{C}
  - \Delta x \phi_{C}'
  + \frac{\Delta x^{2}}{2}\phi_{C}''
  - \frac{\Delta x^{3}}{6}\phi_{C}'''
  + \frac{\Delta x^{4}}{24}\phi_{C}^{iv}
  - \frac{\Delta x^{5}}{120}\phi_{C}^{v}
  + \cdots
\end{align}\end{split}\]</div>
<p>使用上述两组方程可以得到</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\phi_{C} - 2\phi_{e} + \phi_{E}
&amp;= \phi_{C} - 2\phi_{C} - \Delta x \phi_{C}'
  - \frac{\Delta x^{2}}{4}\phi_{C}'' - \frac{\Delta x^{3}}{24}\phi_{C}'''
  - \frac{\Delta x^{4}}{192}\phi_{C}^{iv} - \frac{\Delta x^{5}}{1920}\phi_{C}^{v} + \cdots
\\
&amp; \quad + \phi_{C} + \Delta x \phi_{C}'
  + \frac{\Delta x^{2}}{2}\phi_{C}'' + \frac{\Delta x^{3}}{6}\phi_{C}'''
  + \frac{\Delta x^{4}}{24}\phi_{C}^{iv} + \frac{\Delta x^{5}}{120}\phi_{C}^{v} + \cdots
\\
&amp;= \frac{\Delta x^{2}}{4}\phi_{C}'' + \frac{\Delta x^{3}}{8}\phi_{C}'''
  + \frac{7 \Delta x^{4}}{192}\phi_{C}^{iv} + \frac{15\Delta x^{5}}{1920}\phi_{C}^{v} + \cdots
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{W} - 2\phi_{w} + \phi_{C}
= \frac{\Delta x^{2}}{4}\phi_{C}''
  - \frac{\Delta x^{3}}{8}\phi_{C}'''
  + \frac{7\Delta x^{4}}{192}\phi_{C}^{iv}
  - \frac{15\Delta x^{5}}{1920}\phi_{C}^{v}
  + \cdots
\end{align}\]</div>
<p>于是可以得到 <span class="math notranslate nohighlight">\((\phi_{e}'' - \phi_{w}'')\)</span> 的表达式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\Delta x^{2}}{8}(\phi_{e}'' - \phi_{w}'')
= \frac{\Delta x^{3}}{8}\phi_{C}'''
  + \frac{\Delta x^{5}}{128}\phi_{C}^{v}
  + \cdots
\end{align}\]</div>
<p>代入回作差方程就将其转换为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{1}{2}(\phi_{E} + \phi_{C})
- \frac{1}{2}(\phi_{C} + \phi_{W})
= \phi_{e} - \phi_{w}
  + \frac{\Delta x^{3}}{8}\phi_{C}'''
  + \frac{\Delta x^{5}}{128}\phi_{C}^{v}
  + \cdots
\end{align}\]</div>
<p>通过除以 <span class="math notranslate nohighlight">\(\Delta x\)</span> 即可得到与梯度计算有关的截断误差为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
TE = \frac{\Delta x^{2}}{8}\phi_{C}''' + \frac{\Delta x^{4}}{128}\phi_{C}^{v} + \cdots
\end{align}\]</div>
<p>这表明中心差分格式具有二阶精度。</p>
</div>
<div class="section" id="id31">
<h3>一阶迎风格式<a class="headerlink" href="#id31" title="永久链接至标题">¶</a></h3>
<p>线性对称方法给两个节点提供了相同的权重，在网格面上没有方向偏重，这适用于无方向性现象的椭圆型项（如扩散项），但对于对流项来说是不合适的。一种更适合对流过程的格式是迎风格式(upwind scheme)。如图所示，迎风格式基本上模拟了对流过程的基本物理过程，因为网格表面值依赖于迎风节点值，即依赖于流动方向。在这个情况下，网格面上的值如下得到：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\phi_{e} = \left\{\begin{array}{ll}\phi_{C} \quad \text{if}~\dot{m}_{e}&gt;0 \\ \phi_{E} \quad \text{if}~\dot{m}_{e}&lt;0 \end{array}\right.
,\quad
\phi_{w} = \left\{\begin{array}{ll}\phi_{C} \quad \text{if}~\dot{m}_{e}&gt;0 \\ \phi_{W} \quad \text{if}~\dot{m}_{e}&lt;0 \end{array}\right.
\end{align}\end{split}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\dot{m}_{e}\)</span> 和 <span class="math notranslate nohighlight">\(\dot{m}_{w}\)</span> 分别是在网格面 <span class="math notranslate nohighlight">\(e\)</span> 和 <span class="math notranslate nohighlight">\(w\)</span> 的质量通量：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \dot{m}_{e} = (\rho\mathbf{U}\cdot \mathbf{S})_{e} = (\rho uS)_{e} = (\rho u \Delta y)_{e} \\
&amp; \dot{m}_{w} = (\rho\mathbf{U}\cdot \mathbf{S})_{w} = -(\rho uS)_{w} = -(\rho u\Delta y)_{w}
\end{align}\end{split}\]</div>
<div class="figure align-center">
<img alt="../_images/一阶迎风格式.png" src="../_images/一阶迎风格式.png" />
</div>
<p>因此，在网格面 <span class="math notranslate nohighlight">\(e\)</span> 的对流通量可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\dot{m}_{e}\phi_{e} = \max(\dot{m}_{e}, 0)\phi_{C} - \max(-\dot{m}_{e}, 0)\phi_{E}
= \text{FluxC}_{e}^{Conv}\phi_{C} + \text{FluxF}_{e}^{Conv}\phi_{E} + \text{FluxV}_{e}^{Conv}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{FluxC}_{e}^{Conv} = \max(\dot{m}_{e}, 0)
,\quad
\text{FluxF}_{e}^{Conv} = -\max(-\dot{m}_{e}, 0)
,\quad
\text{FluxV}_{e}^{Conv} = 0
\end{align}\]</div>
<p>类似地，可以得到在网格面 <span class="math notranslate nohighlight">\(w\)</span> 的对流通量可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\dot{m}_{w}\phi_{w} = \max(\dot{m}_{w}, 0)\phi_{C} - \max(-\dot{m}_{w}, 0)\phi_{W}
= \text{FluxC}_{w}^{Conv}\phi_{C} + \text{FluxF}_{w}^{Conv}\phi_{W} + \text{FluxV}_{w}^{Conv}
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\text{FluxC}_{w}^{Conv} = \max(\dot{m}_{w}, 0)
,\quad
\text{FluxF}_{w}^{Conv} = -\max(-\dot{m}_{w}, 0)
,\quad
\text{FluxV}_{w}^{Conv} = 0
\end{align}\]</div>
<p>同时考虑扩散通量的贡献（以上标Diff表示），将它们全部代入离散方程当中得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\text{FluxC}_{e}^{Conv} + \text{FluxC}_{e}^{Diff} + \text{FluxC}_{w}^{Conv} + \text{FluxC}_{w}^{Diff})\phi_{C}
+ (\text{FluxF}_{e}^{Conv} + \text{FluxF}_{e}^{Diff})\phi_{E}
+ (\text{FluxF}_{w}^{Conv} + \text{FluxF}_{w}^{Diff})\phi_{W}
= 0
\end{align}\]</div>
<p>上式可以整合为下面的形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} = 0
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = \text{FluxF}_{e}^{Conv} + \text{FluxF}_{e}^{Diff} = -\max(-\dot{m}_{e}, 0) - \Gamma^{\phi}_{e}\frac{S_{e}}{\delta x_{e}} \\
&amp; a_{W} = \text{FluxF}_{w}^{Conv} + \text{FluxF}_{w}^{Diff} = -\max(-\dot{m}_{w}, 0) - \Gamma^{\phi}_{w}\frac{S_{w}}{\delta x_{w}} \\
&amp; a_{C} = \sum_{f}\Big( \text{FluxC}_{f}^{Conv} + \text{FluxC}_{f}^{Diff} \Big)
= \max(\dot{m}_{e}, 0) + \max(\dot{m}_{w}, 0) + \Gamma^{\phi}_{e}\frac{S_{e}}{\delta x_{e}} + \Gamma^{\phi}_{w}\frac{S_{w}}{\delta x_{w}}
= - (a_{E} + a_{W}) + (\dot{m}_{e} + \dot{m}_{w}) \\
&amp; b_{C} = - \sum_{f} \Big( \text{FluxV}_{f}^{Conv} + \text{FluxV}_{f}^{Diff} \Big) = 0
\end{align}\end{split}\]</div>
<p>容易发现，迎风格式能够得到负的相邻单元系数，并且根据连续性方程，可以得到主要节点的系数满足</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C} = -(a_{W} + a_{E})
\end{align}\]</div>
<p>这就保证了有界条件。将连续性约束代入到系数表达式，并考虑均一网格、扩散系数为常数，那么</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\phi_{C} - \phi_{W}}{\phi_{E} - \phi_{W}}
= \frac{2 + \max(-Pe_{L}, 0)}{4 + \max(-Pe_{L}, 0) + \max(Pe_{L}, 0)}
= \frac{2 + \max(-Pe_{L}, 0)}{4 + |Pe_{L}|}
\end{align}\]</div>
<p>如图所示，在 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 值较低的时候，迎风格式没有中心差分格式那么精确，这也是可以理解的，因为迎风格式只有一阶精度而线性格式有二阶精度。当 <span class="math notranslate nohighlight">\(Pe_{L}\)</span> 值较高时，中心差分格式不再稳定，因为它的解无界且非物理；而迎风格式虽然不是很精确，但物理趋势是正确的。因此，准确性和稳定性之间存在一种权衡。使用迎风格式能在较高Péclet数的情况下仍有良好的表现与有界性，但是这是牺牲精度来实现的。另一方面，二阶中心差分格式在超过一定Péclet数后变得不稳定，从而导致物理上错误的解。</p>
<div class="figure align-center">
<img alt="../_images/迎风格式与解析解的对比.png" src="../_images/迎风格式与解析解的对比.png" />
</div>
<p>下面分析迎风格式的截断误差问题。考虑由迎风格式得到的离散方程，为了恢复积分方程以考虑截断误差，就要将 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{W}\)</span> 分别写成 <span class="math notranslate nohighlight">\(\phi_{e}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{w}\)</span> 的方程。这里假设流动朝 <span class="math notranslate nohighlight">\(x\)</span> 的正方向。在迎风格式中则有</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{e} = \phi_{C},
\qquad
\phi_{w} = \phi_{W}
\end{align}\]</div>
<p>因此，使用迎风格式的一维对流扩散离散方程化简为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho u\Delta y)_{e}\phi_{C}
- (\rho u\Delta y)_{w}\phi_{W}
- \Big[
  \Big( \Gamma^{\phi}\frac{\mathrm{d}\phi}{\mathrm{d}x}\Delta y \Big)_{e}
  - \Big( \Gamma^{\phi}\frac{\mathrm{d}\phi}{\mathrm{d}x}\Delta y \Big)_{w}
  \Big]
= 0
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\phi_{C}\)</span> 在网格面 <span class="math notranslate nohighlight">\(e\)</span> 处的一维泰勒展开为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{C} = \phi_{e}
+ \Big(\frac{\mathrm{d} \phi}{\mathrm{d} x}\Big)_{e}(x_{C} - x_{e})
+ \frac{1}{2}\Big(\frac{\mathrm{d}^{2} \phi}{\mathrm{d} x^{2}}\Big)_{e} (x_{C} - x_{e})^{2}
+ \cdots
= \phi_{e} - \Big(\frac{\mathrm{d} \phi}{\mathrm{d} x}\Big)_{e}(x_{e} - x_{C}) + \cdots
\end{align}\]</div>
<p>对于均匀网格则变成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{C} = \phi_{e}
- \Big(\frac{\mathrm{d} \phi}{\mathrm{d} x}\Big)_{e}\frac{(\delta x)_{e}}{2}
+ \frac{1}{2}\Big(\frac{\mathrm{d}^{2}\phi}{\mathrm{d}x^{2}} \Big)_{e} \Big(\frac{(\delta x)_{e}}{2} \Big)^{2}
\cdots
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\phi_{W}\)</span> 也可以得到类似的表达式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{W} = \phi_{w} - \Big(\frac{\mathrm{d} \phi}{\mathrm{d} x}\Big)_{w}\frac{(\delta x)_{w}}{2} + \frac{1}{2}\Big(\frac{\mathrm{d}^{2}\phi}{\mathrm{d} x^{2}} \Big)_{w}\Big(\frac{(\delta x)_{w}}{2}\Big)^{2} \cdots
\end{align}\]</div>
<p>忽略二阶及以上的项，然后代入到对流项当中，那么离散方程等号左侧就变成了</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho u\Delta y)_{e}\phi_{C}
- (\rho u\Delta y)_{w}\phi_{W}
- \Big[
  \Big( \Gamma^{\phi}\frac{\mathrm{d}\phi}{\mathrm{d}x}\Delta y \Big)_{e}
  - \Big( \Gamma^{\phi}\frac{\mathrm{d}\phi}{\mathrm{d}x}\Delta y \Big)_{w}
  \Big]
=
(\rho u \Delta y)_{e} \Big[ \phi_{e} - \Big(\frac{\mathrm{d} \phi}{\mathrm{d} x} \Big)_{e} \frac{\delta x_{e}}{2} \Big]
- (\rho u \Delta y)_{w} \Big[ \phi_{w} - \Big(\frac{\mathrm{d} \phi}{\mathrm{d} x} \Big)_{w}\frac{\delta x_{w}}{2} \Big]
- \Big[ \Big( \Gamma^{\phi}\frac{\mathrm{d} \phi}{\mathrm{d} x}\Delta y \Big)_{e} - \Big(\Gamma^{\phi}\frac{\mathrm{d} \phi}{\mathrm{d} x} \Delta y\Big)_{w} \Big]
\end{align}\]</div>
<p>整理后可以得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho u\Delta y)_{e}\phi_{C}
- (\rho u\Delta y)_{w}\phi_{W}
- \Big[
  \Big( \Gamma^{\phi}\frac{\mathrm{d}\phi}{\mathrm{d}x}\Delta y \Big)_{e}
  - \Big( \Gamma^{\phi}\frac{\mathrm{d}\phi}{\mathrm{d}x}\Delta y \Big)_{w}
  \Big]
=
(\rho u \Delta y)_{e} \phi_{e}
- (\rho u \Delta y)_{w} \phi_{w}
- \bigg[
  \Big( \Gamma^{\phi} + \rho u\frac{\delta x}{2} \Big)_{e} \Big( \frac{\mathrm{d} \phi}{\mathrm{d} x}\Delta y \Big)_{e}
  - \Big( \Gamma^{\phi} + \rho u \frac{\delta x}{2} \Big)_{w} \Big( \frac{\mathrm{d} \phi}{\mathrm{d} x} \Delta y\Big)_{w}
  \bigg]
\end{align}\]</div>
<p>显然可以看到所求解的方程中额外产生了一个扩散分量，这被称为截断误差。该数值扩散的值为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Gamma^{\phi}_{\text{truncation}} = \rho u \frac{\delta x}{2}
\end{align}\]</div>
<p>该截断误差也称顺流扩散(stream wise diffusion)，由于修改了扩散系数的大小导致求解的精度降低。因此，对流和扩散方程额外产生扩散效应。另一方面，这个顺流扩散也是需要的，因为它能够使求解保持有界以保证物理正确性。</p>
<p>显然，要想减小顺流数值扩散就需要使用更高阶的对对流项的估计，这需要用某种方式保持解的有界性。</p>
</div>
<div class="section" id="id32">
<h3>顺风格式<a class="headerlink" href="#id32" title="永久链接至标题">¶</a></h3>
<p>顺风格式(downwind scheme)是与迎风格式完全相反的格式，节点值由交界面下游处的值提供，因此在面 <span class="math notranslate nohighlight">\(e\)</span> 和 <span class="math notranslate nohighlight">\(w\)</span> 处的值如下进行计算：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\phi_{e} = \left \{\begin{array}{ll}
\phi_{E} \quad \text{if}~\dot{m}_{e} &gt; 0 \\
\phi_{C} \quad \text{if}~\dot{m}_{e} &lt; 0
\end{array}\right .
\qquad
\phi_{w} = \left \{\begin{array}{ll}
\phi_{W} \quad \text{if}~\dot{m}_{e} &gt; 0 \\
\phi_{C} \quad \text{if}~\dot{m}_{e} &lt; 0
\end{array}\right .
\end{align}\end{split}\]</div>
<p>根据上式，在网格面上的对流通量可以写成</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \dot{m}_{e}\phi_{e}
= - \| -\dot{m}_{e} , 0 \| \phi_{C}
  + \| \dot{m}_{e} , 0 \| \phi_{E}
= \text{FluxC}_{e}^{Conv}\phi_{C}
  + \text{FluxF}_{e}^{Conv}\phi_{E}
  + \text{FluxV}_{e}^{Conv}
\\
&amp; \dot{m}_{w}\phi_{w}
= - \| -\dot{m}_{w},0 \|
  + \| \dot{m}_{w} ,0 \| \phi_{W}
= \text{FluxC}_{w}^{Conv}\phi_{C}
  + \text{FluxF}_{w}^{Conv}\phi_{W}
  + \text{FluxF}_{w}^{Conv}
\end{align}\end{split}\]</div>
<p>将上式代入到离散方程当中，得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
( \text{FluxC}_{e}^{Conv}
  + \text{FluxC}_{e}^{Diff}
  + \text{FluxC}_{w}^{Conv}
  + \text{FluxC}_{w}^{Diff}
) \phi_{C}
+ (\text{FluxF}_{e}^{Conv} + \text{FluxF}_{e}^{Diff}) \phi_{E}
+ (\text{FluxF}_{w}^{Conv} + \text{FluxF}_{w}^{Diff}) \phi_{W}
= 0
\end{align}\]</div>
<p>该方程可以简写成如下形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} = 0
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E}
  = \text{FluxF}_{e}^{Conv} + \text{FluxF}_{e}^{Diff}
  = \| \dot{m}_{e} ,0 \| - \Gamma_{e}^{\phi}\frac{S_{e}}{\delta x_{e}}
\\
&amp; a_{W}
  = \text{FluxF}_{w}^{Conv} + \text{FluxF}_{w}^{Diff}
  = \| \dot{m}_{w} ,0 \| - \Gamma_{w}^{\phi}\frac{S_{w}}{\delta x_{w}}
\\
&amp; a_{C}
  = \sum_{f}\Big( \text{FluxC}_{f}^{Conv} + \text{FluxC}_{f}^{Diff} \Big)
  = - \| -\dot{m}_{e} ,0 \| + \Gamma_{e}^{\phi}\frac{S_{e}}{\delta x_{e}} - \| -\dot{m}_{w} ,0 \| + \Gamma_{w}^{\phi}\frac{S_{w}}{\delta x_{w}}
  = - (a_{E} + a_{W}) + (\dot{m}_{e} + \dot{m}_{w})
\\
&amp; b_{C}
  = - \sum_{f} \Big( \text{FluxV}_{f}^{Conv} + \text{FluxV}_{f}^{Diff} \Big) = 0
\end{align}\end{split}\]</div>
<p>调用上式的连续性约束，并假设网格是均一的、扩散系数为常数，那么就有</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\phi_{C} - \phi_{W}}{\phi_{E} - \phi_{W}}
= \frac{2 - \| Pe_{L} ,0 \|}{4 - \| -Pe_{L} ,0 \| - \| Pe_{L} ,0 \|}
= \frac{2 - \| Pe_{L} ,0 \|}{4 - |Pe_{L}|}
\end{align}\]</div>
<p>可以看到，当 <span class="math notranslate nohighlight">\(|Pe_{L}| \to 4\)</span> ，解就会变得完全不有界。顺风格式在与其他格式混合之后可能有利于捕捉间断界面。</p>
<p>接下来考虑顺风格式的截断误差。与迎风格式的分析过程类似，要将 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{W}\)</span> 写成关于 <span class="math notranslate nohighlight">\(\phi_{e}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{w}\)</span> 的函数。这里假设流动是沿着 <span class="math notranslate nohighlight">\(x\)</span> 轴正方向的，那么在顺风格式下有</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{e} = \phi_{E},
\qquad
\phi_{w} = \phi_{C}
\end{align}\]</div>
<p>于是离散方程为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho u \Delta y)_{e} \phi_{E}
- (\rho u \Delta y)_{w} \phi_{C}
- \bigg[
  \Big( \Gamma^{\phi} \frac{\mathrm{d} \phi}{\mathrm{d} x} \Delta y \Big)_{e}
  - \Big( \Gamma^{\phi} \frac{\mathrm{d} \phi}{\mathrm{d} x} \Delta y \Big)_{w}
  \bigg]
= 0
\end{align}\]</div>
<p>对于均匀网格， <span class="math notranslate nohighlight">\(\phi_{E}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 分别在面 <span class="math notranslate nohighlight">\(e\)</span> 和 <span class="math notranslate nohighlight">\(w\)</span> 处的一维泰勒展开式分别为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \phi_{E}
= \phi_{e}
  + \Big(\frac{\mathrm{d} \phi}{\mathrm{d} x}\Big)_{e} \frac{(\delta x)_{e}}{2}
  + \frac{1}{2} \Big( \frac{\mathrm{d}^{2} \phi}{\mathrm{d} x^{2}} \Big)_{e} \Big( \frac{(\delta x)_{e}}{2} \Big)^{2}
  + \cdots
\\
&amp; \phi_{C}
= \phi_{w}
  + \Big( \frac{\mathrm{d} \phi}{\mathrm{d} x} \Big)_{w} \frac{(\delta x)_{w}}{2}
  + \frac{1}{2} \Big( \frac{\mathrm{d}^{2} \phi}{\mathrm{d} x^{2}} \Big)_{w} \Big( \frac{(\delta x)_{w}}{2} \Big)^{2}
  + \cdots
\end{align}\end{split}\]</div>
<p>忽略二阶及以上的项并将其代入到对流项，那么离散方程等号左侧就变成了</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho u \Delta y)_{e} \phi_{E}
- (\rho u \Delta y)_{w} \phi_{C}
- \bigg[
  \Big( \Gamma^{\phi} \frac{\mathrm{d} \phi}{\mathrm{d} x} \Delta y \Big)_{e}
  - \Big( \Gamma^{\phi} \frac{\mathrm{d} \phi}{\mathrm{d} x} \Delta y \Big)_{w}
  \bigg]
=
(\rho u \Delta y)_{e} \phi_{e}
- (\rho u \Delta y)_{w} \phi_{w}
- \bigg[
  \Big( \Gamma^{\phi} - \rho u \frac{\delta x}{2} \Big)_{e} \Big( \frac{\mathrm{d} \phi}{\mathrm{d} x} \Delta y \Big)_{e}
  - \Big( \Gamma^{\phi} - \rho u \frac{\delta x}{2} \Big)_{w} \Big( \frac{\mathrm{d} \phi}{\mathrm{d} x} \Delta y \Big)_{w}
  \bigg]
\end{align}\]</div>
<p>可以看到，在该格式中数值扩散有一个负号，其值为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Gamma^{\phi}_{\text{truncation}} = - \rho u \frac{\delta x}{2}
\end{align}\]</div>
<p>它使扩散系数变小，呈现出反扩散效应。研究发现，使用顺风格式的预测会引起平流廓线的剪切。事实上，用这种格式生成的一维对流扩散问题的解比中心差分格式更具振荡性。</p>
</div>
<div class="section" id="id33">
<h3>二阶迎风格式<a class="headerlink" href="#id33" title="永久链接至标题">¶</a></h3>
<p>之前的讨论表明，一阶迎风格式和中心差分格式都有严重的局限性。一阶迎风格式由于数值扩散问题而导致精度较差，中心差分格式则由于其不稳定性(也称为数值弥散误差)而严重受限。这些缺点引起了人们对利用高阶迎风偏置插值剖面来提高对流格式精度和稳定性的大量研究。这些高阶格式旨在产生至少二阶的精确解，同时是无条件稳定的。</p>
<p>为了强调将通量与网格面关联而不是与网格体心关联的守恒性质，接下来使用 <span class="math notranslate nohighlight">\(D\)</span> 表示Downwind、用 <span class="math notranslate nohighlight">\(C\)</span> 表示Upwind、用 <span class="math notranslate nohighlight">\(U\)</span> 表示far Upwind对应的网格面中心节点。另外， <span class="math notranslate nohighlight">\(DD\)</span> 和 <span class="math notranslate nohighlight">\(UU\)</span> 分别表示 <span class="math notranslate nohighlight">\(D\)</span> 和 <span class="math notranslate nohighlight">\(U\)</span> 的下游和上游网格面。对这些位置对应的通量值分别表示为 <span class="math notranslate nohighlight">\(\phi_{DD},\phi_{D},\phi_{C},\phi_{U},\phi_{UU}\)</span> ，如图所示，对于速度方向分别为正或负情况会有所不同。</p>
<div class="figure align-center">
<img alt="../_images/用于描述对流格式的UU,U,C,D,DD节点位置的示意图.png" src="../_images/用于描述对流格式的UU,U,C,D,DD节点位置的示意图.png" />
</div>
<p>二阶迎风格式(second order upwind)需要使用线性轮廓(linear profile)，就像中心差分格式那样，但是并不是使用对称的轮廓，而使用向迎风方向偏移的模板(upwind biased stencil)。如图所示，线性剖面是利用网格面 <span class="math notranslate nohighlight">\(C\)</span> 和 <span class="math notranslate nohighlight">\(U\)</span> 上的值来构造的，因此网格面上的值实际上是通过外推而不是插值来计算的。</p>
<div class="figure align-center">
<img alt="../_images/二阶迎风格式轮廓.png" src="../_images/二阶迎风格式轮廓.png" />
</div>
<p>使用位于网格面中心处 <span class="math notranslate nohighlight">\(x_{C}\)</span> 和 <span class="math notranslate nohighlight">\(x_{U}\)</span> 的值 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 和 <span class="math notranslate nohighlight">\(\phi_{U}\)</span> 来构建线性轮廓则为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi(x) = \phi_{C} + \frac{\phi_{C} - \phi_{U}}{x_{C} - x_{U}}(x - x_{C})
\end{align}\]</div>
<p>使用上式，在图中所示的面 <span class="math notranslate nohighlight">\(f\)</span> 处的值 <span class="math notranslate nohighlight">\(\phi\)</span> 可以如下得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \phi(x_{f}) = \phi_{C} + \frac{\phi_{C} - \phi_{U}}{x_{C} - x_{U}}(x_{f} - x_{C})
\end{align}\]</div>
<p>对于均匀网格则化简为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \frac{3}{2}\phi_{C} - \frac{1}{2}\phi_{U}
\end{align}\]</div>
<p>使用上述剖面近似离散的一维对流扩散方程中的界面值，得到各网格面处的通量为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \dot{m}_{e}\phi_{e} =
\Big(\frac{3}{2}\phi_{C} - \frac{1}{2}\phi_{W}\Big) \max(\dot{m}_{e},0)
- \Big(\frac{3}{2}\phi_{E} - \frac{1}{2}\phi_{EE} \Big) \max(-\dot{m}_{e} ,0) \\
&amp; \dot{m}_{w}\phi_{w} =
\Big(\frac{3}{2}\phi_{C} - \frac{1}{2}\phi_{E} \Big) \max(\dot{m}_{w} ,0)
- \Big(\frac{3}{2}\phi_{W} - \frac{1}{2}\phi_{WW} \Big) \max(-\dot{m}_{w} ,0)
\end{align}\end{split}\]</div>
<p>将上述通量代入到离散方程得到</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big(\frac{3}{2}\phi_{C} - \frac{1}{2}\phi_{W}\Big) \max(\dot{m}_{e},0)
- \Big(\frac{3}{2}\phi_{E} - \frac{1}{2}\phi_{EE} \Big) \max(-\dot{m}_{e} ,0)
+ \Big(\frac{3}{2}\phi_{C} - \frac{1}{2}\phi_{E} \Big) \max(\dot{m}_{w} ,0)
- \Big(\frac{3}{2}\phi_{W} - \frac{1}{2}\phi_{WW} \Big) \max(-\dot{m}_{w} ,0)
- \bigg[
  \Big(\Gamma^{\phi}\frac{S}{\delta x}\Big)_{e} (\phi_{E} - \phi_{C})
  - \Big(\Gamma^{\phi}\frac{S}{\delta x}\Big)_{w} (\phi_{C} - \phi_{W})
  \bigg]
= 0
\end{align}\]</div>
<p>该离散方程可以整理改写为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} + a_{EE}\phi_{EE} + a_{WW}\phi_{WW} = 0
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = \text{FluxF}_{e} =
    - \Gamma_{e}^{\phi}\frac{S_{e}}{\delta x_{e}}
    - \frac{3}{2}\max(-\dot{m}_{e} ,0)
    - \frac{1}{2} \max(\dot{m}_{w} ,0)
\\
&amp; a_{W} = \text{FluxF}_{w} =
    - \Gamma_{w}^{\phi}\frac{S_{w}}{\delta x_{w}}
    - \frac{3}{2}\max(-\dot{m}_{w},0)
    - \frac{1}{2}\max(\dot{m}_{e},0)
\\
&amp; a_{EE} = \text{FluxF}_{ee} = \frac{1}{2}\max(-\dot{m}_{e},0) \\
&amp; a_{WW} = \text{FluxF}_{ww} = \frac{1}{2}\max(-\dot{m}_{w},0) \\
&amp; a_{C} = \sum_{f\sim nb(C)}\text{FluxC}_{f} =
    \Gamma_{e}^{\phi}\frac{S_{e}}{\delta x_{e}}
    + \Gamma_{w}^{\phi}\frac{S_{w}}{\delta x_{w}}
    + \frac{3}{2}\max(\dot{m}_{e} , 0)
    + \frac{3}{2}\max(\dot{m}_{w} , 0)
    = - (a_{E} + a_{W} + a_{EE} + a_{WW}) + (\dot{m}_{e} + \dot{m}_{w})
\end{align}\end{split}\]</div>
<p>仿照与中心差分格式类似的分析过程，可以得到二阶迎风格式的截断误差为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
TE = - \frac{3}{8}\Delta x^{2}\phi_{C}''' - \frac{1}{4}\Delta x^{3}\phi_{C}^{iv} + \cdots
\end{align}\]</div>
<p>上式表明格式确实具有二阶精度。</p>
<p>接下来分析二阶迎风格式的稳定性。离散的对流通量为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
RHS_{convection} =
- \Big(\frac{3}{2}\phi_{C} - \frac{1}{2}\phi_{W} \Big) \max(\dot{m}_{e} ,0)
+ \Big(\frac{3}{2}\phi_{E} - \frac{1}{2}\phi_{EE} \Big) \max(-\dot{m}_{e},0)
- \Big(\frac{3}{2}\phi_{C} - \frac{1}{2}\phi_{E} \Big) \max(\dot{m}_{w} ,0)
+ \Big(\frac{3}{2}\phi_{W} - \frac{1}{2}\phi_{WW} \Big) \max(-\dot{m}_{w} ,0)
\end{align}\]</div>
<p>其对 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的变化率为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (RHS_{convection})}{\partial \phi_{C}} = - \frac{3}{2} \max(\dot{m}_{e} ,0) - \frac{3}{2}\max(\dot{m}_{w} ,0)
\end{align}\]</div>
<p>它总是负的，说明二阶迎风格式是一个稳定的格式，即解的误差总能够保持控制。</p>
<div class="admonition attention">
<p class="first admonition-title">注意</p>
<p class="last">这里所说的误差总能控制只适用于推导中所述的条件，而不适用于速度不恒定的一般情况。</p>
</div>
</div>
<div class="section" id="quick">
<h3>QUICK格式<a class="headerlink" href="#quick" title="永久链接至标题">¶</a></h3>
<p>二次上游插值对流运动学格式(The Quadratic Upstream Interpolation for Convective Kinematics, QUICK)由Leonard提出，该格式利用偏上游的二次多项式插值元素各面因变量的值，如图所示，插值得到的值用于计算因变量控制方程中的对流项。</p>
<div class="figure align-center">
<img alt="../_images/QUICK格式轮廓.png" src="../_images/QUICK格式轮廓.png" />
</div>
<p>在其原始形式中，QUICK格式需要使用一般的多维二次多项式来计算未知变量 <span class="math notranslate nohighlight">\(\phi\)</span> 。然而，一般来说都会将流动视为局部一维，并在每个坐标方向上使用二阶一维剖面就足够了。对于所讨论的一维对流扩散问题， <span class="math notranslate nohighlight">\(\phi\)</span> 的值通过二次多项式</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi = k_{0} + k_{1}x + k_{2}x^{2}
\end{align}\]</div>
<p>来计算，其中要求</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\phi = \left\{ \begin{array}{ll}
\phi_{U} , \quad x = x_{U} \\
\phi_{C} , \quad x = x_{C} \\
\phi_{D} , \quad x = x_{D}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>代入上述要求，可以展开得到 <span class="math notranslate nohighlight">\(\phi\)</span> 具体的计算方式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi = \phi_{U}
+ \frac{(x - x_{U})(x - x_{C})}{(x_{D} - x_{U})(x_{D} - x_{c})} (\phi_{D} - \phi_{U})
+ \frac{(x - x_{U})(x - x_{D})}{(x_{C} - x_{U})(x_{C} - x_{D})} (\phi_{C} - \phi_{U})
\end{align}\]</div>
<p>对于均匀网格，在网格面 <span class="math notranslate nohighlight">\(f\)</span> 处的值的计算可以化简为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \frac{\phi_{C} + \phi_{D}}{2} - \frac{\phi_{D} - 2\phi_{C} + \phi_{U}}{8}
\end{align}\]</div>
<p>于是，在网格单元面上的对流通量可以如下计算：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \dot{m}_{e}\phi_{e} = \Big( \frac{3}{4}\phi_{C} - \frac{1}{8}\phi_{W} + \frac{3}{8}\phi_{E} \Big) \| \dot{m}_{e},0\|
    - \Big( \frac{3}{4}\phi_{E} - \frac{1}{8}\phi_{EE} + \frac{3}{8}\phi_{C} \Big) \| -\dot{m}_{e} ,0\| \\
&amp; \dot{m}_{w}\phi_{w} = \Big( \frac{3}{4}\phi_{C} - \frac{1}{8}\phi_{E} + \frac{3}{8}\phi_{W} \Big) \| \dot{m}_{w} ,0 \|
    - \Big( \frac{3}{4}\phi_{W} - \frac{1}{8}\phi_{WW} + \frac{3}{8}\phi_{C} \Big) \| -\dot{m}_{w} ,0\|
\end{align}\end{split}\]</div>
<p>将它代入到一维对流扩散方程，其离散形式变成</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \Big( \frac{3}{4}\phi_{C} - \frac{1}{8}\phi_{W} + \frac{3}{8}\phi_{E} \Big) \| \dot{m}_{e},0\|
  - \Big( \frac{3}{4}\phi_{E} - \frac{1}{8}\phi_{EE} + \frac{3}{8}\phi_{C} \Big) \| -\dot{m}_{e} ,0\|
\\
&amp; + \Big( \frac{3}{4}\phi_{C} - \frac{1}{8}\phi_{E} + \frac{3}{8}\phi_{W} \Big) \| \dot{m}_{w} ,0 \|
    - \Big( \frac{3}{4}\phi_{W} - \frac{1}{8}\phi_{WW} + \frac{3}{8}\phi_{C} \Big) \| -\dot{m}_{w} ,0\|
\\
&amp; \bigg[
  \Big(\Gamma^{\phi}\frac{S}{\delta x}\Big)_{e} (\phi_{E} - \phi_{C})
  - \Big( \Gamma^{\phi}\frac{S}{\delta x} \Big)_{w} (\phi_{C} - \phi_{W})
  \bigg]
= 0
\end{align}\end{split}\]</div>
<p>该方程可以整理改写为如下形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} + a_{EE}\phi_{EE} + a_{WW}\phi_{WW} = 0
\end{align}\]</div>
<p>其中各系数的表达式为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = \text{FluxF}_{e} = - \Gamma^{\phi}_{e}\frac{S_{e}}{\delta x_{e}} - \frac{3}{4}\| -\dot{m}_{e} ,0\| + \frac{3}{8}\| \dot{m}_{e},0 \| - \frac{1}{8}\| \dot{m}_{w},0 \| \\
&amp; a_{W} = \text{FluxF}_{w} = - \Gamma^{\phi}_{w}\frac{S_{w}}{\delta x_{w}} - \frac{3}{4}\| -\dot{m}_{w},0 \| + \frac{3}{8} \| \dot{m}_{w},0 \| - \frac{1}{8} \| \dot{m}_{e},0 \| \\
&amp; a_{EE} = \text{FluxF}_{ee} = \frac{1}{8} \| -\dot{m}_{e},0 \| \\
&amp; a_{WW} = \text{FluxF}_{ww} = \frac{1}{8} \| -\dot{m}_{w},0 \| \\
&amp; a_{C} = \sum_{f \sim nb(C)}\text{FluxC}_{f}
= \Gamma^{\phi}_{e} \frac{S_{e}}{\delta x_{e}} + \Gamma^{\phi}_{w}\frac{S_{w}}{\delta x_{w}}
  + \frac{3}{4} \| \dot{m}_{e},0 \| - \frac{3}{8} \| -\dot{m}_{e},0 \| + \frac{3}{4} \| \dot{m}_{w} ,0 \| - \frac{3}{8} \| -\dot{m}_{w},0 \|
= -(a_{E} + a_{W} + a_{WW} + a_{EE}) + (\dot{m}_{e} + \dot{m}_{w})
\end{align}\end{split}\]</div>
<p>利用之前讨论过的分析过程，可以分析出QUICK格式的截断误差为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
TE = \frac{1}{16}\Delta x^{3} \phi_{C}^{iv} - \frac{3}{128}\Delta x^{4}\phi_{C}^{v} + \cdots
\end{align}\]</div>
<p>上式表明QUICK格式具有三阶精度。</p>
<p>接下来分析QUICK格式的稳定性。根据离散的对流通量，可以得到</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
RHS_{\text{convection}} &amp;=
- \Big( \frac{3}{4}\phi_{C} - \frac{1}{8}\phi_{W} + \frac{3}{8}\phi_{E} \Big) \| \dot{m}_{e},0\|
+ \Big( \frac{3}{4}\phi_{E} - \frac{1}{8}\phi_{EE} + \frac{3}{8}\phi_{C} \Big) \| -\dot{m}_{e} ,0\| \\
&amp;\quad - \Big( \frac{3}{4}\phi_{C} - \frac{1}{8}\phi_{E} + \frac{3}{8}\phi_{W} \Big) \| \dot{m}_{w} ,0 \|
+ \Big( \frac{3}{4}\phi_{W} - \frac{1}{8}\phi_{WW} + \frac{3}{8}\phi_{C} \Big) \| -\dot{m}_{w} ,0\|
\end{align}\end{split}\]</div>
<p>于是对流项敏感性为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (RHS_{\text{convection}})}{\partial \phi_{C}} =
- \frac{3}{8} \| \dot{m}_{e},0 \| - \frac{3}{8} \| \dot{m}_{w},0 \| - \frac{3}{8}(\dot{m}_{e} + \dot{m}_{w})
\end{align}\]</div>
<p>对于均一的流速它总是为负的，所以是一个稳定的格式。但是它并不能保证解的有界性，尤其对于一般情况下的非均一流速。</p>
</div>
<div class="section" id="fromm">
<h3>FROMM格式<a class="headerlink" href="#fromm" title="永久链接至标题">¶</a></h3>
<p>FROMM格式通过目标网格面的迎风节点与顺风节点构建线性轮廓，如图所示，插值并不是对称轮廓而是迎风偏向的，并要求 <span class="math notranslate nohighlight">\(\phi_{U},\phi_{C},\phi_{D}\)</span> 是共线的。</p>
<p>首先基于顺风 <span class="math notranslate nohighlight">\(x_{D}\)</span> 处的 <span class="math notranslate nohighlight">\(\phi_{D}\)</span> 以及远迎风 <span class="math notranslate nohighlight">\(x_{U}\)</span> 处的 <span class="math notranslate nohighlight">\(\phi_{U}\)</span> 构建线性格式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi(x) = \phi_{U} + \frac{\phi_{D} - \phi_{U}}{x_{D} - x_{U}}(x - x_{U})
\end{align}\]</div>
<p>根据该方程，在迎风 <span class="math notranslate nohighlight">\(C\)</span> 节点处的值可以如下得到：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{C} = \phi_{U} + \frac{\phi_{D} - \phi_{U}}{x_{D} - x_{U}}(x_{C} - x_{U})
\end{align}\]</div>
<p>对于均匀网格的情况，上述方程简化为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{C} = \frac{\phi_{D} + \phi_{U}}{2}
\end{align}\]</div>
<p>那么所需面 <span class="math notranslate nohighlight">\(f\)</span> 处的值则为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \phi(x_{f})
= \phi_{U} + \frac{\phi_{D} - \phi_{U}}{x_{D} - x_{U}}(x_{f} - x_{U})
= \phi_{C} + \frac{x_{f} - x_{C}}{x_{D} - x_{U}}(\phi_{D} - \phi_{U})
\end{align}\]</div>
<p>对于均匀网格的情况，上述方程简化为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\phi_{f} = \phi_{C} + \frac{\phi_{D} - \phi_{U}}{4}
\end{align}\]</div>
<p>使用该格式来估计离散一维对流扩散方程的网格面处的值，网格面处的通量为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \dot{m}_{e}\phi_{e} =
\Big( \phi_{C} - \frac{1}{4}\phi_{W} + \frac{1}{4}\phi_{E} \Big) \| \dot{m}_{e},0 \|
- \Big( \phi_{E} - \frac{1}{4}\phi_{EE} + \frac{1}{4}\phi_{C} \Big) \| -\dot{m}_{e},0 \|
\\
&amp; \dot{m}_{w}\phi_{w} =
\Big( \phi_{C} - \frac{1}{4}\phi_{E} + \frac{1}{4}\phi_{W} \Big) \| \dot{m}_{w},0 \|
- \Big( \phi_{W} - \frac{1}{4}\phi_{WW} + \frac{1}{4}\phi_{C} \Big) \| -\dot{m}_{w},0 \|
\end{align}\end{split}\]</div>
<p>将它们代入到离散方程中，则方程变为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \Big( \phi_{C} - \frac{1}{4}\phi_{W} + \frac{1}{4}\phi_{E} \Big) \| \dot{m}_{e},0 \|
- \Big( \phi_{E} - \frac{1}{4}\phi_{EE} + \frac{1}{4}\phi_{C} \Big) \| -\dot{m}_{e},0 \|
\\
&amp; + \Big( \phi_{C} - \frac{1}{4}\phi_{E} + \frac{1}{4}\phi_{W} \Big) \| \dot{m}_{w},0 \|
- \Big( \phi_{W} - \frac{1}{4}\phi_{WW} + \frac{1}{4}\phi_{C} \Big) \| -\dot{m}_{w},0 \|
\\
&amp; \bigg[
  \Big( \Gamma^{\phi}\frac{S}{\delta x} \Big)_{e} (\phi_{E} - \phi_{C})
  - \Big( \Gamma^{\phi}\frac{S}{\delta x} \Big)_{w} (\phi_{C} - \phi_{W})
  \bigg]
= 0
\end{align}\end{split}\]</div>
<p>该方程可以整理改写为如下形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} + a_{EE}\phi_{EE} + a_{WW}\phi_{WW} = 0
\end{align}\]</div>
<p>其中</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = \text{FluxF}_{e} = -\Gamma^{\phi}_{e}\frac{S_{e}}{\delta x_{e}} + \frac{1}{4} \| \dot{m}_{e},0 \| - \| -\dot{m}_{e},0 \| - \frac{1}{4} \| \dot{m}_{w},0 \| \\
&amp; a_{W} = \text{FluxF}_{w} = -\Gamma^{\phi}_{w}\frac{S_{w}}{\delta x_{w}} + \frac{1}{4} \| \dot{m}_{w},0 \| - \| -\dot{m}_{w},0 \| - \frac{1}{4} \| \dot{m}_{e},0 \| \\
&amp; a_{EE} = \text{FluxF}_{ee} = \frac{1}{4} \| -\dot{m}_{e},0 \| \\
&amp; a_{WW} = \text{FluxF}_{ww} = \frac{1}{4} \| -\dot{m}_{w},0 \| \\
&amp; a_{C} = \sum_{f\sim nb(C)}\text{FluxC}_{f}
= \Gamma^{\phi}_{e}\frac{S_{e}}{\delta x_{e}} + \Gamma^{\phi}_{w}\frac{S_{w}}{\delta x_{w}} + \| \dot{m}_{e},0 \| - \frac{1}{4} \| -\dot{m}_{e},0 \| + \| \dot{m}_{w},0 \| - \frac{1}{4} \| -\dot{m}_{w},0 \|
= -(a_{E} + a_{W} + a_{EE} + a_{WW}) + (\dot{m}_{e} + \dot{m}_{w})
\end{align}\end{split}\]</div>
<p>根据中心差分格式中讨论的分析方法，FROMM格式的截断误差可以发现满足</p>
<div class="math notranslate nohighlight">
\[\begin{align}
TE = O(\Delta x^{2})
\end{align}\]</div>
<p>表明FROMM格式具有二阶精度。</p>
<p>现在考虑FROMM格式的稳定性。根据对流通量的离散形式，可以得到</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
RHS_{\text{convection}} &amp;=
- \Big( \phi_{C} - \frac{1}{4}\phi_{W} + \frac{1}{4}\phi_{E} \Big) \| \dot{m}_{e},0 \|
+ \Big( \phi_{E} - \frac{1}{4}\phi_{EE} + \frac{1}{4}\phi_{C} \Big) \| -\dot{m}_{e},0 \|
\\
&amp;\quad - \Big( \phi_{C} - \frac{1}{4}\phi_{E} + \frac{1}{4}\phi_{W} \Big) \| \dot{m}_{w},0 \|
+ \Big( \phi_{W} - \frac{1}{4}\phi_{WW} + \frac{1}{4}\phi_{C} \Big) \| -\dot{m}_{w},0 \|
\end{align}\end{split}\]</div>
<p>从而可知对流项敏感性为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (RHS_{\text{convection}})}{\partial \phi_{C}} =
-\frac{3}{4}\| \dot{m}_{e},0 \| - \frac{3}{4} \| \dot{m}_{w},0 \| - \frac{1}{4}(\dot{m}_{e} + \dot{m}_{w})
\end{align}\]</div>
<p>这表明，对于恒定速度场，其对流敏感性总是负的，说明该格式是稳定的。但是对于一般的情况，速度场会变化，则并不能确保绝对稳定。</p>
</div>
<div class="section" id="flux-vector-splitting-methods">
<h3>Flux Vector Splitting Methods<a class="headerlink" href="#flux-vector-splitting-methods" title="永久链接至标题">¶</a></h3>
<p>abcdefg</p>
</div>
<div class="section" id="id34">
<h3>数值稳定性<a class="headerlink" href="#id34" title="永久链接至标题">¶</a></h3>
<p>与截断误差相关的混乱(物理解的一阶和非物理解的二阶)导致许多工作者推断，既然扩散项的中心差分是如此准确，那么对流项的中心差分也应该同样准确。当然，正如前面几节所看到的，对流项的中心差异可以导致非物理解。造成这种现象的原因是，当应用于像对流项这样的奇阶导数时，中心差分格式没有固有的对流稳定性。</p>
<p>Leonard提出了对流稳定性的概念，以解释由中心差分格式应用于对流为主的流动所产生的数值解中的振荡。Leonard使用了一般的一维非定常对流扩散方程来描述这个概念：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (\rho \phi)}{\partial t}
= - \frac{\partial (\rho u\phi)}{\partial x}
+ \frac{\partial }{\partial x}\Big( \Gamma^{\phi}\frac{\partial \phi}{\partial x} \Big)
+ Q^{\phi}
\end{align}\]</div>
<p>将该方程应用于如图所示的网格中心 <span class="math notranslate nohighlight">\(C\)</span> 上，方程的左侧表示控制单元单位时间内 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的变化率，方程的右侧表示网格单元表面的净流入和单元内影响 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 值的源项。如果方程右侧存在数值误差，则根据离散化过程中使用的格式的不同，由该方程计算出来的 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 值将增加或减小。</p>
<p>在不稳定的格式中，与 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 正确值的微小偏差使得方程右侧表示的净流入相应增加或减少。当求解过程中进行迭代时，净流入的增加/减少都将进一步增加/减少迭代过程后续每个步骤中的 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 。在一个稳定的格式中，由于方程右侧的错误导致的 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 变化应该作为一个自修正反馈到方程右侧。显然，对于这种数值稳定性，方程右侧(RHS)应该满足</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (RHS)}{\partial \phi_{C}} &lt; 0
\end{align}\]</div>
<p>上式表明方程右侧的组合对 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 变化的反应为负。这种情况下， <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的增加/减少将对应于流入的减少/增加，这反过来又将 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 向下/向上推至正确的值。然而，稳定性不应该与有界性或者准确性相混淆。一个稳定的数值格式实际上可能是无界的，从而导致过度/不足(over/under shoots)和振荡/摆动(oscillations/wiggles)，或者扩散性非常强从而给出精度非常低的结果。这里的稳定性指的是控制数值误差保持有界，使得其不会像中心差分格式那样无限增加，也就是让其在 <span class="math notranslate nohighlight">\(Pe\)</span> 在 <span class="math notranslate nohighlight">\(-\infty\)</span> 到 <span class="math notranslate nohighlight">\(\infty\)</span> 变化时 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 的归一化值不会同样在 <span class="math notranslate nohighlight">\(-\infty\)</span> 到 <span class="math notranslate nohighlight">\(\infty\)</span> 之间变化，而是在 <span class="math notranslate nohighlight">\(1\)</span> 到 <span class="math notranslate nohighlight">\(0\)</span> 之间变化。迎风格式恰好同时具有有界性和稳定性特征。</p>
<p>现在考虑方程右侧的一般离散形式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
RHS = -(\rho u \Delta y)_{e}\phi_{e}
+ (\rho u \Delta y)_{w}\phi_{w}
+ \bigg[
  \Big(\Gamma^{\phi}\frac{\Delta y}{\delta x}\Big)_{e} (\phi_{E} - \phi_{C})
  - \Big(\Gamma^{\phi}\frac{\Delta y}{\delta x}\Big)_{w} (\phi_{C} - \phi_{W})
  \bigg]
+ Q_{C}^{\phi}V_{C}
\end{align}\]</div>
<p>当使用中心差分格式时，上式变成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
RHS_{CD} = -(\rho u \Delta y)_{e}\frac{\phi_{E} + \phi_{C}}{2}
+ (\rho u \Delta y)_{w}\frac{\phi_{C} + \phi_{W}}{2}
+ \bigg[
  \Big(\Gamma^{\phi}\frac{\Delta y}{\delta x}\Big)_{e} (\phi_{E} - \phi_{C})
  - \Big(\Gamma^{\phi}\frac{\Delta y}{\delta x}\Big)_{w} (\phi_{C} - \phi_{W})
  \bigg]
+ Q_{C}^{\phi}V_{C}
\end{align}\]</div>
<p>根据之前所述的标准来分析中心差分格式，可以发现扩散项的敏感性(sensitivity)为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (RHS_{CD}^{Diff})}{\partial \phi_{C}}
= - 2\Gamma^{\phi}\frac{\Delta y}{\delta x}
\end{align}\]</div>
<p>由于 <span class="math notranslate nohighlight">\(\Gamma^{\phi}\)</span> 是正的，所以扩散项敏感性是负的，表明对于扩散性来说这是一个稳定的格式。但是对流项的敏感性为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (RHS_{CD}^{Conv})}{\partial \phi_{C}}
= -\frac{1}{2}(\dot{m}_{e} + \dot{m}_{w})
\end{align}\]</div>
<p>对于恒定流来说则敏感性为零，但是对非恒定流来说则并不一定为零，比如对于减速流来说它的值将会是正的。在一般的流动中，这样的区域就像一个摆动源(wiggle sources)并且在Péclet数非常大的时候非常容易导致数值突变。即使对于稳定流动，由于它的值为零，它也不能反馈到方程中进行自我修正。同时，上式还表明对于恒定流动，使用中心差分格式计算的净对流通量与 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 无关。因此，如图所示，不同可能得 <span class="math notranslate nohighlight">\(\phi_{C}\)</span> 值将导致网格节点C上的净对流通量相同。</p>
<div class="figure align-center">
<img alt="../_images/中心差分格式对phic值的不敏感性.png" src="../_images/中心差分格式对phic值的不敏感性.png" />
</div>
<p>而使用迎风格式的时候，一般离散方程的右侧项则为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
RHS_{\text{upwind}} =
- \max(\dot{m}_{e} , 0) \phi_{C}
+ \max(-\dot{m}_{e} , 0) \phi_{E}
- \max(\dot{m}_{w} , 0) \phi_{C}
+ \max(-\dot{m}_{w} , 0) \phi_{W}
+ \Big( \Gamma^{\phi}\frac{S}{\delta x} \Big)_{e} (\phi_{E} - \phi_{C})
- \Big( \Gamma^{\phi}\frac{S}{\delta x} \Big)_{w} (\phi_{C} - \phi_{W})
+ Q_{C}^{\phi}
\end{align}\]</div>
<p>其对对流项的敏感性对所有流动为负或者零，因此该格式对所有Péclet数都是稳定的：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (RHS_{\text{upwind}}^{Conv})}{\partial \phi_{C}}
= - \max( \dot{m}_{e} , 0) - \max( \dot{m}_{w} , 0)
\end{align}\]</div>
<p>当两个质量流量都为负的时候，敏感性将为零，这种情况不会出现在一维横截面积不变的情况。当考虑上一阶近似引入的假扩散时，上式表明该格式非常稳定。但是正如之前讨论的那样，这种稳定性是以牺牲准确性为代价的。</p>
<p>对于顺风格式，一般离散方程的右侧项则为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
RHS_{\text{downwind}} =
- \max(\dot{m}_{e} ,0)\phi_{E}
+ \max(-\dot{m}_{e} ,0)\phi_{C}
- \max(-\dot{m}_{w} ,0)\phi_{W}
+ \max(-\dot{m}_{w} ,0)\phi_{C}
+ \Big( \Gamma^{\phi}\frac{S}{\delta x} \Big)_{e} (\phi_{E} - \phi_{C})
+ \Big( \Gamma^{\phi}\frac{S}{\delta x} \Big)_{w} (\phi_{W} - \phi_{C})
\end{align}\]</div>
<p>其对对流项的敏感性为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial (RHS_{\text{downwind}}^{Conv})}{\partial \phi_{C}} =
- \max(-\dot{m}_{e} ,0) + \max(-\dot{m}_{w} , 0)
\end{align}\]</div>
<p>对于所有流动它总是正的或者等于零。当考虑上它的反扩散效应之后，它就变成了一个高度不稳定的格式。</p>
</div>
<div class="section" id="id35">
<h3>均匀网格与非均匀网格的函数关系<a class="headerlink" href="#id35" title="永久链接至标题">¶</a></h3>
<p>前面提到的各种插值格式都是在一维笛卡尔网格上推导出来的。沿着曲线坐标轴，同样的函数关系也可以用曲线 <span class="math notranslate nohighlight">\(\zeta\)</span> 轴代替笛卡尔坐标系的 <span class="math notranslate nohighlight">\(x\)</span> 轴。</p>
<div class="figure align-center">
<img alt="../_images/一维曲线坐标系zeta.png" src="../_images/一维曲线坐标系zeta.png" />
</div>
<p>如上图所示，对于均匀网格，函数关系与一维直线网格的形式完全相同；对于非均匀网格，应该将函数关系中出现的自变量 <span class="math notranslate nohighlight">\(x\)</span> 替换为更一般的自变量 <span class="math notranslate nohighlight">\(\zeta\)</span> ，它表示沿坐标轴的距离。如果原点为 <span class="math notranslate nohighlight">\(O\)</span> ，则</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \zeta_{U} = \zeta_{UU} + (\zeta_{U} - \zeta_{UU}) \\
&amp; \zeta_{UU} = \sqrt{(x_{UU} - x_{O})^{2} + (y_{UU} - y_{O})^{2} + (z_{UU} - z_{O})^{2}} \\
&amp; \zeta_{U} - \zeta_{UU} = \sqrt{(x_{U} - x_{UU})^{2} + (y_{U} - y_{UU})^{2} + (z_{U} - z_{UU})^{2}}
\end{align}\end{split}\]</div>
<p>通过应用这个一般坐标系，不同格式的函数关系在均匀网格和非均匀网格的形式都可以得到，如下表所示：</p>
<table border="1" class="docutils">
<colgroup>
<col width="3%" />
<col width="23%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">离散格式</th>
<th class="head">均匀网格</th>
<th class="head">非均匀网格</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Upwind</td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{C}\)</span></td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{C}\)</span></td>
</tr>
<tr class="row-odd"><td>Downwind</td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{D}\)</span></td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{D}\)</span></td>
</tr>
<tr class="row-even"><td>CD</td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = 0.5(\phi_{C} + \phi_{D})\)</span></td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{C} + \Big(\frac{\phi_{D} - \phi_{C}}{\zeta_{D} - \zeta_{C}}\Big)(\zeta_{f} - \zeta_{C})\)</span></td>
</tr>
<tr class="row-odd"><td>SOU</td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \frac{3}{2}\phi_{C} - \frac{1}{2}\phi_{U}\)</span></td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{C} + \Big(\frac{\phi_{C} - \phi_{U}}{\zeta_{C} - \zeta_{U}}\Big)(\zeta_{f} - \zeta_{C})\)</span></td>
</tr>
<tr class="row-even"><td>QUICK</td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \frac{3}{4}\phi_{C} - \frac{1}{8}\phi_{U} + \frac{3}{8}\phi_{D}\)</span></td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{U} + \frac{(\zeta_{f} - \zeta_{U})(\zeta_{f} - \zeta_{C})}{(\zeta_{D} - \zeta_{U})(\zeta_{D} - \zeta_{C})}(\phi_{D} - \phi_{U}) + \frac{(\zeta_{f} - \zeta_{U})(\zeta_{f} - \zeta_{D})}{(\zeta_{C} - \zeta_{U})(\zeta_{C} - \zeta_{D})}(\phi_{C} - \phi_{U})\)</span></td>
</tr>
<tr class="row-odd"><td>FROMM</td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{C} + \frac{1}{4}(\phi_{D} - \phi_{U})\)</span></td>
<td><span class="math notranslate nohighlight">\(\phi_{f} = \phi_{C} + \frac{\zeta_{f} - \zeta_{C}}{\zeta_{D} - \zeta_{U}}(\phi_{D} - \phi_{U})\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id36">
<h3>稳态二维对流<a class="headerlink" href="#id36" title="永久链接至标题">¶</a></h3>
<p>考虑稳态二维对流方程：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\nabla \cdot (\rho\mathbf{U}\phi) = 0
\end{align}\]</div>
<p>通过在如图所示的二维网格中取控制体积 <span class="math notranslate nohighlight">\(V_{C}\)</span> 将上式进行有限体积离散，得到网格面通量的关系：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\sum_{f\sim nb(C)} \Big( \int_{f}\mathbf{J}^{\phi,C} \cdot \mathrm{d}\mathbf{S} \Big)
= \sum_{f\sim nb(C)} \Big( \mathbf{J}_{f}^{\phi,C} \cdot \mathbf{S}_{f} \Big)
= \sum_{f\sim nb(C)} (\rho\mathbf{U}\phi)_{f} \cdot \mathbf{S}_{f}
= 0
\end{align}\]</div>
<p>在一个均匀笛卡尔网格中，完整的离散形式为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\underbrace{(\rho u \Delta y \phi)_{e}}_{\dot{m}_{e}}
- \underbrace{(\rho u \Delta y \phi)_{w}}_{-\dot{m}_{w}}
+ \underbrace{(\rho v \Delta x \phi)_{n}}_{\dot{m}_{n}}
- \underbrace{(\rho v \Delta x \phi)_{s}}_{-\dot{m}_{s}}
= 0
\end{align}\]</div>
<div class="figure align-center">
<img alt="../_images/二维笛卡尔网格中的稳态对流.png" src="../_images/二维笛卡尔网格中的稳态对流.png" />
</div>
<p>在各坐标轴方向上分别应用一阶迎风格式来像一维情况那样处理流动，则离散方程变为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} + a_{N}\phi_{N} + a_{S}\phi_{S} = 0
\end{align}\]</div>
<p>其中各系数为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = \text{FluxF}_{e} = - \| -\dot{m}_{e},0 \| \\
&amp; a_{W} = \text{FluxF}_{w} = - \| -\dot{m}_{w},0 \| \\
&amp; a_{N} = \text{FluxF}_{n} = - \| -\dot{m}_{n},0 \| \\
&amp; a_{S} = \text{FluxF}_{s} = - \| -\dot{m}_{s},0 \| \\
&amp; a_{C} = \sum_{f\sim nb(C)}\text{FluxC}_{f}
= \| \dot{m}_{e},0 \| + \| \dot{m}_{w},0 \| + \| \dot{m}_{n},0 \| + \| \dot{m}_{s},0 \|
= - (a_{E} + a_{W} + a_{N} + a_{S}) + \dot{m}_{e} + \dot{m}_{w} + \dot{m}_{n} + \dot{m}_{s}
\end{align}\end{split}\]</div>
<p>如果使用的是QUICK格式，那么离散方程则变成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{C}\phi_{C} + a_{E}\phi_{E} + a_{W}\phi_{W} + a_{EE}\phi_{EE} + a_{WW}\phi_{WW} + a_{N}\phi_{N} + a_{S}\phi_{S} + a_{NN}\phi_{NN} + a_{SS}\phi_{SS} = 0
\end{align}\]</div>
<p>其中各系数为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; a_{E} = \text{FluxF}_{e} = -\frac{3}{4} \| -\dot{m}_{e},0 \| + \frac{3}{8} \| \dot{m}_{e},0 \| - \frac{1}{8} \| \dot{m}_{w},0 \| \\
&amp; a_{W} = \text{FluxF}_{w} = -\frac{3}{4} \| -\dot{m}_{w},0 \| + \frac{3}{8} \| \dot{m}_{w},0 \| - \frac{1}{8} \| \dot{m}_{e},0 \| \\
&amp; a_{N} = \text{FluxF}_{n} = -\frac{3}{4} \| -\dot{m}_{n},0 \| + \frac{3}{8} \| \dot{m}_{n},0 \| - \frac{1}{8} \| \dot{m}_{s},0 \| \\
&amp; a_{S} = \text{FluxF}_{s} = -\frac{3}{4} \| -\dot{m}_{s},0 \| + \frac{3}{8} \| \dot{m}_{s},0 \| - \frac{1}{8} \| \dot{m}_{n},0 \| \\
&amp; a_{EE} = \text{FluxF}_{ee} = \frac{1}{8} \| -\dot{m}_{e},0 \| \\
&amp; a_{WW} = \text{FluxF}_{ww} = \frac{1}{8} \| -\dot{m}_{w},0 \| \\
&amp; a_{NN} = \text{FluxF}_{nn} = \frac{1}{8} \| -\dot{m}_{n},0 \| \\
&amp; a_{SS} = \text{FluxF}_{ss} = \frac{1}{8} \| -\dot{m}_{s},0 \| \\
&amp; a_{C} = \sum_{f\sim nb(C)}\text{FluxC}_{f} = - \sum_{F\sim NB(C)}a_{F} + (\dot{m}_{e} + \dot{m}_{w} + \dot{m}_{n} + \dot{m}_{s})
\end{align}\end{split}\]</div>
<p>现在使用上述两个离散方程来求解一个斜速度场中阶跃剖面的纯对流问题。计算域的划分如图所示，在正方形算域有一个物理量 <span class="math notranslate nohighlight">\(\phi\)</span> 通过速度场 <span class="math notranslate nohighlight">\(\mathbf{U} = (1,1)\)</span> 进行对流传输，左上角部分 <span class="math notranslate nohighlight">\(\phi=1\)</span> 而右下角部分 <span class="math notranslate nohighlight">\(\phi=0\)</span> 。由于方程中没有扩散项，所以理论上 <span class="math notranslate nohighlight">\(\phi\)</span> 的分布会出现阶跃，但是如图所示迎风格式和QUICK格式的结果都与准确值有相当的差异。</p>
<div class="figure align-center">
<img alt="../_images/二维斜速度场对流传输问题.png" src="../_images/二维斜速度场对流传输问题.png" />
</div>
<p>与准确值进行对比，可以看到一阶迎风格式得到的结果是模糊的，非常不准确，但是非常平滑。这种不准确性是由于一种新的误差，称为交叉流扩散(cross-stream diffusion)。这是由于所使用的一维插值格式将流动视为局部一维造成的。交叉流扩散最早由Patankar和Stubley发现，并认为这是一个多维现象(multi-dimensional phenomenon)，只有当速度场与网格不对齐时才会发生这种情况。对于二维流动，de Vahl Davis和Mallinson给出了交叉流扩散的近似表达式：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Gamma_{false}^{\phi} = \frac{\rho |\mathbf{U}| \Delta x\Delta y \sin(2\theta)}{4 (\Delta y \sin^{3}\theta + \Delta x \cos^{3}\theta)}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(\theta\)</span> 表示速度矢量与 <span class="math notranslate nohighlight">\(x\)</span> 轴的夹角。该误差可以通过使用更高阶的插值格式比如QUICK格式来减小。正如图中所示的那样，QUICK格式的结果更加锋利且比迎风格式更加精确，但是它受到附近尖锐梯度的影响产生了振荡(over/undershoots)。这个误差就是之前所说的色散误差(dispersion error)，它导致计算域中产生极大值/极小值，这是所有高阶格式的一个特征。</p>
</div>
</div>
<div class="section" id="notions-on-numerical-methods">
<h2>Notions on Numerical Methods<a class="headerlink" href="#notions-on-numerical-methods" title="永久链接至标题">¶</a></h2>
<div class="section" id="selected-difference-schemes">
<h3>Selected Difference Schemes<a class="headerlink" href="#selected-difference-schemes" title="永久链接至标题">¶</a></h3>
<div class="section" id="the-first-order-upwind-scheme">
<h4>The First Order Upwind Scheme<a class="headerlink" href="#the-first-order-upwind-scheme" title="永久链接至标题">¶</a></h4>
</div>
<div class="section" id="lax-friedrichs-scheme">
<h4>Lax-Friedrichs Scheme<a class="headerlink" href="#lax-friedrichs-scheme" title="永久链接至标题">¶</a></h4>
<p>Lax-Friedrichs scheme也是一个一阶格式，它不需要根据迎风方向来进行差分，而是采用了forward in time and central in space的方式来估计偏微分，也就是说，该格式将时间导数项从一般的 <span class="math notranslate nohighlight">\(u_{t} = \frac{u_{i}^{n+1} - u_{i}^{n}}{\Delta t}\)</span> 中的 <span class="math notranslate nohighlight">\(u_{i}^{n}\)</span> 修改为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{1}{2}(u_{i-1}^{n} + u_{i+1}^{n})
\end{align}\]</div>
<p>于是该格式给出的 <span class="math notranslate nohighlight">\(u_{t} + au_{x} = 0\)</span> 的离散推进形式为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1}{2}(u_{i-1}^{n} + u_{i+1}^{n}) - \frac{1}{2}c(u_{i+1}^{n} - u_{i-1}^{n})
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(c = \Delta t a / \Delta x = a/(\Delta x/\Delta t)\)</span> 为Courant number。通过von Neumann stability analysis可以发现该格式在 <span class="math notranslate nohighlight">\(0 \le |c| \le 1\)</span> 的条件下是稳定的。通过截断误差分析可知该格式具有一阶精度。考虑其数值扩散，也即引入数值粘性系数，则该格式实际求解的方程为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{t} + au_{x} = \alpha_{LF} u_{xx}
,\qquad
\alpha = \frac{\Delta x a}{2c}(1 - c^{2})
\end{align}\]</div>
<p>与一阶迎风格式对比，可以发现Lax-Friedrichs格式会引入更多的扩散效应，因为对于 <span class="math notranslate nohighlight">\(0 &lt; c \le 1\)</span> 有</p>
<div class="math notranslate nohighlight">
\[\begin{align}
2 \le \alpha_{LF} / \alpha_{upwind} = \frac{1 + c}{c} &lt; \infty
\end{align}\]</div>
<p>将该格式写成 <span class="math notranslate nohighlight">\(u_{i}^{n+1} = \sum_{k=-l_{L}}^{l_{R}}b_{k}u_{i+k}^{n}\)</span> 的通用迎风格式形式，则该格式的系数为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
b_{-1} = \frac{1}{2}(1 + c)
,\quad
b_{0} = 0
,\quad
b_{1} = \frac{1}{2}(1 -c)
\end{align}\]</div>
<p>在满足稳定条件 <span class="math notranslate nohighlight">\(0 \le |c| \le 1\)</span> 的前提下，Lax-Friedrich格式的系数 <span class="math notranslate nohighlight">\(b_{k}\)</span> 均为正数或零，因此该格式属于monotone scheme。</p>
</div>
<div class="section" id="lax-wendroff-scheme">
<h4>Lax-Wendroff Scheme<a class="headerlink" href="#lax-wendroff-scheme" title="永久链接至标题">¶</a></h4>
<p>基础的Lax-Wendroff格式在空间和时间上都具有二阶精度。时间导数项仍是一般的first-order forward approximation <span class="math notranslate nohighlight">\(u_{t} = (u_{i}^{n+1}-u_{i}^{n})/\Delta t\)</span> ；空间导数项则取迎风和顺风估计的平均值，即</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{x} = \beta_{1}\frac{u_{i}^{n} - u_{i-1}^{n}}{\Delta x} + \beta_{2}\frac{u_{i+1}^{n} - u_{i}^{n}}{\Delta x}
\end{align}\]</div>
<p>当取 <span class="math notranslate nohighlight">\(\beta_{1} = \frac{1}{2}(1 + c)\)</span> 和 <span class="math notranslate nohighlight">\(\beta_{2} = \frac{1}{2}(1 - c)\)</span> ，则得到Lax-Wendroff格式的离散推进方程：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1}{2}c(1+c)u_{i-1}^{n} + (1 - c^{2})u_{i}^{n} - \frac{1}{2}c(1 - c)u_{i+1}^{n}
\end{align}\]</div>
<p>其中 <span class="math notranslate nohighlight">\(c\)</span> 为Courant number。虽然空间导数中的其中一项来自无条件不稳定的格式，但是Lax-Wendroff格式在 <span class="math notranslate nohighlight">\(0 \le |c| \le 1\)</span> 的条件下是稳定的。虽然该格式通过一阶格式构建出来，但是最终得到的结果是二阶格式，这也充分说明了格式的精度一般不能直接从各偏微分的近似阶数直接得到。将Lax-Wendroff格式写成迎风格式通用形式，则其系数为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
b_{-1} = \frac{(1 + c)c}{2}
,\quad
b_{0} = 1-c^{2}
,\quad
b_{1} = - \frac{(1 - c)c}{2}
\end{align}\]</div>
<p>因此该格式并不属于monoton scheme，不是所有的系数都是正值或零。格式不是单调的与数值解在尖锐梯度附近的伪振荡现象(spurious oscillations)有关，比如在不连续处。</p>
</div>
<div class="section" id="warming-beam-scheme">
<h4>Warming-Beam Scheme<a class="headerlink" href="#warming-beam-scheme" title="永久链接至标题">¶</a></h4>
<p>Warming-Beam格式也具有二阶精度。对于方程 <span class="math notranslate nohighlight">\(u_{t} + au_{x} = 0\)</span> ，当 <span class="math notranslate nohighlight">\(a\)</span> 为正时，该格式给出的离散推进方程为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1}{2}c(c - 1)u_{i-2}^{n} + c(2-c)u_{i-1}^{n} + \frac{1}{2}(c - 1)(c - 2)u_{i}^{n}
\end{align}\]</div>
<p>可以看到，该格式使用的stencil完全位于其中网格点的一侧，显然该格式不是单调的。Warming-Beam格式的稳定性限制为</p>
<div class="math notranslate nohighlight">
\[\begin{align}
0 \le |c| \le 2
\end{align}\]</div>
<p>因此该格式能够选取更大的时间步长，显著提高计算效率。</p>
<p>We can verify that the numerical flux of the scheme of Warming and Beam, as applied to the linear advection equation with <span class="math notranslate nohighlight">\(a&gt;0\)</span> , is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i+\frac{1}{2}}^{WB} = \frac{1}{2}(c-1)f_{i-1} + \frac{1}{2}(3-c)f_{i}
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>The Warming-Beam numerical flux can be derived from</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}})
,\qquad
\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}} = \frac{1}{\Delta x} \int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x} \mathbf{U}_{i+\frac{1}{2}}(x, \frac{1}{2}\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>in terms of integral averages of solutions of Riemann problems under the assumption <span class="math notranslate nohighlight">\(1 \le c \le 2\)</span> . An extension of this interpretation to non-linear systems was proposed by Toro and Bilett.</p>
<p class="last">We can apply the numerical flux above to the linear advection equation and derive the Warming-Beam flux for negative speed <span class="math notranslate nohighlight">\(a\)</span> . Assume <span class="math notranslate nohighlight">\(-2 \le c \le -1\)</span> .</p>
</div>
</div>
<div class="section" id="fromm-scheme">
<h4>Fromm Scheme<a class="headerlink" href="#fromm-scheme" title="永久链接至标题">¶</a></h4>
<p>Another second order scheme is the FROMM scheme. For the linear advection equation, for <span class="math notranslate nohighlight">\(a&gt;0\)</span> , the scheme reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} =
- \frac{1}{4}(1 - c)c u_{i-2}^{n}
+ \frac{1}{4}(5 - c)c u_{i-1}^{n}
+ \frac{1}{4}(1 - c)(4 + c) u_{i}^{n}
- \frac{1}{4}(1 - c)c u_{i+1}^{n}
\end{align}\]</div>
<p>which has stability restriction <span class="math notranslate nohighlight">\(0 \le |c| \le 1\)</span> . Also, it can be easily verified that the FROMM scheme is no monotone.</p>
<p>Second-order schemes such as Lax-Wendroff, Warming-Beam and FROMM schemes have modified equation of the form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
q_{t} + aq_{x} = \beta q_{xxx}
\end{align}\]</div>
<p>which is a dispersive equation.</p>
<p>We can verify that the FROMM scheme as applied to the linear advection equation, for positive <span class="math notranslate nohighlight">\(a\)</span> , can be written in conservation form with numerical flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i+\frac{1}{2}}^{FR} = -\frac{1}{4}(1-c)f_{i-1} + f_{i} + \frac{1}{4}(1-c)f_{i+1}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the Courant number.</p>
</div>
</div>
<div class="section" id="conservative-methods">
<h3>Conservative Methods<a class="headerlink" href="#conservative-methods" title="永久链接至标题">¶</a></h3>
<div class="section" id="basic-definitions">
<h4>Basic Definitions<a class="headerlink" href="#basic-definitions" title="永久链接至标题">¶</a></h4>
</div>
<div class="section" id="godunov-s-first-order-upwind-method">
<h4>Godunov’s First-Order Upwind Method<a class="headerlink" href="#godunov-s-first-order-upwind-method" title="永久链接至标题">¶</a></h4>
<p>Godunov’s first–order upwind method是守恒方程(conservative formula) <span class="math notranslate nohighlight">\(u_{i}^{n+1} = u_{i}^{n} + \frac{\Delta t}{\Delta x}\Big(f_{i-\frac{1}{2}} - f_{i+\frac{1}{2}}\Big)\)</span> 的一种conseervative method，其中intercell numerical fluxes <span class="math notranslate nohighlight">\(f_{i+\frac{1}{2}}\)</span> 通过求解local Riemann problems来得到。该方法的一个基本假设是对于给定的时间级 <span class="math notranslate nohighlight">\(n\)</span> ，数据是按照下面的方式分片常数分布的：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n} = \frac{1}{\Delta x}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}u(x,t^{n})~\mathrm{d}x
\end{align}\]</div>
<p>在时间级 <span class="math notranslate nohighlight">\(n\)</span> 的 <span class="math notranslate nohighlight">\(f_{i+\frac{1}{2}}\)</span> 可以看成非连续分离的 <span class="math notranslate nohighlight">\((u_{i}^{n}, u_{i+1}^{n})\)</span> 在交界面 <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> 处的贡献。于是，局部地可以定义一个黎曼问题：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; u_{t} + f(u)_{x} = 0 \\
&amp; u(x,0) = u_{0}(0) =
\left \{\begin{array}{ll}
u_{i}^{n} \quad \text{if}~x&lt;0 \\
u_{i+1}^{n} \quad \text{if}~x&gt;0
\end{array}\right .
\end{align}\end{split}\]</div>
<p>这个local Riemann problem可能可以得到解析解。因此，对于给定的时间级 <span class="math notranslate nohighlight">\(n\)</span> ，在每个intercell boundary <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> 我们都得到了有初始条件 <span class="math notranslate nohighlight">\((u_{i}^{n}, u_{i+1}^{n})\)</span> 的local Riemann problem <span class="math notranslate nohighlight">\(RP(u_{i}^{n}, u_{i+1}^{n})\)</span> 。于是，现在需要一个能够找到在下一个时间级 <span class="math notranslate nohighlight">\(n+1\)</span> 的global problem的解的方法。</p>
<div class="section" id="first-version-of-godunov-s-method">
<h5>First Version of Godunov’s Method<a class="headerlink" href="#first-version-of-godunov-s-method" title="永久链接至标题">¶</a></h5>
<p>Godunov建议用下面的方式来将网格值 <span class="math notranslate nohighlight">\(u_{i}^{n}\)</span> 更新到 <span class="math notranslate nohighlight">\(u_{i}^{n+1}\)</span> ：求解守恒方程的两个黎曼问题 <span class="math notranslate nohighlight">\(RP(u_{i-1}^{n}, u_{i}^{n})\)</span> 和 <span class="math notranslate nohighlight">\(RP(u_{i}^{n},u_{i+1}^{n})\)</span> ，take an integral average in cell i of the combined solutions of these two local problems并将该值赋给 <span class="math notranslate nohighlight">\(u_{i}^{n+1}\)</span> 。对于 <span class="math notranslate nohighlight">\(a&gt;0\)</span> 时黎曼问题 <span class="math notranslate nohighlight">\(RP(u_{i-1}^{n} ,u_{i}^{n})\)</span> 的准确解为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u_{i-\frac{1}{2}}(x/t) =
\left\{\begin{array}{ll}
u_{i-1}^{n} \quad \text{if}~x/t &lt; a \\
u_{i}^{n} \quad \text{if}~x/t &gt; a
\end{array}\right.
\end{align}\end{split}\]</div>
<p>其中the local origin of the Riemann problem is <span class="math notranslate nohighlight">\((0,0)\)</span> 。类似的，黎曼问题 <span class="math notranslate nohighlight">\(RP(u_{i}^{n},u_{i+1}^{n})\)</span> 的准确解为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u_{i+\frac{1}{2}}(x/t) =
\left\{\begin{array}{ll}
u_{i}^{n} \quad \text{if}~x/t &lt; a \\
u_{i+1}^{n} \quad \text{if}~x/t &gt; a
\end{array}\right.
\end{align}\end{split}\]</div>
<p>The Godunov scheme defines the updated solution as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1}{\Delta x}
\bigg[
    \int_{0}^{\frac{1}{2}\Delta x}u_{i-\frac{1}{2}}(x/\Delta t)~\mathrm{d}x
    + \int_{-\frac{1}{2}\Delta x}^{0}u_{i+\frac{1}{2}}u_{i+\frac{1}{2}}(x/\Delta t)~\mathrm{d}x
\bigg]
\end{align}\]</div>
<p>This integral is evaluated at time <span class="math notranslate nohighlight">\(\Delta t\)</span> (local time) between the points A and D in Fig.5.6. Note that we only use the right half of the solution <span class="math notranslate nohighlight">\(u_{i-\frac{1}{2}}(x/t)\)</span> and the left half of the solution <span class="math notranslate nohighlight">\(u_{i+\frac{1}{2}}(x/t)\)</span> . Each solution has its own local frame of reference with origin <span class="math notranslate nohighlight">\((0,0)\)</span> corresponding with the intercell boundaries at <span class="math notranslate nohighlight">\(x_{i-\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> . In order to evaluate the integral we impose a restriction on the size of the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> . We set</p>
<div class="math notranslate nohighlight">
\[\begin{align}
c = \frac{a \Delta t}{\Delta x} \le \frac{1}{2}
\end{align}\]</div>
<p>The first term in the updated solution involves the intervals AB and BC; these have lengths respectively given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
l_{AB} = c\Delta x
,\quad
l_{BC} = (\frac{1}{2} - c)\Delta x
\end{align}\]</div>
<p>The integrand is given by exact solution <span class="math notranslate nohighlight">\(u_{i-\frac{1}{2}}(x/t), u_{i+\frac{1}{2}}(x/t)\)</span> ; hence we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{1}{\Delta x}\int_{0}^{\frac{1}{2}\Delta x}u_{i-\frac{1}{2}}(x/\Delta t)~\mathrm{d}x
= c u_{i-1}^{n} + (\frac{1}{2} - c)u_{i}^{n}
\end{align}\]</div>
<p>The second term gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{1}{\Delta x}\int_{-\frac{1}{2}\Delta x}^{0}u_{i+\frac{1}{2}}(x/\Delta t)~\mathrm{d}x = \frac{1}{2}u_{i}^{n}
\end{align}\]</div>
<p>Hence the updated solution becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = u_{i}^{n} + c(u_{i-1}^{n} - u_{i}^{n})
\end{align}\]</div>
<p>which is identical to the first order upwind method for positive speed a. The conservative charater of the Godunov method is self evident: the updated solution is obtained by integral averaging, a conservative process, of local exact solutions of the conservation law.</p>
</div>
<div class="section" id="second-version-of-godunov-s-method">
<h5>Second Version of Godunov’s Method<a class="headerlink" href="#second-version-of-godunov-s-method" title="永久链接至标题">¶</a></h5>
<p>A second interpretation of the Godunov method leads directly to the conservative formula, which is easier to apply in practice and avoids the over-restrictive CFL-like condition <span class="math notranslate nohighlight">\(c = \frac{a\Delta t}{\Delta x} \le \frac{1}{2}\)</span> . The integral average of the solution of the Riemann problems <span class="math notranslate nohighlight">\(RP(u_{i-1}^{n},u_{i}^{n})\)</span> and <span class="math notranslate nohighlight">\(RP(u_{i}^{n},u_{i+1}^{n})\)</span> can also be written as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1}{\Delta x}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}\tilde{u}(x,\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{u}(x,t)\)</span> is understood as the combined solution of <span class="math notranslate nohighlight">\(RP(u_{i-1}^{n},u_{i}^{n})\)</span> and <span class="math notranslate nohighlight">\(RP(u_{i}^{n},u_{i+1}^{n})\)</span> . Since <span class="math notranslate nohighlight">\(\tilde{u}(x,t)\)</span> is an exact solution to the original conservation law, we can make use of it in its integral form, say, in the control volume <span class="math notranslate nohighlight">\([x_{i-\frac{1}{2}}, x_{i+\frac{1}{2}}] \times [0, \Delta t]\)</span> to write</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{u}(x,\Delta t)~\mathrm{d}x
= \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{u}(x,0)~\mathrm{d}x
  + \int_{0}^{\Delta t} f\big( \tilde{u}(x_{i-\frac{1}{2}}, t) \big)~\mathrm{d}t
  - \int_{0}^{\Delta t} f\big( \tilde{u}(x_{i+\frac{1}{2}}, t) \big)~\mathrm{d}t
\end{align}\]</div>
<p>Using the definition of cell averages <span class="math notranslate nohighlight">\(u_{i}^{n} = \frac{1}{\Delta x}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}u(x,t^{n})~\mathrm{d}x\)</span> into the above equation followed by division through by <span class="math notranslate nohighlight">\(\Delta x\)</span> , we reproduce the conservative formula</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = u_{i}^{n} + \frac{\Delta t}{\Delta x} \Big( f_{i-\frac{1}{2}} - f_{i+\frac{1}{2}} \Big)
\end{align}\]</div>
<p>with the intercell fluxes defined as time integral averages, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i-\frac{1}{2}} = \frac{1}{\Delta} \int_{0}^{\Delta t} f\big( \tilde{u}(x_{i-\frac{1}{2}},t) \big)~\mathrm{d}t
,\qquad
f_{i+\frac{1}{2}} = \frac{1}{\Delta} \int_{0}^{\Delta t} f\big( \tilde{u}(x_{i+\frac{1}{2}},t) \big)~\mathrm{d}t
\end{align}\]</div>
<p>Thus, by invoking the integral form of the conservation laws on a control or finite volume <span class="math notranslate nohighlight">\([x_{i-\frac{1}{2}},x_{i+\frac{1}{2}}] \times [0,\Delta t]\)</span> in <span class="math notranslate nohighlight">\(x-t\)</span> space we have arrived at the conservative formula with intercell fluxes; these are time integral averages of the physical flux <span class="math notranslate nohighlight">\(f(u)\)</span> evaluated at the intercell boundaries. The integrand <span class="math notranslate nohighlight">\(f\big(\tilde{u}(x,t)\big)\)</span> at each cell interface depends on the exact solution <span class="math notranslate nohighlight">\(\tilde{u}(x,t)\)</span> of the Riemann problem along the t-axis (local coordinates); this is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u}(x_{i-\frac{1}{2}},t) = u_{i-\frac{1}{2}}(0)
,\qquad
\tilde{u}(x_{i+\frac{1}{2}},t) = u_{i+\frac{1}{2}}(0)
\end{align}\]</div>
<p>and the intercell fluxes <span class="math notranslate nohighlight">\(f_{i-\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(f_{i+\frac{1}{2}}\)</span> become</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i-\frac{1}{2}} = f\big(u_{i-\frac{1}{2}}(0)\big)
,\qquad
f_{i+\frac{1}{2}} = f\big(u_{i+\frac{1}{2}}(0)\big)
\end{align}\]</div>
<p>In general, one expresses the Godunov intercell numerical flux as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i+\frac{1}{2}}^{Godunov} = f\big(u_{i+\frac{1}{2}}(0)\big)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(u_{i+\frac{1}{2}}(0)\)</span> denotes the exact solution <span class="math notranslate nohighlight">\(u_{i+\frac{1}{2}}(x/t)\)</span> of the Riemann problem <span class="math notranslate nohighlight">\(RP(u_{i}^{n},u_{i+1}^{n})\)</span> evaluated at <span class="math notranslate nohighlight">\(x/t=0\)</span> , i.e. the solution is evaluated along the intercell boundary, which coincides with the t-axis in the local frame of the Riemann problem solution. We have thus defined the second version of Godunov’s method for a general scalar conservation law, as the conservative formula together with the intercell numerical flux. For the special conservation law with flux <span class="math notranslate nohighlight">\(f(u)=au,a&gt;0\)</span> , we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i-\frac{1}{2}} = au_{i-1}^{n}
,\qquad
f_{i+\frac{1}{2}} = au_{i}^{n}
\end{align}\]</div>
<p>which if substituted in the conservative formula reproduce the first-order upwind scheme. The second version <span class="math notranslate nohighlight">\(u_{i}^{n+1} = u_{i}^{n} + \frac{\Delta t}{\Delta x} \Big( f_{i-\frac{1}{2}} - f_{i+\frac{1}{2}} \Big)\)</span> , <span class="math notranslate nohighlight">\(f_{i+\frac{1}{2}}^{Godunov} = f\big(u_{i+\frac{1}{2}}(0)\big)\)</span> of Godunov’s method is the one that is mostly used in practice.</p>
</div>
</div>
<div class="section" id="godunov-s-method-for-burgers-s-equation">
<h4>Godunov’s Method for Burgers’s Equation<a class="headerlink" href="#godunov-s-method-for-burgers-s-equation" title="永久链接至标题">¶</a></h4>
<p>As a way of illustrating Godunov’s method in the context of non-linear PDEs, we apply the scheme to the inviscid Burgers equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{t} + f(u)_{x} = 0
,\quad
f(u) = \frac{1}{2}u^{2}
\end{align}\]</div>
<p>We adopt the second version <span class="math notranslate nohighlight">\(u_{i}^{n+1} = u_{i}^{n} + \frac{\Delta t}{\Delta x} \Big( f_{i-\frac{1}{2}} - f_{i+\frac{1}{2}} \Big)\)</span> with numerical flux given by <span class="math notranslate nohighlight">\(f_{i+\frac{1}{2}}^{Godunov} = f\big(u_{i+\frac{1}{2}}(0)\big)\)</span> . We need the solution <span class="math notranslate nohighlight">\(u_{i+\frac{1}{2}}(x/t)\)</span> of the Riemann problem <span class="math notranslate nohighlight">\(RP(u_{i}^{n}, u_{i+1}^{n})\)</span> . The solution is a shock wave when <span class="math notranslate nohighlight">\(u_{i}^{n} &gt; u_{i+1}^{n}\)</span> , and a rarefaction wave when <span class="math notranslate nohighlight">\(u_{i}^{n} \le u_{i+1}^{n}\)</span> . The complete solution is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; u_{i+\frac{1}{2}}(x/t) = \left \{ \begin{array}{ll}
u_{i}^{n} \quad \text{if}~\frac{1}{2}(u_{i}^{n} + u_{i+1}^{n}) \ge x/t \\
u_{i+1}^{n} \quad \text{if}~\frac{1}{2}(u_{i}^{n} + u_{i+1}^{n}) \le x/t
\end{array} \right .
\qquad \text{if}~u_{i}^{n} &gt; u_{i+1}^{n} \\
&amp; u_{i+\frac{1}{2}}(x/t) = \left \{ \begin{array}{ll}
u_{i}^{n} \quad \text{if}~x/t \le u_{i}^{n} \\
x/t \quad \text{if}~u_{i}^{n} &lt; x/t &lt; u_{i+1}^{n} \\
u_{i+1}^{n} \quad \text{if}~x/t \ge u_{i+1}^{n}
\end{array} \right .
\qquad \text{if}~u_{i}^{n} \le u_{i+1}^{n}
\end{align}\end{split}\]</div>
<p>The Godunov’s flux requires <span class="math notranslate nohighlight">\(u_{i+\frac{1}{2}}(0)\)</span> ; this is the solution <span class="math notranslate nohighlight">\(u_{i+\frac{1}{2}}(x/t)\)</span> evaluated along the intercell boundary <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> , that corresponds to <span class="math notranslate nohighlight">\(x/t = 0\)</span> in the frame of the local Riemann problem.</p>
<p>The second stage is to identify all possible wave patterns in the solution of the Riemann problem. For Burgers’s equation there are five possibilities. These are illustrated in Fig.5.7. If the solution is a shock wave, then cases (a) and (b) can occur. The sought value <span class="math notranslate nohighlight">\(u_{i+\frac{1}{2}}(0)\)</span> , on the t-axis, depends on the sign of the shock speed <span class="math notranslate nohighlight">\(\frac{1}{2}(u_{i}^{n} + u_{i+1}^{n})\)</span> . If the solution is a rarefaction wave, then the three possible cases are illustrated in Figs.5.7c, 5.7d and 5.7e. Applying terminology from Gas Dynamics to the rarefaction cases, Fig.5.7c is called supersonic to the left, and that of Fig.5.7d supersonic to the right. The case of Fig.5.7e is that of a transonic rarefaction or sonic rarefaction; as the wave is crossed, there is a sign change in the characteristic speed <span class="math notranslate nohighlight">\(u\)</span> , and thus there is one point at which <span class="math notranslate nohighlight">\(u=0\)</span> , a sonic point. The complete sought solution is summarised as follows</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; u_{i+\frac{1}{2}}(0) = \left \{ \begin{array}{ll}
u_{i}^{n} \quad \text{if}~\frac{1}{2}(u_{i}^{n} + u_{i+1}^{n}) \ge 0 \\
u_{i+1}^{n} \quad \text{if}~\frac{1}{2}(u_{i}^{n} + u_{i+1}^{n}) \le 0
\end{array} \right .
\qquad \text{if}~u_{i}^{n} &gt; u_{i+1}^{n} \\
&amp; u_{i+\frac{1}{2}}(0) = \left \{ \begin{array}{ll}
u_{i}^{n} \quad \text{if}~0 \le u_{i}^{n} \\
x/t \quad \text{if}~u_{i}^{n} &lt; 0 &lt; u_{i+1}^{n} \\
u_{i+1}^{n} \quad \text{if}~0 \ge u_{i+1}^{n}
\end{array} \right .
\qquad \text{if}~u_{i}^{n} \le u_{i+1}^{n}
\end{align}\end{split}\]</div>
<p>Naturally, Godunov’s method can also be implemented using approximate soluitons to the Riemann problem. In applying Godunov’s scheme to solve Burgers’s equation, there are two more issues to consider. One concerns the application of boundary conditions, and the other is to do with the choice of the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> .</p>
<div class="section" id="boundary-conditions">
<h5>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="永久链接至标题">¶</a></h5>
<p>The conservative formula can be applied directly to all cells <span class="math notranslate nohighlight">\(i\)</span> , for <span class="math notranslate nohighlight">\(i = 2,\cdots, M-1\)</span> . The two required intercell fluxes at <span class="math notranslate nohighlight">\(x_{i-\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> are defined in terms of the corresponding Riemann problems. For each of the cells <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(M\)</span> , which are adjacent to the left and right boundaries respectively, we only have one intercell flux. Some special procedure needs to be implemented. Let us consider the left boundary <span class="math notranslate nohighlight">\(x=0\)</span> . One possibility is to assume a boundary function <span class="math notranslate nohighlight">\(u_{1}(t)\)</span> prescribed there. Then we could define an intercell flux at the boundary by setting <span class="math notranslate nohighlight">\(f_{\frac{1}{2}} = f(u_{1}(t))\)</span> .</p>
<p>A more attractive alternative is to specify a fictitious cell <span class="math notranslate nohighlight">\(0\)</span> to the left of the boundary <span class="math notranslate nohighlight">\(x=0\)</span> together with a cell average <span class="math notranslate nohighlight">\(u_{0}^{n}\)</span>, at each time level <span class="math notranslate nohighlight">\(n\)</span> , so that a Riemann problem <span class="math notranslate nohighlight">\(RP(u_{0}^{n},u_{1}^{n})\)</span> can be posed and solved to find the missing intercell flux <span class="math notranslate nohighlight">\(f_{\frac{1}{2}}\)</span> . For the right boundary we prescribe a fictitous cell <span class="math notranslate nohighlight">\(M+1\)</span> and a cell average <span class="math notranslate nohighlight">\(u_{M+1}^{n}\)</span> to find the intercell flux <span class="math notranslate nohighlight">\(f_{M+\frac{1}{2}}\)</span> . The prescription of the fictitious states depends entirely on the physics of the particular problem at hand. Provisionally, for the inviscid Burgers’s equation we apply the boundary conditions</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{0}^{n} = u_{1}^{n}
,\quad
u_{M+1}^{n} = u_{M}^{n}
\end{align}\]</div>
<p>Note that the fictitious states here are given in terms of the data at the states within the computational domain adjacent to the boundaries. This particular type of boundary conditions will cause no disturbance at the boundaries; waves will hopefully go through the boundaries as if the boundaries were not there. Often one speaks of transparent or transmissive boundary conditions in this case.</p>
</div>
<div class="section" id="choosing-the-time-step">
<h5>Choosing the Time Step<a class="headerlink" href="#choosing-the-time-step" title="永久链接至标题">¶</a></h5>
<p>As seen for the linear case, the choice of the size of the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> in the conservative formula is related to the stability condition of the particular scheme. For Godunov’s method, the choice of <span class="math notranslate nohighlight">\(\Delta t\)</span> depends on the restriction on the Courant number <span class="math notranslate nohighlight">\(c\)</span> . For non-linear problems, at each time level, there are multiple wave speeds and thus multiple associated Courant numbers. In deriving the second version of the Godunov’s method, we made the implicit assumption that the value of the local Riemann problem solution along the intercell boundary is constant. This means that the fastest wave at a given time travels for at most one cell length <span class="math notranslate nohighlight">\(\Delta x\)</span> in the sought time step <span class="math notranslate nohighlight">\(\Delta t\)</span> . Denoting by <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> the maximum wave speed throughout the domain at time level <span class="math notranslate nohighlight">\(n\)</span> we define the maximum Courant number <span class="math notranslate nohighlight">\(C_{cfl}\)</span> ：</p>
<div class="math notranslate nohighlight">
\[\begin{align}
C_{cfl} = \frac{\Delta t S_{\max}^{n}}{\Delta x}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta t\)</span> is such that</p>
<div class="math notranslate nohighlight">
\[\begin{align}
0 &lt; C_{cfl} &lt; 1
\end{align}\]</div>
<div class="admonition attention">
<p class="first admonition-title">注意</p>
<p class="last">这里的 <span class="math notranslate nohighlight">\(S\)</span> 表示波速 <span class="math notranslate nohighlight">\(S = \frac{1}{2}(u_{i}^{n} + u_{i+1}^{n})\)</span> ，而不是面积。</p>
</div>
<p>We shall often call <span class="math notranslate nohighlight">\(C_{cfl}\)</span> the <strong>CFL coefficient</strong> or <strong>Courant number coefficient</strong> . The time step <span class="math notranslate nohighlight">\(\Delta t\)</span> follows as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t = C_{cfl} \Delta x / S_{\max}
\end{align}\]</div>
<p>A matter of crucial importance is the estimation of the maximum speed <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> . In realistic applications this can be difficult and frustrating, as inappropriate choices can cause the scheme to crash, no matter how sophisticated this is. For Burgers’s equation one can identify wave speeds, such as those emerging from solutions of Riemann problems at the intercell boundaries, and characteristic speeds <span class="math notranslate nohighlight">\(u\)</span> . At any time level <span class="math notranslate nohighlight">\(n\)</span> , there are <span class="math notranslate nohighlight">\(M+2\)</span> characteristic speeds <span class="math notranslate nohighlight">\(u_{i}^{n}\)</span> (including the fictitious cells) and hence one possibility is to take <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> as the maximum of these, in absolute value. Another possibility is to select, at each time level, a speed <span class="math notranslate nohighlight">\(S_{i+\frac{1}{2}}^{n}\)</span> from the solution Riemann problem at each cell interface; this information is available as part of the flux computation process. For the case of a shock, one oboviously takes the shock speed. For the case of a rarefaction there are two characteristic speeds of significance, namely those of the head and tail of the expansion. Thus we define an intercell speed</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
S_{i+\frac{1}{2}}^{n} = \left \{ \begin{array}{ll}
|\frac{1}{2}(u_{i}^{n} + u_{i+1}^{n})| \quad \text{(shock)} \\
\max(|u_{i}^{n}|, |u_{i+1}^{n}|) \quad \text{(rarefaction)}
\end{array} \right .
\end{align}\end{split}\]</div>
<p>Finally, we define a maximum wave speed at time level <span class="math notranslate nohighlight">\(n\)</span> as follows</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{\max}^{n} = \max_{i}\left\{ S_{i+\frac{1}{2}}^{n} \right \} \quad \text{for}~ i=0,\cdots,M+1
\end{align}\]</div>
<p>Having chosen <span class="math notranslate nohighlight">\(C_{cfl}\)</span> , the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> to march the solution to the next time level is given by <span class="math notranslate nohighlight">\(\Delta t = C_{cfl}\Delta x / S_{\max}^{n}\)</span> . For a scheme with linearised stability condition <span class="math notranslate nohighlight">\(|c| \le 1\)</span> , one usually takes the empirical value <span class="math notranslate nohighlight">\(C_{cfl} = 0.9\)</span> .</p>
</div>
</div>
<div class="section" id="conservative-form-of-difference-schemes">
<h4>Conservative Form of Difference Schemes<a class="headerlink" href="#conservative-form-of-difference-schemes" title="永久链接至标题">¶</a></h4>
<p>Conventional finite difference schemes can often be expressed in conservation form. It is a question of finding an intercell flux.</p>
<div class="section" id="the-lax-friedrichs-scheme">
<h5>The Lax-Friedrichs Scheme<a class="headerlink" href="#the-lax-friedrichs-scheme" title="永久链接至标题">¶</a></h5>
<p>The Lax-Friedrichs scheme as applied to the linear advection equation is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1+c}{2}u_{i-1}^{n} + \frac{1-c}{2}u_{i+1}^{n}
\end{align}\]</div>
<p>It is easy to verify that the conservative formula together with the intercell flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i+\frac{1}{2}} = \frac{1+c}{2c}f(u_{i}^{n}) + \frac{c - 1}{2c}f(u_{i+1}^{n})
\end{align}\]</div>
<p>reproduces the Lax-Friedrichs scheme. Therefore, at least for the linear advection equation, one can recast the Lax-Friedrichs scheme in conservative form.</p>
<p>An interesting way of viewing the Lax-Friedrichs scheme is as an integral average within cell <span class="math notranslate nohighlight">\(i\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{u}(x,\frac{1}{2}\Delta t)\cdot \mathrm{d}x
\end{align}\]</div>
<p>in which <span class="math notranslate nohighlight">\(\tilde{u}(x,t)\)</span> is the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(u_{i-1}^{n}, u_{i+1}^{n})\)</span> , that is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{u}(x/t) = \left\{ \begin{array}{ll}
u_{i-1}^{n} \quad \text{if}~x/t &lt; a \\
u_{i+1}^{n} \quad \text{if}~x/t &gt; a
\end{array} \right.
\end{align}\end{split}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">We note that the Lax-Fridrichs solution at cell <span class="math notranslate nohighlight">\(i\)</span> is a weighted average of the solution of the Riemann problem with the left and right neighbour states as data, at time <span class="math notranslate nohighlight">\(t=\frac{1}{2}\Delta t\)</span> . One could state that the Lax-Friedrichs scheme is upwind biased, as the upwidn term has always the larger weight.</p>
</div>
<p>Let us now attempt to generalise interpretation of the Lax-Friedrichs scheme to non-linear systems of conservation laws</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = 0
\end{align}\]</div>
<p>Now the integral average within cell reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \hat{\mathbf{U}}(x,\frac{1}{2}\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}(x,t)\)</span> is the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i-1}^{n}, \mathbf{U}_{i+1}^{n})\)</span> . Given an exact Riemann solver, one could then implement this Riemann-problem based version of the Lax-Friedrichs scheme. The author has implemented this version of the scheme for non-linear systems. The numerical results obtained are indistinguishable from those obtained from the conventional form of the scheme. The above version of the integral average offers no obvious advantages over the conventional form; in fact it is more expensive and complex and hence is of no practical use. A stochastic evaluation of the integral leads to a random choice type method.</p>
<p>If the space integral at time <span class="math notranslate nohighlight">\(\frac{1}{2}\Delta t\)</span> given above is replaced by invoking the integral form of conservation law in control volume <span class="math notranslate nohighlight">\([-\frac{1}{2}\Delta x, \frac{1}{2}\Delta x] \times [0, \frac{1}{2}\Delta t]\)</span> we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x} \hat{\mathbf{U}}(x,\frac{1}{2}\Delta t)\mathrm{d}x
= \int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x} \hat{\mathbf{U}}(x,0)\mathrm{d}x
+ \int_{0}^{\frac{1}{2}\Delta t}\mathbf{F}(\hat{\mathbf{U}}(-\frac{1}{2}\Delta x, t))~\mathrm{d}t
- \int_{0}^{\frac{1}{2}\Delta t}\mathbf{F}(\hat{\mathbf{U}}(\frac{1}{2}\Delta x, t))~\mathrm{d}t
\end{align}\]</div>
<p>Direct evaluation of the integrals and use of the definition of integral averages in cell <span class="math notranslate nohighlight">\(i\)</span> , as applied to systems, yield</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1}
= \frac{1}{2}(\mathbf{U}_{i-1}^{n} + \mathbf{U}_{i+1}^{n})
+ \frac{1}{2}\frac{\Delta t}{\Delta x}(\mathbf{F}_{i-1}^{n} - \mathbf{F}_{i+1}^{n})
\end{align}\]</div>
<p>Simple algebraic manipulations of this expression lead to a conservative version of the Lax-Friedrichs scheme for systems</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} + \frac{\Delta t}{\Delta x}\Big( \mathbf{F}_{i-\frac{1}{2}} - \mathbf{F}_{i+\frac{1}{2}} \Big)
\end{align}\]</div>
<p>with the Lax-Friedrichs intercell flux given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}}^{LF}
= \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n})
+ \frac{1}{2}\frac{\Delta x}{\Delta t}(\mathbf{U}_{i}^{n} - \mathbf{U}_{i+1}^{n})
\end{align}\]</div>
<p>This is the conventional numerical flux for the Lax-Friedrichs scheme when applied to systems of conservations laws <span class="math notranslate nohighlight">\(\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = 0\)</span> . No mention of the Riemann problem is needed in this formulation.</p>
</div>
<div class="section" id="the-lax-wendroff-scheme">
<h5>The Lax-Wendroff Scheme<a class="headerlink" href="#the-lax-wendroff-scheme" title="永久链接至标题">¶</a></h5>
<p>The Lax-Wendroff scheme as applied to the linear advection equation may also be written in conservation form. The intercell numerical flux is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i+\frac{1}{2}} = \frac{1+c}{2}(au_{i}^{n}) + \frac{1-c}{2}(au_{i+1}^{n})
\end{align}\]</div>
<p>which is a weighted average of fluxes on the left and right of the interface. For the linear advection equation, it is easy to check that this can also be obtained from</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i+\frac{1}{2}} = f(u_{i+\frac{1}{2}}^{n+\frac{1}{2}})
,\qquad
u_{i+\frac{1}{2}}^{n+\frac{1}{2}} = \frac{1+c}{2}u_{i}^{n} + \frac{1-c}{2}u_{i+1}^{n}
\end{align}\]</div>
<p>For non-linear scalar conservation laws, such as Burgers’s equations, this generalises to</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i+\frac{1}{2}} = f(u_{i+\frac{1}{2}}^{n+\frac{1}{2}})
,\qquad
u_{i+\frac{1}{2}}^{n+\frac{1}{2}} = \frac{1}{\Delta x} \int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x} u_{i+\frac{1}{2}}(x, \frac{1}{2}\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(u_{i+\frac{1}{2}}(x,t)\)</span> is the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(u_{i}^{n}, u_{i+1}^{n})\)</span> . A straightforward Riemann-problem based generalisation of the Lax-Wendroff scheme to non-linear hyperbolic systems reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}})
,\qquad
\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}} = \frac{1}{\Delta x} \int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x} \mathbf{U}_{i+\frac{1}{2}}(x, \frac{1}{2}\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x,t)\)</span> is the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> . This scheme is called the <strong>Weighted Average Flux(WAF)</strong> method.</p>
<p>As done for the Lax-Friedrichs scheme, one may repalce the integral involving the solution of the Riemann problem by invoking the integral form of the conservation laws in the control volume <span class="math notranslate nohighlight">\([-\frac{1}{2}\Delta x, \frac{1}{2}\Delta x] \times [0, \frac{1}{2}\Delta t]\)</span> to obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}}
= \mathbf{F}(\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}})
,\qquad
\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}}
= \frac{1}{2}(\mathbf{U}_{i}^{n} + \mathbf{U}_{i+1}^{n})
+ \frac{1}{2}\frac{\Delta t}{\Delta x}(\mathbf{F}_{i}^{n} - \mathbf{F}_{i+1}^{n})
\end{align}\]</div>
<p>This scheme is known as the two-step Richtmyer version of the Lax-Wendroff method, as applied to non-linear systems of conservatioin laws <span class="math notranslate nohighlight">\(\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = 0\)</span> . No mention of the Riemann problem solution is necessary here.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Note the similarities between the reinterpretations and generalisations of the Lax-Friedrichs and Lax-Wendroff schemes. For both schemes one ends up with two formulations. For the Lax-Friedrichs scheme the weighted-average charater leads to an integral formulation involving the solution of the Riemann problem. The second version of the scheme eliminates the role of the Riemann problem by utilising the integral form of the conservatioin law and leads to the conventional form of the Lax-Friedrichs scheme for non-linear systems. For the Lax-Wendroff method the procedure is entirely analogous. An integral average interpretation leads to a Riemann-problem based extension to non-linear systems. Utilisation of the integral form of the conservation law eliminates the role of the Riemann problem and leads to the conventional Richtmyer version version of the scheme. Both versions of the Lax-Wendroff method have actually been applied in practice.</p>
</div>
</div>
</div>
</div>
<div class="section" id="upwind-schemes-for-linear-systems">
<h3>Upwind Schemes for Linear Systems<a class="headerlink" href="#upwind-schemes-for-linear-systems" title="永久链接至标题">¶</a></h3>
<p>Here we apply the first-order upwind scheme to hyperbolic systems with constant coefficients</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>We can consider the linearised equations of Gas Dynamics as an example</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}
\end{align}\]</div>
<p>with</p>
<div class="last math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} = \begin{bmatrix} \rho \\ u \end{bmatrix}
,\qquad
\mathbf{A} = \begin{bmatrix} 0 &amp; \rho_{0} \\ a^{2}/\rho_{0} &amp; 0 \end{bmatrix}
\end{align}\end{split}\]</div>
</div>
<p>We denote the real eigenvalues of the <span class="math notranslate nohighlight">\(m \times m\)</span> constant coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> by <span class="math notranslate nohighlight">\(\lambda_{j}\)</span> with <span class="math notranslate nohighlight">\(j=1,\cdots,m\)</span> and assume they are ordered as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} &lt; \lambda_{2} &lt; \lambda_{3} &lt; \cdots &lt; \lambda_{m}
\end{align}\]</div>
<p>The corresponding right eigenvectors are denoted by <span class="math notranslate nohighlight">\(\mathbf{K}^{(1)},\mathbf{K}^{(2)},\cdots,\mathbf{K}^{(m)}\)</span> . Note here that in general the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{j}\)</span> can be of any sign and thus a one-sided differencing scheme applied to <span class="math notranslate nohighlight">\(\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}\)</span> directly will only work if all the eigenvalues are of the same sign. In the general case with eigenvalues of mixed sign, the particular chosen side for the differencing will be upwind for only some of the eigenvalues and downwind for the rest. The difficulty can be resolved by splitting the matrix into two matrices, one of them having positive or zero eigenvalues and the other having negative or zero eigenvalues. From the assumption of hyperbolicity, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> may be diagonalised as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A} = \mathbf{K}\mathbf{\Lambda}\mathbf{K}^{-1}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is the matrix whose columns are the right eigenvectors <span class="math notranslate nohighlight">\(\mathbf{K}^{(k)}\)</span> , <span class="math notranslate nohighlight">\(\mathbf{K}^{-1}\)</span> is the inverse of <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span> is the diagonal matrix formed by the eigenvalues of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{\Lambda} = \begin{pmatrix}
\lambda_{1} &amp; &amp; 0 \\
 &amp; \ddots &amp; \\
0 &amp; &amp; \lambda_{m}
\end{pmatrix}
\end{align}\end{split}\]</div>
<p>In terms of the characteristic variables</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{V} = \mathbf{K}^{-1}\mathbf{U}
\end{align}\]</div>
<p>system <span class="math notranslate nohighlight">\(\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}\)</span> becomes the decoupled system</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{V}_{t} + \mathbf{\Lambda}\mathbf{V}_{x} = \mathbf{0}
\end{align}\]</div>
<p>where the <span class="math notranslate nohighlight">\(j\)</span> -th equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial }{\partial t}v_{j} + \lambda_{j}\frac{\partial }{\partial x}v_{j} = 0, \quad \text{for}~j=1,\cdots,m
\end{align}\]</div>
<p>involves only the variable <span class="math notranslate nohighlight">\(v_{j}(x,t)\)</span> .</p>
<div class="section" id="the-cir-scheme">
<h4>The CIR Scheme<a class="headerlink" href="#the-cir-scheme" title="永久链接至标题">¶</a></h4>
<p>From a numerical point of view the decomposition of <span class="math notranslate nohighlight">\(\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}\)</span> into the decoupled set <span class="math notranslate nohighlight">\(\mathbf{V}_{t} + \mathbf{\Lambda}\mathbf{V}_{x} = \mathbf{0}\)</span> with component equations is very convenient. Each component equation is a linear advection equation with characteristic speed <span class="math notranslate nohighlight">\(\lambda_{j} = \text{constant}\)</span> . The first-order upwind scheme can directly be applied to each component equation. As for the scalar case we introduce the following definitions</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \lambda_{j}^{+} := \max(\lambda_{j}, 0) = \frac{1}{2}(\lambda_{j} + |\lambda_{j}|) \\
&amp; \lambda_{j}^{-} := \min(\lambda_{j}, 0) = \frac{1}{2}(\lambda_{j} - |\lambda_{j}|)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(|\lambda_{j}|\)</span> is the absolute value of <span class="math notranslate nohighlight">\(\lambda_{j}\)</span> . The following relations can be easily verified</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{j} = \lambda_{j}^{+} + \lambda_{j}^{-}
,\qquad
|\lambda_{j}| = \lambda_{j}^{+} - \lambda_{j}^{-}
\end{align}\]</div>
<p>Then, the first-order upwind scheme applied to each PDE in the component equations for the characteristic variables reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(v_{j})_{i}^{n+1} = (v_{j}^{n})_{i}
- \frac{\Delta t}{\Delta x} \lambda_{j}^{+} \big[ (v_{j})_{i}^{n} - (v_{j})_{i-1}^{n} \big]
- \frac{\Delta t}{\Delta x} \lambda_{j}^{-} \big[ (v_{j})_{i+1}^{n} - (v_{j})_{i}^{n} \big]
\end{align}\]</div>
<p>This is a straight generalisation of the first-order upwind scheme to decoupled linear hyperbolic system <span class="math notranslate nohighlight">\(\mathbf{V}_{t} + \mathbf{\Lambda}\mathbf{V}_{x} = \mathbf{0}\)</span> .</p>
<p>Based on definitions of <span class="math notranslate nohighlight">\(\lambda_{j}^{+},\lambda_{j}^{-}\)</span> we can form the positive <span class="math notranslate nohighlight">\(\mathbf{\Lambda}^{+}\)</span> and negative <span class="math notranslate nohighlight">\(\mathbf{\Lambda}^{-}\)</span> components of the diagonal matrix <span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{\Lambda}^{\pm} = \begin{pmatrix}
\lambda_{1}^{\pm} &amp; &amp; 0 \\
 &amp; \ddots &amp; \\
0 &amp; &amp; \lambda_{m}^{\pm}
\end{pmatrix}
\end{align}\end{split}\]</div>
<p>Property <span class="math notranslate nohighlight">\(\mathbf{A} = \mathbf{K}\mathbf{\Lambda}\mathbf{K}^{-1}\)</span> allows us to introduce the positive and negative componets of the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}^{-} = \mathbf{K}\mathbf{\Lambda}^{-}\mathbf{K}^{-1}
,\qquad
\mathbf{A}^{+} = \mathbf{K}\mathbf{\Lambda}^{+}\mathbf{K}^{-1}
\end{align}\]</div>
<p>The matrices above can be shown to satisfy the following</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{\Lambda} = \mathbf{\Lambda}^{+} + \mathbf{\Lambda^{-}}
,\quad
|\mathbf{\Lambda}| = \mathbf{\Lambda}^{+} - \mathbf{\Lambda^{-}} \\
&amp; \mathbf{A} = \mathbf{A}^{+} + \mathbf{A}^{-}
,\quad
|\mathbf{A}| = \mathbf{A}^{+} - \mathbf{A}^{-}
\end{align}\end{split}\]</div>
<p>The first-order upwind scheme can be written as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{V}_{i}^{n+1} = \mathbf{V}_{i}^{n}
- \frac{\Delta t}{\Delta x} \mathbf{\Lambda}^{+} (\mathbf{V}_{i}^{n} - \mathbf{V}_{i-1}^{n})
- \frac{\Delta t}{\Delta x} \mathbf{\Lambda}^{-} (\mathbf{V}_{i+1}^{n} - \mathbf{V}_{i}^{n})
\end{align}\]</div>
<p>In terms of the original variables <span class="math notranslate nohighlight">\(\mathbf{U} = \mathbf{K}\mathbf{V}\)</span> this scheme may be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n}
- \frac{\Delta t}{\Delta x} \mathbf{A}^{+} \Big( \mathbf{U}_{i}^{n} - \mathbf{U}_{i-1}^{n} \Big)
- \frac{\Delta t}{\Delta x} \mathbf{A}^{-} \Big( \mathbf{U}_{i+1}^{n} - \mathbf{U}_{i}^{n} \Big)
\end{align}\]</div>
<p>This is the generalisation of the first-order upwind scheme to linear hyperbolic systems <span class="math notranslate nohighlight">\(\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}\)</span> with constant coefficients. Note that by splitting the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> into a positive and a negative component we have been able to retain the basic principle of performing the one-sided spatial differencing according to the sign of the charateristic speeds. The differencing <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n} - \mathbf{U}_{i-1}^{n}\)</span> is upwind for the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}^{+}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{i+1}^{n} - \mathbf{U}_{i}^{n}\)</span> is upwind for the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}^{-}\)</span> .</p>
</div>
<div class="section" id="godunov-s-method">
<h4>Godunov’s Method<a class="headerlink" href="#godunov-s-method" title="永久链接至标题">¶</a></h4>
<p>Consider the constant coefficient, linear hyperbolic system written in conservation-law form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
,\qquad
\mathbf{F}(\mathbf{U}) = \mathbf{A}\mathbf{U}
\end{align}\]</div>
<p>The Godunov first-order upwind method utilises the conservative formula and requires the solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> of the local Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}m, \mathbf{U}_{i+1}^{n})\)</span> for the above system to compute the intercell numerical flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}\big( \mathbf{U}_{i+\frac{1}{2}}(0) \big)
\end{align}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0)\)</span> is the value of the solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> at <span class="math notranslate nohighlight">\(x/t=0\)</span> along the intercell boundary. The solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> can be easily found by first expanding the initial data <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n},\mathbf{U}_{i+1}^{n}\)</span> in terms of the right eigenvectors as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n} = \sum_{j=1}^{m}\alpha_{j}\mathbf{K}^{(j)}
,\qquad
\mathbf{U}_{i+1}^{n} = \sum_{j=1}^{m}\beta_{j}\mathbf{K}^{(j)}
\end{align}\]</div>
<p>The general solution at any point <span class="math notranslate nohighlight">\((x,t)\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i+\frac{1}{2}}(x/t) = \sum_{j=1}^{I}\beta_{j}\mathbf{K}^{(j)} + \sum_{j=I+1}^{m}\alpha_{j}\mathbf{K}^{(j)}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(I\)</span> is the largest integer with <span class="math notranslate nohighlight">\(1 \le I \le m\)</span> such that <span class="math notranslate nohighlight">\(x/t \ge \lambda_{I}\)</span> . The Godunov flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{i+\frac{1}{2}}(0))\)</span> requires the solution at <span class="math notranslate nohighlight">\(x/t = 0\)</span> in the above equation. For <span class="math notranslate nohighlight">\(x/t = 0\)</span> , <span class="math notranslate nohighlight">\(I\)</span> is such that <span class="math notranslate nohighlight">\(\lambda_{I} \le 0\)</span> and <span class="math notranslate nohighlight">\(\lambda_{I+1} \ge 0\)</span> , then <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0)\)</span> is obtained by manipulating the above equation, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{i}^{n}
+ \sum_{j=1}^{I}(\beta_{j} - \alpha_{j})\mathbf{K}^{(j)}
\quad \text{or} \quad
\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{i+1}^{n}
- \sum_{j=I+1}^{m}(\beta_{j} - \alpha_{j})\mathbf{K}^{(j)}
\end{align}\]</div>
<p>Recall that the jump across wave <span class="math notranslate nohighlight">\(j\)</span> with eigenvalue <span class="math notranslate nohighlight">\(\lambda_{j}\)</span> and eigenvector <span class="math notranslate nohighlight">\(\mathbf{K}^{(j)}\)</span> is given by <span class="math notranslate nohighlight">\((\beta_{j} - \alpha_{j})\mathbf{K}^{(j)}\)</span> . Note that the solution of the Riemann problem, at <span class="math notranslate nohighlight">\(x/t=0\)</span> , as given by <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{i}^{n} + \sum_{j=1}^{I}(\beta_{j} - \alpha_{j})\mathbf{K}^{(j)}\)</span> , can be interpreted as being the left data state <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n}\)</span> plus all wave jumps across waves of negative or zero speed. Similarly, the form <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{i+1}^{n} - \sum_{j=I+1}^{m}(\beta_{j} - \alpha_{j})\mathbf{K}^{(j)}\)</span> gives the solution as the right data state <span class="math notranslate nohighlight">\(\mathbf{U}_{i+1}^{n}\)</span> minus the wave jumps across all waves of positive or zero speeds. By combining the above two equation we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i+\frac{1}{2}}(0)
= \frac{1}{2}(\mathbf{U}_{i}^{n} + \mathbf{U}_{i+1}^{n})
- \frac{1}{2}\sum_{j=1}^{m}\operatorname{sign}(\lambda_{j})(\beta_{j} - \alpha_{j}) \mathbf{K}^{(j)}
\end{align}\]</div>
<p>The Godunov intercell numerical flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}\big(\mathbf{U}_{i+\frac{1}{2}}(0)\big)\)</span> can now be obtained by  evaluating <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> at any of the three expressions above for the solution of the Riemann problem. Use of <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{i}^{n} + \sum_{j=1}^{I}(\beta_{j} - \alpha_{j})\mathbf{K}^{(j)}\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{i}^{n} + \sum_{j=1}^{I} \mathbf{A}(\beta_{j} - \alpha_{j})\mathbf{K}^{(j)}
\end{align}\]</div>
<p>and since <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{K}^{(j)} = \lambda_{j}\mathbf{K}^{(j)}\)</span> , we get</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{i}^{n} + \sum_{j=1}^{I} (\beta_{j} - \alpha_{j})\lambda_{j}\mathbf{K}^{(j)}
\end{align}\]</div>
<p>Similarly, the second expression gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{i+1}^{n} - \sum_{j=I+1}^{m}(\beta_{j}-\alpha_{j})\lambda_{j}\mathbf{K}^{(j)}
\end{align}\]</div>
<p>or combining the above two results we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}}
= \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n})
- \frac{1}{2}\sum_{j=1}^{m}(\beta_{j} - \alpha_{j}) |\lambda_{j}| \mathbf{K}^{(j)}
\end{align}\]</div>
<p>Now we show that the Godunov flux can also be expressed in two more alternative forms. Starting from the above equation we can get</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}_{i+\frac{1}{2}} &amp;= \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n}) - \frac{1}{2}\sum_{j=1}^{m}(\beta_{j}-\alpha_{j})(\lambda_{j}^{+} - \lambda_{j}^{-})\mathbf{K}^{(j)} \\
&amp;= \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n}) - \frac{1}{2}\sum_{j=1}^{m}(\beta_{j}-\alpha_{j}) \Big[ \lambda_{j}^{+}\mathbf{K}^{(j)} - \lambda_{j}^{-}\mathbf{K}^{(j)} \Big] \\
&amp;= \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n}) - \frac{1}{2}\sum_{j=1}^{m}(\beta_{j}-\alpha_{j}) \Big[ \mathbf{A}^{+}\mathbf{K}^{(j)} - \mathbf{A}^{-}\mathbf{K}^{(j)} \Big] \\
&amp;= \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n}) - \frac{1}{2}\sum_{j=1}^{m}(\beta_{j}-\alpha_{j}) (\mathbf{A}^{+} - \mathbf{A}^{-}) \mathbf{K}^{(j)} \\
&amp;= \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n}) - \frac{1}{2}|\mathbf{A}| \sum_{j=1}^{m} (\beta_{j}-\alpha_{j}) \mathbf{K}^{(j)}
\end{align}\end{split}\]</div>
<p>Hence we get another form of the Godunov flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n}) - \frac{1}{2}|\mathbf{A}| (\mathbf{U}_{i+1}^{n} - \mathbf{U}_{i}^{n})
\end{align}\]</div>
<p>Another Godunov flux in flux-split form follows directly from manupulating the above result and using appropriate definitions. Alternatively we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}_{i+\frac{1}{2}} &amp;= \mathbf{A}\mathbf{U}_{i+\frac{1}{2}}(0)
= \sum_{j=1}^{I} \beta_{j}\mathbf{A}\mathbf{K}^{(j)} + \sum_{j=I+1}^{m}\alpha_{j}\mathbf{A}\mathbf{K}^{(j)} \\
&amp;= \sum_{j=1}^{I} \beta_{j}\lambda_{j}\mathbf{K}^{(j)} + \sum_{j=I+1}^{m}\alpha_{j}\lambda_{j}\mathbf{K}^{(j)}
= \sum_{j=1}^{m}\beta_{j}\lambda_{j}^{-}\mathbf{K}^{(j)} + \sum_{j=1}^{m}\alpha_{j}\lambda_{j}^{+}\mathbf{K}^{(j)} \\
&amp;= \sum_{j=1}^{m}\beta_{j}\mathbf{A}^{-}\mathbf{K}^{(j)} + \sum_{j=1}^{m} \alpha_{j}\mathbf{A}^{+}\mathbf{K}^{(j)}
= \mathbf{A}^{+} \sum_{j=1}^{m}\alpha_{j}\mathbf{K}^{(j)} + \mathbf{A}^{-}\sum_{j=1}^{m}\beta_{i}\mathbf{K}^{(j)} \\
&amp;= \mathbf{A}^{+} \mathbf{U}_{i}^{n} + \mathbf{A}^{-}\mathbf{U}_{i+1}^{n}
\end{align}\end{split}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>The intercell flux has been split as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{i+\frac{1}{2}}^{+} + \mathbf{F}_{i+\frac{1}{2}}^{-}
\end{align}\]</div>
<p>where the positive <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}^{+}\)</span> and negative <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}^{-}\)</span> flux components are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}}^{+} = \mathbf{A}^{+}\mathbf{U}_{i}^{n}
,\quad
\mathbf{F}_{i+\frac{1}{2}}^{-} = \mathbf{A}^{-}\mathbf{U}_{i}^{n}
\end{align}\]</div>
<p class="last">Note that, trivially, the respective Jacobian matrices have eigenvalues that are all positive (or zero) and all negative (or zero).</p>
</div>
</div>
</div>
</div>
<div class="section" id="the-method-of-godunov-for-non-linear-systems">
<h2>The Method of Godunov for Non-linear Systems<a class="headerlink" href="#the-method-of-godunov-for-non-linear-systems" title="永久链接至标题">¶</a></h2>
<div class="section" id="bases-of-godunov-s-method">
<h3>Bases of Godunov’s Method<a class="headerlink" href="#bases-of-godunov-s-method" title="永久链接至标题">¶</a></h3>
<p>Consider the general Initial-Boundary Value Problem(IBVP) for non-linear systems of hyperbolic conservation laws</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = 0 \\
&amp; \mathbf{U}(x,0) = \mathbf{U}^{(0)}(x) \\
&amp; \mathbf{U}(0,t) = \mathbf{U}_{l}(t) , \quad \mathbf{U}(L,t) = \mathbf{U}_{r}(t)
\end{align}\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{U}(x,t)\)</span> is the vector of conserved variables; <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> is the vector of fluxes; <span class="math notranslate nohighlight">\(\mathbf{U}^{(0)}(x)\)</span> is the initial data at time <span class="math notranslate nohighlight">\(t=0\)</span> ; <span class="math notranslate nohighlight">\([0,L]\)</span> is the spatial domain and boundary conditions are, for the moment, assumed to be represented by the boundary functions <span class="math notranslate nohighlight">\(\mathbf{U}_{l}(t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{r}(t)\)</span> . We make the assumption that the solution of the IVBP does exist.</p>
<p>In order to admit discontinuous solutions we must use one of the integral forms of the conservation laws. Here we adopt</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{x_{1}}^{x_{2}} \mathbf{U}(x,t_{2})\mathrm{d}x
= \int_{x_{1}}^{x_{2}} \mathbf{U}(x,t_{1})\mathrm{d}x
+ \int_{t_{1}}^{t_{2}} \mathbf{F}\big(\mathbf{U}(x_{1},t)\big)\mathrm{d}t
- \int_{t_{1}}^{t_{2}} \mathbf{F}\big(\mathbf{U}(x_{2},t)\big)\mathrm{d}t
\end{align}\]</div>
<p>for any control volume <span class="math notranslate nohighlight">\([x_{1},x_{2}] \times [t_{1},t_{2}]\)</span> in the domain of interest. We discretise the spatial domain <span class="math notranslate nohighlight">\([0,L]\)</span> into <span class="math notranslate nohighlight">\(M\)</span> computing cells or finite volumes <span class="math notranslate nohighlight">\(I_{i} = [x_{i-\frac{1}{2}}, x_{i+\frac{1}{2}}]\)</span> of regular size <span class="math notranslate nohighlight">\(\Delta x = x_{i+\frac{1}{2}} - x_{i-\frac{1}{2}} = L/M\)</span> , with <span class="math notranslate nohighlight">\(i = 1,\cdots,M\)</span> . For a given cell <span class="math notranslate nohighlight">\(I_{i}\)</span> the location of the cell center <span class="math notranslate nohighlight">\(x_{i}\)</span> and the cell boundaries <span class="math notranslate nohighlight">\(x_{i-\frac{1}{2}}, x_{i+\frac{1}{2}}\)</span> are given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
x_{i-\frac{1}{2}} = (i-1)\Delta x
,\quad
x_{i} = (i-\frac{1}{2})\Delta x
,\quad
x_{i+\frac{1}{2}} = i\Delta x
\end{align}\]</div>
<p>We denote the temporal domain by <span class="math notranslate nohighlight">\([0,T]\)</span> , where <span class="math notranslate nohighlight">\(T\)</span> is some output time, not a boundary. The discretisation of the time interval <span class="math notranslate nohighlight">\([0,T]\)</span> is generally done in time steps <span class="math notranslate nohighlight">\(\Delta t\)</span> of variable size; recall that of non-linear systems wave speeds vary in space and time, and thus the choice of <span class="math notranslate nohighlight">\(\Delta t\)</span> is carried out as marching in time proceeds. Given general initial data <span class="math notranslate nohighlight">\(\tilde{\mathbf{U}}(x,t^{n})\)</span> for the conservation laws at time <span class="math notranslate nohighlight">\(t=t^{n}\)</span> say, in order to evolve the solution to a time <span class="math notranslate nohighlight">\(t^{n+1} = t^{n} + \Delta t\)</span> , the Godunov method first assumes a piece-wise constant distribution of the data. Formally, this is realised by defining cell averages.</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n} = \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{\mathbf{U}}(x,t^{n})~\mathrm{d}x
\end{align}\]</div>
<p>which produces the desired piecewise constant distribution <span class="math notranslate nohighlight">\(\mathbf{U}(x,t^{n})\)</span> , with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}(x,t^{n}) = \mathbf{U}_{i}^{n} ,\quad \text{for}~x~\text{in each cell}~I_{i} = [x_{i-\frac{1}{2}}, x_{i+\frac{1}{2}}]
\end{align}\]</div>
<p>Data now consists of a set <span class="math notranslate nohighlight">\(\{ \mathbf{U}_{i}^{n} \}\)</span> of constant states. Naturally these are in terms of conserved variables, but other variables may be derived to proceed with the implementation of numerical methods. In particular, for the Godunov method we use the solution of the Riemann problem in terms of primitive variables, which for the Euler equation are <span class="math notranslate nohighlight">\(\mathbf{W} = (\rho, u, p)^{T}\)</span> ; <span class="math notranslate nohighlight">\(\rho\)</span> is density, <span class="math notranslate nohighlight">\(u\)</span> is velocity and <span class="math notranslate nohighlight">\(p\)</span> is pressure.</p>
<p>Once the piece-wise constant distribution of data has been established, the next step in the Godunov method is to solve the Initial Value Problem(IVP) for the original conservation laws but with the modified initial data <span class="math notranslate nohighlight">\(\mathbf{U}(x,t^{n}) = \mathbf{U}_{i}^{n}\)</span> . Effectively, this generates local Riemann problems <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> with data <span class="math notranslate nohighlight">\(\mathbf{U}_{i}\)</span> (left side) and <span class="math notranslate nohighlight">\(\mathbf{U}_{n+1}^{n}\)</span> (right side), centred at the intercell boundary position <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> . The solution of <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> is a similarity solution and depends on the ratio <span class="math notranslate nohighlight">\(\bar{x}/\bar{t}\)</span> , and the data states <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n},\mathbf{U}_{i+1}^{n}\)</span> ; the solution is denoted by <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(\bar{x}/\bar{t})\)</span> , where <span class="math notranslate nohighlight">\((\bar{x}, \bar{t})\)</span> are the local coordinates for the local Riemann problem. Fig.6.2 shows typical wave patterns emerging from intercell boundaries <span class="math notranslate nohighlight">\(x_{i-\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> when solving the two Riemann problems <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i-1}^{n}, \mathbf{U}_{i}^{n})\)</span> and <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> . For a time step <span class="math notranslate nohighlight">\(\Delta t\)</span> that is sufficiently small, to avoid wave interaction, one can define a global solution <span class="math notranslate nohighlight">\(\tilde{\mathbf{U}}(x,t)\)</span> in the strip <span class="math notranslate nohighlight">\(0 \le x \le L\)</span> ， <span class="math notranslate nohighlight">\(t^{n} \le t \le t^{n+1}\)</span> in terms of the local solutions as follows</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\mathbf{U}}(x,t) = \mathbf{U}_{i+\frac{1}{2}}(\bar{x}/\bar{t}) , \quad x\in [x_{i}, x_{i+1}]
\end{align}\]</div>
<p>where the correspondence between the global <span class="math notranslate nohighlight">\((x,t)\)</span> and local <span class="math notranslate nohighlight">\((\bar{x}, \bar{t})\)</span> coordinates is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \bar{x} = x - x_{i+\frac{1}{2}} ,\quad \bar{t} = t - t^{n} \\
&amp; x \in [x_{i}, x_{i+1}] ,\quad t \in [t^{n}, t^{n+1}] \\
&amp; \bar{x} \in [-\frac{\Delta x}{2}, \frac{\Delta x}{2}] ,\quad \bar{t} \in [0, \Delta t]
\end{align}\end{split}\]</div>
<p>Having found a solution <span class="math notranslate nohighlight">\(\tilde{U}(x,t)\)</span> in terms of solutions <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(\bar{x}/\bar{t})\)</span> to local Riemann problems, the Godunov method advances the solution to a time <span class="math notranslate nohighlight">\(t^{n+1} = t^{n} + \Delta t\)</span> by defining a new set of average values <span class="math notranslate nohighlight">\(\{ \mathbf{U}_{i}^{n+1} \}\)</span> , in a way to be described. We shall often use <span class="math notranslate nohighlight">\((x,t)\)</span> to mean the local frame of reference <span class="math notranslate nohighlight">\((\bar{x}, \bar{t})\)</span> .</p>
</div>
<div class="section" id="the-godunov-scheme">
<h3>The Godunov Scheme<a class="headerlink" href="#the-godunov-scheme" title="永久链接至标题">¶</a></h3>
<p>The first version of Godunov’s method defines new average values <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n+1}\)</span> at time <span class="math notranslate nohighlight">\(t^{n+1} = t^{n} + \Delta t\)</span> via the integrals</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{\mathbf{U}}(x,t^{n+1})\mathrm{d}x
\end{align}\]</div>
<p>within each cell <span class="math notranslate nohighlight">\(I_{i} = [x_{i-\frac{1}{2}}, x_{i+\frac{1}{2}}]\)</span> .</p>
<p>Note first that in order to perform the averaging, we need to make the assumption that no wave interaction takes place within cell <span class="math notranslate nohighlight">\(I_{i}\)</span> , in the chosen time <span class="math notranslate nohighlight">\(\Delta t\)</span> . This is satisfied by impoing the following restriction on the size of <span class="math notranslate nohighlight">\(\Delta t\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t \le \frac{\frac{1}{2}\Delta x}{S_{\max}^{n}}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> denotes the maximum wave velocity present throughout the domain at time <span class="math notranslate nohighlight">\(t^{n}\)</span> . A consequence of this restriction is that only two Riemann problem solutions affect cell <span class="math notranslate nohighlight">\(I_{i}\)</span> , namely the right travelling waves of <span class="math notranslate nohighlight">\(\mathbf{U}_{i-\frac{1}{2}}(x/t)\)</span> and the left travelling waves of <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> . Thus <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n+1}\)</span> can be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1}
= \frac{1}{\Delta x} \int_{0}^{\frac{1}{2}\Delta x} \mathbf{U}_{i-\frac{1}{2}}\big(\frac{x}{\Delta t}\big)\mathrm{d}x
+ \frac{1}{\Delta x} \int_{-\frac{1}{2}\Delta x}^{0} \mathbf{U}_{i+\frac{1}{2}}\big(\frac{x}{\Delta t}\big)\mathrm{d}x
\end{align}\]</div>
<p>This version of Godunov’s method can obviously be implemented as a practical computational scheme. We note however that it has two main drawbacks. First, the CFL-like condition is computationally somewhat restrictive on <span class="math notranslate nohighlight">\(\Delta t\)</span> . Second, the evaluation of the integrals in the above equation, although possible, could be involved. Rarefaction waves are bound to add to the complexity of the scheme. The second version of Godunov’s method is more attractive and is given by the following statement.</p>
<p>We will show that the Godunov method can be written in conservative form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1}
= \mathbf{U}_{i}^{n}
+ \frac{\Delta t}{\Delta x}\Big( \mathbf{F}_{i-\frac{1}{2}} - \mathbf{F}_{i+\frac{1}{2}} \Big)
\end{align}\]</div>
<p>with intercell numerical flux given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}\big(\mathbf{U}_{i+\frac{1}{2}}(0)\big)
\end{align}\]</div>
<p>if the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> satisfies the condition</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t \le \frac{\Delta x}{S_{\max}^{n}}
\end{align}\]</div>
<p>To prove it, we should realize that the integrand <span class="math notranslate nohighlight">\(\tilde{\mathbf{U}}(x,t)\)</span> is an exact solution of the conservation laws. We can therefore apply the integral form of the conservation laws to any control volume <span class="math notranslate nohighlight">\([x_{1}, x_{2}] \times [t_{1}, t_{2}]\)</span> . In particular, we can apply it to the case in which <span class="math notranslate nohighlight">\(x_{1} = x_{i-\frac{1}{2}}\)</span> ， <span class="math notranslate nohighlight">\(x_{2} = x_{i+\frac{1}{2}}\)</span> ， <span class="math notranslate nohighlight">\(t_{1} = t^{n}\)</span> ， <span class="math notranslate nohighlight">\(t_{2} = t^{n+1}\)</span> . From <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n} = \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{\mathbf{U}}(x,t^{n})\mathrm{d}x\)</span> we then have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{\mathbf{U}}(x,t^{n+1})~\mathrm{d}x
= \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{\mathbf{U}}(x,t^{n})~\mathrm{d}x
+ \int_{0}^{\Delta t} \mathbf{F}[\tilde{\mathbf{U}}(x_{i-\frac{1}{2}},t)]~\mathrm{d}t
- \int_{0}^{\Delta t} \mathbf{F}[\tilde{\mathbf{U}}(x_{i+\frac{1}{2}},t)]~\mathrm{d}t
\end{align}\]</div>
<p>In terms of local solutions, and assuming condition <span class="math notranslate nohighlight">\(\Delta t \le \Delta x / S_{\max}^{n}\)</span> , we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \tilde{\mathbf{U}}(x_{i-\frac{1}{2}},t) = \mathbf{U}_{i-\frac{1}{2}}(0) = \text{constant} \\
&amp; \tilde{\mathbf{U}}(x_{i+\frac{1}{2}},t) = \mathbf{U}_{i+\frac{1}{2}}(0) = \text{constant}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0)\)</span> is the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> along the ray <span class="math notranslate nohighlight">\(x/t=0\)</span> , which is the t-axis in the local frame. Similarly, <span class="math notranslate nohighlight">\(\mathbf{U}_{i-\frac{1}{2}}(0)\)</span> is the solution of <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i-1}^{n}, \mathbf{U}_{i}^{n})\)</span> along the t-axis. Division of the above equation we got through by <span class="math notranslate nohighlight">\(\Delta x\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{\mathbf{U}}(x,t^{n+1})\mathrm{d}x
= \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{\mathbf{U}}(x,t^{n})\mathrm{d}x
+ \frac{\Delta t}{\Delta x} \Big[ \mathbf{F}\big( \mathbf{U}_{i-\frac{1}{2}}(0) \big) - \mathbf{F}\big( \mathbf{U}_{i+\frac{1}{2}}(0) \big) \Big]
\end{align}\]</div>
<p>which by virtue of <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n} = \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \tilde{\mathbf{U}}(x,t^{n})~\mathrm{d}x\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{U}}(x_{i-\frac{1}{2}},t) = \mathbf{U}_{i-\frac{1}{2}}(0) = \text{constant}\)</span> ， <span class="math notranslate nohighlight">\(\tilde{\mathbf{U}}(x_{i+\frac{1}{2}},t) = \mathbf{U}_{i+\frac{1}{2}}(0) = \text{constant}\)</span> leads to the desired result what we want, and thus the proposition has been proved.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<ul class="last simple">
<li>The CFL condition <span class="math notranslate nohighlight">\(\Delta t \le \Delta x / S_{\max}^{n}\)</span> for the second version of the Godunov method is more generous than  <span class="math notranslate nohighlight">\(\Delta t \le \frac{1}{2}\Delta x / S_{\max}^{n}\)</span> , thus allowing a larger time step. This in turn results in a more efficient time-marching scheme. Here a wave is allowed to travel, at most, a complete cell length <span class="math notranslate nohighlight">\(\Delta x\)</span> in a time <span class="math notranslate nohighlight">\(\Delta t\)</span> .</li>
<li>Condition <span class="math notranslate nohighlight">\(\Delta t \le \Delta x / S_{\max}^{n}\)</span> remians valid even if wave interaction takes place intime <span class="math notranslate nohighlight">\(\Delta t\)</span> within cell <span class="math notranslate nohighlight">\(I_{i}\)</span> , under the assumption that no wave acceleration takes place as a consequence of wave interaction; this is a kind of linearity assumption. Condition <span class="math notranslate nohighlight">\(\Delta t \le \Delta x / S_{\max}^{n}\)</span> is necessary in the result equation when computing the fluxes along the left and right intercell boundaries.</li>
<li>The second version of the Godunov method is the on that is used for practical computations.</li>
</ul>
</div>
</div>
<div class="section" id="godunov-s-method-for-the-euler-equations">
<h3>Godunov’s Method for the Euler Equations<a class="headerlink" href="#godunov-s-method-for-the-euler-equations" title="永久链接至标题">¶</a></h3>
<p>Here we describe Godunov’s method for the specific case of the time-dependent, one-dimensional Euler equations. As data <span class="math notranslate nohighlight">\(\{ \mathbf{U}_{i}^{n} \}\)</span> at time level <span class="math notranslate nohighlight">\(n\)</span> is assumed, in order to march the solution to time level <span class="math notranslate nohighlight">\(n+1\)</span> via the conservative formular, we need to compute the intercell fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{i-\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> .</p>
<div class="section" id="evaluation-of-the-intercell-fluxes">
<h4>Evaluation of the Intercell Fluxes<a class="headerlink" href="#evaluation-of-the-intercell-fluxes" title="永久链接至标题">¶</a></h4>
<p>For a generic cell interface at <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> we compute the Godunov flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> according to <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}\big( \mathbf{U}_{i+\frac{1}{2}}(0) \big)\)</span> . We therefore require the solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> of the Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> evaluated at the point <span class="math notranslate nohighlight">\(S = x/t = 0\)</span> .</p>
<p>The complete exact solution to a general Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> for the Euler equations requires the identification of ten possible wave patterns. Before we considered the five sub-cases arising from the case in which the sampling point <span class="math notranslate nohighlight">\(S\)</span> lies to the left of the contact discontinuity. There is an analogous flow chart for the five sub-cases arising from the case in which the sampling point <span class="math notranslate nohighlight">\(S\)</span> lies to the right of the contact discontinuity. For the Godunov method the sampling is performed for the special value <span class="math notranslate nohighlight">\(S = x/t = 0\)</span> . Unfortunately, this does not simplify the sampling procedure and all ten possible wave patterns must be taken into account. Recall that in our convention a shock is a single thick ray, a contact is a dashed line and a rarefaction wave is obviously a fan. A wave of unknown character is represented by a pair of rays emanating from the origin. There are two situations, each of which has five cases, namely:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(0 \le u_{*}\)</span> (positive particle speed in the Star Region)</li>
<li><span class="math notranslate nohighlight">\(0 \ge u_{*}\)</span> (negative particle speed in the Star Region)</li>
</ul>
<p>The sampled value <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(0)\)</span> needed for evaluating the Godunov flux is given below for all ten possible wave patterns. Consider for example the situation in which <span class="math notranslate nohighlight">\(u_{*}\)</span> is positive. In order to compute correctly the value <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(0)\)</span> along the t-axis (left of contact) we must identify the character of the left wave. This can be a shock or a rarefaction. If the left wave is a shock wave, we compute the state <span class="math notranslate nohighlight">\(\mathbf{W}_{*L}\)</span> between the left shock and the contact using shock relations. Then the speed <span class="math notranslate nohighlight">\(S_{L}\)</span> of the left shock is computed. This then allows us to test whether the shock speed is positive (supersonic flow) or negative (subsonic flow). If <span class="math notranslate nohighlight">\(S_{L} \ge 0\)</span> then</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{W}_{i+\frac{1}{2}}(0) = \mathbf{W}_{L}
\end{align}\]</div>
<p>If <span class="math notranslate nohighlight">\(S_{L} \le 0\)</span> then</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{W}_{i+\frac{1}{2}}(0) = \mathbf{W}_{*L}
\end{align}\]</div>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="44%" />
<col width="44%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sub-case</th>
<th class="head">Case(a): positive speed <span class="math notranslate nohighlight">\(u_{*}\)</span></th>
<th class="head">Case(b): negative speed <span class="math notranslate nohighlight">\(u_{*}\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{L}\)</span></td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{R}\)</span></td>
</tr>
<tr class="row-odd"><td>2</td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{*L}\)</span></td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{*R}\)</span></td>
</tr>
<tr class="row-even"><td>3</td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{L}\)</span></td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{R}\)</span></td>
</tr>
<tr class="row-odd"><td>4</td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{*L}\)</span></td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{*R}\)</span></td>
</tr>
<tr class="row-even"><td>5</td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{Lfan}\)</span></td>
<td><span class="math notranslate nohighlight">\(\mathbf{W}_{Rfan}\)</span></td>
</tr>
</tbody>
</table>
<p>Havign identified the desired value <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(0)\)</span> , the intercell becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}\big( \mathbf{W}_{i+\frac{1}{2}}(0) \big)
\end{align}\]</div>
</div>
<div class="section" id="time-step-size">
<h4>Time Step Size<a class="headerlink" href="#time-step-size" title="永久链接至标题">¶</a></h4>
<p>So far we know how to compute the intercell flux to be used in the conservative formula. The spatial discretisation length <span class="math notranslate nohighlight">\(\Delta x\)</span> is chosen on desired accuracy or available computing resources. What remains to be determined in the conservative formula is the size of the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> . This is based on the condition <span class="math notranslate nohighlight">\(\Delta t \le \Delta x / S_{\max}^{n}\)</span> . The time step is then given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t = \frac{C_{cfl}\Delta x}{S_{\max}^{n}}
\end{align}\]</div>
<p>Here <span class="math notranslate nohighlight">\(C_{cfl}\)</span> is a Courant or CFL coefficient satisfying</p>
<div class="math notranslate nohighlight">
\[\begin{align}
0 &lt; C_{cfl} &lt; 1
\end{align}\]</div>
<p>The closer the coefficient <span class="math notranslate nohighlight">\(C_{cfl}\)</span> is to <span class="math notranslate nohighlight">\(1\)</span> , the more efficient the time marching scheme is. <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> is the largest wave speed present through out the domain at time level <span class="math notranslate nohighlight">\(n\)</span> . This means that no wave present in the solution of all Riemann problems travels more than a distance <span class="math notranslate nohighlight">\(\Delta x\)</span> in time <span class="math notranslate nohighlight">\(\Delta t\)</span> . As discussed before in the context of simple problems, there are various ways of estimating <span class="math notranslate nohighlight">\(\mathbf{S}_{\max}^{n}\)</span> . For the time-dependent, one dimensional Euler equations a reliable choice is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{\max}^{n} = \max_{i} \Big\{ |S_{i+\frac{1}{2}}^{L}| , |S_{i+\frac{1}{2}}^{R}| \Big\}
\end{align}\]</div>
<p>for <span class="math notranslate nohighlight">\(i = 0,\cdots,M\)</span> , where <span class="math notranslate nohighlight">\(S_{i+\frac{1}{2}}^{L},S_{i+\frac{1}{2}}^{R}\)</span> are the wave speeds of the left and right non-linear waves present in the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> . Recall that this Riemann problem generates three waves; the fastest are the non-linear waves, which can be shocks or rarefactions. For rarefaction waves one selects the speed of the head. For shock waves one selects the shock speed, naturally.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Note that in sampling the wave speeds one must include the boundaries, as these might generate large wave speeds.</p>
</div>
<p>Using <span class="math notranslate nohighlight">\(S_{\max}^{n} = \max_{i} \Big\{ |S_{i+\frac{1}{2}}^{L}| , |S_{i+\frac{1}{2}}^{R}| \Big\}\)</span> to find <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> and thus <span class="math notranslate nohighlight">\(\Delta t\)</span> according to <span class="math notranslate nohighlight">\(C_{cfl}\Delta x / S_{\max}^{n}\)</span> , is a simple and very reliable procedure. As the local solutions of Riemann problems are available for flux evaluation, it is just a question of using this information to find <span class="math notranslate nohighlight">\(\Delta t\)</span> as well.</p>
<div class="admonition attention">
<p class="first admonition-title">注意</p>
<p class="last">For multi-dimensional problems however, this scheme for estimating the maximum wave speed is unsuitable.</p>
</div>
<p>A popular alternative for estimating <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> , whick extends to multi-dimensional problems, is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{\max}^{n} = \max_{i}\Big\{ |u_{i}^{n}| + a_{i}^{n} \Big\}
\end{align}\]</div>
<p>Only data values for the particle velocity <span class="math notranslate nohighlight">\(u_{i}^{n}\)</span> and sound speed <span class="math notranslate nohighlight">\(a_{i}^{n}\)</span> are used here. It is not difficult to see however that the above equation can lead to an underestimate of <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> . For instance, assume shock-tube data in which the flow is stationary at time <span class="math notranslate nohighlight">\(t=0\)</span> . Then <span class="math notranslate nohighlight">\(u_{i}^{n}=0\)</span> and the sound speed is the only contribution to <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> . Underestimating <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> results in a choice of <span class="math notranslate nohighlight">\(\Delta t\)</span> that is too large and instabilities may be developed from the beginning of the computations. A possible way of remedying this, is by choosing the CFL coefficient <span class="math notranslate nohighlight">\(C_{cfl}\)</span> cautiously. If <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> is known reliably then the choice <span class="math notranslate nohighlight">\(C_{cfl}=1\)</span> is probably adequate, although this implies that waves pass through each other without acceleration, which is a kind of linearity assumption. A practical choice is <span class="math notranslate nohighlight">\(C_{cfl} = 0.9\)</span> . If there are uncertainties in the estimate for <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> , a more conservative choice for <span class="math notranslate nohighlight">\(C_{cfl}\)</span> is advised. In spite of the alluded disadvantages of choice <span class="math notranslate nohighlight">\(S_{\max}^{n} = \max_{i}\Big\{ |u_{i}^{n}| + a_{i}^{n} \Big\}\)</span> , it provides a practical approach when computing solutions to multi-dimensional problems.</p>
</div>
<div class="section" id="id37">
<h4>Boundary Conditions<a class="headerlink" href="#id37" title="永久链接至标题">¶</a></h4>
<p>For a domain <span class="math notranslate nohighlight">\([0,L]\)</span> discretised into <span class="math notranslate nohighlight">\(M\)</span> computing cells of length <span class="math notranslate nohighlight">\(\Delta x\)</span> , we need boundary conditions at the boundaries <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=L\)</span> . Numerically, such boundary conditions are expected to provide numerical fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{M+\frac{1}{2}}\)</span> . These are required in order to apply the conservative formular to update the extreme cells <span class="math notranslate nohighlight">\(I_{1}\)</span> and <span class="math notranslate nohighlight">\(I_{M}\)</span> to the next time level <span class="math notranslate nohighlight">\(n+1\)</span> . The boundary conditions may result in direct prescription of <span class="math notranslate nohighlight">\(\mathbf{F}_{\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{M+\frac{1}{2}}\)</span> . Alternatively, we may prescribe fictitous data values in the fictitous cell <span class="math notranslate nohighlight">\(I_{0}\)</span> and <span class="math notranslate nohighlight">\(I_{M+1}\)</span> , adjacent to <span class="math notranslate nohighlight">\(I_{1}\)</span> and <span class="math notranslate nohighlight">\(I_{M}\)</span> respectively. In this way, boundary Riemann problems <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{0}^{n}, \mathbf{U}_{1}^{n})\)</span> and <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{M}^{n}, \mathbf{U}_{M+1}^{n})\)</span> are solved and the corresponding Godunov fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{M+\frac{1}{2}}\)</span> are computed, as done for the interior cells. The imposition of boundary conditions is, fundamentally, a physical problem. Great care is required in their numerical implementation. For the Godunov method this tasts to be facilitated by the fact that local Riemann problem solutions are used. Here we consider only two types of boundaries: reflective and transparent or transmissive.</p>
<div class="section" id="reflective-boundaries">
<h5>Reflective Boundaries<a class="headerlink" href="#reflective-boundaries" title="永久链接至标题">¶</a></h5>
<p>Consider the boundary at <span class="math notranslate nohighlight">\(x=L\)</span> and suppose it physically consists of a fixed, reflective impermeable wall. Then the physical situation is correcly modelled by creating a fictitious state <span class="math notranslate nohighlight">\(\mathbf{W}_{M+1}^{n}\)</span> on the right hand side of the boundary and defining the boundary Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{W}_{M}^{n}, \mathbf{W}_{M+1}^{n})\)</span> . The fictitious state <span class="math notranslate nohighlight">\(\mathbf{W}_{M+1}^{n}\)</span> is defined from the known state <span class="math notranslate nohighlight">\(\mathbf{W}_{M}^{n}\)</span> inside the computational domain, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{M+1}^{n} = \rho_{M}^{n}
,\quad
u_{M+1}^{n} = - u_{M}^{n}
,\quad
p_{M+1}^{n} = p_{M}^{n}
\end{align}\]</div>
<p>The exact solution of this boundary Riemann problem consists of either (1) two shock waves if <span class="math notranslate nohighlight">\(u_{M}^{n} &gt; 0\)</span> or (2) two rarefaction waves if <span class="math notranslate nohighlight">\(u_{M}^{n} \le 0\)</span> . In both cases <span class="math notranslate nohighlight">\(u_{*} = 0\)</span> along the boundary; this is the desired condition at the solid, fixed impermeable boundary. Consequently, the only non-zero contribution to the flux vector at the boundary is in the momentum component and is due to the pressure <span class="math notranslate nohighlight">\(p_{*}\)</span> corresponding to <span class="math notranslate nohighlight">\(u_{*} = 0\)</span> . In both cases the solution can be obtained in closed form, no iteration is required. As a matter of fact, a closed-form solution exists for the more general case in which the fluid under consideration obeys the covolume equation of state and the impermeable wall moves with a prescribed speed <span class="math notranslate nohighlight">\(u_{wall}\)</span> . The boundary conditions are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{M+1}^{n} = \rho_{M}^{n}
,\quad
u_{M+1}^{n} = - u_{M}^{n} + 2 u_{wall}
,\quad
p_{M+1}^{n} = p_{M}^{n}
\end{align}\]</div>
<p>The exact solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{W}_{M}^{n}, \mathbf{W}_{M+1}^{n})\)</span> containing a moving boundary is symmetric about the path of the moving wall and consists of either two shocks or two rarefactions, with the contact wave coinciding with the moving wall.</p>
<p>We now find the exact solution for <span class="math notranslate nohighlight">\(p_{*}\)</span> and <span class="math notranslate nohighlight">\(u_{*}\)</span> in the moving-wall Riemann problem. From the analysis of the exact function for pressure, it is seen that if <span class="math notranslate nohighlight">\(\Delta u = -2(u_{M} - u_{wall}) = 0\)</span> , that is <span class="math notranslate nohighlight">\(u_{M} = u_{wall}\)</span> , then the solution <span class="math notranslate nohighlight">\(p_{*}\)</span> for pressure at the boundary is <span class="math notranslate nohighlight">\(p_{*} = p_{M} = p_{M+1}\)</span> . For <span class="math notranslate nohighlight">\(\Delta u &gt; 0\)</span> we have <span class="math notranslate nohighlight">\(p_{*} &lt; p_{M} = p_{M+1}\)</span> , that is, the solution consists of two rarefaction waves. For <span class="math notranslate nohighlight">\(\Delta u &lt; 0\)</span> we have <span class="math notranslate nohighlight">\(p_{*} &gt; p_{M} = p_{M+1}\)</span> and the solution consists of two shocks. For the case of two rarefaction waves, <span class="math notranslate nohighlight">\(u_{M} &lt; u_{wall}\)</span> , direct utilisation of the data in the pressure function <span class="math notranslate nohighlight">\(f(p)=0\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{*} = p_{M} \bigg[ 1 + \frac{1}{2}(\gamma - 1) \Big( \frac{C_{M}}{a_{M}} \Big) \bigg]^{\frac{2\gamma}{\gamma - 1}}
\end{align}\]</div>
<p>For the case of two shocks, <span class="math notranslate nohighlight">\(u_{M} &gt; u_{wall}\)</span> , we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p^{*} = p_{M} + \frac{C_{M}}{2A_{M}} \bigg\{ C_{M} + \Big[ C_{M}^{2} + 4A_{M}(B_{M} + p_{M}) \Big]^{\frac{1}{2}} \bigg\}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
A_{M} = \frac{2}{(\gamma + 1)\rho_{M}}
,\quad
B_{M} = \frac{\gamma - 1}{\gamma +1}p_{M}
,\quad
C_{M} = u_{M} - u_{wall}
\end{align}\]</div>
<p>As anticipated, the solution for the velocity <span class="math notranslate nohighlight">\(u_{*}\)</span> in both cases is found to be</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{*} = u_{wall}
\end{align}\]</div>
<p>These closd-form solutions for the pressure and velocity at the boundary (fixed or moving) can also be utilised in the Godunov method even when this is used in conjuncion with approximte Riemann solvers, particularly if these are thought to be inaccurate for boundary data Riemann problems.</p>
</div>
<div class="section" id="transmissive-boundaries">
<h5>Transmissive Boundaries<a class="headerlink" href="#transmissive-boundaries" title="永久链接至标题">¶</a></h5>
<p>Transmissive, or transparent boundaries arise from the need to define finite, or sufficiently small, computational domains. The corresponding boundary conditions are a numerical attempt to produce boundaries that allow the passage of waves without any effect on them. For one-dimensional problems the objective is reasonably well attained. For multi-dimensional problems this is a substantial area of current research, usually referred to as open-end boundary conditions, transparent boundary conditions, far-field boundary conditions, radiation boundary conditions or non-reflecting boundary conditions. For a transmissive right boundary we suggest the boundary conditions</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{M+1}^{n} = \rho_{M}^{n}
,\quad
u_{M+1}^{n} = u_{M}^{n}
,\quad
p_{M+1}^{n} = p_{M}^{n}
\end{align}\]</div>
<p>This data produces a trivial Riemann problem. No wave of finite strength is produced at the boundary that may affect the flow inside the domain.</p>
<p>For an assumed mesh of size <span class="math notranslate nohighlight">\(\Delta x\)</span> , we have defined all details for the practical implementation of the Godunov method. These are (1) intercell fluxes; (2) the maximum wave speed <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> to compute the time step size <span class="math notranslate nohighlight">\(\Delta t\)</span> ; (3) boundary conditions.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The wave speeds generated at the boundaries, after applying boundary conditions, must be taken into account when selecting the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> .</p>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="random-choice-and-related-methods">
<h2>Random Choice and Related Methods<a class="headerlink" href="#random-choice-and-related-methods" title="永久链接至标题">¶</a></h2>
<div class="section" id="rcm-on-a-non-staggered-grid">
<h3>RCM on a Non-Staggered Grid<a class="headerlink" href="#rcm-on-a-non-staggered-grid" title="永久链接至标题">¶</a></h3>
<p>We consider the general Initial Boundary Value Problem (IBVP) for non-linear systems of hyperbolic conservation laws, namely</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \mathbf{U}^{(0)}(x) \\
&amp; \mathbf{U}(0,t) = \mathbf{U}_{l}(t) ,\quad \mathbf{U}(L,t) = \mathbf{U}_{r}(t)
\end{align}\end{split}\]</div>
<p>We assume a solution to this IBVP exists. Here <span class="math notranslate nohighlight">\(\mathbf{U}(x,t)\)</span> is the vector of conserved variables, <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> is the vector of fluxes, <span class="math notranslate nohighlight">\(\mathbf{U}^{(0)}(x)\)</span> is the initial data at time <span class="math notranslate nohighlight">\(t = 0\)</span> , <span class="math notranslate nohighlight">\([0,L]\)</span> is the spatial domain and boundary conditions are, for the moment, assumed to be represented by the boundary functions <span class="math notranslate nohighlight">\(\mathbf{U}_{l}(t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{r}(t)\)</span> .</p>
<p>In the RCM the only step in which one is required to work with the vector of conserved variables is at the level of the Riemann problem, when enforcing the Rankine–Hugoniot Conditions at shocks. All other steps of the method are more conveniently performed in terms of the vector of primitive variables, which for the Euler equations are <span class="math notranslate nohighlight">\(\mathbf{W} = (\rho, u, p)^{T}\)</span> ; <span class="math notranslate nohighlight">\(\rho\)</span> is density, <span class="math notranslate nohighlight">\(u\)</span> is velocity and <span class="math notranslate nohighlight">\(p\)</span> is pressure.</p>
<div class="section" id="the-scheme-for-non-linear-systems">
<h4>The Scheme for Non-Linear Systems<a class="headerlink" href="#the-scheme-for-non-linear-systems" title="永久链接至标题">¶</a></h4>
<p>We discretise the spatial domain <span class="math notranslate nohighlight">\([0,L]\)</span> into <span class="math notranslate nohighlight">\(M\)</span> computing cells <span class="math notranslate nohighlight">\(I_{i} = [x_{i-\frac{1}{2}}, x_{i+\frac{1}{2}}]\)</span> of size <span class="math notranslate nohighlight">\(\Delta x = x_{i+\frac{1}{2}} - x_{i-\frac{1}{2}} = L/M\)</span> , with <span class="math notranslate nohighlight">\(i = 1,\cdots, M\)</span> . For a given cell <span class="math notranslate nohighlight">\(I_{i}\)</span> , the location of the cell centre <span class="math notranslate nohighlight">\(x_{i}\)</span> and the cell boundaries <span class="math notranslate nohighlight">\(x_{i-\frac{1}{2}}\)</span> , <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> are given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
x_{i-\frac{1}{2}} = (i - 1)\Delta x
,\quad
x_{i} = (i-\frac{1}{2})\Delta x
,\quad
x_{i+\frac{1}{2}} = i\Delta x
\end{align}\]</div>
<p>For convenience we choose cells of regular size <span class="math notranslate nohighlight">\(\Delta x\)</span> , but this is not a necessary requirement for implementing the RCM. Fig. 7.1 illustrates the non–staggered grid arrangement for this version of the Random Choice Method. The solution is updated at the cell centres <span class="math notranslate nohighlight">\(x_{i}\)</span> , every time step. Obviously, the time step is, in general, of different size for every time step. Given general initial data <span class="math notranslate nohighlight">\(\mathbf{W}(x,t^{n})\)</span> at time <span class="math notranslate nohighlight">\(t = t^{n}\)</span> say, in order to evolve the solution to a time <span class="math notranslate nohighlight">\(t^{n+1} = t^{n} + \Delta t\)</span> , the Random Choice Method first assumes a piecewise constant distribution of the data. Formally, this may be realised by defining cell averages as in the Godunov method. For the RCM, this is not necessary and we assume that the given data at the cell centres <span class="math notranslate nohighlight">\(x_{i}\)</span> is constant throughout the respective cell <span class="math notranslate nohighlight">\(I_{i}\)</span> . We then have <span class="math notranslate nohighlight">\(\mathbf{W}(x,t^{n}) = \mathbf{W}_{i}^{n}\)</span> in each cell <span class="math notranslate nohighlight">\(I_{i}\)</span> . Fig.7.2 shows the distribution of a typical variable <span class="math notranslate nohighlight">\(w_{k}\)</span> at a given time level <span class="math notranslate nohighlight">\(n\)</span> .</p>
<p>The pairs of neighbouring, constant, states <span class="math notranslate nohighlight">\(\mathbf{W}_{i}^{n}, \mathbf{W}_{i+1}^{n}\)</span> define local Riemann problems <span class="math notranslate nohighlight">\(RP(\mathbf{W}_{i}^{n}, \mathbf{W}_{i+1}^{n})\)</span> , which have similarity solutions <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(x/t)\)</span> . A detialed understanding of the complete exact solution of the Riemann problem is essential for understanding and implementing the RCM. Fig.7.3 illustrates the structure of a typical Riemann problem solution and a typical sampling range of the solution at a given time <span class="math notranslate nohighlight">\(t^{*}\)</span> , across the wave structure. In the Random Choice Method the particular point <span class="math notranslate nohighlight">\(x=x^{*}\)</span> is picked up at random within the sampling range <span class="math notranslate nohighlight">\([x_{l},x_{r}]\)</span> . The sampling routine evaluates <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(x^{*}/t^{*})\)</span> automatically.</p>
<p>The Random Choice Method updates the solution from the data value <span class="math notranslate nohighlight">\(\mathbf{W}_{i}^{n}\)</span> in cell <span class="math notranslate nohighlight">\(I_{i}\)</span> at time level <span class="math notranslate nohighlight">\(n\)</span> , to the value <span class="math notranslate nohighlight">\(\mathbf{W}_{i}^{n+1}\)</span> at time level <span class="math notranslate nohighlight">\(n+1\)</span> , in two steps as follows:</p>
<p>Step one: Solve the Riemann problems <span class="math notranslate nohighlight">\(RP(\mathbf{W}_{i-1}^{n}, \mathbf{W}_{i}^{n})\)</span> and <span class="math notranslate nohighlight">\(RP(\mathbf{W}_{i}^{n}, \mathbf{W}_{i+1}^{n})\)</span> to find their respective solutions <span class="math notranslate nohighlight">\(\mathbf{W}_{i-\frac{1}{2}}(x/t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(x/t)\)</span> . Fig.7.4 shows typical wave patterns emerging from the intercell boundaries <span class="math notranslate nohighlight">\(x_{i-\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(x_{i+\frac{1}{2}}\)</span> .</p>
<p>Step two: Random sample these solutions at time <span class="math notranslate nohighlight">\(\Delta t\)</span> within cell <span class="math notranslate nohighlight">\(I_{i}\)</span> to pick up a state and assign it to cell <span class="math notranslate nohighlight">\(I_{i}\)</span> . The random sampling range is shown in Fig.7.4 by a thick horizontal line. The picked up state depends on a random, or quasi-random, number <span class="math notranslate nohighlight">\(\theta^{n}\)</span> in the interval <span class="math notranslate nohighlight">\([0,1]\)</span> . The updated solution is then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{W}_{i}^{n+1} = \left\{ \begin{array}{ll}
\mathbf{W}_{i-\frac{1}{2}}(\theta^{n}\Delta x/\Delta t) ,\quad \text{if}~ 0\le \theta^{n} \le \frac{1}{2} \\
\mathbf{W}_{i-\frac{1}{2}}\Big( (\theta^{n}-1)\Delta x / \Delta t \Big) ,\quad \text{if}~ \frac{1}{2} \le \theta^{n} \le 1
\end{array}\right.
\end{align}\end{split}\]</div>
<p>The case in which <span class="math notranslate nohighlight">\(0\le \theta^{n} \le \frac{1}{2}\)</span> is illustrated in Fig.7.5. Here the updated solution depends on the random sampling procedure applied to the right side of the left Riemann problem soluiton <span class="math notranslate nohighlight">\(\mathbf{W}_{i-\frac{1}{2}}(x/t)\)</span> . The particular randomly chosen state is returned by the sampling routine, called with the argument</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S := x/t = \frac{\theta^{n}\Delta x}{\Delta t}
\end{align}\]</div>
<p>The resulting state is then assigned to the grid point <span class="math notranslate nohighlight">\(i\)</span> , which is regarded as the solution in cell <span class="math notranslate nohighlight">\(I_{i}\)</span> for the next time level. A similar procedure is applied if <span class="math notranslate nohighlight">\(\frac{1}{2} \le \theta^{n} \le 1\)</span> . In this case one samples the left side of the right Riemann problem solution <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(x/t)\)</span> . When programming the non-staggered version of the Random Choice Method there are many ways of organising the tasks of (1) solving of Riemann problems and (2) random sampling their solutions.</p>
<p>Concerning the use of random numbers in the scheme, Chorin established that one only requires a single random number <span class="math notranslate nohighlight">\(\theta^{n}\)</span> for a complete time level <span class="math notranslate nohighlight">\(n\)</span> . In Glimm’s proof one may take one random number per time step per cell.</p>
<p>Finally, we note the relationship between the RCM scheme to obtain the updated value <span class="math notranslate nohighlight">\(\mathbf{W}_{i}^{n+1}\)</span> and the Godunov method, instead of random sampling the solution of the relevant Riemann problems, will take the integral average of these local Riemann problem solutions</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1}
= \frac{1}{\Delta x} \int_{0}^{\frac{1}{2}\Delta x}\mathbf{U}_{i-\frac{1}{2}}\Big(\frac{x}{\Delta t}\Big)\mathrm{d}x
+ \frac{1}{\Delta x} \int_{-\frac{1}{2}}^{0} \mathbf{U}_{i+\frac{1}{2}}\Big(\frac{x}{\Delta t}\Big)\mathrm{d}x
\end{align}\]</div>
<p>In order to preserve the conservative character of the Godunov method, the averaging is performed in terms of the conserved variables. The RCM, on the other hand, is not strictly conservative, although one may regard the scheme as being conservative in a statistical sense.</p>
</div>
<div class="section" id="boundary-conditions-and-the-time-step-size">
<h4>Boundary Conditions and the Time Step Size<a class="headerlink" href="#boundary-conditions-and-the-time-step-size" title="永久链接至标题">¶</a></h4>
<p>The solution updating  procedure just described is completely defined for all cell <span class="math notranslate nohighlight">\(I_{i}\)</span> , except for those next to the boundaries, namely <span class="math notranslate nohighlight">\(I_{1}\)</span> and <span class="math notranslate nohighlight">\(I_{M}\)</span> . In order to update these two cells we apply boundary conditions. This is carried out in exactly the same way as for the Godunov method. Fictitious states <span class="math notranslate nohighlight">\(\mathbf{W}_{0}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{W}_{M+1}\)</span> adjacent to states <span class="math notranslate nohighlight">\(\mathbf{W}_{1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{W}_{M}\)</span> are defined. The otherwise missing Riemann problem solutions <span class="math notranslate nohighlight">\(\mathbf{W}_{\frac{1}{2}}(x/t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{W}_{M+\frac{1}{2}}(x/t)\)</span> at the boundaries are now defined and the random sampling procedure can now be extended to the full computational domain. We consider two types of boundary conditions, as for the one-dimensional time dependent Euler equations:</p>
<ol class="arabic simple">
<li>Transmissive Boundary Conditions. Here the fictitous states are given as</li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{0}^{n} = \rho_{1}^{n}
,\quad
u_{0}^{n} = u_{1}^{n}
,\quad
p_{0}^{n} = p_{1}^{n}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{M+1}^{n} = \rho_{M}^{n}
,\quad
u_{M+1}^{n} = u_{M}^{n}
,\quad
p_{M+1}^{n} = p_{M}^{n}
\end{align}\]</div>
<ol class="arabic simple" start="2">
<li>Reflective Boundary Conditions. Here we state the boundary conditions that apply to reflective left and right boundaries moving with respective speeds <span class="math notranslate nohighlight">\(u_{wl}\)</span> and <span class="math notranslate nohighlight">\(u_{wr}\)</span> . The fictitious states are given by</li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{0}^{n} = \rho_{1}^{n}
,\quad
u_{0}^{n} = - u_{1}^{n} + 2u_{wl}
,\quad
p_{0}^{n} = p_{1}^{n}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{M+1}^{n} = \rho_{M}^{n}
,\quad
u_{M+1}^{n} = - u_{M}^{n} + 2u_{wr}
,\quad
p_{M+1}^{n} = p_{M}^{n}
\end{align}\]</div>
<p>The choice of the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> is determined by a CFL condition. Note first that in order to perform the random sampling described previously, we need to make the assumption that no wave interaction takes place within cell <span class="math notranslate nohighlight">\(I_{i}\)</span> , in the chosen time <span class="math notranslate nohighlight">\(\Delta t\)</span> , see Fig.7.4. This is satisfied by imposing the following restriction on the size of <span class="math notranslate nohighlight">\(\Delta t\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t \le \frac{\frac{1}{2}\Delta x}{S_{\max}^{n}}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> denotes the maximum wave velocity present throughout the domain at time <span class="math notranslate nohighlight">\(t^{n}\)</span> . A consequence of this restriction is that only two Riemann problem solutions affect cell <span class="math notranslate nohighlight">\(I_{i}\)</span> , namely the right travelling waves of <span class="math notranslate nohighlight">\(\mathbf{W}_{i-\frac{1}{2}}(x/t)\)</span> and the left travelling waves of <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(x/t)\)</span> . Condition above may be expressed in the standard form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t = \frac{C_{cfl}\Delta x}{S_{\max}^{n}}
\end{align}\]</div>
<p>where the CFL coefficient <span class="math notranslate nohighlight">\(C_{cfl}\)</span> satisfies</p>
<div class="math notranslate nohighlight">
\[\begin{align}
0 \le C_{cfl} \le \frac{1}{2}
\end{align}\]</div>
<p>Hence the Random Choice Method has a stability limit of <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> , which is only half that of Godunov’s method.</p>
<p>For the RCM we recommend the use of the true waves arising from the solutions of local Riemann problems. The collective experience in applying the RCM in that the scheme is not too sensitive to underestimating <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> . If <span class="math notranslate nohighlight">\(S_{\max}^{n}\)</span> is underestimated then the chosen time step <span class="math notranslate nohighlight">\(\Delt t\)</span> will be too large and the likely consequence will not be signs of instabilities, as one  would expect, but computed waves will propagate at obviously wrong speed.</p>
</div>
</div>
<div class="section" id="a-random-choice-scheme-of-the-lax-friedrichs-type">
<h3>A Random Choice Scheme of the Lax-Friedrichs Type<a class="headerlink" href="#a-random-choice-scheme-of-the-lax-friedrichs-type" title="永久链接至标题">¶</a></h3>
<p>Here we present a Random Choice Method that arises from interpreting the Lax-Friedrichs scheme as an integral average of solutions of Riemann problems. If these averages are transformed by use of the integral form of the conservation laws one recovers the usual Lax-Friedrichs scheme for non-linear systems, thus eliminating the role of the Riemann problem. If the role of the Riemann problem solution is preserved and the integral averages are interpreted in a stochastic sence one obtains a Random Choice Method of the Lax-Friedrichs type.</p>
<div class="section" id="review-of-the-lax-friedrichs-scheme">
<h4>Review of the Lax-Friedrichs Scheme<a class="headerlink" href="#review-of-the-lax-friedrichs-scheme" title="永久链接至标题">¶</a></h4>
<p>Let’s review the Lax-Friedrichs scheme first. The Lax-Friedrichs scheme as applied to the linear advection equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{t} + f(u)_{x} = 0
,\quad
f(u) = au
\end{align}\]</div>
<p>reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1 + c}{2}u_{i-1}^{n} + \frac{1 - c}{2}u_{i+1}^{n}
\end{align}\]</div>
<p>This is obviously identical to the integral average</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \hat{u}_{i}(x,\frac{1}{2}\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>within cell <span class="math notranslate nohighlight">\(i\)</span> , in which <span class="math notranslate nohighlight">\(\hat{u}_{i}(x,t)\)</span> is the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(u_{i-1}^{n}, u_{i+1}^{n})\)</span> , that is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{u}_{i}(x/t) = \left\{ \begin{array}{ll}
u_{i-1}^{n} \quad \text{if}~ x/t&lt;a \\
u_{i+1}^{n} \quad \text{if}~ x/t &gt; a
\end{array}\right.
\end{align}\end{split}\]</div>
<p>See Fig.7.6. The Lax-Friedrichs solution in cell <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t^{n+1} = t^{n} + \Delta t\)</span> is a weighted average of the solution of the Riemann problem with the left <span class="math notranslate nohighlight">\(u_{i-1}^{n}\)</span> and right <span class="math notranslate nohighlight">\(u_{i+1}^{n}\)</span> neighbour states as data, at time <span class="math notranslate nohighlight">\(t=\frac{1}{2}\Delta t\)</span> . Note the two peculiarities of the scheme, (1) the data states do not include <span class="math notranslate nohighlight">\(u_{i}^{n}\)</span> and (2) the time for the averaging is half the full time step <span class="math notranslate nohighlight">\(\Delta t\)</span> .</p>
</div>
<div class="section" id="the-scheme">
<h4>The Scheme<a class="headerlink" href="#the-scheme" title="永久链接至标题">¶</a></h4>
<p>We first generalise interpretation of the Lax-Friedrichs scheme to non-linear systems of conservation laws</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
\end{align}\]</div>
<p>The scheme reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \frac{1}{\Delta x} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \hat{\mathbf{U}}_{i}(x,\frac{1}{2}\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}_{i}(x,t)\)</span> is the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i-1}^{n}, \mathbf{U}_{i+1}^{n})\)</span> . There are now three possible routes to follow, these are:</p>
<ul class="simple">
<li>Solve Riemann problems and find the updated solution by evaluating the above equation directly. Numerical results of this scheme are indistinguishable from those obtained from the conventional, much simpler, Lax-Friedrichs scheme. We therefore discard this as a useful scheme.</li>
<li>Apply the integral form of the conservation laws to the above equation to reproduce the conventional Lax-Friedrichs scheme for non-linear systems, and thus eliminate the role of the Riemann problem.</li>
<li>Keep the role of the Riemann problem and reinterpret the above equation in a stochastic sense. We obtain</li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \frac{1}{\Delta x} \int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x} \hat{\mathbf{U}}_{i}(\theta^{n}\Delta x, \frac{1}{2}\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta^{n}\)</span> is a random number satisfying</p>
<div class="math notranslate nohighlight">
\[\begin{align}
- \frac{1}{2} \le \theta^{n} \le \frac{1}{2}
\end{align}\]</div>
<p>A Random Choice Scheme for updating the solution to the new time level is thus obtained, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \hat{\mathbf{U}}_{i}(\theta^{n}\Delta x, \frac{1}{2}\Delta t)
\end{align}\]</div>
<p>The conventional RCM has stability restriction <span class="math notranslate nohighlight">\(0 &lt; C_{cfl} \le \frac{1}{2}\)</span> , while the random choice scheme above has stability condition</p>
<div class="math notranslate nohighlight">
\[\begin{align}
0 &lt; C_{cfl} \le 1
\end{align}\]</div>
<p>which represents an improvement by a factor of <span class="math notranslate nohighlight">\(2\)</span> .</p>
</div>
</div>
<div class="section" id="the-rcm-on-a-staggered-grid">
<h3>The RCM on a Staggered Grid<a class="headerlink" href="#the-rcm-on-a-staggered-grid" title="永久链接至标题">¶</a></h3>
<div class="section" id="id38">
<h4>The Scheme for Non-Linear Systems<a class="headerlink" href="#id38" title="永久链接至标题">¶</a></h4>
<p>The staggered grid version of the RCM to solve <span class="math notranslate nohighlight">\(\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}\)</span> updates <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n}\)</span> to a new value <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n+1}\)</span> in two steps, as illustrated in Fig.7.8. The steps are:</p>
<p>Step one: Solve the Riemann problems <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i-1}^{n}, \mathbf{U}_{i}^{n})\)</span> and <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i}^{n}, \mathbf{U}_{i+1}^{n})\)</span> to find respective solutions</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\mathbf{U}}_{i-\frac{1}{2}}^{n+\frac{1}{2}}(x,t)
,\quad
\hat{\mathbf{U}}_{i+\frac{1}{2}}^{n+\frac{1}{2}}(x,t)
\end{align}\]</div>
<p>Random sample these solutions at a stable time <span class="math notranslate nohighlight">\(\Delta t^{n+\frac{1}{2}}\)</span> , that is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i-\frac{1}{2}}^{n+\frac{1}{2}}
= \hat{\mathbf{U}}_{i-\frac{1}{2}}^{n+\frac{1}{2}}(\theta^{n}\Delta x, \Delta t^{n+\frac{1}{2}})
,\quad
\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}}
= \hat{\mathbf{U}}_{i+\frac{1}{2}}^{n+\frac{1}{2}}(\theta^{n}\Delta x, \Delta t^{n+\frac{1}{2}})
\end{align}\]</div>
<p>Step two: Solve <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i-\frac{1}{2}}^{n+\frac{1}{2}}, \mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}})\)</span> to find solution <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}_{i}^{n+1}(x,t)\)</span> and random sample it, at a stable time <span class="math notranslate nohighlight">\(\Delta t^{n+1}\)</span> , to obtain <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n+1}\)</span> , that is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \hat{\mathbf{U}}_{i}^{n+1}(\theta^{n+1}\Delta x, \Delta t^{n+1})
\end{align}\]</div>
<p>The time steps <span class="math notranslate nohighlight">\(\Delta t^{n+\frac{1}{2}}\)</span> and <span class="math notranslate nohighlight">\(\Delta t^{n+1}\)</span> need not be the same but must be chosen according to the usual stability restriction for the RCM. As for the case of the non-staggered RCM, one may use the primitive variables to describe the staggered grid RCM. However, for the theme of the next section we assume the vector <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> in the above equations to be the vector of conserved variables.</p>
</div>
<div class="section" id="a-deterministic-first-order-centred-scheme-force">
<h4>A Deterministic First-Order Centred Scheme (FORCE)<a class="headerlink" href="#a-deterministic-first-order-centred-scheme-force" title="永久链接至标题">¶</a></h4>
<p>Here we present a First-Order Centred deterministic scheme (FORCE), that is obtained by replacing the stochastic steps in the RCM on staggered grid</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i-\frac{1}{2}}^{n+\frac{1}{2}}
= \hat{\mathbf{U}}_{i-\frac{1}{2}}^{n+\frac{1}{2}}(\theta^{n}\Delta x, \Delta t^{n+\frac{1}{2}})
,\quad
\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}}
= \hat{\mathbf{U}}_{i+\frac{1}{2}}^{n+\frac{1}{2}}(\theta^{n}\Delta x, \Delta t^{n+\frac{1}{2}})
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \hat{\mathbf{U}}_{i}^{n+1}(\theta^{n+1}\Delta x, \Delta t^{n+1})
\end{align}\]</div>
<p>by deterministic versions, via integral averages of Riemann problem solutions. We preserve the previous notation and assume</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t^{n+\frac{1}{2}} = \Delta t^{n+1} = \frac{1}{2}\Delta t
\end{align}\]</div>
<p>The stochastic integrals are replaced by the deterministic integrals</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i-\frac{1}{2}}^{n+\frac{1}{2}} = \frac{1}{\Delta x} \int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x} \hat{\mathbf{U}}_{i-\frac{1}{2}}^{n+\frac{1}{2}}(x, \frac{\Delta t}{2})~\mathrm{d}x
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}} = \frac{1}{\Delta x} \int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x}\hat{\mathbf{U}}_{i+\frac{1}{2}}(x,\frac{\Delta t}{2})~\mathrm{d}x
\end{align}\]</div>
<p>Then we apply the integral form of the  conservation laws to the two expressions above. The result is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{i-\frac{1}{2}}^{n+\frac{1}{2}} = \frac{1}{2}(\mathbf{U}_{i-1}^{n} + \mathbf{U}_{i}^{n}) + \frac{\Delta t}{2\Delta x}(\mathbf{F}_{i-1}^{n} - \mathbf{F}_{i}^{n}) \\
&amp; \mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}} = \frac{1}{2}(\mathbf{U}_{i}^{n} + \mathbf{U}_{i+1}^{n}) + \frac{\Delta t}{2\Delta x}(\mathbf{F}_{i}^{n} - \mathbf{F}_{i+1}^{n})
\end{align}\end{split}\]</div>
<p>We denote by <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}_{i}(x,t)\)</span> the solution of the Riemann problem <span class="math notranslate nohighlight">\(RP(\mathbf{U}_{i-\frac{1}{2}}^{n+\frac{1}{2}}, \mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}})\)</span> and define an average <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n+1}\)</span> at the complete time step <span class="math notranslate nohighlight">\(\Delta t\)</span> in terms of an integral average of <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}_{i}(x,t)\)</span> at the (local) time <span class="math notranslate nohighlight">\(t=\frac{1}{2}\Delta t\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \frac{1}{\Delta x} \int_{-\frac{1}{2}\Delta x}^{\frac{1}{2}\Delta x} \hat{\mathbf{U}}_{i}(x,\frac{1}{2}\Delta t)~\mathrm{d}x
\end{align}\]</div>
<p>This is the deterministic version of <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n+1} = \hat{\mathbf{U}}_{i}^{n+1}(\theta^{n+1}\Delta x, \Delta t^{n+1})\)</span> . Applying the integral form of the conservation laws to the right-hand side of the above equation gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1}
= \frac{1}{2}\Big( \mathbf{U}_{i-\frac{1}{2}}^{n+\frac{1}{2}} + \mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}} \Big)
+ \frac{\Delta t}{2\Delta x}\Big( \mathbf{F}_{i-\frac{1}{2}}^{n+\frac{1}{2}} - \mathbf{F}_{i+\frac{1}{2}}^{n+\frac{1}{2}} \Big)
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}}^{n+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{i+\frac{1}{2}}^{n+\frac{1}{2}}) =: \mathbf{F}_{i+\frac{1}{2}}^{RI}
\end{align}\]</div>
<p>and <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}^{RI}\)</span> is the intercell numerical flux for the Richtmyer scheme.</p>
<p>The scheme is obviously conservative and when written in conservation form we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} + \frac{\Delta t}{\Delta x}\Big( \mathbf{F}_{i-\frac{1}{2}} - \mathbf{F}_{i+\frac{1}{2}} \Big)
\end{align}\]</div>
<p>with intercell numerical flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}}^{force} = \frac{1}{2}\bigg[ \mathbf{F}_{i+\frac{1}{2}}^{n+\frac{1}{2}} + \frac{1}{2}(\mathbf{F}_{i}^{n} + \mathbf{F}_{i+1}^{n}) \bigg] + \frac{1}{4}\frac{\Delta x}{\Delta t}(\mathbf{U}_{i}^{n} - \mathbf{U}_{i+1}^{n})
\end{align}\]</div>
<p>A surprising outcome is that the intercell flux is in fact the arithmetic mean of the fluxes for the Richtmyer and Lax-Friedrichs schemes, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}}^{force} = \frac{1}{2}\Big( \mathbf{F}_{i+\frac{1}{2}}^{RI} + \mathbf{F}_{i+\frac{1}{2}}^{LF} \Big)
\end{align}\]</div>
</div>
<div class="section" id="analysis-of-the-force-scheme">
<h4>Analysis of the FORCE Scheme<a class="headerlink" href="#analysis-of-the-force-scheme" title="永久链接至标题">¶</a></h4>
<p>For the linear advection equation, the conservative FORCE scheme yields</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = b_{-1}u_{i-1}^{n} + b_{0}u_{i}^{n} + b_{1}u_{i+1}^{n}
\end{align}\]</div>
<p>with coefficients given as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
b_{-1} = \frac{1}{4}(1 + c)^{2}
,\quad
b_{0} = \frac{1}{2}(1 - c^{2})
,\quad
b_{1} = \frac{1}{4}(1-c)^{2}
\end{align}\]</div>
<p>Using standard von Neumann analysis, or more directly by utilising Billett’s result, which says that a scheme of this form is stable and only if</p>
<div class="math notranslate nohighlight">
\[\begin{align}
b_{0}(b_{-1} + b_{1}) \ge 0
,\quad
b_{0}(b_{-1} + b_{1}) + 4b_{-1}b_{1} := B \ge 0
\end{align}\]</div>
<p>The first condition leads to the expression of stability condition directly:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
0 \le |c| \le 1, \qquad c = \frac{\Delta t a}{\Delta x}
\end{align}\]</div>
<p>While the second condition produces</p>
<div class="math notranslate nohighlight">
\[\begin{align}
B = \frac{1}{4} \Big[ (1-c^{2})(1+c^{2}) + (1+c)^{2}(1-c)^{2} \Big]
\end{align}\]</div>
<p>A sufficient condition for <span class="math notranslate nohighlight">\(B \ge 0\)</span> is again <span class="math notranslate nohighlight">\(b_{0} \ge 0\)</span> , which confirms the sought stabiliy restriction.</p>
<p>Concerning monotonicity, by inspection, the scheme is monotone for Courant numbers satisfying the stability condition, i.e. all coeffients are non-negative.</p>
<p>By using standard analysis we can get modified equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
q_{t} + aq_{x} = \alpha_{fo}q_{xx}
,\qquad
\alpha_{fo} = \frac{1}{4}a\Delta x\Big(\frac{1-c^{2}}{c}\Big) = \frac{1}{2}\alpha_{lf}
\end{align}\]</div>
</div>
</div>
<div class="section" id="random-numbers">
<h3>Random Numbers<a class="headerlink" href="#random-numbers" title="永久链接至标题">¶</a></h3>
<p>The quality of the computed RCM solution depends crucially on the random numbers <span class="math notranslate nohighlight">\(\{\theta^{n}\}\)</span> . Research in this area has produced some very effective guidelines. For example, it has been established that the more random the generation of <span class="math notranslate nohighlight">\(\{\theta^{n}\}\)</span> , the worse the computed RCM results. Colella introduced the use of pseudo-random numbers of the van der Corput type.</p>
<div class="section" id="van-der-corput-pseudo-random-numbers">
<h4>Van der Corput Pseudo-Random Numbers<a class="headerlink" href="#van-der-corput-pseudo-random-numbers" title="永久链接至标题">¶</a></h4>
</div>
<div class="section" id="statistical-properties">
<h4>Statistical Properties<a class="headerlink" href="#statistical-properties" title="永久链接至标题">¶</a></h4>
</div>
<div class="section" id="propagation-of-a-single-shock">
<h4>Propagation of a Single Shock<a class="headerlink" href="#propagation-of-a-single-shock" title="永久链接至标题">¶</a></h4>
</div>
</div>
</div>
<div class="section" id="id39">
<h2>Flux Vector Splitting Methods<a class="headerlink" href="#id39" title="永久链接至标题">¶</a></h2>
<p>A distinguishing feature of upwind numerical methods is this: the discretisation of the equations on a mesh is performed according to the direction of propagation of information on that mesh. In this way, salient features of the physical phenomena modelled by the equations are incorporated into the discretisation schemes. There are essentially two approaches for identifying upwind directions, namely the Godunov approach and the Flux Vector Splitting (FVS) approach. These two approaches are often referred to as the Riemann approach and the Boltzmann approach. The respective numerical methods derived from these two approaches are often referred to as Flux Difference Splitting Methods and Flux Vector Splitting Methods.</p>
<p>The identification of upwind directions in Flux Vector Splitting Methods is achieved with less effort than in Godunov-type methods, leading to simpler and somewhat more efficient schemes. These two features are very attractive and have made FVS schemes very popular within a large community of practitioners. The Flux Vector Splitting approach is particularly well suited for implicit methods; these are popular in Aerodynamics, where the computation of steady solutions is of great practical value. The reduced sophistication of FVS schemes however, as compared with Godunov-type schemes, results in poorer resolution of discontinuities, particularly stationary contact and shear waves. In applications to the Navier-Stokes equations, it is reported by van Leer, Thomas and Roe that their FVS scheme is considerably less accurate than Godunov’s method with Roe’s approximate Riemann solver. A key feature of the FVS approach is its reliance on a special property of the equations, namemly the homogeneity property. The Euler equations satisfy this property but there are important examples, such as the shallow water equations, that do not. The homogeneity property may however be circumvented so as to be apply the FVS approach.</p>
<div class="section" id="the-flux-vector-splitting-approach">
<h3>The Flux Vector Splitting Approach<a class="headerlink" href="#the-flux-vector-splitting-approach" title="永久链接至标题">¶</a></h3>
<div class="section" id="upwind-differencing">
<h4>Upwind Differencing<a class="headerlink" href="#upwind-differencing" title="永久链接至标题">¶</a></h4>
<p>Consider the small perturbation steady supersonic equations</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{x} - a^{2}v_{y}=0
,\quad
v_{x} - u_{y} = 0
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(u=u(x,y)\)</span> ， <span class="math notranslate nohighlight">\(v=v(x,y)\)</span> ,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a = \sqrt{\frac{1}{M_{\infty}^{2} - 1}}
\end{align}\]</div>
<p>is the sound speed and <span class="math notranslate nohighlight">\(M_{\infty}\)</span> is the free-stream Mach number, assumed to be greater than unity. The equations may be rewritten as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{x} + \mathbf{A}\mathbf{U}_{y} = \mathbf{0}
\end{align}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} = \begin{bmatrix} u \\ v \end{bmatrix}
,\quad
\mathbf{A} = \begin{bmatrix}
0 &amp; -a^{2} \\
-1 &amp; 0
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The eigenvalues of the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} = -a
,\quad
\lambda_{2} = +a
\end{align}\]</div>
<p>with corresponding right eigenvectors</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K}^{(1)} = \begin{bmatrix} a \\ 1 \end{bmatrix}
,\quad
\mathbf{K}^{(2)} = \begin{bmatrix} a \\ -1 \end{bmatrix}
\end{align}\end{split}\]</div>
<p>Given the mixed character of the eigenvalues ( <span class="math notranslate nohighlight">\(\lambda_{1}=-a\)</span> is negative and <span class="math notranslate nohighlight">\(\lambda_{2}=+a\)</span> is positive), a finite difference discretisation of the equation has limited choices for the spatial derivative, if upwind bias is to be applied. Consider, for instance, the one-sided difference schemes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} - \frac{\Delta x}{\Delta y}\mathbf{A}(\mathbf{U}_{i}^{n} - \mathbf{U}_{i-1}^{n}) \\
&amp; \mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} - \frac{\Delta x}{\Delta y}\mathbf{A}(\mathbf{U}_{i+1}^{n} - \mathbf{U}_{i}^{n})
\end{align}\end{split}\]</div>
<p>Clearly the first scheme is upwind relative to the eigenvalue <span class="math notranslate nohighlight">\(\lambda_{2}=a&gt;0\)</span> but is downwind, and thus unstable, relative to the eigenvalue <span class="math notranslate nohighlight">\(\lambda_{1}=-a&lt;0\)</span> . A similar observation applies to the second scheme. For the case in which all eigenvalues have the same sign the difficulty of choosing the upwind direction does not arise.</p>
<p>General linear hyperbolic systems with constant coefficients may be solved by the CIR first-order upwind method by decomposing the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> into a positive component <span class="math notranslate nohighlight">\(\mathbf{A}^{+}\)</span> and a negative component <span class="math notranslate nohighlight">\(\mathbf{A}^{-}\)</span> , such that</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A} = \mathbf{A}^{+} + \mathbf{A}^{-}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}^{+}\)</span> has positive or zero eigenvalues and <span class="math notranslate nohighlight">\(\mathbf{A}^{-}\)</span> has negative or zero eigenvalues. One then has the upwind scheme</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} - \frac{\Delta x}{\Delta y}\mathbf{A}^{+}[\mathbf{U}_{i}^{n} - \mathbf{U}_{i-1}^{n}] - \frac{\Delta x}{\Delta y}\mathbf{A}^{-}[\mathbf{U}_{i+1}^{n} - \mathbf{U}_{i}^{n}]
\end{align}\]</div>
<p>The Split-Coefficient Matrix Scheme of Chakravarthy et. al. is an extension of this procedure to non-linear systems, in non-conservative form.</p>
<p>The CIR upwind scheme, when applied to general linear hyperbolic systems with constant coefficients, may be written in conservative form by defining the flux vector</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F} = \mathbf{A}\mathbf{U}
\end{align}\]</div>
<p>Then the splitting of the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> results in a natural splitting of the flux vector <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F} = \mathbf{F}^{+} + \mathbf{F}^{-}
\end{align}\]</div>
<p>In this way the CIR upwind scheme can be written in conservative form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} - \frac{\Delta t}{\Delta x}[\mathbf{F}_{i+\frac{1}{2}} - \mathbf{F}_{i-\frac{1}{2}}]
\end{align}\]</div>
<p>where the intercell numerical flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{i}^{+}(\mathbf{U}_{i}^{n}) + \mathbf{F}_{i}^{-}(\mathbf{U}_{i+1}^{n})
\end{align}\]</div>
<p>is identical to the Godunov intercell flux. The Flux Vector Splitting Method is a generalisation of this to non-linear systems in conservation form.</p>
</div>
<div class="section" id="the-fvs-approach">
<h4>The FVS Approach<a class="headerlink" href="#the-fvs-approach" title="永久链接至标题">¶</a></h4>
<p>Here we consider a general system of <span class="math notranslate nohighlight">\(m\)</span> non-linear hyperbolic conservation laws</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
\end{align}\]</div>
<p>From the assumption of hyperbolicity the Jacobian matrix</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}(\mathbf{U}) = \frac{\partial \mathbf{F}}{\partial \mathbf{U}}
\end{align}\]</div>
<p>may be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A} = \mathbf{K}\mathbf{\Lambda}\mathbf{K}^{-1}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span> is the diagonal matrix formed by the eigenvalues of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{\Lambda} = \begin{bmatrix}
\lambda_{1} &amp; &amp; 0 \\
 &amp; \ddots &amp; \\
0 &amp; &amp; \lambda_{m}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{K} = [\mathbf{K}^{(1)} , \mathbf{K}^{(2)} , \cdots , \mathbf{K}^{(m)}]
\end{align}\]</div>
<p>where the colume <span class="math notranslate nohighlight">\(\mathbf{K}^{(i)}\)</span> is the right eigenvector of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> corresponding to <span class="math notranslate nohighlight">\(\lambda_{i}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{K}^{-1}\)</span> is the inverse of <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> . Recall our usual convention of ordering the eigenvalues in increasing order.</p>
<p>The Flux Vector Splitting method aims to generalising the intercell numerical flux to non-linear systems. That is, FVS requires a splitting of the flux vector <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> into two component <span class="math notranslate nohighlight">\(\mathbf{F}^{+}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}^{-}\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}(\mathbf{U}) = \mathbf{F}^{+}(\mathbf{U}) + \mathbf{F}^{-}(\mathbf{U})
\end{align}\]</div>
<p>under the restriction that the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{i}^{+}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{i}^{-}\)</span> of the Jacobian matrices</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}^{+} = \frac{\partial \mathbf{F}^{+}}{\partial \mathbf{U}}
,\quad
\mathbf{A}^{-} = \frac{\partial \mathbf{F}^{-}}{\partial \mathbf{U}}
\end{align}\]</div>
<p>satisfy the condition</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{i}^{+} \ge 0
,\quad
\lambda_{i}^{-} \le 0
\end{align}\]</div>
<p>The splitting is also required to reproduce regular upwinding when all eigenvalues <span class="math notranslate nohighlight">\(\lambda_{i}\)</span> of the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> are one-sided, that is, all positive or zero, or all negative or zero. That is to say</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{F}^{+} = \mathbf{F} ,\quad \mathbf{F}^{-}=\mathbf{0} \quad \text{if}~\lambda_{i}\ge 0 \quad \text{for}~ i=1,\cdots,m \\
&amp; \mathbf{F}^{+} = \mathbf{0} ,\quad \mathbf{F}^{-} = \mathbf{F} \quad \text{if}~\lambda_{i} \le 0 \quad \text{for}~ i=1,\cdots,m
\end{align}\end{split}\]</div>
<p>If in addition to hyperbolicity, the system satisfies the homogeneity property</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}(\mathbf{U}) = \mathbf{A}(\mathbf{U})\mathbf{U}
\end{align}\]</div>
<p>just as in the linear constant coefficient case, then the sought splitting is easily accomplished by identifying a suitable splitting of the Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> . The time-dependent Euler equations satisfy the homogeneity property.</p>
<p>From the diagonalisation of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> given by <span class="math notranslate nohighlight">\(\mathbf{A}=\mathbf{K}\mathbf{\Lamda}\mathbf{K}^{-1}\)</span> , a splitting of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> may be accomplished by an appropriate splitting of the diagonal matrix <span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span> . This in turn, may be split by identifying a splitting of the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{i}, i=1,\cdots,m\)</span> of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> . Suppose we may split the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{i}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{i} = \lambda_{i}^{+} + \lambda_{i}^{-}
\end{align}\]</div>
<p>such that <span class="math notranslate nohighlight">\(\lambda_{i}^{+} \ge 0\)</span> and <span class="math notranslate nohighlight">\(\lambda_{i}^{-} le 0\)</span> . Then <span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span> may be split as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Lambda = \Lambda^{+} + \Lambda^{-}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\Lambda^{+} = \begin{bmatrix}
\lambda_{1}^{+} &amp; &amp; 0 \\
 &amp; \ddots &amp; \\
0 &amp; &amp; \lambda_{m}^{+}
\end{bmatrix}
,\qquad
\Lambda^{-} = \begin{bmatrix}
\lambda_{1}^{-} &amp; &amp; 0 \\
 &amp; \ddots &amp; \\
0 &amp; &amp; \lambda_{m}^{-}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>A natural splitting of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> results, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A} = \mathbf{A}^{+} + \mathbf{A}^{-}
\end{align}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}^{+} = \mathbf{K}\mathbf{\Lambda}^{+}\mathbf{K}^{-1}
,\quad
\mathbf{A}^{-} = \mathbf{K}\mathbf{\Lambda}^{-}\mathbf{K}^{-1}
\end{align}\]</div>
<p>Then, if <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U}) = \mathbf{A}(\mathbf{U})\mathbf{U}\)</span> is satisfied, we can split <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F} = \mathbf{F}^{+} + \mathbf{F}^{-}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}^{+} = \mathbf{A}^{+}\mathbf{U}
,\quad
\mathbf{F}^{-} = \mathbf{A}^{-}\mathbf{U}
\end{align}\]</div>
<p>Steger and Warming proposed a splitting of the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{i}\)</span> as in <span class="math notranslate nohighlight">\(\lambda_{i} = \lambda_{i}^{+} + \lambda_{i}^{-}\)</span> with definitions</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{i}^{+} = \frac{1}{2}(\lambda_{i} + |\lambda_{i}|)
,\quad
\lambda_{i}^{-} = \frac{1}{2}(\lambda_{i} - |\lambda_{i}|)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(|\lambda_{i}|\)</span> is the absolute value of <span class="math notranslate nohighlight">\(\lambda_{i}\)</span> . Clearly</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{i}^{+} \ge 0 , \quad \lambda_{i}^{-} \le 0 ,\quad \text{for}~ i=1,\cdots,m
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>We can verify that the following properties are satisfied</p>
<div class="last math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp;  \lambda_{i} = \lambda_{i}^{+} + \lambda_{i}^{-}, \quad |\lambda_{i}| = \lambda_{i}^{+} - \lambda_{i}^{-} \\
&amp; \mathbf{\Lambda} = \mathbf{\Lambda}^{+} + \mathbf{\Lambda}^{-} ,\quad |\mathbf{\Lambda}| = \mathbf{\Lambda}^{+} - \mathbf{\Lambda}^{-} \\
&amp; \mathbf{A} = \mathbf{A}^{+} + \mathbf{A}^{-} ,\quad |\mathbf{A}| = \mathbf{A}^{+} - \mathbf{A}^{-}
\end{align}\end{split}\]</div>
</div>
</div>
</div>
<div class="section" id="fvs-for-the-isothermal-equations">
<h3>FVS for the Isothermal Equations<a class="headerlink" href="#fvs-for-the-isothermal-equations" title="永久链接至标题">¶</a></h3>
<p>In order to illustrate the FVS approach we consider the isothermal equations of Gas Dynamics</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} = \begin{bmatrix} \rho \\ \rho u \end{bmatrix}
,\quad
\mathbf{F}(\mathbf{U}) = \begin{bmatrix} \rho u \\ \rho u^{2} + \rho a^{2} \end{bmatrix}
\end{align}\end{split}\]</div>
<p>where the sound speed <span class="math notranslate nohighlight">\(a\)</span> is a positive constant. The Jacobian matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{A} = \frac{\partial \mathbf{F}}{\partial \mathbf{U}} =
\begin{bmatrix}
0 &amp; 1 \\
a^{2}-u^{2} &amp; 2u
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The eigenvalues of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} = u-a
,\quad
\lambda_{2} = u+a
\end{align}\]</div>
<p>and the matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> of corresponding right eigenvectors is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K} = \begin{bmatrix}
1 &amp; 1 \\
u-a &amp; u+a
\end{bmatrix}
\end{align}\end{split}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">We can verify that the system satisfy the homogeneity property.</p>
</div>
<div class="section" id="split-fluxes">
<h4>Split Fluxes<a class="headerlink" href="#split-fluxes" title="永久链接至标题">¶</a></h4>
<p>Given any splitting <span class="math notranslate nohighlight">\(\lambda_{i} = \lambda_{i}^{+} + \lambda_{i}^{-}\)</span> with</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{\Lambda}^{+} = \begin{bmatrix} \lambda_{1}^{+} &amp; 0 \\ 0 &amp; \lambda_{2}^{+} \end{bmatrix}
,\quad
\mathbf{\Lambda}^{-} = \begin{bmatrix} \lambda_{1}^{-} &amp; 0 \\ 0 &amp; \lambda_{2}^{-} \end{bmatrix}
\end{align}\end{split}\]</div>
<p>we require the computation of the matrices <span class="math notranslate nohighlight">\(\mathbf{A}^{+}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A}^{-}\)</span> as given by <span class="math notranslate nohighlight">\(\mathbf{A}^{+}=\mathbf{K}\mathbf{\Lambda}^{+}\mathbf{K}^{-}, \mathbf{A}^{-}=\mathbf{K}\mathbf{\Lambda}^{-}\mathbf{K}^{-1}\)</span> . One then requires the determination of the inverse <span class="math notranslate nohighlight">\(\mathbf{K}^{-1}\)</span> of the matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> , the products of three matrices as in <span class="math notranslate nohighlight">\(\mathbf{A}^{+}=\mathbf{K}\mathbf{\Lambda}^{+}\mathbf{K}^{-}, \mathbf{A}^{-}=\mathbf{K}\mathbf{\Lambda}^{-}\mathbf{K}^{-1}\)</span> and finally the products <span class="math notranslate nohighlight">\(\mathbf{F}^{+}=\mathbf{A}^{+}\mathbf{U}, \mathbf{F}^{-}=\mathbf{A}^{-}\mathbf{U}\)</span> to find the flux components. For the isothermal equations we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K}^{-1} = \frac{1}{2a}\begin{bmatrix}
u+a &amp; -1 \\
a-u &amp; 1
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>Now, given any of the two components of <span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span> , <span class="math notranslate nohighlight">\(\mathbf{A}^{\alpha}\)</span> , say, we compute</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}^{\alpha} = \mathbf{K}\mathbf{\Lambda}^{\alpha}\mathbf{K}^{-1}
\end{align}\]</div>
<p>The result is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{\mathbf{\alpha}} = \frac{1}{2a}
\begin{bmatrix}
\lambda_{1}^{\alpha} (u+a) - \lambda_{2}^{\alpha}(u-a) &amp; \lambda_{2}^{\alpha} - \lambda_{1}^{\alpha} \\
(u^{2} - a^{2})(\lambda_{1}^{\alpha}-\lambda_{2}^{\alpha}) &amp; \lambda_{2}^{\alpha}(u+a) - \lambda_{1}^{\alpha}(u-a)
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>Application of <span class="math notranslate nohighlight">\(\mathbf{F}^{+}=\mathbf{A}^{+}\mathbf{U}, \mathbf{F}^{-}=\mathbf{A}^{-}\mathbf{U}\)</span> gives the flux vector component</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{\alpha} = \mathbf{A}^{\alpha}\mathbf{U} = \frac{\rho}{2} \begin{bmatrix} \lambda_{1}^{\alpha}+\lambda_{2}^{\alpha} \\ \lambda_{1}^{\alpha}(u-a) + \lambda_{2}^{\alpha}(u+a) \end{bmatrix}
\end{align}\end{split}\]</div>
<p>Note that the expression for the component <span class="math notranslate nohighlight">\(\mathbf{F}^{\alpha}\)</span> given by the above expression is general. For <span class="math notranslate nohighlight">\(\alpha=+\)</span> and <span class="math notranslate nohighlight">\(\alpha=-\)</span> the flux components <span class="math notranslate nohighlight">\(\mathbf{F}^{+}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}^{-}\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{+} = \frac{\rho}{2} \begin{bmatrix} \lambda_{1}^{+}+\lambda_{2}^{+} \\ \lambda_{1}^{+}(u-a) + \lambda_{2}^{+}(u+a) \end{bmatrix}
,\quad
\mathbf{F}^{-} = \frac{\rho}{2} \begin{bmatrix} \lambda_{1}^{-}+\lambda_{2}^{-} \\ \lambda_{1}^{-}(u-a) + \lambda_{2}^{-}(u+a) \end{bmatrix}
\end{align}\end{split}\]</div>
<p>For the split fluxes given above, for the case of subsonic flow, for the positive flux component <span class="math notranslate nohighlight">\(\mathbf{F}^{+}\)</span> the Jacobian matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{A}}^{+} = \frac{\partial \mathbf{F}^{+}}{\partial \mathbf{U}} = \begin{bmatrix} \frac{1}{2}a &amp; \frac{1}{2} \\ \frac{1}{2}(a^{2}-u^{2}) &amp; u+a \end{bmatrix}
\end{align}\end{split}\]</div>
<p>The eigenvalues are the roots of the characteristic polynomial</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda^{2} - (\frac{3}{2}a + u)\lambda + \frac{1}{4}(u + a)^{2} = 0
\end{align}\]</div>
<p>namely,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\lambda}_{1}^{+} = \frac{1}{4}a\Big( 2M + 3 - \sqrt{4M + 5} \Big)
,\quad
\hat{\lambda}_{2}^{+} = \frac{1}{4}a \Big( 2M + 3 + \sqrt{4M + 5} \Big)
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>Note that</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\mathbf{A}}^{+} \ne \mathbf{A}^{+}
,\quad
\hat{\lambda}_{i}^{+} \ne \hat{\lambda}_{i}^{+}
\end{align}\]</div>
<p class="last">Note also that <span class="math notranslate nohighlight">\(\hat{\lambda}_{i}^{+} &gt; 0\)</span> , that is, none of the eigenvalues vanish. Numerically, this particular property is not desirable, and which unfortunately also carries over to the Euler equations. As we shall see in the next section, there are other splitting schemes that remove this difficulty.</p>
</div>
</div>
<div class="section" id="fvs-numerical-schemes">
<h4>FVS Numerical Schemes<a class="headerlink" href="#fvs-numerical-schemes" title="永久链接至标题">¶</a></h4>
<p>The FVS approach can be used to solve <span class="math notranslate nohighlight">\(\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}\)</span> using the explicit conservative scheme</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} - \frac{\Delta t}{\Delta x}[\mathbf{F}_{i+\frac{1}{2}} - \mathbf{F}_{i-\frac{1}{2}}]
\end{align}\]</div>
<p>where the FVS numerical flux is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{i}^{+}(\mathbf{U}_{i}^{n}) + \mathbf{F}_{i+1}^{-}(\mathbf{U}_{i+1}^{n})
\end{align}\]</div>
<p>Fig.8.1 provides a physical interpretation of it. The intercell numerical flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> is made out from two contributions; one comes from the forward component <span class="math notranslate nohighlight">\(\mathbf{F}_{i}^{+}\)</span> in the left cell <span class="math notranslate nohighlight">\(I_{i}\)</span> and the other comes from the backward component <span class="math notranslate nohighlight">\(\mathbf{F}_{i+1}^{-}\)</span> in the right cell <span class="math notranslate nohighlight">\(I_{i+1}\)</span> .</p>
<p>The Steger and Warming splitting in a computational set up is as follows: we consider a computing cell <span class="math notranslate nohighlight">\(I_{i}\)</span> at time level <span class="math notranslate nohighlight">\(n\)</span> , where <span class="math notranslate nohighlight">\(\mathbf{U}_{i}^{n}\)</span> is the vector of conserved variables and <span class="math notranslate nohighlight">\(\mathbf{F}_{i}^{n} = \mathbf{F}(\mathbf{U}_{i}^{n})\)</span> is the vector of fluxes. The three cases to consider are illustrated in Fig.8.2 and are:</p>
<ul class="simple">
<li>Case(a) Left supersonic flow: <span class="math notranslate nohighlight">\(\lambda_{2} = u_{i}^{n} + a_{i}^{n} \le 0\)</span> . Fig.8.2a illustrates the situation in a cell <span class="math notranslate nohighlight">\(I_{i}\)</span> at time level <span class="math notranslate nohighlight">\(n\)</span> . Clearly</li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \lambda_{1}^{+} = 0 ,\quad \lambda_{1}^{-} = \lambda_{1} = u_{i}^{n}-a_{i}^{n} \\
&amp; \lambda_{2}^{+} = 0 ,\quad \lambda_{2}^{-} = \lambda_{2} = u_{i}^{n}+a_{i}^{n} \\
&amp; \mathbf{F}_{i}^{n} = \mathbf{0} ,\quad \mathbf{F}_{i}^{-}=\mathbf{F}_{i}^{n}
\end{align}\end{split}\]</div>
<ul class="simple">
<li>Case(b) Right supersonic flow: <span class="math notranslate nohighlight">\(\lambda_{1}=u_{i}^{n}-a_{1}^{n} \ge 0\)</span> . See Fig.8.2b. Obviously</li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \lambda_{1}^{+} = \lambda_{1} = u_{i}^{n}-a_{i}^{n} ,\quad \lambda_{1}^{-} = 0 \\
&amp; \lambda_{2}^{+} = \lambda_{2} = u_{i}^{n}+a_{i}^{n} ,\quad \lambda_{2}^{-} = 0 \\
&amp; \mathbf{F}_{i}^{+} = \mathbf{F}_{i}^{n} ,\quad \mathbf{F}_{i}^{n} = \mathbf{0}
\end{align}\end{split}\]</div>
<ul class="simple">
<li>Case(c) Subsonic flow: <span class="math notranslate nohighlight">\(\lambda_{1} = u_{i}^{n}-a_{i}^{n} \le 0 \le \lambda_{2} = u_{i}^{n}+a_{i}^{n}\)</span> . See Fig.8.2c. Evidently</li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \lambda_{1}^{+} = 0 ,\quad \lambda_{1}^{-} = \lambda_{1} = u_{i}^{n}-a_{i}^{n} \\
&amp; \lambda_{2}^{+} = \lambda_{2} = u_{i}^{n} + a_{i}^{n} ,\quad \lambda_{2}^{-} = 0
\end{align}\end{split}\]</div>
<p>According to the flux components expressions discussed before, the fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{i}^{+}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{i}^{n}\)</span> for the subsonic case are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}_{i}^{+} = \frac{\rho_{i}^{n}}{2}\begin{bmatrix} u_{i}^{n}+a_{i}^{n} \\ (u_{i}^{n}+a_{i}^{n})^{2} \end{bmatrix}
,\quad
\mathbf{F}_{i}^{-} = \frac{\rho_{i}^{n}}{2}\begin{bmatrix} u_{i}^{n}-a_{i}^{n} \\ (u_{i}^{n}-a_{i}^{n})^{2} \end{bmatrix}
\end{align}\end{split}\]</div>
</div>
</div>
<div class="section" id="fvs-applied-to-the-euler-equations">
<h3>FVS Applied to the Euler Equations<a class="headerlink" href="#fvs-applied-to-the-euler-equations" title="永久链接至标题">¶</a></h3>
<div class="section" id="recalling-the-equations">
<h4>Recalling the Equations<a class="headerlink" href="#recalling-the-equations" title="永久链接至标题">¶</a></h4>
<p>Here we present three Flux applied to the time dependent Euler equations. The one-dimensional Euler Equations in conservation-law form are given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} = \begin{bmatrix} \rho \\ \rho u \\ E \end{bmatrix}
,\quad
\mathbf{F}(\mathbf{U}) = \begin{bmatrix} \rho u \\ \rho u^{2} + p \\ u(E+p) \end{bmatrix}
\end{align}\end{split}\]</div>
<p>The Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{A} =
\begin{bmatrix}
0 &amp; 1 &amp; 0 \\
\frac{1}{2}(\gamma - 3)u^{2} &amp; (3-\gamma)u &amp; \gamma - 1 \\
\frac{1}{2}(\gamma - 2)u^{3}-\frac{a^{2}u}{\gamma-1} &amp; \frac{3-2\gamma}{2}u^{2}+\frac{a^{2}}{\gamma-1} &amp; \gamma u
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>and the system is hyperbolic with real eigenvalues</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} = u - a
,\quad
\lambda_{2} = u
,\quad
\lambda_{3} = u + a
\end{align}\]</div>
<p>The matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> of corresponding right eigenvectors is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K} =
\begin{bmatrix}
0 &amp; 1 &amp; 0 \\
u-a &amp; u &amp; u+a \\
H - ua &amp; \frac{1}{2}u^{2} &amp; H+ua
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(H\)</span> is the enthalpy</p>
<div class="math notranslate nohighlight">
\[\begin{align}
H = (E + p)/\rho = \frac{1}{2}u^{2} + \frac{a^{2}}{\gamma - 1}
\end{align}\]</div>
<p>The three-dimensional Euler equations may be dealt with by only considering the flux component normal to the computing cell interface. In constructing numerical methods for Cartesian geometries it is sufficient to consider the flux in any of the coordinate directions. For general geometries this is modified by use of rotation matrices. We thus state teh schemes for the x-split three dimensional Euler equations</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} = \begin{bmatrix}
\rho \\ \rho u \\ \rho v \\ \rho w \\ E
\end{bmatrix}
,\quad
\mathbf{F}(\mathbf{U}) = \begin{bmatrix}
\rho u \\ \rho u^{2} + p \\ \rho u v \\ \rho u w \\ u(E+p)
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{A} =
\begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
(\gamma-1)H-u^{2}-a^{2} &amp; (3-\gamma)u &amp; (1-\gamma)v &amp; (1-\gamma)w &amp; \gamma-1 \\
-uv &amp; v &amp; u &amp; 0 &amp; 0 \\
-uw &amp; w &amp; 0 &amp; u &amp; 0 \\
\frac{1}{2}u[(\gamma-3)H-a^{2}] &amp; H-(\gamma-1)u^{2} &amp; (1-\gamma)uv &amp; (1-\gamma)uw &amp; (\gamma-1)u
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
H = (E + p)/\rho = \frac{1}{2}\mathbf{V}^{2} + \frac{a^{2}}{\gamma-1}
,\quad
\mathbf{V}^{2} = u^{2} + v^{2} + w^{2}
\end{align}\]</div>
<p>This system is hyperbolic with real eigenvalues</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} = u-a
,\quad
\lambda_{2} = \lambda_{3} = \lambda_{4} = u
,\quad
\lambda_{5} = u+a
\end{align}\]</div>
<p>The matrix of corresponding right eigenvectors is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K} =
\begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
u-a &amp; u &amp; 0 &amp; 0 &amp; u+a \\
v &amp; v &amp; 1 &amp; 0 &amp; v \\
w &amp; w &amp; 0 &amp; 1 &amp; w \\
H-ua &amp; \frac{1}{2}\mathbf{V}^{2} &amp; v &amp; w &amp; H+ua
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The one-dimensional Euler equations satisfy the homogeneity property</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}(\mathbf{U}) = \mathbf{A}(\mathbf{U})\mathbf{U}
\end{align}\]</div>
<p>We can also verify that the split three-dimensional Euler equations also satisfy the homogeneity property.</p>
</div>
<div class="section" id="the-steger-warming-splitting">
<h4>The Steger-Warming Splitting<a class="headerlink" href="#the-steger-warming-splitting" title="永久链接至标题">¶</a></h4>
<p>For the Steger-Warming Splitting we require an expression for the inverse <span class="math notranslate nohighlight">\(\mathbf{K}^{-1}\)</span> of the matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> , in order to find the split Jacobians.</p>
<div class="section" id="the-one-dimensional-case">
<h5>The One-Dimensional Case<a class="headerlink" href="#the-one-dimensional-case" title="永久链接至标题">¶</a></h5>
<p>For the one-dimensional Euler equations we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K}^{-1} = \frac{\gamma-1}{2a^{2}}
\begin{bmatrix}
\frac{1}{2}u^{2}+\frac{ua}{\gamma-1} &amp; -u-\frac{a}{\gamma-1} &amp; 1 \\
\frac{2a^{2}}{\gamma-1}-u^{2} &amp; 2u &amp; -2 \\
\frac{1}{2}u^{2}-\frac{ua}{\gamma-1} &amp; \frac{a}{\gamma-1}-u &amp; 1
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>Then, for any component <span class="math notranslate nohighlight">\(\mathbf{\Lambda}^{\alpha}\)</span> of the two components of <span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span> , the corresponding Jacobian component is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}^{\alpha} = \mathbf{K}\mathbf{\Lambda}^{\alpha}\mathbf{K}^{-1}
\end{align}\]</div>
<p>The associated split flux component <span class="math notranslate nohighlight">\(\mathbf{F}^{\alpha} = \mathbf{A}^{\alpha}\mathbf{U}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{\alpha} = \frac{\rho}{2\gamma}
\begin{bmatrix}
\lambda_{1}^{\alpha} + 2(\gamma-1)\lambda_{2}^{\alpha} + \lambda_{3}^{\alpha} \\
(u-a)\lambda_{1}^{\alpha} + 2(\gamma - 1)u \lambda_{2}^{\alpha} + (u+a)\lambda_{3}^{\alpha} \\
(H-ua)\lambda_{1}^{\alpha} + (\gamma-1)u^{2}\lambda_{2}^{\alpha} + (H+ua)\lambda_{3}^{\alpha}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>where the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{k}^{\alpha}\)</span> are given by <span class="math notranslate nohighlight">\(\lambda_{i}^{+}=\frac{1}{2}(\lambda_{i}+|\lambda_{i}|), \lambda_{i}^{-}=\frac{1}{2}(\lambda_{i}-|\lambda_{i}|)\)</span> , for <span class="math notranslate nohighlight">\(\alpha = +,-\)</span> .</p>
</div>
<div class="section" id="the-three-dimensional-case">
<h5>The Three-Dimensional Case<a class="headerlink" href="#the-three-dimensional-case" title="永久链接至标题">¶</a></h5>
<p>For the three-dimensional case we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K}^{-1} = \frac{\gamma-1}{2a^{2}}
\begin{bmatrix}
H + \frac{a}{\gamma-1}(u-a) &amp; -(u+\frac{a}{\gamma-1}) &amp; -v &amp; -w &amp; 1 \\
-2H + \frac{4}{\gamma-1}a^{2} &amp; 2u &amp; 2v &amp; 2w &amp; -2 \\
-\frac{2va^{2}}{\gamma-1} &amp; 0 &amp; \frac{2a^{2}}{\gamma-1} &amp; 0 &amp; 0 \\
-\frac{2wa^{2}}{\gamma-1} &amp; 0 &amp; 0 &amp; \frac{2a^{2}}{\gamma-1} &amp; 0 \\
H-\frac{a}{\gamma-1}(u+a) &amp; -u+\frac{a}{\gamma-1} &amp; -v &amp; -w &amp; 1
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>and the resulting split flux component <span class="math notranslate nohighlight">\(\mathbf{F}^{\alpha} = \mathbf{A}^{\alpha}\mathbf{U}\)</span> is found to be</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{\alpha} = \frac{\rho}{2\gamma}
\begin{bmatrix}
\lambda_{1}^{\alpha} + 2(\gamma-1)\lambda_{2}^{\alpha} + \lambda_{5}^{\alpha} \\
(u-a)\lambda_{1}^{\alpha} + 2(\gamma-1)u\lambda_{2}^{\alpha} + (u+a)\lambda_{5}^{\alpha} \\
v\lambda_{1}^{\alpha} + 2(\gamma-1)v\lambda_{2}^{\alpha} + v\lambda_{5}^{\alpha} \\
w\lambda_{1}^{\alpha} + 2(\gamma-1)w\lambda_{2}^{\alpha} + w\lambda_{5}^{\alpha} \\
(H-ua)\lambda_{1}^{\alpha} + (\gamma-1)\mathbf{V}^{2}\lambda_{2}^{\alpha} + (H+ua)\lambda_{5}^{\alpha}
\end{bmatrix}
\end{align}\end{split}\]</div>
</div>
</div>
<div class="section" id="the-van-leer-splitting">
<h4>The van Leer Splitting<a class="headerlink" href="#the-van-leer-splitting" title="永久链接至标题">¶</a></h4>
<p>Van Leer constructed a splitting for the Euler equations that has some extra desirable properties, namely</p>
<ul class="simple">
<li>The split Jacobian matrices</li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\mathbf{A}}^{+} = \frac{\partial \mathbf{F}^{+}}{\partial \mathbf{U}}
,\quad
\hat{\mathbf{A}}^{-} = \frac{\partial \mathbf{F}^{-}}{\partial \mathbf{U}}
\end{align}\]</div>
<p>are required to be continuous.</p>
<ul class="simple">
<li>The split fluxes are degenerate for subsonic flow, that is <span class="math notranslate nohighlight">\(\hat{\mathbf{A}}^{+},\hat{\mathbf{A}}^{-}\)</span> have a zero eigenvalue.</li>
</ul>
<p>Van Leer expresses the flux vector <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> as a function of density, sound speed and Mach number <span class="math notranslate nohighlight">\(M = \frac{u}{a}\)</span> , that is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F} = \mathbf{F}(\rho,a,M) =
\begin{bmatrix}
\rho a M \\
\rho a^{2}(M^{2} + \frac{1}{\gamma}) \\
\rho a^{3}M(\frac{1}{2}M^{2} + \frac{1}{\gamma-1})
\end{bmatrix}
=: \begin{bmatrix}
f_{mas} \\
f_{mom} \\
f_{ene}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>For the mass flux <span class="math notranslate nohighlight">\(f_{mas}=\rho aM\)</span> , one requires quadratics in <span class="math notranslate nohighlight">\(M\)</span> and the split mass fluxes are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{mas}^{+} = \frac{1}{4}\rho a(1+M)^{2}
,\quad
f_{mas}^{-} = -\frac{1}{4}\rho a(1-M)^{2}
\end{align}\]</div>
<p>The momentum split fluxes are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{mom}^{+} = f_{mas}^{+}\frac{2a}{\gamma}\Big[ \frac{\gamma-1}{2}M + 1 \Big]
,\quad
f_{mom}^{-} = f_{mas}^{-}\frac{2a}{\gamma}\Big[ \frac{\gamma-1}{2}M - 1 \Big]
\end{align}\]</div>
<p>and the energy split fluxes are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{ene}^{+} = \frac{\gamma^{2}}{2(\gamma^{2}-1)}\frac{[f_{mom}^{+}]^{2}}{f_{mas}^{+}}
,\quad
f_{ene}^{-} = \frac{\gamma^{2}}{2(\gamma^{2}-1)}\frac{[f_{mom}^{-}]^{2}}{f_{mas}^{-}}
\end{align}\]</div>
<p>In vector form we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{+} = \frac{1}{4}\rho a (1+M)^{2}
\begin{bmatrix}
1 \\
\frac{2a}{\gamma}(\frac{\gamma-1}{2}M + 1) \\
\frac{2a^{2}}{\gamma^{2}-1}(\frac{\gamma-1}{2}M + 1)^{2}
\end{bmatrix}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{-} = -\frac{1}{4}\rho a (1-M)^{2}
\begin{bmatrix}
1 \\
\frac{2a}{\gamma}(\frac{\gamma-1}{2}M - 1) \\
\frac{2a^{2}}{\gamma^{2}-1}(\frac{\gamma-1}{2}M - 1)^{2}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>For the x-split three dimensional Euler equations the split flux formulae are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{+} = \frac{1}{4}\rho a (1 + M)^{2}
\begin{bmatrix}
1 \\
\frac{2a}{\gamma}(\frac{\gamma-1}{2}M + 1) \\
v \\
w \\
\frac{2a^{2}}{\gamma^{2}-1}(\frac{\gamma-1}{2}M + 1)^{2} + \frac{1}{2}(v^{2} + w^{2})
\end{bmatrix}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{-} = -\frac{1}{4}\rho a (1 - M)^{2}
\begin{bmatrix}
1 \\
\frac{2a}{\gamma}(\frac{\gamma-1}{2}M - 1) \\
v \\
w \\
\frac{2a^{2}}{\gamma^{2}-1}(\frac{\gamma-1}{2}M - 1)^{2} + \frac{1}{2}(v^{2} + w^{2})
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>where the Mach number is still <span class="math notranslate nohighlight">\(M=\frac{u}{a}\)</span> .</p>
<p>Concerning stability, van Leer gives the following practical stability condition</p>
<div class="math notranslate nohighlight">
\[\begin{align}
C_{cfl} := \frac{\Delta t}{\Delta x}(|u| + a) \le \frac{2\gamma + |M|(3-\gamma)}{\gamma+3}
\end{align}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(C_{cfl}=C_{cfl}(M)\)</span> and that when <span class="math notranslate nohighlight">\(\gamma=1.4\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
C_{cfl}^{\max} = 1 \quad\text{for}\quad |M|=1
,\qquad
C_{cfl}^{\min} = \frac{2\gamma}{\gamma+3}\approx 0.636... \quad\text{for}\quad |M|=0
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The CFL condition for the explicit FVS scheme is more restrictive than that for the Godunov method, for which <span class="math notranslate nohighlight">\(C_{cfl}\)</span> is close to unity.</p>
</div>
</div>
<div class="section" id="advection-upstream-splitting-method-ausm">
<h4>Advection Upstream Splitting Method (AUSM)<a class="headerlink" href="#advection-upstream-splitting-method-ausm" title="永久链接至标题">¶</a></h4>
<p>A recent scheme that attempts to combine features from the Flux Vector Splitting and Godunov approaches is due to Liou and Steffen. The scheme has been formulated in terms of the time-dependent Euler equations and relies on splitting the flux vector <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> into a convective component <span class="math notranslate nohighlight">\(\mathbf{F}^{(c)}\)</span> and a pressure component <span class="math notranslate nohighlight">\(\mathbf{F}^{(p)}\)</span> . For the x-split three dimensional flux we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}(\mathbf{U}) =
\begin{bmatrix}
\rho u \\
\rho u^{2} + p \\
\rho u v \\
\rho u w \\
u(E + p)
\end{bmatrix}
=
\begin{bmatrix}
\rho u \\ \rho u^{2} \\ \rho u v \\ \rho u w \\ \rho u H
\end{bmatrix}
+
\begin{bmatrix}
0 \\ p \\ 0 \\ 0 \\ 0
\end{bmatrix}
=: \mathbf{F}^{(c)} + \mathbf{F}^{(p)}
\end{align}\end{split}\]</div>
<p>with the obvious definitions for the convective component <span class="math notranslate nohighlight">\(\mathbf{F}^{(c)}\)</span> and the pressure component <span class="math notranslate nohighlight">\(\mathbf{F}^{(p)}\)</span> . By introducing the Mach number and enthalpy</p>
<div class="math notranslate nohighlight">
\[\begin{align}
M = \frac{u}{a}
,\quad
H = \frac{E + p}{\rho}
\end{align}\]</div>
<p>we write</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{(c)} = M \begin{bmatrix} \rho a \\ \rho au \\ \rho av \\ \rho aw \\ \rho aH \end{bmatrix}
=: M \hat{\mathbf{F}}^{(c)}
\end{align}\end{split}\]</div>
<p>with the obvious notation for the vector <span class="math notranslate nohighlight">\(\hat{\mathbf{F}}^{(c)}\)</span> . In defining the intercell numerical flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> , Liou and Steffen take</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{i+\frac{1}{2}}^{(c)} + \mathbf{F}_{i+\frac{1}{2}}^{(p)}
\end{align}\]</div>
<p>where the convective flux component is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}}^{(c)} = M_{i+\frac{1}{2}}\Big[ \hat{\mathbf{F}}^{(c)} \Big]_{i+\frac{1}{2}}
\end{align}\]</div>
<p>with definition</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
[\cdot]_{i+\frac{1}{2}} = \left\{ \begin{array}{ll}
[\cdot]_{i} \quad \text{if}~M_{i+\frac{1}{2}} \ge 0 \\
[\cdot]_{i+1} \quad \text{if}~M_{i+\frac{1}{2}} \le 0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>Note that the flux vector is upwinded according to the sign of the convection, or advection, speed implied in the intercell Mach number <span class="math notranslate nohighlight">\(M_{i+\frac{1}{2}}\)</span> . For this reason Liou and Steffen call their scheme AUSM, which stands for Advection Upstream Splitting Method.</p>
<p>The cell-interface Mach number is given by the splitting</p>
<div class="math notranslate nohighlight">
\[\begin{align}
M_{i+\frac{1}{2}} = M_{i}^{+} + M_{i+1}^{-}
\end{align}\]</div>
<p>with the positive and negative components yet to be defined. The splitting of the pressure flux component depends on the splitting of the pressure itself, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{i+\frac{1}{2}} = p_{i}^{+} + p_{i+1}^{-}
\end{align}\]</div>
<p>For the splitting of the Mach number Liou and Steffen follow van Leer and set</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
M^{\pm} = \left\{ \begin{array}{ll}
\pm \frac{1}{4}(M \pm 1)^{2} \quad \text{if}~|M|\le 1 \\
\frac{1}{2}(M \pm |M|) \quad \text{if}~|M| &gt; 1
\end{array} \right.
\end{align}\end{split}\]</div>
<p>For splitting the pressure they suggest two choices, namely</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
p^{\pm} = \left\{ \begin{array}{ll}
\frac{1}{2}p(1 \pm M) \quad \text{if}~|M| \le 1 \\
\frac{1}{2}p\frac{M \pm |M|}{M} \quad \text{if}~|M| &gt; 1
\end{array} \right.
\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
p^{\pm} = \left\{ \begin{array}{ll}
\frac{1}{4}p(M \pm 1)^{2}(2 \mp M) \quad \text{if}~|M|\le 1 \\
\frac{1}{2}p\frac{(M \pm |M|)}{M} \quad \text{if}~|M| &gt; 1
\end{array} \right.
\end{align}\end{split}\]</div>
</div>
</div>
</div>
<div class="section" id="approximate-state-riemann-solvers">
<h2>Approximate-State Riemann Solvers<a class="headerlink" href="#approximate-state-riemann-solvers" title="永久链接至标题">¶</a></h2>
<p>The method of Godunov and its high-order extensions require the solution of the Riemann problem. In a practical computation this is solved billions of times, making the Riemann problem solution process the single most demanding task in the numerical method. An iterative procedure is always involved and the associated computational effort may not always be justified. This effort may increase dramatically by equations of state of complicated algebraic form or by the complexity of the particular system of equations being solved, or both. Approximate, non-iterative solutions have the potential to provide the necessary items of information for numerical purposes. There are essentially two ways of extracting approximate information from the solution of the Riemann problem to be used in Godunov-type methods:</p>
<ul class="simple">
<li>One is to find an approximation to the numerical flux employed in the numerical method directly.</li>
<li>The other approach is to find an approximation to a state and then evaluate the physical flux function at this state.</li>
</ul>
<p>We present, approximate, Riemann solvers that do not need an iteration process. We provide an approximate solution for the state required to evaluate the Godunov flux. The approximations can be used directly in the first-order Godunov method and its high-order extensions. Some of the approximations presented are exceedingly simple but not accurate enough to produce robust numerical methods. This difficulty is resolved by designing hybrid schemes that combine various approximate solvers in and adaptive fashion.</p>
<div class="section" id="the-riemann-problem-and-the-godunov-flux">
<h3>The Riemann Problem and the Godunov Flux<a class="headerlink" href="#the-riemann-problem-and-the-godunov-flux" title="永久链接至标题">¶</a></h3>
<p>We want to solve numerically the general Initial Boundary Value Problem (IBVP)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} = \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \mathbf{U}^{(0)}(x) \\
&amp; \mathbf{U}(0,t) = \mathbf{U}_{l}(t) ,\quad \mathbf{U}(L,t)=\mathbf{U}_{r}(t)
\end{align}\end{split}\]</div>
<p>utilising the explicit conservative formula</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} + \frac{\Delta t}{\Delta x}[\mathbf{F}_{i-\frac{1}{2}} - \mathbf{F}_{i+\frac{1}{2}}]
\end{align}\]</div>
<p>along with the Godunov intercell numerical flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{i+\frac{1}{2}}(0))
\end{align}\]</div>
<p>We assume that the solution of IBVP exists. Here <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0)\)</span> is the similarity solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> of the Riemann problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \left\{ \begin{array}{ll}
\mathbf{U}_{L} \quad \text{if}~x&lt;0 \\
\mathbf{U}_{R} \quad \text{if}~x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>evaluated at <span class="math notranslate nohighlight">\(x/t=0\)</span> . Fig.9.1 shows the structure of the exact solution of the Riemann problem for the x-split three-dimensional Euler equations, for which the vectors of conserved variables and fluxes are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} =
\begin{bmatrix}
\rho \\ \rho u \\ \rho v \\ \rho w \\ E
\end{bmatrix}
,\quad
\mathbf{F} =
\begin{bmatrix}
\rho u \\ \rho u^{2}+p \\ \rho uv \\ \rho u w \\ u(E+p)
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The value <span class="math notranslate nohighlight">\(x/t=0\)</span> for the Godunov flux corresponds to the t-axis. The piece-wise constant initial data, in terms of primitive variables, is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{W}_{L} =
\begin{bmatrix}
\rho_{L} \\ u_{L} \\ v_{L} \\ w_{L} \\ p_{L}
\end{bmatrix}
,\quad
\mathbf{W}_{R} =
\begin{bmatrix}
\rho_{R} \\ u_{R} \\ v_{R} \\ w_{R} \\ p_{R}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The purpose of this chapter is to find approximate solutions to the Riemann problem in order to evaluate the Godunov flux. The evaluation of the flux requires the identification of the appropriate wave pattern in the Riemann problem solution; as depicted in Fig.9.2, there are ten possibilities to be considered.</p>
<p>In our solution procedure we split the task of solving the complete Riemann problem into three subproblems, namely</p>
<ul class="simple">
<li>The star values <span class="math notranslate nohighlight">\(p_{*},u_{*},\rho_{*L},\rho_{*R}\)</span> in the Star Region between the non-linear waves.</li>
<li>The solution for the tangential velocity components <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(w\)</span> throughout the wave structure.</li>
<li>The solution for <span class="math notranslate nohighlight">\(\rho, u, p\)</span> inside rarefactions.</li>
</ul>
<div class="section" id="tangential-velocity-components">
<h4>Tangential Velocity Components<a class="headerlink" href="#tangential-velocity-components" title="永久链接至标题">¶</a></h4>
<p>Recall that in the exact solution, the values of the tangential velocity components <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(w\)</span> do not change across the non-linear waves but do change, discontinuously, across the middle wave. Thus, given an approximate solution <span class="math notranslate nohighlight">\(u_{*}\)</span> for the normal velocity component in the Star Region, the solution for the tangential velocity components <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(w\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
v(x,t), w(x,t) = \left\{ \begin{array}{ll}
v_{L}, w_{L} \quad \text{if}~x/t \le u_{*} \\
v_{R}, w_{R} \quad \text{if}~x/t &gt; u_{*}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>In this way, the solution for the tangential velocity components is, in a sense, exact; the only approximation being that for <span class="math notranslate nohighlight">\(u_{*}\)</span> . As a matter of fact, any passive scalar quantity <span class="math notranslate nohighlight">\(q(x,y,z,t)\)</span> advected with the fluid will have this property. In the study of multi-component flow, this quantity could be a species concentration; in practical applications there can be many of such quantities. Hence, it is very important that the approximate solution of the Riemann problem preserves the correct behaviour.</p>
</div>
<div class="section" id="sonic-rarefactions">
<h4>Sonic Rarefactions<a class="headerlink" href="#sonic-rarefactions" title="永久链接至标题">¶</a></h4>
<p>Assuming the solution for the star values is available, we then need to identify the correct values along the t-axis, in order to evaluate the Godunov flux. The cases (a1) to (a4) and (b1) to (b4) of Fig.9.2 can be dealt with once solutions for star values and tangential velocity are available. The sonic flow cases (a5) and (b5) must be treated separately. For these two cases we recommend the use of the exact solution, which is non-iterative.</p>
<p>The solution along the t-axis inside a left sonic rarefaction is obtained by setting <span class="math notranslate nohighlight">\(x/t=0\)</span> im</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{W}_{Lfan} = \left\{ \begin{array}{ll}
\rho = \rho_{L}\Big[ \frac{2}{\gamma+1} + \frac{\gamma-1}{(\gamma+1)a_{L}}(u_{L} - \frac{x}{t}) \Big]^{\frac{2}{\gamma-1}} \\
u = \frac{2}{\gamma + 1}\Big[ a_{L} + \frac{\gamma-1}{2}u_{L} + \frac{x}{t} \Big] \\
p = p_{L}\Big[ \frac{2}{\gamma + 1} + \frac{\gamma-1}{(\gamma+1)a_{L}} (u_{L} - \frac{x}{t}) \Big]^{\frac{2\gamma}{\gamma-1}}
\end{array}\right.
\end{align}\end{split}\]</div>
<p>The solution along the t-axis inside a right sonic rarefaction is obtained by setting <span class="math notranslate nohighlight">\(x/t = 0\)</span> in</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{W}_{Rfan} = \left\{ \begin{array}{ll}
\rho = \rho_{R}\Big[ \frac{2}{\gamma+1} - \frac{\gamma-1}{(\gamma+1)a_{R}}(u_{R} - \frac{x}{t}) \Big]^{\frac{2}{\gamma-1}} \\
u = \frac{2}{\gamma + 1}\Big[ -a_{R} + \frac{\gamma-1}{2}u_{R} + \frac{x}{t} \Big] \\
p = p_{R}\Big[ \frac{2}{\gamma + 1} + \frac{\gamma-1}{(\gamma+1)a_{R}} (u_{R} - \frac{x}{t}) \Big]^{\frac{2\gamma}{\gamma-1}}
\end{array}\right.
\end{align}\end{split}\]</div>
<p>The rest of this chapter is devoted to providing approximate solutions for the star values. We study four approaches as well as two adaptive schemes that combine various approximations.</p>
</div>
</div>
<div class="section" id="primitive-variable-riemann-solvers-pvrs">
<h3>Primitive Variable Riemann Solvers (PVRS)<a class="headerlink" href="#primitive-variable-riemann-solvers-pvrs" title="永久链接至标题">¶</a></h3>
<p>A very simple linearised solution to the Riemann problem for the x-split, three dimensional time dependent Euler equations can be obtained in terms of the primitive variables <span class="math notranslate nohighlight">\(\rho, u, v, w, p\)</span> . The corresponding governing equations are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{W}_{t} + \mathbf{A}(\mathbf{W})\mathbf{W}_{x} = \mathbf{0}
\end{align}\]</div>
<p>where the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}(\mathbf{W})\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{A} =
\begin{bmatrix}
u &amp; \rho &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; u &amp; 0 &amp; 0 &amp; 1/\rho \\
0 &amp; 0 &amp; u &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; u &amp; 0 \\
0 &amp; \rho a^{2} &amp; 0 &amp; 0 &amp; u
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The eigenvalues of <span class="math notranslate nohighlight">\(\mathbf{A}(\mathbf{W})\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} = u - a
,\quad
\lambda_{2} = \lambda_{3} = \lambda_{4} = u
,\quad
\lambda_{5} = u + a
\end{align}\]</div>
<p>and the matrix of corresponding right eigenvectors is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K} =
\begin{bmatrix}
\rho &amp; 1 &amp; \rho &amp; \rho &amp; \rho \\
-a &amp; 0 &amp; 0 &amp; 0 &amp; a \\
0 &amp; v &amp; 1 &amp; v &amp; 0 \\
0 &amp; w &amp; w &amp; 1 &amp; 0 \\
\rho a^{2} &amp; 0 &amp; 0 &amp; 0 &amp; \rho a^{2}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The difficulty in solving is due to the fact that the coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{A}(\mathbf{W})\)</span> depends on the solution vector <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> itself. If <span class="math notranslate nohighlight">\(\mathbf{A}(\mathbf{W})\)</span> were to be constant, then we could apply the various techniques for solving linear hyperbolic systems with constant coefficients.</p>
<p>Assume that the initial data <span class="math notranslate nohighlight">\(\mathbf{W}_{L}, \mathbf{W}_{R}\)</span> and the solution <span class="math notranslate nohighlight">\(\mathbf{W}(x/t)\)</span> are close to a constant state <span class="math notranslate nohighlight">\(\bar{\mathbf{W}}\)</span> . Then, by setting</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{\mathbf{A}} \equiv \mathbf{A}(\bar{\mathbf{W}})
\end{align}\]</div>
<p>we approximate the Riemann problem for <span class="math notranslate nohighlight">\(\mathbf{W}_{t} + \mathbf{A}(\mathbf{W})\mathbf{W}_{x} = \mathbf{0}\)</span> by the Riemann problem for the linear hyperbolic systems with constant coefficients</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{W}_{t} + \bar{\mathbf{A}}\mathbf{W}_{x} = \mathbf{0}
\end{align}\]</div>
<p>We now solve this approximate problem, with initial data <span class="math notranslate nohighlight">\(\mathbf{W}_{L},\mathbf{W}_{R}\)</span> , exactly. We have studied various techniques that are directly applicable to this problem. One possibility is to apply Rankine-Hugoniot Conditions across each wave of speed <span class="math notranslate nohighlight">\(\bar{\lambda}_{i}\)</span> . Thus we treat <span class="math notranslate nohighlight">\(\mathbf{W}_{t} + \bar{\mathbf{A}}\mathbf{W}_{x} = \mathbf{0}\)</span> as the system in conservative form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{W}_{t} + \mathbf{F}(\mathbf{W})_{x} = \mathbf{0}
,\quad
\mathbf{F}(\mathbf{W}) \equiv \bar{\mathbf{A}}\mathbf{W}
\end{align}\]</div>
<p>Then, across a wave of speed <span class="math notranslate nohighlight">\(\bar{\lambda}_{i}\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta \mathbf{F} \equiv \bar{\mathbf{A}} \Delta\mathbf{W} = \bar{\lambda_{i}}\Delta \mathbf{W}
\end{align}\]</div>
<p>Direct application of it to the <span class="math notranslate nohighlight">\(\bar{\lambda}_{1}\)</span> and <span class="math notranslate nohighlight">\(\bar{\lambda}_{5}\)</span> waves gives four useful relations, namely</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; (u_{*} - u_{L})\bar{\rho} + \bar{a} (\rho_{*L} - \rho_{L}) = 0 \\
&amp; (\rho_{*} - \rho_{L})/\bar{\rho} + \bar{a} (u_{*} - u_{L}) = 0 \\
&amp; (u_{R} - u_{*})/\bar{\rho} - \bar{a}(\rho_{R} - \rho_{*R}) = 0 \\
&amp; (p_{R} - p_{*})/\bar{\rho} - \bar{a}(u_{R} - u_{*}) = 0
\end{align}\end{split}\]</div>
<p>The complete solution for the unknowns is then given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; p_{*} = \frac{1}{2}(p_{L} + p_{R}) + \frac{1}{2}(u_{L} - u_{R}) (\bar{p}\bar{a}) \\
&amp; u_{*} = \frac{1}{2}(u_{L} + u_{R}) + \frac{1}{2}(p_{L} - p_{R})/(\bar{\rho}\bar{a}) \\
&amp; \rho_{*L} = \rho_{L} + (u_{L} - u_{*})(\bar{\rho}/\bar{a}) \\
&amp; \rho_{*R} = \rho_{R} + (u_{*} - u_{R})(\bar{\rho}/\bar{a})
\end{align}\end{split}\]</div>
<p>Notice that in this linearised solution we only need to specify constant values for <span class="math notranslate nohighlight">\(\bar{\rho}\)</span> and <span class="math notranslate nohighlight">\(\bar{a}\)</span> . There is some freedom in making the choice. Selecting some average of the data values <span class="math notranslate nohighlight">\(\rho_{L}, \rho_{R}, a_{L}, a_{R}\)</span> appears sensible. The choice may be constrained to satisfy some desirable properties of the Riemann problem solution, such as exact recognition of particular flow features. Here we suggest to select the simple arithmetic means</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{\rho} = \frac{1}{2}(\rho_{L} + \rho_{R})
,\quad
\bar{a} = \frac{1}{2}(a_{L} + a_{R})
\end{align}\]</div>
<p>Note that if the data states <span class="math notranslate nohighlight">\(\mathbf{W}_{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{W}_{R}\)</span> are connected by a single isolated contact discontinuity or shear wave, then the solution is actually exact, regardless of the particular choice for the averages <span class="math notranslate nohighlight">\(\bar{\rho}\)</span> and <span class="math notranslate nohighlight">\(\bar{a}\)</span> . This is in fact a very important property; contacts and shear waves turn out to be some of the most challenging flow features to resolve correctly by any numerical method.</p>
<p>Another way of obtaining approximate solutions for the star values is to use the characteristic equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathrm{d}p - \rho a \mathrm{d}u = 0 \quad \text{along}~\mathrm{d}x/\mathrm{d}t = u - a \\
&amp; \mathrm{d}p - a^{2}\mathrm{d}\rho = 0 \quad \text{along}~\mathrm{d}x/\mathrm{d}t = u \\
&amp; \mathrm{d}p + \rho a \mathrm{d}u = 0 \quad \text{along}~\mathrm{d}x/\mathrm{d}t = u + a
\end{align}\end{split}\]</div>
<p>These differential relations hold true along characteristic directions. First we set</p>
<div class="math notranslate nohighlight">
\[\begin{align}
C = \rho a
\end{align}\]</div>
<p>Then, in order to find the star values we connect the state <span class="math notranslate nohighlight">\(\mathbf{W}_{*L}\)</span> to the data state <span class="math notranslate nohighlight">\(\mathbf{W}_{L}\)</span> , see Fig.9.1, by integrating the third characteristic equation along the characteristic of speed <span class="math notranslate nohighlight">\(u+a\)</span> , where <span class="math notranslate nohighlight">\(C\)</span> is evaluated at the foot of the characteristic. See Fig.9.3 The results is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{*} + C_{L}u_{*} = p_{L} + C_{L}u_{L}
\end{align}\]</div>
<p>Similarly, we connect <span class="math notranslate nohighlight">\(\mathbf{W}_{*R}\)</span> to the data state <span class="math notranslate nohighlight">\(\mathbf{W}_{R}\)</span> by integrating first characteristic equation along the characteristic of speed <span class="math notranslate nohighlight">\(u-a\)</span> , with <span class="math notranslate nohighlight">\(C\)</span> is evaluated at the foot of the characteristic. We obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{*} - C_{R}u_{*} = p_{R} - C_{R}u_{R}
\end{align}\]</div>
<p>The values <span class="math notranslate nohighlight">\(\rho_{*L}\)</span> and <span class="math notranslate nohighlight">\(\rho_{*R}\)</span> are obtained by connecting <span class="math notranslate nohighlight">\(\mathbf{W}_{*L}\)</span> to <span class="math notranslate nohighlight">\(\mathbf{W}_{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{W}_{*R}\)</span> to <span class="math notranslate nohighlight">\(\mathbf{W}_{R}\)</span> via the second characteristic equation. The complete solution is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; p_{*} = \frac{1}{C_{L} + C_{R}}\Big[ C_{R}p_{L} + C_{L}p_{R} + C_{L}C_{R}(u_{L} - u_{R}) \Big] \\
&amp; u_{*} = \frac{1}{C_{L} + C_{R}}\Big[ C_{L}u_{L} + C_{R}u_{R} + (p_{L} - p_{R}) \Big] \\
&amp; \rho_{*L} = \rho_{L} + (p_{*} - p_{L})/a_{L}^{2} \\
&amp; \rho_{*R} = \rho_{R} + (p_{*} - p_{R})/a_{R}^{2}
\end{align}\end{split}\]</div>
<p>In this approximation we do not need to make a choice for the averages <span class="math notranslate nohighlight">\(\bar{\rho}\)</span> and <span class="math notranslate nohighlight">\(\bar{a}\)</span> ; their values are replaced by data values at the foot of the corresponding characteristics. If <span class="math notranslate nohighlight">\(C_{L} = C_{R} = \bar{\rho}\bar{a}\)</span> , then the two approximations are identical.</p>
<p>The two linearised approximations for the star values are exceedingly simple and may be useful in a variety of ways. The approaches might prove very useful in solving the Riemann problem for complicated sets of equations.</p>
<p>We have now given the complete approximation solution to the sub-problems. In order to evaluate the Godunov flux we need to sample the solution to find the value <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(0)\)</span> along the t-axis. This sampling procedure is virtually identical, although simpler, to the sampling procedure for the exact Riemann problem solution. The reader is made aware that the numerical schemes associated with the simple linearised solutions just derived may not be robust enough to be used with absolute confidence under all flow condtions. We will study hybrid Riemann solvers, which combine simple and sophisticated solvers to provide schemes that have effectively the computational cost of the simplest Riemann solvers and the robustness of the sophisticated Riemann solvers.</p>
</div>
<div class="section" id="approximations-based-on-the-exact-solver">
<h3>Approximations Based on the Exact Solver<a class="headerlink" href="#approximations-based-on-the-exact-solver" title="永久链接至标题">¶</a></h3>
<p>We have presented an exact Riemann solver based on the pressure equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f(p) \equiv f_{L}(p, \mathbf{W}_{L}) + f_{R}(p, \mathbf{W}_{R}) + \Delta u = 0
,\quad
\Delta u = u_{R} - u_{L}
\end{align}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
f_{K}(p) = \left\{ \begin{array}{l}
(p - p_{K})\Big[ \frac{A_{K}}{p + B_{K}} \Big]^{\frac{1}{2}} \quad \text{if}~ p&gt;p_{K}~(\text{shock}) \\
\frac{2a_{K}}{\gamma-1}\Big[ \Big(\frac{p}{p_{K}}\Big)^{z} - 1 \Big] \quad \text{if}~ p \le p_{K} ~(\text{rarefaction})
\end{array} \right.
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
z = \frac{\gamma - 1}{2\gamma}
,\quad
A_{K} = \frac{2}{(\gamma+1)\rho_{K}}
,\quad
B_{K} = \Big( \frac{\gamma - 1}{\gamma + 1} \Big)p_{K}
,\quad
K = L,R
\end{align}\]</div>
<p>Various approximations based on <span class="math notranslate nohighlight">\(f(p) = 0\)</span> can be obtained, including curve-fitting procedures. Here we give approximations based on the rarefaction and shock branches of <span class="math notranslate nohighlight">\(f(p)\)</span> .</p>
<div class="section" id="a-two-rarefaction-riemann-solver-trrs">
<h4>A Two-Rarefaction Riemann Solver (TRRS)<a class="headerlink" href="#a-two-rarefaction-riemann-solver-trrs" title="永久链接至标题">¶</a></h4>
<p>Recall that the non-linear waves in the Riemann problem solution are either shock or rarefaction waves and finding their type is part of the solution procedure. If one assumes <span class="math notranslate nohighlight">\(a\)</span> -priori that both non-linear waves are rarefactions then, with the appropriate choice of <span class="math notranslate nohighlight">\(f_{L}\)</span> and <span class="math notranslate nohighlight">\(f_{R}\)</span> above, becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{2a_{L}}{\gamma - 1} \Big[ \Big( \frac{p}{p_{L}} \Big)^{2} - 1 \Big]
+ \frac{2a_{R}}{\gamma - 1} \Big[ \Big( \frac{p}{p_{R}} \Big)^{2} - 1 \Big]
+ u_{R} - u_{L} = 0
\end{align}\]</div>
<p>Solving this equation for pressure <span class="math notranslate nohighlight">\(p_{*}\)</span> gives the approximation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{*} = \bigg[ \frac{a_{L} + a_{R} - \frac{\gamma-1}{2}(u_{R} - u_{L})}{a_{L}/p_{L}^{z} + a_{R}/p_{R}^{z}} \bigg]^{\frac{1}{z}}
\end{align}\]</div>
<p>Having found <span class="math notranslate nohighlight">\(p_{*}\)</span> one can obtain the particle velocity <span class="math notranslate nohighlight">\(u_{*}\)</span> from any of the rarefaction wave relations</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{*} = u_{L} - \frac{2a_{L}}{\gamma - 1}\Big[ \Big(\frac{p_{*}}{p_{L}}\Big)^{z} - 1 \Big]
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{*} = u_{R} + \frac{2a_{R}}{\gamma - 1}\Big[ \Big(\frac{p_{*}}{p_{R}}\Big)^{z} - 1 \Big]
\end{align}\]</div>
<p>Alternatively, one can eliminate <span class="math notranslate nohighlight">\(\rho_{*}\)</span> from the above relations to obtain a closed-form solution for the particle velocity</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{*} = \frac{P_{LR}u_{L}/a_{L} + u_{R}a_{R} + 2(P_{LR} - 1)/(\gamma-1)}{P_{LR}/a_{L} + 1/a_{R}}
,\quad
P_{LR} = \Big(\frac{p_{L}}{p_{R}}\Big)^{2}
\end{align}\]</div>
<p>Computing <span class="math notranslate nohighlight">\(p_{*}\)</span> from the approximation expression requires the evaluation of 3 fractional powers. A more efficient approach is to calculate <span class="math notranslate nohighlight">\(u_{*}\)</span> from the above equation, which only requires one fractional power, and then evaluate <span class="math notranslate nohighlight">\(p_{*}\)</span> from one of the two rarefaction wave relations, or from a mean value as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{*} = \frac{1}{2}\bigg\{ p_{L} \Big[ 1 + \frac{\gamma-1}{2a_{L}}(u_{L} - u_{*}) \Big]^{\frac{1}{z}} + p_{R}\Big[ 1 + \frac{\gamma-1}{2a_{R}}(u_{*} - u_{R}) \Big]^{\frac{1}{z}} \bigg\}
\end{align}\]</div>
<p>Being consistent with the assumption that the two nonlinear waves are rarefaction waves, the computation of the densities <span class="math notranslate nohighlight">\(\rho_{*L}\)</span> and <span class="math notranslate nohighlight">\(\rho_{*R}\)</span> on either side of the contact discontinuity is obtained from the isentropic law. The result is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{*L} = \rho_{L} \Big( \frac{p_{*}}{p_{L}} \Big)^{\frac{1}{\gamma}}
,\quad
\rho_{*R} = \rho_{R} \Big( \frac{p_{*}}{p_{R}} \Big)^{\frac{1}{\gamma}}
\end{align}\]</div>
<p>An improved version of the two-rarefaction solution is obtained by using exact relations, for given <span class="math notranslate nohighlight">\(p_{*}\)</span> or <span class="math notranslate nohighlight">\(u_{*}\)</span> . For instance, suppose <span class="math notranslate nohighlight">\(p_{*}\)</span> is given by approximation say, then <span class="math notranslate nohighlight">\(u_{*}\)</span> can be found from</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{*} = \frac{1}{2}(u_{L} + u_{R}) + \frac{1}{2}[f_{R}(p_{*}) - f_{L}(p_{*})]
\end{align}\]</div>
<p>where the functions <span class="math notranslate nohighlight">\(f_{L}\)</span> and <span class="math notranslate nohighlight">\(f_{R}\)</span> are evaluated according to the exact relations <span class="math notranslate nohighlight">\(f_{K}(p)\)</span> by comparing <span class="math notranslate nohighlight">\(p_{*}\)</span> with <span class="math notranslate nohighlight">\(p_{L}\)</span> and <span class="math notranslate nohighlight">\(p_{R}\)</span> . The densities <span class="math notranslate nohighlight">\(\rho_{*L}\)</span> and <span class="math notranslate nohighlight">\(\rho_{*R}\)</span> can be found from the isentropic law if the <span class="math notranslate nohighlight">\(K\)</span> wave is a rarefaction <span class="math notranslate nohighlight">\((p_{*} \le p_{K})\)</span> or from the shock relation if the <span class="math notranslate nohighlight">\(K\)</span> wave is a shock wave <span class="math notranslate nohighlight">\((p_{*} &gt; p_{K})\)</span> .</p>
<p>The two-rarefaction approximation is generally quite robust; it is more accurate, although more expensive, than the simple PVRS solutions. The TRRS is in fact exact when both nonlinear waves are actually rarefaction waves. This can be detected a-priori by the condition</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f(p_{\min}) \ge 0 \quad \text{with}~ p_{\min} = \min(p_{L}, p_{R})
\end{align}\]</div>
<p>We have now given another approximate solution to the star values problem. The solution for <span class="math notranslate nohighlight">\(\mathbf{W}_{Lfan},\mathbf{W}_{Rfan}\)</span> follows. The evaluation of the Godunov flux requires sampling the solution to find the value <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(0)\)</span> along the t-axis, in the usual way.</p>
</div>
<div class="section" id="a-two-shock-riemann-solver-tsrs">
<h4>A Two-Shock Riemann Solver (TSRS)<a class="headerlink" href="#a-two-shock-riemann-solver-tsrs" title="永久链接至标题">¶</a></h4>
<p>By assuming that both non-linear waves are shock waves in <span class="math notranslate nohighlight">\(f(p) \equiv f_{L}(p,\mathbf{W}_{L}) + f_{R}(p,\mathrm{W}_{R}) + \Delta u = 0\)</span> , <span class="math notranslate nohighlight">\(f_{K}(p)\)</span> , one can derive the two-shock approximation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f(p) = (p - p_{L})g_{L}(p) + (p - p_{R})g_{R}(p) + u_{R} - u_{L} = 0
\end{align}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g_{K}(p) = \bigg[ \frac{A_{K}}{p + B_{K}} \bigg]^{\frac{1}{2}}
,\quad
A_{K} = \frac{2}{(\gamma + 1)\rho_{K}}
,\quad
B_{K} = \Big(\frac{\gamma - 1}{\gamma + 1}\Big)p_{K}
,\quad
K = L,R
\end{align}\]</div>
<p>Unfortunately, this approximation does not lead to a closed-form solution. Further approximations must be constructed. Obvious approximations to the two-shock approximation involve quadratic equations. These do not generally lead to robust schemes. One difficulty is the non-uniqueness of solutions and making the correct choice; the exact solution is unique. The other problem is the case of complex roots (non-existence) even for data for which the exact problem has a solution; in our experience these can occur very often and is therefore the most serious difficulty of the two-shock approach.</p>
<p>An alternative approach is as follows. First we assume an estimate <span class="math notranslate nohighlight">\(p_{0}\)</span> for the solution for pressure. Then we insert this estimate in the functions <span class="math notranslate nohighlight">\(g_{K}(p)\)</span> , which in turn are substituted into two-shock approximation equation. We obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(p - p_{L})g_{L}(p_{0}) + (p - p_{R})g_{R}(p_{0}) + u_{R} - u_{L} = 0
\end{align}\]</div>
<p>The solution of this equation is immediate:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{*} = \frac{g_{L}(p_{0})p_{L} + g_{R}(p_{0})p_{R} - (u_{R} - u_{L})}{g_{L}(p_{0}) + g_{R}(p_{0})}
\end{align}\]</div>
<p>Being consistent with the two-shock assumption we derive a solution for the velocity <span class="math notranslate nohighlight">\(u_{*}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{*} = \frac{1}{2}(u_{L} + u_{R}) + \frac{1}{2} \big[(p_{*} - p_{R})g_{R}(p_{0}) - (p_{*} - p_{L})g_{L}(p_{0}) \big]
\end{align}\]</div>
<p>Solution values for <span class="math notranslate nohighlight">\(\rho_{*L}\)</span> and <span class="math notranslate nohighlight">\(\rho_{*R}\)</span> obtained from shock relations namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{*L} = \rho_{L} \bigg[ \frac{\frac{p_{*}}{p_{L}} + \frac{\gamma-1}{\gamma+1}}{\frac{\gamma-1}{\gamma+1}\frac{p_{*}}{p_{L}} + 1} \bigg]
,\quad
\rho_{*R} = \rho_{R} \bigg[ \frac{\frac{p_{*}}{p_{R}} + \frac{\gamma-1}{\gamma+1}}{\frac{\gamma-1}{\gamma+1}\frac{p_{*}}{p_{R}} + 1} \bigg]
\end{align}\]</div>
<p>As to the choice for the pressure estimate <span class="math notranslate nohighlight">\(p_{0}\)</span> we propose</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{0} = \max(0, p_{pvrs})
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(p_{pvrs}\)</span> is the solution for pressure given by the PVRS solver.</p>
<p>We have just presented another approximate solution to the problem. As before, the solution for <span class="math notranslate nohighlight">\(\mathbf{W}_{Lfan},\mathbf{W}_{Rfan}\)</span> follows. The evaluation of the Godunov flux requires sampling the solution to find the value <span class="math notranslate nohighlight">\(\mathbf{W}_{i+\frac{1}{2}}(0)\)</span> along the t-axis, in the usual way.</p>
<p>The approximation given above to the star values is more efficient than the TRRS and only slightly more expensive than the PVRS approximations. Also TSRS is more accurate then TRRS and PVRS for a wider range of flow conditions, except for near vacuum condtions, where TRRS is very accurate or indeed exact. As for the case of the TRRS approximation, we improve the TSRS by using the true wave relations whenever possible. For instance, for given <span class="math notranslate nohighlight">\(p_{*}\)</span> as computed from the above expression, one can obtain <span class="math notranslate nohighlight">\(u_{*},\rho_{*L}\)</span> and <span class="math notranslate nohighlight">\(\rho_{*R}\)</span> from exact wave relations. This is bound to improve the accuracy of the derived quantities.</p>
</div>
</div>
<div class="section" id="adaptive-riemann-solvers">
<h3>Adaptive Riemann Solvers<a class="headerlink" href="#adaptive-riemann-solvers" title="永久链接至标题">¶</a></h3>
<p>In a typical flow field the overwhelming majority of local Riemann problems are a representation for smooth flow. Large gradients occur only near shock waves, contact surfaces, shear waves or some other sharp flow features. Large gradients generate Riemann problems with widely different data states <span class="math notranslate nohighlight">\(\mathbf{W}_{L}, \mathbf{W}_{R}\)</span> . Generally, it is in this kind of situations where approximate Riemann solvers can be fatally inaccurate leading to a failure of the numerical method being used. The rationale behind the use of hybrid schemes is the use of simple Riemann solvers in regions of smooth flow and near isolated contacts and shear waves and more sophisticated Riemann solvers elsewhere in an adaptive fashion.</p>
<div class="section" id="an-adaptive-iterative-riemann-solver-airs">
<h4>An Adaptive Iterative Riemann Solver (AIRS)<a class="headerlink" href="#an-adaptive-iterative-riemann-solver-airs" title="永久链接至标题">¶</a></h4>
<p>This adaptive scheme makes use of two Riemann solvers: any of primitive-variable Riemann solvers PVRS and exact Riemann solver. The PVRS scheme is used if the following two condtions are met:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
Q = p_{\max} / p_{\min} &lt; Q_{user}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{\min} &lt; p_{*} &lt; p_{\max}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{\min} \equiv \min(p_{L},p_{R})
,\quad
p_{\max} \equiv \max(p_{L},p_{R})
,\quad
p_{*} \equiv p_{pvrs}
\end{align}\]</div>
<p>Otherwise, the exact Riemann solver is used.</p>
<p>Some remarks on the switching conditions above are in order. Condition <span class="math notranslate nohighlight">\(Q = p_{\max} / p_{\min} &lt; Q_{user}\)</span> ensures that the pressure data values <span class="math notranslate nohighlight">\(p_{L},p_{R}\)</span> are not widely different. Condition <span class="math notranslate nohighlight">\(p_{\min} &lt; p_{*} &lt; p_{\max}\)</span> imposes an extra restriction on the use of PVRS. The pressure restriction is no sufficient; in fact for <span class="math notranslate nohighlight">\(Q \approx 1, (p_{L} \approx p_{R})\)</span> and <span class="math notranslate nohighlight">\(\Delta u = u_{R} - u_{L}\)</span> negative and large in absolute value, strong shock waves are present in the solution of the Riemann problem, that is <span class="math notranslate nohighlight">\(p_{*} &gt; p_{\max}\)</span> . For <span class="math notranslate nohighlight">\(\Delta u\)</span> large and positive <span class="math notranslate nohighlight">\(p_{*} &lt; p_{\min}\)</span> and strong rarefactions are present in the exact solution of the Riemann problem. Condition <span class="math notranslate nohighlight">\(p_{\min} &lt; p_{*} &lt; p_{\max}\)</span> is effectively a condition on <span class="math notranslate nohighlight">\(\Delta u\)</span> and excludes the two-rarefaction and the two-shock cases; both of these cases occur naturally at reflected boundaries, where it would be unwise to employ unreliable approxiamtions. Also, these two cases are inconsistent with condtion <span class="math notranslate nohighlight">\(Q = p_{\max} / p_{\min} &lt; Q_{user}\)</span> on pressure ratios.</p>
<p>A choice of the switching parameter <span class="math notranslate nohighlight">\(Q_{user}\)</span> is to be made. Extensive testing suggests that the value <span class="math notranslate nohighlight">\(Q_{user} = 2\)</span> is perfectly adequate to give both very robust and efficient schemes. Even much larger values of <span class="math notranslate nohighlight">\(Q_{user}\)</span> can give accurate solutions, but the gains are not significant and thus the cautions choice of <span class="math notranslate nohighlight">\(Q_{user} = 2\)</span> is recommended. For typical flow conditions and meshes, over <span class="math notranslate nohighlight">\(90\%\)</span> of  all Riemann problems are handled by the cheap linearised Riemann solver. Effectively, the resulting schems have the efficiency of the cheapest Riemann solvers and the robustness of the exact Riemann solver. A disadvantage of this hybrid PVRS-EXACT scheme is the iterative character of the robust component of the scheme, namely the exact Riemann solver. This may be inconvenient for some computer architectures. One possiblity here is to fix the number of iterations in the exact Riemann solver. In our experience, one iteration leads to very accurate values for pressure and subsequent quantities derived. This is due in part to the provision of a sophisticated starting value for the iteration procedure.</p>
</div>
<div class="section" id="an-adaptive-noniterative-riemann-solver-anrs">
<h4>An Adaptive Noniterative Riemann Solver (ANRS)<a class="headerlink" href="#an-adaptive-noniterative-riemann-solver-anrs" title="永久链接至标题">¶</a></h4>
<p>Here we propose to combine a PVRS scheme, as the cheap component, together with the non-iterative TRRS and TSRS solvers to provide the robust component of the adaptive scheme. The use of PVRS is again restricted by conditions of the previous scheme. If any of conditions are not met we use either TRRS or TSRS. The switching between TRRS and TSRS is motivated by the behaviour of the exact function for pressure, and is as follows. If</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{pvrs} \le p_{\min}
\end{align}\]</div>
<p>then we use TRRS, otherwise we use TSRS. The flow chart of Fig.9.4 illustrates the implementation of this adaptive scheme. The problems of computing the tangential velocity components, handling sonic flow and the sampling procedure to find the Godunov flux are dealt with as described in the previous sections. This adaptive noniterative Riemann solver is recommended for practical applications.</p>
</div>
</div>
</div>
<div class="section" id="the-hll-and-hllc-riemann-solvers">
<h2>The HLL and HLLC Riemann Solvers<a class="headerlink" href="#the-hll-and-hllc-riemann-solvers" title="永久链接至标题">¶</a></h2>
<p>For the purpose of computing a Godunov flux, Harten, Lax and van Leer proposed HLL Riemann solvers. In this approach an approximation for the intercell numerical flux is obtained directly. The central idea is assume, for the solution, a wave configuration that consists of two wave separating three constant states. Assuming that the wave speeds are given by some algorithm, application of the integral form of the conservation laws gives a closed-form, approximate expression for the flux. The resulting HLL-type Riemann solvers form the bases of very efficient and robust approximate Godunov-type methods.</p>
<p>One difficulty with these schemes, however, is the assumption of a  two-wave configuration. This is correct only for hyperbolic systems of two equations, such as the one-dimensional shallow water equations. For larger systems, such as the Euler equations or the split two-dimensional shallow water equations for example, the two-wave assumption is incorrect. As a consequence the resolution of physical features such as contact surfaces, shear waves and material interfaces, can be very inaccurate. For the limiting case in which these features are stationary relative to the mesh, the resulting numerical smearing is unacceptable.</p>
<p>A different approach to remedy the problem of intermediate waves in the HLL approach waves was taken by Toro, Spruce and Speares. They proposed the HLLC Riemann solver (C standing for Contact), as applied to the time-dependent Euler equations. HLLC is a three-wave model, resulting two-star states for the intermediate region of the Riemann-problem solution fan. The approximate wave structure of HLLC contains all the characteristic fields of the exact problem. However, for systems with eigenstructure containing more than three distinct characteristic fields, HLLC becomes incomplete, tending to behave like HLL for the one-dimensional Euler equations. The incomplete character of a Riemann solver affects the resolution of intermediate waves, particularly when these move slowly relative to the mesh. Therefore, the obvious way of improving the HLLC approach is to admit the correct number of characteristic fields for the system of interest.</p>
<div class="section" id="the-riemann-problem">
<h3>The Riemann Problem<a class="headerlink" href="#the-riemann-problem" title="永久链接至标题">¶</a></h3>
<p>We concerned with solving numerically the general Initial Boundary Value Problem (IBVP)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \mathbf{U}^{(0)}(x) \\
&amp; \mathbf{U}(0,t) = \mathbf{U}_{l}(t) ,\quad \mathbf{U}(L,t) = \mathbf{U}_{r}(t)
\end{align}\end{split}\]</div>
<p>in a domain <span class="math notranslate nohighlight">\(0 \le x \le L\)</span> , with appropriate boundary conditions. We use the explicit conservative formula</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} - \frac{\Delta t}{\Delta x}[\mathbf{F}_{i+\frac{1}{2}} - \mathbf{F}_{i-\frac{1}2{}}]
\end{align}\]</div>
<p>with the numerical flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> yet to be defined.</p>
<div class="section" id="the-godunov-flux">
<h4>The Godunov Flux<a class="headerlink" href="#the-godunov-flux" title="永久链接至标题">¶</a></h4>
<p>We defined the Godunov intercell numerical flux as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{i+\frac{1}{2}}(0))
\end{align}\]</div>
<p>in which <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0)\)</span> is the exact similarity solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> of the Riemann problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \left\{ \begin{array}{l}
\mathbf{U}_{L} \quad \text{if}~ x&lt;0 \\
\mathbf{U}_{R} \quad \text{if}~ x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>evaluated at <span class="math notranslate nohighlight">\(x/t=0\)</span> . Fig.10.1 shows the structure of the exact solution of the Riemann problem for the x-split, three dimensional Euler equations, for which the vectors of conserved variables and fluxes are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} =
\begin{bmatrix}
\rho \\ \rho u \\ \rho v \\ \rho w \\ E
\end{bmatrix}
,\quad
\mathbf{F} =
\begin{bmatrix}
\rho u \\ \rho u^{2} + p \\ \rho u v \\ \rho u w \\ u(E + p)
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The value <span class="math notranslate nohighlight">\(x/t=0\)</span> for the Godunov flux corresponds to the t-axis. The piece-wise constant initial data, in terms of primitive variables, is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{W}_{L} =
\begin{bmatrix}
\rho_{L} \\ u_{L} \\ v_{L} \\ w_{L} \\ p_{L}
\end{bmatrix}
,\quad
\mathbf{W}_{R} =
\begin{bmatrix}
\rho_{R} \\ u_{R} \\ v_{R} \\ w_{R} \\ p_{R}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>We provided approximations to the state <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> and obtained a corresponding approximate Godunov method by evaluating the physical flux function <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> at this approximate state. The purpose of this chapter is to find direct approximations to the flux function <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> following the novel approach proposed by Harten, Lax and van Leer.</p>
</div>
<div class="section" id="integral-relations">
<h4>Integral Relations<a class="headerlink" href="#integral-relations" title="永久链接至标题">¶</a></h4>
<p>Consider Fig.10.2, in which the whole of the wave structure arising from the exact solution of the Riemann problem is contained in the control volume <span class="math notranslate nohighlight">\([x_{L},x_{R}] \times [0,T]\)</span> , that is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
x_{L} \le TS_{L}
,\quad
x_{R} \ge TS_{R}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> are the fastest signal velocities perturbing the initial data states <span class="math notranslate nohighlight">\(\mathbf{U}_{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{R}\)</span> respectively, and <span class="math notranslate nohighlight">\(T\)</span> is a chosen time. The integral form of the conservation laws in control volume <span class="math notranslate nohighlight">\([x_{L},x_{R}] \times [0,T]\)</span> reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{x_{L}}^{x_{R}}\mathbf{U}(x,T)\mathrm{d}x
= \int_{x_{L}}^{x_{R}}\mathbf{U}(x,0)\mathrm{d}x
+ \int_{0}^{T}\mathbf{F}(\mathbf{U}(x_{L},t))\mathrm{d}t
- \int_{0}^{T}\mathbf{F}(\mathbf{U}(x_{R},t))\mathrm{d}t
\end{align}\]</div>
<p>Evaluation of the right-hand side of this expression gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{x_{L}}^{x_{R}} \mathbf{U}(x,T)\mathrm{d}x
= x_{R}\mathbf{U}_{R}
- x_{L}\mathbf{U}_{L}
+ T(\mathbf{F}_{L} - \mathbf{F}_{R})
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{F}_{L} = \mathbf{F}(\mathbf{U}_{L})\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{R} = \mathbf{F}(\mathbf{U}_{R})\)</span> . We call this integral relation <strong>the consistency condition</strong> . Now we split the integral on the left-hand side of the integral form of the conservation laws into three integrals, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{x_{L}}^{x_{R}} \mathbf{U}(x,T)\mathrm{d}x
= \int_{x_{L}}^{TS_{L}}\mathbf{U}(x,T)\mathrm{d}x
+ \int_{TS_{L}}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
+ \int_{TS_{R}}^{x_{R}}\mathbf{U}(x,T)\mathrm{d}x
\end{align}\]</div>
<p>and evaluate the first and third terms on the right-hand side. We obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{x_{L}}^{x_{R}} \mathbf{U}(x,T)\mathrm{d}x
= \int_{TS_{L}}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
+ (TS_{L} - x_{L})\mathbf{U}_{L}
+ (x_{R} - TS_{R})\mathbf{U}_{R}
\end{align}\]</div>
<p>Comparing it with the consistency condition gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{TS_{L}}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
= T(S_{R}\mathbf{U}_{R} - S_{L}\mathbf{U}_{L} + \mathbf{F}_{L} - \mathbf{F}_{R})
\end{align}\]</div>
<p>On division through by the length <span class="math notranslate nohighlight">\(T(S_{R} - S_{L})\)</span> , which is the width of the wave system of the solution of the Riemann problem between the slowest and fastest signals at time <span class="math notranslate nohighlight">\(T\)</span> , we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{1}{T(S_{R} - S_{L})}\int_{TS_{L}}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
= \frac{S_{R}\mathbf{U}_{R} - S_{L}\mathbf{U}_{L} + \mathbf{F}_{L} - \mathbf{F}_{R}}{S_{R} - S_{L}}
\end{align}\]</div>
<p>Thus, the integral average of the exact solution of the Riemann problem between the slowest and fastest signals at time <span class="math notranslate nohighlight">\(T\)</span> is a known constant, provided that the signal speeds <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> are known; such constant is the right-hand side of the above equation and we denote it by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}^{hll} = \frac{S_{R}\mathbf{U}_{R} - S_{L}\mathbf{U}_{L} + \mathbf{F}_{L} - \mathbf{F}_{R}}{S_{R} - S_{L}}
\end{align}\]</div>
<p>We now apply the integral form of the conservation laws to the left portioin of Fig.10.2, that is the control volume <span class="math notranslate nohighlight">\([x_{L},0] \times [0,T]\)</span> . We obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{TS_{L}}^{0}\mathbf{U}(x,T)\mathrm{d}x = -TS_{L}\mathbf{U}_{L} + T(\mathbf{F}_{L} - \mathbf{F}_{0L})
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{F}_{0L}\)</span> is the flux <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> along the t-axis. Solving for <span class="math notranslate nohighlight">\(\mathbf{F}_{0L}\)</span> we find</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{0L} = \mathbf{F}_{L} - S_{L}\mathbf{U}_{L} - \frac{1}{T}\int_{TS_{L}}^{0}\mathbf{U}(x,T)\mathrm{d}x
\end{align}\]</div>
<p>Evaluation of the integral form of the conservation laws on the control volume <span class="math notranslate nohighlight">\([0,x_{R}] \times [0,T]\)</span> yields</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{0R} = \mathbf{F}_{R} - S_{R}\mathbf{U}_{R} + \frac{1}{T}\int_{0}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
\end{align}\]</div>
<p>We can easily veriy that the equality</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{0L} = \mathbf{F}_{0R}
\end{align}\]</div>
<p>results in the consistency condition. All relations so far are exact, as we are assuming the exact solution of the Riemann problem.</p>
</div>
</div>
<div class="section" id="the-hll-approximate-riemann-solver">
<h3>The HLL Approximate Riemann Solver<a class="headerlink" href="#the-hll-approximate-riemann-solver" title="永久链接至标题">¶</a></h3>
<p>Harten, Lax and van Leer put forward the following approximate Riemann solver</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{U}}(x,t) = \left\{ \begin{array}{l}
\mathbf{U}_{L} \quad \text{if}~ \quad \frac{x}{t} \le S_{L} \\
\mathbf{U}^{hll} \quad \text{if}~\quad S_{L} \le \frac{x}{t} \le S_{R} \\
\mathbf{U}_{R} \quad \text{if}~\quad \frac{x}{t} \ge S_{R}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{U}^{hll}\)</span> is the constant state vector and the speeds <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> are assumed to be known. Fig.10.3 shows the strcuture of this approximate solution of the Riemann problem, called the HLL Riemann solver. Note that this approximation consists of just three constant states separated by two waves. The Star Region consists of a single constant state; all intermediate states separated by intermediate waves are lumped into the single state <span class="math notranslate nohighlight">\(\mathbf{U}^{hll}\)</span> . The corresponding flux <span class="math notranslate nohighlight">\(\mathbf{F}^{hll}\)</span> along the t-axis is found from the relations <span class="math notranslate nohighlight">\(\mathbf{F}_{0L}\)</span> or <span class="math notranslate nohighlight">\(\mathbf{F}_{0R}\)</span> , with the exact integrand replaced by the approximate solution <span class="math notranslate nohighlight">\(\tilde{\mathbf{U}}(x,t)\)</span> . Note that we do not take <span class="math notranslate nohighlight">\(\mathbf{F}^{hll} = \mathbf{F}(\mathbf{U}^{hll})\)</span> . The non-trivial case of interest is the subsonic case <span class="math notranslate nohighlight">\(S_{L} \le 0 \le S_{R}\)</span> . Substitution of the integrand in <span class="math notranslate nohighlight">\(\mathbf{F}_{0L}\)</span> or <span class="math notranslate nohighlight">\(\mathbf{F}_{0R}\)</span> by <span class="math notranslate nohighlight">\(\mathbf{U}^{hll}\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}^{hll} = \mathbf{F}_{L} + S_{L}(\mathbf{U}^{hll} - \mathbf{U}_{L})
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}^{hll} = \mathbf{F}_{R} + S_{R}(\mathbf{U}^{hll} - \mathbf{U}_{R})
\end{align}\]</div>
<p>Note that the above two relations are also obtained from applying Rankine-Hugoniot conditions across the left and right waves respectively. Use of <span class="math notranslate nohighlight">\(\mathbf{U}^{hll}\)</span> in the above two relations gives the HLL flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}^{hll} = \frac{S_{R}\mathbf{F}_{L} - S_{L}\mathbf{F}_{R} + S_{L}S_{R}(\mathbf{U}_{R} - \mathbf{U}_{L})}{S_{R} - S_{L}}
\end{align}\]</div>
<p>The corresponding HLL intercell flux for the approximate Godunov method is then given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}_{i+\frac{1}{2}}^{hll} = \left\{ \begin{array}{l}
\mathbf{F}_{L} \quad \text{if}~ 0 \le S_{L} \\
\frac{S_{R}\mathbf{F}_{L} - S_{L}\mathbf{F}_{R} + S_{L}S_{R}(\mathbf{U}_{R} - \mathbf{U}_{L})}{S_{R} - S_{L}} \quad \text{if}~ S_{L} \le 0 \le S_{R} \\
\mathbf{F}_{R} \quad \text{if}~ 0 \ge S_{R}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>Given an algorithm to compute the speeds <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> we have an approximate intercell flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}^{hll}\)</span> to be used in the conservative formula to produce an approximate Godunov method. Harten, Lax and van Leer showed that the Godunov scheme, if convergent, converges to the weak solution of the conservation laws. In fact they proved that the converged solution is also the physical, entropy satisfying, solution of the conservation laws. Their results actually apply to a larger class of approximate Riemann solvers. One of the requirements is consistency with the integral form of the conservation laws. That is, an approximate solution <span class="math notranslate nohighlight">\(\tilde{\mathbf{U}}(x,t)\)</span> is consistent with the integral form of the conservation laws if, when substituted for the exact solution <span class="math notranslate nohighlight">\(\mathbf{U}(x,t)\)</span> in the consistency condition, the right-hand side remains unaltered.</p>
<p>A shortcoming of the HLL scheme is exposed by contact discontinuities, shear waves and material interfaces, or any type of intermediate waves. For the Euler equations these waves are associated with the multiple eigenvalue <span class="math notranslate nohighlight">\(\lambda_{2}=\lambda_{3}=\lambda_{4}=u\)</span> . Note that in the integral average of the exact solution of the Riemann problem between the slowest and fastest signals at time <span class="math notranslate nohighlight">\(T\)</span> , all that matters is the average across the wave structure, without regard for the spatial variations of the solution of the Riemann problem in the Star Region. This defect of the HLL scheme may be corrected by restoring the missing waves. Accordingly, Toro, Spruce and Speares proposed the so called HLLC scheme, where C stands for Contact. In this scheme the missing middle waves are put back into the structure of the approximate Riemann solver.</p>
</div>
<div class="section" id="the-hllc-approximate-riemann-solver">
<h3>The HLLC Approximate Riemann Solver<a class="headerlink" href="#the-hllc-approximate-riemann-solver" title="永久链接至标题">¶</a></h3>
<p>The HLLC scheme is a modification of the HLL scheme described in the previous section, whereby the missing contact and shear waves in the Euler equations are restored. The scheme was first presented in terms of the time-dependent, two dimensional Euler equations. Early applications include the steady supersonic two-dimensional Euler equations and the time-dependent two dimensional shallow water equations.</p>
<div class="section" id="useful-relations">
<h4>Useful Relations<a class="headerlink" href="#useful-relations" title="永久链接至标题">¶</a></h4>
<p>Consider Fig.10.2, in which the complete structure of the solution of the Riemann problem is contained in a sufficiently large control volume <span class="math notranslate nohighlight">\([x_{L},x_{R}] \times [0,T]\)</span> . Now, in addition to the slowest and fastest signal speeds <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> we include a middle wave of speed <span class="math notranslate nohighlight">\(S_{*}\)</span> ; for the Euler equations this corresponds to the multiple eigenvalue <span class="math notranslate nohighlight">\(\lambda_{2}=\lambda_{3}=\lambda_{4}=u\)</span> . See Fig.10.4. Evaluation of the integral form of the conservation laws in the control volume reproduces the result of equation of the integral average of the exact solution of the Riemann problem between the slowest and fastest signals at time <span class="math notranslate nohighlight">\(T\)</span> , even if variations of the integrand across the wave of speed <span class="math notranslate nohighlight">\(S_{*}\)</span> are allowed. Note that the consistency condition effectively becomes the condition of the integral average. By splitting the left-hand side of integral into two terms we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{1}{T(S_{R} - S_{L})}\int_{TS_{L}}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
= \frac{1}{T(S_{R} - S_{L})} \int_{TS_{L}}^{TS_{*}}\mathbf{U}(x,T)\mathrm{d}x
+ \frac{1}{T(S_{R} - S_{L})} \int_{TS_{*}}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
\end{align}\]</div>
<p>We define the integral averages</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{*L} = \frac{1}{T(S_{*} - S_{L})} \int_{TS_{L}}^{TS_{*}}\mathbf{U}(x,T)\mathrm{d}x \\
&amp; \mathbf{U}_{*R} = \frac{1}{T(S_{R} - S_{*})} \int_{TS_{*}}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
\end{align}\end{split}\]</div>
<p>The consistency condition becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big( \frac{S_{*} - S_{L}}{S_{R} - S_{L}} \Big)\mathbf{U}_{*L}
+ \Big( \frac{S_{R} - S_{*}}{S_{R} - S_{L}} \Big) \mathbf{U}_{*R}
= \mathbf{U}^{hll}
\end{align}\]</div>
<p>The HLLC approximate Riemann solver is given as follows</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{U}}(x,t) = \left\{ \begin{array}{l}
\mathbf{U}_{L} ,\quad \text{if}~ \frac{x}{t} \le S_{L} \\
\mathbf{U}_{*L} ,\quad \text{if}~ S_{L} \le \frac{x}{t} \le S_{*} \\
\mathbf{U}_{*R} ,\quad \text{if}~ S_{*} \le \frac{x}{t} \le S_{R} \\
\mathbf{U}_{R} ,\quad \text{if}~ \frac{x}{t} \ge S_{R}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>We seek a corresponding HLLC numerical flux defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}_{i+\frac{1}{2}}^{hllc} = \left\{ \begin{array}{l}
\mathbf{F}_{L} ,\quad \text{if}~ 0 \le S_{L} \\
\mathbf{F}_{*L} ,\quad \text{if}~ S_{L} \le 0 \le S_{*} \\
\mathbf{F}_{*R} ,\quad \text{if}~ S_{*} \le 0 \le S_{R} \\
\mathbf{F}_{R} ,\quad \text{if}~ 0 \ge S_{R}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>with the intermediate fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{*L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{*R}\)</span> still to be determined. Fig.10.4 shows the structure of the HLLC approximate Riemann solver.</p>
<p>By integrating over appropriate control volumes, or more directly, by applying Rankine-Hugoniot Conditions across each of the waves of speeds <span class="math notranslate nohighlight">\(S_{L}, S_{*}, S_{R}\)</span> , we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{F}_{*L} = \mathbf{F}_{L} + S_{L}(\mathbf{U}_{*L} - \mathbf{U}_{L}) \\
&amp; \mathbf{F}_{*R} = \mathbf{F}_{*L} + S_{*}(\mathbf{U}_{*R} - \mathbf{U}_{*L}) \\
&amp; \mathbf{F}_{*R} = \mathbf{F}_{R} + S_{R}(\mathbf{U}_{*R} - \mathbf{U}_{R})
\end{align}\end{split}\]</div>
<p>The three conditions are sufficient for ensuring consistency; these are three equations for the four unknowns vectors <span class="math notranslate nohighlight">\(\mathbf{U}_{*L}, \mathbf{F}_{*L}, \mathbf{U}_{*R}, \mathbf{F}_{*R}\)</span> .</p>
</div>
<div class="section" id="the-hllc-flux-for-the-euler-equations">
<h4>The HLLC Flux for the Euler Equations<a class="headerlink" href="#the-hllc-flux-for-the-euler-equations" title="永久链接至标题">¶</a></h4>
<p>We seek the solution for the two unknown intermediate fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{*L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{*R}\)</span> . From the three conditions above we see that it is sufficient to find solutions for the two intermediate state vectors <span class="math notranslate nohighlight">\(\mathbf{U}_{*L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{*R}\)</span> . There are more unknowns than equations and some extra conditions need to be imposed, in order to solve the algebraic problem. Obvious conditions to impose are those satisfied by the exact solution; for pressure and normal component of velocity we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; p_{*L} = p_{*R} = p_{*} \\
&amp; u_{*L} = u_{*R} = u_{*}
\end{align}\end{split}\]</div>
<p>and for tangential velocity components we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; v_{*L} = v_{L} ,\quad v_{*R} = v_{R} \\
&amp; w_{*L} = w_{L} ,\quad w_{*R} = w_{R}
\end{align}\end{split}\]</div>
<p>In addition, it is entirely justified, and convenient, to set</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{*} = u_{*}
\end{align}\]</div>
<p>and thus if an estimate for <span class="math notranslate nohighlight">\(S_{*}\)</span> is known, the normal velocity component <span class="math notranslate nohighlight">\(u_{*}\)</span> in the Star Region is known. Now the equations can be rearranged as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{L}\mathbf{U}_{*L} - \mathbf{F}_{*L} = S_{L}\mathbf{U}_{L} - \mathbf{F}_{L}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{R}\mathbf{U}_{*R} - \mathbf{F}_{*R} = S_{R}\mathbf{U}_{R} - \mathbf{F}_{R}
\end{align}\]</div>
<p>where the right-hand sides are known constant vectors. We also note the useful relation between <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}(\mathbf{U}) = u\mathbf{U} + p\mathbf{D}
,\quad
\mathbf{D} = [0, 1, 0, 0, u]^{T}
\end{align}\]</div>
<p>Assuming that the wave speeds <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> are known and performing algebraic manipulations of the first and second components of the rearranged equations one obtains the following solutions for pressure in the two Star Regions</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{*L} = p_{L} + \rho_{L}(S_{L} - u_{L})(S_{*} - u_{L})
,\quad
p_{*R} = p_{R} + \rho_{R}(S_{R} - u_{R})(S_{*} - u_{R})
\end{align}\]</div>
<p>From <span class="math notranslate nohighlight">\(p_{*L}=p_{*R}\)</span> allows us to obtain an expression for the speed <span class="math notranslate nohighlight">\(S_{*}\)</span> purely in terms of the assumed speeds <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{*} = \frac{p_{R} - p_{L} + \rho_{L}u_{L}(S_{L} - u_{L}) - \rho_{R}u_{R}(S_{R} - u_{R})}{\rho_{L}(S_{L} - u_{L}) - \rho_{R}(S_{R} - u_{R})}
\end{align}\]</div>
<p>Thus, we only need to provide estimate for <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> , just as for the simpler HLL solver.</p>
<p>Algebraic manipulation of the rearranged equations and using the corresponding values <span class="math notranslate nohighlight">\(p_{*L}\)</span> and <span class="math notranslate nohighlight">\(p_{*R}\)</span> gives the intermediate fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{*L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{*R}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{*K} = \mathbf{F}_{K} + S_{K}(\mathbf{U}_{*K} - \mathbf{U}_{K})
\end{align}\]</div>
<p>for <span class="math notranslate nohighlight">\(K=L,R\)</span> , with the intermediate states given as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U}_{*K} = \rho_{K} \Big( \frac{S_{K} - u_{K}}{S_{K} - S_{*}} \Big)
\begin{bmatrix}
1 \\
S_{*} \\
v_{K} \\
w_{K} \\
\frac{E_{K}}{\rho_{K}} + (S_{*} - u_{K})\Big[ S_{*} + \frac{p_{K}}{\rho_{K}(S_{K} - u_{K})} \Big]
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The final choice of the HLLC flux is made according to the expression of <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}^{hllc}\)</span> .</p>
<p>A variation in the formulation of the HLLC solver is the following. From the rearranged equations we may write the following solutions for the state vectors <span class="math notranslate nohighlight">\(\mathbf{U}_{*L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{*R}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{*K} = \frac{S_{K}\mathbf{U}_{K} - \mathbf{F}_{K} + p_{*K}\mathbf{D}_{*}}{S_{L} - S_{*}}
,\quad
\mathbf{D}_{*} = [0, 1, 0, 0, S_{*}]
\end{align}\]</div>
<p>with <span class="math notranslate nohighlight">\(p_{*L}\)</span> and <span class="math notranslate nohighlight">\(p_{*R}\)</span> as given by the expressions. Substitution of <span class="math notranslate nohighlight">\(p_{*K}\)</span> from the expressions into the equation followed by use of expressions of <span class="math notranslate nohighlight">\(\mathbf{F}_{*L}, \mathbf{F}_{*R}\)</span> gives direct expressions for the intermediate fluxes as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{*K} = \frac{S_{*}(S_{K}\mathbf{U}_{K} - \mathbf{F}_{K}) + S_{K}(p_{K} + \rho_{L}(S_{K} - u_{K})(S_{*} - u_{K}))D_{*}}{S_{K} - S_{*}}
\end{align}\]</div>
<p>with the final choice of the HLLC flux made again according to the expression of <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}^{hllc}\)</span> .</p>
<p>We remark here that the first HLLC formulation enforces the condition <span class="math notranslate nohighlight">\(p_{*L} = p_{*R}\)</span> , which is satisfied by the exact solution. In the alternative HLLC formulation we relax such condition, being more consistent with the pressure approximations.</p>
<p>A different HLLC flux is obtained by assuming a single mean pressure value in the Star Region, and given by the arithmetic average of the pressures <span class="math notranslate nohighlight">\(p_{*L}, p_{*R}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
P_{LR} = \frac{1}{2}[p_{L} + p_{R} + \rho_{L}(S_{L} - u_{L})(S_{*} - u_{L}) + \rho_{R}(S_{R} - u_{R})(S_{*} - u_{R})]
\end{align}\]</div>
<p>Then the intermediate state vectors are given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{*K} = \frac{S_{K}\mathbf{U}_{K} - \mathbf{F}_{K} + P_{LR}\mathbf{D}_{*}}{S_{K} - S_{*}}
\end{align}\]</div>
<p>Substitution of these into expressions of <span class="math notranslate nohighlight">\(\mathbf{F}_{*L},\mathbf{F}_{*R}\)</span> gives the fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{*L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{*R}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{*K} = \frac{S_{*}(S_{K}\mathbf{U}_{K} - \mathbf{F}_{K}) + S_{K}P_{LR}\mathbf{D}_{*}}{S_{K} - S_{*}}
\end{align}\]</div>
<p>Again the final choice of HLLC flux is made according to <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}^{hllc}\)</span> .</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">All manipulations so far, assuming that wave speed estimates for <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> are available, are valid for any equation of state. The equation o state only enters in prescribing estmates for <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> .</p>
</div>
</div>
<div class="section" id="multidimensional-and-multicomponent-flow">
<h4>Multidimensional and Multicomponent Flow<a class="headerlink" href="#multidimensional-and-multicomponent-flow" title="永久链接至标题">¶</a></h4>
<p>Here we consider extensions of the HLLC solver to two areas of application, namely multidimensional flow and multicomponent flow.</p>
<p>The presentation of the HLLC scheme has been made for the x-split three dimensional Euler equations, for which the corresponding eigenvalues are denoted here as <span class="math notranslate nohighlight">\(\lambda_{1} = u - a\)</span> , <span class="math notranslate nohighlight">\(\lambda_{2} = u\)</span> (multiplicity 3), <span class="math notranslate nohighlight">\(\lambda_{3} = u + a\)</span> , where <span class="math notranslate nohighlight">\(u\)</span> is the normal velocity component and <span class="math notranslate nohighlight">\(a\)</span> is the speed of sound. In a general multidimensional situation, one usually requires the flux in the direction normal to a volume (or element) interface, which is not necessarily aligned with any of the Cartesian directions. In this case the form of the governing equations remains identical to the x-split system. There will be a normal and two tangential components of velocity as before, and all the results obtained so far will be applicable.</p>
<p>In the study of multicomponent flow, one considers the advection of chemical species by the flow, the carrier fluid. For example, let us consider <span class="math notranslate nohighlight">\(m\)</span> species of concentrations <span class="math notranslate nohighlight">\(q_{l}\)</span> , for <span class="math notranslate nohighlight">\(l=1,\cdots,m\)</span> , advected with the normal fluid speed <span class="math notranslate nohighlight">\(u\)</span> . This means that for each species we can write the following advection equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\partial_{t}q_{l} + u\partial_{x}q_{l} = 0
\end{align}\]</div>
<p>for <span class="math notranslate nohighlight">\(l = 1,\cdots,m\)</span> . Note that these equations are written in non-conservative form. However, by combining these with the continuity equation we obtain a conservative form of these equations, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho q_{l})_{t} + (\rho u q_{l})_{x} = 0
,\quad \text{for}~ l=1,\cdots,m
\end{align}\]</div>
<p>The eigenvalues of the enlarged system are as before, with the exception of <span class="math notranslate nohighlight">\(\lambda_{2} = u\)</span> , which now, in three space dimensions, has multiplicity <span class="math notranslate nohighlight">\(m+3\)</span> . These conservation equations can then be added as new components to the conservation equations discussed before, with the enlarged vectors of conserved variables and fluxes given as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} =
\begin{bmatrix}
\rho \\ \rho u \\ \rho v \\ \rho w \\ E \\ \rho q_{1} \\ \cdots \\ \rho q_{l} \\ \cdots \\ \rho q_{m}
\end{bmatrix}
,\quad
\mathbf{F} =
\begin{bmatrix}
\rho u \\ \rho u^{2}+p \\ \rho u v \\ \rho u w \\ u(E + p) \\ \rho u q_{1} \\ \cdots \\ \rho u q_{l} \\ \cdots \\ \rho u q_{m}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The HLLC flux accommodates these new equations in a very natural way, and nothing special needs to be done. If the HLLC flux <span class="math notranslate nohighlight">\(\mathbf{F}_{*K}\)</span> is used, with <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> as given above, then the intermediate state vectors are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U}_{*K} = \rho_{K} \Big( \frac{S_{K} - u_{K}}{S_{K} - S_{*}} \Big)
\begin{bmatrix}
1 \\
S_{*} \\
v_{K} \\
w_{K} \\
\frac{E_{K}}{\rho_{K}} + (S_{*} - u_{K})\Big[ S_{*} + \frac{p_{K}}{\rho_{K}(S_{K} - u_{K})} \Big] \\
(q_{1})_{K} \\
\cdots \\
(q_{l})_{K} \\
\cdots \\
(q_{m})_{K}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>for <span class="math notranslate nohighlight">\(K=L,R\)</span> . In this manner the HLLC flux will resolve the additional intermediate fields as the exact Riemann solver.</p>
<p>Note that the tangential velocity components <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(w\)</span> are special cases of passive scalars; compare it with <span class="math notranslate nohighlight">\(\mathbf{U}_{*K}\)</span> given before for <span class="math notranslate nohighlight">\(q=v\)</span> and <span class="math notranslate nohighlight">\(q=w\)</span> .</p>
</div>
</div>
<div class="section" id="wave-speed-estimates">
<h3>Wave-Speed Estimates<a class="headerlink" href="#wave-speed-estimates" title="永久链接至标题">¶</a></h3>
<p>In order to determine completely the numerical fluxes in both the HLL and HLLC Riemann solvers we need to provide an algorithm for computing the wave speeds <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> . For the HLLC scheme one requires in addition an estimate for the speed of the middle wave <span class="math notranslate nohighlight">\(S_{*}\)</span> , but this can in fact be computed once <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> are known. Thus the pending task is to determine estimates for <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> . One approach is to estimate the speeds directly; another approach relies on pressure estimates in the Star Region, which are then utilised to obtain <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> using exact wave relations.</p>
<div class="section" id="direct-wave-speed-estimates">
<h4>Direct Wave Speed Estimates<a class="headerlink" href="#direct-wave-speed-estimates" title="永久链接至标题">¶</a></h4>
<p>The most well known approach for estimating bounds for the minimum and maximum signal velocities present in the solution of the Riemann problem is to provide, directly, wave speeds <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> . Davis suggested the simple estimates</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{L} = u_{L} - a_{L}
,\quad
S_{R} = u_{R} + a_{R}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{L} = \min(u_{L}-a_{L}, u_{R}-a_{R})
,\quad
S_{R} = \max(u_{L}+a_{L}, u_{R}+a_{R})
\end{align}\]</div>
<p>These estimates make use of data values only, are exceedingly simple but are no recommended for practical computations. Both Davis and Einfeldt, proposed to use the Roe average eigenvalues for the left and right non-linear waves, that is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{L} = \tilde{u} - \tilde{a}
,\quad
S_{R} = \tilde{u} + \tilde{a}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{u}\)</span> and <span class="math notranslate nohighlight">\(\tilde{a}\)</span> are the Roe-average particle and sound speeds respectively, given as follows</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u} = \frac{\sqrt{\rho_{L}}u_{L} + \sqrt{\rho_{R}}u_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
,\quad
\tilde{a} = \Big[ (\gamma - 1)(\tilde{H} - \frac{1}{2}\tilde{u}^{2}) \Big]^{1/2}
\end{align}\]</div>
<p>with the enthalpy <span class="math notranslate nohighlight">\(H = (E + p)/\rho\)</span> approximated as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{H} = \frac{\sqrt{\rho_{L}}H_{L} + \sqrt{\rho_{R}}H_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<p>Motivated by the Roe eigenvalues Einfeldt proposed the estimates</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{L} = \bar{u} - \bar{d}
,\quad
S_{R} = \bar{u} + \bar{d}
\end{align}\]</div>
<p>for his HLLE solver, where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{d}^{2} = \frac{\sqrt{\rho_{L}}a_{L}^{2} + \sqrt{\rho_{R}}a_{R}^{2}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}} + \eta_{2}(u_{R} - u_{L})^{2}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\eta_{2} = \frac{1}{2} \frac{\sqrt{\rho_{L}}\sqrt{\rho_{R}}}{(\sqrt{\rho_{L}} + \sqrt{\rho_{R}})^{2}}
\end{align}\]</div>
<p>These wave speed estimates are reported to lead to effective and robust Godunov-type schemes.</p>
<p>Davis made some observations regarding the relationship between the chosen wave speeds and some well-known numerical methods. Suppose that for a given Riemann problem we can identify a positive speed <span class="math notranslate nohighlight">\(S^{+}\)</span> . Then by choosing <span class="math notranslate nohighlight">\(S_{L} = -S^{+}\)</span> and <span class="math notranslate nohighlight">\(S_{R} = S^{+}\)</span> in the HLL flux one obtains a Rusanov flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \frac{1}{2}(\mathbf{F}_{L} + \mathbf{F}_{R}) - \frac{1}{2}S^{+}(\mathbf{U}_{R} - \mathbf{U}_{L})
\end{align}\]</div>
<p>As to the choice of the speed <span class="math notranslate nohighlight">\(S^{+}\)</span> , Davis considered</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S^{+} = \max(|u_{L} - a_{L}|, |u_{R} - a_{R}|, |u_{L} + a_{L}|, |u_{R} + a_{R}|)
\end{align}\]</div>
<p>Actually, the above speed is bounded by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S^{+} = \max(|u_{L}| + a_{L}, |u_{R}| + a_{R})
\end{align}\]</div>
<p>This choice is likely to produce a more robust scheme and is also simpler than Davis’s choice.</p>
<p>Another possible choice is <span class="math notranslate nohighlight">\(S^{+} = S_{\max}^{n}\)</span> , the maximum wave speed present at the appropriate time found by imposing the Courant stability condtion. This speed is related to the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> and the grid spacing <span class="math notranslate nohighlight">\(\Delta x\)</span> via</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{\max}^{n} = \frac{C_{cfl}\Delta x}{\Delta t}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(C_{cfl}\)</span> is the Courant number coefficient, usually chosen (empirically) to be <span class="math notranslate nohighlight">\(C_{cfl} \approx 0.9\)</span> , for a scheme of linear stability limit of unity. For <span class="math notranslate nohighlight">\(C_{cfl} = 1\)</span> one has <span class="math notranslate nohighlight">\(S^{+}=\frac{\Delta x}{\Delta t}\)</span> , which results in the Lax-Friedrichs numerical flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \frac{1}{2}(\mathbf{F}_{L} + \mathbf{F}_{R}) - \frac{1}{2}\frac{\Delta x}{\Delta t}(\mathbf{U}_{R} - \mathbf{U}_{L})
\end{align}\]</div>
</div>
<div class="section" id="pressure-based-wave-speed-estimates">
<h4>Pressure-Based Wave Speed Estimates<a class="headerlink" href="#pressure-based-wave-speed-estimates" title="永久链接至标题">¶</a></h4>
<p>A different approach for finding wave speed estimates was proposed by Toro et. al., whereby one first finds an estimate for the pressure <span class="math notranslate nohighlight">\(p_{*}\)</span> in the Star Region. Then estimates for <span class="math notranslate nohighlight">\(S_{L}\)</span> and <span class="math notranslate nohighlight">\(S_{R}\)</span> are derived. This is a simple tast and several reliable choices are available. Suppose we have an estimate <span class="math notranslate nohighlight">\(p_{*}\)</span> for the pressure in the Star Region. Then we choose the following wave speeds</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{L} = u_{L} - a_{L}q_{L}
,\quad
S_{R} = u_{R} + a_{R}q_{R}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
q_{K} = \left\{ \begin{array}{l}
1 \quad \text{if}~ p_{*} \le p_{K} \\
\Big[ 1 + \frac{\gamma + 1}{2\gamma}(p_{*}/p_{K} - 1) \Big]^{1/2} \quad \text{if}~ p_{*} &gt; p_{K}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>This choice of wave speeds discriminates between shock and rarefaction waves. If the <span class="math notranslate nohighlight">\(K\)</span> wave ( <span class="math notranslate nohighlight">\(K=L\)</span> or <span class="math notranslate nohighlight">\(K=R\)</span> ) is a rarefaction then the speed <span class="math notranslate nohighlight">\(S_{K}\)</span> corresponds to the characteristic speed of the head of the rarefaction, which carries the fastest signal. If the wave is a shock wave then the speed corresponds to an approximation of the true shock speed; the wave relations used are exact but the pressure ratio across the shock is approximated, because <span class="math notranslate nohighlight">\(p_{*}\)</span> is an approximation to the pressure behind the shock wave. We propose to use the state approximations to find <span class="math notranslate nohighlight">\(p_{*}\)</span> .</p>
<p>The PVRS approximate Riemann solver gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{pvrs} = \frac{1}{2}(p_{L} + p_{R}) - \frac{1}{2}(u_{R} - u_{L})\bar{\rho}\bar{a}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{\rho} = \frac{1}{2}(\rho_{L} + \rho_{R})
,\quad
\bar{a} = \frac{1}{2}(a_{L} + a_{R})
\end{align}\]</div>
<p>This approximation for pressure can be used directly into the wave speeds expressions above to obtain wave speed estimates for the HLL and HLLC schemes.</p>
<p>Another choice is furnished by the Two-Rarefaction Riemann solver TRRS, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{tr} = \Big[ \frac{a_{L} + a_{R} - \frac{\gamma-1}{2}(u_{R} - u_{L})}{a_{L}/p_{L}^{z} + a_{R}/p_{R}^{z}} \Big]^{1/z}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
P_{LR} = \Big( \frac{p_{L}}{p_{R}} \Big)^{z}
,\quad
z = \frac{\gamma-1}{2\gamma}
\end{align}\]</div>
<p>The Two-Shock Riemann solver TSRS gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{ts} = \frac{g_{L}(p_{0})p_{L} + g_{R}(p_{0})p_{R} - \Delta u}{g_{L}(p_{0}) + g_{R}(p_{0})}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g_{K}(p) = \Big[ \frac{A_{K}}{p + B_{K}} \Big]^{1/2}
,\quad
p_{0} = \max(0, p_{pvrs})
\end{align}\]</div>
<p>for <span class="math notranslate nohighlight">\(K=L\)</span> and <span class="math notranslate nohighlight">\(K=R\)</span> .</p>
<p>In computational practice we could use the hybrid scheme to determine <span class="math notranslate nohighlight">\(p_{*}\)</span> . The HLL approximate Riemann solver with the hybrid pressure-based wave speed estimates has been implemented in the NAG routine D03PXF for Godunov-type methods to solve the time-dependent, one dimensional Euler equations for ideal gases. For ideal gases we find that the simplified PVRS scheme, with <span class="math notranslate nohighlight">\(p_{*} = \max(0, p_{pvrs})\)</span> is very simple and also is found to be sufficiently robust.</p>
</div>
</div>
<div class="section" id="contact-waves-and-passive-scalars">
<h3>Contact Waves and Passive Scalars<a class="headerlink" href="#contact-waves-and-passive-scalars" title="永久链接至标题">¶</a></h3>
<p>Here we study the special case of a passive scalar <span class="math notranslate nohighlight">\(q(x,t)\)</span> transported with the fluid speed <span class="math notranslate nohighlight">\(u(x,t)\)</span> . The time-dependent, one dimensional Euler equations are augmented by the extra conservation law</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho q)_{t} + (\rho qu)_{x} = 0
\end{align}\]</div>
<p>Consider the special IVP in which <span class="math notranslate nohighlight">\(p,\rho,u\)</span> are constant and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
q(x,0) = q_{0}(x) = \left\{ \begin{array}{l}
q_{L} \quad \text{if}~ x\le0 \\
q_{R} \quad \text{if}~ x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>Clearly, the non-trivial part of the exact solution is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
q(x,t) = q_{0}(x-ut)
\end{align}\]</div>
<p>Application of the HLL Riemann solver to this problem gives the following expression for the numerical flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{i+\frac{1}{2}}^{hll} = \frac{1}{2}\Big(1 + \frac{1}{M}\Big)f_{i} + \frac{1}{2}\Big(1 - \frac{1}{M}\Big)f_{i+1}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(M=\frac{u}{a}\)</span> is the Mach number and the wave speeds have been taken to be</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S_{L} = u - a
,\quad
S_{R} = u + a
\end{align}\]</div>
<p>Obviously, this flux applies only in the subsonic regime <span class="math notranslate nohighlight">\(u-a \le 0 \le u+a\)</span> . For sonic flow, the flux reduces identically to the Godunov flux computed from the exact Riemann solver. For subsonic flow <span class="math notranslate nohighlight">\(1/M &gt; 1\)</span> and the resulting scheme is more diffusive than the Godunov method when used in the conjunction with the exact Riemann solver. For the special case</p>
<div class="math notranslate nohighlight">
\[\begin{align}
M = \frac{u\Delta t}{\Delta x}
\end{align}\]</div>
<p>the HLL scheme reproduces the Lax-Friedrichs method, which is exceedingly diffusive. The limiting case of a stationary passive scalar is the worst. Note that the analysis includes the important cases <span class="math notranslate nohighlight">\(q=v\)</span> and <span class="math notranslate nohighlight">\(q=w\)</span> , the tangential velocity components in three-dimensional flow.</p>
<p>The analysis for an isolated contact can be carried out in a similar manner; by using an appropriate choice of the wave speeds the resulting HLL flux is identical to <span class="math notranslate nohighlight">\(f_{i+\frac{1}{2}}^{hll} = \frac{1}{2}\Big(1 + \frac{1}{M}\Big)f_{i} + \frac{1}{2}\Big(1 - \frac{1}{M}\Big)f_{i+1}\)</span> , and thus the same observations as for a passive scalar apply. The HLLC solver, on the other hand, behaves as the exact Riemann solver; for the limiting case in which the wave is stationary, the HLLC numerical scheme gives infinite resolution; the reader can verify this algebraically. The relevance of these observations is that the HLL scheme, unlike the HLLC scheme, will add excessive numerical dissipation to the resolution of spacial but important flow features such as material interfaces, shear waves and vortices.</p>
</div>
</div>
<div class="section" id="the-riemann-solver-of-roe">
<h2>The Riemann Solver of Roe<a class="headerlink" href="#the-riemann-solver-of-roe" title="永久链接至标题">¶</a></h2>
<div class="section" id="bases-of-the-roe-approach">
<h3>Bases of the Roe Approach<a class="headerlink" href="#bases-of-the-roe-approach" title="永久链接至标题">¶</a></h3>
<div class="section" id="the-exact-riemann-problem-and-the-godunov-flux">
<h4>The Exact Riemann Problem and the Godunov Flux<a class="headerlink" href="#the-exact-riemann-problem-and-the-godunov-flux" title="永久链接至标题">¶</a></h4>
<p>We concerned with solving numerically the general Initial Boundary Value Problem (IBVP)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \mathbf{U}^{(0)}(x) \\
&amp; \mathbf{U}(0,t) = \mathbf{U}_{l}(t) ,\quad \mathbf{U}(L,t) = \mathbf{U}_{r}(t)
\end{align}\end{split}\]</div>
<p>in a domain <span class="math notranslate nohighlight">\(x_{l} \le x \le x_{r}\)</span> , utilising the explicit conservative formula</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} + \frac{\Delta t}{\Delta x}[\mathbf{F}_{i-\frac{1}{2}} - \mathbf{F}_{i+\frac{1}{2}}]
\end{align}\]</div>
<p>We assume the solution of IBVP exists. We defined the Godunov intercell numerical flux</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{i+\frac{1}{2}}(0))
\end{align}\]</div>
<p>in which <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0)\)</span> is the exact similarity solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> of the Riemann problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \left\{ \begin{array}{l}
\mathbf{U}_{L} \quad \text{if}~ x&lt;0 \\
\mathbf{U}_{R} \quad \text{if}~ x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>evaluated at <span class="math notranslate nohighlight">\(x/t=0\)</span> . Fig.11.1 shows the structure of the exact solution of the Riemann problem for the x-split three dimensional Euler equations, for which the vectors of conserved variables and fluxes are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} =
\begin{bmatrix}
\rho \\ \rho u \\ \rho v \\ \rho w \\ E
\end{bmatrix}
,\quad
\mathbf{F} =
\begin{bmatrix}
\rho u \\ \rho u^{2} + p \\ \rho u v \\ \rho u w \\ u(E + p)
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The Star Region between the left and right waves contains the unknowns of the problem. The particular value at <span class="math notranslate nohighlight">\(x/t=0\)</span> corresponds to the t-axis and is the value required by the Godunov flux. The piece-wise constant initial data, in terms of primitive variables, is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{W}_{L} =
\begin{bmatrix}
\rho_{L} \\ u_{L} \\ v_{L} \\ w_{L} \\ p_{L}
\end{bmatrix}
,\quad
\mathbf{W}_{R} =
\begin{bmatrix}
\rho_{R} \\ u_{R} \\ v_{R} \\ w_{R} \\ p_{R}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>We have provided an algorithm to compute the exact solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> and we utilised this solution in the Godunov method. We provided approximations to the state <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> and obtained a corresponding approximate Godunov method by evaluating the physical flux function <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> at this approximate state. The purpose of this chapter is to find direct approximations to the flux function <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> following the approach proposed by Roe and Pike.</p>
</div>
<div class="section" id="approximate-conservation-laws">
<h4>Approximate Conservation Laws<a class="headerlink" href="#approximate-conservation-laws" title="永久链接至标题">¶</a></h4>
<p>Roe solved the Riemann problem approximately. By introducing the Jacobian matrix</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}(\mathbf{U}) = \frac{\partial \mathbf{F}}{\partial \mathbf{U}}
\end{align}\]</div>
<p>and using the chain rule the conservation laws may be written as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{A}(\mathbf{U})\mathbf{U}_{x} = \mathbf{0}
\end{align}\]</div>
<p>Roe’s approach replaces the Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{A}(\mathbf{U})\)</span> by a constant Jacobian matrix</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\mathbf{A}} = \tilde{\mathbf{A}}(\mathbf{U}_{L}, \mathbf{U}_{R})
\end{align}\]</div>
<p>which is a function of the data states <span class="math notranslate nohighlight">\(\mathbf{U}_{L}, \mathbf{U}_{R}\)</span> . In this way the original PDEs are replaced by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \tilde{\mathbf{A}}\mathbf{U}_{x} = \mathbf{0}
\end{align}\]</div>
<p>This is a linear system with constant coefficients. The original Riemann problem is then replaced by the approximate Riemann problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \tilde{\mathbf{A}}\mathbf{U}_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \left\{ \begin{array}{l}
\mathbf{U}_{L} ,\quad x&lt;0 \\
\mathbf{U}_{R} ,\quad x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>which is then solved exactly. The approximate problem results from replacing the original non-linear conservation laws by a linearised system with constant coefficients but the initial data of the exact problem is retained.</p>
<p>For a general hyperbolic system of <span class="math notranslate nohighlight">\(m\)</span> conservation laws, the Roe Jacobian matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> is required to satisfy the following properties:</p>
<p>Property (A): Hyperbolicity of the system. <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> is required to have real eigenvalues <span class="math notranslate nohighlight">\(\tilde{\lambda}_{i} = \tilde{\lambda}_{i}(\mathbf{U}_{L}, \mathbf{U}_{R})\)</span> , which we choose to order as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\lambda}_{1} \le \tilde{\lambda}_{2} \le \cdots \le \tilde{\lambda}_{m}
\end{align}\]</div>
<p>and a complete set of linearly independent right eigenvectors</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\mathbf{K}}^{(1)} ,\quad \tilde{\mathbf{K}}^{(2)} , \cdots , \tilde{\mathbf{K}}^{(m)}
\end{align}\]</div>
<p>Property (B): Consistency with the exact Jacobian</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\mathbf{A}}(\mathbf{U},\mathbf{U}) = \mathbf{A}(\mathbf{U})
\end{align}\]</div>
<p>Property (C): Conservation across discontinuities</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}(\mathbf{U}_{R}) - \mathbf{F}(\mathbf{U}_{L}) = \tilde{\mathbf{A}}(\mathbf{U}_{R} - \mathbf{U}_{L})
\end{align}\]</div>
<p>Property (A) on hyperbolicity is an obvious requirement; the approximate problem should at the very least preserve the mathematical character of the original non-linear system. Property (B) ensures consistency with the conservation laws. Property (C) ensures conservation. It also ensures exact recognition of isolated discontinuities; that is, if the data <span class="math notranslate nohighlight">\(\mathbf{U}_{L}, \mathbf{U}_{R}\)</span> are connected by a single, isolated discontinuity, then the approximate Riemann solver recognises this wave exactly. Note however that this does not mean that the corresponding, approximate, Godunov method with the Roe approximate numerical flux will in general give exact solutions for isolated discontinuities.</p>
<p>The construction of matrices satisfying properties (A)-(C) for general hyperbolic systems can be very complicated and thus computationally unattractive. For the specific case of the Euler equations of Gas Dynamics Roe proposed a relatively simple way of constructing a matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> . Later, Roe and Pike proposed a simpler approach, where the explicit construction of <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> is actually avoided.</p>
</div>
<div class="section" id="the-approximate-riemann-problem-and-the-intercell-flux">
<h4>The Approximate Riemann Problem and the Intercell Flux<a class="headerlink" href="#the-approximate-riemann-problem-and-the-intercell-flux" title="永久链接至标题">¶</a></h4>
<p>Once the matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}(\mathbf{U}_{L},\mathbf{U}_{R})\)</span> , its eigenvalues <span class="math notranslate nohighlight">\(\tilde{\lambda}_{i}(\mathbf{U}_{L},\mathbf{U}_{R})\)</span> and right eigenvectors <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{(i)}(\mathbf{U}_{L},\mathbf{U}_{R})\)</span> are available, one solves the Riemann problem by direct application of methods discussed for linear hyperbolic systems with constant coefficients. By projecting the data difference</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta \mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L}
\end{align}\]</div>
<p>onto the right eigenvectors we write</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta \mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L} = \sum_{i=1}^{m}\tilde{\alpha}_{i}\tilde{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>from which one finds the wave strengths <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i} = \tilde{\alpha}_{i}(\mathbf{U}_{L},\mathbf{U}_{R})\)</span> . The solution <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(x/t)\)</span> evaluated along the t-axis, <span class="math notranslate nohighlight">\(x/t=0\)</span> , is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{L} + \sum_{\tilde{\lambda}_{i} \le 0}\tilde{\alpha}_{i}\tilde{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{R} - \sum_{\tilde{\lambda}_{i} \ge 0}\tilde{\alpha}_{i}\tilde{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>We now find the corresponding numerical flux. Recall that we have replaced the original set of conservation laws by the constant coefficient linear system; this can be viewed as a modified system of conservation laws</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\mathbf{U}}_{t} + \overline{\mathbf{F}}(\overline{\mathbf{U}})_{x} = \mathbf{0}
\end{align}\]</div>
<p>with flux function</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\mathbf{F}}(\overline{\mathbf{U}}) = \tilde{\mathbf{A}}\overline{\mathbf{U}}
\end{align}\]</div>
<p>The corresponding numerical flux is not the choice <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}=\tilde{\mathbf{A}}\overline{\mathbf{U}}_{i+\frac{1}{2}}(0)\)</span> . That this would be incorrect becomes obvious when, for instance, assuming right supersonic flow in the expression of <span class="math notranslate nohighlight">\(\mathbf{\mathbf{U}}_{i+\frac{1}{2}}(0)\)</span> one would compute an intercell flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}} \ne \mathbf{F}_{L}\)</span> . Instead, the correct expression for the corresponding numerical flux is obtained from any of the integral relations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{F}_{0L} = \mathbf{F}_{L} - S_{L}\mathbf{U}_{L} - \frac{1}{T}\int_{TS_{L}}^{0}\mathbf{U}(x,T)\mathrm{d}x \\
&amp; \mathbf{F}_{0R} = \mathbf{F}_{R} - S_{R}\mathbf{U}_{R} + \frac{1}{T}\int_{0}^{TS_{R}}\mathbf{U}(x,T)\mathrm{d}x
\end{align}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(S_{L}, S_{R}\)</span> are the smallest and largest signal speeds in the exact solution of the Riemann problem with data <span class="math notranslate nohighlight">\(\mathbf{U}_{L}, \mathbf{U}_{R}\)</span> and <span class="math notranslate nohighlight">\(T\)</span> is a positive time. If the integrand <span class="math notranslate nohighlight">\(\mathbf{U}(x,t)\)</span> is replaced by some approximate solution, then equality of the fluxes <span class="math notranslate nohighlight">\(\mathbf{F}_{0L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{0R}\)</span> requires the approximate solution to satisfy a Consistency Condition.</p>
<p>If <span class="math notranslate nohighlight">\(\overline{\mathbf{U}}_{i+\frac{1}{2}}(x,t)\)</span> is the solution of the Riemann problem for the modified conservation laws with data <span class="math notranslate nohighlight">\(\mathbf{U}_{L},\mathbf{U}_{R}\)</span> , then the integrals in the above two relations respectively, are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{TS_{L}}^{0}\overline{\mathbf{U}}_{i+\frac{1}{2}}(x,T)\mathrm{d}x
= T [\overline{\mathbf{F}}(\mathbf{U}_{L}) - \overline{\mathbf{F}}(\overline{\mathbf{U}}_{i+\frac{1}{2}}(0))]
- TS_{L}\mathbf{U}_{L}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{0}^{TS_{R}}\overline{\mathbf{U}}_{i+\frac{1}{2}}(x,T)\mathrm{d}x
= T [\overline{\mathbf{F}}(\overline{\mathbf{U}}_{i+\frac{1}{2}}(0)) - \overline{\mathbf{\mathbf{F}}}(\mathbf{U}_{R})]
+ TS_{R}\mathbf{U}_{R}
\end{align}\]</div>
<p>Substitution of these two expressions into the integral relations gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{0L} = \overline{\mathbf{F}}(\overline{\mathbf{U}}_{i+\frac{1}{2}}(0))
+ \mathbf{F}(\mathbf{U}_{L}) - \overline{\mathbf{F}}(\mathbf{U}_{L})
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{0R} = \overline{F}(\overline{\mathbf{U}}_{i+\frac{1}{2}}(0))
+ \mathbf{F}(\mathbf{U}_{R}) - \overline{\mathbf{F}}(\mathbf{U}_{R})
\end{align}\]</div>
<p>Finally, by using <span class="math notranslate nohighlight">\(\overline{\mathbf{U}}_{i+\frac{1}{2}}(0)\)</span> as given by <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{L} + \sum_{\tilde{\lambda}_{i} \le 0}\tilde{\alpha}_{i}\tilde{\mathbf{K}}^{(i)}\)</span> or <span class="math notranslate nohighlight">\(\mathbf{U}_{i+\frac{1}{2}}(0) = \mathbf{U}_{R} - \sum_{\tilde{\lambda}_{i} \ge 0}\tilde{\alpha}_{i}\tilde{\mathbf{K}}^{(i)}\)</span> and the definition of the flux <span class="math notranslate nohighlight">\(\overline{\mathbf{F}} = \tilde{\mathbf{A}}\overline{\mathbf{U}}\)</span> we obtain the numerical flux as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{L} + \sum_{\tilde{\lambda}_{i} \le 0}\tilde{\alpha}_{i}\tilde{\lambda}_{i}\tilde{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{R} - \sum_{\tilde{\lambda}_{i} \ge 0} \tilde{\alpha}_{i}\tilde{\lambda}_{i}\tilde{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>Alternatively, we may also write</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \frac{1}{2}(\mathbf{F}_{L} + \mathbf{F}_{R})
- \frac{1}{2} \sum_{i=1}^{m} \tilde{\alpha}_{i}|\tilde{\lambda}_{i}|\tilde{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>We remark that all previous relations are valid for any hyperbolic system and any linearisation of it. In order to compute Roe’s numerical flux for a particular system of hyperbolic conservation laws, one requires expressions for the wave strengths <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}\)</span> , the eigenvalues <span class="math notranslate nohighlight">\(\tilde{\lambda}_{i}\)</span> and the right eigenvectors <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{(i)}\)</span> in any of the flux expressions. Note that the Jacobian matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}(\mathbf{U}_{L}, \mathbf{U}_{R})\)</span> is not explicitly required by the numerical flux. In the next two sections we give detials on methodologies to find <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}, \tilde{\lambda}_{i}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{i}\)</span> . There are two approaches, namely the original approach presented by Roe and the Roe-Pike approach.</p>
</div>
</div>
<div class="section" id="the-original-roe-method">
<h3>The Original Roe Method<a class="headerlink" href="#the-original-roe-method" title="永久链接至标题">¶</a></h3>
<p>In order for the approximate Godunov method with the Roe-type numerical flux to be completely determined, we need to find the average eigenvalues <span class="math notranslate nohighlight">\(\tilde{\lambda}_{i}\)</span> , the corresponding averaged right eigenvectors <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{(i)}\)</span> and averaged wave strengths <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}\)</span> . In his original paper Roe finds an averaged Jacobian matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> , the Roe matrix, from which <span class="math notranslate nohighlight">\(\tilde{\lambda}_{i}, \tilde{\mathbf{K}}^{(i)}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}\)</span> follow directly. In constructing a matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> the properties (A)-(C) are enforced. It is not difficult to think of candidates <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> that satisfy the first two properties. Property C is crucial and is the one that narrows down the choices. Roe showed that the existence of a matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> satisfying Property C is assured by the mean value theorem. An early line of attack in constructing a matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> satisfying all desirable properties is reported by Sells. Roe identifies some disadvantages of this approach; it is argued, for instance, that the construction is far from unique and that the resulting schemes are too complicated.</p>
<p>A breakthrough in constructing <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> resulted from Roe’s ingenious idea of introducing a parameter vector <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> , such that both the vector of conserved variables <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> and the flux vector <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> could be expressed in terms of <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> . That is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U} = \mathbf{U}(\mathbf{Q})
,\quad
\mathbf{F} = \mathbf{F}(\mathbf{Q})
\end{align}\]</div>
<p>Two important steps then follow. First, the changes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta \mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L}
,\quad
\Delta \mathbf{F} = \mathbf{F}(\mathbf{U}_{R}) - \mathbf{F}(\mathbf{U}_{L})
\end{align}\]</div>
<p>can be expressed in terms of the change <span class="math notranslate nohighlight">\(\Delta \mathbf{Q} = \mathbf{Q}_{R} - \mathbf{Q}_{L}\)</span> . Then, averages are obtained in terms of simple arithmetic means of <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> . Next, we illustrate the technique as applied to a simple set of conservation laws.</p>
<div class="section" id="the-isothermal-equations">
<h4>The Isothermal Equations<a class="headerlink" href="#the-isothermal-equations" title="永久链接至标题">¶</a></h4>
<p>Consider the isothermal equations</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} \equiv \begin{bmatrix} u_{1} \\ u_{2} \end{bmatrix} \equiv \begin{bmatrix} \rho \\ \rho u \end{bmatrix}
,\quad
\mathbf{F} \equiv \begin{bmatrix} f_{1} \\ f_{2} \end{bmatrix} \equiv \begin{bmatrix} \rho u \\ \rho u^{2} + a^{2}\rho \end{bmatrix}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is a constant sound speed. The exact Jacobian, eigenvalues and corresponding right eigenvectors are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{A}(\mathbf{U}) =
\begin{bmatrix}
0 &amp; 1 \\
a^{2}-u^{2} &amp; 2u
\end{bmatrix}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} = u - a
,\quad
\lambda_{2} = u + a
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K}^{(1)} =
\begin{bmatrix}
1 \\ u-a
\end{bmatrix}
,\quad
\mathbf{K}^{(2)} =
\begin{bmatrix}
1 \\ u+a
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>Choose the parameter vector</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{Q} \equiv \begin{bmatrix} q_{1} \\ q_{2} \end{bmatrix}
\equiv \frac{\mathbf{U}}{\sqrt{\rho}}
= \begin{bmatrix} \sqrt{\rho} \\ \sqrt{\rho} u \end{bmatrix}
\end{align}\end{split}\]</div>
<p>Then <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> can be expressed in terms of the components <span class="math notranslate nohighlight">\(q_{1},q_{2}\)</span> of <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} \equiv \begin{bmatrix} u_{1} \\ u_{2} \end{bmatrix}
\equiv q_{1}\mathbf{Q}
= \begin{bmatrix} q_{1}^{2} \\ q_{1}q_{2} \end{bmatrix}
\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F} \equiv \begin{bmatrix} f_{1} \\ f_{2} \end{bmatrix}
\equiv \begin{bmatrix} q_{1}q_{2} \\ q_{2}^{2}+a^{2}q_{1}^{2} \end{bmatrix}
\end{align}\end{split}\]</div>
<p>One now looks for an averaged vector <span class="math notranslate nohighlight">\(\tilde{\mathbf{Q}} = (\tilde{q}_{1}, \tilde{q}_{2})^{T}\)</span> . This is found by simple arithmetic averaging</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{Q}} = \begin{bmatrix} \tilde{q}_{1} \\ \tilde{q}_{2} \end{bmatrix}
= \frac{1}{2}(\mathbf{Q}_{L} + \mathbf{Q}_{R})
= \frac{1}{2}
\begin{bmatrix}
\sqrt{\rho_{L}} + \sqrt{\rho_{R}} \\
\sqrt{\rho_{L}}u_{L} + \sqrt{\rho_{R}}u_{R}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>Then two matrices <span class="math notranslate nohighlight">\(\tilde{\mathbf{B}}=\tilde{\mathbf{B}}(\tilde{\mathbf{Q}})\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{C}}=\tilde{\mathbf{C}}(\tilde{\mathbf{Q}})\)</span> are found, such that the jumps <span class="math notranslate nohighlight">\(\Delta \mathbf{U}\)</span> and <span class="math notranslate nohighlight">\(\Delta \mathbf{F}\)</span> can be expressed in terms of the jump <span class="math notranslate nohighlight">\(\Delta \mathbf{Q}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \tilde{\mathbf{B}}\Delta\mathbf{Q}
,\quad
\Delta\mathbf{F} = \tilde{\mathbf{C}}\Delta\mathbf{Q}
\end{align}\]</div>
<p>Use of these two expressions produces</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{F} = (\tilde{\mathbf{C}}\tilde{\mathbf{B}}^{-1})\Delta\mathbf{U}
\end{align}\]</div>
<p>which if compared with condition (C) produces the Roe averaged matrix</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\mathbf{A}} = \tilde{\mathbf{C}}\tilde{\mathbf{B}}^{-1}
\end{align}\]</div>
<p>Matrices <span class="math notranslate nohighlight">\(\tilde{\mathbf{B}}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{C}}\)</span> satisfying <span class="math notranslate nohighlight">\(\Delta\mathbf{U} = \tilde{\mathbf{B}}\Delta\mathbf{Q}\)</span> and <span class="math notranslate nohighlight">\(\Delta\mathbf{F} = \tilde{\mathbf{C}}\Delta\mathbf{Q}\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{B}} =
\begin{bmatrix}
2\tilde{q}_{1} &amp; 0 \\
\tilde{q}_{2} &amp; \tilde{q}_{1}
\end{bmatrix}
,\quad
\tilde{\mathbf{C}} =
\begin{bmatrix}
\tilde{q}_{2} &amp; \tilde{q}_{1} \\
2a^{2}\tilde{q}_{1} &amp; 2\tilde{q}_{2}^{2}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The sought Roe matrix is then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{A}} =
\begin{bmatrix}
0 &amp; 1 \\
a^{2}-\tilde{u}^{2} &amp; 2\tilde{u}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{u}\)</span> is the Roe averaged velocity and is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u} = \frac{\sqrt{\rho_{L}}u_{L} + \sqrt{\rho_{R}}u_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<p>As the sound speed <span class="math notranslate nohighlight">\(a\)</span> is constant, no averaged <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> is required.</p>
<p>Having found <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> one computes the averaged eigenvalues, eigenvectors and wave strengths. The eigenvalues of <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\lambda}_{1} = \tilde{u} - a
,\quad
\tilde{\lambda}_{2} = \tilde{u} + a
\end{align}\]</div>
<p>and are all real. The corresponding averaged right eigenvectors are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{K}}^{(1)} =
\begin{bmatrix}
1 \\ \tilde{u}-a
\end{bmatrix}
,\quad
\tilde{\mathbf{K}}^{(2)} =
\begin{bmatrix}
1 \\ \tilde{u}+a
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>and are easily seen to be linearly independent. Thus condition (A) is satisfied. To find the wave strengths <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}\)</span> we solve the <span class="math notranslate nohighlight">\(2 \times 2\)</span> linear system</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\Delta \mathbf{U} \equiv \begin{bmatrix} \Delta u_{1} \\ \Delta u_{2} \end{bmatrix}
= \sum_{i=1}^{2}\tilde{\alpha}_{i}\tilde{\mathbf{K}}^{(i)}
\end{align}\end{split}\]</div>
<p>The solution is easily verified to be</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \tilde{\alpha}_{1} = \frac{\Delta u_{1} (\tilde{u} + a) - \Delta u_{2}}{2a} \\
&amp; \tilde{\alpha}_{2} = \frac{-\Delta u_{1} (\tilde{u} - a) + \Delta u_{2}}{2a}
\end{align}\end{split}\]</div>
<p>with the obvious definitions <span class="math notranslate nohighlight">\(\Delta u_{1} \equiv \rho_{R} - \rho_{L}\)</span> , <span class="math notranslate nohighlight">\(\Delta u_{2} \equiv \rho_{R}u_{R} - \rho_{L}u_{L}\)</span> . The corresponding Roe numerical flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> now follows from using the above expressions into any of the flux expressions given before.</p>
</div>
<div class="section" id="the-euler-equations">
<h4>The Euler Equations<a class="headerlink" href="#the-euler-equations" title="永久链接至标题">¶</a></h4>
<p>Here we present the Roe Riemann solver as applied to the Riemann problem for the x-split three dimensional time dependent Euler equations for ideal gases.</p>
<p>The exact, x-direction Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{A}(\mathbf{U})\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{A} =
\begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
\hat{\gamma}H - u^{2} - a^{2} &amp; (3-\gamma)u &amp; -\hat{\gamma}v &amp; -\hat{\gamma}w &amp; \hat{\gamma} \\
-uv &amp; v &amp; u &amp; 0 &amp; 0 \\
-uw &amp; w &amp; 0 &amp; u &amp; 0 \\
\frac{1}{2}u[(\gamma-3)H-a^{2}] &amp; H-\hat{\gamma}u^{2} &amp; -\hat{\gamma}uv &amp; -\hat{\gamma}uw &amp; \gamma u
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{\gamma} = \gamma - 1\)</span> . The eigenvalues are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} = u - a
,\quad
\lambda_{2} = \lambda_{3} = \lambda_{4} = u
,\quad
\lambda_{5} = u + a
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(a = \sqrt{\gamma p/\rho}\)</span> is the sound speed. The corresponding right eigenvectors are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K}^{(1)} =
\begin{bmatrix}
1 \\ u-a \\ v \\ w \\ H-ua
\end{bmatrix}
,\quad
\mathbf{K}^{(2)} =
\begin{bmatrix}
1 \\ u \\ v \\ w \\ \frac{1}{2}\mathbf{V}^{2}
\end{bmatrix}
,\quad
\mathbf{K}^{(3)} =
\begin{bmatrix}
0 \\ 0 \\ 1 \\ 0 \\ v
\end{bmatrix}
,\quad
\mathbf{K}^{(4)} =
\begin{bmatrix}
0 \\ 0 \\ 0 \\ 1 \\ w
\end{bmatrix}
,\quad
\mathbf{K}^{(5)} =
\begin{bmatrix}
1 \\ u+a \\ v \\ w \\ H+ua
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(H\)</span> is the total enthalpy</p>
<div class="math notranslate nohighlight">
\[\begin{align}
H = \frac{E + p}{\rho}
\end{align}\]</div>
<p>and <span class="math notranslate nohighlight">\(E\)</span> is the total energy per unit volume</p>
<div class="math notranslate nohighlight">
\[\begin{align}
E = \frac{1}{2}\rho\mathbf{V}^{2} + \rho e
\end{align}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{V}^{2} = u^{2} + v^{2} + w^{2}
\end{align}\]</div>
<p>and <span class="math notranslate nohighlight">\(e\)</span> denoting the specific internal energy, which for ideal gases is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
e = \frac{p}{(\gamma - 1)\rho}
\end{align}\]</div>
<p>Roe chooses the parameter vector</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{Q} \equiv \begin{bmatrix} q_{1} \\ q_{2} \\ q_{3} \\ q_{4} \\ q_{5} \end{bmatrix}
\equiv \sqrt{\rho} \begin{bmatrix} 1 \\ u \\ v \\ w \\ H \end{bmatrix}
\end{align}\end{split}\]</div>
<p>which has the property that every component <span class="math notranslate nohighlight">\(u_{i}\)</span> of <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> and every component <span class="math notranslate nohighlight">\(f_{i}\)</span> of <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> is a quadratic in the components <span class="math notranslate nohighlight">\(q_{i}\)</span> of <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> . For instance <span class="math notranslate nohighlight">\(u_{1} = q_{1}^{2}\)</span> and <span class="math notranslate nohighlight">\(f_{1} = q_{1}q_{2}\)</span> , etc. Actually, the property is also valid for the components of the <span class="math notranslate nohighlight">\(\mathbf{G}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> fluxes for the full three-dimensional Euler equations.</p>
<p>As done for the isothermal equations, one can express the jumps <span class="math notranslate nohighlight">\(\Delta\mathbf{U}\)</span> and <span class="math notranslate nohighlight">\(\Delta\mathbf{F}\)</span> in terms of the jump <span class="math notranslate nohighlight">\(\Delta\mathbf{Q}\)</span> via two matrices <span class="math notranslate nohighlight">\(\tilde{\mathbf{B}}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{C}}\)</span> . Roe gives the following expressions</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{B}} =
\begin{bmatrix}
2\tilde{q}_{1} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\tilde{q}_{2} &amp; \tilde{q}_{1} &amp; 0 &amp; 0 &amp; 0 \\
\tilde{q}_{3} &amp; 0 &amp; \tilde{q}_{1} &amp; 0 &amp; 0 \\
\tilde{q}_{4} &amp; 0 &amp; 0 &amp; \tilde{q}_{1} &amp; 0 \\
\frac{\tilde{q}_{5}}{\gamma} &amp; \frac{\gamma-1}{\gamma}\tilde{q}_{2} &amp; \frac{\gamma-1}{\gamma}\tilde{q}_{3} &amp; \frac{\gamma-1}{\gamma}\tilde{q}_{4} &amp; \frac{\tilde{q}_{1}}{\gamma}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{C}} =
\begin{bmatrix}
\tilde{q}_{2} &amp; \tilde{q}_{1} &amp; 0 &amp; 0 &amp; 0 \\
\frac{\gamma-1}{\gamma}\tilde{q}_{5} &amp; \frac{\gamma+1}{\gamma}\tilde{q}_{2} &amp; -\frac{\gamma-1}{\gamma}\tilde{q}_{3} &amp; -\frac{\gamma-1}{\gamma}\tilde{q}_{4} &amp; \frac{\gamma-1}{\gamma}\tilde{q}_{1} \\
0 &amp; \tilde{q}_{3} &amp; \tilde{q}_{2} &amp; 0 &amp; 0 \\
0 &amp; \tilde{q}_{4} &amp; 0 &amp; \tilde{q}_{2} &amp; 0 \\
0 &amp; \tilde{q}_{5} &amp; 0 &amp; 0 &amp; \tilde{q}_{2}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The sought Roe matrix is then given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\mathbf{A}} = \tilde{\mathbf{B}}\tilde{\mathbf{C}}^{-1}
\end{align}\]</div>
<p>The eigenvalues of <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\lambda}_{1} = \tilde{u} - \tilde{a}
,\quad
\tilde{\lambda}_{2} = \tilde{\lambda}_{3} = \tilde{\lambda}_{4} = \tilde{u}
,\quad
\tilde{\lambda}_{5} = \tilde{u} + \tilde{a}
\end{align}\]</div>
<p>and the corresponding right eigenvectors are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde{\mathbf{K}}^{(1)} =
\begin{bmatrix}
1 \\ \tilde{u}-\tilde{a} \\ \tilde{v} \\ \tilde{w} \\ \tilde{H}-\tilde{u}\tilde{a}
\end{bmatrix}
,\quad
\tilde{\mathbf{K}}^{(2)} =
\begin{bmatrix}
1 \\ \tilde{u} \\ \tilde{v} \\ \tilde{w} \\ \frac{1}{2}\tilde{\mathbf{V}}^{2}
\end{bmatrix}
,\quad
\tilde{\mathbf{K}}^{(3)}
\begin{bmatrix}
0 \\ 0 \\ 1 \\ 0 \\ \tilde{v}
\end{bmatrix}
,\quad
\mathbf{K}^{(4)} =
\begin{bmatrix}
0 \\ 0 \\ 0 \\ 1 \\ \tilde{w}
\end{bmatrix}
,\quad
\mathbf{K}^{(5)} =
\begin{bmatrix}
1 \\ \tilde{u}+\tilde{a} \\ \tilde{v} \\ \tilde{w} \\ \tilde{H}+\tilde{u}\tilde{a}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>The symbol <span class="math notranslate nohighlight">\(\tilde{r}\)</span> denotes a Roe average for a variable <span class="math notranslate nohighlight">\(r\)</span> . The relevant averages are given as follows</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u} = \frac{\sqrt{\rho_{L}}u_{L} + \sqrt{\rho_{R}}u_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{v} = \frac{\sqrt{\rho_{L}}v_{L} + \sqrt{\rho_{R}}v_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{w} = \frac{\sqrt{\rho_{L}}w_{L} + \sqrt{\rho_{R}}w_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{H} = \frac{\sqrt{\rho_{L}}H_{L} + \sqrt{\rho_{R}}H_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{a} = \Big( (\gamma-1)(\tilde{H} - \frac{1}{2}\tilde{\mathbf{V}}^{2}) \Big)^{\frac{1}{2}}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{\mathbf{V}}^{2} = \tilde{u} + \tilde{v} + \tilde{w}^{2}\)</span> .</p>
<p>In order to determin completely the Roe numerical flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> we need, in addition, the wave strengths <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}\)</span> . These are obtained by projecting the jump <span class="math notranslate nohighlight">\(\Delta\mathbf{U}\)</span> onto the right, averaged eigenvectors, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \sum_{i=1}^{5}\tilde{\alpha}_{i}\tilde{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>when written in full these equations read</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\alpha}_{1} + \tilde{\alpha}_{2} + \tilde{\alpha}_{5} = \Delta u_{1}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\alpha}_{1}(\tilde{u} - \tilde{a}) + \tilde{\alpha}_{2}\tilde{u} + \tilde{\alpha}_{5}(\tilde{u} + \tilde{a}) = \Delta u_{2}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\alpha}_{1}\tilde{v} + \tilde{\alpha}_{2}\tilde{v} + \tilde{\alpha}_{3} + \tilde{\alpha}_{5}\tilde{v} = \Delta u_{3}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\alpha}_{1}\tilde{w} + \tilde{\alpha}_{2}\tilde{w} + \tilde{\alpha}_{4} + \tilde{\alpha}_{5}\tilde{w} = \Delta u_{4}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\alpha}_{1}(\tilde{H} - \tilde{u}\tilde{a}) + \frac{1}{2}\tilde{\mathbf{V}}^{2}\tilde{\alpha}_{2} + \tilde{\alpha}_{3}\tilde{v} + \tilde{\alpha}_{4}\tilde{w} + \tilde{\alpha}_{5}(\tilde{H} + \tilde{u}\tilde{a}) = \Delta u_{5}
\end{align}\]</div>
<p>Here the right-hand side terms are knowns: they are jumps <span class="math notranslate nohighlight">\(\Delta u_{i}\)</span> in the conserved quantity <span class="math notranslate nohighlight">\(u_{i}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta u_{i} = (u_{i})_{R} - (u_{i})_{L}
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>Before solving these equations we note that in the purely one-dimensional case</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{v} = \tilde{w} = 0
,\quad
\tilde{\alpha}_{3} = \tilde{\alpha}_{4} = 0
,\quad
\tilde{\mathbf{K}}^{(3)} = \tilde{\mathbf{K}}^{(4)} = \mathbf{0}
\end{align}\]</div>
<p>and the problem reduces to solving for <span class="math notranslate nohighlight">\(\tilde{\alpha}_{1}, \tilde{\alpha}_{2}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\alpha}_{5}\)</span> , with terms involving <span class="math notranslate nohighlight">\(\tilde{\alpha}_{3}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\alpha}_{4}\)</span> being absent.</p>
<p class="last">For the x-split dimensional problem the system may be viewed in exactly the same manner as for the one-dimensional case.</p>
</div>
<p>Solve the system and computationally it is convenient to arrange the solution as follows</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \tilde{\alpha}_{1} = \frac{1}{2\tilde{a}}[\Delta u_{1}(\tilde{u} + \tilde{a}) - \Delta u_{2} - \tilde{a} \tilde{\alpha}_{2}] \\
&amp; \tilde{\alpha}_{2} = \frac{\gamma-1}{\tilde{a}^{2}}\Big[ \Delta u_{1}(\tilde{H} - \tilde{u}^{2}) + \tilde{u}\Delta u_{2} - \overline{\Delta u_{5}} \Big] \\
&amp; \tilde{\alpha}_{3} = \Delta u_{3} - \tilde{v}\Delta u_{1} \\
&amp; \tilde{\alpha}_{4} = \Delta u_{4} - \tilde{w}\Delta u_{1} \\
&amp; \tilde{\alpha}_{5} = \Delta u_{1} - (\tilde{\alpha}_{1} + \tilde{\alpha}_{2})
\end{align}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\Delta u_{5}} = \Delta u_{5} - (\Delta u_{3} - \tilde{v}\Delta u_{1})\tilde{v} - (\Delta u_{4} - \tilde{w}\Delta u_{1})\tilde{w}
\end{align}\]</div>
</div>
</div>
<div class="section" id="the-roe-pike-method">
<h3>The Roe-Pike Method<a class="headerlink" href="#the-roe-pike-method" title="永久链接至标题">¶</a></h3>
<p>Recall that solving the Riemann problem approximately using Roe’s method means finding averaged eigenvalues <span class="math notranslate nohighlight">\(\tilde{\lambda}_{i}\)</span> , right eigenvectors <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{(i)}\)</span> and wave strengths <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}\)</span> , so that the Roe numerical flux may be evaluated by any of the flux formulae. In the previous section this task was carried out by following the original Roe approach, where the averaged Jacobian matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> is first sought. In this section we present a different approach, due to Roe and Pike, whereby the construction of <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> is avoided; instead, one seeks directly averages of a set of scalar quantities that can then be used to evaluate the eigenvalues, right eigenvectors and wave strengths needed.</p>
<div class="section" id="the-approach">
<h4>The Approach<a class="headerlink" href="#the-approach" title="永久链接至标题">¶</a></h4>
<p>The approach assumes, of course, that the appropriate original system is hyperbolic and that analytical expressions for the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{i}\)</span> and the set of linearly independent right eigenvectors <span class="math notranslate nohighlight">\(\mathbf{K}^{(i)}\)</span> are available. Analytical expressions <span class="math notranslate nohighlight">\(\hat{\alpha}_{i}\)</span> for the wave strengths require extra work via an extra linearisation. One then selects a suitable vector of scalar quantities, typically the vector <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> of primitive variables or variations of it, for which an average <span class="math notranslate nohighlight">\(\tilde{\mathbf{W}}\)</span> is to be found. The values of <span class="math notranslate nohighlight">\(\tilde{\lambda}_{i}, \tilde{\mathbf{K}}^{(i)}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}\)</span> are then found by direct evaluation of the analytical expressions for <span class="math notranslate nohighlight">\(\lambda_{i}, \mathbf{K}^{(i)}\)</span> and <span class="math notranslate nohighlight">\(\hat{\alpha}_{i}\)</span> at the state <span class="math notranslate nohighlight">\(\tilde{\mathbf{W}}\)</span> . There are two distinct steps in the Roe-Pike approach.</p>
<div class="section" id="linearisation-about-a-reference-state">
<h5>Linearisation about a Reference State<a class="headerlink" href="#linearisation-about-a-reference-state" title="永久链接至标题">¶</a></h5>
<p>To find analytical expressions for the wave strengths <span class="math notranslate nohighlight">\(\alpha_{i}\)</span> Roe and Pike assume a linearised form of the governing equations based on the assumption that the data states <span class="math notranslate nohighlight">\(\mathbf{U}_{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{R}\)</span> are close to a reference state <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> , to order <span class="math notranslate nohighlight">\(O(\Delta^{2})\)</span> . Linearisation of the conservation laws about this state <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x}
\equiv \mathbf{U}_{t} + \Big( \frac{\partial \mathbf{F}}{\partial \mathbf{U}} \Big) \mathbf{U}_{x}
\approx \mathbf{U}_{t} + \hat{\mathbf{A}}\mathbf{U}_{x}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \hat{\mathbf{A}}\mathbf{U}_{x} = \mathbf{0}
\end{align}\]</div>
<p>is an approximation to the original conservation laws. Here <span class="math notranslate nohighlight">\(\hat{\mathbf{A}}\)</span> is the Jacobian matrix, assumed available, computed at the reference state <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> . Eigenvalues and right eigenvectors follow. Analytical expressions for the wave strengths <span class="math notranslate nohighlight">\(\hat{\alpha}_{i}\)</span> in the solution of the linear Riemann problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \hat{\mathbf{A}}\mathbf{U}_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \left\{ \begin{array}{l}
\mathbf{U}_{L} \quad \text{if}~ x&lt;0 \\
\mathbf{U}_{R} \quad \text{if}~ x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>are found by decomposing the data jump <span class="math notranslate nohighlight">\(\Delta \mathbf{U}\)</span> onto the right eigenvectors, in the usual way. That is we solve</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L} = \sum_{k=1}^{m}\hat{\alpha}_{k}\hat{\mathbf{K}}^{(k)}
\end{align}\]</div>
<p>Before proceeding, we note that this linearisation is not the Roe linearisation resulting from the Roe matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> ; it is merely a step to find some sufficiently simple analytical expressions for the wave strengths, which can then be evaluated at the unknown Roe-Pike average state <span class="math notranslate nohighlight">\(\tilde{\mathbf{W}}\)</span> , yet to be found.</p>
</div>
<div class="section" id="the-algebraic-problem-for-the-average-state">
<h5>The Algebraic Problem for the Average State<a class="headerlink" href="#the-algebraic-problem-for-the-average-state" title="永久链接至标题">¶</a></h5>
<p>The sought Roe-Pike average vector <span class="math notranslate nohighlight">\(\tilde{\mathbf{W}}\)</span> is then found by first setting</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\alpha}_{i} = \hat{\alpha}_{i}(\tilde{\mathbf{W}})
,\quad
\tilde{\lambda}_{i} = \lambda_{i}(\tilde{\mathbf{W}})
,\quad
\tilde{\mathbf{K}}^{(i)} = \mathbf{K}^{(i)}(\tilde{\mathbf{W}})
\end{align}\]</div>
<p>the analytical expressions for <span class="math notranslate nohighlight">\(\lambda_{i}, \mathbf{K}^{(i)}\)</span> and <span class="math notranslate nohighlight">\(\hat{\alpha}_{i}\)</span> are evaluated at the unknown average state <span class="math notranslate nohighlight">\(\tilde{\mathbf{W}}\)</span> . Then <span class="math notranslate nohighlight">\(\tilde{\mathbf{W}}\)</span> is found by solving the algebraic problem posed by the following two sets of equations</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L} = \sum_{k=1}^{m}\tilde{\alpha}_{k}\tilde{\mathbf{K}}^{(k)}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{F} = \mathbf{F}_{R} - \mathbf{F}_{L} = \sum_{k=1}^{m}\tilde{\alpha}_{k}\tilde{\lambda}_{k}\tilde{\mathbf{K}}^{(k)}
\end{align}\]</div>
<p>In the following section we illustrate the Roe-Pike approach in terms of a simple system of conservation laws.</p>
</div>
</div>
<div class="section" id="id40">
<h4>The Isothermal Equations<a class="headerlink" href="#id40" title="永久链接至标题">¶</a></h4>
<p>We solve the Riemann problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \left\{ \begin{array}{l}
\mathbf{U}_{L} \quad \text{if}~ x&lt;0 \\
\mathbf{U}_{R} \quad \text{if}~ x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>for the isothermal equations using the Roe-Pike approach. The exact Jacobian matrix, eigenvalues and right eigenvectors are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{A}(\mathbf{U}) =
\begin{bmatrix}
0 &amp; 1 \\
a^{2}-u^{2} &amp; 2u
\end{bmatrix}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1} = u - a
,\quad
\lambda_{2} = u + a
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K}^{(1)} = \begin{bmatrix} 1 \\ u - a \end{bmatrix}
,\quad
\mathbf{K}^{(2)} = \begin{bmatrix} 1 \\ u + a \end{bmatrix}
\end{align}\end{split}\]</div>
<div class="section" id="id41">
<h5>Linearisation about a Reference State<a class="headerlink" href="#id41" title="永久链接至标题">¶</a></h5>
<p>Assume that the data states <span class="math notranslate nohighlight">\(\mathbf{U}_{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{R}\)</span> are close to a state <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> to order <span class="math notranslate nohighlight">\(O(\Delta^{2})\)</span> . Linearisation of the conservation laws about this state <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> gives linear Riemann problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \hat{\mathbf{A}}\mathbf{U}_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,0) = \left\{ \begin{array}{l}
\mathbf{U}_{L} \quad \text{if}~ x&lt;0 \\
\mathbf{U}_{R} \quad \text{if}~ x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\hat{\mathbf{A}}\)</span> is the Jacobian <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> evaluated at the reference state <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> , which in terms of primitive variables is denoted by <span class="math notranslate nohighlight">\(\hat{\mathbf{W}}=(\hat{\rho}, \hat{u})^{T}\)</span> . The complete eigenstructure is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{A}}(\mathbf{U}) =
\begin{bmatrix}
0 &amp; 1 \\
a^{2}-\hat{u}^{2} &amp; 2\hat{u}
\end{bmatrix}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\lambda}_{1} = \hat{u} - a
,\quad
\hat{\lambda}_{2} = \hat{u} + a
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{K}}^{(1)} = \begin{bmatrix} 1 \\ \hat{u} - a \end{bmatrix}
,\quad
\hat{\mathbf{K}}^{(2)} = \begin{bmatrix} 1 \\ \hat{u} + a \end{bmatrix}
\end{align}\end{split}\]</div>
<p>Recall that the sound speed <span class="math notranslate nohighlight">\(a\)</span> is constant. We look for solutions of this linear Riemann problem. The system is linear with constant coefficients. One can therefore deploy appropriate techniques. We decompose the data jump <span class="math notranslate nohighlight">\(\Delta\mathbf{U}\)</span> onto the right eigenvectors as follows</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L} = \sum_{k=1}^{2}\hat{\alpha}_{k}\hat{\mathbf{K}}^{(k)} = \hat{\alpha}_{1}\hat{\mathbf{K}}^{(1)} + \hat{\alpha}_{2}\hat{\mathbf{K}}^{(2)}
\end{align}\]</div>
<p>where analytical expressions for the coefficients <span class="math notranslate nohighlight">\(\hat{\alpha}_{1}, \hat{\alpha}_{2}\)</span> are to be found. Writing it in full gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\rho = \rho_{R} - \rho_{L} = \hat{\alpha}_{1} + \hat{\alpha}_{2}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u) = (\rho u)_{R} - (\rho u)_{L} = \hat{\alpha}_{1}(\hat{u} - a) + \hat{\alpha}_{2}(\hat{u} + a)
\end{align}\]</div>
<p>It can easily be shown that</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u) = \hat{\rho}\Delta u + \hat{u}\Delta \rho + O(\Delta^{2})
\end{align}\]</div>
<p>where the leading term in <span class="math notranslate nohighlight">\(O(\Delta^{2})\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\rho_{R} - \hat{\rho})(u_{R} - \hat{u}) - (\rho_{L} - \hat{\rho})(u_{L} - \hat{u})
\end{align}\]</div>
<p>By neglecting <span class="math notranslate nohighlight">\(O(\Delta^{2})\)</span> it becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\rho}\Delta u + \hat{u}\Delta\rho = \hat{\alpha}_{1}(\hat{u} - a) + \hat{\alpha}_{2}(\hat{u} + a)
\end{align}\]</div>
<p>Hence we can get the sought analytical expressions for <span class="math notranslate nohighlight">\(\hat{\alpha}_{1}\)</span> and <span class="math notranslate nohighlight">\(\hat{\alpha}_{2}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\alpha}_{1} = \frac{1}{2}\Big[ \Delta\rho - \hat{\rho}\frac{\Delta u}{a} \Big]
,\quad
\hat{\alpha}_{2} = \frac{1}{2}\Big[ \Delta\rho + \hat{\rho}\frac{\Delta u}{a} \Big]
\end{align}\]</div>
<p>The reader may easily verify that, to within <span class="math notranslate nohighlight">\(O(\Delta^{2})\)</span> , the following two sets of equations are identically satisfied</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L} = \sum_{k=1}^{2}\hat{\alpha}_{k}\hat{\mathbf{K}}^{(k)}
,\quad
\Delta\mathbf{F} = \mathbf{F}_{R} - \mathbf{F}_{L} = \sum_{k=1}^{2}\hat{\alpha}_{k}\hat{\lambda}_{k}\hat{\mathbf{K}}^{(k)}
\end{align}\]</div>
<p>Here we give details for the second set. In full, these equations read</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u) = \hat{\alpha}_{1}\hat{\lambda}_{1} + \hat{\alpha}_{2}\hat{\lambda}_{2}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u^{2} + \rho a^{2}) = \hat{\alpha}_{1}\hat{\lambda}_{1}(\hat{u} - a) + \hat{\alpha}_{2}\hat{\lambda}_{2}(\hat{u} + a)
\end{align}\]</div>
<p>The first equation may be written as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\rho}\Delta u + \hat{u}\Delta\rho = \hat{u}(\hat{\alpha}_{1} + \hat{\alpha}_{2}) + a (\hat{\alpha}_{2} - \hat{\alpha}_{1})
\end{align}\]</div>
<p>which after using <span class="math notranslate nohighlight">\(\hat{\alpha}_{1} = \frac{1}{2}\Big[ \Delta\rho - \hat{\rho}\frac{\Delta u}{a} \Big], \hat{\alpha}_{2} = \frac{1}{2}\Big[ \Delta\rho + \hat{\rho}\frac{\Delta u}{a} \Big]\)</span> becomes an identity. To prove the second equation we first expand its left-hand side</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u^{2} + \rho a^{2}) = 2\hat{\rho}\hat{u}\Delta u + \hat{u}^{2}\Delta\rho + a^{2}\Delta\rho
\end{align}\]</div>
<p>The right-hand side of the second equation can be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\hat{\alpha}_{1} + \hat{\alpha}_{2})(\hat{u}^{2} + a^{2}) + 2\hat{u}a(\hat{\alpha}_{2} - \hat{\alpha}_{1})
\end{align}\]</div>
<p>Therefore, after use of <span class="math notranslate nohighlight">\(\hat{\alpha}_{1} = \frac{1}{2}\Big[ \Delta\rho - \hat{\rho}\frac{\Delta u}{a} \Big], \hat{\alpha}_{2} = \frac{1}{2}\Big[ \Delta\rho + \hat{\rho}\frac{\Delta u}{a} \Big]\)</span> , the second equation becomes an identity and thus the second set of equtions, to order <span class="math notranslate nohighlight">\(O(\Delta^{2})\)</span> , is identically satisfied.</p>
</div>
<div class="section" id="id42">
<h5>The Algebraic Problem for the Average State<a class="headerlink" href="#id42" title="永久链接至标题">¶</a></h5>
<p>For the general case in which the data states <span class="math notranslate nohighlight">\(\mathbf{U}_{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{R}\)</span> are not necessarily close, the Roe-Pike approach proposes the algebraic problem of finding the Roe-Pike averages <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> and <span class="math notranslate nohighlight">\(\tilde{u}\)</span> such that the two conditions are valid, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \sum_{k=1}^{2}\tilde{\alpha}_{k}\tilde{\mathbf{K}}^{(k)}
,\quad
\Delta\mathbf{F} = \sum_{k=1}^{2}\tilde{\alpha}_{k}\tilde{\lambda}_{k}\tilde{\mathbf{K}}^{(k)}
\end{align}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\tilde{\alpha}_{k}, \tilde{\lambda}_{k}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{(k)}\)</span> are obtained by evaluating the available analytical expressions at the sought averages <span class="math notranslate nohighlight">\(\tilde{\rho}, \tilde{u}\)</span> . For the wave strengths these are given by <span class="math notranslate nohighlight">\(\hat{\alpha}_{1} = \frac{1}{2}\Big[ \Delta\rho - \hat{\rho}\frac{\Delta u}{a} \Big], \hat{\alpha}_{2} = \frac{1}{2}\Big[ \Delta\rho + \hat{\rho}\frac{\Delta u}{a} \Big]\)</span> . For the eigenvalues and right eigenvectors they are given by the exact expressions. We then set</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\alpha}_{1} = \frac{1}{2}\Big[ \Delta\rho - \tilde{\rho}\frac{\Delta u}{a} \Big]
,\quad
\tilde{\alpha}_{2} = \frac{1}{2}\Big[ \Delta\rho + \tilde{\rho}\frac{\Delta u}{a} \Big]
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\lambda}_{1} = \tilde{u} - a
,\quad
\tilde{\lambda}_{2} = \tilde{u} + a
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K}^{(1)} = \begin{bmatrix} 1 \\ \tilde{u}-a \end{bmatrix}
,\quad
\mathbf{K}^{(2)} = \begin{bmatrix} 1 \\ \tilde{u}+a \end{bmatrix}
\end{align}\end{split}\]</div>
<p>Writing condtions in full produces</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\rho = \tilde{\alpha}_{1} + \tilde{\alpha}_{2}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u) = \tilde{\alpha}_{1}(\tilde{u} - a) + \tilde{\alpha}_{2}(\tilde{u} + a)
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u) = \tilde{\lambda}_{1}\tilde{\alpha}_{1} + \tilde{\lambda}_{2}\tilde{\alpha}_{2}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u^{2} + a^{2}\rho) = \tilde{\lambda}_{1}\tilde{\alpha}_{1}(\tilde{u} - a) + \tilde{\lambda}_{2}\tilde{\alpha}_{2}(\tilde{u} + a)
\end{align}\]</div>
<p>These are a set of four non-linear algebraic equations for the two unknowns <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> and <span class="math notranslate nohighlight">\(\tilde{u}\)</span> . Note however that, by virtue of <span class="math notranslate nohighlight">\(\tilde{\alpha}_{1} = \frac{1}{2}\Big[ \Delta\rho - \tilde{\rho}\frac{\Delta u}{a} \Big], \tilde{\alpha}_{2} = \frac{1}{2}\Big[ \Delta\rho + \tilde{\rho}\frac{\Delta u}{a} \Big]\)</span> , the frist equation is an identity, for any average value <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> . Also, the second equation is identical to the third equation and thus we work with the third and fourth equations only. From the third equation one obtains</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u) = \tilde{u}(\tilde{\alpha}_{1} + \tilde{\alpha}_{2}) + a (\tilde{\alpha}_{2} - \tilde{\alpha}_{1})
\end{align}\]</div>
<p>Use of <span class="math notranslate nohighlight">\(\tilde{\alpha}_{1} = \frac{1}{2}\Big[ \Delta\rho - \tilde{\rho}\frac{\Delta u}{a} \Big], \tilde{\alpha}_{2} = \frac{1}{2}\Big[ \Delta\rho + \tilde{\rho}\frac{\Delta u}{a} \Big]\)</span> here leads to</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta (\rho u) = \tilde{\rho}\Delta u + \tilde{u}\Delta\rho
\end{align}\]</div>
<p>From the fourth equation we write</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u^{2} + \rho a^{2}) = (\tilde{\alpha}_{1} + \tilde{\alpha}_{2})(\tilde{u}^{2} + a^{2}) + 2a\tilde{u}(\tilde{\alpha}_{2} - \tilde{\alpha}_{1})
\end{align}\]</div>
<p>which after using <span class="math notranslate nohighlight">\(\tilde{\alpha}_{1} = \frac{1}{2}\Big[ \Delta\rho - \tilde{\rho}\frac{\Delta u}{a} \Big], \tilde{\alpha}_{2} = \frac{1}{2}\Big[ \Delta\rho + \tilde{\rho}\frac{\Delta u}{a} \Big]\)</span> and the exact relation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u^{2} + \rho a^{2}) = \Delta(\rho u^{2}) + a^{2}\Delta\rho
\end{align}\]</div>
<p>leads to the result</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(\rho u^{2}) = 2\tilde{u}\tilde{\rho}\Delta u + \tilde{u}^{2}\Delta\rho
\end{align}\]</div>
<p>Elimination of <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> from <span class="math notranslate nohighlight">\(\Delta (\rho u) = \tilde{\rho}\Delta u + \tilde{u}\Delta\rho\)</span> and <span class="math notranslate nohighlight">\(\Delta(\rho u^{2}) = 2\tilde{u}\tilde{\rho}\Delta u + \tilde{u}^{2}\Delta\rho\)</span> leads to a quadratic equation for <span class="math notranslate nohighlight">\(\tilde{u}\)</span> , namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\rho\tilde{u}^{2} - 2\Delta(\rho u)\tilde{u} + \Delta(\rho u^{2}) = 0
\end{align}\]</div>
<p>This equation has two solutions, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u} = \frac{\Delta(\rho u) \pm \sqrt{[\Delta(\rho u)]^{2} - \Delta\rho\Delta(\rho u^{2})}}{\Delta \rho}
\end{align}\]</div>
<p>After using the definition <span class="math notranslate nohighlight">\(\Delta r = r_{R} - r_{L}\)</span> the discriminant is found to be</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\rho_{L}\rho_{R}(\Delta u)^{2}
\end{align}\]</div>
<p>which simplifies the solutions to be</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u} = \frac{\Delta(\rho u )\pm \Delta u \sqrt{\rho_{L}\rho_{R}}}{\Delta \rho}
\end{align}\]</div>
<p>The root obtained by taking the negative sign in it produces the Roe-averaged velocity</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u} = \frac{\sqrt{\rho_{L}}u_{L} + \sqrt{\rho_{R}}u_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<p>From <span class="math notranslate nohighlight">\(\Delta(\rho u) = \tilde{\rho}\Delta u + \tilde{u}\Delta\rho\)</span> we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\rho} = \sqrt{\rho_{L}\rho_{R}}
\end{align}\]</div>
<p>We have thus found algebraic expressions for the sought Roe-Pike averages <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> and <span class="math notranslate nohighlight">\(\tilde{u}\)</span> .</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>We observe that the second root obtained by taking the positive sign leads to the spurious solution</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u} = \frac{\sqrt{\rho_{R}}u_{R} - \sqrt{\rho_{L}}u_{L}}{\sqrt{\rho_{R}} - \sqrt{\rho_{L}}}
\end{align}\]</div>
<p class="last">There is a very good reason for rejecting this as a useful solution; in the trivial case <span class="math notranslate nohighlight">\(\rho_{L}=\rho_{R}\)</span> , <span class="math notranslate nohighlight">\(u_{L}\ne u_{R}\)</span> the solution <span class="math notranslate nohighlight">\(\tilde{u}\)</span> is not even defined.</p>
</div>
<p>Having found the Roe-Pike averages <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> and <span class="math notranslate nohighlight">\(\tilde{u}\)</span> we can then compute the wave strengths <span class="math notranslate nohighlight">\(\tilde{\alpha}_{k}\)</span> , the eigenvalues <span class="math notranslate nohighlight">\(\tilde{\lambda}_{k}\)</span> and the right eigenvectors <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{(k)}\)</span> according to expressions given before. The Roe numerical flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> to be used in the conservative formula can now be obtained from any of the flux relations.</p>
</div>
</div>
<div class="section" id="id43">
<h4>The Euler Equations<a class="headerlink" href="#id43" title="永久链接至标题">¶</a></h4>
<p>We solve the Riemann problem for the x-split, three dimensional Euler equations using the Roe-Pike method. Assuming the analytical expressions for the eigenvalues and eigenvectors, one then linearises the equations about a state <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> to find analytical expressions for the wave strengths; this is done under the assumption that both data states <span class="math notranslate nohighlight">\(\mathbf{U}_{L}, \mathbf{U}_{R}\)</span> are close to <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> to <span class="math notranslate nohighlight">\(O(\Delta^{2})\)</span> . This leads to the linear system</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{U}_{t} + \tilde{\mathbf{A}}\mathbf{U}_{x} = \mathbf{0} \\
&amp; \mathbf{U}(x,t) = \left\{ \begin{array}{l}
\mathbf{U}_{L} ,\quad x&lt;0 \\
\mathbf{U}_{R} ,\quad x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>The Jacobian matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf{A}}\)</span> is obtained by evaluating the exact Jacobian matrix at the state <span class="math notranslate nohighlight">\(\hat{\mathbf{U}}\)</span> ; the eigenvalues <span class="math notranslate nohighlight">\(\hat{\lambda}_{i}\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\lambda}_{1} = \hat{u} - \hat{a}
,\quad
\hat{\lambda}_{2} = \hat{\lambda}_{3} = \hat{\lambda}_{4} = \hat{u}
,\quad
\hat{\lambda}_{5} = \hat{u} + \hat{a}
\end{align}\]</div>
<p>and the right eigenvectors <span class="math notranslate nohighlight">\(\hat{\mathbf{K}}^{(i)}\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{K}}^{(1)} =
\begin{bmatrix}
1 \\ \hat{u}-\hat{a} \\ \hat{v} \\ \hat{w} \\ \hat{H}-\hat{u}\hat{a}
\end{bmatrix}
,\quad
\hat{\mathbf{K}}^{(2)} =
\begin{bmatrix}
1 \\ \hat{u} \\ \hat{v} \\ \hat{w} \\ \frac{1}{2}\hat{\mathbf{V}}^{2}
\end{bmatrix}
,\quad
\hat{\mathbf{K}}^{(3)} =
\begin{bmatrix}
0 \\ 0 \\ 1 \\ 0 \\ \hat{v}
\end{bmatrix}
,\quad
\hat{\mathbf{K}}^{(4)} =
\begin{bmatrix}
0 \\ 0 \\ 0 \\ 1 \\ \hat{w}
\end{bmatrix}
,\quad
\hat{\mathbf{K}}^{(5)} =
\begin{bmatrix}
1 \\ \hat{u}+\hat{a} \\ \hat{v} \\ \hat{w} \\ \hat{H}+\hat{u}\hat{a}
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>By expanding the data jump <span class="math notranslate nohighlight">\(\Delta\mathbf{U}\)</span> onto the right eigenvectors we write</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \sum_{i=1}^{5}\hat{\alpha}_{i}\hat{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>The solution of this <span class="math notranslate nohighlight">\(5 \times 5\)</span> linear system will provide analytical expressions for the wave strengths <span class="math notranslate nohighlight">\(\hat{\alpha}_{i}\)</span> . As a matter of fact we can use the solution for the wave strengths obtained in the Roe original method, and reinterpret the solution appropriately. These are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \hat{\alpha}_{1} = \frac{1}{2\hat{a}}[\Delta u_{1}(\hat{u} + \hat{a}) - \Delta u_{2} - \hat{a}\hat{\alpha}_{2}] \\
&amp; \hat{\alpha}_{2} = \frac{\gamma-1}{\hat{a}^{2}}[\Delta u_{1}(\hat{H} - \hat{u}^{2}) + \hat{u}\Delta u_{2} - \overline{\Delta u_{5}}] \\
&amp; \hat{\alpha}_{3} = \Delta u_{3} - \hat{v}\Delta u_{1} \\
&amp; \hat{\alpha}_{4} = \Delta u_{4} - \hat{w}\Delta u_{1} \\
&amp; \hat{\alpha}_{5} = \Delta u_{1} - (\hat{\alpha}_{1} + \hat{\alpha}_{2})
\end{align}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\Delta u}_{5} = \Delta u_{5} - (\Delta u_{3} - \hat{v}\Delta u_{1})\hat{v} - (\Delta u_{4} - \hat{w}\Delta u_{1})\hat{w}
\end{align}\]</div>
<p>By applying the operator</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta(rs) = \hat{r}\Delta s + \hat{s}\Delta r + O(\Delta^{2})
\end{align}\]</div>
<p>and neglecting <span class="math notranslate nohighlight">\(O(\Delta^{2})\)</span> we arrive at the following solution:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \hat{\alpha}_{1} = \frac{1}{2\hat{a}^{2}}[\Delta p - \hat{\rho}\hat{a}\Delta u] \\
&amp; \hat{\alpha}_{2} = \Delta\rho - \Delta p/\hat{a}^{2} \\
&amp; \hat{\alpha}_{3} = \hat{\rho}\Delta v \\
&amp; \hat{\alpha}_{4} = \hat{\rho}\Delta w \\
&amp; \hat{\alpha}_{5} = \frac{1}{2\hat{a}^{2}}[\Delta p + \hat{\rho}\hat{a}\Delta u]
\end{align}\end{split}\]</div>
<p>The second step in the Roe-Pike method is to find an average state</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\mathbf{W}} = (\tilde{\rho}, \tilde{u}, \tilde{v}, \tilde{w}, \tilde{a})^{T}
\end{align}\]</div>
<p>such that the algebraic problem posed by the following two sets of equations</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{U} = \sum_{i=1}^{5}\tilde{\alpha}_{i}\tilde{\mathbf{K}}^{(i)}
,\quad
\Delta\mathbf{F} = \sum_{i=1}^{5}\tilde{\alpha}_{i}\tilde{\lambda}_{i}\tilde{\mathbf{K}}^{(i)}
\end{align}\]</div>
<p>is satisfied, where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\alpha}_{i} = \hat{\alpha}_{i}(\tilde{\mathbf{W}})
,\quad
\tilde{\lambda}_{i} = \lambda_{i}(\tilde{\mathbf{W}})
,\quad
\tilde{\mathbf{K}}^{(i)} = \mathbf{K}^{(i)}(\tilde{\mathbf{W}})
\end{align}\]</div>
<p>with <span class="math notranslate nohighlight">\(\lambda_{i}, \mathbf{K}^{(i)}\)</span> and <span class="math notranslate nohighlight">\(\hat{\alpha}_{i}\)</span> already given before. Details of the algebra for the one-dimensional case are given by Roe and Pike. For the x-split three dimensional case the solution for the average vector <span class="math notranslate nohighlight">\(\tilde{\mathbf{W}}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{\rho} = \sqrt{\rho_{L}\rho_{R}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{u} = \frac{\sqrt{\rho_{L}}u_{L} + \sqrt{\rho_{R}}u_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{v} = \frac{\sqrt{\rho_{L}}v_{L} + \sqrt{\rho_{R}}v_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{w} = \frac{\sqrt{\rho_{L}}w_{L} + \sqrt{\rho_{R}}w_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{H} = \frac{\sqrt{\rho_{L}}H_{L} + \sqrt{\rho_{R}}H_{R}}{\sqrt{\rho_{L}} + \sqrt{\rho_{R}}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\tilde{a} = \Big( (\gamma-1)(\tilde{H}-\frac{1}{2}\tilde{\mathbf{V}}^{2}) \Big)^{\frac{1}{2}}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{\mathbf{V}}^{2} = \tilde{u}^{2} + \tilde{v}^{2} + \tilde{w}^{2}\)</span> . These are identical to the Roe averages obtained by the original Roe method. Now <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}, \tilde{\lambda}_{i}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{(i)}\)</span> can be computed and then the Roe intercell flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> follows from any of the flux formulae.</p>
</div>
</div>
<div class="section" id="an-entropy-fix">
<h3>An Entropy Fix<a class="headerlink" href="#an-entropy-fix" title="永久链接至标题">¶</a></h3>
<p>Linearised Riemann problem solutions consist of discontinuous jumps only. This can be a good approximation for contacts and shocks, in that the discontinuous character of the wave is correct, although the size of the jump may not be correctly approximated by the linearised solution. Rarefaction waves, on the other hand, carry a continuous change in flow variables, and as time increases, they tend to spread; that is spatial gradients tend to decay. Quite clearly then, the linearised approximation via discontinuous jumps is grossly incorrect. In a practical computational set up however, it is only in the case in which the rarefaction wave is transonic, or sonic, where linearised approximations encounter difficulties; these show up in the form of unphyisical, entropy violating discontinuous waves, sometimes called rarefaction shocks.</p>
<div class="section" id="the-entropy-problem">
<h4>The Entropy Problem<a class="headerlink" href="#the-entropy-problem" title="永久链接至标题">¶</a></h4>
<p>Consider the Riemann problem whose initial data is that Test 1 in Table 11.1. The structure of the exact solution of this problem, depicted in Fig.11.2, contains a left sonic rarefaction, a contact discontinuity of speed <span class="math notranslate nohighlight">\(u_{*}\)</span> and a right shock wave. As the left rarefaction is sonic the eigenvalue <span class="math notranslate nohighlight">\(\lambda_{1} = u - a\)</span> changes from negative to positive, as the wave is crossed from left to right. There is a point at which <span class="math notranslate nohighlight">\(\lambda_{1} = u - a = 0\)</span> , giving the sonic flow condition <span class="math notranslate nohighlight">\(u=a\)</span> .</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1}(\mathbf{U}_{L}) = S_{HL} = u_{L} - a_{L} &lt; 0
\end{align}\]</div>
<p>is the speed of the head of the rarefaction and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1}(\mathbf{U}_{*L}) = S_{TL} = u_{*} - a_{*L} &gt; 0
\end{align}\]</div>
<p>is the speed of the tail. Fig.11.4 shows the numerical (symbols) and exact (line) solutions of this problem, where the numerical solution is obtained by Roe’s method as described so far. The numerical solution within the rarefaction exhibits a discontinuity within the wave; this discontinuity is unphysical, it violates the entropy condition. Recall that a physically admissible discontinuity of speed <span class="math notranslate nohighlight">\(S\)</span> requires <span class="math notranslate nohighlight">\(S_{b} \ge S \ge S_{a}\)</span> where <span class="math notranslate nohighlight">\(S_{b}\)</span> and <span class="math notranslate nohighlight">\(S_{a}\)</span> are characteristic speeds behind and ahead of the wave respectively. That is, characteristics move into the discontinuity; the limiting case of parallel chracteristic speeds is that of a contact discontinuity. For the example above, the opposite happens.</p>
<p>Roe’s solver can be modified so as to avoid entropy violating solutions. This is usually referred to as an entropy fix. Harten and Hyman suggested an entropy fix for Roe’s method, which has widespread use. Other ways of correcting the scheme have been discussed by Roe and Pike, Roe, Sweby and Dubois and Mehlman, amongst others. Here we present the details of the Harten-Hymann approach.</p>
</div>
<div class="section" id="the-harten-hymann-entropy-fix">
<h4>The Harten-Hymann Entropy Fix<a class="headerlink" href="#the-harten-hymann-entropy-fix" title="永久链接至标题">¶</a></h4>
<p>The general approach is presented in the original paper of Harten and Hyman of 1983. The presentation here is tailored specifically to the time-dependent Euler equations, for which we only need to consider the left and right non-linear waves associated with the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{1} = u-a\)</span> and <span class="math notranslate nohighlight">\(\lambda_{5} = u+a\)</span> respectively. Our version of the Harten-Hyman entropy fix relies on estimates for particle velocity <span class="math notranslate nohighlight">\(u_{*}\)</span> and sound speeds <span class="math notranslate nohighlight">\(a_{*L}, a_{*R}\)</span> in the Star Region.</p>
<div class="section" id="left-transonic-rarefaction">
<h5>Left Transonic Rarefaction<a class="headerlink" href="#left-transonic-rarefaction" title="永久链接至标题">¶</a></h5>
<p>Consider the situation depicted in Fig.11.2. Assuming <span class="math notranslate nohighlight">\(u_{*}\)</span> and <span class="math notranslate nohighlight">\(a_{*L}\)</span> are available, we compute the speeds</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1}^{L} = u_{L} - a_{L}
,\quad
\lambda_{1}^{R} = u_{*} - a_{*L}
\end{align}\]</div>
<p>If</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1}^{L} &lt; 0 &lt; \lambda_{1}^{R}
\end{align}\]</div>
<p>then the left wave is a transonic, or sonic, rarefaction wave. In these circumstances the entropy fix is required and is enforced as follows. The single jump</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{*L} - \mathbf{U}_{L} = \tilde{\alpha}_{1}\tilde{\mathbf{K}}^{(1)}
\end{align}\]</div>
<p>travelling with speed <span class="math notranslate nohighlight">\(\tilde{\lambda}_{1}\)</span> is split into two smaller jumps <span class="math notranslate nohighlight">\(\mathbf{U}_{SL} - \mathbf{U}_{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{*L} - \mathbf{U}_{SL}\)</span> travelling respectively at speeds <span class="math notranslate nohighlight">\(\lambda_{1}^{L}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{1}^{R}\)</span> , where <span class="math notranslate nohighlight">\(\mathbf{U}_{SL}\)</span> is a transonic state yet to be found; see Fig.11.3. Application of the integral form of the conservation laws gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1}^{R}(\mathbf{U}_{SL} - \mathbf{U}_{*L}) + \lambda_{1}^{L}(\mathbf{U}_{L} - \mathbf{U}_{SL}) = \tilde{\lambda}_{1}(\mathbf{U}_{L} - \mathbf{U}_{*L})
\end{align}\]</div>
<p>from which we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{SL} = \frac{(\tilde{\lambda}_{1} - \lambda_{1}^{L})\mathbf{U}_{L} + (\lambda_{1}^{R} - \tilde{\lambda}_{1})\mathbf{U}_{*L}}{\lambda_{1}^{R} - \lambda_{1}^{L}}
\end{align}\]</div>
<p>To compute the Roe intercell flux we adopt the one-sided formulae, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{L} + \sum_{\tilde{\lambda}_{k} \le 0}\tilde{\lambda}_{k}\tilde{\alpha}_{k}\tilde{\mathbf{K}}^{(k)}
\end{align}\]</div>
<p>where in the present case the summation applies to the single jump <span class="math notranslate nohighlight">\(\mathbf{U}_{SL} - \mathbf{U}_{L}\)</span> travelling with speed <span class="math notranslate nohighlight">\(\lambda_{1}^{L} &lt; 0\)</span> ; the jump is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{SL} - \mathbf{U}_{L} = \frac{(\lambda_{1}^{R} - \tilde{\lambda}_{1})}{(\lambda_{1}^{R} - \lambda_{1}^{L})}(\mathbf{U}_{*L} - \mathbf{U}_{L})
\end{align}\]</div>
<p>But the Roe approximation gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{*L} - \mathbf{U}_{L} = \tilde{\alpha}_{1}\tilde{\mathbf{K}}^{(1)}
\end{align}\]</div>
<p>and thus the flux jump <span class="math notranslate nohighlight">\((\Delta\mathbf{F})_{1}^{L}\)</span> across the wave of speed <span class="math notranslate nohighlight">\(\lambda_{1}^{L}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\Delta\mathbf{F})_{1}^{L} = \lambda_{1}^{L}\Big(\frac{\lambda_{1}^{R} - \tilde{\lambda}_{1}}{\lambda_{1}^{R} - \lambda_{1}^{L}}\Big)\tilde{\alpha}_{1}\tilde{\mathbf{K}}^{(1)}
\end{align}\]</div>
<p>By defining the new wave speed</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\lambda_{1}} = \lambda_{1}^{L}\Big(\frac{\lambda_{1}^{R} - \tilde{\lambda}_{1}}{\lambda_{1}^{R} - \lambda_{1}^{L}}\Big)
\end{align}\]</div>
<p>the intercell flux becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{L} + \overline{\lambda_{1}}\tilde{\alpha}_{1}\tilde{\mathbf{K}}^{(1)}
\end{align}\]</div>
</div>
<div class="section" id="right-transonic-rarefaction">
<h5>Right Transonic Rarefaction<a class="headerlink" href="#right-transonic-rarefaction" title="永久链接至标题">¶</a></h5>
<p>For a right transonic rarefaction, the entropy fix procedure is entirely analogous to the left rarefaction case. Assuming the speeds <span class="math notranslate nohighlight">\(u_{*}\)</span> and <span class="math notranslate nohighlight">\(a_{*R}\)</span> are available, we compute the two wave speeds</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{5}^{L} = u_{*} + a_{*R}
,\quad
\lambda_{5}^{R} = u_{R} + a_{R}
\end{align}\]</div>
<p>If</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{5}^{L} &lt; 0 &lt; \lambda_{5}^{R}
\end{align}\]</div>
<p>then the right wave is a transonic rarefaction wave. The transonic state <span class="math notranslate nohighlight">\(\mathbf{U}_{SR}\)</span> is defined between the waves of speeds <span class="math notranslate nohighlight">\(\lambda_{5}^{L}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{5}^{R}\)</span> and is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{SR} = \frac{(\lambda_{5}^{R} - \tilde{\lambda}_{5})\mathbf{U}_{R} + (\tilde{\lambda}_{5} - \lambda_{5}^{L})\mathbf{U}_{*R}}{\lambda_{5}^{R} - \lambda_{5}^{L}}
\end{align}\]</div>
<p>Next we define the new wave speed</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{\lambda_{5}} = \lambda_{5}^{R}\Big( \frac{\tilde{\lambda}_{5} - \lambda_{5}^{L}}{\lambda_{5}^{R} - \lambda_{5}^{L}} \Big)
\end{align}\]</div>
<p>and then use the one-sided flux formula to compute the numerical flux. The resulting Roe numerical flux is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}_{R} - \overline{\lambda_{5}}\tilde{\alpha}_{5}\tilde{\mathbf{K}}^{(5)}
\end{align}\]</div>
<p>In the present version of the Harten-Hymann entropy fix we have used the one-sided flux formulae. The procedure can be easily adapted for use in conjunction with the centred formulae, if desired. Next we dicuss ways of finding the speeds <span class="math notranslate nohighlight">\(u_{*}, a_{*L}\)</span> and <span class="math notranslate nohighlight">\(a_{*R}\)</span> needed to implement the entropy fix.</p>
</div>
</div>
<div class="section" id="the-star-region-speeds">
<h4>The Star Region Speeds<a class="headerlink" href="#the-star-region-speeds" title="永久链接至标题">¶</a></h4>
<p>The star states <span class="math notranslate nohighlight">\(\mathbf{U}_{*L}, \mathbf{U}_{*R}\)</span> are required in order to obtain the speeds <span class="math notranslate nohighlight">\(u_{*}, a_{*L}, a_{*R}\)</span> and thus the characteristic speeds <span class="math notranslate nohighlight">\(\lambda_{1}^{R}, \lambda_{5}^{L}\)</span> . We present various possible alternatives.</p>
<div class="section" id="the-roe-averaged-states">
<h5>The Roe-Averaged States<a class="headerlink" href="#the-roe-averaged-states" title="永久链接至标题">¶</a></h5>
<p>Given the Roe-averaged <span class="math notranslate nohighlight">\(\tilde{\alpha}_{i}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\mathbf{K}}^{(i)}\)</span> one can find the state <span class="math notranslate nohighlight">\(\mathbf{U}_{*L}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{*L} = \mathbf{U}_{L} + \tilde{\alpha}_{1}\tilde{\mathbf{K}}^{(1)}
\end{align}\]</div>
<p>which leads to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \rho_{*L} = \rho_{L} + \tilde{\alpha}_{1} \\
&amp; u_{*} = \frac{\rho_{L}u_{L} + \tilde{\alpha}_{1}(\tilde{u} - \tilde{a})}{\rho_{L} + \tilde{\alpha}_{1}} \\
&amp; p_{*} = (\gamma-1)\Big[ E_{L} + \tilde{\alpha}_{1}(\tilde{H} - \tilde{u}\tilde{a}) - \frac{1}{2}\rho_{*L}u_{*}^{2} \Big]
\end{align}\end{split}\]</div>
<p>Then we compute the sound speed</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{*L} = \sqrt{\frac{\gamma p_{*}}{\rho_{*L}}}
\end{align}\]</div>
<p>and thus the speeds <span class="math notranslate nohighlight">\(\lambda_{1}^{L}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{1}^{R}\)</span> follow. For the right wave one has</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{*R} = \mathbf{U}_{R} - \tilde{\alpha}_{5}\tilde{\mathbf{K}}^{(5)}
\end{align}\]</div>
<p>which produces</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \rho_{*R} = \rho_{R} - \tilde{\alpha}_{5} \\
&amp; u_{*} = \frac{\rho_{R}u_{R} - \tilde{\alpha}_{5}(\tilde{u} + \tilde{a})}{\rho_{R} - \tilde{\alpha}_{5}} \\
&amp; p_{*} = (\gamma-1)\Big[ E_{R} - \tilde{\alpha}_{5}(\tilde{H} + \tilde{u}\tilde{a}) - \frac{1}{2}\rho_{*R}u_{*}^{2} \Big]
\end{align}\end{split}\]</div>
<p>The sound speed follows as <span class="math notranslate nohighlight">\(a_{*R} = \sqrt{\frac{\gamma p_{*}}{\rho_{*R}}}\)</span> and thus the wave speeds <span class="math notranslate nohighlight">\(\lambda_{5}^{L}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{5}^{R}\)</span> are determined.</p>
</div>
<div class="section" id="the-pvrs-approximation">
<h5>The PVRS Approximation<a class="headerlink" href="#the-pvrs-approximation" title="永久链接至标题">¶</a></h5>
<p>Another way of estimating the required wave speeds is by using the Primitive-Variable Riemann Solver (PVRS) of Toro. The relevant solution values are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; p_{*} = \frac{1}{2}(p_{L} + p_{R}) + \frac{1}{2}(u_{L} - u_{R})\bar{\rho}\bar{a} \\
&amp; u_{*} = \frac{1}{2}(u_{L} + u_{R}) + \frac{1}{2}(p_{L} - p_{R})/(\bar{\rho}\bar{a}) \\
&amp; \rho_{*L} = \rho_{L} + (u_{L} - u_{*})\bar{\rho}/\bar{a} \\
&amp; \rho_{*R} = \rho_{R} + (u_{*} - u_{R})\bar{\rho}/\bar{a}
\end{align}\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{\rho} = \frac{1}{2}(\rho_{L} + \rho_{R})
,\quad
\bar{a} = \frac{1}{2}(a_{L} + a_{R})
\end{align}\]</div>
<p>In order to avoid negative pressures we recommend replacing the linearised solution <span class="math notranslate nohighlight">\(p_{*}\)</span> by <span class="math notranslate nohighlight">\(\max(0, p_{*})\)</span> . The sound speeds <span class="math notranslate nohighlight">\(a_{*L}, a_{*R}\)</span> are then computed in the usual way.</p>
</div>
<div class="section" id="trrs-approximation">
<h5>TRRS Approximation<a class="headerlink" href="#trrs-approximation" title="永久链接至标题">¶</a></h5>
<p>Another possibility is to use the Two-Rarefaction Riemann Solver (TRRS). The pressure <span class="math notranslate nohighlight">\(p_{*}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{*} = \Big[ \frac{a_{L} + a_{R} - \frac{\gamma-1}{2}(u_{R} - u_{L})}{a_{L}/p_{L}^{z} + a_{R}/p_{R}^{z}} \Big]^{\frac{1}{z}}
\end{align}\]</div>
<p>with <span class="math notranslate nohighlight">\(z = \frac{\gamma - 1}{2\gamma}\)</span> . For the left non-linear wave the sound speed and particle velocity follow directly as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{*L} = a_{L}(p_{*}/p_{L})^{z}
,\quad
u_{*} = u_{L} + \frac{2}{(\gamma-1)}(a_{L} - a_{*L})
\end{align}\]</div>
<p>For the right non-linear wave we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{*R} = a_{R}(p_{*}/p_{R})^{z}
,\quad
u_{*} = u_{R} + \frac{2}{(\gamma-1)}(a_{*R} - a_{R})
\end{align}\]</div>
<p>Hence speeds <span class="math notranslate nohighlight">\(\lambda_{1}^{L}, \lambda_{1}^{R}, \lambda_{5}^{L}, \lambda_{5}^{R}\)</span> are determined.</p>
</div>
<div class="section" id="other-alternatives">
<h5>Other Alternatives<a class="headerlink" href="#other-alternatives" title="永久链接至标题">¶</a></h5>
<p>Both the PVRS and the Roe linearised solutions for the speed <span class="math notranslate nohighlight">\(u_{*}, a_{*L}, a_{*R}\)</span> may fail in the vicinity of low density flow. The TRRS approximation presented above would not suffer from such difficulties; in fact, in the case in which both non-linear waves are rarefactions such an approximation would be exact. But as seen in its equations there are four fractional powers to be computed in each case, which makes this approximation rather expensive to use. A robust and yet more efficient scheme is the Two-Shock Riemann Solver (TSRS). Even better is the adaptive Riemann solver scheme.</p>
</div>
</div>
</div>
</div>
<div class="section" id="the-riemann-solver-of-osher">
<h2>The Riemann Solver of Osher<a class="headerlink" href="#the-riemann-solver-of-osher" title="永久链接至标题">¶</a></h2>
<p>One of the attractions of Osher’s scheme is the smoothness of the numerical flux; the scheme has also been proved to be entropy satisfying and in practical computations it is seen to handle sonic flow well. A distinguishing feature of the Osher scheme is its performance near slowly-moving shock waves. The scheme is closely related to the Flux Vector Splitting approach and it is a generalisation of the CIR scheme for linear hyperbolic systems with constant coefficients.</p>
<p>The derivation of the Osher intercell numerical flux depends on integration in phase space. Such operation involves the choice of integration paths, intersection points and sonic points. The integration paths are taken to be integral curves associated with the set of right eigenvectors and to date there are essentially two ways of ordering these integration paths. The most recent approach orders the integration paths such that these correspond to physically meaningful relations across wave families in physical space. In the current literature this is called physical ordering or P-ordering. Osher’s original scheme utilises the ordering of paths that is precisely the inverse of the P-ordering; this is usually called O-ordering. Intersection and sonic points are computed via Generalised Riemann Invariants.</p>
<div class="section" id="osher-s-scheme-for-a-general-system">
<h3>Osher’s Scheme for a General System<a class="headerlink" href="#osher-s-scheme-for-a-general-system" title="永久链接至标题">¶</a></h3>
<div class="section" id="mathematical-bases">
<h4>Mathematical Bases<a class="headerlink" href="#mathematical-bases" title="永久链接至标题">¶</a></h4>
<p>Osher’s approach to upwind differencing provides an approximation to the Godunov numerical flux and results from evaluating the physical flux <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> at various states <span class="math notranslate nohighlight">\(\mathbf{U}_{k}\)</span> ; these include the data states <span class="math notranslate nohighlight">\(\mathbf{U}_{L}, \mathbf{U}_{R}\)</span> , intersection points and sonic points. Consider a system of <span class="math notranslate nohighlight">\(m\)</span> hyperbolic conservation laws</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
\end{align}\]</div>
<p>and the conservative scheme</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{i}^{n+1} = \mathbf{U}_{i}^{n} + \frac{\Delta t}{\Delta x}\Big[ \mathbf{F}_{i-\frac{1}{2}} - \mathbf{F}_{i+\frac{1}{2}} \Big]
\end{align}\]</div>
<p>to solve it numerically. The objective of this chapter is to provide an expression for the numerical flux <span class="math notranslate nohighlight">\(\mathbf{F}_{i+\frac{1}{2}}\)</span> following Osher’s approach.</p>
<p>We assume the system to be strictly hyperbolic with eigenvalues</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{1}(\mathbf{U}) &lt; \lambda_{2}(\mathbf{U}) &lt; \cdots &lt; \lambda_{m}(\mathbf{U})
\end{align}\]</div>
<p>and corresponding right eigenvectors</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{K}^{(1)}(\mathbf{U})
,\quad
\mathbf{K}^{(2)}(\mathbf{U})
,\quad \cdots ,\quad
\mathbf{K}^{(m)}(\mathbf{U})
\end{align}\]</div>
<p>From hyperbolicity, the Jacobian matrix</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}(\mathbf{U}) = \frac{\partial \mathbf{F}}{\partial \mathbf{U}}
\end{align}\]</div>
<p>is diagonalisable, that is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}(\mathbf{U}) = \mathbf{K}(\mathbf{U})\mathbf{\Lambda}(\mathbf{U})\mathbf{K}^{-1}(\mathbf{U})
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}(\mathbf{U})\)</span> is the non-singular matrix whose columns are the right eigenvectors of <span class="math notranslate nohighlight">\(\mathbf{A}(\mathbf{U})\)</span> , that is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{K}(\mathbf{U}) = \Big[ \mathbf{K}^{(1)}(\mathbf{U}); \mathbf{K}^{(2)}(\mathbf{U}); \cdots ; \mathbf{K}^{(m)}(\mathbf{U}) \Big]
\end{align}\]</div>
<p>and <span class="math notranslate nohighlight">\(\mathbf{\Lambda}(\mathbf{U})\)</span> is the diagonal matrix formed by the eigenvalues <span class="math notranslate nohighlight">\(\lambda_{i}(\mathbf{U})\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{\Lambda}(\mathbf{U}) =
\begin{bmatrix}
\lambda_{1}(\mathbf{U}) &amp; \cdots &amp; 0 \\
\vdots &amp; &amp; \vdots \\
0 &amp; \cdots &amp; \lambda_{m}(\mathbf{U})
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>As done before for linear systems with constant coefficients, we introduce the following notation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{i}^{+}(\mathbf{U}) = \max(\lambda_{i}(\mathbf{U}), 0)
,\quad
\lambda_{i}^{-}(\mathbf{U}) = \min(\lambda_{i}(\mathbf{U}), 0)
\end{align}\]</div>
<p>to define diagonal matrices</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{\Lambda}^{+}(\mathbf{U}) =
\begin{bmatrix}
\lambda_{1}^{+}(\mathbf{U}) &amp; \cdots &amp; 0 \\
\vdots &amp; &amp; \vdots \\
0 &amp; \cdots &amp; \lambda_{m}^{+}(\mathbf{U})
\end{bmatrix}
,\quad
\mathbf{\Lambda}^{-}(\mathbf{U}) =
\begin{bmatrix}
\lambda_{1}^{-}(\mathbf{U}) &amp; \cdots &amp; 0 \\
\vdots &amp; &amp; \vdots \\
0 &amp; \cdots &amp; \lambda_{m}^{-}(\mathbf{U})
\end{bmatrix}
,\quad
|\mathbf{\Lambda}(\mathbf{U})| =
\begin{bmatrix}
|\lambda_{1}(\mathbf{U})| &amp; \cdots &amp; 0 \\
\vdots &amp; &amp; \vdots \\
0 &amp; \cdots &amp; |\lambda_{m}(\mathbf{U})|
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>We also introduce</p>
<div class="math notranslate nohighlight">
\[\begin{align}
|\mathbf{A}(\mathbf{U})| = \mathbf{K}(\mathbf{U})|\mathbf{\Lambda}(\mathbf{U})|\mathbf{K}^{-1}(\mathbf{U})
\end{align}\]</div>
<p>But</p>
<div class="math notranslate nohighlight">
\[\begin{align}
|\lambda_{i}(\mathbf{U})| = \lambda_{i}^{+}(\mathbf{U}) - \lambda_{i}^{-}(\mathbf{U})
\end{align}\]</div>
<p>and hence</p>
<div class="math notranslate nohighlight">
\[\begin{align}
|\mathbf{\Lambda}(\mathbf{U})| = \mathbf{\Lambda}^{+}(\mathbf{U}) - \mathbf{\Lambda}^{-}(\mathbf{U})
\end{align}\]</div>
<p>which if substituted in <span class="math notranslate nohighlight">\(|\mathbf{A}(\mathbf{U})| = \mathbf{K}(\mathbf{U})|\mathbf{\Lambda}(\mathbf{U})|\mathbf{K}^{-1}(\mathbf{U})\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
|\mathbf{A}(\mathbf{U})| = \mathbf{A}^{+}(\mathbf{U}) - \mathbf{A}^{-}(\mathbf{U})
\end{align}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}^{+}(\mathbf{U}) = \mathbf{K}(\mathbf{U})\mathbf{\Lambda}^{+}(\mathbf{U})\mathbf{K}^{-1}(\mathbf{U})
,\quad
\mathbf{A}^{-}(\mathbf{U}) = \mathbf{K}(\mathbf{U})\mathbf{\Lambda}^{-}(\mathbf{U})\mathbf{K}^{-1}(\mathbf{U})
\end{align}\]</div>
<p>These matrices produce a splitting of the Jacobian matrix as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{A}(\mathbf{U}) = \mathbf{A}^{+}(\mathbf{U}) + \mathbf{A}^{-}(\mathbf{U})
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}^{+}(\mathbf{U})\)</span> has positive or zero eigenvalues and <span class="math notranslate nohighlight">\(\mathbf{A}^{-}(\mathbf{U})\)</span> has negative or zero eigenvalues. Note that this is a direct generalisation to non-linear systems of the Jacobian splitting for linear systems with constant coefficients.</p>
</div>
<div class="section" id="osher-s-numerical-flux">
<h4>Osher’s Numerical Flux<a class="headerlink" href="#osher-s-numerical-flux" title="永久链接至标题">¶</a></h4>
<p>Osher’s approach assumes that there exist vector-valued functions <span class="math notranslate nohighlight">\(\mathbf{F}^{+}(\mathbf{U})\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}^{-}(\mathbf{U})\)</span> that satisfy</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}(\mathbf{U}) = \mathbf{F}^{+}(\mathbf{U}) + \mathbf{F}^{-}(\mathbf{U})
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial \mathbf{F}^{+}}{\partial \mathbf{U}} = \mathbf{A}^{+}(\mathbf{U})
,\quad
\frac{\partial \mathbf{F}^{-}}{\partial \mathbf{U}} = \mathbf{A}^{-}(\mathbf{U})
\end{align}\]</div>
<p>If the initial data <span class="math notranslate nohighlight">\(\mathbf{U}_{L}, \mathbf{U}_{R}\)</span> of the Riemann problem for the conservation laws is denoted by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{0} \equiv \mathbf{U}_{L} = \mathbf{U}_{i}^{n}
,\quad
\mathbf{U}_{1} \equiv \mathbf{U}_{R} = \mathbf{U}_{i+1}^{n}
\end{align}\]</div>
<p>then the corresponding numerical flux to be used is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}^{+}(\mathbf{U}_{0}) + \mathbf{F}^{-}(\mathbf{U}_{1})
\end{align}\]</div>
<p>Using the integral relations</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{\mathbf{U}_{0}}^{\mathbf{U}_{1}}\mathbf{A}^{-}(\mathbf{U})\mathrm{d}\mathbf{U}
= \mathbf{F}^{-}(\mathbf{U}_{1}) - \mathbf{F}^{-}(\mathbf{U}_{0})
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{\mathbf{U}_{0}}^{\mathbf{U}_{1}}\mathbf{A}^{+}(\mathbf{U})\mathrm{d}\mathbf{U}
= \mathbf{F}^{+}(\mathbf{U}_{1}) - \mathbf{F}^{+}(\mathbf{U}_{0})
\end{align}\]</div>
<p>we can express the numerical flux in three different forms, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{0}) + \int_{\mathbf{U}_{0}}^{\mathbf{U}_{1}}\mathbf{A}^{-}(\mathbf{U})\mathrm{d}\mathbf{U}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \mathbf{F}(\mathbf{U}_{1}) - \int_{\mathbf{U}_{0}}^{\mathbf{U}_{1}}\mathbf{A}^{+}(\mathbf{U})\mathrm{d}\mathbf{U}
\end{align}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{i+\frac{1}{2}} = \frac{1}{2}[\mathbf{F}(\mathbf{U}_{0}) + \mathbf{F}(\mathbf{U}_{1})] - \frac{1}{2}\int_{\mathbf{U}_{0}}^{\mathbf{U}_{1}}|\mathbf{A}(\mathbf{U})|\mathrm{d}\mathbf{U}
\end{align}\]</div>
<p>The integration with respect to <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> in these expressions is carried out in phase space <span class="math notranslate nohighlight">\(\mathbb{R}^{m}\)</span> . Elements of this vector space are vectors</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U} = [u_{1}, u_{2}, \cdots, u_{m}]^{T}
\end{align}\]</div>
<p>whose components <span class="math notranslate nohighlight">\(u_{i}\)</span> are real numbers. In general, the integrals depend on the integration path chosen. Osher’s approach is to select particular integration paths so as to make the actual integration tractable.</p>
</div>
<div class="section" id="osher-s-flux-for-the-single-wave-case">
<h4>Osher’s Flux for the Single-Wave Case<a class="headerlink" href="#osher-s-flux-for-the-single-wave-case" title="永久链接至标题">¶</a></h4>
</div>
</div>
</div>
<div class="section" id="ausm-family-schemes">
<h2>AUSM family schemes<a class="headerlink" href="#ausm-family-schemes" title="永久链接至标题">¶</a></h2>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0021999196902569">A Sequel to AUSM: AUSM+</a></p>
<p>Consider as an initial-value problem the one-dimensional system of conservation laws for ideal-gas flows</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \frac{\partial\mathbf{U}}{\partial t} + \frac{\partial\mathbf{F}}{\partial x} = 0
,\quad t&gt;0, -\infty \le x \le \infty \\
&amp; \mathbf{U}(x,0) = \mathbf{U}_{0}(x)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{U} = (\rho, \rho u, \rho e_{t})^{T}\)</span> belongs to a phase space <span class="math notranslate nohighlight">\(\mathbb{R}^{3}\)</span> , the inviscid flux <span class="math notranslate nohighlight">\(\mathbf{F} = (\rho u, \rho u^{2} + p, \rho u h_{t})^{T}\)</span> denoted a smooth mapping <span class="math notranslate nohighlight">\(\mathbf{F}: \mathbb{U}\to\mathbb{R}^{3}\)</span> . We denote the specific total energy <span class="math notranslate nohighlight">\(e_{t} = e + u^{2}/2 = h_{t} - p/\rho\)</span> , and the ideal-gas equation of state is assumed, <span class="math notranslate nohighlight">\(p = (\gamma - 1)\rho e, \gamma=1.4\)</span> .</p>
<div class="section" id="ausm-formulation">
<h3>AUSM formulation<a class="headerlink" href="#ausm-formulation" title="永久链接至标题">¶</a></h3>
<p>As a first step in formulation of the AUSM family of schemes, we recognize the convection and acoustic waves as two physically distinct processes and write the inviscid flux as a sum of the convective and pressure terms</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F} = \mathbf{F}^{(c)} + \mathbf{P}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{F}^{(c)} = Ma \begin{pmatrix} \rho \\ \rho u \\ \rho h_{t} \end{pmatrix}
,\quad
\mathbf{P} = \begin{pmatrix} 0 \\ p \\ 0 \end{pmatrix}
\end{align}\end{split}\]</div>
<p>Here the convective flux <span class="math notranslate nohighlight">\(\mathbf{F}^{(c)}\)</span> is expressed in terms of the convective speed <span class="math notranslate nohighlight">\(M\)</span> and the passive scalar quantities indicated in the brackets. The pressure flux <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> contains nothing but the pressure term.</p>
<p>Boldface characters denote a column vector of variables defined at the continuous level, the lower-case boldface indicates the numerical flux at the discrete level, and the calligraphic type used for the split Mach number and pressure functions. Correspondingly we shall express the numerical flux <span class="math notranslate nohighlight">\(\mathbf{f}_{j+1/2}\)</span> as the sum of the numerical convective flux <span class="math notranslate nohighlight">\(\mathbf{f}_{j+1/2}^{(c)}\)</span> and the numerical pressure flux, at the interface <span class="math notranslate nohighlight">\(j+1/2\)</span> straddling the <span class="math notranslate nohighlight">\(j\)</span> -th and <span class="math notranslate nohighlight">\((j+1)\)</span> -th cells</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{f}_{j+1/2} = \mathbf{f}_{j+1/2}^{(c)} + \mathbf{p}_{j+1/2}
\end{align}\]</div>
<p>where we further write</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{f}_{j+1/2}^{(c)} = m_{j+1/2}\Phi_{j+1/2}
,\quad
\mathbf{p}_{j+1/2} = \begin{pmatrix} 0 \\ p_{j+1/2} \\ 0 \end{pmatrix}
\end{align}\end{split}\]</div>
<p>For the AUSM formulation, these interface quantities are summarized in the following: First we define <span class="math notranslate nohighlight">\(\forall j \in \mathbb{Z}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; m_{j+1/2} = \mathscr{M}_{j}^{+} + \mathscr{M}_{j+1}^{-}
,\quad \mathscr{M}_{j}^{\pm} = \mathscr{M}^{\pm}(M_{j}) \\
&amp; p_{j+1/2} = \mathscr{P}_{j}^{+}p_{j} + \mathscr{P}_{j+1}^{-}p_{j+1}
,\quad \mathscr{P}_{j}^{\pm} = \mathscr{P}^{\pm}(M_{j})
\end{align}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathscr{M}^{\pm}(M) = \left\{ \begin{array}{l}
\frac{1}{2}(M \pm |M|) ,\quad \text{if}~ |M|&gt;1 \\
\pm\frac{1}{4}(M\pm 1)^{2} ,\quad \text{otherwise}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathscr{P}^{\pm} = \left\{ \begin{array}{l}
\frac{1}{2}(1 \pm \operatorname{sign}(M)) ,\quad \text{if}~|M|\ge 1 \\
\frac{1}{4}(M \pm 1)^{2}(2 \mp M) ,\quad \text{otherwise}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>Then simple upwinding is applied to define <span class="math notranslate nohighlight">\(\phi_{j+1/2}\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\Phi_{j+1/2} = \left\{ \begin{array}{l}
\Phi_{j} ,\quad \text{if}~ m_{j+1/2}\ge0 \\
\Phi_{j+1} ,\quad \text{otherwise}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi = (\rho a , \rho a u, \rho a h_{t})^{T}\)</span> .</p>
<p>Despite successes brought by the scheme, we have also found drawbacks and concluded that further improvement is warranted. In fact, it is possible to derive an improved scheme, termed AUSM+, which contains AUSM as a special case. In this new formulation, the two splittings (respectively, in terms of Mach number and velocity) are unified and the scheme is capable of exactly capturing, not only a stationary contact discontinuity, but also a stationary shock. Furthermore, a set of more general Mach number and pressure splitting functions are used in the AUSM+, resulting in improvement in accuracy, such as removing postshock overshoot and a glitch in the slowly moving shock problem. In what follows, we will present the detailed steps for constructing the AUSM+ and give some interesting heretofore unreported mathematical properties that bear physical consequences. In particular, the positivity-preserving property that allows calculations of strong rarefaction and near vacuum flows.</p>
</div>
<div class="section" id="ausm-scheme">
<h3>AUSM+ scheme<a class="headerlink" href="#ausm-scheme" title="永久链接至标题">¶</a></h3>
<p>As we saw in the previous section, the AUSM scheme simply consists of two steps: (1) the definition of <span class="math notranslate nohighlight">\(\mathscr{M}^{\pm}\)</span> and <span class="math notranslate nohighlight">\(\mathscr{P}^{\pm}\)</span> , followed by (2), a simple upwind selection advection of <span class="math notranslate nohighlight">\(\Phi_{j+1/2}\)</span> . In essence, we propose to deal with the genuinely nonlinear field associated with the eigenvalues <span class="math notranslate nohighlight">\((u \pm a)\)</span> in the first step and the linearly degenerate field associated with the eigenvalue <span class="math notranslate nohighlight">\((u)\)</span> in the second step. In other words, the interface (numerical) velocity and pressure will be determined by considering the nonlinear field when we define their explicit functional forms.</p>
<p>The key for unifying the Mach number and velocity formulations is the notion of common speed of sound defined at the cell interface. This notion turns out to be very useful. It allows, in 1D stationary flow, the exact capturing of a contact discontinuity in the AUSMDV and, in addition, the exact capturing of a shock wave in the AUSM+.</p>
<p>Let the common speed of sound be denoted by <span class="math notranslate nohighlight">\(a_{j+1/2}\)</span> . We now rewrite the numerical convective flux as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{f}_{j+1/2}^{(c)} = m_{j+1/2}a_{j+1/2}\Phi_{j+1/2}
,\quad
\mathbf{\Phi} = (\rho , \rho u , \rho h_{t})^{T}
\end{align}\]</div>
<p>We note that the quantity <span class="math notranslate nohighlight">\(\mathbf{\Phi}\)</span> differs by a factor <span class="math notranslate nohighlight">\(a\)</span> from that used in the AUSM, and we shall solely use the former hereafter. The scalar quantities in <span class="math notranslate nohighlight">\(\Phi_{j+1/2}\)</span> again are given by the simple upwinding</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\Phi_{j+1/2} = \left\{ \begin{array}{l}
\Phi_{j} ,\quad \text{if}~ m_{j+1/2}\ge0 \\
\Phi_{j+1} ,\quad \text{otherwise}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>with the content of <span class="math notranslate nohighlight">\(\mathbf{\Phi}\)</span> now given by <span class="math notranslate nohighlight">\(\mathbf{\Phi} = (\rho , \rho u , \rho h_{t})^{T}\)</span> . What remains is to define <span class="math notranslate nohighlight">\((m_{j+1/2}, p_{j+1/2})\)</span> and <span class="math notranslate nohighlight">\(a_{j+1/2}\)</span> for which we shall develop the detailed framework in the following.</p>
<p>Anticipating contributions from “j” and “j+1” states to the interface Mach number <span class="math notranslate nohighlight">\(m_{j+1/2}\)</span> , let us write for a 3-point scheme the mapping <span class="math notranslate nohighlight">\(m: \mathscr{U} \times \mathscr{U} \to \mathscr{U} \in \mathbb{R}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{align}
m_{j + 1/2} = m(M_{j}, M_{j+1})
\end{align}\]</div>
<p>Specifically we write <span class="math notranslate nohighlight">\(m_{j+1/2}\)</span> as a sum of two individual components</p>
<div class="math notranslate nohighlight">
\[\begin{align}
m_{j+1/2} = \mathscr{M}^{+}(M_{j}) + \mathscr{M}^{-}(M_{j+1})
\end{align}\]</div>
<p>where the superscripts “+” and “-” are understood to be associated with the right- and left-running waves.</p>
<p>For 1D conservation laws, the nonlinear characteristic equations are</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathrm{d}p \pm \rho a\mathrm{d}u = 0
,\quad \text{along}~
\frac{\mathrm{d}x}{\mathrm{d}t} = u \pm a
\end{align}\]</div>
<p>This simply suggests that the velocity and pressure are closely coupled and that the characteristic variables expressed above are propagating locally at the speeds <span class="math notranslate nohighlight">\(u \pm a\)</span> . For <span class="math notranslate nohighlight">\(|M|&lt;1\)</span> , the two waves move in opposite directions and interact with each other. Hence the interface velocity and pressure, composed of the interaction of these two waves, are constructed using <span class="math notranslate nohighlight">\((u \pm a)\)</span> as basis functions in the polynomial expansion. This suggests the following expansion in terms of <span class="math notranslate nohighlight">\((M \pm 1)\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathscr{M}^{\pm} = \frac{1}{2}(M \pm 1) \quad \text{for}~ |M|&lt;1
\end{align}\]</div>
<p>This in fact a form of eigenvalue expansion, utilizing just the eigenvalues associated with the genuinely nonlinear fields. Then from <span class="math notranslate nohighlight">\(m_{j+1/2} = \mathscr{M}^{+}(M_{j}) + \mathscr{M}^{-}(M_{j+1})\)</span> , the interface Mach number is defined, as <span class="math notranslate nohighlight">\(|M|&lt;1\)</span> , by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
m_{j+1/2} = \frac{1}{2}[(M+1)_{j} + (M-1)_{j+1}]
\end{align}\]</div>
<p>This in fact corresponds to the simple average of <span class="math notranslate nohighlight">\(M_{j}\)</span> and <span class="math notranslate nohighlight">\(M_{j+1}\)</span> . As in the Van Leer splitting, the present method makes explicit use of the eigenvalues associated with the nonlinear waves, <span class="math notranslate nohighlight">\(M\pm 1\)</span> . Using the eigenvalues as a basis for expressing the numerical fluxes is quite common in the upwind formulation.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>To remove the nondifferentiability of <span class="math notranslate nohighlight">\(\mathscr{M}^{\pm} = \frac{1}{2}(M \pm 1)\)</span> when the sign of eigenvalues changes, Van Leer chose differentiable second-order polynomials:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathscr{M}^{\pm} = \pm \frac{1}{4}(M \pm 1)^{2}
\end{align}\]</div>
<p class="last">It is evident that the above split formula results in an unsymetric distribution of signals propagated by the characteristic speeds <span class="math notranslate nohighlight">\((M \pm 1)\)</span> as <span class="math notranslate nohighlight">\(M \ne 0\)</span> and becomes the simple (symmetric) average as <span class="math notranslate nohighlight">\(M\)</span> tends to zero, leading to the formula used commonly in the pressure-based codes for incompressble flows.</p>
</div>
<p>In the present study, we present a more general footing for designing the split formulas. First we require that the split Mach number and pressure functions satisfy the following properties:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(\mathscr{M}^{+}(M) + \mathscr{M}^{-}(M) = M\)</span> for consistency.</li>
<li><span class="math notranslate nohighlight">\(\mathscr{M}^{+}(M) \ge 0\)</span> and <span class="math notranslate nohighlight">\(\mathscr{M}^{-} \le 0\)</span> .</li>
<li><span class="math notranslate nohighlight">\(\mathscr{M}^{\pm}\)</span> are monotone increasing functions of <span class="math notranslate nohighlight">\(M\)</span> .</li>
<li><span class="math notranslate nohighlight">\(\mathscr{M}^{+} = -\mathscr{M}^{-}(-M)\)</span> , i.e., a symmetry property.</li>
<li><span class="math notranslate nohighlight">\(\mathscr{M}^{+}(M)=M\)</span> as <span class="math notranslate nohighlight">\(M \ge 1\)</span> ; <span class="math notranslate nohighlight">\(\mathscr{M}^{-}(M) = M\)</span> as <span class="math notranslate nohighlight">\(M \le -1\)</span> .</li>
<li><span class="math notranslate nohighlight">\(\mathscr{M}^{\pm}\)</span> are continuously differentiable.</li>
</ul>
<p>Consequantly we have the definition of the split Mach number <span class="math notranslate nohighlight">\(\mathscr{M}^{\pm}\)</span> that satisfy the above six properties:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathscr{M}^{\pm}(M) = \left\{ \begin{array}{l}
\frac{1}{2}(M \pm |M|) ,\quad \text{if}~ |M| \ge 1 \\
\mathscr{M}_{\beta}^{\pm}(M) ,\quad \text{otherwise}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathscr{M}_{\beta}^{\pm}(M) = \pm \frac{1}{4}(M \pm 1)^{2} \pm \beta(M^{2} - 1)^{2}
,\quad -\frac{1}{16} \le \beta \le \frac{1}{2}
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last"><span class="math notranslate nohighlight">\(\mathscr{M}_{\beta=0}^{\pm}\)</span> correspond to the Van Leer formula and are the lowest degree polynomials differentiable at <span class="math notranslate nohighlight">\(M = \pm 1\)</span> .</p>
</div>
<p>Next, the interface pressure for a 3-point flux scheme is written in general as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{j+1/2} = p(M_{j}, p_{j}, M_{j+1}, p_{j+1})
\end{align}\]</div>
<p>or specifically</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{j+1/2} = \mathscr{P}^{+}(M_{j})p_{j} + \mathscr{P}^{-}(M_{j+1})p_{j+1}
\end{align}\]</div>
<p>We require that the split pressures <span class="math notranslate nohighlight">\(\mathscr{P}^{\pm}\)</span> satisfy the following properties:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(\mathscr{P}^{+}(M) + \mathscr{P}^{+}(M) = 1\)</span> , for consistency.</li>
<li><span class="math notranslate nohighlight">\(0 \ge \mathscr{P}^{\pm}(M)\)</span> , as required by the physical constraint that the pressure be nonnegative.</li>
<li><span class="math notranslate nohighlight">\(\frac{\partial\mathscr{P}^{+}}{\partial M} \ge 0\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial\mathscr{P}^{-}}{\partial M} \le 0\)</span> .</li>
<li><span class="math notranslate nohighlight">\(\mathscr{P}^{+}(M) = \mathscr{P}^{-}(-M)\)</span> .</li>
<li><span class="math notranslate nohighlight">\(\mathscr{P}^{+} = 1\)</span> as <span class="math notranslate nohighlight">\(M &gt; 1\)</span> ; <span class="math notranslate nohighlight">\(\mathscr{P}^{-} = 1\)</span> as <span class="math notranslate nohighlight">\(M &lt; -1\)</span> .</li>
<li><span class="math notranslate nohighlight">\(\mathscr{P}^{\pm}(M)\)</span> are continuously differentiable.</li>
</ul>
<p>Then we have the definition of the split pressures <span class="math notranslate nohighlight">\(\mathscr{P}^{\pm}\)</span> that hold the above six properties:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathscr{P}^{\pm}(M) = \left\{ \begin{array}{l}
\frac{1}{2}(1 \pm \operatorname{sign}(M)) ,\quad \text{if}~ |M| \ge 1 \\
\mathscr{P}_{\alpha}^{\pm}(M) ,\quad \text{otherwise}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathscr{P}_{\alpha}^{\pm} = \frac{1}{4}(M \pm 1)^{2}(2 \mp M) \pm \alpha M(M^{2} - 1)^{2}
,\quad -\frac{3}{4} \le \alpha \le \frac{3}{16}
\end{align}\]</div>
<p>Next we consider the criteria for setting the values of the parameters <span class="math notranslate nohighlight">\((\alpha, \beta)\)</span> . It is noted that there exists an inflection point in <span class="math notranslate nohighlight">\(\mathscr{P}_{\alpha}^{\pm}\)</span> at <span class="math notranslate nohighlight">\(M=0~~\forall \alpha\)</span> . Thus, if we also allow in <span class="math notranslate nohighlight">\(\mathscr{M}_{\beta}^{\pm}\)</span> the same inflection point at <span class="math notranslate nohighlight">\(M=0\)</span> , and no other additional inflections in <span class="math notranslate nohighlight">\(\mathscr{P}_{\alpha}^{\pm}\)</span> for <span class="math notranslate nohighlight">\(M \in [-1,1]\)</span> , except at the end points <span class="math notranslate nohighlight">\(M = \pm 1\)</span> , then we get the following results:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \frac{\mathrm{d}^{2}\mathscr{M}_{\beta}^{\pm}}{\mathrm{d}M^{2}}(0) = 0
\quad\Rightarrow\quad \beta = \frac{1}{8} \\
&amp; \frac{\mathrm{d}^{2}\mathscr{P}_{\alpha}^{\pm}}{\mathrm{d}M^{2}}(\pm 1) = 0
\quad\Rightarrow\quad \alpha = \frac{3}{16}
\end{align}\end{split}\]</div>
<p>These values are recommended for use because this pair have given results that are improved over the AUSM and comparable with the Roe splitting. While the above criteria may seem intuitive and there might be a better choice, they have nevetheless performed well on many calculations.</p>
<p>To achieve the unification of the velocity and Mach number <span class="math notranslate nohighlight">\((c=u,M)\)</span> splittings, it is obvious that we can no longer use each respective speed of sound, <span class="math notranslate nohighlight">\(a_{j}\)</span> or <span class="math notranslate nohighlight">\(a_{j+1}\)</span> , but instead should use a common one. The notion of the common speed of sound turns out to be very useful. It allows, in 1D stationary flow, the exact capturing of the contact discontinuity in AUSMDV and, in addition, the exact capturing of the shock wave in AUSM+. This is also justifiable from the physical point of view. Since the interface flux is viewed as a recipient of contributions from both neighboring cells, it certainly makes sense to use a common speed of sound defined there as a basis for determining the Mach number and subsequent upwinding. Let us now write</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{j+1/2} = a(\mathbf{U}_{j}, \mathbf{U}_{j+1})
\end{align}\]</div>
<p>It is this freedom that allows us to make a favorable choice to attain an exact capture of a stationary shock.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>It is of interest to note that we can write <span class="math notranslate nohighlight">\(a_{j+1/2}\)</span> for AUSM in the present AUSM+ formulation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
a_{j+1/2} = \left\{ \begin{array}{l}
a_{j} ,\quad \text{if}~ m_{j+1/2} \ge 0 \\
a_{j+1} ,\quad \text{otherwise}
\end{array} \right.
\end{align}\end{split}\]</div>
<p class="last">Thus, AUSM belongs to a special case of AUSM+.</p>
</div>
<p>Consider a 1D stationary shock problem:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{U} = \left\{ \begin{array}{l}
\mathbf{U}_{L} ,\quad x \le x_{j} \\
\mathbf{U}_{R} ,\quad x&gt;x_{j}
\end{array} \right.
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{U}_{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}_{R}\)</span> are related via the normal shock relation and <span class="math notranslate nohighlight">\(u_{j}&gt;a_{j}\)</span> . Let <span class="math notranslate nohighlight">\(a_{j}^{*}\)</span> be the critical speed of sound evaluated at <span class="math notranslate nohighlight">\(U_{j}(=\mathbf{U}_{L})\)</span> , then the speed of sound used in the AUSM+</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{j+1/2} = a_{j}^{*2}/u_{j}
\end{align}\]</div>
<p>allows an exact resolution of the stationary shock for any <span class="math notranslate nohighlight">\((\alpha,\beta)\)</span> . The critical speed of sound <span class="math notranslate nohighlight">\(a^{*}\)</span> is calculated via the isoenergetic condition</p>
<div class="math notranslate nohighlight">
\[\begin{align}
h_{t} = \frac{a^{2}}{\gamma - 1} + \frac{1}{2}u^{2} = \frac{(\gamma+1)a^{*2}}{2(\gamma-1)}
\quad \text{for ideal gas}
\end{align}\]</div>
<p>It is well known that the Mach numbers based on the speeds of sound <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(a^{*}\)</span> indicate equally whether the flow lies at the sonic or the supersonic or the subsonic regime. Namely, let <span class="math notranslate nohighlight">\(M=u/a\)</span> and <span class="math notranslate nohighlight">\(M^{*}=u/a^{*}\)</span> ; then</p>
<div class="math notranslate nohighlight">
\[\begin{align}
M=1 \Leftrightarrow M^{*}=1
,\quad
M&gt;1 \Leftrightarrow M^{*}&gt;1
,\quad
M&lt;1 \Leftrightarrow M^{*}&lt;1
\end{align}\]</div>
<p>Hence, the critical speed of sound defined above can be used as a reference to define the Mach number to be used as the variable for upwinding.</p>
<p>Note that the formula <span class="math notranslate nohighlight">\(a_{j+1/2} = a_{j}^{*2}/u_{j}\)</span> is valid for <span class="math notranslate nohighlight">\(u_{L} &gt; a_{L}^{*}\)</span> . We now must extend it to other conditions such as subsonic speed or <span class="math notranslate nohighlight">\(u_{L} &lt; 0\)</span> ; we suggest the following formula for <span class="math notranslate nohighlight">\(M \in \mathbb{R}\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{align}
a_{j+1/2} = \min(\tilde{a}_{L}, \tilde{a}_{R})
,\quad
\tilde{a}_{L} = \frac{a^{*2}}{\max(a^{*}, u_{L})}
,\quad
\tilde{a}_{L} = \frac{a^{*2}}{\max(a^{*}, -u_{R})}
\end{align}\]</div>
<p>That is, <span class="math notranslate nohighlight">\(\tilde{a}\)</span> is taken to be <span class="math notranslate nohighlight">\(a^{*}\)</span> when <span class="math notranslate nohighlight">\(|u| &lt; a^{*}\)</span> .</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>Other formulas may be used for the reason of simplicity, but at the expense of losing the above property. Some obvious choices are</p>
<div class="last math notranslate nohighlight">
\[\begin{align}
a_{j+1/2} = \frac{1}{2}(a_{j} + a_{j+1})
,\quad
a_{j+1/2} = \sqrt{a_{j}a_{j+1}}
\end{align}\]</div>
</div>
<p>In summary, the above splittings for both the advective and pressure terms completely define the Euler numerical flux. The AUSM+ algorithm can be simply summarized as follows: Let <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(j+1\)</span> states be given, then</p>
<ol class="arabic simple">
<li><span class="math notranslate nohighlight">\(M_{j} = u_{j}/a_{j+1/2}\)</span> and <span class="math notranslate nohighlight">\(M_{j+1}=u_{j+1}/a_{j+1/2}\)</span> via <span class="math notranslate nohighlight">\(a_{j+1/2} = \min(\tilde{a}_{L}, \tilde{a}_{R})\)</span> ;</li>
<li><span class="math notranslate nohighlight">\(m_{j+1/2}=\mathscr{M}^{+}(M_{j}) + \mathscr{M}^{-1}(M_{j+1})\)</span> and <span class="math notranslate nohighlight">\(m_{j+1/2}^{\pm} = \frac{1}{2}(m_{j+1/2} \pm |m_{j+1/2}|)\)</span> , <span class="math notranslate nohighlight">\(p_{j+1/2} = \mathscr{P}^{+}(M_{j})p_{j} + \mathscr{P}^{-}(M_{j+1})p_{j+1}\)</span> ;</li>
<li><span class="math notranslate nohighlight">\(\mathbf{f}_{j+1/2} = a_{j+1/2} \left\{  m_{j+1/2}^{+}\begin{pmatrix} \rho \\ \rho u \\ \rho h_{t} \end{pmatrix}_{j} + m_{j+1/2}^{-} \begin{pmatrix} \rho \\ \rho u \\ \rho h_{t} \end{pmatrix}_{j+1} \right\} + \begin{pmatrix} 0 \\ p_{j+1/2} \\ 0 \end{pmatrix}\)</span> .</li>
</ol>
<p>The numerical flux defined above can be rewritten as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{f}_{j+1/2} = a_{j+1/2}\Big[\frac{1}{2}m_{j+1/2}(\mathbf{\Phi}_{j} + \mathbf{\Phi}_{j+1}) - \frac{1}{2}|m_{j+1/2}| (\mathbf{\Phi}_{j+1} - \mathbf{\Phi}_{j}) \Big] + \mathbf{p}_{j+1/2}
\end{align}\]</div>
</div>
<div class="section" id="ausm-up-scheme">
<h3>AUSM+up scheme<a class="headerlink" href="#ausm-up-scheme" title="永久链接至标题">¶</a></h3>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0021999105004274">A sequel to AUSM, Part II: AUSM+up for all speeds</a></p>
<p>First, one defines</p>
<div class="math notranslate nohighlight">
\[\begin{align}
M_{L/R} = \frac{u_{L/R}}{a_{1/2}}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_{1/2}\)</span> is defined either by <span class="math notranslate nohighlight">\(a_{j+1/2} = \min(\tilde{a}_{L}, \tilde{a}_{R})\)</span> or a simple average of <span class="math notranslate nohighlight">\(a_{L}\)</span> and <span class="math notranslate nohighlight">\(a_{R}\)</span> . For multi-dimensional flows, <span class="math notranslate nohighlight">\(u = \mathbf{U} \cdot \mathbf{n}\)</span> , with <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> being the unit normal vector of the cell face under consideration.</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{M}^{2} = \frac{u_{L}^{2} + u_{R}^{2}}{2a_{1/2}^{2}}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
M_{0}^{2} = \min\Big( 1, \max(\bar{M}^{2}, M_{\infty}^{2}) \Big) \in [0,1]
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{a}(M_{0}) = M_{0}(2 - M_{0}) \in [0,1]
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
M_{1/2} = \mathscr{M}^{+}_{(4)}(M_{L}) + \mathscr{M}_{(4)}^{-}(M_{R})
- \frac{K_{p}}{f_{a}}\max(1 - \sigma\bar{M}^{2}, 0) \frac{p_{R} - p_{L}}{\rho_{1/2}a_{1/2}^{2}}
,\quad
\rho_{1/2} = (\rho_{L} + \rho_{R})/2
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(0 \le K_{p} \le 1\)</span> and <span class="math notranslate nohighlight">\(\sigma \le 1\)</span> . Then, the mass and pressure fluxes are readily defined</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{m}_{1/2} = a_{1/2}M_{1/2} \left\{\begin{array}{l}
\rho_{L} \quad \text{if}~ M_{1/2}&gt;0 \\
\rho_{R} \quad \text{otherwise}
\end{array}\right.
\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
p_{1/2} = \mathscr{P}_{(5)}^{+}(M_{L})p_{L}
+ \mathscr{P}_{(5)}^{-}(M_{R})\rho_{R}
- K_{u}\mathscr{P}_{(5)}^{+}\mathscr{P}_{(5)}^{-}(\rho_{L} + \rho_{R})(f_{a}a_{1/2})(u_{R} - u_{L})
\end{align}\]</div>
<p>using the parameters</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\alpha = \frac{3}{16}(-4 + 5f_{a}^{2}) \in [-\frac{3}{4}, \frac{3}{16}]
,\quad
\beta = \frac{1}{8}
\end{align}\]</div>
<p>with <span class="math notranslate nohighlight">\(0 \le K_{u} \le 1\)</span> . Finally, the whole flux is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{f}_{1/2} = \dot{m}_{1/2}\left\{\begin{array}{l}
\vec{\psi}_{L} \quad \text{if}~\dot{m}_{1/2}&gt;0 \\
\vec{\psi}_{R} \quad \text{otherwise}
\end{array}\right.
+ \mathbf{p}_{1/2}
\end{align}\end{split}\]</div>
<p>It is reminded that only in the pressure flux is the numerical speed of sound used, which is scaled by the factor <span class="math notranslate nohighlight">\(f_{a}\)</span> , but nowhere else.</p>
<p>This scheme is still designated as AUSM+up since it incorporates both the velocity and pressure terms into AUSM+ scheme and the basic scheme is only a special version obtained by simply setting <span class="math notranslate nohighlight">\(f_{a} = 1\)</span> .</p>
<p>As noted previously, the basic scheme should be invoked when we consider the shock-tube type of problems in which the leading pressure term is not spatially uniform, even though the fluid velocity may be small.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">在原作者的论文当中，推荐使用的参数设置为 <span class="math notranslate nohighlight">\(K_{p}=0.25, K_{u}=0.75, \sigma=1.0\)</span> .</p>
</div>
</div>
<div class="section" id="higher-order-extension">
<h3>Higher-order extension<a class="headerlink" href="#higher-order-extension" title="永久链接至标题">¶</a></h3>
<p>The MUSCL strategy for preserving monotonicity is adopoted here, via the use of a nonlinear limiter sensing the ratio of neighboring first-differences of appropriate variables. We choose to extrapolate the primitive variables <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> , according to the formulas</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{W}_{L} := \mathbf{W}_{j} + \frac{1}{2}\psi(r_{j})(\mathbf{W}_{j} - \mathbf{W}_{j-1}) \\
&amp; \mathbf{W}_{R} := \mathbf{W}_{j+1} - \frac{1}{2}\psi(\frac{1}{r_{j+1}})(\mathbf{W}_{j+2} - \mathbf{W}_{j+1})
\end{align}\end{split}\]</div>
<p>where the subscripts “L” and “R” represent the states that take place of “j” and “j+1” in the formulas derived before for the first-order scheme. To take grid nonuniformity into account, grid-size weighting can also be formulated into it if desired. The function <span class="math notranslate nohighlight">\(\psi\)</span> is a limiter whose argument is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
r_{j} = \frac{\Delta_{j+1/2}w_{i}}{\Delta_{j-1/2}w_{i}}
,\quad
\mathbf{W} = (w_{1}, w_{2}, w_{3})^{T}
,\quad
\Delta_{j+1/2}() = ()_{j+1} - ()_{j}
\end{align}\]</div>
<p>We stress that the set of primitive variables <span class="math notranslate nohighlight">\(\mathbf{W} = (\rho, u, h_{t})^{T}\)</span> is employed and the minmod function is normally chosen for its robustness in our calculations. Other forms for the limiter function have been proposed and it is generally known that the accuracy of solution around discontinuities (shock or contact) is influenced more or less by the choice of the limiter. The dependence of the solution on the choice of the variables chosen for extrapolation also occurs.</p>
</div>
</div>
<div class="section" id="high-order-and-tvd-methods-for-scalar-equations">
<h2>High-Order and TVD Methods for Scalar Equations<a class="headerlink" href="#high-order-and-tvd-methods-for-scalar-equations" title="永久链接至标题">¶</a></h2>
<p>It is well-known that high-order linear (constant coefficients) schemes produce unphysical oscillations in the vicinity of large gradients. On the other hand, the class of monotone methods do not produce unphysical oscillations. However, monotone methods are at most first order accurate and are therefore of limited use. One way of resolving the contradiction between linear schemes of high-order of accuracy and absence of spurious oscillations is by constructing non-linear methods.</p>
<p>Total Variation Diminishing Methods, or TVD Methods for short, are a prominent class of non-linear methods. The theoretical bases of TVD methods are sound for scalar one-dimensional problems only. In practical, non-linear, multidimensional problems, the accumulated experience of numerous applications has demonstrated that the one-dimensional scalar theory serves well as a guideline or extending the ideas, on a more or less empirical basis. TVD schemes have their roots on the fundamental question of convergence of schemes of non-linear problems. Total-Variation Stable schemes have been proved to be convergent. TVD methods are a class of Total-Variation Stable schemes and they are based on the requirement that the total variation of the numerical solution be non-increasing in time. As a matter of fact the exact solution of a scalar conservation law does possess this property and therefore TVD numerical methods just mimic a property of the exact solution. Apart from being a class of methods proved to be convergent, for scalar problems, the TVD concept is also extremely useful in designing schemes.</p>
<p>TVD schemes are intimately linked to traditional Artificial Viscosity Methods. Both TVD and Artificial Viscosity Methods attempt to circumvent Godunov’s theorem by constructing schemes of accuracy <span class="math notranslate nohighlight">\(p&gt;1\)</span> , such that spurious oscillations near high gradients are eliminated or controlled. Both classes of schemes resort effectively to the same mechanism, namely the addition of artificial viscosity. Artifical Viscosity Methods do this explicitly, by adding extra terms to the PDEs. In TVD methods, on the other hand, the artificial viscosity is inherent in the scheme itself, but the way this is activated is rather sophisticated.</p>
<p>The TVD approach has managed to circumvent Godunov’s theorem by resorting to non-linear schemes, even when applied to linear problems. The inherent artificial viscosity of the schemes is controlled in a very precise manner so that spurious oscillations are eliminated and high-order accuracy in smooth parts of the solution is retained. Historically, TVD methods have almost exclusively been associated with high-order upwind methods. Over the last few years, however, the TVD concept has been extended to centred schemes, as distinct from upwind schemes. This development has effectively provided Artificial Viscosity Methods with a more rational basis and has tended to unify the developments on numerical methods for conservation laws.</p>
<div class="section" id="basic-properties-of-selected-schemes">
<h3>Basic Properties of Selected Schemes<a class="headerlink" href="#basic-properties-of-selected-schemes" title="永久链接至标题">¶</a></h3>
<p>The purpose of this section is to review a selected number of schemes and discuss some of their main properties. In the main, the discussion is centred on the linear advection equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{t} + f(u)_{x} = 0 ,\quad f(u) = au
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(u=u(x,t)\)</span> and <span class="math notranslate nohighlight">\(a\)</span> is a constant wave propagation speed.</p>
<div class="section" id="selected-schemes">
<h4>Selected Schemes<a class="headerlink" href="#selected-schemes" title="永久链接至标题">¶</a></h4>
</div>
<div class="section" id="accuracy">
<h4>Accuracy<a class="headerlink" href="#accuracy" title="永久链接至标题">¶</a></h4>
</div>
<div class="section" id="stability">
<h4>Stability<a class="headerlink" href="#stability" title="永久链接至标题">¶</a></h4>
</div>
</div>
<div class="section" id="waf-type-high-order-schemes">
<h3>WAF-Type High Order Schemes<a class="headerlink" href="#waf-type-high-order-schemes" title="永久链接至标题">¶</a></h3>
<p>The Weighted Average Flux (or WAF for short) approach is a generalisation of the Lax-Wendroff and the Godunov first-order upwind schemes to non-linear systems of conservation laws. It is also a generalisation of the Warming-Beam method. The WAF approach has its origins in the random flux scheme, which is second-order accurate in space and time in a statistical sense. The WAF approach is deterministic and leads to fully discrete, explicit second order accurate schemes.</p>
<p>In this section we present the approach as applied to a general scalar conservation law</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{t} + f(u)_{x} = 0
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(u = u(x,t)\)</span> and <span class="math notranslate nohighlight">\(f(u)\)</span> is a convex flux function. The scheme is based on the explicit conservative formula</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n+1} = u_{i}^{n} + \frac{\Delta t}{\Delta x}[f_{i-\frac{1}{2}} - f_{i+\frac{1}{2}}]
\end{align}\]</div>
<p>Full details for the linear advection case will be developed.</p>
<div class="section" id="the-basic-waf-scheme">
<h4>The Basic WAF Scheme<a class="headerlink" href="#the-basic-waf-scheme" title="永久链接至标题">¶</a></h4>
<p>The WAF method assumes piece-wise constant data <span class="math notranslate nohighlight">\(\{ u_{i}^{n} \}\)</span> , as in the Godunov first-order upwind method; that is, <span class="math notranslate nohighlight">\(u_{i}^{n}\)</span> is an integral average of the solution <span class="math notranslate nohighlight">\(u(x,t^{n})\)</span> within a cell <span class="math notranslate nohighlight">\(I_{i}=[x_{i-\frac{1}{2}},x_{i+\frac{1}{2}}]\)</span> at time <span class="math notranslate nohighlight">\(t=t^{n}\)</span> namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u_{i}^{n} = \frac{1}{\Delta x}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}u(x,t^{n})\mathrm{d}x
\end{align}\]</div>
</div>
</div>
</div>
<div class="section" id="high-order-and-tvd-schemes-for-non-linear-systems">
<h2>High-Order and TVD Schemes for Non-Linear Systems<a class="headerlink" href="#high-order-and-tvd-schemes-for-non-linear-systems" title="永久链接至标题">¶</a></h2>
</div>
<div class="section" id="splitting-schemes-for-pdes-with-source-terms">
<h2>Splitting Schemes for PDEs with Source Terms<a class="headerlink" href="#splitting-schemes-for-pdes-with-source-terms" title="永久链接至标题">¶</a></h2>
</div>
<div class="section" id="methods-for-multi-dimensional-pdes">
<h2>Methods for Multi-Dimensional PDEs<a class="headerlink" href="#methods-for-multi-dimensional-pdes" title="永久链接至标题">¶</a></h2>
<p>This chapter concerned with numerical methods for solving non-linear systems of hyperbolic conservation laws in multidimensions. For Cartesian geometries one may write the equations of our interest here as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} + \mathbf{G}(\mathbf{U})_{y} + \mathbf{H}(\mathbf{U})_{z} = \mathbf{0}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> denotes time or a time-like variable and <span class="math notranslate nohighlight">\(x,y,z\)</span> are Cartesian coordinate directions. <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> is the vector of conserved variables and <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{U})\)</span> , <span class="math notranslate nohighlight">\(\mathbf{G}(\mathbf{U})\)</span> , <span class="math notranslate nohighlight">\(\mathbf{H}(\mathbf{U})\)</span> are vectors of fluxes in the <span class="math notranslate nohighlight">\(x,y,z\)</span> directions respectively. A prominent example are the time-dependent three dimensional Euler equations. Other examples are the time-dependent two dimensional shallow water equations and the artificial compressibility equations.</p>
<p>We shall present two ways of solving the system numerically. The first approach is dimensional splitting or method of fractional steps. This method is also known as time-operator splitting. In this approach one applies one-dimensional methods in each coordinate direction. A simple extension of the one-dimensional methods is required to solve the one-dimensional conservation laws augmented by the extra components of velocity present in multidimensional problems. Any of the methods studied before can be applied to solve the system, in conjunction with dimensional splitting. The other approach studied here is the finite volume method, whereby in updating the solution within some control volume one includes all the intercell flux contrbutions in a single step. Only some of the one-dimensional approaches discussed before can be extended to multidimensional problems following the (unsplit) finite volume approach. There is a close relationship between dimensional splitting and the finite volume method. If the schemes used in the dimensional splitting approach are of the finite-volume type in one space dimension, then the resulting splitting schemes may be viewed as being predictor-corrector type finite volume schemes in multidimensions. Both the dimensional splitting and the finite volume approaches may be extended to deal with non-Cartesian geometries.</p>
<div class="section" id="dimensional-splitting">
<h3>Dimensional Splitting<a class="headerlink" href="#dimensional-splitting" title="永久链接至标题">¶</a></h3>
</div>
</div>
<div class="section" id="lower-upper-symmetric-gauss-seidel-implicit-scheme-lu-sgs">
<h2>Lower-Upper Symmetric Gauss-Seidel Implicit Scheme (LU-SGS)<a class="headerlink" href="#lower-upper-symmetric-gauss-seidel-implicit-scheme-lu-sgs" title="永久链接至标题">¶</a></h2>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0965997815001520">Implementation of density-based implicit LU-SGS solver in the framework of OpenFOAM</a></p>
<p>Matrix-free LU-SGS implicit scheme is widely used because of its low numerical complexity and modest memory requirements.</p>
<p>Governing equations in integral form is shown as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{\Omega}\frac{\partial\mathbf{W}}{\partial t}\mathrm{d}\Omega
+ \oint_{\partial \Omega}(\mathbf{F}_{c} - \mathbf{F}_{v})~\mathrm{d}S
= 0
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> is the vector of the conservative variables, <span class="math notranslate nohighlight">\(\mathbf{F}_{c}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{F}_{v}\)</span> are the vectors of the convective fluxes and the viscous fluxes, respectively, and <span class="math notranslate nohighlight">\(\Omega, \partial\Omega\)</span> and <span class="math notranslate nohighlight">\(\mathrm{d}S\)</span> denote the control volume, the closed surface related to the particular control volume <span class="math notranslate nohighlight">\(\Omega\)</span> and a surface element.</p>
<p>By using the finite volume method for each grid cell <span class="math notranslate nohighlight">\(i\)</span> , the temporal and spatial discretization of the governing equations can be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big[ \frac{\Omega_{i}}{\Delta t}I + \frac{\partial \mathbf{R}_{i}^{n}}{\partial \mathbf{W}_{i}} \Big] \Delta \mathbf{W}_{i}^{n} = -\mathbf{R}_{i}^{n}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{R}_{i}^{n}\)</span> is the so-called residual (the complete spatial discretization term), the term <span class="math notranslate nohighlight">\(\frac{\partial \mathbf{R}_{i}^{n}}{\partial \mathbf{W}_{i}}\)</span> is referred to as the flux Jacobian, <span class="math notranslate nohighlight">\(I\)</span> is identity matrix, and the superscript <span class="math notranslate nohighlight">\(n\)</span> denotes time level at the current time <span class="math notranslate nohighlight">\(t\)</span> , with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{W}_{i}^{n} = \mathbf{W}_{i}^{n+1} - \mathbf{W}_{i}^{n}
\end{align}\]</div>
<p>being the solution correction. In this paper, we only consider the contribution of the convective flux Jacobian to the term <span class="math notranslate nohighlight">\(\frac{\partial \mathbf{R}_{i}^{n}}{\partial \mathbf{W}_{i}}\)</span> , i.e.</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial \mathbf{R}_{i}^{n}}{\partial \mathbf{W}_{i}} \Delta\mathbf{W}_{i}^{n}
= \frac{\partial\Big( \sum\limits_{j \in N(i)}\mathbf{F}_{c,ij}^{n}S_{ij} \Big)}{\partial \mathbf{W}_{ij}}\Delta\mathbf{W}_{ij}^{n}
= \sum_{j \in N(i)} \frac{\partial \mathbf{F}_{c,ij}^{n}}{\partial \mathbf{W}_{ij}} S_{ij} \Delta\mathbf{W}_{ij}^{n}
= \sum_{j \in N(i)} \mathbf{A}_{c,ij} S_{ij} \Delta\mathbf{W}_{ij}^{n}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial\mathbf{R}_{i}^{n}}{\partial\mathbf{W}_{i}}\Delta\mathbf{W}_{i}^{n}
= \frac{\partial \Big( \sum\limits_{j\in N(i)}\mathbf{F}_{c,ij}^{n}S_{ij} \Big)}{\partial\mathbf{W}}\Delta\mathbf{W}_{ij}^{n}
- \frac{\partial \Big( \sum\limits_{j\in N(i)}\mathbf{F}_{v,ij}^{n}S_{ij} \Big)}{\partial \mathbf{W}}\Delta\mathbf{W}_{ij}^{n}
= \sum_{j \in N(i)} \bigg( \frac{\partial \mathbf{F}_{c,ij}^{n}}{\partial \mathbf{W}} S_{ij}\Delta\mathbf{W}_{ij}^{n} \bigg)
- \sum_{j \in N(i)} \bigg( \frac{\partial\mathbf{F}_{v,ij}^{n}}{\partial \mathbf{W}}S_{ij}\Delta\mathbf{W}_{ij}^{n} \bigg)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}_{c}\)</span> is the convective Jacobian matrix, <span class="math notranslate nohighlight">\(N(i)\)</span> is the set of cells which are adjacent to cell <span class="math notranslate nohighlight">\(i\)</span> . Substituting it for the convective flux Jacobian into discretization equations, the following form is obtained:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\Omega_{i}}{\Delta t_{i}}\Delta\mathbf{W}_{i}
+ \sum_{j \in N(i)}\mathbf{A}_{c,ij} \Delta \mathbf{W}_{ij}^{n} S_{ij}
= -\mathbf{R}_{i}^{n}
\end{align}\]</div>
<p>Then applying the Steger-Warming splitting scheme to discretize the term related to the convective fluex above</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial \mathbf{F}_{c,ij}^{n}}{\partial \mathbf{W}} S_{ij}\Delta\mathbf{W}_{ij}^{n}
= (\mathbf{A}_{c,ij}^{+}\Delta\mathbf{W}_{i}^{n} + \mathbf{A}_{c,ij}^{-}\Delta\mathbf{W}_{j}^{n})S_{ij}
\end{align}\]</div>
<p>with <span class="math notranslate nohighlight">\(A_{c}^{\pm}\)</span> denoting the positive/negative Steger-Warming flux-splitting Jacobian matrix.</p>
<p>Applying TSL approximation the term related to the viscous fluxes becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial\mathbf{F}_{v,ij}^{n}}{\partial \mathbf{W}}S_{ij}\Delta\mathbf{W}_{ij}^{n}
\approx \Big( \mathbf{A}_{v,ij}\Delta\mathbf{W}_{j}^{n} - \mathbf{A}_{v,ij}\Delta\mathbf{W}_{i}^{n} \Big) S_{ij}
\end{align}\]</div>
<p>Finally, the following discretization form is obtained:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\Omega_{i}}{\Delta t_{i}}\Delta\mathbf{W}_{i}^{n}
+ \sum_{j \in N(i)} \Big(
\mathbf{A}_{c,i}^{+}\Delta \mathbf{W}_{i}^{n} + \mathbf{A}_{c,j}^{-}\Delta \mathbf{W}_{j}^{n}
+ \mathbf{A}_{v,ij}\Delta\mathbf{W}_{i}^{n} - \mathbf{A}_{v,ij}\Delta\mathbf{W}_{j}^{n}
\Big)S_{ij}
= -\mathbf{R}_{i}^{n}
\end{align}\]</div>
<p>According to the original theory of LU-SGS scheme, the implicit operator should be divided into the diagonal matrix <span class="math notranslate nohighlight">\(D\)</span> , the lower-diagonal matrix <span class="math notranslate nohighlight">\(L\)</span> and the upper-diagonal matrix <span class="math notranslate nohighlight">\(U\)</span> . For this purpose, the above equation should be deduced further as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Big[\frac{\Omega_{i}}{\Delta t_{i}}I
+ \sum_{j \in N(i)}(\mathbf{A}_{c,i}^{+}S_{ij} + \mathbf{A}_{v,ij}S_{ij})
\Big]\Delta W_{i}^{n}
+ \sum_{j \in L(i)}(\mathbf{A}_{c,j}^{-}S_{ij} - \mathbf{A}_{v,ij}S_{ij})\Delta\mathbf{W}_{j}^{n}
+ \sum_{j \in U(i)}(\mathbf{A}_{c,j}^{-}S_{ij} - \mathbf{A}_{v,ij}S_{ij})\Delta\mathbf{W}_{j}^{n}
= -\mathbf{R}_{i}^{n}
\end{align}\]</div>
<p>The split convective flux Jacobian could be evaluated as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
A^{\pm} \Delta  S_{ij} = \frac{1}{2}(A_{c}S_{ij} \pm \Lambda_{c}I)
,\quad
\Lambda_{c} = (|V| + c)S_{ij}
\end{align}\]</div>
<p>where the contravariant velocity <span class="math notranslate nohighlight">\(V = \mathbf{U}\cdot\mathbf{n}_{ij} = n_{x}u + n_{y}v + n_{z}w\)</span> , with the unit normal vector <span class="math notranslate nohighlight">\(\mathbf{n}_{ij} = n_{x}\mathbf{i} + n_{y}\mathbf{j} + n_{z}\mathbf{k}\)</span> corresponding to the face area vector <span class="math notranslate nohighlight">\(\mathbf{S}_{ij}\)</span> , and <span class="math notranslate nohighlight">\(\Lambda_{c}\)</span> represents the spectral radius of the convective flux Jacobian <span class="math notranslate nohighlight">\(A_{c}\)</span> .</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>将 <span class="math notranslate nohighlight">\(A_{c}^{\pm}S_{ij}\)</span> 具体展开的形式如下所示：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
A_{c}^{\pm}S_{ij} =
\begin{bmatrix}
\frac{1}{2}(-V_{t}S_{ij} \pm \Lambda_{c}) &amp;
\frac{1}{2}n_{x}S_{ij} &amp;
\frac{1}{2}n_{y}S_{ij} &amp;
\frac{1}{2}n_{z}S_{ij} &amp;
0 \\
\frac{1}{2}(n_{x}S_{ij}\phi - uVS_{ij}) &amp;
\frac{1}{2}(VS_{ij} - V_{t}S_{ij} - a_{3}n_{x}u S_{ij} \pm \Lambda_{c}) &amp;
\frac{1}{2}(n_{y}S_{ij}u - a_{2}n_{x}S_{ij}v) &amp;
\frac{1}{2}(n_{z}S_{ij}u - a_{2}n_{x}S_{ij}w) &amp;
\frac{1}{2}a_{2}n_{x}S_{ij} \\
\frac{1}{2}(n_{y}S_{ij}\phi - vVS_{ij}) &amp;
\frac{1}{2}(n_{x}S_{ij}v - a_{2}n_{y}S_{ij}u) &amp;
\frac{1}{2}(VS_{ij} - V_{t}S_{ij} - a_{3}n_{y}S_{ij}v \pm \Lambda_{c}) &amp;
\frac{1}{2}(n_{z}S_{ij}v - a_{2}n_{y}S_{ij}w) &amp;
\frac{1}{2}a_{2}n_{y}S_{ij} \\
\frac{1}{2}(n_{z}S_{ij}\phi - wVS_{ij}) &amp;
\frac{1}{2}(n_{x}S_{ij}w - a_{2}n_{z}S_{ij}u) &amp;
\frac{1}{2}(n_{y}S_{ij}w - a_{2}n_{z}S_{ij}v) &amp;
\frac{1}{2}(VS_{ij} - V_{t}S_{ij} - a_{3}n_{z}S_{ij}w \pm \Lambda_{c}) &amp;
\frac{1}{2}a_{2}n_{z}S_{ij} \\
\frac{1}{2}V(\phi - a_{1})S_{ij} &amp;
\frac{1}{2}(n_{x}S_{ij}a_{1} - a_{2}uVS_{ij}) &amp;
\frac{1}{2}(n_{y}S_{ij}a_{1} - a_{2}vVS_{ij}) &amp;
\frac{1}{2}(n_{z}S_{ij}a_{1} - a_{2}wVS_{ij}) &amp;
\frac{1}{2}(\gamma VS_{ij} - V_{t}S_{ij} \pm \Lambda_{c})
\end{bmatrix}
\end{align}\end{split}\]</div>
<p class="last">可以看到，对于同一个控制体积，当围绕其表面计算convective flux Jacobian并求和时，非对角元素会因为面矢量的方向原因而相互抵消，因此可以得到下面diagonal matrix的化简表达式。</p>
</div>
<p>Then substituting it into the deduced equations, the diagonal matrix <span class="math notranslate nohighlight">\(D\)</span> could be written as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
D_{i} = \frac{\Omega_{i}}{\Delta t_{i}}I
+ \sum_{j\in N(i)}\frac{\omega}{2}\Lambda_{c,ij}
+ \sum_{j \in N(i)}\mathbf{A}_{v,ij}S_{ij}
\end{align}\]</div>
<p>Meanwhile, <span class="math notranslate nohighlight">\(L_{i} = \sum_{j\in L(i)}(A_{c,j}^{-}S_{ij})\)</span> , with <span class="math notranslate nohighlight">\(L(i)\)</span> being the set of owner cells which are adjacent to the discrete element <span class="math notranslate nohighlight">\(i\)</span> cell, i.e. <span class="math notranslate nohighlight">\(j \in L(i)\)</span> ; <span class="math notranslate nohighlight">\(U_{i} = \sum_{j \in U(i)}(A_{c,j}^{-}S_{ij})\)</span> , with <span class="math notranslate nohighlight">\(U(i)\)</span> being the set of neighbor cells which are adjacent to the discrete element <span class="math notranslate nohighlight">\(i\)</span> cell, i.e. <span class="math notranslate nohighlight">\(j \in U(i)\)</span> . The viscous flux Jacobian can be approximated by its spectral radius, therefore the diagonal operator becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
D_{i} = \frac{\Omega_{i}}{\Delta t_{i}}I
+ \sum_{j\in N(i)}\frac{\omega}{2}\Lambda_{c,ij}
+ \sum_{j \in N(i)}\Lambda_{v,ij}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Lambda_{v,ij} = \frac{S_{ij}^{2}}{\Omega_{i}}
\max\Big(\frac{4}{3\rho_{ij}}, \frac{\gamma_{ij}}{\rho_{ij}}\Big)
\Big(\frac{\mu_{L}}{Pr_{L}} + \frac{\mu_{T}}{Pr_{T}}\Big)_{ij}
\end{align}\]</div>
<p>In the above equaiton, <span class="math notranslate nohighlight">\(\mu_{L}\)</span> denotes the laminar and <span class="math notranslate nohighlight">\(\mu_{T}\)</span> the turbulent dynamic viscosity coefficient, respectively. Furthermore, <span class="math notranslate nohighlight">\(Pr_{L}\)</span> and <span class="math notranslate nohighlight">\(Pr_{T}\)</span> are the laminar and the turbulent Prandtl numbers. The values of the flow variables at the faces of the control volume are obtained by arithmetic averaging.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">在进行以上Jacobian matrix计算的时候，单位面矢量的方向都是根据网格 <span class="math notranslate nohighlight">\(i\)</span> 的方向来确定的，也即需要保证面矢量方向都是从网格 <span class="math notranslate nohighlight">\(i\)</span> 指向相邻网格 <span class="math notranslate nohighlight">\(j\)</span> 的，以满足Gauss theorem的要求。</p>
</div>
<p>Finally the deduced equations could be transformed into</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\mathbf{D} + \mathbf{L})\mathbf{D}^{-1}(\mathbf{D} + \mathbf{U})\Delta \mathbf{W}^{n} = -\mathbf{R}^{n}
\end{align}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>精确的方程组应该写成</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\mathbf{L} + \mathbf{D} + \mathbf{U})\Delta\mathbf{W} = -\mathbf{R}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
(\mathbf{L} + \mathbf{D})\mathbf{D}^{-1}(\mathbf{D} + \mathbf{U})\Delta\mathbf{W} = -\mathbf{R} + \mathbf{L}\mathbf{D}^{-1}\mathbf{U}\Delta\mathbf{W}
\end{align}\]</div>
<p class="last">而在LU-SGS中， <span class="math notranslate nohighlight">\(\mathbf{L}\mathbf{D}^{-1}\mathbf{U}\Delta\mathbf{W}\)</span> 被忽略了。</p>
</div>
<p>The solving process is divided into two steps: forward sweep and backward sweep, where forward and backward sweep processes are directly solving the following two equtions, respectively,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; (\mathbf{D} + \mathbf{L})\Delta \mathbf{W}^{*} = - \mathbf{R}^{n} \\
&amp; (\mathbf{D} + \mathbf{U})\Delta \mathbf{W}^{n} = \mathbf{D}\Delta \mathbf{W}^{*}
\end{align}\end{split}\]</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">与Gauss-Seidel迭代进行对比，可以看到LU-SGS等价于一次初始迭代量取零的Symmetric Gauss-Seidel迭代。因此，使用LU-SGS的主要优势是不需要组装矩阵，节省内存消耗。参考讨论 <a class="reference external" href="https://www.cfd-china.com/topic/815/lu-sgs求解器/6">LU-SGS求解器</a></p>
</div>
<p>Dual time-stepping approach is very often employed for the unsteady flow. In this approach, pseudo-time term, i.e. <span class="math notranslate nohighlight">\(\Omega_{i}\frac{\Delta W_{i}^{*}}{\Delta \tau}\)</span> , should be added in as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Omega_{i}\frac{\Delta W_{i}^{l}}{\Delta \tau}
+ \Omega_{i}\frac{3\Delta W_{i}^{l} + 3W_{i}^{l} - 4W_{i}^{n} + W_{i}^{n-1}}{2\Delta t}
+ \sum_{j \in N(i)}(F_{c,ij}^{l+1} - F_{v,ij}^{l})S_{ij}
= 0
\end{align}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta W_{i}^{l} = W_{i}^{l+1} - W_{i}^{l}
\end{align}\]</div>
<p>where superscript <span class="math notranslate nohighlight">\(l\)</span> denotes the current pseudo-time level. Similar as the discretization for the physical time implicit scheme, the following equation is obtained:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bigg[ \Omega_{i}\Big( \frac{1}{\Delta\tau} + \frac{3}{2\Delta t} \Big) + \frac{\partial R_{i}^{l}}{\partial W_{i}^{l}} \bigg] \Delta W_{i}^{l} = -(R_{i}^{*})^{l}
\end{align}\]</div>
<p>where the residual term for dual time-stepping approach is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(R_{i}^{*})^{l} = R_{i}^{l} + \Big( \Omega_{i}\frac{3W_{i}^{l} - 4W_{i}^{n} + W_{i}^{n-1}}{2\Delta t} \Big)
\end{align}\]</div>
<p>The discretization procedure to solve the above eqution is similar as that shown for the physical time implicit scheme.</p>
</div>
<div class="section" id="temporal-discretization">
<h2>Temporal Discretization<a class="headerlink" href="#temporal-discretization" title="永久链接至标题">¶</a></h2>
<p>The application of the method of lines, that is, the discretization of the governing equations separately for spatial and temporal, leads, written down for each control volume, to a system of coupled ordinary differential equations in time</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d}(\Omega\bar{M}\mathbf{W})_{i}}{\mathrm{d}t} = -\mathbf{R}_{i}
\end{align}\]</div>
<p>In this eqution, <span class="math notranslate nohighlight">\(\Omega\)</span> represents the volume, <span class="math notranslate nohighlight">\(\mathbf{R}\)</span> the residual, <span class="math notranslate nohighlight">\(\bar{M}\)</span> the mass matrix, and the index <span class="math notranslate nohighlight">\(i\)</span> denotes the particular control volume. The system has to integrated in time–either to obtain a steady-state solution ( <span class="math notranslate nohighlight">\(\mathbf{R}_{i}=0\)</span> ), or to reproduce the time history of an unsteady flow.</p>
<p>We saw that the various explicit and implicit methods can be derived from a basic non-linear scheme. It reads for a stationary grid</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{(\Omega \bar{M})_{i}}{\Delta t_{i}}\Delta\mathbf{W}_{i}^{n}
= -\frac{\beta}{1 + \omega}\mathbf{R}_{i}^{n+1}
- \frac{1 - \beta}{1 + \omega}\mathbf{R}_{i}^{n}
+ \frac{\omega}{1 + \omega}\frac{(\Omega \bar{M})_{i}}{\Delta t_{i}}\Delta\mathbf{W}_{i}^{n-1}
\end{align}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{W}_{i}^{n} = \mathbf{W}_{i}^{n+1} - \mathbf{W}_{i}^{n}
\end{align}\]</div>
<p>stands for the update (correction) of the solution. The superscripts <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\((n+1)\)</span> denote the time levels. Hence, <span class="math notranslate nohighlight">\(\mathbf{W}^{n}\)</span> means the flow solution at the present time <span class="math notranslate nohighlight">\(t\)</span> . Consequently, <span class="math notranslate nohighlight">\(\mathbf{W}^{n+1}\)</span> represents the solution at the time <span class="math notranslate nohighlight">\((t + \Delta t)\)</span> . The parameters <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> determine the discretization type (explicit or implicit) and also the temporal accuracy.</p>
<div class="section" id="explicit-time-stepping-schemes">
<h3>Explicit Time-Stepping Schemes<a class="headerlink" href="#explicit-time-stepping-schemes" title="永久链接至标题">¶</a></h3>
<p>An explicit scheme starts from a known solution <span class="math notranslate nohighlight">\(\mathbf{W}^{n}\)</span> and employs the corresponding residual <span class="math notranslate nohighlight">\(\mathbf{R}^{n}\)</span> in order to obtain a new solution at time <span class="math notranslate nohighlight">\((t + \Delta t)\)</span> . In other words, the new solution <span class="math notranslate nohighlight">\(\mathbf{W}^{n+1}\)</span> depends solely on values already known. This fact makes the explicit schemes very simple and easy to implement.</p>
<p>A basic explicit scheme can be derived from the basic non-linear scheme by setting <span class="math notranslate nohighlight">\(\beta=0\)</span> and <span class="math notranslate nohighlight">\(\omega=0\)</span> . This results in</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{M}_{i}\Delta\mathbf{W}_{i}^{n} = -\frac{\Delta t_{i}}{\Omega_{i}}\mathbf{R}_{i}^{n}
\end{align}\]</div>
<p>which is termed the forward Euler approximation. The mass matrix <span class="math notranslate nohighlight">\(\bar{M}\)</span> can be lumped (i.e., substituted by the identity matrix) for steady problems or for the cell-centered discretization.</p>
<div class="section" id="multistage-schemes-runge-kutta">
<h4>Multistage Schemes (Runge-Kutta)<a class="headerlink" href="#multistage-schemes-runge-kutta" title="永久链接至标题">¶</a></h4>
<p>The concept of explicit multistage schemes was first presented by Jameson et al. The multistage scheme advances the solution in a number of steps (stages) which can be viewed as a sequence of updates according to basic explicit scheme. Applied to the discretized governing equations, where the mass matrix was lumped, an m-stage scheme reads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{W}_{i}^{(0)} = \mathbf{W}_{i}^{n} \\
&amp; \mathbf{W}_{i}^{(1)} = \mathbf{W}_{i}^{(0)} - \alpha_{1}\frac{\Delta t_{i}}{\Omega_{i}}\mathbf{R}_{i}^{(0)} \\
&amp; \mathbf{W}_{i}^{(2)} = \mathbf{W}_{i}^{(0)} - \alpha_{2}\frac{\Delta t_{i}}{\Omega_{i}}\mathbf{R}_{i}^{(1)} \\
&amp; \qquad\vdots \\
&amp; \mathbf{W}_{i}^{n+1} = \mathbf{W}_{i}^{(m)} = \mathbf{W}_{i}^{(0)} - \alpha_{m}\frac{\Delta t_{i}}{\Omega_{i}}\mathbf{R}_{i}^{(m-1)}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_{1},\cdots,\alpha_{m}\)</span> represent the stage coefficients. Furthermore, the denotation <span class="math notranslate nohighlight">\(\mathbf{R}_{i}^{(k)}\)</span> means that the residual is evaluated with the solution <span class="math notranslate nohighlight">\(\mathbf{W}_{i}^{(k)}\)</span> from the k-th stage.</p>
<p>Unlike the classical Runge-Kutta schemes, only the zero-th solution and the newest residual are stored here in order to reduce the memory requirements. The stage coefficients can be tuned to increase the maximum time step and to improve the stability for a particular spatial discretization. For consistency, it is only required that <span class="math notranslate nohighlight">\(\alpha_{m} = 1\)</span> . A consequence of teh modification to the Runge-Kutta scheme is that second-order time accuracy can be realized only if <span class="math notranslate nohighlight">\(\alpha_{m-1} = 1/2\)</span> . Otherwise, the multistage scheme is first-order accurate in time.</p>
<p>The above multistage approach is particularly suitable for upwind spatial discretization on structured as well as unstructured grids. Central discretization schemes perform more efficiently with the hybrid multistage methodology. Sets of optimized stage coefficients for first- and second-order upwind schemes are presented in the following table for three- to five-stage schemes. Practical experience shows that the coefficients for the first-order scheme should be preferred in cases, where the flow field contains for the first-order scheme should be preferred in cases, where the flow field contains strong shocks, regardless of the order of the spatial discretization. This can be explained by the fact that every higher-order scheme switches to first order at shocks to prevent oscillations of the solution. However, the residuals at strong shocks influence the convergence to steady state the most significantly.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="22%" />
<col width="9%" />
<col width="9%" />
<col width="23%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head" colspan="3">First-order scheme</th>
<th class="head" colspan="3">Second-order scheme</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Stages</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>CFL</td>
<td>1.5</td>
<td>2.0</td>
<td>2.5</td>
<td>0.69</td>
<td>0.92</td>
<td>1.15</td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\alpha_{1}\)</span></td>
<td>0.1481</td>
<td>0.0833</td>
<td>0.0533</td>
<td>0.1918</td>
<td>0.1084</td>
<td>0.0695</td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\alpha_{2}\)</span></td>
<td>0.4000</td>
<td>0.2069</td>
<td>0.1263</td>
<td>0.4929</td>
<td>0.2602</td>
<td>0.1602</td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\alpha_{3}\)</span></td>
<td>1.0000</td>
<td>0.4265</td>
<td>0.2375</td>
<td>1.0000</td>
<td>0.5052</td>
<td>0.2898</td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(\alpha_{4}\)</span></td>
<td>&#160;</td>
<td>1.0000</td>
<td>0.4414</td>
<td>&#160;</td>
<td>1.0000</td>
<td>0.5060</td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(\alpha_{5}\)</span></td>
<td>&#160;</td>
<td>&#160;</td>
<td>1.0000</td>
<td>&#160;</td>
<td>&#160;</td>
<td>1.0000</td>
</tr>
</tbody>
</table>
<p>The main disadvantage of every explicit scheme is that the time step <span class="math notranslate nohighlight">\((\Delta t)\)</span> is severely restricted by the characteristics of the governing equations as well as by the grid geometry.</p>
</div>
<div class="section" id="hybrid-multistage-schemes">
<h4>Hybrid multistage schemes<a class="headerlink" href="#hybrid-multistage-schemes" title="永久链接至标题">¶</a></h4>
<p>The computational work of an explicit multistage scheme can be substantially reduced if the viscous fluxes and the dissipation are not re-evaluated at each stage. Additionally, the dissipation terms from different stages can be blended to increase the stability of the scheme. Methods of this type were devised by Martinelli and by Mavriplis and Jameson. They are known as hybrid multistage schemes. Provided the stage coefficients are carefully optimized, the hybrid schemes are as robust as the basic multistage schemes.</p>
<p>Let us for illustration consider a popular 5-stage hybrid scheme, where the dissipative terms are evaluated at odd stages. First, we split the spatial discretization into two parts, that is,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{R}_{i} = (\mathbf{R}_{c})_{i} - (\mathbf{R}_{d})_{i}
\end{align}\]</div>
<p>The first part, <span class="math notranslate nohighlight">\(\mathbf{R}_{c}\)</span> , contains the central discretization of the convective fluxes, which can be either the average of variables or the average of fluxes. It also includes the source term. The second part, <span class="math notranslate nohighlight">\(\mathbf{R}_{d}\)</span> , is composed of the viscous fluxes and the numerical dissipation. For example, in the case of the central scheme with artificial dissipation we would set</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; (\mathbf{R}_{c})_{i} = \sum_{k=1}^{N_{F}}\Big[ \mathbf{F}_{c}(\mathbf{W}_{av})\Delta S \Big]_{k} - (\mathbf{Q}\Omega)_{i} \\
&amp; (\mathbf{R}_{d})_{i} = \sum_{k=1}^{N_{F}}\Big[ \mathbf{F}_{v}\Delta S + \mathbf{D} \Big]_{k}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{W}_{av}\)</span> represents the arithmetic average of flow variables from the left and the right side of face <span class="math notranslate nohighlight">\(k\)</span> .</p>
<p>With the residual split the scheme can be formulated as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{W}_{i}^{(0)} = \mathbf{W}_{i}^{n} \\
&amp; \mathbf{W}_{i}^{(1)} = \mathbf{W}_{i}^{(0)} - \alpha_{1}\frac{\Delta t_{i}}{\Omega_{i}}\Big[ \mathbf{R}_{c}^{(0)} - \mathbf{R}_{d}^{(0)} \Big]_{i} \\
&amp; \mathbf{W}_{i}^{(2)} = \mathbf{W}_{i}^{(0)} - \alpha_{2}\frac{\Delta t_{i}}{\Omega_{i}}\Big[ \mathbf{R}_{c}^{(1)} - \mathbf{R}_{d}^{(0)} \Big]_{i} \\
&amp; \mathbf{W}_{i}^{(3)} = \mathbf{W}_{i}^{(0)} - \alpha_{3}\frac{\Delta t_{i}}{\Omega_{i}}\Big[ \mathbf{R}_{c}^{(2)} - \mathbf{R}_{d}^{(2,0)} \Big]_{i} \\
&amp; \mathbf{W}_{i}^{(4)} = \mathbf{W}_{i}^{(0)} - \alpha_{4}\frac{\Delta t}{\Omega_{i}}\Big[ \mathbf{R}_{c}^{(3)} - \mathbf{R}_{d}^{(2,0)} \Big]_{i} \\
&amp; \mathbf{W}_{i}^{n+1} = \mathbf{W}_{i}^{(0)} - \alpha_{5}\frac{\Delta t_{i}}{\Omega_{i}}\Big[ \mathbf{R}_{c}^{(4)} - \mathbf{R}_{d}^{(4,2)} \Big]_{i}
\end{align}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{R}_{d}^{(2,0)} = \beta_{3}\mathbf{R}_{d}^{(2)} + (1-\beta_{3})\mathbf{R}_{d}^{(0)} \\
&amp; \mathbf{R}_{d}^{(4,0)} = \beta_{5}\mathbf{R}_{d}^{(4)} + (1-\beta_{5})\mathbf{R}_{d}^{(2,0)}
\end{align}\end{split}\]</div>
<p>The stage coefficients <span class="math notranslate nohighlight">\(\alpha_{m}\)</span> and the blending coefficients <span class="math notranslate nohighlight">\(\beta_{m}\)</span> in the above relations equations are given in following table for central and upwind schemes. Both sets of coefficients are particularly optimized for the multigrid method. We shall discuss the properties of the above hybrid multistage scheme later.</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="15%" />
<col width="14%" />
<col width="18%" />
<col width="14%" />
<col width="19%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head" colspan="2">Central scheme</th>
<th class="head" colspan="2">First-order upwind</th>
<th class="head" colspan="2">Second-order upwind</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CFL</td>
<td colspan="2">3.6</td>
<td colspan="2">2.0</td>
<td colspan="2">1.0</td>
</tr>
<tr class="row-odd"><td>Stage</td>
<td><span class="math notranslate nohighlight">\(\alpha\)</span></td>
<td><span class="math notranslate nohighlight">\(\beta\)</span></td>
<td><span class="math notranslate nohighlight">\(\alpha\)</span></td>
<td><span class="math notranslate nohighlight">\(\beta\)</span></td>
<td><span class="math notranslate nohighlight">\(\alpha\)</span></td>
<td><span class="math notranslate nohighlight">\(\beta\)</span></td>
</tr>
<tr class="row-even"><td>1</td>
<td>0.2500</td>
<td>1.00</td>
<td>0.2742</td>
<td>1.00</td>
<td>0.2742</td>
<td>1.00</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>0.1667</td>
<td>0.00</td>
<td>0.2067</td>
<td>0.00</td>
<td>0.2067</td>
<td>0.00</td>
</tr>
<tr class="row-even"><td>3</td>
<td>0.3750</td>
<td>0.56</td>
<td>0.5020</td>
<td>0.56</td>
<td>0.5020</td>
<td>0.56</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>0.5000</td>
<td>0.00</td>
<td>0.5142</td>
<td>0.00</td>
<td>0.5142</td>
<td>0.00</td>
</tr>
<tr class="row-even"><td>5</td>
<td>1.0000</td>
<td>0.44</td>
<td>1.0000</td>
<td>0.44</td>
<td>1.0000</td>
<td>0.44</td>
</tr>
</tbody>
</table>
<p>It should be mentioned that it is also popular to evaluate the dissipation term <span class="math notranslate nohighlight">\(\mathbf{R}_{d}\)</span> in the first two stages only, without any blending. A well-known (5,2)-scheme, which is often employed with the central spatial discretization, uses the stage coefficients of the table. However, the (5,2)-scheme is less suitable for viscous flows and multigrid than the (5,3)-scheme.</p>
</div>
<div class="section" id="treatment-of-the-source-term">
<h4>Treatment of the source term<a class="headerlink" href="#treatment-of-the-source-term" title="永久链接至标题">¶</a></h4>
<p>There are certain cases in which the source term <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> becomes dominant. Such situation is often encounterred when chemistry or turbulence models are employed. The problem is that a large source term changes the flow variables rapidly in space and in time. The changes due to a strong source term happen at much smaller time scales than those of the flow equations. This increases the stiffness of the governing equations significantly. The stiffness is defined as the ratio of the largest to the smallest eigenvalue of the Jacobian matrix <span class="math notranslate nohighlight">\(\partial \mathbf{R}/\partial \mathbf{W}\)</span> . The stiffness can also be viewed as the ratio of the largest to the smallest time scale.</p>
<p>When we apply one of the above explicit multistage schemes (or any other purely explicit scheme) to a stiff system of equations, we will have to reduce the time step considerably in order stabilize the time integration. Hence, the convergence to the steady state will become very slow. More seriously, an explicit scheme can be even fail to find the correct solution. A remedy suggested by Curtiss and Hirschfelder is to treat the source term in an implicit way. In order to demonstrate the approach, we rewrite the basic explicit scheme as follows</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\Omega_{i}}{\Delta t_{i}}\Delta\mathbf{W}_{i}^{n}
= - \bigg[ \sum_{k=1}^{N_{F}}(\mathbf{F}_{c}^{n} - \mathbf{F}_{v}^{n})_{k}\Delta S_{k} - \Omega_{i}\mathbf{Q}_{i}^{n+1} \bigg]
= -(\mathbf{R}_{Q})_{i}^{n} + \Omega_{i}\mathbf{Q}_{i}^{n+1}
\end{align}\]</div>
<p>where the source term is now evaluated at the new time level <span class="math notranslate nohighlight">\((n+1)\)</span> . For simplicity, the mass matrix was omitted from this equation. Since the value of the source term at the time <span class="math notranslate nohighlight">\((n+1)\)</span> is unknown, we have to approximate it. For this purpose, we linearize the source term about the current time level <span class="math notranslate nohighlight">\(n\)</span> , resulting in</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{Q}^{n+1} \approx \mathbf{Q}^{n} + \frac{\partial \mathbf{Q}}{\partial \mathbf{W}}\Delta\mathbf{W}^{n}
\end{align}\]</div>
<p>If we insert it into the equation and rearrange the terms, we obtain the following relation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bigg[ \frac{1}{\Delta t_{i}}\bar{I} - \Big( \frac{\partial\mathbf{Q}}{\partial\mathbf{W}} \Big)_{i} \bigg]\Delta\mathbf{W}_{i}^{n}
= -\frac{1}{\Omega_{i}}\Big[ (\mathbf{R}_{Q})_{i}^{n} - \Omega_{i}\mathbf{Q}_{i}^{n} \Big]
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{I}\)</span> represents the identity matrix. The formulation is called point implicit because the term is square brackets on the left-hand side (the implicit operator) depends only on values in the control volume <span class="math notranslate nohighlight">\(\Omega_{i}\)</span> itself. A comparison with the first equation reveals that now the scalar time step <span class="math notranslate nohighlight">\(\Delta t\)</span> changed to a matrix. Thus, each flow equation becomes scaled by an individual parameter, corresponding to the associated eigenvalue. In this way, the disparity between the time scales is offset and the time step restriction due to the source term is alleviated.</p>
<p>When we apply the above point-implicit approach to the multistage scheme, we obtain for the k-th stage</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{W}_{i}^{(k)} = \mathbf{W}_{i}^{(0)} - \Big[ (\mathbf{R}_{Q})_{i}^{(k-1)} - \Omega_{i}\mathbf{Q}_{i}^{(0)} \Big] \bigg[ \frac{\Omega_{i}}{\alpha_{k}\Delta t_{i}}\bar{I} - \Big(\frac{\partial \mathbf{Q}}{\partial \mathbf{W}}\Big)_{i} \bigg]^{-1}
\end{align}\]</div>
<p>A similar expression holds also for the hybrid multistage scheme. A more elaborate approach is to treat the stiff source term by means of an implicit Runge-Kutta scheme, described first by Rosenbrock and Butcher. Schemes of this type are numerically more stable than the approach above, however they require the inversion of a large system of linear equations at each stage.</p>
</div>
<div class="section" id="determination-of-the-maximum-time-step">
<h4>Determination of the maximum time step<a class="headerlink" href="#determination-of-the-maximum-time-step" title="永久链接至标题">¶</a></h4>
<p>Every explicit time-stepping scheme remains stable only up to a certain value of the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> . To be stable, a time-stepping scheme has to fulfill the so-called CFL condition. It states that the domain of dependence of the numerical method has to include the domain of dependence of the paritial differential equation. The CFL condition means for the basic explicit scheme that the time step should be equal to or smaller than the time required to transport information acroos the stencil of the spatial discretization scheme. Hence, in 1D the condtion for the time step would read for the linear convection equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t = \sigma\frac{\Delta x}{|\Lambda_{c}|}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta x / |\Lambda_{c}|\)</span> represents the time necessary to propagate information over the cell size <span class="math notranslate nohighlight">\(\Delta x\)</span> with the velocity <span class="math notranslate nohighlight">\(\Lambda_{c}\)</span> . The velocity <span class="math notranslate nohighlight">\(\Lambda_{c}\)</span> corresponds to the maximum eigenvalue of the convective flux Jacobian. The positive coefficient <span class="math notranslate nohighlight">\(\sigma\)</span> denotes the CFL number. The magnitude of the CFL number depends on the type and the parameters of the time-stepping scheme, as well as on the form of the spatial discretization problems.</p>
<p>The maximum time step can be determined for linear model equations with the aid of Von Neumann stability analysis. However, the maximum time step can be calculated only approximately in multiple dimensions and for non-linear governing equations.</p>
<div class="section" id="time-step-on-structured-grids">
<h5>Time step on structured grids<a class="headerlink" href="#time-step-on-structured-grids" title="永久链接至标题">¶</a></h5>
<p>On a structured grid, the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> can be determined for a control volume <span class="math notranslate nohighlight">\(\Omega_{i}\)</span> from the approximate relation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t_{i} = \sigma \frac{\Omega_{i}}{(\hat{\Lambda}_{c}^{i} + \hat{\Lambda}_{c}^{j} + \hat{\Lambda}_{c}^{k})_{i}}
\end{align}\]</div>
<p>The CFL number <span class="math notranslate nohighlight">\(\sigma\)</span> is given for multistage schemes in tables before. The spectral radii of the convective flux Jacobians read for the three grid directions</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \hat{\Lambda}_{c}^{I} = (|\mathbf{U} \cdot \mathbf{n}^{I}| + c)\Delta S^{I} \\
&amp; \hat{\Lambda}_{c}^{J} = (|\mathbf{U} \cdot \mathbf{n}^{J}| + c)\Delta S^{J} \\
&amp; \hat{\Lambda}_{c}^{K} = (|\mathbf{U} \cdot \mathbf{n}^{K}| + c)\Delta S^{K}
\end{align}\end{split}\]</div>
<p>The normal vectors and face areas in the above equation are obtained by averaging the corresponding values from the two opposite sides of the control volume in the respective direction. For example, if a dual control volume would be oriented as sketched in Fig.4.1b, we would use in the I-direction</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{n}_{i,j,k}^{I} = \frac{1}{2}(\mathbf{n}_{1} - \mathbf{n}_{2})
,\quad
\Delta S_{i,j,k}^{I} = \frac{1}{2}(\Delta S_{1} + \Delta S_{2})
\end{align}\]</div>
<p>Similar expressions hold for the J- and K-direction.</p>
<p>With the approximate relation, we obtain a local time step, which is valid for one control volume only. If we are interested in s steady state solution, we may use the local time step to accelerate the convergence. However, if time accuracy is important, we have to employ one global time step for all volumes, that is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t = \min_{i}(\Delta t_{i})
\end{align}\]</div>
<p>where the minimum is taken over all control volumes.</p>
<p>For viscous flows, the spectral radii of the viscous flux Jacobians have to be included in the computation of <span class="math notranslate nohighlight">\(\Delta t\)</span> . They can severely limit the maximum time step in boundary layers. The time step can be evaluated from</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t_{i} = \sigma \frac{\Omega_{i}}{(\hat{\Lambda}_{c}^{I} + \hat{\Lambda}_{c}^{J} + \hat{\Lambda}_{c}^{K})_{i} + C(\hat{\Lambda}_{v}^{I} + \hat{\Lambda}_{v}^{J} + \hat{\Lambda}_{v}^{K})_{i}}
\end{align}\]</div>
<p>The constant which multiplies the viscous spectral radii is usually set as <span class="math notranslate nohighlight">\(C=4\)</span> for central spatial discretizations, <span class="math notranslate nohighlight">\(C=2\)</span> for first-order upwind and <span class="math notranslate nohighlight">\(C=1\)</span> for second-order upwind discretizations. If we assume that an eddy-viscosity turbulence model is employed, the viscous spectral radii are given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\Lambda}_{v}^{I} = \max\Big( \frac{4}{3\rho}, \frac{\gamma}{\rho}\Big) \Big( \frac{\mu_{L}}{Pr_{L}} + \frac{\mu_{T}}{Pr_{T}}\Big) \frac{(\Delta S^{I})^{2}}{\Omega}
\end{align}\]</div>
<p>and similarly for the other directions. In this equation, <span class="math notranslate nohighlight">\(\mu_{L}\)</span> denotes the laminar and <span class="math notranslate nohighlight">\(\mu_{T}\)</span> the turbulent dynamic viscosity coefficient, respectively. Furthermore, <span class="math notranslate nohighlight">\(Pr_{L}\)</span> and <span class="math notranslate nohighlight">\(Pr_{T}\)</span> are the laminar and the turbulent Prandtl numbers. The CFL numbers in tables apply also for viscous flows. Particularly  efficient for viscous flows is the hybrid scheme.</p>
</div>
<div class="section" id="time-step-on-unstructured-grids">
<h5>Time step on unstructured grids<a class="headerlink" href="#time-step-on-unstructured-grids" title="永久链接至标题">¶</a></h5>
<p>Several approaches were suggested for the estimation of the maximum time step on unstructured grids. We shall present two different approaches below.</p>
<p><strong>Method 1</strong> One proven method, which closely follows the implementation on strctured grids, reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t_{I} = \sigma \frac{\Omega_{I}}{(\hat{\Lambda}_{c} + C\hat{\Lambda}_{v})_{I}}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{\Lambda}_{c}\)</span> and <span class="math notranslate nohighlight">\(\hat{\Lambda}_{v}\)</span> represent a sum of the convective and viscous spectral radii over all faces of the control volume. As on strctured grids, <span class="math notranslate nohighlight">\(1 \le C \le 4\)</span> is usually used. In the case of the cell-centered scheme, the spectral radii are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; (\hat{\Lambda}_{c})_{I} = \sum_{J=1}^{N_{F}}(|\mathbf{U}_{IJ} \cdot \mathbf{n}_{IJ}| + c_{IJ})\Delta S_{IJ} \\
&amp; (\hat{\Lambda}_{v})_{I} = \frac{1}{\Omega_{I}}\sum_{J=1}^{N_{F}} \bigg[ \max\Big(\frac{4}{3\rho_{IJ}}, \frac{\gamma_{IJ}}{\rho_{IJ}}\Big) \Big( \frac{\mu_{L}}{Pr_{L}} + \frac{\mu_{T}}{Pr_{T}} \Big)_{IJ}(\Delta S_{IJ})^{2} \bigg]
\end{align}\end{split}\]</div>
<p>The values of the flow variables at the faces of the control volume are obtained by arithmetic averaging.</p>
<p><strong>Method 2</strong> The spectral radii predicted by the above equationa are too large, particularly on mixed element grids. This leads to a smaller time step than necessary for stability. Another implementation offers a more accurate estimation of the time step, namely</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t_{I} = \sigma \frac{\Omega_{I}}{(\hat{\Lambda}_{c}^{x} + \hat{\Lambda}_{c}^{y} + \hat{\Lambda}_{c}^{z})_{I} + C(\hat{\Lambda}_{v}^{x} + \hat{\Lambda}_{v}^{y} + \hat{\Lambda}_{v}^{z})_{I}}
\end{align}\]</div>
<p>with the convective spectral radii</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \hat{\Lambda}_{c}^{x} = (|u| + c)\Delta \hat{S}^{x} \\
&amp; \hat{\Lambda}_{c}^{\gamma} = (|v| + c)\Delta \hat{S}^{y} \\
&amp; \hat{\Lambda}_{c}^{z} = (|w| + c)\Delta \hat{S}^{z}
\end{align}\end{split}\]</div>
<p>and with the viscous spectral radii (eddy-viscosity turbulence model assuemd)</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{\Lambda}_{v}^{x} = \max\Big( \frac{4}{3\rho}, \frac{\gamma}{\rho} \Big) \Big( \frac{\mu_{L}}{Pr_{L}} + \frac{\mu_{T}}{Pr_{T}} \Big) \frac{(\Delta \hat{S}^{x})^{2}}{\Omega}
\end{align}\]</div>
<p>The variables <span class="math notranslate nohighlight">\(\Delta \hat{S}^{x}, \Delta \hat{S}^{y}, \Delta \hat{S}^{z}\)</span> , respectively, represent projections of the control volume on the y-z-, x-z-, and the x-y-plane. They are given by the formulas</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \Delta \hat{S}^{x} = \frac{1}{2}\sum_{J=1}^{N_{F}}|S_{x}|_{J} \\
&amp; \Delta\hat{S}^{y} = \frac{1}{2}\sum_{J=1}^{N_{F}}|S_{y}|_{J} \\
&amp; \Delta\hat{S}^{z} = \frac{1}{2}\sum_{J=1}^{N_{F}}|S_{z}|_{J}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{x}, S_{y}\)</span> and <span class="math notranslate nohighlight">\(S_{z}\)</span> denote the x-, y- and the z-component of the face vector <span class="math notranslate nohighlight">\(\mathbf{S} = \mathbf{n} \cdot \Delta S\)</span> .</p>
<p>The CFL numbers remain in general the same as on structured grids. Thus, the values collected in tables before still apply. Furthermore, the convergence to steady state can also be accelerated by local time stepping, in the same way as on the structured grids. A global time step, necessary for simulating unsteady flows, can be obtained from <span class="math notranslate nohighlight">\(\Delta t = \min(\Delta t_{I})\)</span> as before.</p>
</div>
</div>
</div>
<div class="section" id="implicit-time-stepping-schemes">
<h3>Implicit Time-Stepping Schemes<a class="headerlink" href="#implicit-time-stepping-schemes" title="永久链接至标题">¶</a></h3>
<p>Various implicit time integration schemes can be obtained by setting <span class="math notranslate nohighlight">\(\beta \ne 0\)</span> . An implicit scheme with <span class="math notranslate nohighlight">\(\omega=0\)</span> was found to be best suited for the solution of stationary flow problems. Herewith, the basic non-linear scheme simplifies to</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{(\Omega\bar{M})_{I}}{\Delta t_{I}}\Delta\mathbf{W}_{I}^{n}
= -\beta\mathbf{R}_{I}^{n+1} - (1-\beta)\mathbf{R}_{I}^{n}
\end{align}\]</div>
<p>As we can see, the implicit formulation leads to a set of non-linear equations for the unknown flow variables at the time <span class="math notranslate nohighlight">\((t + \Delta t)\)</span> . The solution of the equation requires the evaluation of the residual at the new time level, that is, <span class="math notranslate nohighlight">\(\mathbf{R}^{n+1}\)</span> . Since we do not know <span class="math notranslate nohighlight">\(\mathbf{W}^{n+1}\)</span> , this cannot be done directly. However, we can linearize the residual <span class="math notranslate nohighlight">\(\mathbf{R}^{n+1}\)</span> in the equation about the current time level, that is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{R}_{I}^{n+1} \approx \mathbf{R}_{I}^{n} + \Big( \frac{\partial \mathbf{R}}{\partial \mathbf{W}} \Big)_{I}\Delta\mathbf{W}^{n}
\end{align}\]</div>
<p>where the term <span class="math notranslate nohighlight">\(\partial\mathbf{R}/\partial\mathbf{W}\)</span> is referred to as the flux Jacobian. We should mention that the flux Jacobian is often derived from a rather crude approximation to the spatial discretization represented by <span class="math notranslate nohighlight">\(\mathbf{R}^{n}\)</span> . For example, in the case of higher-order upwind discretizations, it is quite common to base the flux Jacobian solely on a first-order upwind scheme. However, for best efficiency and robustness, the flux Jacobian should still reflect the most important features of the spatial discretization.</p>
<p>If we substitute now the linearization for <span class="math notranslate nohighlight">\(\mathbf{R}^{n+1}\)</span> into the equation, we obtain the following implicit scheme</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bigg[ \frac{(\Omega\bar{M})_{I}}{\Delta t_{I}} + \beta \Big( \frac{\partial\mathbf{R}}{\partial\mathbf{W}} \Big)_{I} \bigg] \Delta\mathbf{W}^{n} = -\mathbf{R}_{I}^{n}
\end{align}\]</div>
<p>The term in square brackets on the left-hand side of it is reffered to as the implicit operator or the system matrix. Consequently, the right-hand side of the equation is called the explicit operator. It is only the explicit operator that determines the spatial accuracy of the solution.</p>
<p>The implicit operator constitutes a large, sparse, and non-symmetric block matrix with dimensions equal to the total number of cells (cell-centered scheme) or grid points structured as well as for unstructured grids. As we already saw before, the mass matrix <span class="math notranslate nohighlight">\(\bar{M}\)</span> can be replaced by the identity matrix, without influencing the steady state solution. The parameter <span class="math notranslate nohighlight">\(\beta\)</span> is generally set to <span class="math notranslate nohighlight">\(1\)</span> , which results in a first-order accurate temporal discretization. A second-order time accurate scheme is obtained for <span class="math notranslate nohighlight">\(\beta=1/2\)</span> . However, this is not recommended since the scheme with <span class="math notranslate nohighlight">\(\beta=1\)</span> is much more robust, and the time accuracy is of no importance for steady problems.</p>
<p>In the case of stiff governing equations, the source term has to be included in the implicit operator. This happens quite naturally with the linearization of the residual, which leads to a formulation identical to <span class="math notranslate nohighlight">\(\mathbf{Q}^{n+1} \approx \mathbf{Q}^{n} + \frac{\partial\mathbf{Q}}{\partial\mathbf{W}}\Delta\mathbf{W}\)</span> . The above implicit scheme remains stable for any time step if the eigenvalues of <span class="math notranslate nohighlight">\(\partial\mathbf{Q}/\partial\mathbf{W}\)</span> are all negative or zero.</p>
<p>The solution of the linear equation system requires the inversion of the implicit operator, that is, the inversion of a very large matrix. In principle, this can be done in two ways. The first one consists of a direct matrix inversion, using either the Gaussian elimination or some direct sparse matrix method. However, because of the excessive amount of memory and the very high computational effort, this approach is not suited for practical problems.</p>
<p>The second possibility of inverting the implicit operator represent iterative methods. Iterative methods can be divided roughly into two groups. The first one consists of approaches which decompose the implicit operator into several parts (a process called factorization). The factors are constructed in such a way that they can be more easily inverted than the original implicit operator. To the second group belong schems, which employ a Krylov-subspace method for the inversion of the implicit operator. In this case, the implicit time-stepping scheme is usually turned into Newton’s method by setting <span class="math notranslate nohighlight">\(\Delta t \to \infty\)</span> . The scheme is then named Newton-Krylov method.</p>
<div class="section" id="matrix-form-of-the-implicit-operator">
<h4>Matrix form of the implicit operator<a class="headerlink" href="#matrix-form-of-the-implicit-operator" title="永久链接至标题">¶</a></h4>
<p>We can write the linearization of the residual <span class="math notranslate nohighlight">\(\mathbf{R}^{n+1}\)</span> in the form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{R}^{n+1} \approx \mathbf{R}^{n}
+ \sum_{m=1}^{N_{F}} \bigg\{ \frac{\partial}{\partial\mathbf{W}}\Big[(\mathbf{F}_{c} - \mathbf{F}_{v})_{m}\Delta S_{m}\Big] \Delta\mathbf{W}^{n} \bigg\}
- \frac{\partial(\Omega\mathbf{Q})}{\partial\mathbf{W}}\Delta\mathbf{W}
\end{align}\]</div>
<p>with <span class="math notranslate nohighlight">\(N_{F}\)</span> being the number of faces of the control volume <span class="math notranslate nohighlight">\(\Omega\)</span> . Thus, the flux Jacobian reads</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial\mathbf{R}}{\partial\mathbf{W}}
= \sum_{m=1}^{N_{F}}\frac{\partial(\mathbf{F}_{c})_{m}}{\partial\mathbf{W}}\Delta S_{m}
- \sum_{m=1}^{N_{F}}\frac{\partial(\mathbf{F}_{v})_{m}}{\partial\mathbf{W}}\Delta S_{m}
- \frac{\partial(\Omega\mathbf{Q})}{\partial\mathbf{W}}
\end{align}\]</div>
<p>It should be stressed that the flux Jacobian has to be conceived as an operator which acts on the update <span class="math notranslate nohighlight">\(\Delta\mathbf{W}\)</span> . As stated above, the convective and viscous fluxes do not necessarily have to be identical to the fluxes in the explicit operator.</p>
<p>Because of the significant differences between the implicit operators on structured and unstructured grids, we shall treat each case separately.</p>
<p>The appearance of the system matrix changes completely when we proceed from structured to unstructured grids. This can be demonstrated with the aid of a small unstructured grid sketched in Fig.6.3. We want assume that the spatial discretization is given by the cell-centred scheme, which uses flow values only from the nearest neighbors (e.g., like a first-order upwind scheme). Thus, for example, the stencil for cell 2 includes the cells 18, 10, and 13. The resulting system matrix is displayed on the right side of Fig.6.3. It is obvious that since the grid cells (nodes in the case of a median-dual scheme) are in general numbered in an arbitrary order, no regular pattern can be expected for the matrix. Only the main diagonal, which contains at least the expression <span class="math notranslate nohighlight">\(\frac{(\Omega \bar{M})_{I}}{\Delta t_{I}}\)</span> and possibly the derivative of the source term, is always present.</p>
<p>The quasi-random distribution of nonzero elements in the system matrix is undesirable. It slows down the convergence of iterative inversion methods like Gauss-Seidel. Furthermore, preconditioning techniques for Krylov-subspace methods like incomplete lower-upper (ILU) factorization scheme cannot be used effectively. Therefore, strategies were developed where the cells (nodes) are renumbered such that the bandwidth of the system matrix is considerably reduced, that is, the nonzero elements are clustered close to the main diagonal. The best-known renumbering strategy is the Reverse-Cuthill-McKee (RCM) algorithm. Several other renumbering strategies were developed in order to minimize cache misses or to allow for vectorization of the numerical scheme.</p>
</div>
<div class="section" id="evaluation-of-the-flux-jacobian">
<h4>Evaluation of the flux Jacobian<a class="headerlink" href="#evaluation-of-the-flux-jacobian" title="永久链接至标题">¶</a></h4>
<p>Depending on the type of the underlying spatial discretization scheme, an analytical evaluation of the flux Jacobian <span class="math notranslate nohighlight">\(\partial\mathbf{R}/\partial\mathbf{W}\)</span> may be very complex if not impossible. In order to make the concepts more clear, we shall derive the flux Jacobian for inviscid flows and then discuss the extension to the Navier-Stokes equations.</p>
<div class="section" id="central-scheme">
<h5>Central scheme<a class="headerlink" href="#central-scheme" title="永久链接至标题">¶</a></h5>
<p>The flux Jacobian is most easily formulated in the case of the central spatial discretization. As we already saw for the example in Fig.6.1, <span class="math notranslate nohighlight">\(\partial\mathbf{R}/\partial\mathbf{W}\)</span> consists of the convective flux Jacobians, which can be derived analytically. Artificial viscosity is usually included in a simplified form, without the non-linear pressure sensor.</p>
</div>
<div class="section" id="flux-vector-splitting-scheme">
<h5>Flux-vector splitting scheme<a class="headerlink" href="#flux-vector-splitting-scheme" title="永久链接至标题">¶</a></h5>
<p>The evalutation of the flux Jacobian becomes more involved when one of the flux-vector splitting schemes is used as the basis for its derivation. Let us, for illustration, consider the Steger-Warming. Previous investigations revealed that the Steger-Warming splitting is preferable over, for example, van Leer’s flux-vector splitting scheme for various upwind disretizations of the implicit operator.</p>
<p>The basic idea of the Steger-Warming flux-vector splitting scheme is to divide the convective fluxes into a positive and a negative part, that is,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{c} = \mathbf{F}_{c}^{+} + \mathbf{F}_{c}^{-}
\end{align}\]</div>
<p>with the fluxes defined as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{F}_{c}^{\pm} = \bar{A}_{SW}^{\pm} = (\bar{T}\bar{\Lambda}^{\pm}\bar{T}^{-1})\mathbf{W}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{A}_{SW}^{\pm}\)</span> denotes the positive/negative Steger-Warming flux-splitting Jacobian. Furthermore, <span class="math notranslate nohighlight">\(\bar{T}\)</span> represents the matrix of right eigenvectors, <span class="math notranslate nohighlight">\(\bar{T}^{-1}\)</span> the matrix of left eigenvectors, and <span class="math notranslate nohighlight">\(\bar{\Lambda}^{\pm}\)</span> stands for the diagonal matrix of positive/negative eigenvalues, respectively. The eigenvalue matrices are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{\Lambda}^{\pm} = \frac{1}{2}(\bar{\Lambda}_{c} \pm |\bar{\Lambda}_{c}|)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{\Lambda}_{c}\)</span> is given by Eq.(A.84).</p>
<p>Using the splitting defined in <span class="math notranslate nohighlight">\(\mathbf{F}_{c} = \mathbf{F}_{c}^{+} + \mathbf{F}_{c}^{-}\)</span> , we obtain for the product of the flux Jacobian with the update <span class="math notranslate nohighlight">\(\Delta\mathbf{W}^{n}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial\mathbf{R}_{I}}{\partial\mathbf{W}}\Delta\mathbf{W}^{n}
= \sum_{m=1}^{N_{F}} \bigg[
\frac{\partial(\mathbf{F}_{c}^{+}\Delta S)_{m}}{\partial\mathbf{W}_{L,m}}\Delta\mathbf{W}_{L,m}^{n}
+ \frac{\partial(\mathbf{F}_{c}^{-}\Delta S)_{m}}{\partial\mathbf{W}_{R,m}}\Delta\mathbf{W}_{R,m}^{n}
\bigg]
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta\mathbf{W}_{L,m}^{n}\)</span> and <span class="math notranslate nohighlight">\(\Delta\mathbf{W}_{R,m}^{n}\)</span> denote the updates of the left and right state at the face <span class="math notranslate nohighlight">\(m\)</span> , respectively. On structured grids, the left and right state can be evaluated by the MUSCL approach. On unstructured grids, the reconstruction methods can be applied. However, the stencil becomes wider with increasing accuracy, which leads to larger bandwidth of the system matrix. Therefore, and in order to reduce the numerical complexity, only first-order accurate approximation is usually employed in the equation. As a compromise, we could reconstruct the left and right state with higher accuracy but retain the stencil of the first-order scheme for the evaluation of the derivatives.</p>
<p>To proceed with the discussion of the evaluation of the derivatives <span class="math notranslate nohighlight">\(\partial\mathbf{F}_{c}^{\pm}/\partial\mathbf{W}\)</span> in the equation, let us consider, for example, the positive flux at face <span class="math notranslate nohighlight">\(m\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial(\mathbf{F}_{c}^{+}\Delta S)_{m}}{\partial\mathbf{W}_{L,m}}
= \frac{\partial}{\partial\mathbf{W}_{L,m}}\Big[ (\bar{A}_{SW}^{+}\mathbf{W})_{L,m}\Delta S_{m} \Big]
\end{align}\]</div>
<p>which becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial(\mathbf{F}_{c}^{+}\Delta S)_{m}}{\partial\mathbf{W}_{L,m}}
= \frac{\Delta S_{m}}{2}\Big[ (\bar{A}_{c})_{L,m} + |(\bar{A}_{c})_{L,m}| \Big]
+ \frac{\Delta S_{m}}{2}\bigg[
\frac{\partial(\bar{A}_{c})_{L,m}}{\partial\mathbf{W}_{L,m}}
+ \frac{\partial |(\bar{A}_{c})_{L,m}|}{\partial\mathbf{W}_{L,m}}
\bigg] \mathbf{W}_{L,m}^{n}
\end{align}\]</div>
<p>An expression similar to the above equation can also be found for the negative flux. As we can see, the first term it consists of convective flux Jacobians and thus presents no difficulty. However, the second term involves derivatives of matrix elements. Although it is possible to obtain the derivatives analytically, this will produce a large, computationally inefficient code. Alternatively, it is possible to assume the matrix <span class="math notranslate nohighlight">\(\bar{A}_{c}\)</span> is locally constant so that the second term in the equation can be neglected. However, depending on the type of the implicit scheme, this may severely restrict the CFL number.</p>
</div>
<div class="section" id="flux-difference-splitting-scheme">
<h5>Flux-difference splitting scheme<a class="headerlink" href="#flux-difference-splitting-scheme" title="永久链接至标题">¶</a></h5>
<p>In the case of the flux-difference splitting scheme due to Roe, we can write the product of the flux Jacobian with the update as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial\mathbf{R}_{I}}{\partial\mathbf{W}}\Delta\mathbf{W}^{n}
= \sum_{m=1}^{N_{F}} \frac{\Delta S_{m}}{2} \bigg\{
(\bar{A}_{c})_{L,m} \Delta\mathbf{W}_{L,m}^{n}
+ (\bar{A}_{c})_{R,m}\Delta\mathbf{W}_{R,m}^{n}
- \frac{\partial}{\partial\mathbf{W}_{L,m}} \Big[ |\bar{A}_{Roe}|_{m} (\mathbf{W}_{R,m}^{n} - \mathbf{W}_{L,m}^{n}) \Big] \Delta\mathbf{W}_{L,m}^{n}
- \frac{\partial}{\partial\mathbf{W}_{R,m}} \Big[ |\bar{A}_{Roe}|_{m} (\mathbf{W}_{R,m}^{n} - \mathbf{W}_{L,m}^{n}) \Big] \Delta\mathbf{W}_{R,m}^{n}
\bigg\}
\end{align}\]</div>
<p>Similar to flux-vector splitting, the expression contains convective flux Jacobians as well as derivatives of the Roe matrix <span class="math notranslate nohighlight">\(\bar{A}_{Roe}\)</span> . Since the corresponding formulas are very complex, it is a better idea to evaluate the term <span class="math notranslate nohighlight">\(\partial\mathbf{F}_{c}/\partial\mathbf{W}\)</span> numerically, as discussed above. However, we can also simplify it by assuming locally constant Roe matrices</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial\mathbf{R}_{I}}{\partial\mathbf{W}}\Delta\mathbf{W}^{n}
\approx \sum_{m=1}^{N_{F}} \frac{\Delta S_{m}}{2} \bigg\{
(\bar{A}_{c})_{L,m} \Delta\mathbf{W}_{L,m}^{n}
+ (\bar{A}_{c})_{R,m} \Delta\mathbf{W}_{R,m}^{n}
- |\bar{A}_{Roe}|_{m} \Big( \Delta\mathbf{W}_{R,m}^{n} - \Delta\mathbf{W}_{L,m}^{n} \Big)
\bigg\}
\end{align}\]</div>
<p>In contrast to the Steger-Warming flux-vector splitting scheme, the above approximate linearization degrades the performance of the implicit scheme only slightly.</p>
</div>
<div class="section" id="viscous-flows">
<h5>Viscous flows<a class="headerlink" href="#viscous-flows" title="永久链接至标题">¶</a></h5>
<p>For the Navier-Stokes equations, we have to account also for the viscous fluxes in the implicit operator. The derivative <span class="math notranslate nohighlight">\(\partial\mathbf{F}_{v}/\partial\mathbf{W}\)</span> , that is, the viscous flux Jacobian is in general not straightforward to obtain. Additional complexity arises due to the fact that the viscous flux vector contains derivatives of flow variables. For this reason, we have either to evaluate the viscous flux Jacobian by finite differences, or we have to use a simplified formulation.</p>
<p>In the case of the TSL approximation of Navier-Stokes equations, it is possible to find the viscous flux Jacobian analytically by assuming locally constant dynamic viscosity and thermal conductivity coefficients. Then the term related to the viscous fluxes becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial(\mathbf{F}_{v}\Delta S)_{m}}{\partial\mathbf{W}}\Delta\mathbf{W}^{n}
\approx \Big[
(\bar{A}_{v}^{*})_{R,m} \Delta\mathbf{W}_{R,m}^{n}
- (\bar{A}_{v}^{*})_{L,m} \Delta\mathbf{W}_{L,m}^{n}
\Big] \Delta S_{m}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{A}_{v}^{*}\)</span> stands for the viscous flux Jacobian given by Eq.(A.71) or Eq.(A.75) but without the spatial operators <span class="math notranslate nohighlight">\(\partial_{\psi}()\)</span> . The Jacobians are evaluated using either the left or the right state for all variables except for the dynamic viscosity, which is determined from an arithmatic average. It should be mentioned that the above equation leads to a second-order central difference approximation in the implicit operator, supposed the left and right state are computed with first-order accuracy.</p>
</div>
</div>
<div class="section" id="alternating-direction-implicit-scheme">
<h4>Alternating direction implicit scheme<a class="headerlink" href="#alternating-direction-implicit-scheme" title="永久链接至标题">¶</a></h4>
<p>The alternating direction implicit (ADI) scheme was one of the first iterative implicit methods. The ADI scheme can be implemented on structured grids only. It is based on an approximate splitting (or, in other words, factorization) of the implicit operator into two (in 2D) or three (in 3D) factors. Each factor contains the linearization of the convective and viscous fluxes for one particular direction in the computational space. In 3D, this leads to the formulation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bigg\{ \frac{\Omega}{\Delta t}\bar{I}
+ \frac{\partial\Big[ (\mathbf{F}_{c}^{I} - \mathbf{F}_{v}^{I})\Delta S^{I} \Big]_{i+1/2}}{\partial\mathbf{W}}
+ \frac{\partial\Big[ (\mathbf{F}_{c}^{I} - \mathbf{F}_{v}^{I})\Delta S^{I} \Big]_{i-1/2}}{\partial\mathbf{W}}
\bigg\}
\bigg\{ \frac{\Omega}{\Delta t}\bar{I}
+ \frac{\partial\Big[ (\mathbf{F}_{c}^{I} - \mathbf{F}_{v}^{I})\Delta S^{I} \Big]_{j+1/2}}{\partial\mathbf{W}}
+ \frac{\partial\Big[ (\mathbf{F}_{c}^{I} - \mathbf{F}_{v}^{I})\Delta S^{I} \Big]_{j-1/2}}{\partial\mathbf{W}}
\bigg\}
\bigg\{ \frac{\Omega}{\Delta t}\bar{I}
+ \frac{\partial\Big[ (\mathbf{F}_{c}^{I} - \mathbf{F}_{v}^{I})\Delta S^{I} \Big]_{k+1/2}}{\partial\mathbf{W}}
+ \frac{\partial\Big[ (\mathbf{F}_{c}^{I} - \mathbf{F}_{v}^{I})\Delta S^{I} \Big]_{k-1/2}}{\partial\mathbf{W}}
- \frac{\partial(\Omega \mathbf{Q})}{\partial \mathbf{W}}
\bigg\} \Delta\mathbf{W}^{n}
= -\mathbf{R}^{n}
\end{align}\]</div>
<p>For clarity, the node indexes <span class="math notranslate nohighlight">\(i,j,k\)</span> were omitted where not required. Furthermore, the superscripts <span class="math notranslate nohighlight">\(I,J,K\)</span> mark the flux vector or of the face area associated with certain coordinate in the computaional space. By replacing the node indexes by cell indexes, the scheme can be applied to a cell-centered discretization.</p>
<p>The derivatives of the convective and viscous fluxes can be evaluated as discussed in the previous subsection. The ADI method is traditionally coupled to the central scheme with artificial dissipation. In such a case, formulation similar to that in Eq.(6.34) holds for each factor (of course, the linearization of the source term is included in one factor only). In order to obtain a robust and efficient scheme, it is necessary to include a linearization of the artificial dissipation terms in the implicit operator. The linearization is in general simplified by treating the spectral radii and the dissipation coefficients as independent of <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> . Hence, according to Eq.(4.48) the factor, for example, in the I-direction becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bigg\{ \frac{\Omega}{\Delta t}\bar{I}
+ \frac{\partial[ (\mathbf{F}_{c}^{I} - \mathbf{F}_{v}^{I})\Delta S^{I} ]_{i+1/2}}{\partial\mathbf{W}}
+ \frac{\partial[ (\mathbf{F}_{c}^{I} - \mathbf{F}_{v}^{I})\Delta S^{I} ]_{i-1/2}}{\partial\mathbf{W}}
- \frac{\partial(\mathbf{D}_{IM}^{I}\Delta S^{I})_{i+1/2}}{\partial\mathbf{W}}
- \frac{\partial(\mathbf{D}_{IM}^{I}\Delta S^{I})_{i-1/2}}{\partial\mathbf{W}}
\bigg\}
\end{align}\]</div>
<p>with the implicit artificial dissipation term JST scheme</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial(\mathbf{D}_{IM}^{I})_{i+1/2}}{\partial\mathbf{W}}\Delta\mathbf{W}^{n}
\approx \hat{\Lambda}_{i+1/2}^{S} \Big[
(\epsilon_{IM}^{(2)})_{i+1/2} (\Delta\mathbf{W}_{i+1}^{n} - \Delta\mathbf{W}_{i}^{n})
- (\epsilon_{IM}^{(4)})_{i+1/2} (\Delta\mathbf{W}_{i+2}^{n} - 3\Delta\mathbf{W}_{i+1}^{n} + 3\Delta\mathbf{W}_{i}^{n} - \Delta\mathbf{W}_{i-1}^{n})
\Big]
\end{align}\]</div>
<p>The implicit dissipation terms in other directions are defined in a similar way. It is also possible to retain only the second-order differences in the implicit operator. This reduces the matrix for each factors from block-pentadiagonal to block-tridiagonal form. However, this restricts the stability of the scheme.</p>
<p>The inversion of the implicit operator proceeds in three steps (two steps in 2D), that is,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; (\mathbf{D}^{I} + \mathbf{L}^{I} + \mathbf{U}^{I})\Delta\mathbf{W}^{(1)} = -\mathbf{R}^{n} \\
&amp; (\mathbf{D}^{I} + \mathbf{L}^{J} + \mathbf{U}^{J})\Delta\mathbf{W}^{(2)} = \Delta\mathbf{W}^{(1)} \\
&amp; (\mathbf{D}^{K} + \mathbf{L}^{K} + \mathbf{U}^{K})\Delta\mathbf{W}^{n} = \Delta\mathbf{W}^{(2)}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> represents the diagonal, <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> the lower-diagonal, and <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> the upper-diagonal terms, respectively. Each step requires the inversion of a block-tridiagonal or a block-penta-diagonal matrix (if <span class="math notranslate nohighlight">\(\epsilon_{IM}^{(4)} &gt; 0\)</span> ). This is done by a direct solution method. In order to reduce the numerical effort, Pulliam and Chaussee suggested a diagonalized form of the ADI scheme. Herewith, the block matrices (composed of convective and viscous flux Jacobians) are transformed into diagonal matrices. Hence, only non-block tri- or pentadiagonal matrices have to be inverted, which results in significant savings of computational work and memory. Although the diagonalization is valid strictly for the Euler equations only, it can be employed for viscous flows as well. The linearization of the viscous fluxes is then either dropped from the implicit operator, or it is approximated by the viscous eigenvalue.</p>
<p>The splitting of the implicit operator introduces what is called the factorization error. It is the difference between the implicit operator of the base scheme and the factorized operator. In the case of the ADI scheme, this error term is scaled by the factor <span class="math notranslate nohighlight">\((\Delta t)^{N}\)</span> , where <span class="math notranslate nohighlight">\(N\)</span> denotes the number of space dimensions. This term causes the ADI scheme to loose its unconditional stability in 3D. However, the stability is improved if the fourth-order differences of the artificial viscosity are included in the implicit operator. In fact, the ADI scheme was successfully used for the solution of various 3D problems. An interesting implementation of the ADI scheme on multiblock grids, which treats the block boundaries implicitly, was presented by Rosenfeld and Yassour.</p>
<p>The time step <span class="math notranslate nohighlight">\(\Delta t\)</span> can be computed in the same way as presented before. The optimal CFL number varies betwenn 20 and 50, depending on the physics of the particular flow case.</p>
</div>
<div class="section" id="lower-upper-symmetric-gauss-seidel-scheme">
<h4>Lower-Upper symmetric Gauss-Seidel Scheme<a class="headerlink" href="#lower-upper-symmetric-gauss-seidel-scheme" title="永久链接至标题">¶</a></h4>
<p>The implicit lower-upper symmetric Gauss-Seidel (LU-SGS) scheme, which is also called the lower-upper symmetric overrelaxation (LU-SSOR) scheme, became widely used because of its low numerical complexity and modest memory requirements, which are both comparable to an explicit multistage scheme. Furthermore, the LU-SGS scheme can be implemented easily on vector and parallel computers. It can also be used on structured as well as on unstructured grids.</p>
<p>The LU-SGS scheme has its origins in the work of Jameson and Turkel, who considered decompositions of the implicit operator into lower and upper diagonally dominant factors. The LU-SGS method itself was introduced by Yoon and Jameson as a relaxation method for solving the unfactored implicit scheme. It was further developed and applied to 3D viscous flow fields by Rieger and Jameson. Since then, various researchers applied the LU-SGS scheme to viscous flows on structured and on unstructured grids. The LU-SGS approach is often used for the simulation of chemically reacting flows.</p>
<p>The LU-SGS scheme employs a simplification of the first-order accurate flux-vector splitting approach due to Steger and Warming for the linearization of the convective fluxes. The linearization is always kept the same regardless of the discretization of the explicit operator. The LU-SGS scheme is further based on the factorization of the implicit operator into the following three parts</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\mathbf{D} + \mathbf{L})\mathbf{D}^{-1}(\mathbf{D} + \mathbf{U})\Delta\mathbf{W}^{n} = -\mathbf{R}_{I}^{n}
\end{align}\]</div>
<p>The factors are constructed such that <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> consists only of terms in the strictly lower triangular matrix, <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> of terms in the strictly upper triangular matrix, and <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> of diagonal terms. It is important to remark that the number of factors remains always the same independent of the number of space dimensions.</p>
<p>The system matrix of the LU-SGS scheme can be inverted in two steps–a forward and a backward sweep, that is,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; (\mathbf{D} + \mathbf{L})\Delta\mathbf{W}^{(1)} = -\mathbf{R}_{I}^{n} \\
&amp; (\mathbf{D} + \mathbf{U})\Delta\mathbf{W}^{n} = \mathbf{D}\Delta\mathbf{W}^{(1)}_{I}
\end{align}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf{W}^{n+1} = \mathbf{W}^{n} + \Delta\mathbf{W}^{n}\)</span> . The operators <span class="math notranslate nohighlight">\(\mathbf{L},\mathbf{D}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> and also the inversion procedure differ between structured and unstructured grids in some aspects. Therefore, we shall discuss below each case separately.</p>
<div class="section" id="lu-sgs-on-unstructured-grids">
<h5>LU-SGS on unstructured grids<a class="headerlink" href="#lu-sgs-on-unstructured-grids" title="永久链接至标题">¶</a></h5>
<p>Here, for a median-dual scheme the operators read</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{L} = \sum_{j \in L(i)}\Big[ \bar{A}_{j}^{+} + (\bar{A}_{v})_{j} \Big]\Delta S_{ij} \\
&amp; \mathbf{U} = \sum_{j \in U(i)} \Big[ \bar{A}_{j}^{-} - (\bar{A}_{v})_{j} \Big]\Delta S_{ij} \\
&amp; \mathbf{D} = \frac{\Omega_{i}}{\Delta t_{i}}\bar{I}
+ \frac{\omega}{2}(\hat{\Lambda}_{c})_{i}
+ \sum_{j=1}^{N_{F}}(\bar{A}_{v})_{i}\Delta S_{ij}
- \frac{\partial (\Omega_{i}\mathbf{Q}_{i})}{\partial \mathbf{W}}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\((\hat{\Lambda}_{v})_{i}\)</span> is evaluated according to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; (\hat{\Lambda}_{c})_{i} = \sum_{j=1}^{N_{F}}(|\mathbf{U}_{ij} \cdot \mathbf{n}_{ij}| + c_{ij})\Delta S_{ij} \\
&amp; (\hat{\Lambda}_{v})_{i} = \frac{1}{\Omega_{i}}\sum_{j=1}^{N_{F}}\bigg[ \max\Big( \frac{4}{3\rho_{ij}}, \frac{\gamma_{ij}}{\rho_{ij}} \Big) \Big( \frac{\mu_{L}}{Pr_{L}} + \frac{\mu_{T}}{Pr_{T}} \Big)_{ij}(\Delta S_{ij})^{2} \bigg]
\end{align}\end{split}\]</div>
<p>Formulas similar to operator equations can be obtained in the case of the cell-centered scheme. The major difference is that the summation in the <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> and the <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> operator is conducted onver faces of the cell instead of incident edges.</p>
<p>The sets <span class="math notranslate nohighlight">\(L(i)\)</span> and <span class="math notranslate nohighlight">\(U(i)\)</span> should fulfill the same function as the diagonal planes on structured grids. For this reason, it is necessary to arrange the nodes (cells) into layers such that:</p>
<ul class="simple">
<li>nodes <span class="math notranslate nohighlight">\(i\)</span> (cells <span class="math notranslate nohighlight">\(I\)</span> ) of a current layer have connections to layers with previously updated flow variables–otherwise the LU-SGS scheme degenerates to a Jacobi iteration,</li>
<li>nodes (cells) in a layer are not connected to each other–otherwise the scheme could not be vectorized.</li>
</ul>
<p>An appropriate definition of the sets <span class="math notranslate nohighlight">\(L(i)\)</span> and <span class="math notranslate nohighlight">\(U(i)\)</span> allows for the following two-step inversion procedure</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \mathbf{D}\Delta\mathbf{W}_{i}^{(1)} = -\mathbf{R}_{i}^{n}
- \sum_{j \in L(i)}\frac{1}{2}\Big[ (\Delta F_{c}^{(1)})_{j} \Delta S_{ij} + (r_{A}^{*})_{j}\bar{I}\Delta\mathbf{W}_{j}^{(1)} \Big] \\
&amp; \mathbf{D}\Delta\mathbf{W}_{i}^{n} = \mathbf{D}\Delta\mathbf{W}_{i}^{(1)}
- \sum_{j\in U(i)} \frac{1}{2}\Big[ (\Delta F_{c}^{n})_{j} \Delta S_{ij} - (r_{A}^{*})_{j}\bar{I}\Delta\mathbf{W}_{j}^{n} \Big]
\end{align}\end{split}\]</div>
<p>where the viscous Jacobians were approximated by their spectral radii and where the positive/negative Jacobians were linearized according to</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(\bar{A}^{\pm} \Delta S)\Delta\mathbf{W}^{n}
\approx \frac{1}{2} (\Delta\mathbf{F}_{c}\Delta S \pm r_{A}\bar{I}\Delta\mathbf{W}^{n})
\end{align}\]</div>
<p>with the update of the convective fluxes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta\mathbf{F}_{c} = \mathbf{F}_{c}^{n+1} - \mathbf{F}_{c}^{n}
\end{align}\]</div>
<p>Futhermore, the factor <span class="math notranslate nohighlight">\((r_{A}^{*})_{j}\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
(r_{A}^{*})_{j} = \omega (|\mathbf{U}_{j} \cdot \mathbf{n}_{ij}| + c_{j})\Delta S_{ij}
+ \frac{\Delta S_{ij}}{\| \mathbf{r}_{j} - \mathbf{r}_{i} \|_{2}} \bigg[ \max\Big( \frac{4}{3\rho_{j}}, \frac{\gamma_{j}}{\rho_{j}} \Big) \Big( \frac{u_{L}}{Pr_{L}} + \frac{u_{T}}{Pr_{T}} \Big)_{j} \bigg]
\end{align}\]</div>
<p>with <span class="math notranslate nohighlight">\(\| \mathbf{r}_{j} - \mathbf{r}_{i} \|_{2}\)</span> being the length of the edge <span class="math notranslate nohighlight">\(ij\)</span> .</p>
<p>The time step can be computed in the same way as for the explicit scheme. However, the viscous eigenvalue should be omitted, since the viscous terms are already contained in the implicit operator and hence do not reduce the time step as in the case of an explicit scheme. The CFL number can be chosen in the range from <span class="math notranslate nohighlight">\(10^{4}\)</span> to <span class="math notranslate nohighlight">\(10^{6}\)</span> for steady flows. The convergence speed and the robustness of the LU-SGS scheme can then be tuned using the overrelaxation parameter <span class="math notranslate nohighlight">\(\omega\)</span> .</p>
</div>
</div>
<div class="section" id="newton-krylov-method">
<h4>Newton-Krylov method<a class="headerlink" href="#newton-krylov-method" title="永久链接至标题">¶</a></h4>
<p>First of all, let us rewrite the implicit scheme as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{J}\Delta\mathbf{W}^{n} = -\mathbf{R}^{n}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{J}\)</span> represents the implicit operator (system matrix). As we saw already, <span class="math notranslate nohighlight">\(\bar{J}\)</span> constitutes a large, sparse, and generally non-symmetric matrix. In the previous sections, we discussed two methods that decompose <span class="math notranslate nohighlight">\(\bar{J}\)</span> into several factors which can each inverted more easily than <span class="math notranslate nohighlight">\(\bar{J}\)</span> itself. However, due to the factorization error (and approximate linearization of <span class="math notranslate nohighlight">\(\mathbf{R}^{n+1}\)</span> ), only a linear convergence to steady state can be achieved. In order to obtain the quadratic convergence of Newton’s method for the solution of non-linear equations, four conditions must be fulfilled:</p>
<ul class="simple">
<li>the linearization of the residual must be exact,</li>
<li><span class="math notranslate nohighlight">\(\bar{J}\)</span> must be accurately inverted,</li>
<li>the time step has to be <span class="math notranslate nohighlight">\(\Delta t \to \infty\)</span> ,</li>
<li>initial solution must be, in some sense, close to the final solution.</li>
</ul>
<p>Obviously, the main obstacles that have to be overcome are the linearization and the inversion of the full system matrix.</p>
<p>A particularly suitable class of iterative techniques for the solution of large linear equation systems are the so-called Krylov-subspace methods. Several were proposed for the inversion of matrices which arise in CFD. Examples are the conjugate gradient squared (CGS) method, the bi-conjugate gradient stabilized (Bi-CGSTAB) scheme, or the transpose-free quasi-minimum residual (TFQMR) approach. However, the most successful Krylov subspace method became the generalized minimal residual (GMRES) technique, which was originally suggested by Saad and Schulz. Since then, the GMRES method was improved and augmented by several researchers. Because of its popularity, we shall focus on the GMRES approach in the following. Nevertheless, most of what we shall discuss also applies to the other Krylov subspace methods.</p>
</div>
</div>
</div>
<div class="section" id="unified-gas-kinetic-scheme-ugks">
<h2>Unified Gas-Kinetic Scheme (UGKS)<a class="headerlink" href="#unified-gas-kinetic-scheme-ugks" title="永久链接至标题">¶</a></h2>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0021999110003475#:~:text=The%20unified%20scheme%20is%20an%20extension%20of%20the,of%20local%20solution%20of%20the%20gas%20distribution%20function.">A unified gas-kinetic scheme for continuum and rarefied flows</a></p>
<div class="section" id="kinetic-theory-and-discrete-ordinate-method">
<h3>Kinetic theory and discrete ordinate method<a class="headerlink" href="#kinetic-theory-and-discrete-ordinate-method" title="永久链接至标题">¶</a></h3>
<p>In this paper, we will present a unified scheme for all Knudsen flows. The one-dimensional kinetic equation will be used to illustrate the idea. In this section, we are going to first intrduce the kinetic equation and the traditional discrete ordinate method (DOM).</p>
<p>The one-dimensional gas-kinetic BGK equation can be written as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial f}{\partial t} + u\frac{\partial f}{\partial x} = \frac{g - f}{\tau}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> is the gas distribution function and <span class="math notranslate nohighlight">\(g\)</span> is the equilibrium state approached by <span class="math notranslate nohighlight">\(f\)</span> . Both <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> are functions of space <span class="math notranslate nohighlight">\(x\)</span> , time <span class="math notranslate nohighlight">\(t\)</span> , particle velocities <span class="math notranslate nohighlight">\(u\)</span> , and internal variable <span class="math notranslate nohighlight">\(\xi\)</span> . The particle collision time <span class="math notranslate nohighlight">\(\tau\)</span> is related to the viscosity and heat conduction coefficients, i.e., <span class="math notranslate nohighlight">\(\tau = \mu/p\)</span> where <span class="math notranslate nohighlight">\(\mu\)</span> is the dynamic viscosity coefficient and <span class="math notranslate nohighlight">\(p\)</span> is the pressure. The equilibrium state is a Maxwellian distribution</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g = \rho \Big( \frac{\lambda}{\pi} \Big)^{\frac{K+1}{2}} e^{-\lambda((u - U)^{2} + \xi^{2})}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is the density, <span class="math notranslate nohighlight">\(U\)</span> is the macroscopic velocity in the <span class="math notranslate nohighlight">\(x\)</span> direction, <span class="math notranslate nohighlight">\(\lambda\)</span> is equal to <span class="math notranslate nohighlight">\(m/2kT\)</span> , <span class="math notranslate nohighlight">\(m\)</span> is the molecular mass, <span class="math notranslate nohighlight">\(k\)</span> is the Boltzmann constant, and <span class="math notranslate nohighlight">\(T\)</span> is the temperature. For 1D flow, the total number of degrees of freedom <span class="math notranslate nohighlight">\(K\)</span> in <span class="math notranslate nohighlight">\(\xi\)</span> is equal to <span class="math notranslate nohighlight">\(\frac{3 - \gamma}{\gamma - 1}\)</span> . For example, for a monatomic gas with <span class="math notranslate nohighlight">\(\gamma = 5/3\)</span> , <span class="math notranslate nohighlight">\(K\)</span> is equal to <span class="math notranslate nohighlight">\(2\)</span> to account for the particle motion in the <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> directions. In the equilibrium state, the internal variable <span class="math notranslate nohighlight">\(\xi^{2}\)</span> is equal to <span class="math notranslate nohighlight">\(\xi^{2} = \xi_{1}^{2} + \xi_{2}^{2} + \cdots + \xi_{K}^{2}\)</span> . The relation between mass <span class="math notranslate nohighlight">\(\rho\)</span> , momentum <span class="math notranslate nohighlight">\(\rho U\)</span> , and energy densities <span class="math notranslate nohighlight">\(E\)</span> with the distribution function <span class="math notranslate nohighlight">\(f\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\begin{pmatrix} \rho \\ \rho U \\ E \end{pmatrix}
= \int \psi_{\alpha}f~\mathrm{d}\Xi
,\quad \alpha = 1,2,3
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\psi_{\alpha}\)</span> is the component of the vector of moments</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\boldsymbol{\psi} = (\psi_{1}, \psi_{2}, \psi_{3})^{T}
= \Big( 1, u, \frac{1}{2}(u^{2} + \xi^{2}) \Big)^{T}
\end{align}\]</div>
<p>and <span class="math notranslate nohighlight">\(\mathrm{d}\Xi = \mathrm{d}u\mathrm{d}\xi_{1}\mathrm{d}\xi_{2}\cdots\mathrm{d}\xi_{K}\)</span> is the volume element in the phase space with <span class="math notranslate nohighlight">\(\mathrm{d}\xi = \mathrm{d}\xi_{1}\mathrm{d}\xi_{2}\cdots\mathrm{d}\xi_{K}\)</span> . Based on the distribution function <span class="math notranslate nohighlight">\(f\)</span> , all other macroscopic flow variables, such as the stress <span class="math notranslate nohighlight">\(p_{ij}\)</span> and heat fluxes <span class="math notranslate nohighlight">\(q_{i}\)</span> , can be defined as well,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; p_{ij} = \int (u_{i} - U_{i})(u_{j} - U_{j})f~\mathrm{d}\Xi \\
&amp; q_{i} = \int \frac{1}{2}(u_{i} - U_{i})((u_{j} - U_{j})^{2} + \xi^{2})~\mathrm{d}\Xi
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(U_{i}\)</span> is the averaged fluid velocity</p>
<div class="math notranslate nohighlight">
\[\begin{align}
U_{i} = \frac{\int u_{i}f~\mathrm{d}\Xi}{\int f~\mathrm{d}\Xi}
\end{align}\]</div>
<p>Since mass, momentum, and energy are conserved during particle collisions, <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> satisfy the conservation constraint,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int (g - f)\psi_{\alpha}~\mathrm{d}\Xi = 0
,\quad
\alpha = 1,2,3
\end{align}\]</div>
<p>at any point in space and time.</p>
<p>Before we introduce discrete ordinate method, let’s first discretize the physical space, time and particle velocity space. The physical space is divided into numerical cells with cell size <span class="math notranslate nohighlight">\(\Delta x\)</span> , and the j-th cell is given by <span class="math notranslate nohighlight">\(x \in [x_{j-1/2}, x_{j+1/2}]\)</span> with cell size <span class="math notranslate nohighlight">\(\Delta x = x_{j+1/2} - x_{j-1/2}\)</span> . The temporal discretization is denoted by <span class="math notranslate nohighlight">\(t^{n}\)</span> for the n-th time step. The particle velocity space is discretized by <span class="math notranslate nohighlight">\(2N+1\)</span> subcells with cell size <span class="math notranslate nohighlight">\(\Delta u\)</span> , and the center of k-th velocity interval is <span class="math notranslate nohighlight">\(u_{k} = k\Delta u\)</span> , and it represents the average velocity <span class="math notranslate nohighlight">\(u\)</span> in that interval,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
u \in \Big[ (k-\frac{1}{2})\Delta u, (k+\frac{1}{2})\Delta u \Big]
,\quad
k = -N, -(N-1), \cdots, -1, 0, 1, \cdots, (N-1), N
\end{align}\]</div>
<p>Then, the averaged gas distribution function in cell <span class="math notranslate nohighlight">\(j\)</span> , at time step <span class="math notranslate nohighlight">\(t^{n}\)</span> , and around particle velocity <span class="math notranslate nohighlight">\(u_{k}\)</span> , is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f(x_{j}, t^{n}, u_{k}) = f_{j,k}^{n}
= \frac{1}{\Delta x \Delta u} \int_{x_{j-1/2}}^{x_{j+1/2}}\int_{u_{k}-\frac{1}{2}\Delta u}^{u_{k}+\frac{1}{2}\Delta u} f(x,t^{n},u)~\mathrm{d}x\mathrm{d}u
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta x\)</span> is the cell size and <span class="math notranslate nohighlight">\(\Delta u\)</span> is the particle velocity interval defined later.</p>
<p>The BGK equation can be rewritten as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial f}{\partial t} = -u\frac{\partial f}{\partial x} + \frac{g - f}{\tau}
\end{align}\]</div>
<p>Integrating the above equation in a control volume <span class="math notranslate nohighlight">\(\int_{x_{j-1/2}}^{x_{j+1/2}}\int_{t^{n}}^{t^{n+1}}(\cdots)\mathrm{d}x\mathrm{d}t/\Delta x\)</span> , and keeping the particle velocity space continuous, the above differential equation becomes an integral equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{j}^{n+1} = f_{j}^{n}
+ \frac{1}{\Delta x}\int_{t^{n}}^{t^{n+1}}\Big( u\hat{f}_{j-1/2}(t) - u\hat{f}_{j+1/2}(t) \Big)~\mathrm{d}t
+ \frac{1}{\Delta x}\int_{t^{n}}^{t^{n+1}}\int_{x_{j-1/2}}^{x_{j+1/2}}\frac{g - f}{\tau}~\mathrm{d}x\mathrm{d}t
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{f}_{j+1/2}\)</span> is the gas distribution function at the cell interface <span class="math notranslate nohighlight">\(x_{j+1/2}\)</span> . The above equation is exact and there is no any numerical error introduced yet. For a kinetic scheme, two terms on the right hand side of the above equation have to be numerically evaluated.</p>
<p>With discretized particle space, at each particle velocity <span class="math notranslate nohighlight">\(u_{k}\)</span> , a standard operator splitting method is to solve the above equation in the following steps. The above equation is decoupled to</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{j,k}^{*} = f_{j,k}^{n} + \frac{1}{\Delta x}\int \Big( u_{k}\hat{f}_{j-1/2,k}(t) - u_{k}\hat{f}_{j+1/2, k}(t) \Big)~\mathrm{d}t
\end{align}\]</div>
<p>for the transport across a cell interface, and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d}f_{j,k}}{\mathrm{d}t} = \frac{g - f_{j,k}^{*}}{\tau}
\end{align}\]</div>
<p>for the particle collision or source term inside each cell. In the transport part, the collisionless Boltzmann equation or upwinding approach, is used,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\partial f}{\partial t} + u\frac{\partial f}{\partial x} = 0
\end{align}\]</div>
<p>for the flux evaluation at the cell interface. For example, for a first-order method, the upwinding flux is based on the following solution at the cell interface,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{f}_{j+1/2, k} = \left\{ \begin{array}{l}
f_{j,k} ,\quad u_{k} \ge 0 \\
f_{j+1,k} ,\quad u_{k}&lt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>which is dynamically equivalent to the flux vector splitting scheme. The above transport and collision steps can be also coupled using Runge-Kutta method within a time step.</p>
<p>If we take conservative moments <span class="math notranslate nohighlight">\(\psi_{\alpha}\)</span> on the integral form equation, due to the conservation of conservative variables during particle collision process, the update of conservative variables become</p>
<div class="math notranslate nohighlight">
\[\begin{align}
W_{j}^{n+1} = W_{j}^{n} + \frac{1}{\Delta x} \int_{t^{n}}^{t^{n+1}}\big( F_{j-1/2}(t) - F_{j+1/2}(t) \big)~\mathrm{d}t
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(W\)</span> is the averaged conservative mass, momentum and energy densities inside each cell, and <span class="math notranslate nohighlight">\(F = \int u \psi_{\alpha}\hat{f}~\mathrm{d}\Xi\)</span> is the flux based on the collisionless Boltzmann equation. The above scheme for the update of macroscopic flow variables is physically identical to the kinetic flux vector splitting schemes (KFVS). The only difference is the approximation of initial gas distribution function used at the beginning of each time step in order to evaluate the interface flux <span class="math notranslate nohighlight">\(\hat{f}\)</span> . For the KFVS scheme, an equilibrium state with continuous particle velocity space is used to construct initial condtion <span class="math notranslate nohighlight">\(f\)</span> for <span class="math notranslate nohighlight">\(f_{t} + u f_{x} = 0\)</span> , and for the DOM the initial <span class="math notranslate nohighlight">\(f\)</span> is explicitly given from the update of the discretized particle distribution function. But, the different initial condition will not change the numerical dissipative mechanism in the KFVS method, where the numerical dissipation is proportional to the time step. Therefore, if a large time step could be used for the DOM method in the continuum flow regime, the numerical dissipation would make DOM scheme be inaccurate for the NS solutions. It is a well-known defect for all flux vector splitting methods. So, in the continuum flow regime, for the DOM method the requirement of time step being less than the particle collision time helps the scheme not only for the stability, but also for the accuracy. Unfortunately, this constraint deviates the above scheme away from an AP method for the NS solutions in the continuum flow regime.</p>
<p>In order to design an AP scheme which is able to capture NS solutions in the continuum flow regime and also get an accurate free molecule solution in another limit, the full BGK equation has to be solved in the flux evaluation across a cell interface. The kinetic equation models the transport <span class="math notranslate nohighlight">\(uf_{x}(x,t)\)</span> and collision <span class="math notranslate nohighlight">\((g-f)/\tau\)</span> as a continuous function of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(t\)</span> . For these molecules passing through a cell interface, they do suffer from particle collisions during their passage moving towards to the cell interface. The collision frequency of these molecules distinguishes the continuum and rarefied flow regimes dynamically, subsequently presents the corresponding distribution functions.</p>
</div>
<div class="section" id="unified-kinetic-scheme-for-all-flow-regimes">
<h3>Unified kinetic scheme for all flow regimes<a class="headerlink" href="#unified-kinetic-scheme-for-all-flow-regimes" title="永久链接至标题">¶</a></h3>
<p>In this section, we will present a unified kinetic scheme based on the BGK model for all flow regimes. The current method is a natural extension of the gas-kinetic BGK-NS method for the compressible Navier-Stokes solutions to all Knudsen number flows. In this section, only one-dimensional formulation will be presented. The extension to 2D and 3D cases is straightforward for the kinetic method.</p>
<p>With the discretization of space <span class="math notranslate nohighlight">\(x_{j}\)</span> , time <span class="math notranslate nohighlight">\(t^{n}\)</span> , and particle velocity <span class="math notranslate nohighlight">\(u_{k}\)</span> , the finite volume scheme based on the integral solution of the integral form equation is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{j,k}^{n+1} = f_{j,k}^{n}
+ \frac{1}{\Delta x}\int \Big( u_{k}\hat{f}_{j-1/2,k} - u_{k}\hat{f}_{j+1/2,k} \Big)~\mathrm{d}t
+ \frac{1}{\Delta x}\iint \frac{g - f}{\tau}\mathrm{d}x\mathrm{d}t
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(f_{j,k}^{n}\)</span> is the averaged distribution function in the j-th cell <span class="math notranslate nohighlight">\(x \in [x_{j-1/2}, x_{j+1/2}]\)</span> at the particle velocity <span class="math notranslate nohighlight">\(u_{k}\)</span> . Instead of using upwinding scheme for the evaluation of the distribution function at a cell interface, the solution <span class="math notranslate nohighlight">\(\hat{f}_{j+1/2,k}\)</span> in the above equation is constructed from an integral solution of the BGK model using the method of characteristics</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{f}_{j+1/2,k} = f(x_{j+1/2}, t, u_{k}, \xi)
= \frac{1}{\tau}\int_{t^{n}}^{t} g(x', t', u_{k}, \xi)e^{-(t-t')/\tau}\mathrm{d}t'
+ e^{-(t-t^{n})/\tau}f_{0,k}^{n}(x_{j+1/2} - u_{k}(t - t^{n}), t^{n}, u_{k}, \xi)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(x' = x_{j+1/2} - u_{k}(t - t')\)</span> is the particle trajectory and <span class="math notranslate nohighlight">\(f_{0,k}^{n}\)</span> is the intial gas distribution function of <span class="math notranslate nohighlight">\(f\)</span> at time <span class="math notranslate nohighlight">\(t=t^{n}\)</span> around the cell interface <span class="math notranslate nohighlight">\(x_{j+1/2}\)</span> at the particle velocity <span class="math notranslate nohighlight">\(u_{k}\)</span> , i.e., <span class="math notranslate nohighlight">\(f_{0,k}^{n} = f_{0}^{n}(x, t^{n},u_{k},\xi)\)</span> . In the above equation, <span class="math notranslate nohighlight">\(f_{0,k}^{n}\)</span> , is known at the beginning of each time step <span class="math notranslate nohighlight">\(t^{n}\)</span> , and a high-order reconstruction can be used to reconstruct its subcell resolution using TVD and ENO methods. The use of the following discontinuous reconstruction is to introduce artificial dissipation for the unified scheme once the scheme becomes a shock capturing method when the dissipative flow structure cannot be well resolved by the cell size. If the solutions are well resolved, the discontinuous reconstruction will become a continuous one automatically. In order to simplify the notation, in the following the cell <span class="math notranslate nohighlight">\(x_{j+1/2}=0\)</span> and <span class="math notranslate nohighlight">\(t^{n} = 0\)</span> are used. For example, around each cell interface <span class="math notranslate nohighlight">\(x_{j+1/2}\)</span> , at time step <span class="math notranslate nohighlight">\(t^{n}\)</span> the initial distribution function becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
f_{0}(x,t^{n},u_{k},\xi) = f_{0,k}(x,0) = \left\{ \begin{array}{l}
f_{j+1/2,k}^{l}[1 + \sigma_{j,k}x] ,\quad x\le 0 \\
f_{j+1/2,k}[1 + \sigma_{j+1,k}x] ,\quad x&gt;0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>where nonlinear limiter is used to reconstruct <span class="math notranslate nohighlight">\(f_{j+1/2,k}^{l}, f_{j+1/2,k}^{r}\)</span> and the corresponding slopes <span class="math notranslate nohighlight">\(\sigma_{j,k}\)</span> . For example, in this paper we will use van Leer limiter in the reconstruction. The cell interface distribution functions become</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; f_{j+1/2,k}^{l} = f_{j,k} + (x_{j+1/2} - x_{j})\sigma_{j,k} \\
&amp; f_{j+1/2,k}^{r} = f_{j+1,k} - (x_{j+1} - x_{j+1/2})\sigma_{j+1,k}
\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\sigma_{j,k} = \Big( \operatorname{sign}(s_{1}) + \operatorname{sign}(s_{2}) \Big) \frac{|s_{1}||s_{2}|}{|s_{1}| + |s_{2}|}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(s_{1} = \frac{f_{j,k} - f_{j-1,k}}{x_{j} - x_{j-1}}\)</span> and <span class="math notranslate nohighlight">\(s_{2} = \frac{f_{j+1,k} - f_{j,k}}{x_{j+1} - x_{j}}\)</span> .</p>
<p>There is one-to-one correspondence between an equilibrium state and macroscopic flow variables. For the integral solution of the equilibrium state in <span class="math notranslate nohighlight">\(\hat{f}_{j+1/2,k}\)</span> , we can first use a continuous particle velocity space to evaluate the integral. For an equilibrium state <span class="math notranslate nohighlight">\(g\)</span> around a cell interface <span class="math notranslate nohighlight">\((x_{j+1/2}=0, t=0)\)</span> , same as the BGK-NS scheme, it can be expanded with two slopes,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g = g_{0} \Big[ 1 + (1 - H[x])\overline{a}^{l}x + H[x] \overline{a}^{r}x + \overline{A}t \Big]
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(H[x]\)</span> is the Heaviside function defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
H[x] = \left\{ \begin{array}{l}
0 ,\quad x&lt;0 \\
1 ,\quad x\ge 0
\end{array} \right.
\end{align}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(g_{0}\)</span> is a local Maxwellian distribution function located at <span class="math notranslate nohighlight">\(x = 0\)</span> . Even though, <span class="math notranslate nohighlight">\(g\)</span> is continuous at <span class="math notranslate nohighlight">\(x = 0\)</span> , it has different slopes at <span class="math notranslate nohighlight">\(x&lt;0\)</span> and <span class="math notranslate nohighlight">\(x\ge 0\)</span> . In the equilibrium state in space and time, it is not necessary to use a discretized particle velocity space. Based on the macroscopic flow distributions, we can construct the integral solution with a continuous particle velocity space first, then take its corresponding value at the specific particle velocity when necessary. The expansion of the above equilibrium distribution is coming from a Taylor expansion of a Maxwellian in space and time. In order to have AP scheme for the Navier-Stokes equations, to keep to keep the first-order expansion of an equilibrium state in space and time is necessary. Certainly, if you would like to increase the order of accuracy or solve Burnett equations as the asymptotic limit in the continuum regime, a high-order expansion needs to be used.</p>
<p>The dependence of <span class="math notranslate nohighlight">\(\overline{a}^{l}, \overline{a}^{r}\)</span> and <span class="math notranslate nohighlight">\(\overline{A}\)</span> on the particle velocity can be obtained from a Taylor expansion of a Maxwellian and have the following form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \overline{a}^{l} = \overline{a}_{1}^{l} + \overline{a}_{2}^{l}u + \overline{a}_{3}^{l}\frac{1}{2}(u^{2} + \xi^{2}) = \overline{a}_{\alpha}^{l}\psi_{\alpha} \\
&amp; \overline{a}^{r} = \overline{a}_{1}^{r} + \overline{a}_{2}^{r}u + \overline{a}_{3}^{r}\frac{1}{2}(u^{2} + \xi^{2}) = \overline{a}_{\alpha}^{r}\psi_{\alpha} \\
&amp; \overline{A} = \overline{A}_{1} + \overline{A}_{2}u + \overline{A}_{3}\frac{1}{2}(u^{2} + \xi^{2}) = \overline{A}_{\alpha}\psi_{\alpha}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha = 1,2,3\)</span> and all coefficient <span class="math notranslate nohighlight">\(\overline{a}_{1}^{l}, \overline{a}_{2}^{l}, \cdots, \overline{A}_{3}\)</span> are local constants.</p>
<p>The determination of <span class="math notranslate nohighlight">\(g_{0}\)</span> depends on the determination of the local macroscopic values of <span class="math notranslate nohighlight">\(\rho_{0}, U_{0}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{0}\)</span> in <span class="math notranslate nohighlight">\(g_{0}\)</span> , i.e.</p>
<div class="math notranslate nohighlight">
\[\begin{align}
g_{0} = \rho_{0}\Big(\frac{\lambda_{0}}{\pi}\Big)^{\frac{K+1}{2}}e^{-\lambda((u-U_{0})^{2} - \xi^{2})}
\end{align}\]</div>
<p>which is determined uniquely using the compatibility condition of the BGK model. Taking the limit <span class="math notranslate nohighlight">\(t \to 0\)</span> in the <span class="math notranslate nohighlight">\(\hat{f}_{j+1/2,k}\)</span> expression and substituting its solution into <span class="math notranslate nohighlight">\(\int (g-f)\psi_{\alpha}\mathrm{d}\Xi\)</span> , the conservation constraint at <span class="math notranslate nohighlight">\((x = x_{j+1/2}, t=0)\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
W_{0} = \int g_{0}\psi\mathrm{d}\Xi
= \sum_{k=-N}^{k=N}\Big( f_{j+1/2,k}^{l} H[u_{k}] + f_{j+1/2,k}^{r}(1 - H[u_{k}]) \Big)\boldsymbol{\psi}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(W_{0} = (\rho_{0}, \rho_{0}U_{0}, E_{0})^{T}\)</span> is the conservative macroscopic flow variables located at the cell interface at time <span class="math notranslate nohighlight">\(t=0\)</span> . Since <span class="math notranslate nohighlight">\(f_{j+1/2,k}^{l}\)</span> and <span class="math notranslate nohighlight">\(f_{j+1/2,k}^{r}\)</span> have been obtained earlier in the initial distribution function <span class="math notranslate nohighlight">\(f_{0}\)</span> around a cell interface, the above moments can be evaluated explicitly. Therefore, the conservative variables <span class="math notranslate nohighlight">\(\rho_{0}, \rho_{0}U_{0}\)</span> and <span class="math notranslate nohighlight">\(E_{0}\)</span> at the cell interface can be obtained, from which <span class="math notranslate nohighlight">\(g_{0}\)</span> is uniquely determined. Different from the BGK-NS method, the integration of <span class="math notranslate nohighlight">\(f_{0}\)</span> term in phase space in BGK-NS scheme is replaced by the quadrature formula in particle velocity due to the discretization of phase space. Also, due to the particle velocity discretization, the gas distribution function has more freedom here to recover any shape distribution function in the highly non-equilibrium flow regime, and the macroscopic governing equations underlying the current kinetic approach can be beyond the NS in the general case. For the equilibrium state, <span class="math notranslate nohighlight">\(\lambda_{0}\)</span> in <span class="math notranslate nohighlight">\(g_{0}\)</span> can be found from</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\lambda_{0} = \frac{(K + 1)\rho_{0}}{4\Big( E_{0} - \frac{1}{2}\rho_{0}U_{0}^{2} \Big)}
\end{align}\]</div>
<p>Then, <span class="math notranslate nohighlight">\(\overline{a}^{l}\)</span> and <span class="math notranslate nohighlight">\(\overline{a}^{r}\)</span> of <span class="math notranslate nohighlight">\(g\)</span> can be obtained through the relation of</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\overline{W}_{j+1}(x_{j+1}) - W_{0}}{\rho_{0}\Delta x^{+}}
= \int \overline{a}^{r}g_{0}\psi ~\mathrm{d}\Xi
= \overline{M}_{\alpha\beta}^{0} \begin{pmatrix} \overline{a}_{1}^{r} \\ \overline{a}_{2}^{r} \\ \overline{a}_{3}^{r} \end{pmatrix}
= \overline{M}_{\alpha\beta}^{0}\overline{a}_{\beta}^{r}
\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{W_{0} - \overline{W}_{j}(x_{j})}{\rho_{0}\Delta x^{-}}
= \int \overline{a}^{l}g_{0}\psi ~\mathrm{d}\Xi
= \overline{M}_{\alpha\beta}^{0} \begin{pmatrix} \overline{a}_{1}^{l} \\ \overline{a}_{2}^{l} \\ \overline{a}_{3}^{l} \end{pmatrix}
= \overline{M}_{\alpha\beta}^{0}\overline{a}_{\beta}^{l}
\end{align}\end{split}\]</div>
<p>where the matrix <span class="math notranslate nohighlight">\(\overline{M}_{\alpha\beta}^{0} = \int g_{0}\psi_{\alpha}\psi_{\beta}\mathrm{d}\Xi/\rho_{0}\)</span> is known, and <span class="math notranslate nohighlight">\(\Delta x^{+} = x_{j+1} - x_{j+1/2}\)</span> and <span class="math notranslate nohighlight">\(\Delta x^{-} = x_{j+1/2} - x_{j}\)</span> are the distances from the interface to cell centers. Therefore, <span class="math notranslate nohighlight">\((\overline{a}_{1}^{r}, \overline{a}_{2}^{r}, \overline{a}_{3}^{r})^{T}\)</span> and <span class="math notranslate nohighlight">\((\overline{a}_{1}^{l}, \overline{a}_{2}^{l}, \overline{a}_{3}^{l})^{T}\)</span> can be found following the procedure as BGK-NS method. In order to evaluate the time evolution part <span class="math notranslate nohighlight">\(\overline{A}\)</span> in the equilibrium state, we can apply the following condition</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d}}{\mathrm{d}t}\int (g-\hat{f})\boldsymbol{\psi}\mathrm{d}\Xi = 0
\end{align}\]</div>
<p>at <span class="math notranslate nohighlight">\((x=0,t=0)\)</span> and get</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\overline{M}_{\alpha\beta}^{0}\overline{A}_{\beta}
= \Big( \frac{\partial \rho}{\partial t}, \frac{\partial(\rho U)}{\partial t}, \frac{\partial E}{\partial t} \Big)^{T}
= -\frac{1}{\rho_{0}}\int \Big[ u\Big( \overline{a}^{l}H[u] + \overline{a}^{r}(1 - H[u]) \Big)g_{0} \Big] \boldsymbol{\psi}\mathrm{d}\Xi
\end{align}\]</div>
<p>Up to this point, we have determined all parameters in the initial gas distribution funtion <span class="math notranslate nohighlight">\(f_{0}\)</span> and the equilibrium state <span class="math notranslate nohighlight">\(g\)</span> in space and time locally. After substituting the expression of <span class="math notranslate nohighlight">\(f_{0}\)</span> and <span class="math notranslate nohighlight">\(g\)</span> into the <span class="math notranslate nohighlight">\(\hat{f}_{j+1/2,k}\)</span> equation and taking <span class="math notranslate nohighlight">\(u=u_{k}\)</span> in <span class="math notranslate nohighlight">\(g_{0}, \overline{a}^{l}, \overline{a}^{r}\)</span> and <span class="math notranslate nohighlight">\(\overline{A}\)</span> , the gas distribution function <span class="math notranslate nohighlight">\(\hat{f}(x_{j+1/2}, t, u_{k}, \xi)\)</span> at the discretized particle velocity <span class="math notranslate nohighlight">\(u_{k}\)</span> can be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{f}_{j+1/2,k}(0,t)
&amp;= (1 - e^{-t/\tau})g_{0}
+ \Big( \tau(-1 + e^{-t/\tau}) + te^{-t/\tau} \Big) \Big( \overline{a}^{l}H[u_{k}] + \overline{a}^{r}(1 - H[u_{k}]) \Big) u_{k}g_{0}
+ \tau (t/\tau - 1 + e^{-t/\tau})\overline{A}g_{0} \\
&amp;\quad + e^{-t/\tau}\Big( (1 - u_{k}t\sigma_{j,k})H[u_{k}]f_{j+1/2,k}^{l} + (1 - u_{k}t\sigma_{j+1.k})(1 - H[u_{k}])f_{j+1/2,k}^{r} \Big) \\
&amp;:= \tilde{g}_{j+1/2,k} + \tilde{f}_{j+1/2,k}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{g}_{j+1/2,k}\)</span> is all terms related to the integration of the equilibrium state <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(\tilde{f}_{j+1/2,k}\)</span> is the terms from initial condtion <span class="math notranslate nohighlight">\(f_{0}\)</span> . The collision time <span class="math notranslate nohighlight">\(\tau\)</span> in the above distribution function is determined by <span class="math notranslate nohighlight">\(\tau = \mu(T_{0})/p_{0}\)</span> , where <span class="math notranslate nohighlight">\(T_{0}\)</span> is the temperature and <span class="math notranslate nohighlight">\(p_{0}\)</span> is the pressure, and both of them can be evaluated from <span class="math notranslate nohighlight">\(W_{0}\)</span> at the cell interface. The above time-accurate gas distribution function can be used in <span class="math notranslate nohighlight">\(f_{j,k}^{n+1}\)</span> equation for the fluxes at a cell interface.</p>
<p>In order to discretize the collision term in the <span class="math notranslate nohighlight">\(f_{j,k}^{n+1}\)</span> equation efficiently and accurately, a multiscale unified formulation is the following. Let’s first take moment <span class="math notranslate nohighlight">\(\boldsymbol{\psi}\)</span> on it. Due to the vanishing of the particle collision term for the conservative variables, we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
W_{j}^{n+1} = W_{j}^{n}
+ \frac{1}{\Delta x}\int \int_{t^{n}}^{t^{n+1}}u (\tilde{g}_{j-1/2} - \tilde{g}_{j+1/2})\psi ~\mathrm{d}t\mathrm{d}\Xi
+ \frac{1}{\Delta x}\sum_{k}\int_{t^{n}}^{t^{n+1}}u_{k}(\tilde{f}_{j-1/2,k} - \tilde{f}_{j+1/2,k})\boldsymbol{\psi}~\mathrm{d}t
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{g}_{j+1/2}\)</span> has the same expression as <span class="math notranslate nohighlight">\(\tilde{g}_{j+1/2,k}\)</span> , but is integrated in a continuous particle velocity space <span class="math notranslate nohighlight">\(u_{k}=u\)</span> . The integration of the equilibrium part <span class="math notranslate nohighlight">\(\tilde{g}\)</span> can be evaluated exactly and the integration of the non-equilibrium part <span class="math notranslate nohighlight">\(\tilde{f}\)</span> can be done using the quadrature.</p>
<p>For the update of the conservative variables, the difference between the above formulation and the BGK-NS scheme is that the discrete sum is used for the integration of the initial distribution function <span class="math notranslate nohighlight">\(f_{0}\)</span> in particle velocity space. For a highly non-equilibrium flow, the real distribution function <span class="math notranslate nohighlight">\(f_{0}\)</span> can be a complicated function, and a discretization of particle velocity has to be used. For the original BGK-NS scheme targeting on the NS solutions, the initial gas distribution function <span class="math notranslate nohighlight">\(f_{0}\)</span> can be reconstructed from the distribution of macroscopic variables according to the Chapman-Enskog expansion. Therefore, the specific form of initial condition <span class="math notranslate nohighlight">\(f_{0}\)</span> can be mathematically reconstructed. In the continuum flow limit, due to the sufficient number of particle collisions and with the condition of time step being much larger than the particle collision time, the contribution of the integration of the equilibrium state <span class="math notranslate nohighlight">\(\tilde{g}_{j+1/2}\)</span> will be dominant in the final solution of the distribution function <span class="math notranslate nohighlight">\(\hat{f}_{j+1/2,k}\)</span> . The <span class="math notranslate nohighlight">\(\tilde{g}_{j+1/2}\)</span> itself gives a corresponding NS distribution function, and the contribution from initial term <span class="math notranslate nohighlight">\(\tilde{f}_{j+1/2,k}\)</span> vanishes. As a result, the updated discrete form of the distribution function <span class="math notranslate nohighlight">\(f_{j,k}^{n+1}\)</span> will present a Chapman-Enskog NS distribution function. Therefore, in the continuum flow regime, the BGK-NS scheme with continuous particle velocity space and the current unified method with discretized particle velocity space will become the same scheme. In the continuum flow regime, for the NS solutions the update of the conservative variables through the above equation is enough, because the gas distribution function <span class="math notranslate nohighlight">\(f_{j,k}^{n+1}\)</span> can be reconstructed from the updated conservative variables. Therefore, for the continuum flow only, like the BGK-NS scheme, we do not basically update the gas distribution function. This also illustrates that in terms of the conservative flow variable update, the unified scheme is an AP method in the continuum limit. However, the unified scheme is not limited to continuum flow. In the highly non-equilibrium flow regime, the equation for the update of conservative variables is still correct. For example, in the collisionless limit, the non-equilibrium part <span class="math notranslate nohighlight">\(\tilde{f}_{j-1/2,k}\)</span> and <span class="math notranslate nohighlight">\(\tilde{f}_{j+1/2,k}\)</span> will take dominant effect, and the contribution from the equilibrium part vanishes. Therefore, the unified scheme has the correct collisionless limit as well.</p>
<p>In general, based on the above updated conservative variables, we can immediately obtain the equilibrium gas distribution function <span class="math notranslate nohighlight">\(g_{j,k}^{n+1}\)</span> inside each cell, therefore based on the above equation the unified kinetic scheme for the update of gas distribution function becomes</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{j,k}^{n+1} = f_{j,k}^{n}
+ \frac{1}{\Delta x} \bigg(
\int_{t^{n}}^{t^{n+1}}u_{k}(\tilde{g}_{j-1/2,k} - \tilde{g}_{j+1/2,k})\mathrm{d}t
+ \int_{t^{n}}^{t^{n+1}}u_{k}(\tilde{f}_{j-1/2,k} - \tilde{f}_{j+1/2,k})\mathrm{d}t
\bigg)
+ \frac{\Delta t}{2}\Big( \frac{g_{j,k}^{n+1} - f_{j,k}^{n+1}}{\tau^{n+1}} + \frac{g_{j,k}^{n} - f_{j,k}^{n}}{\tau^{n}} \Big)
\end{align}\]</div>
<p>where trapezoidal rule has been used for the time integration of collision term. So, from the above equation, the unified multiscale scheme for the update of gas distribution function is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f_{j,k}^{n+1} = \Big( 1 + \frac{\Delta t}{2 \tau^{n+1}} \Big)^{-1}
\bigg[ f_{j,k}^{n}
+ \frac{1}{\Delta x}\Big(
\int_{t^{n}}^{t^{n+1}}u_{k}(\tilde{g}_{j-1/2,k} - \tilde{g}_{j+1/2,k})\mathrm{d}t
+ \int_{t^{n}}^{t^{n+1}} u_{k}(\tilde{f}_{j-1/2,k} - \tilde{f}_{j+1/2,k})\mathrm{d}t
\Big)
+ \frac{\Delta t}{2}\Big( \frac{g_{j,k}^{n+1}}{\tau_{j}^{n+1}} + \frac{g_{j,k}^{n} - f_{j,k}^{n}}{\tau_{j}^{n}} \Big)
\bigg]
\end{align}\]</div>
<p>where no iteration is needed for the update of the above solution. The particle collision times <span class="math notranslate nohighlight">\(\tau_{j}^{n}\)</span> and <span class="math notranslate nohighlight">\(\tau_{j^{n+1}}\)</span> are defined based on the temperature and pressure in the cell, i.e., <span class="math notranslate nohighlight">\(\tau_{j}^{n} = \mu(T_{j}^{n})/p_{j}^{n}\)</span> and <span class="math notranslate nohighlight">\(\tau_{j}^{n+1} = \mu(T_{j}^{n+1})/p_{j}^{n+1}\)</span> , which are known due to the update of macroscopic flow variables in the equation given before.</p>
</div>
<div class="section" id="determination-of-time-step">
<h3>Determination of time step<a class="headerlink" href="#determination-of-time-step" title="永久链接至标题">¶</a></h3>
<p>In the continuum limit, for the unified scheme the time step is determined by the CFL condition</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t = \text{CFL}\frac{\Delta x}{|U| + c}
\end{align}\]</div>
<p>where CFL is the CFL number and <span class="math notranslate nohighlight">\(c\)</span> is the sound speed. On the other hand, the particle collision time is defined by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\tau = \frac{\mu}{p} = \frac{\rho|U|\Delta x}{p Re}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(Re = \rho \Delta x |U| / \mu\)</span> is the cell’s Reynolds number. With the approximation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
|U| + c \simeq c
\end{align}\]</div>
<p>which is true for low speed flow and is approximately correct even for hypersonic flow because the flow velocity is on the same order of sound speed, we have</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\Delta t}{\tau} = \frac{Re}{M}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is the Mach number. So, for the continuum flow computation, even for a modest cell Reynolds number, such as <span class="math notranslate nohighlight">\(10^{4}\)</span> , the time step for the unified scheme can be several order larger than the particle collision time. The above equation can be also written in the following form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\Delta t = \frac{\tau}{Kn}
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(Kn = M/Re\)</span> is the local cell Knudsen number. So, for a flow with all Knudsen regimes from the continuum to free molecules, such as the nozzle flows, the overall time step taken by the unified scheme can be the one which maximizes the above time step. As a result, the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> used in the whole domain will be <span class="math notranslate nohighlight">\(\Delta t \gg \tau\)</span> in the continuum and <span class="math notranslate nohighlight">\(\Delta t &lt; \tau\)</span> in rarefied regimes. In comparison with the schemes which use a time step solely controlled by the minimum particle collision time, the current unified scheme is much more efficient.</p>
</div>
<div class="section" id="prandtl-number-fix">
<h3>Prandtl number fix<a class="headerlink" href="#prandtl-number-fix" title="永久链接至标题">¶</a></h3>
<p>The unified scheme is based on the BGK model, which presents unit Prandtl number. For real gas, due to the interaction forces between molecules, the Prandtl number is approximately equal to <span class="math notranslate nohighlight">\(2/3\)</span> for a monatomic gas. In order to extend the unified scheme to simulate flow with any realistic Prandtl number, the heat flux in the scheme has to been modified.</p>
<p>Traditionally, in order to fix the Prandtl number, many approaches have been investigated. The well-known ones include Ellipsoid BGK model, velocity dependent particle collision time, and Shakhov model. Since the heat flux is a macroscopic flow variable, it is related to the collective flow properties, it is very hard to directly modify it in the update of gas distribution function. Fortunately, the current unified scheme is a multiscale method. Both microscopic distribution function and macroscopic conservative flow variables are updated in the scheme. As a result, similar to the BGK-NS method, in the process of updating conservative flow variables, we can modify the heat flux across the cell interface in <span class="math notranslate nohighlight">\(W_{j}^{n+1}\)</span> equation in the following way. In the flux evaluation in the equation, the interface flux is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
F_{j+1/2} = \int u\tilde{g}_{j+1/2}\boldsymbol{\psi}\mathrm{d}\Xi
+ \sum_{k}u_{k}\tilde{f}_{j+1/2,k}\boldsymbol{\psi}
\end{align}\]</div>
<p>which include the energy flux <span class="math notranslate nohighlight">\(F_{E}\)</span> . Therefore, the easiest way to modify the Prandtl number is to change the heat flux. The heat flux at a cell interface is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
q_{j+1/2} = \int \frac{1}{2}(u - U_{j+1/2}) \Big( (u - U_{j+1/2})^{2} + \xi^{2} \Big)\boldsymbol{\psi} \tilde{g}_{j+1/2}\mathrm{d}\Xi
+ \sum_{k}\frac{1}{2}(u_{k} - U_{j+1/2}) \Big( (u_{k} - U_{j+1/2})^{2} + \xi^{2} \Big) \boldsymbol{\psi} \tilde{f}_{j+1/2,k}
\end{align}\]</div>
<p>where the interface averaged flow velocity is defined by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
U_{j + 1/2} = \frac{\int u \tilde{g}_{j+1/2}\mathrm{d}\Xi + \sum_{k}u_{k}\tilde{f}_{j+1/2,k}}{\int \tilde{g}_{j+1/2}\mathrm{d}\Xi + \sum_{k}\tilde{f}_{j+1/2,k}}
\end{align}\]</div>
<p>So, with a given Prandtl number <span class="math notranslate nohighlight">\(Pr\)</span> , we only need to replace the original energy flux <span class="math notranslate nohighlight">\(F_{E}\)</span> in the <span class="math notranslate nohighlight">\(F_{j+1/2}\)</span> expression by the new one</p>
<div class="math notranslate nohighlight">
\[\begin{align}
F_{E}^{new} = F_{E} + \Big(\frac{1}{Pr} - 1\Big)q_{j+1/2}
\end{align}\]</div>
<p>With the correct Prandtl number in the updated macroscopic variables, subsequently it effects the construction of the equilibrium state <span class="math notranslate nohighlight">\(g^{n+1}\)</span> at the next level. Therefore, the update of microscopic gas distribution function is modified as well. The above procedure of the modification of heat flux has some similarity with the DSMC method. For example, in the current scheme the post-collision particle velocity and directions are controlled through the modified <span class="math notranslate nohighlight">\(g^{n+1}\)</span> .</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="稀薄气体动力学.html" class="btn btn-neutral float-left" title="稀薄气体动力学" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AutoCAD.html" class="btn btn-neutral float-right" title="AutoCAD" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022-2023, Koishi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>