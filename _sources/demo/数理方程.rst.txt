********
数理方程
********


偏微分方程定解问题
=====================

偏微分方程是指含有多元未知函数 :math:`u=u(\mathbf{x})` ， :math:`\mathbf{x}=(x_{1},x_{2},\cdots,x_{n})` 及其若干阶偏导数的关系式

.. math::
	\begin{align}
	F\Big( \mathbf{x},u,\frac{\partial u}{\partial x_{1}},\cdots,\frac{\partial u}{\partial x_{n}},\cdots,\frac{\partial ^{m}u}{\partial x_{1}^{m_{1}}\partial x_{2}^{m_{2}}\cdots\partial x_{n}^{m_{n}}} \Big) = 0
	\end{align}

其中，最高阶导数的阶数 :math:`m=m_{1}+m_{2}+\cdots+m_{n}` 为 **方程的阶** 。如果偏微分方程中与未知函数有关的部分是 :math:`u` 及 :math:`u` 的偏导数的线性组合，则称该偏微分方程为 **线性偏微分方程** ，具有形式

.. math::
	\begin{align}
	L[u] & = f
	\end{align}

其中 :math:`L[u]` 表示 :math:`u` 及其导数的线性组合； :math:`f` 表示自由项，只依赖于独立变量。如果 :math:`f=0` ，即 :math:`L[u]\equiv 0` 则称为齐次方程。


三个典型方程的导出
---------------------

弦的横振动
^^^^^^^^^^^^

一根弦在内部张力作用下处于平衡位置，某个微小扰动引起部分质点的位移，内部张力又使邻近的部分随之发生位移，形成波的运动。假设弦均匀细长，从而其横截面可忽略而视作线，线密度为常数。又设弦柔软弹性，可任意弯曲，张力满足胡克定律。弦的运动在同一个平面内进行，每个质点的位移都是横向的，即垂直于弦的平衡位置，且绝对位移和相对位移都很小。

取弦在自身张力作用下的平衡位置所在直线为x轴，横向位移方向为u轴，设t时刻弦上x处的质点相对于平衡位置的横向位移为未知函数 :math:`u=u(t,x)` 。

采用微元分析法，在弦上任意取微元 :math:`[x,x+\mathrm{d}x]` ，由于是微小振动，可以认为

.. math::
	\begin{align}
	\mathrm{d}s = \sqrt{(\mathrm{d}x)^{2} + (\frac{\partial u}{\partial x}\mathrm{d}x)^{2} } = \sqrt{1+(\frac{\partial u}{\partial x})^{2}} \mathrm{d}x \approx \mathrm{d}x  
	\end{align}

因此该微元可以视作质量为 :math:`\rho\mathrm{d}x` 的质点，其中 :math:`\rho` 为线密度，设为常数。

该微元所受的外力有左端点的张力 :math:`-\mathbf{T}(t,x)` ，右端点的张力 :math:`\mathbf{T}(t,x+\mathrm{d}x)` ，以及 :math:`t` 时刻作用于 :math:`x` 处的单位长度上的外力（外力密度） :math:`g(t,x)` ，借助位移矢量 :math:`\mathbf{s}` ，对微元应用牛顿第二定律可以得到

.. math::
	\begin{align}
	(\rho\mathrm{d}x)\frac{\partial ^{2}\mathbf{s}}{\partial t^{2}} = -\mathbf{T}(t,x) + \mathbf{T}(t,x+\mathrm{d}x) + \mathbf{g}(t,x)\mathrm{d}x
	\end{align}

其中，根据之前的假设， :math:`\mathbf{s}` 和 :math:`\mathbf{g}` 的方向相同，与 :math:`\mathrm{d}x` 方向垂直，即只有u方向的分量。对 :math:`\mathbf{T}(t,x+\mathrm{d}x)` 进行泰勒展开并忽略二阶及以上的无穷小量，则有

.. math::
	\begin{align}
	\rho\mathrm{d}x\frac{\partial ^{2}\mathbf{s}}{\partial t^{2}} = \frac{\partial \mathbf{T}}{\partial x}\mathrm{d}x + \mathbf{g}(t,x)\mathrm{d}x  
	\end{align}

根据上式，可以得到 :math:`x` 方向和 :math:`u` 方向的分量形式：

.. math::
	\begin{align}
	& \frac{\partial T_{1}}{\partial x} = 0 \\
	& \rho\frac{\partial ^{2}u}{\partial t^{2}} = \frac{\partial T_{2}}{\partial x} + g(t,x)  
	\end{align}

其中 :math:`T_{1},T_{2}` 分别是张力 :math:`\mathbf{T}` 在x和u方向的分量。由于张力 :math:`\mathbf{T}` 沿着弦的切线方向作用，所以

.. math::
	\begin{align}
	T_{2} = T_{1}\frac{\partial u}{\partial x}
	\end{align}

代入两个分量方程就可以化简得到

.. math::
	\begin{align}
	\rho\frac{\partial ^{2}u}{\partial t^{2}}=T_{1}\frac{\partial ^{2}u}{\partial x^{2}}+g(t,x)  
	\end{align}

在微小横振动的假设下， :math:`\Big| \frac{\partial u}{\partial x} \Big| \ll 1` ，张力大小满足

.. math::
	\begin{align}
	T = \sqrt{T_{1}^{2}+T_{2}^{2}} = T_{1}\sqrt{1+(\frac{\partial u}{\partial x} )^{2}} \approx T_{1}
	\end{align}

又因为在运动过程中微元弧长保持不变，由胡克定律可知张力大小 :math:`T\approx T_{1}` 也不随时间变化，从而张力为常数，从而原方程可以改写为

.. math::
	\begin{align}
	& \frac{\partial ^{2}u}{\partial t^{2}} = a^{2}\frac{\partial ^{2}u}{\partial x^{2}} +f(t,x) \\
	& a=\sqrt{\frac{T}{\rho} }, \quad f(t,x)=\frac{g(t,x)}{\rho}    
	\end{align}

上述方程称之为弦的横振动方程，其中系数 :math:`a` 反映波的传播速度，由弦本身的性质决定； :math:`f(t,x)` 则是作用在弦身单位质量上的外力，当弦自由振动时有 :math:`f(t,x)=0` 。


由此可见，凡是弹性介质中微小扰动的传播问题，都可以用类似方法导出同一类方程，一般表示为

.. math::
	\begin{align}
	\frac{\partial ^{2}u}{\partial t^{2}} = a^{2}\Delta u+f(t,x), \qquad x=(x_{1},x_{2},\cdots,x_{n}) 
	\end{align}

其中 :math:`\Delta = \sum_{j=1}^{n}\frac{\partial ^{2}}{\partial x_{j}^{2}}` 为拉普拉斯算子。这类方程称为 **波动方程** 。




热传导问题
^^^^^^^^^^^^^

空间某个物体或静止流体内温度分布不均匀，引起热量流动及温度的变化，这类过程称为热运动。设物体由同一介质构成，且介质均匀分布、各向同性，从而介质的密度、比热和热传导系数均为常数。在空间取定直角坐标系，取各点在 :math:`t` 时刻的温度 :math:`u=u(t,x,y,z)` 为热运动的表征量。在介质内任取微元 :math:`\mathrm{d}V=[x,x+\mathrm{d}x]\times[y,y+\mathrm{d}y]\times[z,z+\mathrm{d}z]` ，考察微元 :math:`\mathrm{d}V` 在时间间隔 :math:`[t,t+\mathrm{d}t]` 内的温度变化。

根据能量守恒定律，物体温度升高所需热量等于外部流入热量和内部热源产生热量之和。热量的流动遵循傅里叶热传导定律：

.. math::
	\begin{align}
	\mathbf{Q}_{n} = -k\frac{\partial u}{\partial \mathbf{n}}
	\end{align}

其中， :math:`\mathbf{Q}_{n}` 为 :math:`\mathbf{n}` 方向的热流密度矢量，即单位时间沿 :math:`\mathbf{n}` 方向通过单位面积的热量； :math:`k` 为介质的热传导系数，在介质均匀、各向同性的假设下是常数。

在 :math:`[t,t+\mathrm{d}t]` 时间间隔内通过微元的左右面传入的热量为

.. math::
	\begin{align}
	-k\frac{\partial u}{\partial x}\bigg|_{(t,x,y,z)}\mathrm{d}t\mathrm{d}y\mathrm{d}z
	+k\frac{\partial u}{\partial x}\bigg|_{(t,x+\mathrm{d}x,y,z)}\mathrm{d}t\mathrm{d}y\mathrm{d}z
	\approx k\frac{\partial ^{2}u}{\partial x^{2}}\bigg|_{(t,x,y,z)}\mathrm{d}t\mathrm{d}x\mathrm{d}y\mathrm{d}z           
	\end{align}

以上近似过程利用了x轴方向泰勒展开并忽略了二阶及以上无穷小量。通过类似的方式可以求出通过前后和上下面流入的热量。

如果介质内部有热源，其热源密度，即单位时间体积热源流出的热量为 :math:`g(t,x,y,z)` ，则在 :math:`[t,t+\mathrm{d}t]` 时间间隔内，微元内部热源流出热量为

.. math::
	\begin{align}
	g(t,x,y,z)\mathrm{d}t\mathrm{d}x\mathrm{d}y\mathrm{d}z 
	\end{align}

而微元温度升高所需的热量为

.. math::
	\begin{align}
	c\rho\Big( u(t+\mathrm{d}t,x,y,z) - u(t,x,y,z)\Big)\mathrm{d}x\mathrm{d}y\mathrm{d}z \approx c\rho\frac{\partial u}{\partial t}\mathrm{d}t\mathrm{d}x\mathrm{d}y\mathrm{d}z      
	\end{align}

以上近似过程利用了t方向泰勒展开并忽略了二阶及以上无穷小量。将上述所有的量代入能量守恒定律，得到方程

.. math::
	\begin{align}
	c\rho\frac{\partial u}{\partial t} 
	= k\Big( \frac{\partial^{2} u}{\partial x^{2}} + \frac{\partial ^{2}u}{\partial y^{2}} + \frac{\partial ^{2}u}{\partial z^{2}} \Big) 
	+ g(t,x,y,z)
	\end{align}

整理即得到 **热传导方程** ：

.. math::
	\begin{align}
	\frac{\partial u}{\partial t} = a^{2}\Delta u + f(t,x,y,z) 
	\end{align}

其中 :math:`a = \sqrt{\frac{k}{c\rho}}` ， :math:`f(t,x,y,z)=\frac{g(t,x,y,z)}{c\rho}` 。如果考虑热传导方程的稳恒状态，即 :math:`\frac{\partial u}{\partial t} \equiv 0` ，就成为了泊松方程：

.. math::
	\begin{align}
	\Delta u = -\frac{1}{a^{2}}f(x,y,z) 
	\end{align}




静电场
^^^^^^^^^

真空中有电荷分布，密度为 :math:`\rho(x,y,z)` ，引起的稳恒电场为 :math:`\mathbf{E}(x,y,z)` 。在空间任取区域 :math:`V` ，由静电场的高斯定律：通过任意封闭曲面的电通量等于该曲面包围体积内的电荷总量除以介电常数 :math:`\varepsilon_{0}` ，有

.. math::
	\begin{align}
	\int_{\partial V}\mathbf{E} \cdot\mathrm{d}\mathbf{S}
	= \frac{1}{\varepsilon_{0}}\int_{V}\rho(x,y,z)\mathrm{d}V
	= \int_{V}\nabla \cdot\mathbf{E}~\mathrm{d}V  
	\end{align}

由 :math:`V` 的任意性就可以得到

.. math::
	\begin{align}
	\nabla \cdot \mathbf{E} = \frac{\rho(x,y,z)}{\varepsilon_{0}} 
	\end{align}

又在空间任意取曲面 :math:`\mathbf{S}` ，其边界线为 :math:`L` ，由法拉第定律：静电场绕任意闭路的电动势为零，则有

.. math::
	\begin{align}
	\int_{L}\mathbf{E}\cdot\mathrm{d}\mathbf{l}
	= \int_{S}\nabla\times\mathbf{E}\cdot\mathrm{d}\mathbf{S}
	= 0
	\end{align}

由 :math:`\mathbf{S}` 的任意性可以得到

.. math::
	\begin{align}
	\nabla \times \mathbf{E} = 0
	\end{align}

也即静电场无旋，从而存在位函数 :math:`\varphi(x,y,z)` 使得 :math:`\mathbf{E}=-\nabla\varphi` ，则

.. math::
	\begin{align}
	\nabla \cdot (-\nabla\varphi)= \frac{\rho(x,y,z)}{\varepsilon_{0}}
	\quad \Rightarrow \quad 
	\nabla^{2}\varphi = -\frac{\rho(x,y,z)}{\varepsilon_{0}} 
	\end{align}

上式是一个Poisson方程，也称为 **场位方程** 。






定解问题及其适定性
---------------------


通解和特解
^^^^^^^^^^^^^

如果多元函数 :math:`u(x_{1},x_{2},\cdots,x_{n})` 在空间区域 :math:`V \subset \mathbb{R}^{n}` 内具有方程中出现的各阶连续导数，并使方程

.. math::
	\begin{align}
	F\Big( x_{1},\cdots,x_{n},u,\frac{\partial u}{\partial x_{1}},\cdots,\frac{\partial^{m}u}{\partial x_{1}^{m_{1}}\partial x_{2}^{m_{2}}\cdots\partial x_{n}^{m_{n}}}\Big)=0
	\end{align}

成为恒等式，则称此函数为上述方程在区域 :math:`V` 内的解，也称为 **古典解** 。

偏微分方程的解族很大，可以包含任意函数。称 :math:`m` 阶偏微分方程的含有 :math:`m` 个任意函数的解为方程的 **通解** ，不含任意函数或任意常数的解为方程的一个 **特解** 。通解中的任意函数一旦确定，通解就成为特解。


.. note:: 例如，根据解析函数的实部、虚部是调和函数，可以得到二维Laplace方程 :math:`\nabla^{2}u=0` 的中心对称解 :math:`u=\ln\frac{1}{r}(r\ne 0)` ，周期解 :math:`u=e^{x}\sin y` ，多项式解 :math:`u=x^{2}-y^{2}` 等。



定解条件
^^^^^^^^^^^

通常把反映系统内部作用导出的偏微分方程称为 **泛定方程** ，把确定运动的制约条件称为 **定解条件** ，泛定方程配以适当的定解条件构成一个偏微分方程的 **定解问题** 。定解条件也需要从具体的物理问题中导出，常见的定解条件有以下几类：

- **初始条件** ：对于随着时间发展变化的物理过程，某一时刻的状态将影响该时刻以后得过程，该时刻的状态便是初始条件。从数学上讲，初始条件是给出未知函数 :math:`u` 及其关于某个自变量 :math:`t` 的若干阶偏导数在同一时刻 :math:`t=t_{0}` 的值。如果方程中关于 :math:`t` 的最高阶导数是 :math:`m` 阶的，则对应给出 :math:`u,\frac{\partial u}{\partial t},\cdots,\frac{\partial^{m-1}u}{\partial t^{m-1}}` 在 :math:`t=t_{0}` 的值。
- **边界条件** ：第一类边界是直接给定边界上待求变量的分布，也称为 **Dirichlet条件** ；第二类边界是给定边界上待求变量的梯度值，也称为 **Neumann条件** ；第三类边界是待求变量与其梯度值之间的线性组合关系，也称为 **Robin条件** 。




一阶线性（拟线性）偏微分方程的通解法和特征线法
-------------------------------------------------


两个自变量的一阶线性偏微分方程
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

现在有两个自变量的一阶线性偏微分方程：

.. math::
	\begin{align}
	a(x,y)\frac{\partial u}{\partial x}
	+ b(x,y)\frac{\partial u}{\partial y}
	+ c(x,y)u
	= f(x,y)  
	\end{align}

其中，系数 :math:`a(x,y)` ， :math:`b(x,y)` ， :math:`c(x,y)` 是平面区域 :math:`D \subset \mathbb{R}^{2}` 上的连续函数，且 :math:`a(x,y)` ， :math:`b(x,y)` 不同时为零。 :math:`f(x,y)` 在 :math:`D` 上连续，称为方程的非齐次项，如果它恒等于零，那么方程就变成齐次的。

如果在 :math:`D` 上， :math:`a(x,y)=0` ， :math:`b(x,y)\ne 0` ，上述方程就可以改写为

.. math::
	\begin{align}
	\frac{\partial u}{\partial y}
	+ \frac{c(x,y)}{b(x,y)}u
	= \frac{f(x,y)}{b(x,y)}   
	\end{align}

从而可以使用一阶线性常微分方程的求解方法得到其通解：

.. math::
	\begin{align}
	u(x,y) = 
	\exp\Big( -\int\frac{c(x,y)}{b(x,y)}\mathrm{d}y \Big)
	\cdot
	\Big( 
	\int\exp\Big( \int\frac{c(x,y)}{b(x,y)}\mathrm{d}y \Big)
	\frac{f(x,y)}{b(x,y)}\mathrm{d}y
	+ g(x)
	\Big)
	\end{align}

其中 :math:`g(x)` 为任意的 :math:`C^{1}` 函数。



如果在 :math:`D` 上 :math:`a(x,y)b(x,y)\ne 0` ，则作待定的自变量代换：

.. math::
	\begin{align}
	\left \{\begin{array}{ll}
	\xi = \varphi(x,y), \\
	\eta = \psi(x,y),
	\end{array}\right.
	\end{align}

要求其Jacobi行列式恒不等于零以保证新变量 :math:`\xi,\eta` 的相互独立性：

.. math::
	\begin{align}
	J(\varphi,\psi) = \frac{\partial(\varphi,\psi)}{\partial(x,y)} = 
	\begin{vmatrix}
	\frac{\partial \varphi}{\partial x} & \frac{\partial \varphi}{\partial y} \\
	\frac{\partial \psi}{\partial x} & \frac{\partial \psi}{\partial y}    
	\end{vmatrix} 
	\ne 0
	\end{align}

利用链式法则

.. math::
	\begin{align}
	\frac{\partial u}{\partial x} = \frac{\partial \varphi}{\partial x}\frac{\partial u}{\partial \xi} + \frac{\partial \psi}{\partial x}\frac{\partial u}{\partial \eta},
	\qquad 
	\frac{\partial u}{\partial y} = \frac{\partial \varphi}{\partial y}\frac{\partial u}{\partial \xi} + \frac{\partial \psi}{\partial y}\frac{\partial u}{\partial \eta}       
	\end{align}


代入原方程就可以将 :math:`u(x,y)` 的方程变为 :math:`u(\xi,\eta)` 的方程：

.. math::
	\begin{align}
	a\Big( 
	\frac{\partial \varphi}{\partial x}\frac{\partial u}{\partial \xi} 
	+ \frac{\partial \psi}{\partial x}\frac{\partial u}{\partial \eta} 
	\Big)
	+ b \Big(
	\frac{\partial \varphi}{\partial y}\frac{\partial u}{\partial \xi}
	+ \frac{\partial \psi}{\partial y}\frac{\partial u}{\partial \eta}
	\Big)
	+ c u = f
	\end{align}


.. math::
	\begin{align}
	\Big( a\frac{\partial \varphi}{\partial x} 
	+ b\frac{\partial \varphi}{\partial y} 
	\Big) \frac{\partial u}{\partial \xi}
	+ \Big( a\frac{\partial \psi}{\partial x}
	+ b\frac{\partial \psi}{\partial y}
	\Big) \frac{\partial u}{\partial \eta}
	+ cu = f 
	\end{align}


如果令第一项的系数等于零，即 :math:`a\frac{\partial \varphi}{\partial x}+b\frac{\partial \varphi}{\partial y}=0` ，并记解为 :math:`\xi=\varphi(x,y)` ，那么化简后的方程可以通过对 :math:`\eta` 积分得到通解。

存在一个定理能用来确定 :math:`\varphi` 的表达式：如果 :math:`\varphi(x,y)=h` 是一阶常微分方程（ **特征方程** ）

.. math::
	\begin{align}
	\frac{\mathrm{d}x}{a(x,y)} = \frac{\mathrm{d}y}{b(x,y)} 
	\end{align}

在区域 :math:`D` 内的隐式通解（积分曲线族），称作 **特征曲线** ，则 :math:`\xi=\varphi(x,y)` 是一阶线性偏微分方程

.. math::
	\begin{align}
	a(x,y)\frac{\partial \varphi}{\partial x} + b(x,y)\frac{\partial \varphi}{\partial y} = 0  
	\end{align}

在区域 :math:`D` 上的一个解。该定理的逆命题也成立。



根据上述定理求出了积分曲线族 :math:`\varphi(x,y)=h` ，再任取满足Jacobi行列式不等于零的函数 :math:`\psi(x,y)` ，代入回原方程为化简成可以积分求通解的方程。特别地，当 :math:`c(x,y)=f(x,y)=0` 时，则有

.. math::
	\begin{align}
	& a\frac{\partial u}{\partial x} + b\frac{\partial \varphi}{\partial y} = 0 \\
	& \frac{\partial u}{\partial \eta} = 0  
	\end{align}

上述方程的通解为 :math:`u=g(\xi)=g\big(\varphi(x,y)\big)` ，其中 :math:`\varphi(x,y)=h` 是积分曲线族隐式通解， :math:`g(\xi)` 是任意 :math:`C^{1}` 函数。







波动方程的行波解
-------------------


一维波动方程的通解和初值问题
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

一维波动方程

.. math::
	\begin{align}
	\frac{\partial ^{2}u}{\partial t^{2}} = a^{2}\frac{\partial ^{2}u}{\partial x^{2}}  
	\end{align}

在 :math:`a>0` 为常数时可以分解为

.. math::
	\begin{align}
	\Big( \frac{\partial }{\partial t} + a\frac{\partial }{\partial x} \Big)\Big( \frac{\partial }{\partial t} - a\frac{\partial }{\partial x} \Big)u = 0
	\end{align}

等价于两个一阶线性偏微分方程的方程组

.. math::
	\begin{align}
	&\frac{\partial v}{\partial t} + a\frac{\partial v}{\partial x} = 0 \\
	&\frac{\partial u}{\partial t} - a\frac{\partial u}{\partial x} = v    
	\end{align}

上述两个方程各有一族独立的特征线，分别为 :math:`x-at=c_{1}` ， :math:`x+at=c_{2}` 。引入新的自变量

.. math::
	\begin{align}
	\xi = x-at, \qquad \eta = x+at
	\end{align}

于是根据链式法则有

.. math::
	\begin{align}
	\frac{\partial u}{\partial t} - a\frac{\partial u}{\partial x}
	= \frac{\partial u}{\partial \xi}\frac{\partial \xi}{\partial t}
	+ \frac{\partial u}{\partial \eta}\frac{\partial \eta}{\partial t}
	- a \Big( \frac{\partial u}{\partial \xi}\frac{\partial \xi}{\partial x} 
	+ \frac{\partial u}{\partial \eta}\frac{\partial \eta}{\partial x} \Big)
	= a\frac{\partial u}{\partial \xi} 
	- a\frac{\partial u}{\partial \eta}
	- a \Big( \frac{\partial u}{\partial \xi}+\frac{\partial u}{\partial \eta} \Big)
	= -2a \frac{\partial u}{\partial \eta}
	= v
	\end{align}


.. math::
	\begin{align}
	\frac{\partial v}{\partial t} + a\frac{\partial v}{\partial x}
	= \frac{\partial v}{\partial \xi}\frac{\partial \xi}{\partial t}
	+ \frac{\partial v}{\partial \eta}\frac{\partial \eta}{\partial t}
	+ a \Big( \frac{\partial v}{\partial \xi}\frac{\partial \xi}{\partial x} 
	+ \frac{\partial v}{\partial \eta}\frac{\partial \eta}{\partial x} \Big)
	= a\frac{\partial v}{\partial \xi} 
	- a\frac{\partial v}{\partial \eta}
	+ a \Big( \frac{\partial v}{\partial \xi}+\frac{\partial v}{\partial \eta} \Big)
	= 2a \frac{\partial v}{\partial \xi}
	= 0
	\end{align}


综合上述两个方程可以得到

.. math::
	\begin{align}
	\frac{\partial ^{2}u}{\partial \xi\partial \eta} = 0
	\end{align}

相继对 :math:`\xi,\eta` 积分，代回原自变量，得到一维波动方程的通解：

.. math::
	\begin{align}
	u = f(\xi) + g(\eta) = f(x-at) + g(x+at)
	\end{align} 

其中， :math:`f,g` 是任意一元 :math:`C^{2}` 函数。可以看到，一维波动方程的解是由速度均为 :math:`a` 的两列反向行进的波组成，成为 **行波解** 。其中 :math:`f(x-at)` 为右行波， :math:`g(x+at)` 为左行波。

现在在上述一维波动方程的基础上，进一步考虑定解条件

.. math::
	\begin{align}
	u\big|_{t=0} = \varphi(x), \qquad \frac{\partial u}{\partial t}\bigg|_{t=0} = \psi(x) 
	\end{align}

将上述初始条件代入通解则有

.. math::
	\begin{align}
	& u\big|_{t=0} = f(x) + g(x) = \varphi(x) \\
	& \frac{\partial u}{\partial t}\bigg|_{t=0} = -af'(x) + ag'(x) = \psi(x) 
	\end{align}

对第二个式子进行积分，得到

.. math::
	\begin{align}
	-f(x)+g(x) = \frac{1}{a}\int_{0}^{x}\psi(x)~\mathrm{d}\xi + C  
	\end{align}

解 :math:`f(x),g(x)` 的联立方程组，得到

.. math::
	\begin{align}
	& f(x) = \frac{1}{2}\Big[ \varphi(x) - \frac{1}{a}\int_{0}^{x}\psi(\xi)~\mathrm{d}\xi - C \Big] , \\
	& g(x) = \frac{1}{2}\Big[ \varphi(x) + \frac{1}{a}\int_{0}^{x}\psi(\xi)~\mathrm{d}\xi + C \Big] 
	\end{align}

从而，一维波动方程初值问题的解一定有下面的形式：

.. math::
	\begin{align}
	u(t,x) = \frac{1}{2}[\varphi(x-at) + \varphi(x+at)] + \frac{1}{2a}\int_{x-at}^{x+at}\psi(\xi)~\mathrm{d}\xi   
	\end{align}

上式称为 **达朗贝尔（d'Alembert）公式** 。



半直线上的问题——延拓法
^^^^^^^^^^^^^^^^^^^^^^^^^^

半直线上的弦振动问题，有时可以先将初始条件延拓至整根直线，再用达朗贝尔公式求解。例如，考虑一端固定半无界弦的自由振动

.. math::
	\begin{align}
	& \frac{\partial^{2}u}{\partial t^{2}} = a^{2}\frac{\partial ^{2}u}{\partial x^{2}} ,~~(t>0,x>0) \\
	& u(t,0)=0, \quad u(0,x)=\varphi(x), \quad \frac{\partial u}{\partial t}(0,x) = \psi(x) 
	\end{align}

这里的初始条件 :math:`\varphi(x),\psi(x)` 仅在 :math:`x>0` 有定义，所以不能直接应用达朗贝尔公式。但是，如果定义在整个实轴上的 :math:`\varphi(x),\psi(x)` 为奇函数，则

.. math::
	\begin{align}
	u(t,0)=\frac{1}{2}[\varphi(-at) + \varphi(at)] + \frac{1}{2a}\int_{-at}^{at}\psi(\xi)\mathrm{d}\xi =0  
	\end{align}


.. note:: 

	如果 :math:`\varphi(x),\psi(x)` 是偶函数，则

	.. math::
		\begin{align}
		\frac{\partial u}{\partial x}(t,0) = \frac{1}{2}[\varphi'(-at) + \varphi'(at)] + \frac{1}{2a}[\psi(at) - \psi(-at)] = 0  
		\end{align}

因此，可以用延拓法将原式中的 :math:`\varphi(x),\psi(x)` 从 :math:`x>0` 奇延拓到 :math:`x<0` ，再利用达朗贝尔公式，求出的解必定满足边界条件 :math:`u(t,0)=0` 。于是作辅助函数

.. math::
	\begin{align}
	\Phi(x)=\left\{
	\begin{array}{l}
	\varphi(x), \qquad x\ge 0, \\
	-\varphi(-x), ~~x<0,
	\end{array}\right.
	\qquad 
	\Psi(x)=\left\{
	\begin{array}{l}
	\psi(x), \qquad x\ge 0, \\
	-\psi(-x), ~~x<0,
	\end{array}\right.
	\end{align}

将上式代入达朗贝尔公式得到解为

.. math::
	\begin{align}
	u(t,x) &= \frac{1}{2}[\Phi(x+at) + \Phi(x-at)] + \frac{1}{2a}\int_{x-at}^{x+at}\Psi(\xi)\mathrm{d}\xi \\
	&= \left\{
	\begin{array}{l}
	\frac{1}{2}[\varphi(x+at) + \varphi(x-at)] + \frac{1}{2a}\int_{x-at}^{x+at}\psi(\xi)\mathrm{d}\xi ,~~t\le \frac{x}{a}, \\
	\frac{1}{2}[\varphi(x+at) - \varphi(at-x)] + \frac{1}{2a}\int_{at-x}^{x+at}\psi(\xi)\mathrm{d}\xi ,~~t>\frac{x}{a}.     
	\end{array}\right .
	\end{align}


.. note:: 类似的，也可以通过将 :math:`\varphi(x),\psi(x)` 作偶延拓求解端点自由的半无界弦的自由振动。



中心对称的球面波
^^^^^^^^^^^^^^^^^^^^

对于中心对称的高维波动方程定解问题，可以通过未知函数的变量代换，将方程约化为一维波动方程来用达朗贝尔公式求解。例如，考虑三维波动方程的初值问题

.. math::
	\begin{align}
	& \frac{\partial^{2}u}{\partial t^{2}} = a^{2}\nabla^{2}u, \quad (t>0, r=\sqrt{x^{2}+y^{2}+z^{2}}>0) \\
	& u\big|_{t=0}=\varphi(r), \quad \frac{\partial u}{\partial t}\bigg|_{t=0}=\psi(r)  
	\end{align}

根据初始条件的球对称性，可以设未知函数 :math:`u=u(t,r)` 。采用球坐标，方程为

.. math::
	\begin{align}
	\frac{\partial^{2}u}{\partial t^{2}} = a^{2}\Big(\frac{\partial ^{2}u}{\partial r^{2}} + \frac{2}{r}\frac{\partial u}{\partial r} \Big) 
	\end{align}

作未知函数的代换

.. math::
	\begin{align}
	u(t,r) = e^{\alpha (r)}v(t,r)
	\end{align}

其中 :math:`\alpha(r)` 待定，目的是消去一阶导数项。代入 :math:`u` 的方程，得到 :math:`v` 的方程

.. math::
	\begin{align}
	\frac{\partial ^{2}v}{\partial t^{2}} = a^{2}\Big\{ \frac{\partial ^{2}v}{\partial r^{2}} + \Big[ 2\alpha '(r) + \frac{2}{r} \Big]\frac{\partial v}{\partial r} + \Big[ \alpha ''(r) + \alpha '(r)^{2} + \frac{2}{r}\alpha (r) \Big] v \Big\} 
	\end{align}

当 :math:`\alpha(r)=-\ln r` ，即 :math:`v=ru` 时，则为一维波动方程

.. math::
	\begin{align}
	\frac{\partial ^{2}v}{\partial t^{2}} = a^{2}\frac{\partial ^{2}v}{\partial r^{2}}  
	\end{align}

由一维波动方程的通解得到三维波动方程的球面对称解为

.. math::
	\begin{align}
	u(t,r) = \frac{1}{r}[f(r-at) + g(r+at)] 
	\end{align}

其中 :math:`f(r-at)` 为发散波， :math:`g(r+at)` 为会聚波， :math:`\frac{1}{r}` 为波形的衰减或扩张因子。利用一端固定半无界弦的自由振动的结果，可以得到该初值问题的解为

.. math::
	\begin{align}
	u(t,r) = \left\{
	\begin{array}{l}
	\frac{1}{2r}\big[ (r+at)\varphi(r+at) + (r-at)\varphi(r-at) \big] + \frac{1}{2ar}\int_{r-at}^{r+at}\xi\psi(\xi)\mathrm{d}\xi, \quad t\le \frac{r}{a} \\
	\frac{1}{2r}\big[ (r+at)\varphi(r+at) - (at-r)\varphi(at-r) \big] + \frac{1}{2ar}\int_{at-r}^{r+at}\xi\psi(\xi)\mathrm{d}\xi, \quad t> \frac{r}{a}
	\end{array}\right.
	\end{align}




二阶线性偏微分方程的分类和标准式
-----------------------------------

在前面导出的波动方程、扩散方程、场位方程和Poisson方程都是 **二阶线性偏微分方程** 。一般地， :math:`n` 个自变量的二阶线性偏微分方程可以表示为

.. math::
	\begin{align}
	\sum_{i,j=1}^{n}a_{ij}(x_{1},\cdots,x_{n}) \frac{\partial ^{2}u}{\partial x_{i}\partial x_{j}} 
	+ \sum_{j=1}^{n} b_{j}(x_{1}, \cdots, x_{n}) \frac{\partial u}{\partial x_{j}}
	+ c(x_{1},\cdots,x_{n}) u
	= f(x_{1},\cdots, x_{n})
	\end{align}

当系数 :math:`a_{ij},b_{j},c` 均为常数时，称为 **常系数线性偏微分方程** ，否则称为 **变系数线性偏微分方程** ，且总可以假定 :math:`a_{ij} = a_{ji}` 。方程中不含未知函数的项 :math:`f(x_{1},\cdots,x_{n})` 称为 **非齐次项** ，当 :math:`f \equiv 0` 时方程为 **二阶齐次线性偏微分方程** ，否则为非齐次的。


特征方程和特征线
^^^^^^^^^^^^^^^^^^^

两个自变量的二阶齐次线性偏微分方程为

.. math::
	\begin{align}
	a_{11}\frac{\partial ^{2}u}{\partial x^{2}}
	+ 2a_{12}\frac{\partial ^{2}u}{\partial x\partial y}
	+ a_{22}\frac{\partial ^{2}u}{\partial y^{2}}
	+ b_{1}\frac{\partial u}{\partial x}
	+ b_{2}\frac{\partial u}{\partial y}
	+ cu
	= 0
	\end{align}

其中 :math:`a_{11},a_{12},a_{22}` 不同时为 :math:`0` 。进行一个自变量的变量代换：

.. math::
	\begin{align}
	\xi = \varphi(x,y) ,\quad 
	\eta = \psi(x,y)
	\end{align}

其中函数 :math:`\varphi,\psi` 有二阶连续偏导，其Jacobi行列式满足

.. math::
	\begin{align}
	J = \frac{\partial (\varphi, \psi)}{\partial (x, y)} = 
	\begin{vmatrix}
	\frac{\partial \varphi}{\partial x} & \frac{\partial \varphi}{\partial y} \\
	\frac{\partial \psi}{\partial x} & \frac{\partial \psi}{\partial y}    
	\end{vmatrix} 
	\ne 0
	\end{align}

以保证函数 :math:`\varphi, \psi` 相互独立，有反函数存在。未知函数 :math:`u` 则可记为 :math:`u(\xi,\eta)` 。利用复合函数求导的链式法则，可以将原本的二阶齐次线性偏微分方程重新表示成

.. math::
	\begin{align}
	A_{11}\frac{\partial ^{2}u}{\partial \xi^{2}}
	+ 2A_{12}\frac{\partial ^{2}u}{\partial \xi\partial \eta}
	+ A_{22}\frac{\partial ^{2}u}{\partial \eta}
	+ B_{1}\frac{\partial u}{\partial \xi}
	+ B_{2}\frac{\partial u}{\partial \eta}
	+ Cu
	= 0
	\end{align}

其中各系数的具体表达式分别为

.. math::
	\begin{align}
	& A_{11} = a_{11}\Big(\frac{\partial \varphi}{\partial x}\Big)^{2}
	+ 2a_{12}\frac{\partial \varphi}{\partial x}\frac{\partial \varphi}{\partial y}
	+ a_{22}\Big(\frac{\partial \varphi}{\partial y} \Big)^{2} \\
	& A_{12} = a_{11}\frac{\partial \varphi}{\partial x}\frac{\partial \psi}{\partial x}
	+ a_{12}\Big( \frac{\partial \varphi}{\partial x}\frac{\partial \psi}{\partial y} + \frac{\partial \varphi}{\partial y}\frac{\partial \psi}{\partial x}\Big)
	+ a_{22}\frac{\partial \varphi}{\partial y}\frac{\partial \psi}{\partial y} \\
	& A_{22} = a_{11}\Big( \frac{\partial \psi}{\partial x}\Big)^{2}
	+ 2a_{12}\frac{\partial \psi}{\partial x}\frac{\partial \psi}{\partial y}
	+ a_{22}\Big( \frac{\partial \psi}{\partial y}\Big)^{2} \\
	& B_{1} = a_{11}\frac{\partial ^{2}\varphi}{\partial x^{2}}
	+ 2a_{12}\frac{\partial^{2}\varphi}{\partial x\partial y}
	+ a_{22}\frac{\partial^{2}\varphi}{\partial y^{2}}
	+ b_{1}\frac{\partial \varphi}{\partial x}
	+ b_{2}\frac{\partial \varphi}{\partial y} \\
	& B_{2} = a_{11}\frac{\partial^{2}\psi}{\partial x^{2}}
	+ 2a_{12}\frac{\partial^{2}\varphi}{\partial x\partial y}
	+ a_{22}\frac{\partial^{2} \psi}{\partial y^{2}}
	+ b_{1}\frac{\partial \psi}{\partial x}
	+ b_{2}\frac{\partial \psi}{\partial y} \\
	& C = c\big(x(\xi,\eta), y(\xi,\eta)\big)
	\end{align}

可以用矩阵的形式来进行表示：

.. math::
	\begin{align}
	D = 
	\begin{bmatrix}
	A_{11} & A_{12} \\
	A_{21} & A_{22}
	\end{bmatrix}
	=
	\begin{bmatrix}
	\frac{\partial \xi}{\partial x} & \frac{\partial \xi}{\partial y} \\
	\frac{\partial \eta}{\partial y} & \frac{\partial \eta}{\partial y}    
	\end{bmatrix}
	\begin{bmatrix}
	a_{11} & a_{12} \\
	a_{21} & a_{22}
	\end{bmatrix}
	\begin{bmatrix}
	\frac{\partial \xi}{\partial x} & \frac{\partial \xi}{\partial y} \\
	\frac{\partial \eta}{\partial y} & \frac{\partial \eta}{\partial y}    
	\end{bmatrix}^{T}
	\end{align}


为了化简方程中的二阶偏导数部分，由上面的系数表达式可知，如果选取 :math:`\varphi(x,y)` 或 :math:`\psi(x,y)` 是一阶非线性偏微分方程：

.. math::
	\begin{align}
	a_{11}\Big( \frac{\partial z}{\partial x}\Big)^{2}
	+ 2a_{12}\frac{\partial z}{\partial x} \frac{\partial z}{\partial y}
	+ a_{22} \Big( \frac{\partial z}{\partial y} \Big)^{2}
	= 0
	\end{align}

的解，则新方程中 :math:`A_{11}` 与 :math:`A_{22}` 至少有一个为 :math:`0` ，从而实现方程的化简。对上面这个一阶偏微分方程的求解，可以归结为一阶常微分方程：

.. math::
	\begin{align}
	a_{11}(\mathrm{d}y)^{2}
	- 2a_{12}\mathrm{d}x \mathrm{d}y
	+ a_{22}(\mathrm{d}x)^{2}
	= 0  
	\end{align}

的求解。存在定理：如果 :math:`\varphi(x,y)=h` 是上述常微分方程的隐式通解（积分曲线族），则 :math:`z=\varphi(x,y)` 是偏微分方程的解。该定理的逆命题也成立。根据该定理，上述常微分方程可以称为二阶线性偏微分方程的 **特征方程** ，称特征方程的积分曲线为二阶线性偏微分方程的 **特征曲线** 。



方程的分类、化简和标准形
^^^^^^^^^^^^^^^^^^^^^^^^^^


二阶齐次线性偏微分方程二阶偏导部分系数的行列式满足

.. math::
	\begin{align}
	& \Delta _{A} := -
	\begin{vmatrix}
	A_{11} & A_{12} \\
	A_{12} & A_{22}
	\end{vmatrix}
	= A_{12}^{2} - A_{11}A_{22}
	= J^{2} \Delta \\
	& \Delta := -
	\begin{vmatrix}
	a_{11} & a_{12} \\
	a_{21} & a_{22}
	\end{vmatrix}
	= a_{12}^{2} - a_{11}a_{22}
	\end{align}

特征方程的解取决于它的判别式：

.. math::
	\begin{align}
	\Delta := -
		\begin{vmatrix}
		a_{11} & a_{12} \\
		a_{21} & a_{22}
		\end{vmatrix}
		= a_{12}^{2} - a_{11}a_{22}
	\end{align}


在可逆自变量变换下（即当Jacobi行列式不等于零时）， :math:`\Delta` 的符号是一个不变量，于是 :math:`\Delta` 称作 **二阶线性偏微分方程的判别式** ：

1. 若在 :math:`(x_{0},y_{0})` 处 :math:`\Delta > 0` ，则称二阶线性偏微分方程在点 :math:`(x_{0},y_{0})` 处为双曲型的；
2. 若在 :math:`(x_{0},y_{0})` 处 :math:`\Delta = 0` ，则称二阶线性偏微分方程在点 :math:`(x_{0},y_{0})` 处为抛物型的；
3. 若在 :math:`(x_{0},y_{0})` 处 :math:`\Delta < 0` ，则称二阶线性偏微分方程在点 :math:`(x_{0},y_{0})` 处为椭圆形的。


当 :math:`\Delta > 0` 时，特征方程可以分解为两个一阶常微分方程。不妨假设 :math:`a_{11} \ne 0` ，此时有

.. math::
	\begin{align}
	\frac{\mathrm{d}y}{\mathrm{d}x} = \frac{a_{12} + \sqrt{\Delta}}{a_{11}}
	,\qquad 
	\frac{\mathrm{d}y}{\mathrm{d}x} = \frac{a_{12} - \sqrt{\Delta}}{a_{11}}    
	\end{align}

从中解得两族特征线 :math:`\varphi(x,y) = h_{1}` 和 :math:`\psi(x,y) = h_{2}` 。如果令 :math:`\xi = \varphi(x,y)` ， :math:`\eta = \psi(x,y)` ，由定理可知此时 :math:`A_{11} = A_{22} = 0` ，从而进行了变量代换后的二阶线性齐次偏微分方程就有简单形式：

.. math::
	\begin{align}
	\frac{\partial ^{2}u}{\partial \xi\partial \eta}
	+ \frac{1}{2A_{12}} (B_{1}\frac{\partial u}{\partial \xi} + B_{2} \frac{\partial u}{\partial \eta} + Cu)
	= 0  
	\end{align}

上式被称为 **双曲型方程的标准形** 。

因为沿着两族特征线分别有

.. math::
	\begin{align}
	\frac{\partial \varphi}{\partial x}\mathrm{d}x 
	+ \frac{\partial \varphi}{\partial y}\mathrm{d}y
	= 0
	,\quad 
	\frac{\partial \psi}{\partial x}\mathrm{d}x
	+ \frac{\partial \psi}{\partial y}\mathrm{d}y
	= 0     
	\end{align}

从而有

.. math::
	\begin{align}
	\frac{\partial \varphi}{\partial x} \Big/ \frac{\partial \varphi}{\partial y}
	= - \frac{a_{12} + \sqrt{\Delta}}{a_{11}}
	,\quad 
	\frac{\partial \psi}{\partial x} \Big/ \frac{\partial \psi}{\partial y}
	= - \frac{a_{12} - \sqrt{\Delta}}{a_{11}}      
	\end{align}

由 :math:`a_{11} \ne 0` 可知 :math:`\frac{\partial \varphi}{\partial y}\ne 0` ， :math:`\frac{\partial \psi}{\partial y} \ne 0` ，进而可以得到

.. math::
	\begin{align}
	J = 
	\begin{vmatrix}
	\frac{\partial \varphi}{\partial x} & \frac{\partial \varphi}{\partial y} \\
	\frac{\partial \psi}{\partial x} & \frac{\partial \psi}{\partial y}    
	\end{vmatrix}
	= \frac{\partial \varphi}{\partial x}\frac{\partial \psi}{\partial y}
	- \frac{\partial \psi}{\partial x}\frac{\partial \varphi}{\partial y}
	= \frac{\partial \varphi}{\partial y}\frac{\partial \psi}{\partial y}\Big( \frac{\partial \varphi}{\partial x} \Big/ \frac{\partial \varphi}{\partial y} - \frac{\partial \psi}{\partial x} \Big/ \frac{\partial \psi}{\partial y} \Big)
	= \frac{\partial \varphi}{\partial y}\frac{\partial \psi}{\partial y}\frac{-2\sqrt{\Delta}}{a_{11}} 
	\ne 0
	\end{align}

因此 :math:`\xi, \eta` 是两个独立的变量。

如果再对上述的标准形方程作变量代换：

.. math::
	\begin{align}
	s = \frac{1}{2}(\xi + \eta)
	,\quad 
	t = \frac{1}{2}(\xi - \eta)  
	\end{align}

从而可以得到方程

.. math::
	\begin{align}
	\frac{\partial^{2}u}{\partial t^{2}}
	- \frac{\partial^{2}u}{\partial s^{2}}
	+ \frac{1}{\tilde{A}_{11}}\Big( \tilde{B}_{1}\frac{\partial u}{\partial t} + \tilde{B}_{2}\frac{\partial u}{\partial s} + \tilde{C}u\Big)
	= 0
	\end{align}

上式同样也被称为 **双曲型方程的标准形** 。



当 :math:`\Delta = 0` 时，由特征方程只能得到一个一阶线性常微分方程。不妨假设 :math:`a_{11} \ne 0` ，则该一阶线性常微分方程为

.. math::
	\begin{align}
	\frac{\mathrm{d} y}{\mathrm{d} x} = \frac{a_{12}}{a_{11}}  
	\end{align}

解得一族特征曲线 :math:`\varphi(x,y) = h` 。任取二元函数 :math:`\psi(x,y)` ，使得 :math:`J = \frac{\partial (\varphi, \psi)}{\partial (x, y)} \ne 0` 。作变量代换

.. math::
	\begin{align}
	\xi = \varphi(x,y)
	,\quad 
	\eta = \psi(x,y) 
	\end{align}

可以得到 :math:`A_{11} = 0` ， :math:`A_{22} \ne 0` 。因为 :math:`a_{12}^{2} = a_{11}a_{22}` ， :math:`\frac{\partial \varphi}{\partial x}\Big/ \frac{\partial \varphi}{\partial y} = -\frac{a_{22}}{a_{11}}` ，从而根据二阶偏导项系数的表达式可得

.. math::
	\begin{align}
	A_{12} = \frac{1}{a_{11}}
	\Big( a_{11}\frac{\partial \varphi}{\partial x} + a_{12}\frac{\partial \varphi}{\partial y} \Big)
	\Big( a_{11}\frac{\partial \psi}{\partial x} + a_{12}\frac{\partial \psi}{\partial y} \Big)
	= 0
	\end{align}

于是，进行了变量代换后的二阶线性齐次偏微分方程就有简单形式：

.. math::
	\begin{align}
	\frac{\partial^{2}u}{\partial \eta^{2}}
	+ \frac{1}{A_{22}} \Big( B_{1}\frac{\partial u}{\partial \xi} + B_{2}\frac{\partial u}{\partial \eta} + Cu \Big)
	= 0
	\end{align}

上式称为 **抛物型方程的标准形** 。



当 :math:`\Delta < 0` ，特征方程只能在复数域内分解成两个一阶方程。不妨设 :math:`a_{11} \ne 0` ，相应的一阶方程为

.. math::
	\begin{align}
	\frac{\mathrm{d} y}{\mathrm{d} x}
	= \frac{a_{12} + \mathrm{i}\sqrt{-\Delta}}{a_{11}}
	,\quad 
	\frac{\mathrm{d} y}{\mathrm{d} x}
	= \frac{a_{12} - \mathrm{i}\sqrt{-\Delta}}{a_{11}}    
	\end{align}

此时不存在实特征线，特征方程的隐式通解为

.. math::
	\begin{align}
	& G(x,y) = \varphi(x,y) + \mathrm{i}\psi(x,y) = h_{1} \\
	& \overline{G}(x,y) = \varphi(x,y) - \mathrm{i}\psi(x,y) = h_{2} 
	\end{align}

作变量代换 :math:`\xi = \varphi(x,y)` ， :math:`\eta = \psi(x,y)` 。根据特征线可以得到

.. math::
	\begin{align}
	- \frac{\partial G}{\partial x} \Big/ \frac{\partial G}{\partial y}
	= \frac{\mathrm{d}y}{\mathrm{d} x}
	= \frac{a_{12} + \mathrm{i}\sqrt{-\Delta}}{a_{11}}
	\quad \Rightarrow \quad 
	a_{11}\frac{\partial G}{\partial x}
	= - (a_{12} + \mathrm{i}\sqrt{- \Delta}) \frac{\partial G}{\partial y} 
	\quad \Rightarrow \quad 
	a_{11}\Big( \frac{\varphi}{\partial x} + \mathrm{i}\frac{\psi}{\partial x} \Big)
	= - (a_{12} + \mathrm{i}\sqrt{-\Delta}) \Big( \frac{\varphi}{\partial y} + \mathrm{i}\frac{\psi}{\partial y}  \Big) 
	\end{align}

分别取实部和虚部得到

.. math::
	\begin{align}
	\frac{\partial \varphi}{\partial x}
	= \frac{-1}{a_{11}} \Big(a_{12}\frac{\partial \varphi}{\partial y} - \sqrt{-\Delta}\frac{\partial \psi}{\partial y}\Big)
	,\quad 
	\frac{\partial \psi}{\partial x}
	= \frac{-1}{a_{11}} \Big( \sqrt{-\Delta}\frac{\partial \varphi}{\partial y} + a_{12}\frac{\partial \psi}{\partial y}\Big)  
	\end{align}

从而Jacobi行列式满足

.. math::
	\begin{align}
	J = 
	\begin{vmatrix}
	\frac{\partial \varphi}{\partial x} & \frac{\partial \varphi}{\partial y} \\
	\frac{\partial \psi}{\partial x} & \frac{\partial \psi}{\partial y}    
	\end{vmatrix}
	= \frac{\partial \varphi}{\partial x}\frac{\psi}{\partial y}
	- \frac{\partial \psi}{\partial x}\frac{\partial \varphi}{\partial y}
	= \frac{\sqrt{-\Delta}}{a_{11}}\Big( (\frac{\partial \varphi}{\partial y})^{2} + (\frac{\partial \psi}{\partial y})^{2}\Big)
	\ne 0
	\end{align}


.. note:: 

	如果 :math:`\frac{\sqrt{-\Delta}}{a_{11}}\Big( (\frac{\partial \varphi}{\partial y})^{2} + (\frac{\partial \psi}{\partial y})^{2}\Big) = 0` ，则会有 :math:`\frac{\partial \varphi}{\partial y} = \frac{\partial \psi}{\partial y} = 0` ，进而推导出 :math:`\frac{\partial \varphi}{\partial x} = \frac{\partial \psi}{\partial x} = 0` ，从而得到 :math:`\frac{\partial G}{\partial x} = \frac{\partial G}{\partial y} = 0` 。但是 :math:`a_{11}\ne 0` 决定了 :math:`\frac{\partial G}{\partial y} \ne 0` ，产生矛盾。


注意到 :math:`G(x,y)` 满足

.. math::
	\begin{align}
	a_{11}(\frac{\partial G}{\partial x})^{2}
	+ 2a_{12} \frac{\partial G}{\partial x}\frac{\partial G}{\partial y}
	+ a_{22} (\frac{\partial G}{\partial y})^{2}
	= 0 
	\quad \Rightarrow \quad
	a_{11}\Big( \frac{\partial \varphi}{\partial x} + \mathrm{i}\frac{\partial \psi}{\partial x} \Big)^{2}
	+ 2a_{12} \Big( \frac{\partial \varphi}{\partial x} + \mathrm{i}\frac{\partial \psi}{\partial x}\Big) \Big( \frac{\partial \varphi}{\partial y} + \mathrm{i}\frac{\partial \psi}{\partial y} \Big)
	+ a_{22} \Big( \frac{\partial \varphi}{\partial y} + \mathrm{i}\frac{\partial \psi}{\partial y}\Big)^{2}
	= 0
	\end{align}

分别取其实部和虚部则得到

.. math::
	\begin{align}
	& a_{11}(\frac{\partial \varphi}{\partial x})^{2}
	+ 2a_{12}\frac{\partial \varphi}{\partial x}\frac{\partial \varphi}{\partial y}
	+ a_{22}(\frac{\partial \varphi}{\partial y})^{2}
	- a_{11}(\frac{\partial \psi}{\partial x})^{2}
	- 2a_{12}\frac{\partial \psi}{\partial x}\frac{\partial \psi}{\partial y}
	+ a_{22}(\frac{\partial \psi}{\partial y})^{2}
	= 0 \\
	& 2a_{11}\frac{\partial \varphi}{\partial x}\frac{\partial \psi}{\partial x}
	+ 2a_{12}\Big( \frac{\partial \varphi}{\partial x}\frac{\partial \psi}{\partial y} + \frac{\partial \varphi}{\partial y}\frac{\partial \psi}{\partial x}\Big)
	+ 2a_{22}\frac{\partial \varphi}{\partial y}\frac{\partial \psi}{\partial y}
	= 0  
	\end{align}

据此可以得到 :math:`A_{12} = 0` ， :math:`A_{11} = A_{22} \ne 0` ，于是进行了变量代换后的二阶线性齐次偏微分方程就有简单形式：

.. math::
	\begin{align}
	\frac{\partial^{2}u}{\partial \xi^{2}}
	+ \frac{\partial^{2}u}{\partial \eta^{2}}
	+ \frac{1}{A_{11}} \Big( B_{1}\frac{\partial u}{\partial \xi} + B_{2}\frac{\partial u}{\partial \eta} + Cu \Big)
	= 0
	\end{align}

上式称为 **椭圆型方程的标准形** 。




叠加原理和齐次化原理
-----------------------

线性叠加原理
^^^^^^^^^^^^^^

考虑一个 :math:`n` 自变量的二阶线性偏微分方程

.. math::
	\begin{align}
	\sum_{i,j=1}^{n}a_{ij}\frac{\partial ^{2}u}{\partial x_{i}\partial x_{j}}
	+ \sum_{j=1}^{n}b_{j}\frac{\partial u}{\partial x_{j}}
	+ cu
	= f  
	\end{align}

引入偏微分算子

.. math::
	\begin{align}
	L = \sum_{i,j=1}^{n}a_{ij}\frac{\partial ^{2}}{\partial x_{i}\partial x_{j}}
	+ \sum_{j=1}^{n}b_{j}\frac{\partial}{\partial x_{j}}
	+ c
	\end{align}

于是上述二阶线性偏微分方程可以简单表示为

.. math::
	\begin{align}
	Lu(\mathbf{x}) = f(\mathbf{x}) ,\quad 
	\mathbf{x} = (x_{1},x_{2},\cdots,x_{n})
	\end{align}



由线性算子的定义，我们有 **叠加原理** ：设 :math:`L` 是关于 :math:`\mathbf{x}=(x_{1},x_{2},\cdots,x_{n})` 的任意阶线性微分算子（常或偏），则有

1. **有限叠加原理** ：如果 :math:`u_{j}(\mathbf{x})` 满足 :math:`Lu_{j}(\mathbf{x}) = f_{j}(\mathbf{x})\quad (j=1,2,\cdots,m)` ，则当 :math:`u(\mathbf{x}) = \sum\limits_{j=1}^{m}\lambda_{j}u_{j}(\mathbf{x})` 时，有 :math:`Lu(\mathbf{x}) = \sum\limits_{j=1}^{m}\lambda_{j}f_{i}(\mathbf{x})\quad (\lambda_{j}\in \Lambda, j=1,2,\cdots,m)` 。
2. **级数叠加原理** ：如果 :math:`u_{j}(\mathbf{x})` 满足 :math:`Lu_{j}(\mathbf{x}) = f_{j}(\mathbf{x})\quad (j=1,2,\cdots)` ，则当 :math:`u(\mathbf{x}) = \sum\limits_{j=1}^{\infty}\lambda_{j}u_{j}(\mathbf{x})` 时，有 :math:`Lu(\mathbf{x}) = \sum\limits_{j=1}^{\infty}\lambda_{j}f_{i}(\mathbf{x})\quad (\lambda_{j}\in \Lambda, j=1,2,\cdots)` 。
3. **积分叠加原理** ：如果 :math:`u(\mathbf{x};\boldsymbol{\xi})` 满足 :math:`Lu(\mathbf{x};\boldsymbol{\xi}) = f(\mathbf{x};\boldsymbol{\xi}), \quad \boldsymbol{\xi}\in V` ，则当 :math:`U(\mathbf{x}) = \int_{V}\lambda(\boldsymbol{\xi})u(\mathbf{x};\boldsymbol{\xi})\mathrm{d}\boldsymbol{\xi}` 时，有 :math:`LU(\mathbf{x}) = \int_{V}\lambda(\boldsymbol{\xi})f(\mathbf{x};\boldsymbol{\xi})\mathrm{d}\boldsymbol{\xi}, \quad \lambda(\boldsymbol{\xi})\in \Lambda, \boldsymbol{\xi}\in V` 。
   



齐次化原理（冲量原理）
^^^^^^^^^^^^^^^^^^^^^^^^


设 :math:`L` 是关于 :math:`t` 与 :math:`\mathbf{x} = (x_{1},x_{2},\cdots,x_{n})` 中各分量的线性偏微分算子，其中关于 :math:`t` 的最高阶导数不超过 :math:`m-1` 阶。如果 :math:`w(t,\mathbf{x};\tau)` 满足齐次方程初值问题

.. math::
	\begin{align}
	& \frac{\partial ^{m}w}{\partial t^{m}} = Lw ,\quad t>\tau>0, \mathbf{x}\in\mathbb{R}^{n}, \\
	& w\Big|_{t=\tau} = \frac{\partial w}{\partial t}\bigg|_{t=\tau} = \cdots = \frac{\partial^{m-2}w}{\partial t^{m-2}}\bigg|_{t=\tau} = 0, \\
	& \frac{\partial^{m-1}w}{\partial t^{m-1}}\bigg|_{t=\tau} = f(\tau, \mathbf{x})   
	\end{align}

则

.. math::
	\begin{align}
	u(t,\mathbf{x}) = \int_{0}^{t}w(t,\mathbf{x}; \tau)~\mathrm{d}\tau 
	\end{align}

是非齐次方程初值问题

.. math::
	\begin{align}
	& \frac{\partial ^{m}u}{\partial t^{m}} = Lu + f(t,\mathbf{x}) ,\quad t>0, \mathbf{x}\in\mathbb{R}^{n}, \\
	& u\Big|_{t=0} = \frac{\partial u}{\partial t}\bigg|_{t=0} = \cdots = \frac{\partial^{m-1}u}{\partial t^{m-1}}\bigg|_{t=0} = 0
	\end{align}

的解。





分离变量法
=============

两端固定弦的自由振动
-----------------------

选弦在张力作用下的平衡位置为 :math:`x` 轴，弦上各质点的横向位移 :math:`u(t,x)` 满足弦振动方程的混合问题：

.. math::
	\begin{align}
	& \frac{\partial^{2}u}{\partial t^{2}} = a^{2} \frac{\partial^{2}u}{\partial x^{2}}
	,\quad t > 0, 0<x<l \\
	& u\Big|_{x=0} = u\Big|_{x=l} = 0 \\
	& u\Big|_{t=0} = \varphi(x), \frac{\partial u}{\partial t}\Big|_{t=0} = \psi(x) 
	\end{align}


.. note:: 根据前面的知识，一个自然的想法是通过通解来求特解。将初始条件奇延拓至 :math:`[-l,0)` ，再以 :math:`2l` 为周期，周期开拓至 :math:`-infty < x < +\infty` ，便可以使用d'Alembert公式求解。

上面的第一行方程称为泛定方程，第二行式子称为齐次边界条件，第三行式子称为初始条件。现在我们从简谐波的角度考虑：简谐波前行遇到固定端点反射回来成为同频率的反向波，与原来的波叠加成为驻波，此时不同点的振动同步，不同的仅仅是振幅，因此驻波可以表示为 :math:`u(t,x)=T(t)X(x)` ，这就是一种变量分离形状的解。我们首先来求解满足泛定方程和齐次边界条件的变量分离形状的特解（ **驻波解** ）。

设 :math:`u(t,x) = T(t)X(x)` ，代入泛定方程，两边同时除以 :math:`a^{2}u` ，得到

.. math::
	\begin{align}
	\frac{T''(t)}{a^{2}T(t)} = \frac{X''(x)}{X(x)}  
	\end{align}

上式的左边与 :math:`x` 无关，右边与 :math:`t` 无关，故左右两边只能是个常数，记为 :math:`-\lambda` ，分别得到 :math:`T(t)` 和 :math:`X(x)` 满足的常微分方程

.. math::
	\begin{align}
	X''(x) + \lambda X(x) = 0
	,\quad
	T''(t) + \lambda a^{2}T(t) = 0
	\end{align}

再将 :math:`u(t,x)=T(t)X(x)` 代入齐次边界条件，得到

.. math::
	\begin{align}
	T(t)X(0) = T(t)X(l) = 0
	\end{align}

显然 :math:`T(t) \ne 0` ，所以一定有

.. math::
	\begin{align}
	X(0) = X(l) = 0
	\end{align}

至此，通过寻找变量分离形状的特解，原本偏微分方程的定解问题划归为常微分方程的边值问题（ **特征值问题** ）：

.. math::
	\begin{align}
	& X''(x) + \lambda X(x) = 0
	,\quad 0<x<l \\
	& X(0) = X(l) = 0
	\end{align}

1. 当 :math:`\lambda = -\omega^{2} < 0~(\omega>0)` 时，上述方程有通解

.. math::
	\begin{align}
	X(x) = Ae^{\omega x} + Be^{-\omega x}
	\end{align}

代入边界条件可以得到

.. math::
	\begin{align}
	X(0) = A+B = 0
	,\quad 
	X(l) = Ae^{\omega l} + Be^{-\omega l} = 0
	\end{align}

于是可知 :math:`A=B=0` ，因此该边值问题没有非零解。

2. 当 :math:`\lambda = 0` 时，方程的通解为

.. math::
	\begin{align}
	X(x) = Ax + B
	\end{align}

代入边界条件有 :math:`X(0)=B=0` ， :math:`X(l)=Al=0` ，于是可知该边值问题仍然没有非零解。

3. 当 :math:`\lambda = \omega^{2}>0~(\omega > 0)` 时，方程有通解
   
.. math::
	\begin{align}
	X(x) = A\cos\omega x + B\sin\omega x
	\end{align}

代入边界条件有

.. math::
	\begin{align}
	X(0)=A=0
	,\quad 
	X(l) = B\sin\omega l = 0
	\end{align}

当且仅当 :math:`\omega = \frac{n\pi}{l}(n=1,2,\cdots)` 时，该边值问题有非零解 :math:`X_{n}(x) = B\sin\frac{n\pi}{l}x` 。将使得特征值问题有非零解的 :math:`\lambda` 的取值称为 **特征值** ，相应的非零解称为 **特征函数** 。


.. note:: 这里出现的情况很像矩阵的特征值问题 :math:`Ax=\lambda x` 。当且仅当 :math:`\lambda` 为某些特殊值时，该线性方程组有非零解，其中 :math:`A` 为 :math:`n\times n` 矩阵， :math:`x` 为 :math:`n` 维向量， :math:`\lambda` 为参数。


在上面的过程中，我们求出了特征值问题的特征值：

.. math::
	\begin{align}
	\lambda _{n} = \Big( \frac{n\pi}{l} \Big)^{2}
	,\quad 
	n = 1,2,\cdots
	\end{align}

相应的特征函数为

.. math::
	\begin{align}
	X_{n}(x) = \sin\frac{n\pi}{l}x 
	\end{align}

因为 :math:`B` 取不同值时的解相互线性相关，不妨设 :math:`B=1` 。

对于每一个特征值 :math:`\lambda_{n}` ，求解相应的 :math:`T_{n}(t)` 方程： :math:`T''(t) + \lambda a^{2}T(t) = 0` ，得到通解为

.. math::
	\begin{align}
	T_{n}(t) = C_{n}\cos\frac{an\pi}{l}t + D_{n}\sin\frac{an\pi}{l}t  
	\end{align}

从而得到一族变量分离形状的特解：

.. math::
	\begin{align}
	u_{n}(t,x) = \Big( C_{n}\cos\frac{an\pi}{l}t + D_{n}\sin\frac{an\pi}{l}t \Big)\sin\frac{n\pi}{l}x
	= \alpha_{n}\sin\frac{n\pi}{l}x \sin\Big( \frac{an\pi}{l}t + \theta_{n} \Big) 
	,\quad n=1,2,\cdots
	\end{align}

其中 :math:`\alpha_{n}=\sqrt{C_{n}^{2} + D_{n}^{2}}` ， :math:`\theta_{n} = \arcsin\frac{C_{n}}{\alpha_{n}}` 。

但是，虽然每个变量分离解 :math:`u_{n}(t,x)` 满足了泛定方程和齐次边界条件，但是却不一定满足初始条件。根据叠加原理，将所有的 :math:`u_{n}(t,x)` 线性叠加起来仍然满足泛定方程和齐次边界条件，通过选取合适的系数，则有可能使得叠加后的解同时满足初始条件，即

.. math::
	\begin{align}
	u(t,x) = \sum_{n=1}^{+\infty}\Big( C_{n}\cos\frac{an\pi}{l}t + D_{n}\sin\frac{an\pi}{l}t \Big)\sin\frac{n\pi}{l}x 
	\end{align}

将上式代入初始初始条件，得到

.. math::
	\begin{align}
	& u\Big|_{t=0} = \sum_{n=1}^{+\infty}C_{n}\sin\frac{n\pi}{l}x := \varphi(x) \\
	& \frac{\partial u}{\partial t}\bigg|_{t=0} = \sum_{n=1}^{+\infty}\frac{an\pi}{l}D_{n}\sin\frac{n\pi}{l}x := \psi(x)   
	\end{align}

上面两个式子正好是已知函数 :math:`\varphi(x)` ， :math:`\psi(x)` 在区间 :math:`[0,l]` 的Fourier正弦展开，由正弦展开的系数公式，可以确定

.. math::
	\begin{align}
	C_{n} = \frac{2}{l}\int_{0}^{l}\varphi(x)\sin\frac{n\pi}{l}x~\mathrm{d}x
	,\quad 
	D_{n} = \frac{2}{an\pi}\int_{0}^{l}\psi(x)\sin\frac{n\pi}{l}x~\mathrm{d}x    
	\end{align}

如此就得到了混合问题的形式解：

.. math::
	\begin{align}
	u(t,x) = \sum_{n=1}^{+\infty} \Big( \frac{2}{l}\int_{0}^{l}\varphi(\xi)\sin\frac{n\pi}{l}\xi~\mathrm{d}\xi \cos\frac{an\pi}{l}t + \frac{2}{an\pi}\int_{0}^{l}\psi(\xi) \sin\frac{n\pi}{l}\xi~\mathrm{d}\xi \sin\frac{an\pi}{l}t \Big) \sin \frac{n\pi}{l}x 
	\end{align}


.. note:: 

	从数学上可以证明，当 :math:`\varphi(x),\psi(x)` 为 :math:`[0,l]` 上足够光滑的函数，比如 :math:`\varphi \in C^{3}[0,l]` ， :math:`\psi \in C^{2}[0,l]` ，并且 :math:`\varphi, \varphi''` 和 :math:`\psi` 在端点为 :math:`0` 时，上式右端的级数收敛，并且可以逐项求导两次，从而保证了上式的确是混合问题的古典解。同时还可以利用能量积分证明混合问题的解是唯一的、稳定的。


有限长杆的热传导
-------------------

考虑热传导方程：

.. math::
	\begin{align}
	& \frac{\partial u}{\partial t} = a^{2}\frac{\partial ^{2}u}{\partial x^{2}} ,\quad 0<x<L,~t>0 \\
	& u(0,t) = 0, \quad \frac{\partial u}{\partial x}(L,t) + hu(L,t) = 0, \quad t>0 \\
	& u(x,0) = \varphi(x) ,\quad 0\le x \le L   
	\end{align}

其中 :math:`h>0` 为给定的热交换常数。考虑形式为 :math:`u(x,t)=X(x)T(t)` 的形式解，代入方程得到

.. math::
	\begin{align}
	\frac{X''(x)}{X(x)} = \frac{T'(t)}{a^{2}T(t)} = -\lambda   
	\end{align}

其中 :math:`\lambda` 为待定常数。根据边界条件有

.. math::
	\begin{align}
	X(0) = 0
	,\quad 
	X'(L) + hX(L) = 0
	\end{align}

考虑特征值问题：

.. math::
	\begin{align}
	X'' + \lambda X = 0
	,\quad
	X(0) = 0,~X'(L) + hX(L) = 0
	\end{align}

讨论可知当 :math:`\lambda = \beta^{2} > 0` 时，有

.. math::
	\begin{align}
	\beta\cos\beta L + h\sin\beta L = 0
	\quad \Rightarrow \quad
	\tan\beta L = -\frac{\beta}{h} = -\frac{1}{hL}\beta L  
	\end{align}

上式是关于 :math:`\beta` 的超越方程，理论上可以解出相应的 :math:`\beta_{n}` ，通过图像法交点可以大致找到对应的解：

.. math::
	\begin{align}
	X_{n}(x) = B_{n}\sin\beta_{n}x ,\quad n=1,2,\cdots
	\end{align}

再求解 :math:`T' + \lambda a^{2}T = 0` ，得到

.. math::
	\begin{align}
	T_{n}(t) = E_{n}e^{-\beta_{n}^{2}a^{2}t}
	\end{align}

从而得到满足方程与边界条件的一族解：

.. math::
	\begin{align}
	u_{n}(x,t) = C_{n}e^{-\beta_{n}^{2}a^{2}t} \sin\beta_{n}x \quad (n=1,2,\cdots)
	\end{align}


进而根据叠加原理可以设

.. math::
	\begin{align}
	u(x,t) = \sum_{n=1}^{\infty}u_{n}(x,t) = \sum_{n=1}^{\infty}C_{n}e^{-\beta_{n}^{2}a^{2}t}\sin\beta_{n}x
	\end{align}

代入初始条件有

.. math::
	\begin{align}
	u(x,0) = \varphi(x) := \sum_{n=1}^{\infty}C_{n}\sin\beta_{n}x
	\end{align}

容易验证正交性：

.. math::
	\begin{align}
	\int_{0}^{L}\sin\beta_{m}x\sin\beta_{n}x~\mathrm{d}x = 0 ,\quad m\ne n 
	\end{align}

所以可以确定系数表达式为

.. math::
	\begin{align}
	C_{n} = \frac{1}{\int_{0}^{L}\sin^{2}\beta_{n}x~\mathrm{d}x}\int_{0}^{L}\varphi(x)\sin\beta_{n}~\mathrm{d}x 
	\end{align}


圆柱体稳态温度分布
---------------------

现在有一无限长圆柱体 :math:`x^{2}+y^{2}<a^{2}` ， :math:`-\infty < z < +\infty` ，内部无热源，边界柱面温度保持为 :math:`F(x,y)` ，求柱内稳态温度分布。注意到圆柱的对称形及柱面温度分布与 :math:`z` 无关，可以设柱内温度为 :math:`u(x,y)` ，与 :math:`z` 无关。 :math:`u` 满足二维Laplace方程圆内第一边值问题，也称为Dirichlet问题：

.. math::
	\begin{align}
	& \frac{\partial ^{2}u}{\partial x^{2}} + \frac{\partial ^{2}u}{\partial y^{2}} = 0
	,\quad x^{2} + y^{2} < a^{2} \\
	& u\Big|_{x^{2} + y^{2} = a^{2}} = F(x,y)  
	\end{align}


.. note:: 当 :math:`F(x,y)` 为多项式时可以利用调和多项式求解，而对任意给定的 :math:`F(x,y)` 也可以利用Poisson积分公式求解。

由于求解区域为平面圆域，应该采用极坐标，记温度分布为 :math:`u(r,\theta)` ，极坐标下边值问题改写为

.. math::
	\begin{align}
	& \frac{1}{r}\frac{\partial }{\partial r}\Big( r\frac{\partial u}{\partial r} \Big) + \frac{1}{r^{2}}\frac{\partial ^{2}u}{\partial \theta^{2}} = 0
	,\quad r<a, \\
	& u\Big|_{r=a} = F(a\cos\theta, a\sin\theta) = f(\theta)
	\end{align}

这是 :math:`(r,\theta)` 平面的矩形域 :math:`(0\le r < a, -\infty < \theta < +\infty)` 上的问题，可以进行分离变量。令 :math:`u(r,\theta)=R(r)\Theta(\theta)` ，代入方程并且两边同时除以 :math:`u` ，得到

.. math::
	\begin{align}
	\frac{\frac{1}{r}(rR'(r))'}{R(r)} + \frac{\Theta''(\theta)}{r^{2}\Theta(\theta)} = 0
	\end{align}

可以从中分离出两个常微分方程：

.. math::
	\begin{align}
	\Theta''(\theta) + \lambda \Theta(\theta) = 0
	,\quad 
	\frac{1}{r}(rR'(r))' - \frac{\lambda }{r^{2}}R(r) = 0  
	\end{align}

考虑到 :math:`\Theta(\theta)` 本身蕴含周期条件，于是可以与 :math:`\Theta(\theta)` 的方程构成特征值问题：

.. math::
	\begin{align}
	\Theta''(\theta) + \lambda \Theta(\theta) = 0
	,\quad 
	\Theta(\theta + 2\pi) = \Theta(\theta)
	\end{align}

1. 当 :math:`\lambda = -\omega^{2} < 0` 时，该特征值问题的通解为 :math:`\Theta(\theta) = Ae^{\omega\theta} + Be^{-\omega\theta}` ，没有非零周期解。
2. 当 :math:`\lambda = 0` 时，通解为 :math:`\Theta(\theta) = A + B\theta` ，有周期解 :math:`\Theta_{0}(\theta) \equiv 1` 。
3. 当 :math:`\lambda = \omega^{2} > 0` 时，该特征值问题的通解为 :math:`\Theta(\theta) = A\cos\omega\theta + B\sin\omega\theta` ，当且仅当 :math:`\omega = n~(n=1,2,\cdots)` 时，该通解以 :math:`2\pi` 为周期。 

综上可知，以 :math:`2\pi` 为周期的周期条件下的特征值问题的特征值是

.. math::
	\begin{align}
	\lambda_{n} = n^{2}, \quad n=0,1,2,\cdots
	\end{align}

相应的特征函数为

.. math::
	\begin{align}
	\Theta_{n}(\theta) = A_{n}\cos n\theta + B_{n}\sin n\theta =
	\left \{\begin{array}{c}
	\cos n\theta \\ \sin n\theta
	\end{array}\right \}
	\end{align}


.. attention:: 这里对 :math:`n \ne 0` ，一个特征值对应于两个线性无关的特征函数的现象，物理上称为 **简并现象** 。

当特征值 :math:`\lambda_{n} = n^{2}` ，相应的 :math:`R(r)` 的方程式Euler方程：

.. math::
	\begin{align}
	r^{2}R''(r) + rR'(r) - n^{2}R(r) = 0
	\end{align}

在自变量代换 :math:`r=e^{t}` 下，变为常系数方程：

.. math::
	\begin{align}
	\frac{\mathrm{d}^{2}R}{\mathrm{d}t^{2}} - n^{2}R = 0 
	\end{align}

其通解为

.. math::
	\begin{align}
	& R_{0} = C_{0} + D_{0}t = C_{0} + D_{0}\ln r \\
	& R_{n} = C_{n}e^{nt} + D_{n}e^{-nt} = C_{n}r^{n} + D_{n}r^{-n}, \quad n=1,2,\cdots
	\end{align}


根据问题的物理意义，显然在中心 :math:`r=0` 处要有 **自然边界条件** :math:`|R(0)| < +\infty` ，因此得到

.. math::
	\begin{align}
	D_{0} = D_{n} = 0
	,\quad
	R_{0}(r) = 1
	,\quad 
	R_{n}(r) = r^{n}
	\end{align}

进而得到圆内二维Laplace方程变量分离形状的周期解：

.. math::
	\begin{align}
	u_{0}(r,\theta) = 1
	,\quad
	u_{n}(r,\theta) = \left\{ \begin{array}{c} \cos n\theta \\ \sin n\theta \end{array} \right\} r^{n} ,\quad n=1,2,\cdots
	\end{align}

根据叠加原理可以设出通解：

.. math::
	\begin{align}
	u(r,\theta) = \frac{A_{0}}{2} + \sum_{n=1}^{+\infty}\Big(\frac{r}{a}\Big)^{n}(A_{n}\cos n\theta + B_{n}\sin n\theta)
	\end{align}

将上式代入边界条件得到

.. math::
	\begin{align}
	u(a,\theta) = \frac{A_{0}}{2} + \sum_{n=1}^{+\infty}(A_{n}\cos\theta + B_{n}\sin n\theta)  = f(\theta)
	\end{align}

可以看到上式是 :math:`f(\theta)` 在 :math:`[0,2\pi]` 上的Fourier展开式，所以可以确定通解中的系数表达式：对 :math:`n=0,1,2,\cdots` 都有

.. math::
	\begin{align}
	A_{n} = \frac{1}{\pi}\int_{0}^{2\pi}f(\varphi)\cos n\varphi ~\mathrm{d}\varphi
	,\quad
	B_{n} = \frac{1}{\pi}\int_{0}^{2\pi}f(\varphi)\sin n\varphi ~\mathrm{d}\varphi 
	\end{align}


.. note:: 当 :math:`f(\theta)` 是圆周上的连续函数时，可以直接验证上式给出了Dirchlet问题的古典解。利用调和函数的极值原理，还可以证明Dirichlet问题的解唯一、稳定。




一般格式，特征值问题
-----------------------


一般格式
^^^^^^^^^^^

将分离变量法用于更一般的定解问题：

.. math::
	\begin{align}
	& L_{t}u + L_{x}u = 0 ,\quad t\in I, a<x<b, \\
	& \Big( \alpha_{1}u - \beta_{1}\frac{\partial u}{\partial x} \Big)\Big|_{x=a} = 0
	,\quad \Big( \alpha_{2}u + \beta_{2}\frac{\partial u}{\partial x} \Big)\Big|_{x=b} = 0,\\
	& \text{以及一些关于}~t~\text{的定解条件}  
	\end{align}

其中：

- :math:`L_{t},L_{x}` 分别为关于 :math:`t` 和 :math:`x` 的线性偏微分算子，比如 :math:`L_{t}=a_{0}(t)\frac{\partial^{2}}{\partial t^{2}} + a_{1}(t)\frac{\partial }{\partial t} + a_{2}(t)` ， :math:`L_{x} = b_{0}(x)\frac{\partial^{2}}{\partial x^{2}} + b_{1}(x)\frac{\partial }{\partial x} + b_{2}(x)` 。
- 上面的 :math:`a_{j}(t)(j=0,1,2)` 是有限或半无限区间 :math:`I` 上的连续函数； :math:`b_{j}(x)(j=0,1,2)` 是 :math:`a<x<b` 上的连续函数。
- 边界条件式子中的常数 :math:`\alpha_{j},\beta_{j}` 非负，且 :math:`\alpha_{j}^{2} + \beta_{j}^{2} \ne 0 (j=1,2)` 。
- 关于 :math:`t` 的定解条件可以是初始条件，也可以是边界条件。 

**Step1 分离变量** ：设 :math:`u(t,x)=T(t)X(x)` ，代入齐次方程和齐次边界条件式，分离得到特征值问题

.. math::
	\begin{align}
	& L_{x}X(x) + \lambda X(x) = 0 ,\quad a<x<b, \\
	& \alpha_{1}X(a) - \beta_{1}X'(a) = 0 ,\quad \alpha_{2}X(b) + \beta_{2}X'(b) = 0
	\end{align}

以及常微分方程

.. math::
	\begin{align}
	L_{t}T(t) - \lambda T(t) = 0
	\end{align}


.. note:: 
	
	可以看到，满足 :math:`L_{t}u + L_{x}u = 0` 形式的方程，即使 :math:`L_{t},L_{x}` 为更高阶的微分算子，总可以分离变量得到上述常微分方程，而第一、二、三类齐次边界条件也总可以分离出上述常微分方程的边界条件式。称这类问题为可分离变量的问题。


**Step2 解特征值问题，得到变量分离形状特解** ：根据 :math:`\lambda` 的不同情况，求上述特征值问题的通解，并由其边界条件求出特征值 :math:`\{ \lambda_{n} \}` 以及相应的特征函数 :math:`\{ X_{n}(x) \},n=1,2,\cdots` 。再将特征值 :math:`\lambda_{n}` 代入 :math:`L_{t}T(t) - \lambda T(t) = 0` 求解出相应的通解 :math:`T_{n}(t)` ，从而得到一族变量分离形状的解：

.. math::
	\begin{align}
	\{ u_{n}(t,x) = T_{n}(t)X_{n}(x) \}
	\end{align}


**Step3 叠加定系数** ：令

.. math::
	\begin{align}
	u(t,x) = \sum_{n=1}^{+\infty}C_{n}T_{n}(t)X_{n}(x)
	\end{align}

代入关于 :math:`t` 的初始条件或边界条件，定出系数 :math:`C_{n}` ，从而得到定解问题的形式解。



.. attention:: 上面第三步的前提是：1. 存在一串特征值和相应的特征函数；2. 这一串特征函数正好成为函数的Fourier正弦展开或Fourier展开的完备正交函数系（正交基）。


特征值问题的Sturm-Liouville定理
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

首先回顾函数的广义Fourier展开。实线性空间的内积推广到函数空间，令 :math:`L^{2}[a,b] = \Big\{ f(x) \Big| \int_{0}^{b}|f(x)|^{2}~\mathrm{d}x < +\infty \Big\}` ，按照函数的加法和数乘，成为无穷维的线性空间。在实函数时，定义内积：

.. math::
	\begin{align}
	\left \langle f(x),g(x) \right \rangle := \int_{a}^{b}f(x)g(x)~\mathrm{d}x
	\end{align}

:math:`L^{2}[a,b]` 成为无穷维内积空间(Hilbert空间)，函数有了长度(模)：

.. math::
	\begin{align}
	\| f(x) \| := \left \langle f(x),f(x) \right \rangle ^{1/2}
	= \Big( \int_{a}^{b} |f(x)|^{2}~\mathrm{d}x \Big)^{1/2}
	\end{align}

函数间也因此有了夹角。特别地，如果满足

.. math::
	\begin{align}
	\left \langle f(x),g(x) \right \rangle 
	= \int_{a}^{b} f(x)g(x)~\mathrm{d}x = 0
	\end{align}

则称函数 :math:`f(x)` 与 :math:`g(x)` 正交。如果 :math:`L^{2}[a,b]` 中有一串正交函数 :math:`\{ X_{j}(x), j=1,2,\cdots \}` （ :math:`\left \langle X_{i}(x),X_{j}(x) \right \rangle = \| X_{j}(x) \|^{2} \delta_{ij}` ），使得 :math:`\forall f(x) \in L^{2}[a,b]` 有

.. math::
	\begin{align}
	f(x) = \sum_{j=1}^{+\infty}c_{j}X_{j}(x)
	\end{align}

则称 :math:`\{ X_{j}(x), j=1,2,\cdots \}` 为 :math:`L^{2}[a,b]` 中的一串完备正交函数系(正交基)。上式称为 :math:`f(x)` 关于正交基 :math:`\{ X_{j}(x), j=1,2,\cdots \}` 的广义Fourier展开。

可以证明展开式中系数满足

.. math::
	\begin{align}
	c_{j} = \frac{\left \langle f(x),X_{j}(x) \right \rangle }{\| X_{j}(x) \|^{2}}
	= \frac{\int_{a}^{b}f(x)X_{j}(x)~\mathrm{d}x}{\int_{a}^{b} |X_{j}(x)|^{2}~\mathrm{d}x} 
	\end{align}

称之为广义Fourier系数，函数 :math:`f(x)` 由它的广义Fourier系数完全确定。


.. note:: 

	对于复函数空间，只需要修改内积定义为

	.. math::
		\begin{align}
		\left \langle f(x),g(x) \right \rangle := \int_{a}^{b} f(x)\overline{g(x)}~\mathrm{d}x
		\end{align}



我们称下面这个二阶线性常微分方程为 **Sturm-Liouville(S-L)型方程** ：

.. math::
	\begin{align}
	[k(x)X'(x)]' - q(x)X(x) + \lambda \rho(x)X(x) = 0
	\end{align}


.. note:: 

	对于一般的二阶线性常微分方程：

	.. math::
		\begin{align}
		b_{0}(x)X''(x) + b_{1}(x)X'(x) + b_{2}(x)X(x) + \lambda X(x) = 0
		\end{align}

	当 :math:`b_{0}(x) \ne 0` 时，两边同时乘以

	.. math::
		\begin{align}
		\frac{1}{b_{0}(x)}\exp\Big( \int \frac{b_{1}(x)}{b_{0}(x)}~\mathrm{d}x \Big)
		\end{align}

	即可化为S-L型方程，其中

	.. math::
		\begin{align}
		k(x) = \exp\Big( \int \frac{b_{1}(x)}{b_{0}(x)}~\mathrm{d}x \Big)
		,\quad 
		q(x) = -\frac{b_{2}(x)}{b_{0}(x)}k(x)
		,\quad 
		\rho(x) = \frac{1}{b_{0}(x)}k(x)  
		\end{align}


现在考察S-L型方程的特征值问题：

.. math::
	\begin{align}
	& [k(x)X'(x)]' - q(x)X(x) + \lambda \rho(x)X(x) = 0 ,\quad a<x<b, \\
	& \alpha_{1}X(a) - \beta_{1}X'(a) = 0 ,\quad \alpha_{2}X(b) + \beta_{2}X'(b) = 0, \\
	& \alpha_{j},\beta_{j}\ge 0 ,\quad \alpha_{j}^{2}+\beta_{j}^{2}\ne 0 ,\quad j=1,2
	\end{align}

其中方程的系数满足条件：

- :math:`k(x) \in C^{1}[a,b]` ， :math:`q(x),\rho(x) \in C[a,b]` ；
- 在 :math:`[a,b]` 上， :math:`k(x)>0` ， :math:`\rho(x)>0` ， :math:`q(x) \ge 0` 。
  



定理 : 常点情况下的Sturm-Liouville定理
    S-L型方程的特征值问题的特征值、特征函数具有以下性质：

** （1）非负性： ** 所有的特征值 :math:`\lambda` 均为实数，且 :math:`\lambda \ge 0` 。有零特征值 :math:`\lambda_{0}=0` 的充要条件是 :math:`q(x) \equiv 0` ，且两端不出现第一、三类边界条件。零特征值对应的特征函数为常数 :math:`1` 。

** （2）可数性： ** 全体特征值组成无穷数列：

.. math::
	\begin{align}
	\lambda_{1} < \lambda_{2} < \cdots < \lambda_{n} < \cdots ,\quad \lim_{n\to+\infty}\lambda_{n}=+\infty
	\end{align}

对应于每一个特征值，只有一个线性独立的固有函数，组成对应的特征函数列：

.. math::
	\begin{align}
	X_{1}(x), X_{2}(x),\cdots, X_{n}(x) ,\cdots
	\end{align}

** （3）正交性： ** 不同特征值对应的特征函数相互加权正交，即如果特征值 :math:`\lambda_{n}\ne\lambda_{m}` ，对应的特征函数为 :math:`X_{n}(x),X_{m}(x)` ，则有

.. math::
	\begin{align}
	\left \langle X_{n}(x),X_{m}(x) \right \rangle = \int_{a}^{b}X_{n}(x)X_{m}(x)\rho(x)~\mathrm{d}x = 0
	\end{align}

** （4）完备性： ** 全体特征函数 :math:`\{ X_{n}(x), n=1,2,\cdots \}` 构成 :math:`L_{\rho}^{2}[a,b]` 空间中以 :math:`\rho(x)` 为权函数的完备正交函数系(正交基)。


.. note:: 

	这里的完备性有两种情况。

	第一种情况：对于在 :math:`[a,b]` 上有连续一阶导数，分段连续二阶导数，且满足定解问题中的齐次边界条件的函数 :math:`f(x)` ，有在 :math:`[a,b]` 上绝对一致收敛的广义Fourier展开：

	.. math::
		\begin{align}
		f(x) = \sum_{n=1}^{+\infty}C_{n}X_{n}(x)
		\end{align}

	其中广义Fourier系数和模为

	.. math::
		\begin{align}
		C_{n} = \frac{\int_{a}^{b}f(x)X_{n}(x)\rho(x)~\mathrm{d}x}{\| X_{n}(x) \|^{2}}
		,\quad 
		\| X_{n}(x) \| = \Big[ \int_{a}^{b}|X_{n}(x)|^{2}\rho(x)~\mathrm{d}x \Big]^{1/2} 
		\end{align}

	如果 :math:`\| X_{n}(x) \| = 1` ，则称 :math:`X_{n}(x)` 为归一的， :math:`\{X_{n}(x)\}` 为标准正交基。

	第二种情况：对于 :math:`L_{\rho}^{2}[a,b]` 中任意函数 :math:`f(x)` ，上述Fourier展开式仍然成立，但是展开式是在均方收敛意义下的，也即部分和的极限

	.. math::
		\begin{align}
		f(x) = \lim_{N \to +\infty}\sum_{n=1}^{N}C_{n}X_{n}(x)
		\end{align}

	指的是

	.. math::
		\begin{align}
		\lim_{N\to+\infty}\Big\| f(x) - \sum_{n=1}^{N}C_{n}X_{n}(x) \Big\|
		= \lim_{N\to+\infty}\Big( \int_{a}^{b}\Big| f(x)-\sum_{n=1}^{N}C_{n}X_{n}(x) \Big|^{2}\rho(x)~\mathrm{d}x \Big)^{1/2}
		= 0
		\end{align}




定理 : 周期条件下的Sturm-Liouville定理
    S-L型方程特征值问题：

.. math::
	\begin{align}
	& [k(x)X'(x)]' - q(x)X(x) + \lambda \rho(x)X(x) = 0 ,\quad a<x<b, \\
	& X(a) = X(b) ,\quad X'(a)=X'(b)
	\end{align}

其中系数满足条件：

- :math:`k(x) \in C^{1}[a,b]` ， :math:`q(x),\rho(x) \in C[a,b]` ；
- 在 :math:`[a,b]` 上， :math:`k(x)>0` ， :math:`\rho(x)>0` ， :math:`q(x) \ge 0` ；
- 同时还要满足 :math:`k(a) = k(b)` 。

该问题的特征值、特征函数有着与前一个定理相同的结论，但是 **对应于每一个非零特征值有两个相互正交的特征函数** 。



如果将S-L型方程改写为

.. math::
	\begin{align}
	X''(x) + \frac{k'(x)}{k(x)}X'(x) + \frac{\lambda \rho(x) - q(x)}{k(x)}X(x) = 0  
	\end{align}

上述两个定理中方程系数 :math:`k(x),q(x),\rho(x)` 满足系数条件要求限制，就保证了方程在区间 :math:`[a,b]` （包括端点 :math:`a,b` ）没有奇性，称 :math:`a,b` 是方程的常点，上述两个定理是常点情况下的S-L定理。

如果在 :math:`a` 或 :math:`b` 端上式出现了奇性，当奇性不高时，比如 :math:`a` 或 :math:`b` 是 :math:`k(x)` 的一级零点，是 :math:`q(x)` 的至多一级极点时，称 :math:`a` 或 :math:`b` 是方程的正则奇点，此时S-L定理仍然成立。


.. note:: 

	在实际问题中也会出现S-L定理条件不成立的其他固有值问题，比如端点奇性太高，或区间无界等，此时特征值分布比较复杂，除了离散部分还会有连续部分，也可以取负数。



非齐次问题
-------------

齐次边界条件下非齐次发展方程的混合问题
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

下面以两端固定弦的强迫振动问题为例：

.. math::
	\begin{align}
	& \frac{\partial^{2}u}{\partial t^{2}} - a^{2}\frac{\partial^{2}u}{\partial t^{2}} = f(t,x) ,\quad t>0,0<x<l \\
	& u|_{x=0}=u|_{x=l}=0 \\
	& u|_{t=0}=\varphi(x), \quad \frac{\partial u}{\partial t}\Big|_{t=0}=\psi(x)  
	\end{align}

非齐次项 :math:`f(t,x)` 反映了弦身上外力的作用。求解该非齐次问题的基本想法是通过方程“齐次化”，把非齐次问题转化成相应的齐次问题。

** Method 1 特解法** ：由叠加原理，寻找上述非齐次方程的一个特解 :math:`v(t,x)` 可以把方程齐次化。为了保持边界条件的齐次型，还应该要求 :math:`v(t,x)` 满足齐次边界条件。

对于比较特殊的 :math:`f(t,x)` ，比如 :math:`f(t,x)=Ax` （ :math:`A` 为常数），这样的特解有可能找到。不失一般性，不妨假设 :math:`\varphi(x) \equiv 0` ， :math:`\psi(x)\equiv 0` ， :math:`l=1` 。此时特解可以取为一元函数 :math:`v(x)` 。现在令 :math:`u(t,x) = v(x) + w(t,x)` ，其中 :math:`v(x)` 满足常微分方程边值问题

.. math::
	\begin{align}
	& -a^{2}v''(x) = Ax \\
	& v(0) = v(1) = 0
	\end{align}

积分得到方程的通解为

.. math::
	\begin{align}
	v(x) = -\frac{A}{a^{2}}\Big( \frac{1}{6}x^{3} + Cx + D \Big) 
	\end{align}

由边界条件确定出积分常数为 :math:`D=0` ， :math:`C=-\frac{1}{6}` ，于是得到

.. math::
	\begin{align}
	v(x) = \frac{A}{6a^{2}}(x - x^{3}) 
	\end{align}

根据叠加原理， :math:`w(t,x)` 满足定解问题：

.. math::
	\begin{align}
	& \frac{\partial^{2} w}{\partial t^{2}} - a^{2}\frac{\partial^{2}w}{\partial x^{2}} = 0 \\
	& w|_{x=0} = w|_{x=1} = 0 \\
	& w|_{t=0} = -v(x) = \frac{A}{6a^{2}}(x^{3} - x) ,\quad \frac{\partial w}{\partial t}\Big|_{t=0} = 0  
	\end{align}

这是齐次方程齐次边界条件的问题，可以利用前述公式求解得到

.. math::
	\begin{align}
	w(t,x) = \frac{2A}{a^{2}\pi^{3}}\sum_{n=1}^{+\infty}\frac{(-1)^{n}}{n^{3}}\cos an\pi t \sin n\pi x  
	\end{align}


** Method 2 冲量原理法** ：


** Method 3 Fourier展开法** ：对于本问题，对于相应的齐次情形，即 :math:`f(t,x)=0` 时，用分离变量法可以得到特征值和特征函数系：

.. math::
	\begin{align}
	\lambda_{n} = \Big( \frac{n\pi}{l} \Big)^{2}
	,\quad 
	X_{n}(x) = \sin\frac{n\pi}{l}x ,\quad n=1,2,\cdots 
	\end{align}

由于特征函数系 :math:`\{ \sin\frac{n\pi}{l}x ,~ n=1,2,\cdots \}` 是满足问题齐次边界条件的函数空间里的完备正交函数系，于是可以把问题的解 :math:`u(t,x)` 按此固有函数系作Fourier正弦展开：

.. math::
	\begin{align}
	u(t,x) = \sum_{n=1}^{+\infty}T_{n}(t)\sin\frac{n\pi}{l}x 
	\end{align}

其中展开系数 :math:`T_{n}(t)` 待定。由叠加原理可知，这样的 :math:`u(t,x)` 一定满足齐次边界条件，为了确定系数 :math:`T_{n}(t)` 使这样的 :math:`u(t,x)` 满足非齐次方程和初始条件。为此，将问题中的已知函数 :math:`f(t,x),\varphi(x)` 和 :math:`\psi(x)` 都按特征函数系 :math:`\{ \sin\frac{n\pi}{l}x \}` 作正弦展开：

.. math::
	\begin{align}
	f(t,x) = \sum_{n=1}^{+\infty}f_{n}(t)\sin\frac{n\pi}{l}x
	,\quad 
	\varphi(t,x) = \sum_{n=1}^{+\infty}\varphi_{n}\sin\frac{n\pi}{l}x
	,\quad
	\psi(x) = \sum_{n=1}^{+\infty}\psi_{n}\sin\frac{n\pi}{l}x
	\end{align}

其中展开系数为

.. math::
	\begin{align}
	f_{n}(t) = \frac{2}{l}\int_{0}^{l}f(t,x)\sin\frac{n\pi}{l}x~\mathrm{d}x
	,\quad 
	\varphi_{n} = \frac{2}{l}\int_{0}^{l}\varphi(x)\sin\frac{n\pi}{l}x~\mathrm{d}x
	,\quad 
	\psi_{n} = \frac{2}{l}\int_{0}^{l}\psi(x)\sin\frac{n\pi}{l}x~\mathrm{d}x    
	\end{align}

把这些展开式代入方程和初始条件，得到

.. math::
	\begin{align}
	\sum_{n=1}^{+\infty}T_{n}''(t)\sin\frac{n\pi}{l}x
	- a^{2}\sum_{n=1}^{+\infty}T_{n}(t)\Big(\sin\frac{n\pi}{l}x \Big)''
	= \sum_{n=1}^{+\infty}T_{n}''(t)\sin\frac{n\pi}{l}x
	+ a^{2}\sum_{n=1}^{+\infty}\Big(\frac{n\pi}{l} \Big)^{2}T_{n}(t)\sin\frac{n\pi}{l}x
	= \sum_{n=1}^{+\infty}f_{n}(t)\sin\frac{n\pi}{l}x 
	\end{align}

.. math::
	\begin{align}
	\sum_{n=1}^{+\infty}T_{n}(0)\sin\frac{n\pi}{l}x
	= \sum_{n=1}^{+\infty}\varphi_{n}\sin\frac{n\pi}{l}x
	,\quad 
	\sum_{n=1}^{+\infty}T_{n}'(0)\sin\frac{n\pi}{l}x
	= \sum_{n=1}^{+\infty}\psi_{n}\sin\frac{n\pi}{l}x   
	\end{align}

由正弦展开的唯一性，方程两边比较系数，得到 :math:`T_{n}(t)` 的边值问题：

.. math::
	\begin{align}
	& T_{n}''(t) + \Big( \frac{an\pi}{l} \Big)^{2}T_{n}(t) = f_{n}(t) \\
	& T_{n}(0) = \varphi_{n} ,\quad T_{n}'(0)=\psi_{n}
	\end{align}


.. attention:: 

	能从问题的原方程中得到上述方程是因为 :math:`X_{n}(x) = \sin\frac{n\pi}{l}x` 满足方程 :math:`X_{n}''(x) = -\lambda_{n}X_{n}(x)` 。与齐次方程情形不同的是，这里 :math:`T_{n}(t)` 满足的常微分方程是非齐次的。


上述方程对应的齐次方程的基础解系为

.. math::
	\begin{align}
	T_{n1}(t) = \cos\frac{an\pi}{l}t
	,\quad 
	T_{n2}(t) = \sin\frac{an\pi}{l}t  
	\end{align}

其中一个特解为

.. math::
	\begin{align}
	T_{n}^{*}(t) = \int_{0}^{t}\frac{T_{n1}(\tau)T_{n2}(t) - T_{n1}(t)T_{n2}(\tau)}{T_{n1}(\tau)T_{n2}'(\tau) - T_{n1}'(\tau)T_{n2}(\tau)}f_{n}(\tau)~\mathrm{d}\tau
	= \frac{l}{an\pi}\int_{0}^{t}\sin\frac{an\pi}{l}(t-\tau)f_{n}(\tau)~\mathrm{d}\tau  
	\end{align}

于是齐次方程的通解为

.. math::
	\begin{align}
	T_{n}(t) = C_{n}\cos\frac{an\pi}{l}t
	+ D_{n}\sin\frac{an\pi}{l}t
	+ \frac{l}{an\pi}\int_{0}^{t}\sin\frac{an\pi}{l}(t-\tau)f_{n}(\tau)~\mathrm{d}\tau    
	\end{align}


代入初始条件，确定出 :math:`C_{n}=\varphi_{n}` ， :math:`D_{n} = \frac{l}{an\pi}\psi_{n}` ，最后得到两端固定弦的强迫振动的解为

.. math::
	\begin{align}
	u(t,x) = \sum_{n=1}^{+\infty} \bigg[
	    \varphi_{n}\cos\frac{an\pi}{l}t
	    + \frac{l}{an\pi}\psi_{n}\sin\frac{an\pi}{l}t
	    + \frac{l}{an\pi}\int_{0}^{t}\sin\frac{an\pi}{l}(t-\tau)f_{n}(\tau)~\mathrm{d}\tau     
	\bigg] \sin\frac{n\pi}{l}x 
	\end{align}



.. tip:: 

	上面采用的Fourier展开法可以用于一般的非齐次问题：

	.. math::
		\begin{align}
		& L_{t}u + L_{x}u = f(t,x) ,\quad t>0, a<x<b \\
		& \Big( \alpha_{1}u - \beta_{1}\frac{\partial u}{\partial x} \Big)\Big|_{x=a}=0
		,\quad \Big(\alpha_{2}u + \beta_{2}\frac{\partial u}{\partial x} \Big)\Big|_{x=b}=0, \\
		& u|_{t=0} = \varphi(x)
		,\quad \frac{\partial u}{\partial t}\Big|_{t=0}=\psi(x) 
		\end{align}

	其中 :math:`L_{t},L_{x}` 分别是关于 :math:`t,x` 的二阶线性常微分算子。

	**Step 1** 分离变量，同时令 :math:`f(t,x)=0` ，求出相应的齐次问题的特征值问题，解出该问题相应的特征值 :math:`\{\lambda_{n}\}` 以及特征函数系 :math:`\{ X_{n}(x) \}` 。

	**Step 2** 依据S-L定理判断 :math:`\{ X_{n}(x) \}` 的完备性，并将未知函数 :math:`u(t,x)` 以及已知函数 :math:`f(t,x)` ， :math:`\varphi(x)` 和 :math:`\psi(x)` 按照特征函数系 :math:`\{ X_{n}(x) \}` 作广义Fourier展开：

	.. math::
		\begin{align}
		& u(t,x) = \sum_{n}T_{n}(t)X_{n}(x)
		,\quad f(t,x)= \sum_{n}f_{n}(t)X_{n}(x) \\
		& \varphi(x) = \sum_{n}\varphi_{n}X_{n}(x)
		,\quad \psi(x) = \sum_{n}\psi_{n}X_{n}(x)
		\end{align}

	**Step 3** 将上面的展开式代入原控制方程以及初始条件，利用 :math:`L_{x}X_{n}(x) = -\lambda X_{n}(x)` ，得到未知函数 :math:`u(t,x)` 的广义Fourier系数 :math:`T_{n}(t)` 的初值问题：

	.. math::
		\begin{align}
		& L_{t}T_{n}(t) - \lambda_{n}T_{n}(t) = f_{n}(t) \\
		& T_{n}(0) = \varphi_{n} ,\quad T_{n}'(0) = \psi_{n}
		\end{align}

	**Step 4** 求解上述初值问题，确定 :math:`T_{n}(t)` ，给出 :math:`u(t,x)` 的级数表达式。




一般的非齐次混合问题
^^^^^^^^^^^^^^^^^^^^^^^

现在考虑一般的非齐次混合问题：

.. math::
	\begin{align}
	& L_{t}u + L_{x}u = f(t,x) ,\quad t>0, a<x<b \\
	& \Big( \alpha_{1}u - \beta_{1}\frac{\partial u}{\partial x} \Big)\Big|_{x=a} = g_{1}(t)
	,\quad \Big( \alpha_{2}u + \beta_{2}\frac{\partial u}{\partial x} \Big)\Big|_{x=b} = g_{2}(t) \\
	& u|_{t=0}=\varphi(x) ,\quad \frac{\partial u}{\partial t}\Big|_{t=0}=\psi(x) 
	\end{align}


.. attention:: 边界条件出现非齐次项 :math:`g_{1}(t),g_{2}(t)` ，不能再使用分离变量法(Fourier展开法)或冲量原理法求解，但是可以通过寻找满足非齐次边界条件的特解把边界条件齐次化。

设 :math:`v(t,x)` 满足非齐次边界条件：

.. math::
	\begin{align}
	\Big(\alpha_{1}v - \beta_{1}\frac{\partial v}{\partial x} \Big)\Big|_{x=a} = g_{1}(t)
	,\quad 
	\Big(\alpha_{2}v + \beta_{2}\frac{\partial v}{\partial x} \Big)\Big|_{x=b} = g_{2}(t)
	\end{align}

满足条件的 :math:`v(t,x)` 显然不唯一，可以简单地取为 :math:`x` 的线性函数：

.. math::
	\begin{align}
	v(t,x) = A(t)x + B(t)
	\end{align}

其中 :math:`A(t),B(t)` 待定。将此 :math:`v(t,x)` 代入边界条件，整理得到关于 :math:`A(t),B(t)` 的线性方程组：

.. math::
	\begin{align}
	& (\alpha_{1}a - \beta_{1})A(t) + \alpha_{1}B(t) = g_{1}(t) \\
	& (\alpha_{2}b + \beta_{2})A(t) + \alpha_{2}B(t) = g_{2}(t)
	\end{align}

解出 :math:`A(t),B(t)` 便可以得到满足非齐次边界条件的 :math:`v(t,x)` 。

.. note:: 如果上式线性方程组无解，则可以改设 :math:`v(t,x)` 为 :math:`x` 的二次函数。

令 :math:`u(t,x) = v(t,x) + w(t,x)` ，由叠加原理可知， :math:`w(t,x)` 满足非齐次方程齐次边界条件的定解问题：

.. math::
	\begin{align}
	& L_{t}w + L_{x}w = f(t,x) - L_{t}v - L_{x}v ,\quad t>0,a<x<b \\
	& \Big(\alpha_{1}w - \beta_{1}\frac{\partial w}{\partial x} \Big)\Big|_{x=a} = 0
	,\quad \Big(\alpha_{2}w + \beta_{2}\frac{\partial w}{\partial x} \Big)\Big|_{x=b}=0 \\
	& w|_{t=0} = \varphi(x) - v|_{t=0}
	,\quad \frac{\partial w}{\partial t}\Big|_{t=0} = \psi(x) - \frac{\partial v}{\partial t}\Big|_{t=0}  
	\end{align}

而该定解问题可以使用上一节的方法解决。






积分变换法
==============

积分变换法常用语求解无界或半无界区域上的线性偏微分方程问题。积分变换法通过函数的积分变换，把微分运算转化为代数运算，从而减少偏微分方程中自变量的个数，直至化简为常微分方程或代数方程以求解。


Fourier变换法
---------------

Fourier变换
^^^^^^^^^^^^^^

定义在实轴上的函数 :math:`f(x)` 在任意有界区间逐段光滑，且在 :math:`(-\infty,+\infty)` 绝对可积，即 :math:`\int_{-\infty}^{+\infty}|f(x)|~\mathrm{d}x < +\infty` ，则 :math:`\forall \lambda \in (-\infty,+\infty)` ，含参积分

.. math::
	\begin{align}
	\hat{f}(\lambda) = F[f(x)] = \int_{-\infty}^{+\infty}f(x)e^{-\mathrm{i}\lambda x}~\mathrm{d}x
	\end{align}

收敛。称 :math:`f(x) \to \hat{f}(\lambda)` 的对应为Fourier变换， :math:`\hat{f}(\lambda)` 为 :math:`f(x)` 的Fourier变换的像， :math:`f(x)` 为 :math:`\hat{f}(\lambda)` 的Fourier变换的原像。




Fourier变换有以下基本性质：

（1）如果 :math:`F[f_{1}(x)]` ， :math:`F[f_{2}(x)]` 存在，则对任意常数 :math:`c_{1},c_{2}` 有

.. math::
	\begin{align}
	F[c_{1}f_{1}(x) + c_{2}f_{2}(x)] = c_{1}F[f_{1}(x)] + c_{2}F[f_{2}(x)]
	\end{align}

（2）如果 :math:`F[f'(x)]` 存在， :math:`f(\pm\infty) = 0` ，由分部积分公式可以得到微分关系：

.. math::
	\begin{align}
	F[f'(x)] = \mathrm{i}\lambda F[f(x)]
	\end{align}

可以看到，Fourier变换把求导运算变成了代数运算。更一般地，如果 :math:`F[f^{(n)}(x)]` 存在， :math:`f(\pm\infty)=f'(\pm\infty)=\cdots = f^{(n-1)}(\pm\infty) = 0` ，则有

.. math::
	\begin{align}
	F[f^{(n)}(x)] = (\mathrm{i}\lambda)^{n}F[f(x)]
	\end{align}

（3）如果 :math:`f(x)` 在 :math:`(-\infty,+\infty)` 上绝对可积，且在任何有界区间上逐段光滑，则有 **反演公式** ：

.. math::
	\begin{align}
	\frac{1}{2}[f(x-0) + f(x+0)] = \frac{1}{2\pi}\int_{-\infty}^{+\infty}\hat{f}(\lambda)e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda  
	\end{align}

在 :math:`f(x)` 的连续点上，有

.. math::
	\begin{align}
	f(x) = F^{-1}[\hat{f}(x)] = \frac{1}{2\pi} \int_{-\infty}^{+\infty}\hat{f}(\lambda)e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda
	\end{align}

将Fourier正变换的定义式代入上式即可得到Fourier积分公式：

.. math::
	\begin{align}
	f(x) = \frac{1}{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(\xi)e^{-\mathrm{i}(\xi - x)\lambda}~\mathrm{d}\xi\mathrm{d}\lambda
	\end{align}


Fourier变换的其他常用性质如下：

- **频移和时移(位移)特性** ：设 :math:`f(x)` 的Fourier变换为 :math:`\hat{f}(\lambda)` ，则 :math:`\forall \lambda_{0},x_{0} \in (-\infty,+\infty)` ，有

.. math::
	\begin{align}
	& F[f(x)e^{\mathrm{i}\lambda_{0}x}] = \hat{f}(\lambda - \lambda_{0}) \\
	& F[f(x - x_{0})] = \hat{f}(\lambda)e^{-\mathrm{i}x_{0}\lambda}
	\end{align}

- **相似性质** ：设 :math:`f(x)` 的Fourier变换为 :math:`\hat{f}(\lambda)` ，则对不为零的实数 :math:`\alpha` 有

.. math::
	\begin{align}
	F[f(\alpha x)] = \frac{1}{|\alpha|}\hat{f}(\frac{\lambda}{\alpha}) 
	\end{align}

- **积分公式** ：设 :math:`f(x)` 的Fourier变换为 :math:`\hat{f}(\lambda)` ， :math:`\int_{-\infty}^{x}f(\xi)~\mathrm{d}\xi` 的Fourier变换存在，则

.. math::
	\begin{align}
	F\Big[ \int_{-\infty}^{x}f(\xi)~\mathrm{d}\xi \Big] = \frac{1}{\mathrm{i}\lambda}\hat{f}(\lambda) 
	\end{align}

- **卷积公式** ：设 :math:`f(x),g(x)` 的Fourier变换分别为 :math:`\hat{f}(\lambda)` 与 :math:`\hat{g}(\lambda)` ，则它们的卷积函数

.. math::
	\begin{align}
	f(x) * g(x) = \int_{-\infty}^{+\infty}f(\xi)g(x-\xi)~\mathrm{d}\xi
	= \int_{-\infty}^{+\infty}f(x-\xi)g(\xi)~\mathrm{d}\xi
	\end{align}

的Fourier变换也存在，且

.. math::
	\begin{align}
	F[f(x) * g(x)] = \hat{f}(\lambda)\hat{g}(\lambda)
	\qquad
	f(x) * g(x) = F^{-1}[\hat{f}(\lambda)\hat{g}(\lambda)]
	\end{align}

- **反射性** ：设 :math:`f(x)` 的Fourier变换为 :math:`\hat{f}(\lambda)` ，则

.. math::
	\begin{align}
	F[\hat{f}(x)] = 2\pi f(-\lambda)
	\end{align}


+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| Fourier变换性质 | 性质内容                                                                                                                                            |
+=================+=====================================================================================================================================================+
| Fourier正变换   | :math:`\hat{f}(\lambda) = F[f(x)] = \int_{-\infty}^{\infty}f(x)e^{-\mathrm{i}\lambda x}~\mathrm{d}x`                                                |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| Fourier逆变换   | :math:`f(x) = F^{-1}[\hat{f}(\lambda)] = \frac{1}{2\pi} \int_{-\infty}^{\infty}\hat{f}(\lambda)e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda`           |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| 线性关系        | :math:`F[c_{1}f_{1}(x) + c_{2}f_{2}(x)] = c_{1}F[f_{1}(x)] + c_{2}F[f_{2}(x)]`                                                                      |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| 微分关系        | :math:`F[f^{(n)}(x)] = (\mathrm{i}\lambda)^{n}F[f(x)]`                                                                                              |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| 位移特性        | :math:`F[f(x)e^{\mathrm{i}\lambda_{0}x}] = \hat{f}(\lambda - \lambda_{0})` ， :math:`F[f(x - x_{0})] = \hat{f}(\lambda)e^{-\mathrm{i}x_{0}\lambda}` |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| 相似性质        | :math:`F[f(\alpha x)] = \frac{1}{\alpha}\hat{f}(\frac{\lambda}{\alpha})`                                                                            |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| 积分公式        | :math:`F\Big[ \int_{-\infty}^{x}f(\xi)~\mathrm{d}\xi \Big] = \frac{1}{\mathrm{i}\lambda}\hat{f}(\lambda)`                                           |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| 卷积公式        | :math:`F[f(x) * g(x)] = \hat{f}(\lambda)\hat{g}(\lambda)` ， :math:`f(x) * g(x) = F^{-1}[\hat{f}(\lambda)\hat{g}(\lambda)]`                         |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| 反射性          | :math:`F[f(x)] = 2\pi \hat{f}(-\lambda)`                                                                                                            |
+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------+







用Fourier变换求解无界区间上的定解问题
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**案例** 考虑无穷长杆的热传导问题：

.. math::
	\begin{align}
	& \frac{\partial u}{\partial t} = a^{2}\frac{\partial ^{2}u}{\partial x^{2}} ,\quad t>0,-\infty<x<+\infty \\
	& u|_{t=0} = \varphi(x)
	\end{align}

假设未知数 :math:`u(t,x)` 及其相关偏导数都能作Fourier变换，并满足所用公式所求的条件，记

.. math::
	\begin{align}
	\hat{u}(t,\lambda) = F[u(t,x)] = \int_{-\infty}^{+\infty}u(t,x)e^{-\mathrm{i}\lambda x}~\mathrm{d}x
	\end{align}

对方程和初始条件中各项作Fourier变换，即用 :math:`e^{-\mathrm{i}\lambda x}` 遍乘方程和初始条件中的各项，并对变量 :math:`x` 从 :math:`-\infty` 到 :math:`+\infty` 积分，利用微分公式及积分号下求导数、求极限的公式，得到像函数 :math:`\hat{u}(t,\lambda)` 满足的常微分方程初值问题：

.. math::
	\begin{align}
	& \frac{\mathrm{d} \hat{u}}{\mathrm{d} t} = -a^{2}\lambda^{2}\hat{u} ,\quad t>0 \\
	& \hat{u}|_{t=0} = \hat{\varphi}(\lambda)
	\end{align}

其中 :math:`\hat{\varphi}(\lambda)` 是 :math:`\varphi(x)` 的Fourier变换。求解该一阶常微分方程的初值问题，得到像函数表达式为

.. math::
	\begin{align}
	\hat{u}(t,\lambda) = \hat{\varphi}(\lambda)e^{-a^{2}\lambda^{2}t}
	\end{align}

对像函数作Fourier反变换，利用卷积公式得到

.. math::
	\begin{align}
	u(t,x) &= F^{-1}[\hat{\varphi}(\lambda)e^{-a^{2}\lambda^{2}t}]
	= F^{-1}[\hat{\varphi}(\lambda)] * F^{-1}[e^{-a^{2}\lambda^{2}t}] \\
	&= \varphi(x) * \frac{1}{2\pi}\int_{-\infty}^{+\infty}e^{-a^{2}\lambda^{2}t}e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda \\
	&= \varphi(x) * \frac{1}{\pi}\int_{0}^{+\infty}e^{-a^{2}\lambda^{2}t}\cos\lambda x~\mathrm{d}\lambda \\
	&= \varphi (x) * \frac{1}{2a\sqrt{\pi t}}\exp\Big( -\frac{x^{2}}{4a^{2}t} \Big) \\
	&= \frac{1}{2a\sqrt{\pi t}}\int_{-\infty}^{+\infty}\varphi(\xi)\exp\Big[ -\frac{(x - \xi)^{2}}{4a^{2}t} \Big]~\mathrm{d}\xi
	\end{align}

以上解得的 :math:`u(t,x)` 是用含参积分表示的形式解。由其构成可知，只要 :math:`\varphi(x)` 连续，且当 :math:`|x| \to +\infty` 时 :math:`|\varphi(x)|` 有界或增长不超过 :math:`e^{|x|}` ，该广义积分收敛且可以在积分号下求导和求极限，从而上式给出了无穷长杆上热传导问题的古典解。

.. tip:: 可以看到，使用Fourier变换解题时，先作正变换，解出像函数，再作反变换，充分利用现成公式进行化简，即可完成无界区域上线性定解问题的求解。



**案例** 现在再考虑杆上有热源的情况：

.. math::
	\begin{align}
	& \frac{\partial u}{\partial t} = a^{2}\frac{\partial^{2}u}{\partial x^{2}} + f(t,x) ,\quad t>0,-\infty<x<+\infty \\
	& u|_{t=0} = \varphi(x)   
	\end{align}

由叠加原理可知，只需要求解下面的初值问题：

.. math::
	\begin{align}
	& \frac{\partial u}{\partial t} = a^{2}\frac{\partial^{2}u}{\partial x^{2}} + f(t,x) ,\quad t>0,-\infty<x<+\infty \\
	& u|_{t=0} = 0 
	\end{align}

将该初值问题的解与上述已经求解完成的齐次问题的解相叠加，便可得到所需解。

将上式关于 :math:`x` 的函数作Fourier变换，记 :math:`\hat{u}(t,\lambda) = F[u(t,x)]` ，得到

.. math::
	\begin{align}
	& \frac{\mathrm{d} \hat{u}}{\mathrm{d} t} = -a^{2}\lambda^{2}\hat{u} + \hat{f}(t,\lambda) ,\quad t>0, -\infty<\lambda<+\infty \\
	& \hat{u}|_{t=0} = 0
	\end{align}

其中 :math:`\hat{f}(t,\lambda) = F[f(t,x)]` 。该非齐次常微分方程的通解为

.. math::
	\begin{align}
	\hat{u}(t,\lambda) = e^{-a^{2}\lambda^{2}t}\Big[ c + \int_{0}^{t}\hat{f}(\tau,\lambda)e^{a^{2}\lambda^{2}\tau}~\mathrm{d}\tau\Big]
	\end{align}

代入初始条件有 :math:`\hat{u}|_{t=0} = c = 0` ，从而解得像函数为

.. math::
	\begin{align}
	\hat{u}(t,\lambda) = \int_{0}^{t}\hat{f}(\tau,\lambda )e^{-a^{2}\lambda^{2}(t-\lambda)}~\mathrm{d}\tau 
	\end{align}

对其作Fourier反变换，得到初值问题的解为

.. math::
	\begin{align}
	u(t,x) &= \frac{1}{2\pi}\int_{-\infty}^{+\infty}\Big[ \int_{0}^{t}\hat{f}(\tau,\lambda)e^{-a^{2}\lambda^{2}(t-\tau)}~\mathrm{d}\tau \Big]e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda  \\
	&= \int_{0}^{t} \Big[ \frac{1}{2\pi}\int_{-\infty}^{\infty}\hat{f}(\tau,\lambda )e^{-a^{2}\lambda^{2}(t-\tau)}e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda \Big]~\mathrm{d}\tau \\
	&= \int_{0}^{t} F^{-1}[\hat{f}(\tau,\lambda)] * F^{-1}[e^{-a^{2}\lambda^{2}(t-\tau)}] ~\mathrm{d}\tau \\
	&= \int_{0}^{t} f(\tau,x) * \frac{1}{2a\sqrt{\pi (t-\tau)}}\exp\Big[ -\frac{x^{2}}{4a^{2}(t-\tau)} \Big]~\mathrm{d}\tau \\
	&= \frac{1}{2a\sqrt{\pi}}\int_{0}^{t}\int_{-\infty}^{+\infty}\frac{f(\tau,\xi)}{\sqrt{t - \tau}} \exp\Big[ -\frac{(x-\xi)^{2}}{4a^{2}(t-\tau)} \Big]~\mathrm{d}\xi\mathrm{d}\tau
	\end{align}


.. tip:: 可以看到，方程中出现非齐次项时仍然可以使用Fourier变换求解，只不过像函数满足的变成了非齐次常微分方程。除此之外，求解过程中并不需要真正求出已知函数 :math:`\varphi(x),f(t,x)` 的像函数。



**案例** 考虑无限长弦的自由振动：

.. math::
	\begin{align}
	& \frac{\partial^{2}u}{\partial t^{2}} = a^{2}\frac{\partial^{2}u}{\partial x^{2}} ,\quad t>0,-\infty<x<+\infty \\
	& u|_{t=0} = \varphi(x) ,\quad \frac{\partial u}{\partial t}\Big|_{t=0} = \psi(x)  
	\end{align}

设 :math:`\hat{u}(t,\lambda) = F[u(t,x)]` ，对方程和初始条件作Fourier变换，得到像函数所满足的初值问题：

.. math::
	\begin{align}
	& \frac{\mathrm{d}^{2} \hat{u}}{\mathrm{d} t^{2}} = -a^{2}\lambda^{2}\hat{u} \\
	& \hat{u}|_{t=0} = \hat{\varphi}(\lambda) ,\quad \frac{\mathrm{d} \hat{u}}{\partial t}\Big|_{t=0} = \hat{\psi}(\lambda)  
	\end{align}

其中 :math:`\hat{\varphi}(\lambda ) = F[\varphi(x)]` ， :math:`\hat{\psi}(\lambda) = F[\psi(x)]` 。该方程的通解为

.. math::
	\begin{align}
	\hat{u}(t,\lambda ) = A(\lambda )e^{\mathrm{i}\lambda at} + B(\lambda )e^{-\mathrm{i}\lambda at}
	\end{align} 

代入初始条件确定出

.. math::
	\begin{align}
	A(\lambda) = \frac{1}{2}\Big[ \hat{\varphi}(\lambda) + \frac{1}{\mathrm{i}\lambda a}\hat{\psi}(\lambda) \Big]
	,\qquad 
	B(\lambda) = \frac{1}{2}\Big[ \hat{\varphi}(\lambda) - \frac{1}{\mathrm{i}\lambda a}\hat{\psi}(\lambda) \Big]
	\end{align}

代入通解，得到像函数为

.. math::
	\begin{align}
	\hat{u}(t,\lambda) = \frac{1}{2}\Big[ \hat{\varphi}(\lambda)e^{-\mathrm{i}\lambda at} + \hat{\varphi}(\lambda)e^{-\mathrm{i}\lambda at} \Big] 
	+ \frac{1}{2a\mathrm{i}\lambda }\Big[ \hat{\psi}(\lambda)e^{\mathrm{i}\lambda at} - \hat{\psi}(\lambda)e^{-\mathrm{i}\lambda at} \Big] 
	\end{align}

对像函数作反变换，由Fourier变换的积分公式

.. math::
	\begin{align}
	F\Big[ \int_{-\infty}^{x}f(\xi)~\mathrm{d}\xi \Big] = \frac{1}{\mathrm{i}\lambda}\hat{f}(\lambda) 
	\end{align}

以及位移公式

.. math::
	\begin{align}
	F[f(x + \xi)] = \hat{f}(\lambda)e^{\mathrm{i}\lambda \xi}
	\end{align}

可以得到

.. math::
	\begin{align}
	u(t,x) = \frac{1}{2}\Big[ \varphi(x+at) + \varphi(x-at) \Big]
	+ \frac{1}{2a}\int_{x-at}^{x+at}\psi(\xi)~\mathrm{d}\xi
	\end{align}




Fourier正弦、余弦变换和半无界区间上的定解问题
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

对于定义在半无界区间 :math:`[0,+\infty)` 上的函数，可以将其奇延拓或偶延拓到 :math:`(-\infty,+\infty)` 后作Fourier变换，这就导出了 :math:`[0,+\infty)` 区间的Fourier正弦变换和余弦变换：

.. math::
	\begin{align}
	& \hat{f}_{s}(\lambda) = F_{s}[f(x)] := \int_{0}^{+\infty}f(x)\sin\lambda x~\mathrm{d}x \\
	& \hat{f}_{c}(\lambda) = F_{c}[f(x)] := \int_{0}^{+\infty}f(x)\cos\lambda x~\mathrm{d}x
	\end{align}

利用Fourier反变换公式可以推出它们的反演公式分别为

.. math::
	\begin{align}
	& f(x) = F_{s}^{-1}[\hat{f}_{s}(\lambda)] = \frac{2}{\pi}\int_{0}^{+\infty}\hat{f}_{s}(\lambda)\sin\lambda x~\mathrm{d}\lambda \\
	& f(x) = F_{c}^{-1}[\hat{f}_{c}(\lambda)] = \frac{2}{\pi}\int_{0}^{+\infty}\hat{f}_{c}(\lambda)\cos\lambda x~\mathrm{d}\lambda 
	\end{align}

正弦变换和余弦变换可以用来求解半无界空间上的定解问题。


**案例** 考虑简化后的半导体预积淀扩散过程：

.. math::
	\begin{align}
	& \frac{\partial u_{1}}{\partial t} = a^{2}\frac{\partial^{2}u_{1}}{\partial x^{2}} ,\quad t>0,x>0 \\
	& u_{1}|_{x=0} = u_{0} ,\quad u_{1}|_{t=0}=0 \\
	& u_{1}|_{x=+\infty} = \frac{\partial u_{1}}{\partial x}\Big|_{x=+\infty} = 0 
	\end{align}

利用正弦变换求解上式。令 :math:`\hat{u}_{1}(t,\lambda ) = F_{s}[u_{1}(t,x)]` ，则

.. math::
	\begin{align}
	F_{s}\Big[ \frac{\partial^{2}u_{1}}{\partial x^{2}} \Big]
	= \int_{0}^{+\infty}\frac{\partial^{2}u_{1}}{\partial x^{2}}\sin\lambda x~\mathrm{d}x
	= \Big[ \frac{\partial u_{1}}{\partial x}\sin\lambda x - \lambda u_{1}\cos\lambda x \Big] _{0}^{+\infty}
	- \lambda^{2} \int_{0}^{+\infty}u_{1}\sin\lambda x~\mathrm{d}x
	= \lambda u_{0} - \lambda^{2}\hat{u}_{1}
	\end{align}


于是， :math:`u_{1}` 的半直线上的混合问题变换成

.. math::
	\begin{align}
	& \frac{\mathrm{d} \hat{u}_{1}}{\mathrm{d} t} + a^{2}\lambda^{2}\hat{u}_{1} = a^{2}\lambda u_{0} \\
	& \hat{u}_{1}|_{t=0} = 0
	\end{align}

解得像函数为

.. math::
	\begin{align}
	\hat{u}_{1} = \frac{u_{0}}{\lambda }(1 - e^{-a^{2}\lambda ^{2}t}) 
	\end{align}

对其作反正弦变换得到

.. math::
	\begin{align}
	u_{1}(t,x) &= \frac{2u_{0}}{\pi} \int_{0}^{+\infty} \frac{1}{\lambda}(1 - e^{-a^{2}\lambda^{2}t})\sin\lambda x~\mathrm{d}\lambda \\
	&= \frac{2u_{0}}{\pi}\bigg[ \int_{0}^{+\infty}\frac{\sin\lambda x}{\lambda}~\mathrm{d}\lambda - \int_{0}^{+\infty}e^{-\lambda^{2}a^{2}t}\Big( \int_{0}^{x}\cos\lambda \xi~\mathrm{d}\xi \Big)~\mathrm{d}\lambda \bigg] \\
	&= u_{0} - \frac{2u_{0}}{\pi}\int_{0}^{x}\int_{0}^{+\infty}e^{-\lambda^{2}a^{2}t}\cos\lambda \xi~\mathrm{d}\lambda \mathrm{d}\xi \\
	&= u_{0} - \frac{u_{0}}{a\sqrt{\pi t}}\int_{0}^{x}\exp\Big( -\frac{\xi^{2}}{4a^{2}t} \Big)~\mathrm{d}\xi \\
	&= u_{0}\Big[ 1 - \frac{2}{\sqrt{\pi}}\int_{0}^{\frac{x}{2a\sqrt{t}}}e^{-y^{2}}~\mathrm{d}y \Big]
	\end{align}

其中误差函数的函数值有表可查。

.. tip:: 可以看到，用正弦或余弦变换解题，不需要事先将边界条件齐次化，但是在分部积分推导微分公式时会用到边界条件。选用何种积分变换，既取决于边界条件，也取决于方程。


.. attention:: 如果方程中只出现关于 :math:`x` 的二阶导数， :math:`x=0` 端的边界条件为第二类边界条件，应该使用余弦变换来求解。而一般情况下的问题，边界条件出现第三类边界条件，则需要采用其他积分变换。



高维问题
^^^^^^^^^^^

求解全空间上的高维定解问题，可以利用高维Fourier变换。以三维为例，称

.. math::
	\begin{align}
	\hat{f}(\lambda ,\mu,\nu) = \iiint\limits_{-\infty}^{+\infty}f(x,y,z)e^{-\mathrm{i}(\lambda x+\mu y + \nu z)}~\mathrm{d}x\mathrm{d}y\mathrm{d}z  
	\end{align}

为 :math:`f(x,y,z)` 的Fourier变换，记为 :math:`F[f]` 。它的反变换为

.. math::
	\begin{align}
	f(x,y,z) = \frac{1}{(2\pi)^{3}} \iiint\limits_{-\infty}^{+\infty}\hat{f}(\lambda , \mu, \nu)e^{\mathrm{i}(\lambda x + \mu y + \nu z)}~\mathrm{d}\lambda\mathrm{d}\mu\mathrm{d}\nu   
	\end{align}

记为 :math:`F^{-1}[\hat{f}]` 。相应地，有微分公式

.. math::
	\begin{align}
	F\Big[\frac{\partial f}{\partial x} \Big] = \mathrm{i}\lambda F[f]
	,\qquad
	F\Big[\frac{\partial f}{\partial y} \Big] = \mathrm{i}\mu F[f]
	,\quad
	F\Big[\frac{\partial f}{\partial z} \Big] = \mathrm{i}\nu F[f]
	\end{align}

特别地有

.. math::
	\begin{align}
	F[\Delta_{3}f] = - (\lambda^{2} + \mu^{2} + \nu^{2})F[f]
	\end{align}

对于高维函数的卷积

.. math::
	\begin{align}
	f * g = \iiint\limits_{-\infty}^{+\infty}f(x-\xi, y-\eta, z-\zeta) g(\xi, \eta ,\zeta)~\mathrm{d}\xi~\mathrm{d}\eta~\mathrm{d}\zeta   
	\end{align}

有卷积公式

.. math::
	\begin{align}
	F[f*g] = F[f] \cdot F(g)
	\end{align}

.. attention:: 类似一维情况，以上公式都是在一定条件下成立。


**案例** 考虑三维热传导方程的初值问题：

.. math::
	\begin{align}
	& \frac{\partial u}{\partial t} = a^{2}\Delta_{3}u ,\quad t>0,-\infty<x,y,z<+\infty \\
	& u|_{t=0} = \varphi(x,y,z) 
	\end{align}

对方程和初始条件两边作三维Fourier变换，得到

.. math::
	\begin{align}
	& \frac{\mathrm{d} \hat{u}}{\mathrm{d} t} + a^{2}\rho^{2}\hat{u} = 0 ,\quad \rho^{2}=\lambda ^{2} + \mu^{2} + \nu^{2} \\
	& \hat{u}|_{t=0} = \hat{\varphi}(\lambda ,\mu,\nu) 
	\end{align}

解得像函数为

.. math::
	\begin{align}
	\hat{u}(t,\lambda,\mu,\nu) = \hat{\varphi}(\lambda,\mu,\nu)e^{-a^{2}\rho^{2}t}
	\end{align}

因为

.. math::
	\begin{align}
	F^{-1}[e^{-a^{2}\rho^{2}t}]
	&= \frac{1}{(2\pi)^{3}}\iiint\limits_{-\infty}^{+\infty} e^{-a^{2}(\lambda^{2}+\mu^{2}+\nu^{2})t}\cdot e^{\mathrm{i}(\lambda x + \mu y + \nu z)}~\mathrm{d}\lambda\mathrm{d}\mu\mathrm{d}\nu \\
	&= \Big( \frac{1}{2\pi}\int_{-\infty}^{+\infty}e^{-a^{2}\lambda^{2}t} \cdot e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda \Big)
	\cdot \Big( \frac{1}{2\pi}\int_{-\infty}^{+\infty}e^{-a^{2}\mu^{2}t} \cdot e^{\mathrm{i}\mu y}~\mathrm{d}\mu \Big)
	\cdot \Big( \frac{1}{2\pi}\int_{-\infty}^{+\infty}e^{-a^{2}\nu^{2}t} \cdot e^{\mathrm{i}\nu z}~\mathrm{d}\nu \Big) \\
	&= \Big(\frac{1}{2a\sqrt{\pi t}} \Big)^{3}\exp\Big( -\frac{x^{2} + y^{2} + z^{2}}{4a^{2}t} \Big)
	\end{align}

由卷积公式可以得到

.. math::
	\begin{align}
	u(t,x,y,z) = \Big(\frac{1}{2a\sqrt{\pi t}} \Big)^{3}
	\iiint\limits_{-\infty}^{+\infty}
	\varphi(\xi,\eta,\zeta)
	\exp\Big( - \frac{(x-\xi)^{2} + (y-\eta)^{2} + (z - \zeta)^{2}}{4a^{2}t} \Big)
	~\mathrm{d}\xi\mathrm{d}\eta\mathrm{d}\zeta
	\end{align}






Laplace变换法
----------------

Laplace变换
^^^^^^^^^^^^^^

作Laplce变换时，被变换函数规定为

.. math::
	\begin{align}
	f(t) = f(t)H(t)
	\quad \Rightarrow \quad
	H(t) = \left \{\begin{array}{ll}
	1 , \quad t \ge 0 \\
	0 , \quad t < 0
	\end{array} \right .
	\end{align}

称含复参量 :math:`p = \sigma + \mathrm{i}\lambda` 的积分

.. math::
	\begin{align}
	\bar{f}(p) := L[f(p)] = \int_{0}^{+\infty} f(t)e^{-pt}~\mathrm{d}t
	\end{align}

为 :math:`f(t)` 的Laplace变换的像函数，或简称为 :math:`f(t)` 的Laplace变换，记作 :math:`L[f(t)]` 。而 :math:`f(t)` 则称为像函数 :math:`\bar{f}(p)` 的原像，或Laplace反变换，记作 :math:`L^{-1}[\bar{f}(p)]` 。如果 :math:`f(t)` 连续并在任意有限区间逐段光滑， :math:`t \to \infty` 时为指数增长型，也即存在增长指数 :math:`\sigma_{0} \ge 0` 和常数 :math:`M > 0` ，使得 :math:`t` 充分大后 :math:`|f(t)| \le Me^{\sigma_{0}t}` ，则像函数 :math:`\bar{f}(p)` 在半复平面 :math:`\operatorname{Re}[p] > \sigma_{0}` 解析，当 :math:`\operatorname{Re}[p] \to \infty` 时 :math:`\bar{f}(p) \to 0` ，且有反演公式

.. math::
	\begin{align}
	f(t) = L^{-1}[\bar{f}(p)] = \frac{1}{2\pi \mathrm{i}}\int_{\sigma - \mathrm{i}\infty}^{\sigma + \mathrm{i}\infty} \bar{f}(p)e^{pt}~\mathrm{d}p
	\end{align}

其中 :math:`\sigma` 为任意大于 :math:`\sigma_{0}` 的实数。

常用的Laplace变换的性质如下：

- **线性关系** ：

.. math::
	\begin{align}
	L[\alpha f(t) + \beta g(t)] = \alpha L[f(t)] + \beta L[g(t)]
	\end{align}

- **微分公式** ：
  
.. math::
	\begin{align}
	L[f^{(n)}(t)] = p^{n}\bar{f}(p) - p^{n-1}f(+0) - p^{n-2}f'(+0) - \cdots - pf^{(n-2)}(+0) - f^{(n-1)}(+0)
	\end{align}

.. note:: 与Fourier变换相同，Laplace变换把求导运算变成了代数运算，但是 :math:`n` 阶导函数的Laplace变换需要知道相应的从 :math:`0` 阶到 :math:`n-1` 阶导函数的初始值。

- **延迟定理** ：
 
.. math::
	\begin{align}
	L[f(t-\tau)] = L[f(t-\tau)H(t-\tau)] = e^{-p\tau}\bar{f}(p) ,\quad \tau > 0
	\end{align}

- **复频移公式** ：对任何一个复常数 :math:`p_{0}` ，有

.. math::
	\begin{align}
	L[f(t)e^{p_{0}t}] = \bar{f}(p - p_{0})
	\end{align}

- **相似定理** ：对任意常数 :math:`\alpha > 0` ，有
  
.. math::
	\begin{align}
	L[f(\alpha t)] = \frac{1}{\alpha }\bar{f}(\frac{p}{\alpha})
	\end{align}

- **积分公式** ：
  
.. math::
	\begin{align}
	L\Big[ \int_{0}^{t} f(\tau)~\mathrm{d}\tau \Big] = \frac{\bar{f}(p)}{p}
	\end{align}

- **卷积公式** ：
  
.. math::
	\begin{align}
	L[f(t) * g(t)] = \bar{f}(p) \cdot \bar{g}(p)
	\end{align}

- **像函数的微分公式** ：
  
.. math::
	\begin{align}
	L[(-t)^{n}f(t)] = \bar{f}^{(n)}(p)
	\end{align}

- **像函数的积分公式** ：积分路径取在半平面 :math:`\operatorname{Re}[p] > \sigma_{0}` 内，则
  
.. math::
	\begin{align}
	L\Big[\frac{f(t)}{t} \Big] = \int_{p}^{\infty} \bar{f}(p)~\mathrm{d}p
	\end{align}



+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| Laplace变换性质  | 性质内容                                                                                                                                         |
+==================+==================================================================================================================================================+
| Laplace正变换    | :math:`\bar{f}(p) = F[f(t)] = \int_{0}^{+\infty}f(t)e^{-pt}~\mathrm{d}t`                                                                         |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| Laplace逆变换    | :math:`f(t) = F^{-1}[\bar{f}(p)] = \frac{1}{2\pi\mathrm{i}}\int_{\sigma-\mathrm{i}\infty}^{\sigma+\mathrm{i}\infty}\bar{f}(p)e^{pt}~\mathrm{d}p` |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 线性关系         | :math:`L[\alpha f(t) + \beta g(t)] = \alpha L[f(t)] + \beta L[g(t)]`                                                                             |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 微分公式         | :math:`L[f^{(n)}(t)] = p^{n}\bar{f}(p) - p^{n-1}f(+0) - p^{n-2}f'(+0) - \cdots - pf^{(n-2)}(+0) - f^{(n-1)}(+0)`                                 |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 积分公式         | :math:`L\Big[ \int_{0}^{t} f(\tau)~\mathrm{d}\tau \Big] = \frac{\bar{f}(p)}{p}`                                                                  |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 像函数的微分公式 | :math:`L[(-t)^{n}f(t)] = \bar{f}^{(n)}(p)`                                                                                                       |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 像函数的积分公式 | :math:`L\Big[\frac{f(t)}{t} \Big] = \int_{p}^{\infty} \bar{f}(p)~\mathrm{d}p`                                                                    |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 延迟定理         | :math:`L[f(t-\tau)] = L[f(t-\tau)H(t-\tau)] = e^{-p\tau}\bar{f}(p)`                                                                              |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 复频移公式       | :math:`L[f(t)e^{p_{0}t}] = \bar{f}(p - p_{0})`                                                                                                   |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 相似定理         | :math:`L[f(\alpha t)] = \frac{1}{\alpha }\bar{f}(\frac{p}{\alpha})`                                                                              |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| 卷积公式         | :math:`L[f(t) * g(t)] = \bar{f}(p) \cdot \bar{g}(p)`                                                                                             |
+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+





用Laplace变换求解发展方程的定解问题
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**案例** 考虑端点温度已知的半无限长杆上的温度分布问题：

.. math::
	\begin{align}
	& \frac{\partial u}{\partial t} = a^{2}\frac{\partial^{2}u}{\partial x^{2}} ,\quad t>0,x>0 \\
	& u(t,0) = f(t) \\
	& u(0,x) = 0 
	\end{align}

记 :math:`\bar{u}(p,x) = L[u(t,x)], \bar{f}(p) = L[f(t)]` 。对该定解问题方程式作Laplace变换，得到

.. math::
	\begin{align}
	& p\bar{u} = a^{2}\frac{\mathrm{d}^{2}\bar{u}}{\mathrm{d} x^{2}} \\
	& \bar{u} |_{x=0} = \bar{f}(p)
	\end{align}

根据问题的实际意义，对每个 :math:`t>0` ，应该增加自然边界条件 :math:`u(t,+\infty) = 0` ，从而有 :math:`\bar{u}(p,+\infty)=0` 。方程的通解为

.. math::
	\begin{align}
	\bar{u}(p,x) = Ce^{\sqrt{p}x/a } + D e^{-\sqrt{p}x/a}
	\end{align} 

其中 :math:`\sqrt{p}` 为 :math:`p>0` 时取正值的单值分支。由 :math:`\bar{u}(p,+\infty)=0` 推出 :math:`C=0` ；再由 :math:`\bar{u}(p,0) = \bar{f}(p)` ，推出 :math:`D = \bar{f}(p)` ，所以

.. math::
	\begin{align}
	\bar{u}(p,x) = \bar{f}(p)e^{-\sqrt{p}x/a}
	\end{align}

对 :math:`\bar{u}` 作Laplace反变换，根据卷积公式得到

.. math::
	\begin{align}
	u(t,x) &= L^{-1}\Big[ \bar{f}(p) \cdot \exp\big(-\frac{\sqrt{p}}{a}x\big) \Big]
	= L^{-1}[\bar{f}(t)] * L^{-1}\Big[\exp\big(-\frac{\sqrt{p}}{a}x\big)\Big] \\
	&= f(t) * \frac{x}{2a\sqrt{\pi t^{3}}} \exp\Big[ \frac{-x^{2}}{4a^{2}t} \Big] \\
	&= \frac{x}{2a\sqrt{\pi}} \int_{0}^{t} f(\tau)(t - \tau)^{-3/2}\exp\Big[\frac{-x^{2}}{4a^{2}(t - \tau)}\Big]~\mathrm{d}\tau
	\end{align}


**案例** 接下来考虑半无界弦的强迫振动问题：

.. math::
	\begin{align}
	& \frac{\partial^{2} u}{\partial t^{2}} = a^{2}\frac{\partial^{2} u}{\partial x^{2}} ,\quad t>0,x>0 \\
	& \frac{\partial u}{\partial x}\Big|_{x=0} = f(t) \\
	& u|_{t=0} = \frac{\partial u}{\partial t}\Big|_{t=0} = 0
	\end{align}

注意到方程中关于 :math:`t` 和 :math:`x` 都是二阶导数， :math:`x=0` 端的边界条件是一般的非齐次项 :math:`f(t)` ，而关于 :math:`t` 的初始条件均为齐次，故用Laplace变换要优于用余弦变换。由于弦的运动完全由端点所受外界作用引起，在每个 :math:`t` 时刻，应该添加自然边界条件 :math:`u(t,+\infty)=0` 。记 :math:`\bar{u}(p,x) = L[u(t,x)]` ，对该定解问题作Laplace变换，得到

.. math::
	\begin{align}
	& p^{2} \bar{u} = a^{2} \frac{\mathrm{d}^{2} u}{\mathrm{d} x^{2}} ,\quad x>0 \\
	& \frac{\mathrm{d} \bar{u}}{\mathrm{d} x}\Big|_{x=0} = \bar{f}(p) ,\quad \bar{u}|_{x=+\infty} = 0 
	\end{align}

该方程的通解为

.. math::
	\begin{align}
	\bar{u} = Ce^{px/a} + De^{-px/a}
	\end{align}

由边界条件定出 :math:`C=0` ， :math:`D = -\frac{a}{p}\bar{f}(p)` ，所以

.. math::
	\begin{align}
	\bar{u} = - \frac{a}{p}\bar{f}(p)e^{-\frac{x}{a}p} 
	\end{align}

由Laplace变换的积分公式可知

.. math::
	\begin{align}
	L^{-1}\Big[-\frac{a}{p}\bar{f}(p)\Big] = -a \int_{0}^{t} f(\tau)~\mathrm{d}\tau = -aH(t) \int_{0}^{t}f(\tau)~\mathrm{d}\tau
	\end{align}

再由延迟定理可以得到原像为

.. math::
	\begin{align}
	u(t,x) = - a H\Big(t-\frac{x}{a}\Big) \int_{0}^{t-\frac{x}{a}}f(\tau)~\mathrm{d}\tau
	\end{align}



**案例** 接下来考虑有限长弦的强迫振动问题：

.. math::
	\begin{align}
	& \frac{\partial^{2} u}{\partial t^{2}} = a^{2}\frac{\partial^{2} u}{\partial x^{2}} ,\quad t>0,0<x<l \\
	& u(t,0) = 0 ,\quad \frac{\partial u}{\partial x}(t,l) = A\sin\omega t ,\quad \omega \ne \frac{2k - 1}{2l}\pi a , k=1,2,\cdots \\
	& u(0,x) = \frac{\partial u}{\partial t}(0,x) = 0
	\end{align}

这是弦振动问题在有界区间上的混合问题，可以用Laplace变换求解。记 :math:`\bar{u}(p,x) = L[u(t,x)]` ，该混合问题在Laplace变换下成为

.. math::
	\begin{align}
	& p^{2}\bar{u} = a^{2} \frac{\mathrm{d}^{2} \bar{u}}{\mathrm{d} x^{2}} ,\quad 0<x<l \\
	& \bar{u}|_{x=0} = 0 ,\quad \frac{\mathrm{d} \bar{u}}{\mathrm{d} x}\Big|_{x=l} = \frac{A\omega}{p^{2} + \omega^{2}}
	\end{align}

常微分方程的通解为

.. math::
	\begin{align}
	\bar{u} = C \operatorname{ch}\frac{p}{a}x + D \operatorname{sh}\frac{p}{a}x 
	\end{align}

由边界条件定出特解

.. math::
	\begin{align}
	\bar{u} = \frac{Aa\omega}{p(p^{2} + \omega^{2})\operatorname{ch}\frac{l}{a}p}\operatorname{sh}\frac{x}{a}p  
	\end{align}

像函数比较复杂，利用反演公式和留数定理

.. math::
	\begin{align}
	u(t , x) = \frac{1}{2\pi \mathrm{i}} \int_{\sigma - \mathrm{i}\infty}^{\sigma + \mathrm{i}\infty} \bar{u}(p,x)e^{pt}~\mathrm{d}p
	= \sum \operatorname{Res}[\bar{u}(p,x)e^{pt}] 
	\end{align}

其中 :math:`\sum` 表示对 :math:`\bar{u}(p,x)e^{pt}` 的所有孤立奇点的留数求和。由于 :math:`\bar{u}(p,x)` 在 :math:`p` 平面上有可去奇点 :math:`p=0` ，一级极点 :math:`p = \pm \mathrm{i}\omega` 和 :math:`p = \pm \mathrm{i}\omega_{k}` ，其中 :math:`\omega_{k} = \frac{(2k - 1)\pi a}{2l}(k=1,2,3,\cdots)` ，故

.. math::
	\begin{align}
	u_{0}(t,x) &= \Big(\operatorname{Res}_{p=\mathrm{i}\omega} + \operatorname{Res}_{p=-\mathrm{i}\omega}\Big)[\bar{u}(p,x)e^{pt}] \\
	&= 2 \operatorname{Re}\Big\{ \operatorname{Res}_{p=\mathrm{i}\omega} [\bar{u}(p,x)e^{pt}] \Big\} \\
	&= 2 \operatorname{Re}\Big[ \frac{Aa\omega \operatorname{sh}(\frac{x}{a}p)e^{pt}}{p(p+\mathrm{i}\omega)\operatorname{ch}(\frac{l}{a}p)} \Big]_{p=\mathrm{i}\omega} \\
	&= \frac{Aa}{\omega \cos \frac{\omega l}{a}}\sin\frac{\omega x}{a}\sin\omega t 
	\end{align}

.. math::
	\begin{align}
	v(t,x) &= \sum\limits_{k=1}^{+\infty}\Big(\operatorname{Res}_{p=\mathrm{i}\omega_{k}} + \operatorname{Res}_{p=-\mathrm{i}\omega_{k}}\Big)[\bar{u}(p,x)e^{pt}] \\
	&= \sum\limits_{k=1}^{+\infty} 2 \operatorname{Re}\Big\{ \operatorname{Res}_{p=\mathrm{i}\omega_{k}} [\bar{u}(p,x)e^{pt}] \Big\} \\
	&= 2 \sum\limits_{k=1}^{+\infty}\operatorname{Re}\Big[ \frac{Aa\omega \operatorname{sh}(\frac{x}{a}p)e^{pt}}{p(p^{2}+\omega^{2})\frac{l}{a}\operatorname{sh}(\frac{l}{a}p)} \Big]_{p=\mathrm{i}\omega_{k}} \\
	&= 16Aa\omega l^{2} \sum\limits_{k=1}^{+\infty} \frac{(-1)^{k-1}\sin\frac{\omega_{k}}{a}x \sin\omega_{k}t}{(2k-1)\pi [4l^{2}\omega^{2} - (2k-1)^{2}\pi^{2}a^{2}]}
	\end{align}

最后得到三角级数形式的解 :math:`u(t,x) = u_{0}(t,x) + v(t,x)` 。

.. note:: 这里的 :math:`u_{0}(t,x)` 相应于用分离变量法求解时将边界条件齐次化的特解。在用Laplace变换求解时，对于非齐次边界条件不需要作特殊处理，这是它的优点，当然随之而来的是求反变换的麻烦。



基本解方法
=============

一个偏微分方程通常反映了某个物理场和引起这个场的场源之间的关系。最简单的场源是点源，连续分布的场源则可看成点源的叠加。对于线性偏微分方程，如果知道点源产生的场（称为基本解或点源函数），便可以通过线性叠加原理求出相应连续源产生的场，这就是基本解方法。由于点源的特殊性，基本解有可能用较简单、特殊的方法求得。因此，基本解方法成为求解线性偏微分方程的重要方法之一。

delta函数，广义函数简介
-------------------------

delta函数和广义函数
^^^^^^^^^^^^^^^^^^^^^^

描述一个在空间连续分布的物理量 :math:`Q` ，通常有两种方式。一种是局部性的，给出密度函数分布 :math:`\rho(M)=\frac{\mathrm{d}Q}{\mathrm{d}M},~ M\in\mathbb{R}^{n}(n=1,2,3)` ；另一种是整体性的，通过空间任意区域 :math:`\Omega \subset \mathbb{R}^{n}` 该物理量的总量

.. math::
	\begin{align}
	Q(\Omega) = \int_{\Omega}\rho(M)~\mathrm{d}M
	\end{align}

给出。对于集中分布的物理量，也可以通过这两种方式来表述。我们先来讨论集中分布物理量的密度函数。

.. note:: 

	考虑点电荷的线密度。直线 :math:`L` 上仅在 :math:`x=0` 处放置一单位电荷，这可以看成是单位电荷均匀分布在小区间 :math:`[-\varepsilon, \varepsilon]` 上当 :math:`\varepsilon \to 0` 时的极限情况。后者的密度

	.. math::
		\begin{align}
		\rho_{\varepsilon} = \left\{ \begin{array}{l}
		\frac{1}{2\varepsilon} ,\quad |x| \le \varepsilon \\
		0 ,\quad |x| > \varepsilon
		\end{array} \right.
		\end{align}

	且 :math:`\forall \varepsilon > 0` ，直线上的电荷总量

	.. math::
		\begin{align}
		Q = \int_{-\infty}^{+\infty}\rho_{\varepsilon}(x)~\mathrm{d}x = 1
		\end{align}

	令 :math:`\varepsilon \to 0` ，可由 :math:`\rho_{\varepsilon}(x)` 的极限推得单位点电荷的分布

	.. math::
		\begin{align}
		\rho(x) = \left\{ \begin{array}{l}
		+\infty ,\quad x=0 \\
		0 ,\quad x\ne 0
		\end{array} \right.
		\end{align}

	且保持直线上的电荷总量为 :math:`1` 。

将集中于 :math:`x=0` 点的单位物理量引起的密度函数成为 :math:`\delta` 函数，记为 :math:`\delta(x)` ，即 :math:`\delta(x)` 满足条件

.. math::
	\begin{align}
	\delta(x) = \left\{ \begin{array}{l}
	+\infty ,\quad x=0 \\
	0 ,\quad x\ne 0
	\end{array} \right.
	,\qquad
	\int_{-\infty}^{+\infty}\delta(x)~\mathrm{d}x = 1
	\end{align}

置于 :math:`x=\xi` 点的单位物理量引起的密度函数可以用 :math:`\delta(x)` 的平移 :math:`\delta(x-\xi)` 表示

.. math::
	\begin{align}
	\delta(x-\xi) = \left\{ \begin{array}{l}
	+\infty ,\quad x=\xi \\
	0 ,\quad x\ne \xi
	\end{array} \right.
	,\qquad
	\int_{-\infty}^{\infty}\delta(x-\xi)~\mathrm{d}x = 1
	\end{align}


.. note:: 

	考虑点热源产生的温度分布。温度为 :math:`0` 的均匀导热细杆，线密度为 :math:`\rho` ，比热为 :math:`c` 。在某一瞬间给 :math:`x=\xi` 点热量 :math:`Q` ，在加热的瞬间，热量尚未传播出去，在 :math:`x\ne \xi` 处，瞬时温度保持为 :math:`T(x) = 0` ；而在加热点 :math:`\xi` 处，加热瞬间温度上升

	.. math::
		\begin{align}
		T(\xi) = \lim_{\Delta x\to +0}\frac{Q}{c \rho\Delta x} = +\infty
		\end{align}

	整根杆上使温度增加的热量是确定的
	
	.. math::
		\begin{align}
		\int_{-\infty}^{+\infty}c\rho T(x)~\mathrm{d}x = Q
		\end{align}	

	对比 :math:`\delta` 函数的定义式，加热瞬时杆上的温度分布
	
	.. math::
		\begin{align}
		T(x) = \frac{Q}{c\rho}\delta(x - \xi)
		\end{align}	


.. note:: 

	考虑冲量一定的顺时力。在 :math:`t=\tau` 瞬间，有冲量一定的顺时力作用在质量为 :math:`m` 的静止小球上，小球产生速度为 :math:`v` 的匀速直线运动。显然，当 :math:`t\ne \tau` 时，小球所受外力 :math:`F(t)=0` 。在 :math:`t=\tau` 瞬间，小球得到动量

	.. math::
		\begin{align}
		mv = \lim_{\Delta t \to +0} F(\tau)\Delta t
		\end{align}

	因此，在 :math:`t=\tau` 瞬时，小球所受的外力 :math:`F(\tau)` 应该为 :math:`+\infty` 。又由动量守恒原理可知，在整个过程中

	.. math::
		\begin{align}
		mv = \int_{-\infty}^{+\infty}F(t)~\mathrm{d}t
		\end{align}

	所以，小球所受的外力

	.. math::
		\begin{align}
		F(t) = mv\delta(t-\tau)
		\end{align}


无论是关于空间还是关于时间集中分布的物理量都可以用 :math:`\delta` 函数来描述。关于时间集中分布的物理量在实际问题中常称为脉冲。

:math:`\delta` 函数有一条非常重要的基本性质，应用上称为 **筛选性** ，即对任意 :math:`\varphi(x) \in C(\mathbb{R})` ，

.. math::
	\begin{align}
	\int_{a}^{b}\delta(x)\varphi(x)~\mathrm{d}x = \left\{ \begin{array}{l}
	\varphi(0) ,\quad 0 \in [a,b] \\
	0 ,\quad 0 \notin [a,b]
	\end{array} \right.
	\end{align}

特别地

.. math::
	\begin{align}
	\int_{-\infty}^{\infty}\delta(x)\varphi(x)~\mathrm{d}x = \varphi(0)
	\end{align}

也可以这样看，由于当 :math:`x\ne 0` 时 :math:`\delta(x)=0` ，故

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}\delta(x)\varphi(x)~\mathrm{d}x
	= \int_{-\infty}^{+\infty}\delta(x)\varphi(0)~\mathrm{d}x
	= \varphi(0) \int_{-\infty}^{+\infty}\delta(x)~\mathrm{d}x
	= \varphi(0)
	\end{align}

:math:`\delta(x-\xi)` 的筛选性为

.. math::
	\begin{align}
	\int_{a}^{b}\delta(x-\xi)\varphi(x)~\mathrm{d}x
	= \left\{ \begin{array}{l}
	\varphi(\xi) ,\quad \xi \in [a,b] \\
	0 ,\quad \xi \notin [a,b]
	\end{array} \right.
	\end{align}

特别地

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}\delta(x-\xi)\varphi(x)~\mathrm{d}x = \varphi(\xi)
	\end{align}

筛选性表达式就是集中分布物理量的另一种数学描述。当 :math:`\varphi(x)=1` 时，筛选性说明，只要区间里包含 :math:`x=0` 点，该区间内此物理量的总量为 :math:`1` ，否则总量为 :math:`0` 。对于一般的 :math:`\varphi(x)` ，筛选性表达式是 :math:`\varphi(x)` 在 :math:`[a,b]` 上以 :math:`\delta(x)` 为权函数的加权平均，同样反映了 :math:`\delta(x)` 的集中分布性。所以，也可以把筛选性作为 :math:`\delta(x)` 的另一种定义。

选用筛选性作为 :math:`\delta(x)` 的定义则可以对其产生一种全新认识。 :math:`\delta` 函数实际上是一个映射，它把 :math:`C(\mathbb{R})` 中的元素 :math:`\varphi(x)` 映成了 :math:`\mathbb{R}` 中的一个数 :math:`\varphi(0)` 。称函数空间到数域的线性映射为函数空间上的一个线性泛函，则 :math:`\delta` 函数就是 :math:`C(\mathbb{R})` 上的一个特殊的线性泛函，用内积或积分形式记 :math:`\delta` 函数对应的泛函值，即

.. math::
	\begin{align}
	\left \langle \delta(x), \varphi(x)  \right \rangle = \int_{-\infty}^{+\infty}\delta(x)\varphi(x)~\mathrm{d}x = \varphi(0)
	\end{align}

如果一个只在有限区间上不为 :math:`0` 的可积函数 :math:`f(x)` ，则由

.. math::
	\begin{align}
	\left \langle f(x),\varphi(x) \right \rangle = \int_{-\infty}^{+\infty}f(x)\varphi(x)~\mathrm{d}x
	\end{align}

也确定了一个 :math:`C(\mathbb{R})` 上的线性泛函。所以，从线性泛函的角度， :math:`\delta(x)` 和 :math:`f(x)` 并无二异。

称 :math:`C(\mathbb{R})` 上的线性泛函为 **广义函数** ，线性泛函的全体构成一个广义函数空间，记为 :math:`C'(\mathbb{R})` ，称为基本函数空间 :math:`C(\mathbb{R})` 的对偶空间。上述 :math:`\delta(x), f(x)` 均为广义函数，称 :math:`\delta(x)` 为奇异广义函数，称 :math:`f(x)` 为正则广义函数。

基本函数空间可以是不同的，定义在其上的线性泛函的全体构成的广义函数空间也就不同。例如，基本函数空间是 :math:`C^{\infty}(\mathbb{R})` 时，与其对偶的广义函数空间就记为 :math:`(C^{\infty}(\mathbb{R}))'` ，上述 :math:`\delta(x), f(x)` 也都是此空间中的广义函数。以后常常用 :math:`\varphi(x), \varphi_{n}(x), \psi(x)` 等表示基本函数空间中的函数，而广义函数空间中的广义函数常常用 :math:`f(x),f_{n}(x),g(x)` 等表示。



delta函数和广义函数的性质和运算
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

对称性
""""""""""""
  
.. math::
	\begin{align}
	\delta(x-\xi) = \delta(\xi - x)
	,\quad
	\text{特别地，有}
	\quad
	\delta(x)=\delta(-x)
	\end{align}

这是由于 :math:`\forall \varphi(x) \in C(\mathbb{R})` ，

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}\delta(\xi - x)\varphi(x)~\mathrm{d}x
	= \int_{-\infty}^{+\infty}\delta(u)\varphi(\xi - u)~\mathrm{d}u
	= \varphi(\xi - u)|_{u=0}
	= \varphi(\xi)
	\end{align}

与 :math:`\delta(x-\xi)` 对 :math:`\varphi(x)` 的筛选作用相同。


:math:`\delta` 函数与连续函数的乘积
"""""""""""""""""""""""""""""""""""""""
  
对于连续函数 :math:`a(x)` ，有

.. math::
	\begin{align}
	a(x) \delta(x-\xi) = a(\xi)\delta(x - \xi)
	\end{align}

这是因为 :math:`\forall \varphi(x) \in C(\mathbb{R})` ，

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}a(x)\delta(x-\xi)\varphi(x)~\mathrm{d}x
	= \int_{-\infty}^{+\infty}\delta(x-\xi)[a(x)\varphi(x)]~\mathrm{d}x
	= a(\xi)\varphi(\xi)
	\end{align}

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}a(\xi)\delta(x-\xi)\varphi(x)~\mathrm{d}x
	= a(\xi)\int_{-\infty}^{+\infty}\delta(x-\xi)\varphi(x)~\mathrm{d}x
	= a(\xi)\varphi(\xi)
	\end{align}

可以看到，当 :math:`a(\xi)=0` 时，不定式 :math:`a(x)\delta(x-\xi)=0` 。例如，我们有 :math:`x^{n}\delta(x)=0,~n=1,2,\cdots` 。


:math:`\delta` 函数与普通函数的复合
""""""""""""""""""""""""""""""""""""""
  
设 :math:`u(x) \in C^{1}(\mathbb{R})` ，且在实轴上只有单零点 :math:`x_{k}(k=1,2,\cdots,N)` ，则复合函数

.. math::
	\begin{align}
	\delta(u(x)) = \sum_{k=1}^{N}\frac{\delta(x-x_{k})}{|u'(x_{k})|}
	\end{align}

可以这样看， :math:`\forall \varphi(x) \in C(\mathbb{R})` ，由于 :math:`u(x_{k})=0~(k=1,2,\cdots,N)` ，有

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}\delta[u(x)]\varphi(x)~\mathrm{d}x
	= \sum_{k=1}^{N}\int_{x_{k}-\varepsilon_{k}}^{x_{k}+\varepsilon_{k}}\delta[u(x)]\varphi(x)~\mathrm{d}x
	\end{align}

其中 :math:`\varepsilon_{k}` 为小正数。又由于 :math:`u'(x_{k}) \ne 0` 及 :math:`u'(x)` 连续，总可以将相应的 :math:`\varepsilon_{k}` 取得足够小，使 :math:`u'(x)` 在积分区间 :math:`[x_{k}-\varepsilon_{k}, x_{k}+\varepsilon_{k}]` 上不变号。不妨假设 :math:`u'(x_{k})<0` ，则 :math:`u(x)` 在此区间上严格单调下降。作变量代换 :math:`u=u(x)` ，记 :math:`u_{1} = u(x_{k}+\varepsilon_{k}), u_{2} = u(x_{k}-\varepsilon_{k})` ，有 :math:`u_{1} < 0 < u_{2}` ，所以

.. math::
	\begin{align}
	\int_{x_{k}-\varepsilon_{k}}^{x_{k}+\varepsilon_{k}}\delta[u(x)]\varphi(x)~\mathrm{d}x
	= - \int_{u_{1}}^{u_{2}}\delta(u)\varphi(x(u))x'(u)~\mathrm{d}u
	= \int_{u_{1}}^{u_{2}}\delta(u)\frac{\varphi(x(u))}{-u'(x)}~\mathrm{d}u
	= \frac{\varphi(x(u))}{|u'(x(u))|}\Big|_{u=0}
	= \frac{\varphi(x_{k})}{|u'(x_{k})|}
	\end{align}

而我们所考虑的复合函数公式右边的每一项对 :math:`\varphi(x)` 的作用也得到

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}\frac{\delta(x-x_{k})}{|u'(x_{k})|}\varphi(x)~\mathrm{d}x = \frac{\varphi(x_{k})}{|u'(x_{k})|}
	\end{align}


.. note:: 

	利用复合公式可以得到很多有用的结果，例如

	.. math::
		\begin{align}
		& \delta(ax) = \frac{\delta(x)}{|a|} \\
		& \delta(x^{2}-a^{2}) = \frac{\delta(x-a)}{2|a|} + \frac{\delta(x+a)}{2|a|} = \frac{\delta(x-a)}{2|x|} + \frac{\delta(x+a)}{2|x|} \\
		& \delta(\sin x) = \sum_{k=-\infty}^{+\infty}\delta(x-k\pi) \\
		& |x|\delta(x^{2}) = \lim_{a\to 0}|x|\delta(x^{2}-a^{2}) = \delta(x)
		\end{align}


:math:`\delta` 函数和广义函数的导数
""""""""""""""""""""""""""""""""""""""

为了使 :math:`\delta` 函数和一般的广义函数无穷次可导，也为了扩大广义函数的范围，就要使基本函数空间具有 :math:`C^{\infty}(\mathbb{R})` 的光滑性且还要有其他较强的性质，为此引入 :math:`C_{0}^{\infty}(\mathbb{R})` （或者记为 :math:`\mathscr{D}(\mathbb{R})` ）基本函数空间，它包含的函数 :math:`\varphi(x)` 是无穷次连续可导而且在一个有界的闭区间外为零。例如，最典型的是下面这类函数

.. math::
	\begin{align}
	\varphi(x) = b(x)\eta(x,a)
	,\quad
	\eta(x,a) = \left\{ \begin{array}{l}
	e^{\frac{1}{x^{2}-a^{2}}} ,\quad |x|<a \\
	0 ,\quad |x| \ge a
	\end{array} \right.
	,\quad
	b(x) \in C^{\infty}(\mathbb{R})
	\end{align}

定义在 :math:`\mathscr{D}(\mathbb{R})` 上线性泛函的全体构成一个广义函数空间 :math:`\mathscr{D}'(\mathbb{R})` ， :math:`\delta(x)` 是其中一个奇异广义函数，任何一个局部可积的函数 :math:`f(x)` 均为正则广义函数，它们的泛函值分别为

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}\delta(x)\varphi(x)~\mathrm{d}x = \varphi(0)
	,\qquad
	\int_{-\infty}^{+\infty}f(x)\varphi(x)~\mathrm{d}x
	\end{align}

如果 :math:`f(x)` 是 :math:`\mathscr{D}'(\mathbb{R})` 中的广义函数，则 :math:`f^{(n)}(x)` 也是一个广义函数，其定义为

.. math::
	\begin{align}
	\left \langle f^{(n)}(x), \varphi(x) \right \rangle 
	:= (-1)^{n} \left \langle f(x), \varphi^{(n)}(x) \right \rangle 
	,\quad
	\forall \varphi(x) \in C_{0}^{\infty}(\mathbb{R})
	\end{align}

用积分的形式来表示即为

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}f^{(n)}(x)\varphi(x)~\mathrm{d}x
	:= (-1)^{n}\int_{-\infty}^{+\infty}f(x)\varphi^{(n)}(x)~\mathrm{d}x
	\end{align}

在形式上相当于进行分部积分，把对广义函数的求导运算转移到基本函数上，特别地

.. math::
	\begin{align}
	\int_{-\infty}^{+\infty}\delta^{(n)}(x)\varphi(x)~\mathrm{d}x
	= (-1)^{n}\int_{-\infty}^{+\infty}\delta(x)\varphi^{(n)}(x)~\mathrm{d}x
	= (-1)^{n}\varphi^{(n)}(0)
	\end{align}

这样，任何一个广义函数均是无穷次可导的，特别地任何一个连续函数 :math:`f(x)` 是无穷次可导的。


广义函数的原函数和 :math:`\delta` 函数的原函数
"""""""""""""""""""""""""""""""""""""""""""""""""

如果 :math:`g'(x)=f(x)` ，则称 :math:`g(x)` 是 :math:`f(x)` 的一个原函数，这时 :math:`g(x)+C` 也是 :math:`f(x)` 的原函数。特别地，不难直接证明 :math:`H'(x) = \delta(x)` ，即 :math:`H(x)` 是 :math:`\delta(x)` 的一个原函数。这个结果形式上也可以从 :math:`\delta(x)` 变上限积分得到，即

.. math::
	\begin{align}
	\int_{-\infty}^{x}\delta(x)~\mathrm{d}x
	= \left\{ \begin{array}{l}
	0 ,\quad x<0 \\
	1 ,\quad x\ge 0
	\end{array} \right.
	\quad= H(x)
	\end{align}

根据原函数的概念，要求 :math:`\delta(x)` 的原函数就是要求微分方程 :math:`y'(x) = \delta(x)` 的解，方程的通解为 :math:`H(x) + C` ，如果取 :math:`C=-\frac{1}{2}` ，可以得到 :math:`\delta(x)` 的另一个函数 :math:`\frac{1}{2}\operatorname{sgn}x` 。


广义函数的卷积、 :math:`\delta` 函数和广义函数的卷积
"""""""""""""""""""""""""""""""""""""""""""""""""""""""

如果 :math:`f(x), g(x)` 为两个广义函数，则卷积 :math:`h(x) = f(x)*g(x)` 定义了一个广义函数 :math:`h(x)` 如下：

.. math::
	\begin{align}
	\left \langle h(x),\varphi(x) \right \rangle
	:= \left \langle f(x), \left\langle g(y), \varphi(x+y) \right\rangle \right \rangle 
	\end{align}

即用累次泛函来定义。广义函数的卷积仍形式地记为

.. math::
	\begin{align}
	f(x)*g(x) = \int_{-\infty}^{+\infty}f(\xi)g(x-\xi)~\mathrm{d}\xi
	\end{align}

如果形式地交换积分的顺序并进行变数代换，得到

.. math::
	\begin{align}
	\langle h(x), \varphi(x) \rangle
	= \int_{-\infty}^{+\infty}f(\xi)~\mathrm{d}\xi \int_{-\infty}^{+\infty}g(u)\varphi(\xi+u)~\mathrm{d}u
	= \langle f(x), \langle g(y), \varphi(x+y) \rangle \rangle
	\end{align}

特别地，不难得到

.. math::
	\begin{align}
	& \delta(x) * f(x) = f(x) \\
	& \delta'(x) * f(x) = \delta(x) * f'(x) = f'(x) \\
	& \delta^{(n)}(x) * f(x) = \delta(x) * f^{(n)}(x) = f^{(n)}(x) \\
	& L(f(x) * g(x)) = (Lf) * g = f * (Lg)
	\end{align}

其中， :math:`L` 是常系数线性微分算子。




广义函数和 :math:`\delta` 函数的Fourier变换
"""""""""""""""""""""""""""""""""""""""""""""""

为了自由地进行广义函数的 :math:`FT` 和 :math:`F^{-1}T` 又需要引入另一个基本函数空间 :math:`\varphi(\mathbb{R})` ，它的函数 :math:`\varphi(x)` 是无穷次连续可导且是速降的，即对于任意非负整数 :math:`m` 和 :math:`n` ，当 :math:`|x| \to +\infty` 时， :math:`x^{m}\varphi^{(n)}(x) \to 0` 。这种函数最典型的一类是 :math:`p(x)e^{-ax^{2}}~(a>0)` ，其中 :math:`p(x)` 是 :math:`x` 的多项式。在 :math:`\varphi(\mathbb{R})` 上线性泛函的全体构成一个对偶的广义函数空间 :math:`\varphi'(\mathbb{R})` ， :math:`\delta(x)` 也是它的奇异广义函数、任意一个局部可积的函数 :math:`f(x)` ，且当 :math:`|x| \to \infty` 时 :math:`f(x)` 的增长不超过一个多项式，这时 :math:`f(x)` 是 :math:`\varphi'(\mathbb{R})` 的正则广义函数。

如果 :math:`f(x) \in \varphi'(\mathbb{R})` ，则 :math:`F[f], F^{-1}[f]` 也是广义函数，定义如下：

.. math::
	\begin{align}
	\langle F[f], \varphi \rangle := \langle f, F[\varphi] \rangle
	,\qquad
	\langle F^{-1}[f], \varphi \rangle := \langle f, F^{-1}[\varphi] \rangle
	\end{align}

即把 :math:`FT` 和 :math:`F^{-1}T` 转移到基本函数上。广义函数的 :math:`FT` 和 :math:`F^{-1}T` 仍记为

.. math::
	\begin{align}
	F[f] = \int_{-\infty}^{+\infty}f(x)e^{-\mathrm{i} \lambda x}~\mathrm{d}x = \hat{f}(\lambda)
	,\quad
	F^{-1}[f] = \frac{1}{2\pi}\int_{-\infty}^{+\infty}f(\lambda)e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda
	\end{align}

这样， :math:`FT` 建立了 :math:`\varphi'(\mathbb{R})` 中广义函数之间一一对应的关系

.. math::
	\begin{align}
	f(x) \overset{FT}{\underset{F^{-1}T}{\rightleftharpoons}} \hat{f}(\lambda)
	\end{align}

而且保持着 :math:`FT` 的基本性质：线性性质、微分性质、像函数的微分性质、平移性质、频移性质、相似性质、反射性质和卷积性质。根据这些性质由某几个特殊的广义函数的 :math:`FT` 就能得出许多广义函数的 :math:`FT` 。特别地由于

.. math::
	\begin{align}
	F[\delta(x)] = \int_{-\infty}^{+\infty}\delta(x)e^{-\mathrm{i}\lambda x}~\mathrm{d}x = 1
	\end{align}

可以得到

.. math::
	\begin{align}
	& 1 \overset{FT}{\underset{F^{-1}T}{\rightleftharpoons}} 2\pi \delta(\lambda) \\
	& e^{\mathrm{i}ax} \rightleftharpoons 2\pi \delta(\lambda - a) \\
	& \cos ax \rightleftharpoons \pi [\delta(\lambda + a) + \delta(\lambda - a)] \\
	& \sin ax \rightleftharpoons \mathrm{i}\pi [\delta(\lambda + a) - \delta(\lambda - a)] \\
	& x \rightleftharpoons 2\pi \mathrm{i}\delta'(\lambda)
	\end{align}

如果用积分形式来表示，可以得到

.. math::
	\begin{align}
	& \int_{-\infty}^{\infty} e^{\pm \mathrm{i}\lambda x}~\mathrm{d}x = 2\pi \delta(\lambda) \\
	& \int_{-\infty}^{\infty} \cos\lambda x~\mathrm{d}x = 2\pi \delta(\lambda) \\
	& \int_{-\infty}^{+\infty}x e^{-\mathrm{i}\lambda x}~\mathrm{d}x = 2\pi \mathrm{i}\delta'(\lambda)
	\end{align}



delta函数的Fourier展开
""""""""""""""""""""""""""

当 :math:`x,\xi \in (-\pi, \pi)` 时

.. math::
	\begin{align}
	\delta(x - \xi) = \frac{a_{0}}{2} + \sum_{n=1}^{+\infty}(a_{n}\cos nx + b_{n}\sin nx)
	\end{align}

其中Fourier系数为

.. math::
	\begin{align}
	& a_{n} = \frac{1}{\pi} \int_{-\pi}^{\pi}\delta(x - \xi)\cos nx~\mathrm{d}x = \frac{1}{\pi}\cos n\xi \\
	& b_{n} = \frac{1}{\pi} \int_{-\pi}^{\pi}\delta(x - \xi)\sin nx~\mathrm{d}x = \frac{1}{\pi}\sin n\xi
	\end{align}

对于其他的正交基， :math:`\delta` 函数同样可以作广义Fourier展开。



广义函数序列的收敛性和delta序列
""""""""""""""""""""""""""""""""""""

设 :math:`f_{n}(x)` 为一个广义函数的序列， :math:`f(x)` 为一个广义函数，如果对于基本函数空间上的任意函数 :math:`\varphi(x)` 均有

.. math::
	\begin{align}
	\lim_{n\to\infty} \int_{-\infty}^{+\infty}f_{n}(x)\varphi(x)~\mathrm{d}x = \int_{-\infty}^{+\infty}f(x)\varphi(x)~\mathrm{dx}
	\end{align}

则称 :math:`\lim\limits_{n \to \infty}f_{n}(x) \overset{w}{=} f(x)` ，这种收敛称为弱收敛和弱极限。特别地，弱收敛于 :math:`\delta` 函数的序列称为 :math:`\delta` 序列，典型的几个 :math:`\delta` 序列为：

- 矩形脉冲序列： :math:`\lim\limits_{\varepsilon \to 0^{+}}\rho_{\varepsilon}(x) \overset{w}{=} \delta(x)` ；
- Cauchy脉冲序列： :math:`\lim\limits_{\varepsilon \to 0^{+}}\frac{\varepsilon}{\pi(x^{2} + \varepsilon^{2})} \overset{w}{=} \delta(x)` ；
- Gauss脉冲序列： :math:`\lim\limits_{\varepsilon \to 0^{+}}\frac{1}{\sqrt{2\pi} t}e^{-\frac{x^{2}}{2t^{2}}} \overset{w}{=} \delta(x)` ；
- 采样脉冲序列： :math:`\lim\limits_{N \to +\infty}\frac{\sin Nx}{\pi x} \overset{w}{=} \delta(x)` 。
  

直观地看，这些函数列趋于 :math:`\delta(x)` ，而且其中每一个函数在实轴上的积分为 :math:`1` 。严格的证明需要从弱收敛定义出发。

利用 :math:`\delta` 序列可以验证Fourier反变换公式。例如，由采样脉冲序列可知

.. math::
	\begin{align}
	F^{-1}[1] = \frac{1}{2\pi}\int_{-\infty}^{+\infty}e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda
	= \lim_{N \to +\infty}\frac{1}{2\pi}\int_{-N}^{N}e^{\mathrm{i}\lambda x}~\mathrm{d}\lambda
	= \lim_{N \to +\infty}\frac{\sin Nx}{\pi x}
	\overset{w}{=} \delta(x)
	\end{align}

另外，不难证明 :math:`\lim\limits_{n \to \infty}\sin nx \overset{w}{=} 0` ， :math:`\lim\limits_{n \to \infty}\cos nx \overset{w}{=} 0` 。前面所述的 :math:`\delta(x)` 的Fourier级数展开也是在弱收敛意义下的展开式，有时弱收敛也用通常的记号表示。




高维delta函数和广义函数
^^^^^^^^^^^^^^^^^^^^^^^^^^^



Lu=0型方程的基本解
----------------------

这里讨论用基本解方法求解方程

.. math::
	\begin{align}
	Lu = f(x,y,z) ,\quad -\infty< x,y,z < +\infty
	\end{align}

其中 :math:`L` 是关于 :math:`x,y,z` 的常系数线性偏微分算子。现在可以把 :math:`u` 和 :math:`f` 均作为广义函数，在广义函数空间中可以较自由地进行各种运算和变换来求得方程的解，这种解是广义函数，称之为广义解。通常这种解是一个正则广义函数，甚至还有足够的光滑性，那么这种解就称为古典解。当方程的右端为 :math:`\delta(x,y,z)` 时，所得的解 :math:`U(x,y,z)` 称为方程的基本解，其物理意义就是由点源而产生的物理场。根据基本解可以得出一般的右端函数所对应的解，即一般的源所对应的物理场。基本解不但数学上讨论较为容易，而且有时可以根据问题的物理意义求出。



基本解和解的积分表达式
^^^^^^^^^^^^^^^^^^^^^^^^^^

以场位方程为例

.. math::
	\begin{align}
	\Delta_{3}u = f(M) ,\quad M=(x,y,z) \in \mathbb{R}^{3} 
	\end{align}

这里 :math:`f(M) = -\frac{\rho(M)}{\varepsilon}` ， :math:`\rho(M)` 为空间电荷分布， :math:`\varepsilon` 为介电常数。

由 :math:`\delta` 函数与广义函数的卷积运算，有

.. math::
	\begin{align}
	f(M) = \delta(M) * f(M)
	= \int_{\mathbb{R}^{3}}\delta(M - M_{0})f(M_{0})\mathrm{d}M_{0}
	\end{align}

这说明一般源 :math:`f(M)` 可以看成置于 :math:`M_{0}` 点的点源 :math:`f(M_{0})\delta(M - M_{0})` 的积分叠加。由积分叠加原理可知，只要求出方程

.. math::
	\begin{align}
	\Delta_{3}V = \delta(M - M_{0})
	,\quad
	M=(x,y,z),~ M_{0}=(\xi,\eta,\zeta) \in \mathbb{R}^{3}
	\end{align}

的解 :math:`V(M;M_{0})` ，便可以得到原方程的解

.. math::
	\begin{align}
	u(M) = \int_{\mathbb{R}^{3}}V(M;M_{0})f(M_{0})~\mathrm{d}M_{0}
	\end{align}

由于在全空间求解，不妨先求解方程

.. math::
	\begin{align}
	\Delta_{3}U = \delta(M) ,\quad M\in\mathbb{R}^{3}
	\end{align}

如果上式的解为 :math:`U(M)` ，则平移可以得到 :math:`V(M;M_{0}) = U(M - M_{0})` ，进而有

.. math::
	\begin{align}
	u(M) = \int_{\mathbb{R}^{3}}U(M-M_{0})f(M_{0})~\mathrm{d}M_{0}
	= U(M) * f(M)
	\end{align}

该公式反映了一般的源产生的是点源产生场的叠加。这里起基本作用的是置于原点的点源 :math:`\delta(M)` 产生的场 :math:`U(M)` ，称它为基本解。一般有如下定义：方程 :math:`LU = \delta(M)` 的解 :math:`U(M)` 称为 :math:`Lu=0` 型方程的基本解，其中 :math:`L` 是关于自变量 :math:`M = (x,y,z)` 的常系数线性偏微分算子。

由定义可知，基本解是点源产生的场，物理上也称为点源函数。这里的基本解没有定解条件限制，因此不是唯一的，可以相差齐次方程 :math:`Lu=0` 的解，通常根据问题的物理意义和数学的需要选定其中一个。基本解满足的方程的右端是 :math:`\delta(M)` ，因此基本解已经不是古典解，而是一种广义解。


由基本解可以得到非其次方程 :math:`Lu = f(M)` 的解的积分公式。设 :math:`U(M)` 是 :math:`Lu = 0` 型方程的基本解，则

.. math::
	\begin{align}
	u = U(M) * f(M)
	= \int_{\mathbb{R}^{3}}U(M-M_{0})f(M_{0})~\mathrm{d}M_{0}
	\end{align}

满足方程

.. math::
	\begin{align}
	Lu = f(M)
	\end{align}

.. note:: 

	证明如下：由 :math:`LU(M - M_{0}) = \delta(M - M_{0})` ，有

	.. math::
		\begin{align}
		Lu = L(U(M) * f(M))
		= \int_{\mathbb{R}^{3}}LU(M - M_{0})f(M_{0})~\mathrm{d}M_{0}
		= \int_{\mathbb{R}^{3}}\delta(M - M_{0})f(M_{0})~\mathrm{d}M_{0}
		= f(M)
		\end{align}

	这里我们毫无顾忌地交换了微分和积分的次序，这在经典分析中是不允许的，但是，现在我们求的是广义解，在广义函数理论中广义函数的微分与卷积可以交换次序，形式上便是微分与积分可以任意交换次序。


基本解的求法
^^^^^^^^^^^^^^^

从数学上求基本解，即在全空间求解方程 :math:`Lu = \delta(M)` 。 :math:`\delta(M)` 并非普通函数，但由相关的运算和性质，可以像对待普通函数一样求解这个方程。另一方面，由 :math:`\delta` 函数的筛选性，也可以采用一些特殊方法求解。

.. note:: 

	要求常微分方程 :math:`y' + ay = 0` 的基本解，这里常数 :math:`a>0` ，也即求方程

	.. math::
		\begin{align}
		U' + aU = \delta(x)
		\end{align}

	的解。将方程两边同乘 :math:`e^{ax}` ，得到

	.. math::
		\begin{align}
		\frac{\mathrm{d}}{\mathrm{d}x}(e^{ax}U) = e^{ax}\delta(x) = \delta(x)
		\end{align}

	由于 :math:`H'(x) = \delta(x)` ，取基本解

	.. math::
		\begin{align}
		U(x) = e^{-ax}H(x)
		\end{align}

	利用解的积分公式，可以得到非齐次方程 :math:`y'+ay=f(x)` 的一个解

	.. math::
		\begin{align}
		y(x) = U * f(x)
		= \int_{-\infty}^{+\infty}e^{-a\xi}H(\xi)f(x-\xi)~\mathrm{d}\xi
		= \int_{0}^{+\infty}e^{-a\xi}f(x - \xi)~\mathrm{d}\xi
		= \int_{-\infty}^{x}e^{-a(x - \xi)}f(\xi)~\mathrm{d}\xi
		\end{align}



.. note:: 

	求三维Laplace方程的基本解，可以用三维FT求解

	.. math::
		\begin{align}
		\Delta_{3}U = \delta(x,y,z) ,\quad -\infty < x,y,z < +\infty
		\end{align}

	记 :math:`\hat{U}(\lambda,\mu,\nu) = F[U(x,y,z)]` 。由于 :math:`F[\delta(x,y,z)] = 1` ，像函数满足代数方程

	.. math::
		\begin{align}
		-(\lambda^{2} + \mu^{2} + \nu^{2})\hat{U} = 1
		\end{align} 

	解得

	.. math::
		\begin{align}
		\hat{U} = -\frac{1}{\rho^{2}}
		,\quad
		\rho^{2} = \lambda^{2} + \mu^{2} + \nu^{2}
		,\quad
		(\lambda,\mu,\nu) \in \mathbb{R}^{3}
		\end{align}

	作反变换，得到

	.. math::
		\begin{align}
		U = F^{-1}[\hat{U}] = -\frac{1}{(2\pi)^{3}}\iiint\limits_{-\infty}^{+\infty} \frac{1}{\rho^{2}} e^{\mathrm{i}(\lambda x + \mu y + \nu z)}~\mathrm{d}\lambda\mathrm{d}\mu\mathrm{d}\nu
		= -\frac{1}{(2\pi)^{3}} \iiint\limits_{-\infty}^{+\infty} \frac{1}{\rho^{2}} e^{\mathrm{i}\mathbf{\rho} \cdot \mathbf{r}}~\mathrm{d}\lambda\mathrm{d}\mu\mathrm{d}\nu
		= -\frac{1}{(2\pi)^{3}} \iiint\limits_{-\infty}^{+\infty} \frac{1}{\rho^{2}} e^{\mathrm{i}\rho r\cos\theta}\mathrm{d}\lambda\mathrm{d}\mu\mathrm{d}\nu
		\end{align}

	这里，向量 :math:`\mathbf{\rho} = (\lambda, \mu, \nu)` ， :math:`\mathbf{r} = (x,y,z)` ， :math:`r^{2} = x^{2} + y^{2} + z^{2}` ， :math:`\theta` 为 :math:`\mathbf{\rho}` 与 :math:`\mathbf{r}` 的夹角。由于积分区域是全空间，被积函数关于向量 :math:`\mathbf{r}` 轴对称，不妨将 :math:`\nu` 轴取在 :math:`\mathbf{r}` 方向，作球坐标变换

	.. math::
		\begin{align}
		\lambda = \rho\sin\theta\cos\varphi
		,\quad
		\mu = \rho\sin\theta\sin\varphi
		,\quad
		\nu = \rho\cos\theta
		\end{align}

	得到

	.. math::
		\begin{align}
		U(x,y,z) = -\frac{1}{(2\pi)^{3}} \int_{0}^{+\infty}\int_{0}^{\pi}\int_{0}^{2\pi}e^{\mathrm{i}\rho r\cos\theta}\sin\theta~\mathrm{d}\varphi\mathrm{d}\theta\mathrm{d}\rho
		= \frac{1}{(2\pi)^{2}}\int_{0}^{+\infty} \frac{e^{\mathrm{i}\rho r\cos\theta}}{\mathrm{i}\rho r}\Big|_{0}^{\pi}~\mathrm{d}\rho
		= -\frac{1}{2\pi^{2}r} \int_{0}^{+\infty}\frac{\sin \rho r}{\rho}~\mathrm{d}\rho
		= -\frac{1}{4\pi r}
		\end{align}

	这个基本解就是置于原点的 :math:`-\varepsilon` 电荷在无穷远零电位的条件下在全空间产生的电场。


还可以利用 :math:`\delta` 函数的筛选性来求基本解，这需要用到场论里的Green公式。设区域 :math:`V` 由分片光滑闭曲面 :math:`S` 围成， :math:`u(M), v(M)` 在区域 :math:`V` 内有二阶连续偏导数，在 :math:`V \cup S` 上有一阶连续偏导数，则有

.. math::
	\begin{align}
	\oint_{S}u\frac{\partial v}{\partial n}\mathrm{d}S = \iiint_{V}u\Delta v~\mathrm{d}V + \iiint_{V}\nabla u \cdot \nabla v~\mathrm{d}V
	\end{align}

.. math::
	\begin{align}
	\oint_{S}\Big( u\frac{\partial v}{\partial n} - v\frac{\partial u}{\partial n} \Big)~\mathrm{d}S
	= \iiint_{V}(u\Delta v - v\Delta u)\mathrm{d}V
	\end{align}

类似地，有二维Green公式

.. math::
	\begin{align}
	\oint_{l}u\frac{\partial v}{\partial n}\mathrm{d}l = \iint_{D}u\Delta v~\mathrm{d}A + \iint_{D}\nabla u \cdot \nabla v~\mathrm{d}A
	\end{align}

.. math::
	\begin{align}
	\oint_{l}\Big( u\frac{\partial v}{\partial n} - v\frac{\partial u}{\partial n} \Big)~\mathrm{d}l = \iint_{D}(u\Delta v - v\Delta u)\mathrm{d}A
	\end{align}

其中 :math:`l` 是有界区域 :math:`D` 的边界， :math:`\mathbf{n}` 是边界的外法向。

可以得到一个推论，对于Helmholtz算子 :math:`L = \Delta \pm k^{2}` ，也有Green第二公式。在二维情况时为

.. math::
	\begin{align}
	\oint_{l} \Big(u\frac{\partial v}{\partial n} - v \frac{\partial u}{\partial n}\Big)~\mathrm{d}l
	= \iint_{D}(u Lv - vLu)~\mathrm{d}A
	\end{align}


.. note:: 

	求二维Helmholtz方程 :math:`\Delta_{2}u + cu = 0~(c = k^{2}>0)` 的基本解，基本解满足方程

	.. math::
		\begin{align}
		LU = \Delta_{2}U + k^{2}U = \delta(x,y)
		\end{align} 

	由方程的对称性，设 :math:`U = U(r)` ，在极坐标下方程可以改写成

	.. math::
		\begin{align}
		\frac{1}{r}\frac{\mathrm{d}}{\mathrm{d}r}\Big(r\frac{\mathrm{d}U}{\mathrm{d}r}\Big) + k^{2}U = 0 ,\quad r > 0
		\end{align}

	也即

	.. math::
		\begin{align}
		r^{2}U'' + rU' + k^{2}r^{2}U = 0
		\end{align}	

	这是零阶Bessel方程，其通解为

	.. math::
		\begin{align}
		U(r) = AJ_{0}(kr) + BN_{0}(kr)
		\end{align}

	由于 :math:`J_{0}(kr)` 在 :math:`r=0` 无奇性，是齐次方程 :math:`\Delta_{2}u + k^{2}u = 0` 在全平面的解，故可以取 :math:`A = 0` 。而 :math:`N_{0}(kr)` 在 :math:`r=0` 有奇性，有望通过 :math:`B` 的选取成为基本解。

	令 :math:`U(r) = BN_{0}(kr) \sim B\frac{2}{\pi}\ln(kr)` ，取 :math:`\varphi(x,y) \in C_{0}^{+\infty}(\mathbb{R}^{2})` ，即在全平面上有任意阶连续偏导且在一个包含原点的有界区域 :math:`\Omega` 外恒为零的函数（紧支函数），则

	.. math::
		\begin{align}
		\varphi(0,0) = \iint_{\mathbb{R}^{2}}\delta(x,y)\varphi(x,y)~\mathrm{d}A
		= \iint_{\mathbb{R}^{2}}LU\varphi(x,y)~\mathrm{d}A
		= \iint_{\mathbb{R}^{2}}UL\varphi(x,y)~\mathrm{d}A
		\end{align}

	上面的后一个等式来自广义函数求导的规定

	.. math::
		\begin{align}
		\iint_{\mathbb{R}^{2}}\frac{\partial U}{\partial x}\varphi~\mathrm{d}A
		= -\iint_{\mathbb{R}^{2}}U\frac{\partial \varphi}{\partial x}~\mathrm{d}A
		,\quad
		\iint_{\mathbb{R}^{2}}\frac{\partial U}{\partial y}\varphi~\mathrm{d}A
		= -\iint_{\mathbb{R}^{2}}U\frac{\partial \varphi}{\partial y}~\mathrm{d}A
		\end{align}

	由于 :math:`U(r)` 在 :math:`r = 0` 有奇性，以原点为中心， :math:`\varepsilon` 为半径取小圆盘 :math:`D_{\varepsilon}` ，又由 :math:`\varphi(x,y)` 的紧支性，不妨取包含原点的有界区域 :math:`D \supset \Omega` ，则

	.. math::
		\begin{align}
		\varphi(0,0) = \lim_{\varepsilon \to 0} \iint\limits_{D-D_{\varepsilon}}UL\varphi~\mathrm{d}A
		= \lim_{\varepsilon \to 0} \iint\limits_{D-D_{\varepsilon}}(U L\varphi - \varphi LU)~\mathrm{d}A
		\end{align}

	由Green第二公式得到

	.. math::
		\begin{align}
		\varphi(0,0) &= \lim_{\varepsilon \to 0}\bigg[
		\oint_{\partial D}\Big( U\frac{\partial\varphi}{\partial n} - \varphi\frac{\partial U}{\partial n} \Big)\mathrm{d}l
		- \oint_{\partial D_{\varepsilon}}\Big( U\frac{\partial \varphi}{\partial n} - \varphi\frac{\partial U}{\partial n} \Big)\mathrm{d}l
		 \bigg] \\
		&= \lim_{\varepsilon \to 0} \int_{\partial D_{\varepsilon}}\Big( \varphi\frac{\partial U}{\partial r} - U\frac{\partial \varphi}{\partial r} \Big)\mathrm{d}l \\
		&= \lim_{\varepsilon \to 0} 2\pi \varepsilon \Big( \varphi \frac{\partial U}{\partial r} - U\frac{\partial \varphi}{\partial r} \Big)\Big|_{(x^{*},y^{*}) \in \partial D_{\varepsilon}} \\
		&= \lim_{\varepsilon \to 0} 2\pi \varepsilon \Big[ \varphi(x^{*},y^{*})B\frac{2}{\pi\varepsilon} - B\frac{2}{\pi}\ln(k\varepsilon) \frac{\partial \varphi}{\partial r}(x^{*},y^{*}) \Big] \\
		&= 4B \varphi(0,0)
		\end{align}

	所以 :math:`B = \frac{1}{4}` ，得到二维Helmholtz方程 :math:`\Delta_{2}u + k^{2}u = 0` 的基本解为

	.. math::
		\begin{align}
		U(x,y) = \frac{1}{4}N_{0}(kr)
		\end{align}



.. note:: 

	用同样的方法还可以求出二维Laplace方程 :math:`\Delta_{2}u = 0` 的基本解

	.. math::
		\begin{align}
		U(x,y) = -\frac{1}{2\pi}\ln\frac{1}{r}
		\end{align}

	二维Helmholtz方程 :math:`\Delta_{2}u + cu = 0~(c = -k^{2} < 0)` 的基本解

	.. math::
		\begin{align}
		U(x,y) = -\frac{1}{2\pi}K_{0}(kr)
		\end{align}

	三维Helmholtz方程 :math:`\Delta_{3}u + cu = 0` 的基本解

	.. math::
		\begin{align}
		U(x,y,z) = \left\{ \begin{array}{l}
		\frac{-e^{-\mathrm{i}kr}}{4\pi r} ~\text{or}~ -\frac{\cos kr}{4\pi r} ,\quad c=k^{2}>0 \\
		-\frac{e^{-kr}}{4\pi r} ,\quad c = -k^{2}<0
		\end{array}\right.
		\end{align}


边值问题的Green函数法
-------------------------


场位方程边值问题的Green函数及解的积分公式
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

首先讨论场位方程(Poisson方程)第一类边值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta u = - f(M) ,\quad M=(x,y,z)\in V, \\
	u|_{\partial V} = \varphi(M)
	\end{array}\right.
	\end{align}

由叠加原理可知， :math:`u=u_{1}+u_{2}` ， :math:`u_{1}` 与 :math:`u_{2}` 分别满足

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta u_{1} = - f(M) ,\quad M\in V, \\
	u_{1}|_{\partial V} = 0
	\end{array}\right.
	\qquad 
	\left\{\begin{array}{l}
	\Delta u_{2} = 0 ,\quad M\in V, \\
	u_{2}|_{\partial V} = \varphi(M)
	\end{array}\right.
	\end{align}

其中， :math:`u_{1}` 表示在边界接地条件下体内电荷产生的电场， :math:`u_{2}` 则为边界约束引起的电场。体内连续分布电荷 :math:`f(M)` 可以表示成点源的叠加

.. math::
	\begin{align}
	f(M) = \int_{V} \delta(M-M_{0})f(M_{0})\mathrm{d}M_{0}
	\end{align}

注意到 :math:`u_{1}` 的方程的边界条件是齐次的，只要求出点源 :math:`\delta(M-M_{0})` 在齐次边界条件下的解，作相应的积分叠加，便可以得到连续源 :math:`f(M)` 在齐次边界条件下的解。


我们称定解问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta G(M;M_{0}) = - \delta(M-M_{0}) ,\quad M,M_{0}\in V, \\
	G|_{M\in\partial V} = 0
	\end{array}\right.
	\end{align}

的解 :math:`G(M;M_{0})` 为场为方程第一类边值问题式的Green函数。

.. note:: 

	从物理上看，Green函数就是边界接地条件下，置于 :math:`V` 内 :math:`M_{0}` 点(源点)电荷为 :math:`+\varepsilon` 的点源在 :math:`V` 内 :math:`M` 点(场点)产生的电场，仍然是一个点源函数，一个基本解。

	由于边界的限制，它不能由原点的点源产生的场通过平移得到。这样，一个含有参数 :math:`M_{0}` 的点源函数一般称之为Green函数。

为了由Green函数得到Poisson方程第一类边值问题的解，我们首先讨论Green函数的重要性质。

**对称性：** 设 :math:`G(M;M_{0})` 为场位方程第一类边值问题式的Green函数，则 :math:`\forall M_{1},M_{2} \in V` ，有

.. math::
	\begin{align}
	G(M_{2};M_{1}) = G(M_{1};M_{2})
	\end{align}

这个性质在物理上称为 **倒易性** ，说明不管 :math:`V` 是什么样的区域，Green函数中的场点和源点可以互换，即在边界接地条件下 :math:`M_{1}` 点的源在 :math:`M_{2}` 点产生的场等同于 :math:`M_{2}` 点的源在 :math:`M_{1}` 点产生的场。


.. note:: 

	对称性的证明如下：由Green函数的定义， :math:`G(M;M_{1})` 和 :math:`G(M;M_{2})` 分别满足边值问题

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta G(M;M_{1}) = - \delta(M-M_{1}) ,\quad M,M_{1}\in V, \\
		G(M;M_{1})|_{M\in \partial V} = 0
		\end{array}\right.
		\qquad 
		\left\{\begin{array}{l}
		\Delta G(M;M_{2}) = - \delta(M-M_{2}) ,\quad M,M_{2}\in V, \\
		G(M;M_{2})|_{M\in \partial V} = 0
		\end{array}\right.
		\end{align}

	利用Green第二公式，有

	.. math::
		\begin{align}
		G(M_{2};M_{1}) - G(M_{1};M_{2})
		&= \int_{V} G(M;M_{1})\delta(M - M_{2})\mathrm{d}M
		- \int_{V} G(M;M_{2})\delta(M-M_{1})\mathrm{d}M \\
		&= - \int_{V}\Big[ G(M;M_{1})\Delta G(M;M_{2}) - G(M;M_{2})\Delta G(M;M_{1}) \Big] \\
		&= -\oint_{\partial V} \Big[ G(M;M_{1})\frac{\partial G(M;M_{2})}{\partial n} - G(M;M_{2})\frac{\partial G(M;M_{1})}{\partial n} \Big]\mathrm{d}S \\
		&= 0
		\end{align}

	需要说明的是，上述证明并不严格，因为Green公式成立的条件在这里并不满足。严格的证明应该按照瑕积分处理，在奇点 :math:`M_{1}` 和 :math:`M_{2}` 处挖去半径为 :math:`\varepsilon` 的小球后应用Green公式，再令 :math:`\varepsilon \to 0` 取极限证明。


下面利用Green函数给出场位方程第一类边值问题的积分公式(Poisson公式)。设 :math:`G(M;M_{0})` 是场位方程第一类边值问题式的Green函数，则由

.. math::
	\begin{align}
	\int_{V}(u\Delta G - G \Delta u)\mathrm{d}M
	= \oint_{\partial V} \Big( u\frac{\partial G}{\partial n} - G\frac{\partial u}{\partial n} \Big)\mathrm{d}S
	\end{align}

将 :math:`u` 和 :math:`G` 满足的方程和边界条件代入，有

.. math::
	\begin{align}
	\int_{V} \big( -u\delta(M-M_{0}) + Gf \big)\mathrm{d}M
	= \oint_{\partial V}\varphi \frac{\partial G}{\partial n}\mathrm{d}S
	\end{align}

从而得到

.. math::
	\begin{align}
	u(M_{0}) = \int_{V}f(M)G(M;M_{0})\mathrm{d}M - \int_{\partial V}\varphi\frac{\partial G}{\partial n}\mathrm{d}S
	\end{align}

由于对称性，最终得到场位方程第一类边值问题式解的积分公式

.. math::
	\begin{align}
	u(M) = \int_{V}f(M_{0})G(M;M_{0})\mathrm{d}M_{0} - \int_{\partial V}\varphi(M_{0})\frac{\partial G}{\partial n}\mathrm{d}S_{0}
	\end{align}



对于场位方程第二、三类边值问题，也可以类似讨论。若定义定解问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta G(M;M_{0}) = -\delta(M-M_{0}) ,\quad M,M_{0}\in V \\
	\Big( \alpha G + \beta \cfrac{\partial G}{\partial n} \Big)\bigg|_{\partial V} = 0
	\end{array}\right.
	\end{align}

的解 :math:`G(M;M_{0})` 为第三类边界条件下的Green函数，则相应的边值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta u = -f(M) ,\quad M\in V \\
	\Big( \alpha u + \beta \cfrac{\partial u}{\partial n} \Big)\bigg|_{\partial V} = \varphi(M)
	\end{array}\right.
	\end{align}

的解的积分公式为

.. math::
	\begin{align}
	u(M) &= \int_{V}f(M_{0})G\mathrm{d}M_{0} + \frac{1}{\beta}\oint_{\partial V}\varphi(M_{0})G\mathrm{d}S_{0} \\
	&= \int_{V} f(M_{0})G\mathrm{d}M_{0} - \frac{1}{\alpha}\oint_{\partial V}\varphi(M_{0})\frac{\partial G}{\partial n_{0}}\mathrm{d}S_{0}
	\end{align}

当 :math:`\beta = 0` 时即为第一类边值问题。当 :math:`\alpha = 0` 时对应于第二类边值问题，但是此时前面定义的Green函数不存在。从物理上看，上面定义的Green函数表示内部有热源二边界绝热的稳恒温度场，这是不可能的。因此需要引进推广的Green函数

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta G = -\delta(M-M_{0}) + \frac{1}{v} ,\quad M,M_{0}\in V \\
	\cfrac{\partial G}{\partial n}\bigg|_{\partial V} = 0
	\end{array}\right.
	\end{align}

其中 :math:`v` 是区域 :math:`V` 的体积。相应边值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta u = -f(M) ,\quad M\in V \\
	\cfrac{\partial u}{\partial n}\bigg|_{\partial V} = \varphi(M)
	\end{array}\right.
	\end{align}

当且仅当 :math:`\int_{V}f\mathrm{d}M = -\int_{\partial V}\varphi\mathrm{d}S` 时，解的积分公式为

.. math::
	\begin{align}
	u(M) = \int_{V}f(M_{0})G\mathrm{d}M_{0} + \oint_{\partial V}\varphi(M_{0})G\mathrm{d}S_{0} + C
	\end{align}

以上Green函数的定义和解的积分公式在二维时同样适用，只需要将有关的体积分和边界曲面积分相应地改为平面区域 :math:`D` 上的二重积分和边界曲线 :math:`\partial D` 上的曲线积分。



Green函数的求法
^^^^^^^^^^^^^^^^^^^

场位方程边值问题的Green函数是含有广义函数 :math:`\delta(M-M_{0})` 的特殊边值问题式的解。由于 :math:`\delta(M-M_{0})` 可以像经典函数一样作Fourier展开和Fourier变换，因此Fourier方法是求Green函数的基本方法。对于某些特殊的区域和边界条件，则可以采用一些特殊方法求解。以下讨论的Green函数，如果不加说明，都是指Poisson方程第一类边值问题的Green函数。

镜像法
""""""""""

场位方程第一类边值问题的Green函数是定解问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta G = -\delta(M-M_{0}) ,\quad M,M_{0}\in V \\
	G|_{\partial V} = 0
	\end{array}\right.
	\end{align}

的解 :math:`G(M;M_{0})` 。由叠加原理可得

.. math::
	\begin{align}
	G(M;M_{0}) = U(M;M_{0}) + g(M;M_{0})
	\end{align}

其中 :math:`U` 满足方程

.. math::
	\begin{align}
	\Delta U(M;M_{0}) = -\delta(M-M_{0})
	\end{align}

是 :math:`M_{0}` 点的点电荷产生的场。 :math:`g(M;M_{0})` 满足Dirichlet问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta g(M;M_{0}) = 0 ,\quad M,M_{0} \in V \\
	g|_{\partial V} = -U(M;M_{0})|_{\partial V}
	\end{array}\right.
	\end{align}

是 :math:`M_{0}` 的点电荷在边界上的感应电荷产生的电场。利用Laplace方程的基本解，容易得知在二、三维情形分别有

.. math::
	\begin{align}
	U(M;M_{0}) = \frac{1}{2\pi}\ln\frac{1}{r(M,M_{0})}
	,\quad
	r(M,M_{0}) = \sqrt{(x-\xi)^{2} + (y - \eta)^{2}}
	\end{align}

.. math::
	\begin{align}
	U(M;M_{0}) = \frac{1}{4\pi r(M,M_{0})}
	,\quad
	r(M,M_{0}) = \sqrt{(x-\xi)^{2} + (y-\eta)^{2} + (z-\zeta)^{2}}
	\end{align}

由于区域 :math:`V` 外的点源在 :math:`V` 内产生的电场满足Laplace方程，可以将边界感应电荷产生的电场 :math:`g(M;M_{0})` 视作区域外某些虚设电荷产生的等效电场，这就是镜像法。困难就在于域外虚设电荷的电场与域内点电荷的电场在边界上必须相抵消，对于某些特殊区域 :math:`V` ，这样的虚设电荷可以用初等方法找到。

.. note:: 

	求上半空间( :math:`z > 0` )Poisson方程第一类边值问题的Green函数。也就要解定解问题

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta G = -\delta(M - M_{0}) ,\quad z,\zeta >0 \\
		G|_{z=0} = 0
		\end{array}\right.
		\end{align}

	:math:`M_{0}` 点的正电荷 :math:`\varepsilon` 在空间产生的电场为

	.. math::
		\begin{align}
		U_{0} = \frac{1}{4\pi r(M,M_{0})}
		,\quad 
		r(M,M_{0}) = \sqrt{(x-\xi)^{2} + (y-\eta)^{2} + (z-\zeta)^{2}}
		\end{align}

	边界面上 :math:`U_{0}|_{z=0} = \frac{1}{4\pi \sqrt{(x-\xi)^{2} + (y-\eta)^{2} + \zeta^{2}}}` 。虚设电荷应该置于下半空间 :math:`M_{0}` 关于平面 :math:`z=0` 的对称点 :math:`M_{1}=(\xi,\eta,-\zeta)` 上，电荷量为 :math:`-\varepsilon` ，则该虚设电荷在空间产生的电场为

	.. math::
		\begin{align}
		U_{1} = -\frac{1}{4\pi r(M,M_{1})}
		,\quad
		r(M,M_{1}) = \sqrt{(x-\xi)^{2} + (y-\eta)^{2} + (z+\zeta)^{2}}
		\end{align}

	在边界面上

	.. math::
		\begin{align}
		U_{1}|_{z=0} = -\frac{1}{4\pi\sqrt{(x-\xi)^{2} + (y-\eta)^{2} + \zeta^{2}}} = -U_{0}|_{z=0}
		\end{align}

	所以上半空间Poisson方程第一类边值问题的Green函数为

	.. math::
		\begin{align}
		G(M;M_{0}) &= \frac{1}{4\pi r(M,M_{0})} - \frac{1}{4\pi r(M,M_{1})} \\
		&= \frac{1}{4\pi}\Big[
		\frac{1}{\sqrt{(x-\xi)^{2} + (y-\eta)^{2} + (z-\zeta)^{2}}}
		- \frac{1}{\sqrt{(x-\xi)^{2} + (y-\eta)^{2} + (z+\zeta)^{2}}}
		\Big]
		,\quad z,\zeta > 0
		\end{align}

得到上述Green函数后，就有

.. math::
	\begin{align}
	\frac{\partial G}{\partial n}\Big|_{z=0}
	= - \frac{\partial G}{\partial z}\Big|_{z=0}
	= -\frac{\zeta}{2\pi \big((x-\xi)^{2} + (y-\eta)^{2} + \zeta^{2}\big)^{3/2}}
	\end{align}

从而可以得到Dirichlet问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta_{3}u = 0 ,\quad z>0 \\
	u|_{z=0} = \varphi(x,y)
	\end{array}\right.
	\end{align}

的解的Poisson积分公式

.. math::
	\begin{align}
	u(\xi,\eta,\zeta) = \frac{1}{2\pi} \iint\limits_{-\infty}^{+\infty}\frac{\zeta \varphi(x,y)}{\big( (x-\xi)^{2} + (y-\eta)^{2} + \zeta^{2} \big)^{3/2}}\mathrm{d}x\mathrm{d}y
	\end{align}

或者

.. math::
	\begin{align}
	u(x,y,z) = \frac{1}{2\pi} \iint\limits_{-\infty}^{+\infty}\frac{z \varphi(\xi,\eta)}{\big( (x-\xi)^{2} + (y-\eta)^{2} + z^{2} \big)^{3/2}}\mathrm{d}\xi\mathrm{d}\eta
	\end{align}


.. note:: 

	在二维情形，若求上半平面Poisson方程第一类边值问题的Green函数，利用基本解 :math:`U = \frac{1}{2\pi}\ln r` ，将虚设点电荷置于 :math:`M_{0}(\xi,\eta)` 在下半平面的对称点 :math:`M_{1}(\xi,-\eta)` 上，有

	.. math::
		\begin{align}
		G(M;M_{0}) &= \frac{1}{2\pi}\Big[ \ln\frac{1}{r(M,M_{0})} - \ln\frac{1}{r(M,M_{1})}\Big] \\
		&= \frac{1}{4\pi}\ln\frac{(x-\xi)^{2} + (y+\eta)^{2}}{(x-\xi)^{2} + (y-\eta)^{2}}
		,\quad y,\eta > 0
		\end{align}

得到上述Green函数后，就可以得到上半平面Dirichlet问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta_{2}u = 0 ,\quad y>0 \\
	u|_{y=0} = \varphi(x)
	\end{array}\right.
	\end{align}

的解的积分公式为

.. math::
	\begin{align}
	u(x,y) = \frac{1}{\pi}\int_{-\infty}^{+\infty}\frac{y\varphi(\xi)}{(x-\xi)^{2} + y^{2}}\mathrm{d}\xi
	\end{align}



.. note:: 

	求半径为 :math:`R` 的球域内Poisson方程第一类边值问题的Green函数。球域内Green函数的定解问题为

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta_{3}G = -\delta(M-M_{0}) ,\quad 0\le r, \rho <R \\
		G|_{r=R} = 0
		\end{array}\right.
		\end{align}

	其中 :math:`r=\sqrt{x^{2}+y^{2}+z^{2}}, \rho=\sqrt{\xi^{2}+\eta^{2}+\zeta^{2}}` 。球内 :math:`M_{0}` 点正电荷 :math:`\varepsilon` 在 :math:`M` 点的电场为 :math:`U_{0} = \frac{1}{4\pi r(M,M_{0})}` 。该电场关于射线 :math:`OM_{0}` 轴对称，虚设电荷 :math:`-Q` 应该置于球外 :math:`OM_{0}` 射线的某一点 :math:`M_{1}` 上。虚设电荷与 :math:`M_{0}` 点真实点电荷在球面上产生的电位要相抵消，即对于球面上任一点 :math:`M` ，有

	.. math::
		\begin{align}
		U_{0} + U_{1} = \frac{1}{4\pi r(M,M_{0})} - \frac{Q/\varepsilon}{4\pi r(M,M_{1})} = 0
		\end{align}

	因此， :math:`M_{1}` 需要满足

	.. math::
		\begin{align}
		\frac{r(M,M_{1})}{r(M,M_{0})} = \frac{Q}{\varepsilon}
		\end{align}

	由几何知识可知，取 :math:`M_{1}` 为 :math:`M_{0}` 关于球面的对称点时( :math:`r(O,M_{0})\cdot r(O,M_{1}) = R^{2}` )，三角形 :math:`OM_{0}M` 与三角形 :math:`OMM_{1}` 相似，从而有

	.. math::
		\begin{align}
		\frac{r(M,M_{1})}{r(M,M_{0})} = \frac{r(O,M)}{r(O,M_{0})} = \frac{R}{\rho}
		\end{align}

	故虚设电荷应该置于 :math:`M_{0}` 关于球面的对称点 :math:`M_{1}` 上，电荷量应该为 :math:`-Q = -\frac{R}{\rho}\varepsilon` 。从而球内Green函数

	.. math::
		\begin{align}
		G(M;M_{0}) = \frac{1}{4\pi}\Big[ \frac{1}{r(M,M_{0})} - \frac{R}{\rho r(M,M_{1})} \Big]
		\end{align}

	取球坐标，记场点 :math:`M=(r,\theta,\varphi)` ，源点 :math:`M_{0}=(\rho,\theta_{0},\varphi_{0})` ， :math:`\psi` 为 :math:`OM_{0}` 与 :math:`OM` 的夹角，则

	.. math::
		\begin{align}
		r(M,M_{0}) = \sqrt{r^{2} + \rho^{2} - 2r\rho \cos\psi}
		\end{align}

	.. math::
		\begin{align}
		r(M,M_{1}) = \sqrt{r^{2} + (\frac{R^{2}}{\rho})^{2} - 2r\frac{R^{2}}{\rho}\cos\psi}
		= \frac{1}{\rho}\sqrt{\rho^{2}r^{2} + R^{4} - 2\rho r R^{2}\cos\psi}
		\end{align}

	.. math::
		\begin{align}
		\cos\psi = \cos\theta\cos\theta_{0} + \sin\theta\sin\theta_{0}\cos(\varphi-\varphi_{0})
		\end{align}

	从而有

	.. math::
		\begin{align}
		G(M;M_{0}) = \frac{1}{4\pi}\bigg[
		\frac{1}{\sqrt{r^{2} + \rho^{2} - 2\rho r \cos\psi}}
		- \frac{R}{\sqrt{\rho^{2}r^{2} + R^{4} - 2\rho r R^{2} \cos\psi}}
		\bigg]
		\end{align}

在得到上面这个Green函数之后，就可得知在球面上

.. math::
	\begin{align}
	\frac{\partial G}{\partial n}\Big|_{r=R}
	= \frac{\partial G}{\partial r}\Big|_{r=R}
	= -\frac{R^{2} - \rho^{2}}{4\pi R(R^{2} + \rho^{2} - 2\rho R\cos\psi)^{3/2}}
	\end{align}

进而可得Dirichlet问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta_{3}u = 0 ,\quad r<R \\
	u|_{r=R} = f(\theta,\varphi)
	\end{array}\right.
	\end{align}

的解的Poisson积分公式

.. math::
	\begin{align}
	u(\rho,\theta_{0},\varphi_{0}) = \frac{1}{4\pi R}\oint_{S_{R}}\frac{R^{2} - \rho^{2}}{(R^{2} + \rho^{2} - 2R\rho\cos\psi)^{3/2}}f(\theta,\varphi)\mathrm{d}S
	\end{align}

或者

.. math::
	\begin{align}
	u(r,\theta,\varphi) = \frac{1}{4\pi R} \oint_{S_{R}}\frac{R^{2} - r^{2}}{(R^{2} + r^{2} - 2Rr\cos\psi)^{3/2}}f(\theta_{0},\varphi_{0})\mathrm{d}S_{0}
	\end{align}

其中 :math:`S_{R}` 为以 :math:`O` 为球心、 :math:`R` 为半径的球面。如果取 :math:`M_{0}` 为球心 :math:`O` ， :math:`\rho = 0` ，则上式变为

.. math::
	\begin{align}
	u(O) = \frac{1}{4\pi R^{2}}\oint_{S_{R}}f(M)\mathrm{d}S
	\end{align}

这说明Laplace方程的解在球心的值等于它的球面平均值。




.. note:: 

	求圆域内Poisson方程第一类边值问题的Green函数。该Green函数满足

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta_{2}G = -\delta(M-M_{0}) ,\quad r=\sqrt{x^{2}+y^{2}}<R , \rho = \sqrt{\xi^{2} + \eta^{2}}<R \\
		G|_{r=R} = 0
		\end{array}\right.
		\end{align}

	圆内过 :math:`M_{0}=(\xi,\eta)` 点的线电荷 :math:`\varepsilon` 在 :math:`M` 点的电位为

	.. math::
		\begin{align}
		U_{0} = \frac{1}{2\pi}\ln\frac{1}{r(M,M_{0})}
		\end{align}

	在 :math:`M_{0}` 点关于圆周的对称点 :math:`M_{1}` 上放置虚设线电荷 :math:`-Q` 产生的电位为

	.. math::
		\begin{align}
		U_{1} = -\frac{Q}{2\pi \varepsilon}\ln\frac{1}{r(M,M_{1})} + C
		\end{align}

	因为Laplace方程的基本解不唯一，这里添加了待定常数 :math:`C` 。于是Green函数满足形式

	.. math::
		\begin{align}
		G(M;M_{0}) = \frac{1}{2\pi}\bigg[ \ln\frac{1}{r(M,M_{0})} - \frac{Q}{\varepsilon}\ln\frac{1}{r(M,M_{1})}\bigg] + C
		\end{align}

	当 :math:`M` 在圆域边界上， :math:`r(M,M_{1}) = \frac{R}{\rho}r(M,M_{0})` ，边界条件为

	.. math::
		\begin{align}
		G|_{r=R} = \frac{1}{2\pi}\bigg[ \ln\frac{1}{r(M,M_{0})} - \frac{Q}{\varepsilon}\ln\frac{1}{r(M,M_{0})} - \frac{Q}{\varepsilon}\ln\frac{\rho}{R}\bigg] + C = 0
		\end{align}

	从中推出 :math:`Q = \varepsilon` 和 :math:`C = -\frac{1}{2\pi}\ln\frac{R}{\rho}` ，最终得到圆内Green函数

	.. math::
		\begin{align}
		G(M;M_{0}) = \frac{1}{2\pi}\bigg[ \ln\frac{1}{r(M,M_{0})} - \ln\frac{R}{\rho r(M,M_{1})} \bigg]
		\end{align}

	取极坐标 :math:`M=(r,\theta), M_{0}=(\rho,\theta_{0}), \psi=\theta - \theta_{0}` ，有

	.. math::
		\begin{align}
		G(M;M_{0}) = \frac{1}{4\pi}\ln \frac{R^{4} + r^{2}\rho^{2} - 2R^{2}r\rho\cos\psi}{R^{2}(r^{2} + \rho^{2} - 2r\rho\cos\psi)}
		\end{align}

得到上述Green函数后，则有

.. math::
	\begin{align}
	\frac{\partial G}{\partial n}\Big|_{r=R}
	= \frac{\partial G}{\partial r}\Big|_{r=R}
	= -\frac{1}{2\pi}\frac{R^{2} - \rho^{2}}{R(R^{2} + \rho^{2} - 2R\rho\cos\psi)}
	\end{align}

从而可知圆内Laplace方程的Dirichlet问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta_{2}u = 0 ,\quad r<R \\
	u|_{r=R} = \varphi(\theta)
	\end{array}\right.
	\end{align}

的解可以表示为Poisson积分公式

.. math::
	\begin{align}
	u(M_{0}) = u(\rho,\theta_{0}) = \frac{1}{2\pi}\int_{0}^{2\pi}\frac{(R^{2} - \rho^{2})\varphi(\theta)}{R^{2} + \rho^{2} - 2R\rho\cos(\theta - \theta_{0})}\mathrm{d}\theta
	\end{align}

或者

.. math::
	\begin{align}
	u(M) = u(r,\theta) = \frac{1}{2\pi}\int_{0}^{2\pi}\frac{(R^{2} - r^{2})\varphi(\theta_{0})}{R^{2} + r^{2} - 2Rr\cos(\theta - \theta_{0})}\mathrm{d}\theta_{0}
	\end{align}



.. note:: 

	第一象限内场位方程第一边值问题的Green函数为

	.. math::
		\begin{align}
		G(M;M_{0}) = \frac{1}{2\pi}\bigg[ \ln\frac{1}{r(M,M_{0})} - \ln\frac{1}{r(M,M_{1})} - \ln\frac{1}{r(M,M_{2})} + \ln\frac{1}{r(M,M_{3})} \bigg]
		\end{align}

	其中， :math:`M_{0}=(\xi,\eta)` 是真实源点， :math:`M_{1}=(\xi,-\eta), M_{2}=(-\xi,\eta),M_{3}=(-\xi,-\eta)` 为虚设电荷点，分别是 :math:`M_{0}` 关于 :math:`x` 轴、 :math:`y` 轴和原点的对称点。





Fourier方法
""""""""""""""""

Fourier方法是指按照固有函数作广义Fourier展开的方法，包括分离变量和积分变换，仍然是求Green函数的基本方法。

.. note:: 

	半径为 :math:`R` 的匀质球内， :math:`M_{0}` 点处有强度为 :math:`Q` 的热源，球面与温度为零摄氏度的外界自由热交换，求达到稳恒后球内的温度分布。

	这是点源引起的温度分布，稳恒温度 :math:`u(x,y,z)` 满足

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta_{3}u = -\cfrac{Q}{k}\delta(M-M_{0}) ,\quad r,\rho<R \\
		\Big( k\cfrac{\partial u}{\partial r} + hu \Big)\Big|_{r=R} = 0
		\end{array}\right.
		\end{align}

	其中 :math:`k` 为介质内热传导系数， :math:`h` 为边界面热交换系数。如果取 :math:`Q=k` ，那么 :math:`u` 即为Poisson方程第三类边界条件的Green函数。

	由Laplace方程的基本解，令 :math:`U(M;M_{0}) = \frac{1}{4\pi r(M,M_{0})}` ，则

	.. math::
		\begin{align}
		u(M;M_{0}) = \frac{Q}{k}U(M;M_{0}) + g(M;M_{0})
		\end{align}

	则 :math:`g(M;M_{0})` 满足

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta_{3}g = 0 ,\quad r<R \\
		\Big(k\cfrac{\partial g}{\partial r} + hg\Big)\Big|_{r=R} = -\cfrac{Q}{k}\Big( k\cfrac{\partial U}{\partial r}+hU \Big)\Big|_{r=R}
		\end{array}\right.
		\end{align}

	由于温度分布关于球心到 :math:`M_{0}` 点的 :math:`OM_{0}` 轴对称，将 :math:`OM_{0}` 轴取作极轴，由球内Laplace方程解的一般形式式可知

	.. math::
		\begin{align}
		g(M;M_{0}) = \sum_{n=0}^{+\infty}C_{n}\Big(\frac{r}{R}\Big)^{n}P_{n}(\cos\theta)
		\end{align}

	进而

	.. math::
		\begin{align}
		\Big( k\cfrac{\partial g}{\partial r} + hg \Big)\Big|_{r=R}
		= \sum_{n=0}^{+\infty}\Big( \frac{nk}{R} + h \Big)C_{n}P_{n}(\cos\theta)
		\end{align}

	利用Legendre多项式的母函数式，当 :math:`\rho < r` 时，有

	.. math::
		\begin{align}
		\frac{1}{r(M,M_{0})} = \frac{1}{(r^{2} + \rho^{2} - 2r\rho \cos\theta)^{1/2}}
		= \frac{1}{r}\sum_{n=0}^{+\infty}\Big(\frac{\rho}{r}\Big)^{n}P_{n}(\cos\theta)
		\end{align}

	所以

	.. math::
		\begin{align}
		-\frac{Q}{k}\Big( k\frac{\partial U}{\partial r} + hU \Big)\Big|_{r=R}
		= -\frac{Q}{k}\sum_{n=0}^{+\infty}\frac{hR - (n+1)k}{4\pi R^{n+2}}\rho^{n}P_{n}(\cos\theta)
		\end{align}

	代入边界条件，比较系数，解得

	.. math::
		\begin{align}
		C_{n} = \frac{Q}{k}\frac{(n+1)k - hR}{hR + nk}\cdot \frac{\rho^{n}}{4\pi R^{n+1}}
		\end{align}

	故温度分布为

	.. math::
		\begin{align}
		u = \frac{Q}{4\pi k}\bigg[ \frac{1}{r(M,M_{0})} + \sum_{n=0}^{+\infty}\frac{(n+1)k - hR}{(hR + nk)R}\Big(\frac{\rho r}{R^{2}}\Big)^{n}P_{n}(\cos\theta) \bigg]
		\end{align}

	当 :math:`\rho > r` 时该式仍然成立。




.. note:: 

	求矩形域 :math:`D: 0<x<a, 0<y<b` 内Poisson方程第一类边值问题的Green函数。也即求解边值问题

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta_{2}G = -\delta(x-\xi, y-\eta) ,\quad 0<x,\xi<a, 0<y,\eta<b \\
		G|_{x=0} = G|_{x=a} = G|_{y=0} = G|_{y=b} = 0
		\end{array}\right.
		\end{align}

	考虑同一齐次边界条件下Laplace算子的固有值问题

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta_{2}v + \lambda v = 0 ,\quad 0<x<a, 0<y<b \\
		v|_{x=0} = v|_{x=a} = v|_{y=0} = v|_{y=b} = 0
		\end{array}\right.
		\end{align}

	令 :math:`v(x,y) = X(x)Y(y)` ，分离得到常微分方程的固有值问题

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		X'' + \mu X = 0 ,\quad 0<x<a \\
		X(0) = X(a) = 0
		\end{array}\right.
		\qquad 
		\left\{\begin{array}{l}
		Y'' + \nu Y = 0 ,\quad 0<y<b \\
		Y(0) = Y(b) = 0
		\end{array}\right.
		\end{align}

	且 :math:`\mu + \nu = \lambda` 。解得固有值和固有函数分别为

	.. math::
		\begin{align}
		& \mu_{n} = \Big(\frac{n\pi}{a}\Big)^{2} ,\quad X_{n}(x) = \sin\frac{n\pi}{a}x ,\quad n=1,2,\cdots \\
		& \nu_{m} = \Big(\frac{m\pi}{b}\Big)^{2} ,\quad Y_{m}(y) = \sin\frac{m\pi}{b}y ,\quad m=1,2,\cdots
		\end{align}

	所以相应的Laplace方程的固有值问题有固有值和固有函数

	.. math::
		\begin{align}
		\lambda_{nm} = \Big(\frac{n\pi}{a}\Big)^{2} + \Big(\frac{m\pi}{b}\Big)^{2}
		\end{align}

	.. math::
		\begin{align}
		v_{nm}(x,y) = \sin\frac{n\pi}{a}x\sin\frac{m\pi}{b}y ,\quad n,m=1,2,\cdots
		\end{align}

	由于 :math:`\left \{ v_{nm}(x,y) \right \}~(n,m=1,2,\cdots)` 是该矩形区域上的完备正交函数系，设Green函数

	.. math::
		\begin{align}
		G = \sum_{n,m=1}^{+\infty}C_{nm}v_{nm}(x,y)
		\end{align}

	则有

	.. math::
		\begin{align}
		\Delta_{2}G = -\sum_{n,m=1}^{+\infty}C_{nm}\Big[\Big(\frac{n\pi}{a}\Big)^{2} + \Big(\frac{m\pi}{b}\Big)^{2}\Big]v_{nm}(x,y)
		\end{align}

	又因为

	.. math::
		\begin{align}
		\delta(x-\xi, y-\eta) = \sum_{n,m=1}^{+\infty}B_{nm}v_{nm}(x,y)
		\end{align}

	.. math::
		\begin{align}
		B_{nm} = \frac{1}{\| v_{nm}(x,y) \|^{2}}\int_{0}^{a}\int_{0}^{b}\delta(x-\xi,y-\eta)\sin\frac{n\pi}{a}x\sin\frac{m\pi}{b}y\mathrm{d}x\mathrm{d}y
		= \frac{4}{ab}\sin\frac{n\pi}{a}\xi \sin\frac{m\pi}{b}\eta
		\end{align}

	代入 :math:`G` 的方程，两边比较系数，确定

	.. math::
		\begin{align}
		C_{nm} = \frac{4}{ab}\Big[ \Big(\frac{n\pi}{a}\Big)^{2} + \Big(\frac{m\pi}{b}\Big)^{2} \Big]^{-1} \sin\frac{n\pi}{a}\xi \sin\frac{m\pi}{b}\eta
		\end{align}

	得到矩形域上Dirichlet问题的Green函数

	.. math::
		\begin{align}
		G(x,y;\xi,\eta) = \frac{4ab}{\pi^{2}}\sum_{n=1}^{+\infty}\sum_{m=1}^{+\infty} \frac{1}{(nb)^{2} + (ma)^{2}} \sin\frac{n\pi}{a}\xi \sin\frac{m\pi}{b}\eta \sin\frac{n\pi}{a}x \sin\frac{m\pi}{b}y
		\end{align}




.. note:: 

	求半条形区域 :math:`D: 0<x<a, y>0` 内Poisson方程第一类边值问题的Green函数。即解定解问题

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta_{2}G = -\delta(x-\xi, y-\eta) ,\quad 0<x,\xi<a, \quad y,\eta >0 \\
		G|_{x=0} = G|_{x=a} = G|_{y=0} = 0 \\
		G|_{y\to +\infty}\text{有界}
		\end{array}\right.
		\end{align}

	考虑相应偏微分方程固有值问题

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		\Delta_{2}v + \lambda v = 0 ,\quad 0<x<a,~ y>0 \\
		v|_{x=0} = v|_{x=a} = v|_{y=0} = 0 \\
		v|_{y\to\infty}\text{有界}
		\end{array}\right.
		\end{align}

	令 :math:`v=X(x)Y(y)` ，分离出两个常微分方程固有值问题

	.. math::
		\begin{align}
		\left\{\begin{array}{l}
		X'' + \mu X = 0 ,\quad 0<x<a \\
		X(0) = X(a) = 0
		\end{array}\right.
		\qquad
		\left\{\begin{array}{l}
		Y'' + \nu Y = 0 ,\quad 0<y<+\infty \\
		Y(0) = 0 ,\quad Y(+\infty)\text{有界}
		\end{array}\right.
		\end{align}

	其中 :math:`\mu + \nu = \lambda` 。分别解得

	.. math::
		\begin{align}
		& \mu_{n} = \Big(\frac{n\pi}{a}\Big)^{2} ,\quad X_{n}(x) = \sin\frac{n\pi}{a}x ,\quad n=1,2,\cdots \\
		& \nu = \omega^{2} ,\quad Y(y,\omega) = \sin \omega y ,\quad \omega >0
		\end{align}

	故相应偏微分方程固有值问题有固有值和固有函数系

	.. math::
		\begin{align}
		\lambda_{n\omega} = \Big(\frac{n\pi}{a}\Big)^{2} + \omega^{2}
		,\quad 
		v_{n}(x,y,\omega) = \sin\frac{n\pi}{a}x\sin\omega y
		\end{align}

	设 :math:`G` 满足形式

	.. math::
		\begin{align}
		G = \sum\limits_{n=1}^{+\infty}\int_{0}^{+\infty}C_{n}(\omega)\sin\omega y \mathrm{d}\omega \sin\frac{n\pi}{a}x
		\end{align}

	代入 :math:`G` 的方程得到

	.. math::
		\begin{align}
		-\Delta_{2}G = \sum_{n=1}^{+\infty}\bigg[ \int_{0}^{+\infty}C_{n}(\omega)\Big((\frac{n\pi}{a})^{2} + \omega^{2}\Big)\sin \omega y \mathrm{d}\omega \bigg] \sin\frac{n\pi}{a}x = \delta(x-\xi,y-\eta)
		\end{align}

	上式可以看成是 :math:`C_{n}(\omega)\Big((\frac{n\pi}{a})^{2} + \omega^{2}\Big)` 的正弦变换，由反变换公式求出

	.. math::
		\begin{align}
		C_{n}(\omega)\Big((\frac{n\pi}{a})^{2} + \omega^{2}\Big)
		= \frac{2}{\pi}\int_{0}^{+\infty}\Big[ \frac{2}{a}\sin\frac{n\pi}{a}\xi \delta(y-\eta) \Big]\sin\omega y \mathrm{d}y
		= \frac{4}{a\pi}\sin\frac{n\pi}{a}\xi \sin\omega \eta
		\end{align}

	因此

	.. math::
		\begin{align}
		C_{n}(\omega) = \frac{4a}{\pi [(n\pi)^{2} + (a\omega)^{2}]}\sin\frac{n\pi}{a}\xi \sin \omega \eta
		\end{align}

	所以Green函数

	.. math::
		\begin{align}
		G(x,y;\xi,\eta) = \frac{4a}{\pi}\sum_{n=1}^{+\infty}\Big[ \int_{0}^{+\infty}\frac{\sin\omega\eta \sin\omega y}{(n\pi)^{2} + (a\omega)^{2}}\mathrm{d}\omega \Big] \sin\frac{n\pi}{a}\xi \sin\frac{n\pi}{a}x
		\end{align}



Helmholtz方程边值问题及其Green函数
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Helmholtz方程第一类边值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta_{3}u + k^{2}u = f(M) ,\quad M=(x,y,z) \in V \\
	u|_{\partial V} = \varphi(M)|_{\partial V}
	\end{array}\right.
	\end{align}

当 :math:`k^{2}` 不是固有值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta_{3}v + \lambda v = 0 ,\quad M\in V \\
	v|_{\partial V} = 0
	\end{array}\right.
	\end{align}

的固有值时，问题式的解存在且唯一。

如果 :math:`G(M;M_{0})` 满足

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\Delta_{3}G + k^{2}G = \delta(M-M_{0}) ,\quad M,M_{0} \in V \\
	G|_{\partial V} = 0
	\end{array}\right.
	\end{align}

则称 :math:`G(M;M_{0})` 为Helmholtz方程第一类边值问题的Green函数。

由Helmholtz算子 :math:`L = \Delta + k^{2}` 的Green第二公式，同样可以证明 :math:`G(M;M_{0}) = G(M_{0};M)` ，且有问题式解的积分公式：如果 :math:`G(M;M_{0})` 是Helmholtz方程第一类边值问题的Green函数，则问题式的解为

.. math::
	\begin{align}
	u(M_{0}) = \int_{V}f(M)G(M;M_{0})\mathrm{d}M + \oint_{\partial V}\varphi(M)\frac{\partial G}{\partial n}\mathrm{d}S
	\end{align}

或者

.. math::
	\begin{align}
	u(M) = \int_{V} f(M_{0})G(M;M_{0})\mathrm{d}M_{0} + \oint_{\partial V}\varphi(M_{0})\frac{\partial G}{\partial n}\mathrm{d}S_{0}
	\end{align}

求Green函数的基本方法是广义Fourier展开。如果已知固有值问题式的固有值 :math:`\{ \lambda_{nml} \}` ，固有函数 :math:`\{ v_{nml}(M) \}` ，它们构成区域 :math:`V` 上的完备正交函数系，从而可以设

.. math::
	\begin{align}
	G(M;M_{0}) = \sum_{n,m,l}C_{nml}v_{nml}(M)
	\end{align}

代入方程确定 :math:`C_{nml}` ，最后得到

.. math::
	\begin{align}
	G(M;M_{0}) = \sum_{n,m,l}\frac{1}{(k^{2} - \lambda_{nml})\| v_{nml}(M) \|^{2}}v_{nml}(M_{0})v_{nml}(M)
	\end{align}

当 :math:`V` 为某些特殊区域时，也可以用镜像法求Green函数。


初值问题的基本解方法
-------------------------

ut=Lu型方程初值问题的基本解
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

考虑初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial u}{\partial t} = Lu + f(t,M) ,\quad t>0, M\in \mathbb{R}^{n}, n=1,2,3 \\
	u|_{t=0} = \varphi(M)
	\end{array}\right.
	\end{align}

其中 :math:`L` 是关于空间变量 :math:`M` 的常系数线性偏微分算子。一般地，我们定义下列初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial U}{\partial t} = LU ,\quad t>0, M\in\mathbb{R}^{n}, n=1,2,3 \\
	U|_{t=0} = \delta(M)
	\end{array}\right.
	\end{align}

的解 :math:`U(t,M)` 为方程 :math:`\frac{\partial u}{\partial t} = Lu` 的初值问题式的基本解，而在得到该基本解后，就可以得到原初值问题的解为

.. math::
	\begin{align}
	u(t,M) = U(t,M) * \varphi(M) + \int_{0}^{t}U(t-\tau, M) * f(\tau, M)~\mathrm{d}\tau
	\end{align}

.. note:: 

	上述解的积分公式的证明如下：令 :math:`u_{1} = U(t,M) * \varphi(M)` ， :math:`u_{2} = \int_{0}^{t}U(t-\tau,M)*f(\tau,M)\mathrm{d}\tau` 。根据基本解的定义，容易直接验证

	.. math::
		\begin{align}
		\frac{\partial u_{1}}{\partial t}
		= \frac{\partial }{\partial t}[U(t,M)*\varphi(M)]
		= \Big[ \frac{\partial }{\partial t}U(t,M) \Big] * \varphi(M)
		= [LU(t,M)]*\varphi(M)
		= L[U(t,M) * \varphi(M)]
		= Lu_{1}
		\end{align}

	.. math::
		\begin{align}
		u_{1}|_{t=0}
		= [U(t,M) * \varphi(M)]\Big|_{t=0}
		= U(t,M) \Big|_{t=0} * \varphi(M)
		= \delta(M) * \varphi(M)
		= \varphi(M)
		\end{align}

	.. math::
		\begin{align}
		\frac{\partial u_{2}}{\partial t}
		&= \frac{\partial }{\partial t} \int_{0}^{t} U(t-\tau, M) * f(\tau,M)\mathrm{d}\tau \\
		&= \int_{0}^{t} \frac{\partial }{\partial t}U(t-\tau,M) * f(\tau,M)\mathrm{d}\tau + U(0,M) * f(t,M) \\
		&= \int_{0}^{t} LU(t-\tau, M) * f(\tau,M)\mathrm{d}\tau + \delta(M) * f(t,M) \\
		&= \int_{0}^{t} L[U(t-\tau,M) * f(\tau,M)]\mathrm{d}\tau + f(t,M) \\
		& = Lu_{2} + f(t,M)
		\end{align}

	.. math::
		\begin{align}
		u_{2}|_{t=0} = 0
		\end{align}

	再由叠加原理可知 :math:`u = u_{1} + u_{2}` 满足初值问题式。

	这里我们反复交换积分与求导，积分与取极限的次序，从广义函数来看，都是允许的。


utt=Lu型方程问题的基本解
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

考虑初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial^{2}u}{\partial t^{2}} = Lu + f(t,M) ,\quad t>0, M\in \mathbb{R}^{n}, n=1,2,3 \\
	u|_{t=0} = \varphi(M), \quad \cfrac{\partial u}{\partial t}\Big|_{t=0} = \psi(M)
	\end{array}\right.
	\end{align}

其中 :math:`L` 是关于空间变量 :math:`M` 的常系数线性偏微分算子。我们定义下列初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial^{2}U}{\partial t^{2}} = LU,\quad t>0, M\in \mathbb{R}^{n}, n=1,2,3 \\
	U|_{t=0} = 0, \quad \cfrac{\partial U}{\partial t}\Big|_{t=0} = \delta(M)
	\end{array}\right.
	\end{align}

的解 :math:`U(t,M)` 为方程 :math:`\frac{\partial^{2}u}{\partial t^{2}} = Lu` 的初值问题式的基本解。在得知该基本解后，则原初值问题的解为

.. math::
	\begin{align}
	u(t,M) = U(t,M) * \psi(M)
	+ \frac{\partial }{\partial t}[U(t,M) * \varphi(M)]
	+ \int_{0}^{t} U(t-\tau, M) * f(\tau,M)\mathrm{d}\tau
	\end{align}


热传导方程的初值问题
^^^^^^^^^^^^^^^^^^^^^^^^

考虑 :math:`n` 维热传导方程初值问题的基本解，即求解初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial}{\partial t}U = a^{2}\Delta_{n}U ,\quad t>0, \mathbf{x}=(x_{1},x_{2},\cdots,x_{n})\in\mathbb{R}^{n} \\
	U|_{t=0} = \delta(\mathbf{x})
	\end{array}\right.
	\end{align}

采用Fourier变换进行处理，对上式作 :math:`n` 维FT，记 :math:`\hat{U}(t,\boldsymbol{\lambda}) = F[U(t,\mathbf{x})], \boldsymbol{\lambda}=(\lambda_{1},\lambda_{2},\cdots,\lambda_{n})\in\mathbb{R}^{n}` ，得到

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\mathrm{d}\hat{U}}{\mathrm{d}t} = -a^{2}\rho^{2}\hat{U} ,\quad \rho^{2} = \sum\limits_{j=1}^{n}\lambda_{j}^{2} \\
	\hat{U}|_{t=0} = 1
	\end{array}\right.
	\end{align}

可知，像函数为

.. math::
	\begin{align}
	\hat{U}(t,\boldsymbol{\lambda}) = e^{-a^{2}\rho^{2}t}
	\end{align}

对像函数作反变换，求得基本解为

.. math::
	\begin{align}
	U(t,\mathbf{x}) &= \frac{1}{(2\pi)^{n}}\int_{\mathbb{R}^{n}}e^{-a^{2}\rho^{2}t}\cdot e^{-\boldsymbol{\lambda}\cdot \mathbf{x}}\mathrm{d}\boldsymbol{\lambda} \\
	&= \prod_{j=1}^{n} \Big[ \frac{1}{2\pi}\int_{-\infty}^{+\infty}e^{-a^{2}\lambda_{j}^{2}t} \cdot e^{\mathrm{i}\lambda_{j}x_{j}}\mathrm{d}\lambda_{j} \Big] \\
	&= \prod_{j=1}^{n} \frac{1}{2a\sqrt{\pi t}}e^{-\cfrac{x_{j}^{2}}{4a^{2}t}} \\
	&= \Big( \frac{1}{2a\sqrt{\pi t}} \Big)^{n} e^{-\cfrac{x_{1}^{2} + x_{2}^{2} + \cdots + x_{n}^{2}}{4a^{2}t}}
	\end{align}

根据这个基本解，我们可以得知热传导方程初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial u}{\partial t} = a^{2}\Delta_{n}u + f(t,\mathbf{x}) ,\quad t>0, \mathbf{x}\in\mathbb{R}^{n} \\
	u|_{t=0} = \varphi(\mathbf{x})
	\end{array}\right.
	\end{align}

的解为

.. math::
	\begin{align}
	u(t,\mathbf{x}) &= U(t,\mathbf{x}) * \varphi(\mathbf{x}) + \int_{0}^{t}U(t-\tau, \mathbf{x}) * f(\tau,\mathbf{x})\mathrm{d}\tau \\
	&= \Big( \frac{1}{2a\sqrt{\pi t}} \Big)^{n} \int_{\mathbb{R}^{n}} \varphi(\mathbf{x}') \exp\Big( -\frac{|\mathbf{x} - \mathbf{x}'|}{4a^{2}t} \Big)\mathrm{d}\mathbf{x}' \\
	&\quad + \Big( \frac{1}{2a\sqrt{\pi t}} \Big)^{n} \int_{0}^{t} \frac{\mathrm{d}\tau}{(\sqrt{t-\tau})^{n}} \int_{\mathbb{R}^{n}} f(\tau, \mathbf{x}') \exp\Big( -\frac{|\mathbf{x} - \mathbf{x}'|}{4a^{2}(t-\tau)} \Big)\mathrm{d}\mathbf{x}'
	\end{align}

其中，积分变量 :math:`\mathbf{x}' = (\xi_{1}, \xi_{2}, \cdots, \xi_{n}) \in \mathbb{R}^{n}` 。


波动方程的初值问题
^^^^^^^^^^^^^^^^^^^^^^^

考虑单波方程初值问题的基本解，也即求解初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial U}{\partial t} + a\cfrac{\partial U}{\partial x} = 0 ,\quad t>0, -\infty<x<+\infty \\
	U|_{t=0} = \delta(x)
	\end{array}\right.
	\end{align}

对上述方程和初始条件作Fourier变换，记 :math:`\hat{U}(t,\lambda) = F[U(t,x)]` ，得到

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\mathrm{d}\hat{U}}{\mathrm{d}t} + \mathrm{i}a\lambda\hat{U} = 0 \\
	\hat{U}|_{t=0} = 1
	\end{array}\right.
	\end{align}

此常微分方程初值问题的解

.. math::
	\begin{align}
	\hat{U}(t,x) = e^{-\mathrm{i}a\lambda t}
	\end{align}

作反变换，得到

.. math::
	\begin{align}
	U(t,x) = F^{-1}[e^{-\mathrm{i}a\lambda t}] = \delta(x-at)
	\end{align}

根据该基本解，可以直接得到单波方程初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial u}{\partial t} + a\cfrac{\partial u}{\partial x} = f(t,x) ,\quad t>0, -\infty<x<+\infty \\
	u|_{t=0} = \varphi(x)
	\end{array}\right.
	\end{align}

的解为

.. math::
	\begin{align}
	u(t,x) &= \delta(x-at) * \varphi(x) + \int_{0}^{t} \delta\big(x-a(t-\tau)\big) * f(\tau,x)\mathrm{d}\tau \\
	&= \varphi(x-at) + \int_{0}^{t} f\big(\tau, x-a(t-\tau)\big)\mathrm{d}\tau \\
	&= \varphi(x-at) + \frac{1}{a}\int_{x-at}^{x} f\Big(t-\frac{x-\xi}{a}, \xi\Big)\mathrm{d}\xi
	\end{align}



考虑三维波动方程初值问题的基本解，也就是求解初值问题

.. math::
	\begin{align}
	\left\{\begin{array}{l}
	\cfrac{\partial^{2}U}{\partial t^{2}} = a^{2}\Delta_{3}U ,\quad t>0, -\infty<x,y,z<+\infty \\
	U|_{t=0} = 0,\quad \cfrac{\partial U}{\partial t}\Big|_{t=0} = \delta(x,y,z)
	\end{array}\right.
	\end{align}

对方程和初始条件作Fourier变换，记 :math:`\hat{U}(t,\lambda,\mu,\nu) = F[U(t,x,y,z)]` ，得到常微分方程初值问题

.. math::
	\begin{align}
	\left\{ \begin{array}{l}
	\cfrac{\mathrm{d}^{2}\hat{U}}{\mathrm{d}t^{t}} = -a^{2}\rho^{2}\hat{U} ,\quad t>0, -\infty<\lambda,\mu,\nu<+\infty \\
	\hat{U}|_{t=0} = 0 ,\quad \cfrac{\partial \hat{U}}{\partial t}\Big|_{t=0} = 1
	\end{array} \right.
	\end{align}

其中 :math:`\rho = \sqrt{\lambda^{2} + \mu^{2} + \nu^{2}}` 。该初值问题的解为

.. math::
	\begin{align}
	\hat{U}(t,\lambda,\mu,\nu) = \frac{\sin a\rho t}{a\rho}
	\end{align}

作反变换，得到

.. math::
	\begin{align}
	U(t,x,y,z) = \frac{1}{(2\pi)^{3}} \iiint\limits_{-\infty}^{+\infty}\frac{\sin a\rho t}{a\rho} e^{\mathrm{i}(\lambda x + \mu y + \nu z)}\mathrm{d}\lambda\mathrm{d}\mu\mathrm{d}\nu
	= \frac{1}{(2\pi)^{3}} \iiint\limits_{-\infty}^{+\infty}\frac{\sin a\rho t}{a\rho} e^{\mathrm{i}\boldsymbol{\rho}\cdot \mathbf{r}}\mathrm{d}\lambda\mathrm{d}\mu\mathrm{d}\nu
	\end{align}

这里向量 :math:`\mathbf{r} = (x,y,z), \boldsymbol{\rho} = (\lambda,\mu,\nu)` 。以 :math:`\mathbf{r}` 方向为极轴方向取球坐标， :math:`r=\sqrt{x^{y}+y^{2}+z^{2}}` ，则

.. math::
	\begin{align}
	U(t,x,y,z) &= \frac{1}{(2\pi)^{3}} \int_{-\infty}^{+\infty}\frac{\sin a\rho t}{a\rho} \int_{0}^{2\pi}\int_{0}^{\pi} e^{\mathrm{i}\rho r\cos\theta}\rho^{2}\sin\theta\mathrm{d}\theta\mathrm{d}\varphi\mathrm{d}\rho \\
	&= -\frac{1}{4\pi^{2}a} \int_{0}^{+\infty} \sin a\rho t \frac{e^{\mathrm{i}\rho r\cos\theta}}{\mathrm{i}r}\Big|_{0}^{\pi}\mathrm{d}\rho \\
	&= \frac{1}{2\pi^{2}ar} \int_{0}^{+\infty} \sin a\rho t \sin \rho r \mathrm{d}\rho \\
	&= \frac{1}{4\pi^{2}ar} \int_{0}^{+\infty} [\cos \rho(r-at) - \cos\rho(r+at)]\mathrm{d}\rho \\
	&= \frac{1}{8\pi^{2}ar} \int_{-\infty}^{\infty} \Big[ e^{\mathrm{i}\rho(r-at)} - e^{\mathrm{i}\rho(r + at)} \Big]\mathrm{d}\rho \\
	&= \frac{1}{4\pi ar} [\delta(r-at) - \delta(r+at)] \\
	&= \frac{\delta(r-at)}{4\pi ar}
	\end{align}

根据该基本解，可以得知三维波动方程初值问题

.. math::
	\begin{align}
	\left\{ \begin{array}{l}
	\cfrac{\partial^{2}u}{\partial t^{2}} = a^{2}\Delta_{3}u + f(t,x,y,z) ,\quad t>0, -\infty<x,y,z<+\infty \\
	u|_{t=0} = \varphi(x,y,z) ,\quad \cfrac{\partial u}{\partial t}\Big|_{t=0} = \psi(x,y,z)
	\end{array} \right.
	\end{align}

的解为

.. math::
	\begin{align}
	u(t,M) = U(t,M) * \psi(M) + \frac{\partial}{\partial t}[U(t,M) * \varphi(M)] + \int_{0}^{t}U(t-\tau, M) * f(\tau,M)\mathrm{d}\tau ,\quad M=(x,y,z)\in\mathbb{R}^{3}
	\end{align}

其中

.. math::
	\begin{align}
	u_{1}(t,x,y,z) = U(t,M) * \psi(M) = \frac{1}{4\pi a}\iiint\limits_{-\infty}^{+\infty} \frac{\delta(r-at)}{r}\psi(\xi,\eta,\zeta)\mathrm{d}\xi\mathrm{d}\eta\mathrm{d}\zeta
	,\quad
	r = \sqrt{(x-\xi)^{2} + (y-\eta)^{2} + (z-\zeta)^{2}}
	\end{align}

如果以 :math:`M=(x,y,z)` 为中心， :math:`r` 为半径作球面 :math:`S_{r}` ，球坐标变换 :math:`\xi = x + r\sin\theta\cos\varphi` ， :math:`\eta = y + r\sin\theta\sin\varphi` ， :math:`\zeta = z + r\cos\theta` ，则

.. math::
	\begin{align}
	u_{1}(t,x,y,z) &= \frac{1}{4\pi a} \int_{0}^{+\infty} \frac{\delta(r-at)}{r} \Big[ \oint_{S_{r}}\psi(\xi,\eta,\zeta)\mathrm{d}S \Big]\mathrm{d}r \\
	&= \frac{1}{4\pi a^{2}t} \oint_{S_{at}}\psi(\xi,\eta,\zeta)\mathrm{d}S \\
	&= t \cdot \frac{1}{4\pi(at)^{2}}\oint_{S_{at}}\psi(\xi,\eta,\zeta)\mathrm{d}S \\
	&= tM_{at}(\psi)
	\end{align}

其中，记号 :math:`M_{at}(\psi)` 表示函数 :math:`\psi` 在以 :math:`(x,y,z)` 为中心， :math:`at` 为半径的球面 :math:`S_{at}` 上的平均值。类似地，可以得到

.. math::
	\begin{align}
	u_{2}(t,x,y,z) = \frac{\partial }{\partial t}U(t,M) * \varphi(M) = \frac{\partial }{\partial t}[tM_{at}(\varphi)]
	\end{align}

.. math::
	\begin{align}
	u_{3}(t,x,y,z) &= \int_{0}^{t} U(t-\tau,M) * f(\tau,M)\mathrm{d}\tau \\
	&= \int_{0}^{t}(t-\tau)M_{a(t-\tau)}(f)\mathrm{d}\tau \\
	&= \int_{0}^{t}\frac{1}{4\pi a^{2}(t-\tau)}\oint_{S_{a(t-\tau)}}f(\tau,\xi,\eta,\zeta)\mathrm{d}S\mathrm{d}\tau \\
	&= \frac{1}{4\pi a^{2}}\int_{0}^{at} \oint_{S_{r}}\frac{f(t-\frac{r}{a}, \xi,\eta,\zeta)}{r}\mathrm{d}S\mathrm{d}r
	\end{align}

最后一步由变量代换 :math:`r=a(t-\tau)` 得到，公式中的球面 :math:`S_{a(t-\tau)}` 和 :math:`S_{r}` 均以 :math:`(x,y,z)` 为中心。

特别的，齐次三维波动方程初值问题的解为

.. math::
	\begin{align}
	u(t,x,y,z) = tM_{at}(\psi) + \frac{\partial }{\partial t}[tM_{at}(\varphi)]
	\end{align}



.. note:: 

	利用降维法求解二位波动方程初值问题

	.. math::
		\begin{align}
		\left\{ \begin{array}{l}
		\cfrac{\partial^{2}u}{\partial t^{2}} = a^{2}\Big( \cfrac{\partial^{2}u}{\partial x^{2}} + \cfrac{\partial^{2}u}{\partial y^{2}} \Big)
		,\quad t>0, -\infty<x,y<+\infty \\
		u|_{t=0} = \varphi(x,y)
		,\quad
		\cfrac{\partial u}{\partial t}\Big|_{t=0} = \psi(x,y)
		\end{array} \right.
		\end{align}

	该二维问题可以看成是三维波动方程当初始条件 :math:`u|_{t=0} = \varphi(x,y), \frac{\partial u}{\partial t}\Big|_{t=0} = \psi(x,y)` 时的特殊情况。于是可知

	.. math::
		\begin{align}
		u(t,x,y) = tM_{at}(\psi) + \frac{\partial}{\partial t}[tM_{at}(\varphi)]
		\end{align}

	首先需要将 :math:`M_{at}(\psi)` 中的球面积分化为二重积分。由于被积函数 :math:`\psi(\xi,\eta)` 与 :math:`\zeta` 无关， :math:`\psi` 在上、下半球面上的积分值相同。上半球面的方程为

	.. math::
		\begin{align}
		\zeta = z + \sqrt{(at)^{2} - (\xi - x)^{2} - (\eta - y)^{2}}
		\end{align}

	球面面积元 :math:`\mathrm{d}S` 与其在 :math:`\xi-\eta` 平面的投影 :math:`\mathrm{d}A` 之间存在关系

	.. math::
		\begin{align}
		\mathrm{d}S = \sqrt{1 + \Big(\frac{\partial \zeta}{\partial \xi}\Big)^{2} + \Big(\frac{\partial \zeta}{\partial \eta}\Big)^{2}} \mathrm{d}A
		= \frac{at}{\sqrt{(at)^{2} - (\xi-x)^{2} - (\eta - y)^{2}}}\mathrm{d}A
		\end{align}

	所以

	.. math::
		\begin{align}
		\oint_{S_{at}}\psi(\xi,\eta)\mathrm{d}S
		= 2\iint_{S_{at}^{up}}\psi(\xi,\eta)\mathrm{d}S
		= 2at\iint_{D_{at}}\frac{\psi(\xi,\eta)}{\sqrt{(at)^{2} - (\xi-x)^{2} - (\eta - y)^{2}}}\mathrm{d}A
		\end{align}

	其中二重积分区域 :math:`D_{at}` 是 :math:`S_{at}` 在 :math:`\xi-\eta` 平面上的投影，即以 :math:`(x,y)` 为中心， :math:`at` 为半径的圆域。所以二维波动方程初值问题式的解为

	.. math::
		\begin{align}
		u(t,x,y) = \frac{1}{2\pi a} \iint_{D_{at}}\frac{\psi(\xi,\eta)}{\sqrt{(at)^{2} - (\xi-x)^{2} - (\eta - y)^{2}}}\mathrm{d}\xi\mathrm{d}\eta
		+ \frac{1}{2\pi a}\frac{\partial }{\partial t} \iint_{D_{at}}\frac{\psi(\xi,\eta)}{\sqrt{(at)^{2} - (\xi-x)^{2} - (\eta - y)^{2}}}\mathrm{d}\xi\mathrm{d}\eta
		\end{align}

	特别的，如果取 :math:`\varphi(x,y) = 0, \psi(x,y) = \delta(x,y)` ，根据上式可以得到二位波动方程初值问题的基本解

	.. math::
		\begin{align}
		U(t,x,y) &= \frac{1}{2\pi a} \iint_{D_{at}}\frac{\delta(\xi,\eta)}{\sqrt{(at)^{2} - (\xi-x)^{2} - (\eta - y)^{2}}}\mathrm{d}\xi\mathrm{d}\eta \\
		&= \left\{ \begin{array}{l}
		\cfrac{1}{2\pi a \sqrt{(at)^{2} - x^{2} - y^{2}}} ,\quad r<at \\
		0 ,\quad r>at
		\end{array} \right. \\
		&= \frac{1}{2\pi a \sqrt{(at)^{2} - r^{2}}}H(at - r) ,\quad r=\sqrt{x^{2} + y^{2}}
		\end{align}













Notions on Hyperbolic Partial Differential Equations
======================================================

In this chapter we study some elementary properties of a class of hyperbolic Partial Differential Equations. Here we deal almost exclusively with hyperbolic PDEs and hyperbolic conservation laws in particular. There are three main reasons for this: (1) The equations of compressible fluid flow reduce to hyperbolic systems, the Euler equations, when the effects of viscosity and heat conduction are neglected. (2) Numerically, it is generally accepted that the hyperbolic terms of the PDEs of fluid flow are the terms that pose the most stringent requirements on the discretisation techniques. (3) The theory of hyperbolic systems is much more advanced than that for more complete mathematical models, such as the Navier-Stokes equations. In addition, there has in recent years been a noticeable increase in research and development activities centred on the theme of hyperbolic problems, as these cover a wide range of areas of scientific and technological interest.

Quasi-Linear Equations: Basic Concepts
-----------------------------------------

In this section we study systems of first-order partial differential equations of the form

.. math::
	\begin{align}
	\frac{\partial u_{i}}{\partial t}
	+ \sum_{j=1}^{m} a_{ij}(x,t,u_{1},\cdots,u_{m})\frac{\partial u_{j}}{\partial x}
	+ b_{i}(x,t,u_{1},\cdots,u_{m})
	= 0
	\end{align}

for :math:`i=1,\cdots,m` . This is a system of :math:`m` equations in :math:`m` unknowns :math:`u_{i}` that depend on space :math:`x` and a time-like variable :math:`t` . Here :math:`u_{i}` are the dependent variables and :math:`x,t` are the independent variables; this is expressed via the notation :math:`u_{i}=u_{i}(x,t)` ; :math:`\partial u_{i}/\partial t` denotes the partial derivative of :math:`u_{i}(x,t)` with respect to :math:`t` ; similarly :math:`\partial u_{i} / \partial x` denotes the partial derivative of :math:`u_{i}(x,t)` with respect to :math:`t` ; similarly :math:`\partial u_{i}/\partial t` denotes the partial derivative of :math:`u_{i}(x,t)` with respect to :math:`x` . We also make use of subscripts to denote partial derivatives. The system can also be written in matrix form as

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} + \mathbf{B} = \mathbf{0}
	\end{align}

with

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} u_{1} \\ u_{2} \\ \vdots \\ u_{m} \end{bmatrix}
	,\quad
	\mathbf{B} = \begin{bmatrix} b_{1} \\ b_{2} \\ \vdots \\ b_{m} \end{bmatrix}
	,\quad
	\mathbf{A} =
	\begin{bmatrix}
	a_{11} & \cdots & a_{1m} \\
	a_{21} & \cdots & a_{2m} \\
	\vdots & \vdots & \vdots \\
	a_{m1} & \cdots & a_{mm}
	\end{bmatrix}
	\end{align}

If the entries :math:`a_{ij}` of the matrix :math:`\mathbf{A}` are all constant and the component :math:`b_{j}` of the vector :math:`\mathbf{B}` are also constant ten system is linear with constant coefficients. If :math:`a_{ij}=a_{ij}(x,t)` and :math:`b_{i}=b_{i}(x,t)` the system is linear with variable coefficients. The system is still linear if :math:`\mathbf{B}` depends linearly on :math:`\mathbf{U}` and is called quasi-linear if the coefficient matrix :math:`\mathbf{A}` is a function of the vector :math:`\mathbf{U}` , that is :math:`\mathbf{A}=\mathbf{A}(\mathbf{A})` . Note that quasi-linear systems are in general systems of non-linear equations. The system is called homogeneous if :math:`\mathbf{B}=\mathbf{0}` . For a set of PDEs of the form, one needs to specify the range of variation of the independent variables :math:`x` and :math:`t` . Usually :math:`x` lies in a subinterval of the real line, namely :math:`x_{l}<x<x_{r}` ; the values :math:`x_{l},x_{r}` one also needs to specify Boundary Conditions (BCs). In this Chapter we assume the domain is the full real line, :math:`-\infty < x < \infty` , and thus no boundary conditions need to be specified. As to variations of time we assume :math:`t_{0} < t < \infty` . An Initial Condition (IC) needs to be specified at the initial time, which is usually chosen to be :math:`t_{0}=0` .

Two scalar :math:`(m=1)` examples of PDEs of the form are the liear advection equation

.. math::
	\begin{align}
	\frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x} = 0
	\end{align}

and the inviscid Burgers equation

.. math::
	\begin{align}
	\frac{\partial u}{\partial t} + u\frac{\partial u}{\partial x} = 0
	\end{align}

In the linear advection equation the coefficient :math:`a` (a constant) is the wave propagation speed. In the Burgers equation :math:`a=a(u)=u` .


Conservation lawss are systems of partial differential equations that can be written in the form

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
	\end{align}

where

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} u_{1} \\ u_{2} \\ \vdots \\ u_{m} \end{bmatrix}
	,\quad
	\mathbf{F}(\mathbf{U}) = \begin{bmatrix} f_{1} \\ f_{2} \\ \vdots \\ f_{m} \end{bmatrix}
	\end{align}

:math:`\mathbf{U}` is called the vector of conserved variables, :math:`\mathbf{F}=\mathbf{F}(\mathbf{U})` is the vector of fluxes and each of its components :math:`f_{i}` is a function of the components :math:`u_{j}` of :math:`\mathbf{U}` .

The Jacobian of the flux function :math:`\mathbf{F}(\mathbf{U})` in the above systems is the matrix

.. math::
	\begin{align}
	\mathbf{A}(\mathbf{U}) = \frac{\partial \mathbf{F}}{\partial \mathbf{U}} = 
	\begin{bmatrix}
	\frac{\partial f_{1}}{\partial u_{1}} & \cdots & \frac{\partial f_{1}}{\partial u_{m}} \\
	\frac{\partial f_{2}}{\partial u_{1}} & \cdots & \frac{\partial f_{2}}{\partial u_{m}} \\
	\vdots & \vdots & \vdots \\
	\frac{\partial f_{m}}{\partial u_{1}} & \cdots & \frac{\partial f_{m}}{\partial u_{m}}
	\end{bmatrix}
	\end{align}

The entries :math:`a_{ij}` of :math:`\mathbf{A}(\mathbf{U})` are partial derivatives of the components :math:`f_{i}` of the vector :math:`\mathbf{F}` with respect to the components :math:`u_{j}` of conserved variables :math:`\mathbf{U}` , that is :math:`a_{ij}=\partial f_{i} / \partial u_{j}` .

Note that conservation laws of the form can also be written in quasi-linear form, with :math:`\mathbf{B}\equiv\mathbf{0}` , by applying the chain rule to the second term in the conservation laws, namely

.. math::
	\begin{align}
	\frac{\partial \mathbf{F}(\mathbf{U})}{\partial x} = \frac{\partial \mathbf{F}}{\partial \mathbf{U}}\frac{\partial \mathbf{U}}{\partial x}
	\end{align}

Hence the conservation laws becomes

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{A}(\mathbf{U})\mathbf{U}_{x} = \mathbf{0}
	\end{align}

The scalar PDEs, the linear advection equation and the inviscid Burgers equation, can be expressed as conservation laws, namely

.. math::
	\begin{align}
	& \frac{\partial u}{\partial t} + \frac{\partial f(u)}{\partial x} = 0 ,\quad f(u) = au \\
	& \frac{\partial u}{\partial t} + \frac{\partial f(u)}{\partial x} = 0 ,\quad f(u) = \frac{1}{2}u^{2}
	\end{align}

Physically, eigenvalues represent speeds of propagation of information. Speeds will be measured positive in the direction of increasing :math:`x` and negative otherwise.

For the scalar examples above, the eigenvalues are trivially found to be :math:`\lambda = a` and :math:`\lambda = u` respectively. Next we find eigenvalues and eigenvectors for a system of PDEs. 

The linearised equations of Gas Dynamics are the :math:`2 \times 2` linear system

.. math::
	\begin{align}
	& \frac{\partial \rho}{\partial t} + \rho_{0}\frac{\partial u}{\partial x} = 0 \\
	& \frac{\partial u}{\partial t} + \frac{a^{2}}{\rho_{0}}\frac{\partial \rho}{\partial x} = 0
	\end{align}

where the unkowns are the density :math:`u_{1} = \rho(x,t)` and the speed :math:`u_{2}=u(x,t)` ; :math:`\rho_{0}` is a constant reference density and :math:`a` is the sound speed, a positive constant. When written in the matrix form this system reads

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}
	\end{align}

with

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} \rho \\ u \end{bmatrix}
	,\quad
	\mathbf{A} = \begin{bmatrix} 0 & \rho_{0} \\ a^{2}/\rho_{0} & 0 \end{bmatrix}
	\end{align}

The eigenvalues of the system are the zeros of the characteristic polynomial

.. math::
	\begin{align}
	|\mathbf{A} - \lambda\mathbf{I}| = \det
	\begin{bmatrix}
	0-\lambda & \rho_{0} \\
	a^{2}/\rho_{0} & 0-\lambda
	\end{bmatrix}
	\end{align}

That is, :math:`\lambda^{2}=a^{2}` , which has two real and distinct solutions, namely

.. math::
	\begin{align}
	\lambda_{1}=-a ,\quad \lambda_{2}=+a
	\end{align}

We now can find the right eigenvectors :math:`\mathbf{K}^{(1)}, \mathbf{K}^{(2)}` corresponding to the eigenvalues :math:`\lambda_{1}` and :math:`\lambda_{2}` , namely

.. math::
	\begin{align}
	\mathbf{K}^{(1)} = \begin{bmatrix} \rho_{0} \\ -a \end{bmatrix}
	,\quad
	\mathbf{K}^{(2)} = \begin{bmatrix} \rho_{0} \\ a \end{bmatrix}
	\end{align}



A system of first-order partial differential equations is said to be hyperbolic at a point :math:`(x,t)` if :math:`\mathbf{A}` has :math:`m` real eigenvalues :math:`\lambda_{1},\cdots,\lambda_{m}` and a corresponding set of :math:`m` linearly independent right eigenvectors :math:`\mathbf{K}^{(1)}, \cdots, \mathbf{K}^{(m)}` . The system is said to be strictly hyperbolic if the eigenvalues :math:`\lambda_{i}` are all distinct.

Note that strict hyperbolicity implies hyperbolicity, because real and distinct eigenvalues ensure the existence of a set of linearly independent eigenvectors. The system is said to be elliptic at a point :math:`(x,t)` if none of the eigenvalues :math:`\lambda_{i}` of :math:`\mathbf{A}` are real. Both scalar examples given above are trivially hyperbolic. The linearised gas dynamic equations are also hyperbolic, since :math:`\lambda_{1}` and :math:`\lambda_{2}` are both real at any point :math:`(x,t)` . Moreover, as the eigenvalues are also distinct this system is strictly hyperbolic.

An example of a first-order system of the form with :math:`t` replaced by :math:`x` and :math:`x` replaced by :math:`y` is the Cauchy-Riemann equations

.. math::
	\begin{align}
	\frac{\partial u}{\partial x} - \frac{\partial v}{\partial y} = 0
	,\quad
	\frac{\partial v}{\partial x} + \frac{\partial u}{\partial y} = 0
	\end{align}

where :math:`u_{1}=u(x,y)` and :math:`u_{2}=v(x,y)` . These equations arise in the study of analytic in Complex Analysis. When written in matrix notation, equations become

.. math::
	\begin{align}
	\mathbf{U}_{x} + \mathbf{A}\mathbf{U}_{y} = \mathbf{0}
	\end{align}

with

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} u \\ v \end{bmatrix}
	,\quad
	\mathbf{A} = \begin{bmatrix} 0 & - 1 \\ 1 & 0 \end{bmatrix}
	\end{align}

The charateristic polynomial :math:`|\mathbf{A} - \lambda\mathbf{I}| = 0` gives :math:`\lambda^{2}+1=0` , which has no real solutions for :math:`\lambda` and thus the system is elliptic.

The small perturbation steady equations were introduced

.. math::
	\begin{align}
	u_{x} - a^{2}v_{y} = 0
	,\quad
	v_{x} - u_{y} = 0
	\end{align} 

with

.. math::
	\begin{align}
	a^{2} = \frac{1}{M_{\infty}^{2} - 1}
	\end{align}

:math:`M_{\infty} = \text{constant}` denotes the free-stream Mach number and :math:`u(x,y),v(x,y)` are small perturbations of the :math:`x` and :math:`y` velocity components respectively. In matrix notation these equations read

.. math::
	\begin{align}
	\mathbf{U}_{x} + \mathbf{A}\mathbf{U}_{y} = \mathbf{0}
	\end{align}

with

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} u \\ v \end{bmatrix}
	,\quad
	\mathbf{A} = \begin{bmatrix} 0 & -a^{2} \\ -1 & 0 \end{bmatrix}
	\end{align}

The character of these equations depends entirely on the value of the Mach number :math:`M_{\infty}` . For subsonic flow :math:`M_{\infty} < 1` the characteristic polynomial has complex solutions and thus the equations are of elliptic type. For supersonic flow :math:`M_{\infty} > 1` and the system is strictly hyperbolic, wich eigenvalues

.. math::
	\begin{align}
	\lambda_{1} = -a
	,\quad
	\lambda_{2} = +a
	\end{align}

We can check that the corresponding right eigenvectors are

.. math::
	\begin{align}
	\mathbf{K}^{(1)} = \begin{bmatrix} a \\ 1 \end{bmatrix}
	,\quad
	\mathbf{K}^{(2)} = \begin{bmatrix} a \\ -1 \end{bmatrix}
	\end{align}


The Linear Advection Equation
--------------------------------

A general, time-dependent linear advection equation in three space dimensions reads

.. math::
	\begin{align}
	u_{t} + a(x,y,z,t)u_{x} + b(x,y,z,t)u_{y} + c(x,y,z,t)u_{z} = 0
	\end{align}

where the unkown is :math:`u=u(x,y,z,t)` and :math:`a,b,c` are variable coefficients. If the coefficients are sufficiently smooth one can express the equation as a conservation law with some terms, namely

.. math::
	\begin{align}
	u_{t} + (au)_{x} + (bu)_{y} + (cu)_{z} = u(a_{x} + b_{y} + c_{z})
	\end{align}

In this section we study in detial the initial-value problem (IVP) for the special case of the linear advection equation, namely

.. math::
	\begin{align}
	& u_{t} + au_{x} = 0 ,\quad -\infty < x < \infty , t>0 \\
	& u(x,0) = u_{0}(x)
	\end{align}

where :math:`a` is a constant wave propagation speed. The initial data at time :math:`t=0` is a function of :math:`x` alone and is denoted by :math:`u_{0}(x)` . Generally, we shall not explicit about the conditions :math:`-\infty < x < \infty` ; :math:`t>0` on the independent variables when stating an initial-value problem. The PDE above is the simplest hyperboli PDE and is also the simplest hyperbolic conservation law. It is a very useful model equation for the purpose of studying numerical methods for hyperbolic conservation laws, in the same way as the linear, first-order ordinary differential equation

.. math::
	\begin{align}
	\frac{\mathrm{d}x}{\mathrm{d}t} = \beta ,\quad x=x(t), \quad \beta=\text{constant}
	\end{align}

is a popular model equation for analysing numerical methods for Ordinary Differential Equation (ODEs). We study numerical methods for ODEs in connection with source terms in inhomogeneous PDEs.



We recall the definition of characteristics or characteristic curves in the context of a scalar equation. Characteristics may be defined as curves :math:`x=x(t)` in the t-x plane along which the PDE becomes an ODE. Consider :math:`x=x(t)` and regard :math:`u` as a function of :math:`t` , that is :math:`u=u(x(t),t)` . The rate of change of :math:`u` along :math:`x=x(t)` is

.. math::
	\begin{align}
	\frac{\mathrm{d}u}{\mathrm{d}t} = \frac{\partial u}{\partial t} + \frac{\mathrm{d} x}{\mathrm{d} t}\frac{\partial u}{\partial x}
	\end{align}

If the characteristic curve :math:`x=x(t)` satisfies the ODE

.. math::
	\begin{align}
	\frac{\mathrm{d}x}{\mathrm{d}t} = a
	\end{align}

then the PDE :math:`u_{t}+au_{x}=0` , together with :math:`\frac{\mathrm{d}u}{\mathrm{d}t} = \frac{\partial u}{\partial t} + \frac{\mathrm{d} x}{\mathrm{d} t}\frac{\partial u}{\partial x}` and :math:`\frac{\mathrm{d}x}{\mathrm{d}t} = a` , gives

.. math::
	\begin{align}
	\frac{\mathrm{d}u}{\mathrm{d}t} = \frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x} = 0
	\end{align}

Therefore the rate of change of :math:`u` along the characteristic curve :math:`x=x(t)` satisfying :math:`\frac{\mathrm{d}x}{\mathrm{d}t}=a` is zero, that is, :math:`u` is constant along the curve :math:`x=x(t)` . The speed :math:`a` in :math:`\frac{\mathrm{d}x}{\mathrm{d}t}=a` is called the characteristic speed and according to :math:`\frac{\mathrm{d}x}{\mathrm{d}t}=a` it is the slope of the curve :math:`x=x(t)` in the t-x plane. In practice it is more common to use the x-t plane to sketch the characteristics, in which case the slope of the curves in question is :math:`1/a` . The family of characteristic curves :math:`x=x(t)` given by the ODE :math:`\frac{\mathrm{d}x}{\mathrm{d}t}=a` are illustrated in Fig.2.1 for :math:`a>0` and are a one-parameter family of curves. A particular member of this family is determined when an initial condition (IC) at time :math:`t=0` for the ODE is added. Suppose we set

.. math::
	\begin{align}
	x(0) = x_{0}
	\end{align}

then the single characteristic curve that passes through the point :math:`(x_{0},0)` , according to :math:`\frac{\mathrm{d}x}{\mathrm{d}t}=a` is

.. math::
	\begin{align}
	x = x_{0} + at
	\end{align}

This is also illustrated in Fig.2.1. Now we may regard the initial position :math:`x_{0}` as a parameter and in this way we reproduce the full one-parameter family of characteristics. The fact that the curves are parallel is typical of linear hyperbolic PDEs with constant coefficients.

Recall the conclusion from :math:`\frac{\mathrm{d}u}{\mathrm{d}t}=\frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x}=0` that :math:`u` remains constant along characteristics. Thus, if :math:`u` is given the initial value :math:`u(x,0)=u_{0}(x)` at time :math:`t=0` , then along the whole characteristic curve :math:`x(t)=x_{0}+at` that passes through the initial point :math:`x_{0}` on the x-axis, the solution is 

.. math::
	\begin{align}
	u(x,t) = u_{0}(x_{0}) = u_{0}(x-at)
	\end{align}

The second equality follows from :math:`x=x_{0}+at` . The interpretation of the solution of the PDE is this: given an initial profile :math:`u_{0}(x)` , the PDE will simply translate this profile with velocity :math:`a` to the right if :math:`a>0` and to the left if :math:`a<0` . The shape of the initial profile remains unchanged. The model equation :math:`u_{t}+au_{x}=0` under study contains some of the basic features of wave propagation phenomena, where a wave is understood as some recognisable feature of a disturbance that travels at a finite speed.



By using geometric arguments, we have constructed the analytical solution of the general IVP for the linear advection equation. This is given by :math:`u(x,t)=u_{0}(x_{0})=u_{0}(x-at)` in terms of the initial data :math:`u_{0}(x)` . Now we study a special IVP called the Riemann problem

.. math::
	\begin{align}
	& u_{t} + au_{x} = 0 \\
	& u(x,0) = u_{0}(x) = \left\{ \begin{array}{ll}
	u_{L} \quad \text{if}~x<0 \\
	u_{R} \quad \text{if}~x>0
	\end{array} \right.
	\end{align}

where :math:`u_{L}` and :math:`u_{R}` are two constant values, as shown in Fig.2.2. Note that the initial data has a discontinuity at :math:`x=0` . The IVP above is the simplest initial-value problem one can pose. The trivial case would result when :math:`u_{L}=u_{R}` . From the previous discussion on the solution of the general IVP, we expect any point on the initial profile to propagate a distance :math:`d=at` in time :math:`t` . In particular, we expect the initial discontinuity at :math:`x=0` to propagate a distance :math:`d=at` in time :math:`t` . This particular characteristic curve :math:`x=at` will then separate those characteristic curves to the left, on which the solution takes on the value :math:`u_{L}` , from those curves to the right, on which the solution takes on the value :math:`u_{R}` ; see Fig.2.3. So the solution of the Riemann problem is simply

.. math::
	\begin{align}
	u(x,t) = u_{0}(x-at) = \left\{ \begin{array}{ll}
	u_{L} \quad \text{if}~x-at<0 \\
	u_{R} \quad \text{if}~x-at>0
	\end{array} \right.
	\end{align}

The solution also follows directly from the general solution, namely :math:`u(x,t)=u_{0}(x-at)` . From the Riemann problem IC, :math:`u_{0}(x-at)=u_{L}` if :math:`x-at<0` and :math:`u_{0}(x-at)=u_{R}` if :math:`x-at>0` . The solution of the Riemann problem can be represented in the x-t plane, as shown in Fig.2.3. Through any point :math:`x_{0}` on the x-axis one can draw a characteristic. As :math:`a` is constant these are all parallel to each other. For the solution of the Riemann problem the characteristic that passes through :math:`x=0` is significant. This is the only one across which the solution changes.


Linear Hyperbolic Systems
---------------------------

In the previous section we studied in detial the behaviour and the general solution of the simplest PDE of hyperbolic type, namely the linear advection equation with constant wave propagation speed. Here we extend the analysis to sets of :math:`m` hyperbolic PDEs of the form

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}
	\end{align}

where the coefficient matrix :math:`\mathbf{A}` is constant. From the assumption of hyperbolicity :math:`\mathbf{A}` has :math:`m` real eigenvalues :math:`\lambda_{i}` and :math:`m` linearly independent eigenvectors :math:`\mathbf{K}^{(i)}, i=1,\cdots,m` .


Diagonalisation and Characteristic Variables
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

In order to analyse and solve the general IVP for :math:`\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}` , it is found useful to transform the dependent variables :math:`\mathbf{U}(x,t)` to a new set of dependent variables :math:`\mathbf{W}(x,t)` . 

.. note:: 

	A matrix :math:`\mathbf{A}` is said to be diagonalisable if :math:`\mathbf{A}` can be expressed as

	.. math::
		\begin{align}
		\mathbf{A} = \mathbf{K}\mathbf{\Lambda}\mathbf{K}^{-1}
		\quad\text{or}\quad
		\mathbf{\Lambda} = \mathbf{K}^{-1}\mathbf{A}\mathbf{K}
		\end{align}

	in terms of a diagonal matrix :math:`\mathbf{\Lambda}` and a matrix :math:`\mathbf{K}` . The diagonal elements of :math:`\mathbf{\Lambda}` are the eigenvalues :math:`\lambda_{i}` of :math:`\mathbf{A}` and the columns :math:`\mathbf{K}^{(i)}` of :math:`\mathbf{K}` are the right eigenvectors of :math:`\mathbf{A}` corresponding to the eigenvalues :math:`\lambda_{i}` , that is 

	.. math::
		\begin{align}
		\mathbf{\Lambda} =
		\begin{bmatrix}
		\lambda_{1} & \cdots & 0 \\
		0 & \cdots & 0 \\
		\vdots & \vdots & \vdots \\
		0 & \cdots & \lambda_{m}
		\end{bmatrix}
		,\quad
		\mathbf{K} = [\mathbf{K}^{(1)},\cdots,\mathbf{K}^{(m)}]
		,\quad
		\mathbf{A}\mathbf{K}^{(i)} = \lambda_{i}\mathbf{K}^{(i)}
		\end{align}

A system :math:`\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}` is said to be diagonalisable if the coefficient matrix :math:`\mathbf{A}` is diagonalisable. Based on the concept of diagonalisation one often defines a hyperbolic system as a system with reall eigenvalues and diagonalisable coefficient matrix.


The existence of the inverse matrix :math:`\mathbf{K}^{-1}` makes it possible to define a new set of dependent variables :math:`\mathbf{W}=(w_{1},w_{2},\cdots,w_{m})^{T}` via the transformation

.. math::
	\begin{align}
	\mathbf{W} = \mathbf{K}^{-1}\mathbf{U}
	\quad\text{or}\quad
	\mathbf{U} = \mathbf{K}\mathbf{W}
	\end{align}

so that the linear system, when expressed in terms of :math:`\mathbf{W}` , becomes completely decoupled, in a sense to be defined. The new variables :math:`\mathbf{W}` are called characteristic variables. Next we derive the governing PDEs in terms of the characteristic variables, for which we need the partial derivatives :math:`\mathbf{U}_{t}` and :math:`\mathbf{U}_{x}` . Since :math:`\mathbf{A}` is constant, :math:`\mathbf{K}` is also constant and therefore these derivatives are

.. math::
	\begin{align}
	\mathbf{U}_{t} = \mathbf{K}\mathbf{W}_{t}
	,\quad
	\mathbf{U}_{x} = \mathbf{K}\mathbf{W}_{x}
	\end{align}

Direct substitution of these expressions into hyperbolic PDEs gives

.. math::
	\begin{align}
	\mathbf{K}\mathbf{W}_{t} + \mathbf{A}\mathbf{K}\mathbf{W}_{x} = \mathbf{0}
	\end{align}

Multiplication of this equation from the left by :math:`\mathbf{K}^{-1}` and use of :math:`\mathbf{\Lambda}=\mathbf{K}^{-1}\mathbf{A}\mathbf{K}` gives

.. math::
	\begin{align}
	\mathbf{W}_{t} + \mathbf{\Lambda}\mathbf{W}_{x} = \mathbf{0}
	\end{align}

This is called the canonical form or characteristic form of the system. When written in full this system becomes

.. math::
	\begin{align}
	\begin{bmatrix}
	w_{1} \\ w_{2} \\ \vdots \\ w_{m}
	\end{bmatrix}_{t}
	+
	\begin{bmatrix}
	\lambda_{1} & \cdots & 0 \\
	0 & \cdots & 0 \\
	\vdots & \vdots & \vdots \\
	0 & \cdots & \lambda_{m}
	\end{bmatrix}
	\begin{bmatrix}
	w_{1} \\ w_{2} \\ \vdots \\ w_{m}
	\end{bmatrix}_{x}
	= \mathbf{0}
	\end{align}

Clearly the :math:`i` -th PDE of this system is

.. math::
	\begin{align}
	\frac{\partial w_{i}}{\partial t} + \lambda_{i}\frac{\partial w_{i}}{\partial x} = 0
	,\quad i=1,\cdots,m
	\end{align}

and involves the single unkown :math:`w_{i}(x,t)` ; the system is therefore decoupled and is identical to the linear advection equation; now the characteristic speed is :math:`\lambda_{i}` and there are :math:`m` characteristic curves satisfying :math:`m` ODEs

.. math::
	\begin{align}
	\frac{\mathrm{d}x}{\mathrm{d}t} = \lambda_{i}
	,\quad \text{for}~ i=1,\cdots,m
	\end{align}


The General Initial-Value Problem
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

We now study the IVP for the PDEs :math:`\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}` . The initial condition is now denoted by superscript :math:`(0)` , namely

.. math::
	\begin{align}
	\mathbf{U}^{(0)} = (u_{1}^{(0)}, \cdots, u_{m}^{(0)})^{T}
	\end{align}

rather than by subscript :math:`0` , as done for the scalar case. We find the general solution of the IVP by first solving the corresponding IVP for the canonical system :math:`\mathbf{W}_{t}+\mathbf{\Lambda}\mathbf{W}_{x}=\mathbf{0}` in terms of the characteristic variables :math:`\mathbf{W}` and initial condition :math:`\mathbf{W}^{(0)}=(w_{1}^{(0)},\cdots,w_{m}^{(0)})^{T}` such that

.. math::
	\begin{align}
	\mathbf{W}^{(0)} = \mathbf{K}^{-1}\mathbf{U}^{(0)}
	\quad\text{or}\quad
	\mathbf{U}^{(0)} = \mathbf{K}\mathbf{W}^{(0)}
	\end{align}

The solution of the IVP for :math:`\mathbf{W}^{(0)}=(w_{1}^{(0)},\cdots,w_{m}^{(0)})^{T}` is direct. By considering each unkown :math:`w_{i}(x,t)` satisfying :math:`\frac{\partial w_{i}}{\partial t} + \lambda_{i}\frac{\partial w_{i}}{\partial x} = 0` and its corresponding initial data :math:`w_{i}^{(0)}` we write its solution immediately as

.. math::
	\begin{align}
	w_{i}(x,t) = w_{i}^{(0)}(x-\lambda_{i}t)
	,\quad \text{for}~ i=1,\cdots,m
	\end{align}

Compare with solution :math:`u(x,t)=u_{0}(x_{0})=u_{0}(x-at)` for the scalar case. The solution of the general IVP in terms of the original variables :math:`\mathbf{U}` is now obtained by transforming back according to :math:`\mathbf{U}=\mathbf{K}\mathbf{W}` .


.. note:: 

	As a simple example we now study the general IVP for the linearised equations of Gas Dynamics, namely

	.. math::
		\begin{align}
		\begin{bmatrix} u_{1} \\ u_{t} \end{bmatrix}_{t}
		+
		\begin{bmatrix} 0 & \rho_{0} \\ a^{2}/\rho_{0} & 0 \end{bmatrix}
		\begin{bmatrix} u_{1} \\ u_{2} \begin{bmatrix}_{x}
		= \mathbf{0}
		,\quad
		u_{1}\equiv \rho
		,quad
		u_{2}\equiv u
		\end{align}

	with initial condition

	.. math::
		\begin{align}
		\begin{bmatrix}
		u_{1}(x,0) \\ u_{2}(x,0)
		\end{bmatrix}
		=
		\begin{bmatrix}
		u_{1}^{(0)}(x) \\ u_{2}^{(0)}(x)
		\end{bmatrix}
		\end{align}

	We define characteristic variables

	.. math::
		\begin{align}
		\mathbf{W} = (w_{1},w_{2})^{T} = \mathbf{K}^{-1}\mathbf{U}
		\end{align}

	where :math:`\mathbf{K}` is the matrix of right eigenvectors and :math:`\mathbf{K}^{-1}` is its inverse, both given by

	.. math::
		\begin{align}
		\mathbf{K} = 
		\begin{bmatrix}
		\rho_{0} & \rho_{0} \\
		-a & a
		\end{bmatrix}
		,\quad
		\mathbf{K}^{-1} = \frac{1}{2a\rho_{0}}
		\begin{bmatrix}
		a & -\rho_{0} \\
		a & \rho_{0}
		\end{bmatrix}
		\end{align}

	Since :math:`\lambda_{1}=-a` and :math:`\lambda_{2}=a` , in terms of the characteristic variables we may write

	.. math::
		\begin{align}
		\begin{bmatrix} w_{1} \\ w_{2} \end{bmatrix}_{t}
		+
		\begin{bmatrix} -a & 0 \\ 0 & a \end{bmatrix}
		\begin{bmatrix} w_{1} \\ w_{2} \end{bmatrix}_{x}
		= \mathbf{0}
		\end{align}

	or in full

	.. math::
		\begin{align}
		\frac{\partial w_{1}}{\partial t} - a\frac{\partial w_{1}}{\partial x} = 0
		,\quad
		\frac{\partial w_{2}}{\partial t} + a\frac{\partial w_{2}}{\partial x} = 0
		\end{align}

	The initial condition satisfies

	.. math::
		\begin{align}
		\begin{bmatrix} w_{1}^{(0)} \\ w_{2}^{(0)}  \end{bmatrix} = \mathbf{K}^{-1} \begin{bmatrix} u_{1}^{(0)} \\ u_{2}^{(0)} \end{bmatrix}
		\end{align}

	or in full

	.. math::
		\begin{align}
		& w_{1}^{(0)}(x) = \frac{1}{2a\rho_{0}}\Big[ au_{1}^{(0)}(x) - \rho_{0}u_{2}^{(0)}(x) \Big] \\
		& w_{2}^{(0)}(x) = \frac{1}{2a\rho_{0}}\Big[ au_{1}^{(0)}(x) + \rho_{0}u_{2}^{(0)}(x) \Big]
		\end{align}

	Each equation involves a single independent variable and is a linear advection equation of the form :math:`\frac{\partial w_{i}}{\partial t} + \lambda_{i}\frac{\partial w_{i}}{\partial x} = 0` . The solution for :math:`w_{1}` and :math:`w_{2}` in terms of their initial data :math:`w_{1}^{(0)}, w_{2}^{(0)}` , according to :math:`w_{i}(x,t)=w_{i}^{(0)}(x-\lambda_{i}t)` is

	.. math::
		\begin{align}
		w_{1}(x,t) = w_{1}^{(0)}(x+at)
		,\quad
		w_{2}(x,t) = w_{2}^{(0)}(x-at)
		\end{align}	

	or in full

	.. math::
		\begin{align}
		& w_{1}(x,t) = \frac{1}{2a\rho_{0}} \Big[ au_{1}^{(0)}(x+at) - \rho_{0}u_{2}^{(0)}(x+at) \Big] \\
		& w_{2}(x,t) = \frac{1}{2a\rho_{0}} \Big[ au_{1}^{(0)}(x-at) + \rho_{0}u_{2}^{(0)}(x-at) \Big]
		\end{align}

	This is the solution in terms of the characteristic variables. In order to obtain the solution to the original problem we transform back using :math:`\mathbf{U}=\mathbf{K}\mathbf{W}` . This gives the final solution as

	.. math::
		\begin{align}
		& u_{1}(x,t) = \frac{1}{2a} \Big[ au_{1}^{(0)}(x+at) - \rho_{0}u_{2}^{(0)}(x+at) \Big] + \frac{1}{2a} \Big[ au_{1}^{(0)}(x-at) + \rho_{0}u_{2}^{(0)}(x-at) \Big] \\
		& u_{2}(x,t) = -\frac{1}{2\rho_{0}} \Big[ au_{1}^{(0)}(x+at) - \rho_{0}u_{2}^{(0)}(x+at) \Big] + \frac{1}{2\rho_{0}} \Big[ au_{1}^{(0)}(x-at) + \rho_{0}u_{2}^{(0)}(x-at) \Big]
		\end{align}


We return to the expression :math:`\mathbf{U}=\mathbf{K}\mathbf{W}` used to recover the solution to the original problem. When written in full this expression becomes

.. math::
	\begin{align}
	& u_{1} = w_{1}k_{1}^{(1)} + w_{2}k_{1}^{(2)} + \cdots + w_{m}k_{1}^{(m)} \\
	& u_{i} = w_{1}k_{i}^{(1)} + w_{2}k_{i}^{(2)} + \cdots + w_{m}k_{i}^{(m)} \\
	& u_{m} = w_{1}k_{m}^{(1)} + w_{2}k_{m}^{(2)} + \cdots + w_{m}k_{m}^{(m)}
	\end{align}

or

.. math::
	\begin{align}
	\begin{bmatrix} u_{1} \\ u_{2} \\ \vdots \\ u_{m} \end{bmatrix}
	=
	w_{1} \begin{bmatrix} k_{1}^{(1)} \\ k_{2}^{(1)} \\ \vdots \\ k_{m}^{(1)} \end{bmatrix}
	+ w_{2} \begin{bmatrix} k_{1}^{(2)} \\ k_{2}^{(2)} \\ \vdots \\ k_{m}^{(2)} \end{bmatrix}
	+ \cdots
	+ w_{m} \begin{bmatrix} k_{1}^{(m)} \\ k_{2}^{(m)} \\ \vdots \\ k_{m}^{(m)} \end{bmatrix}
	\end{align}

or more succinctly

.. math::
	\begin{align}
	\mathbf{U}(x,t) = \sum_{i=1}^{m} w_{i}(x,t)\mathbf{K}^{(i)}
	\end{align}

This means that the function :math:`w_{i}(x,t)` is the coefficient of :math:`\mathbf{K}^{(i)}` in an eigenvector expansion of the vector :math:`\mathbf{U}` . But according to :math:`w_{i}(x,t)=w_{i}^{(0)}(x-\lambda_{i}t)` we have

.. math::
	\begin{align}
	\mathbf{U}(x,t) = \sum_{i=1}^{m}w_{i}^{(0)}(x-\lambda_{i}t)\mathbf{K}^{(i)}
	\end{align}

Thus, given a point :math:`(x,t)` in the x-t plane, the solution :math:`\mathbf{U}(x,t)` at this point depends only on the initial data at the :math:`m` points :math:`x_{0}^{(i)} = x-\lambda_{i}t` . These are the intersections of the characteristics of speed :math:`\lambda_{i}` with the x-axis. The solution for :math:`\mathbf{U}` can be seen as the superposition of :math:`m` waves, each of which is advected independently without change in shape. The :math:`i` -th wave has shape :math:`w_{i}^{(0)}(x)\mathbf{K}^{(i)}` and propagates with speed :math:`\lambda_{i}` .



The Riemann Problem
^^^^^^^^^^^^^^^^^^^^^^

We study the Riemann problem for the hyperbolic, constant coefficient system. This is the special IVP

.. math::
	\begin{align}
	& \mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0} ,\quad -\infty<x<\infty,\quad t>0 \\
	& \mathbf{U}(x,0) = \mathbf{U}^{(0)}(x) = \left\{ \begin{array}{ll}
	\mathbf{U}_{L} \quad x<0 \\
	\mathbf{U}_{R} \quad x>0
	\end{array} \right.
	\end{align}

We assume that the system is strictly hyperbolic and we order the real and distinct eigenvalues as

.. math::
	\begin{align}
	\lambda_{1} < \lambda_{2} < \cdots < \lambda_{m}
	\end{align}

The structure of the solution of the Riemann problem in the x-t plane is depicted in Fig.2.4. It consists of :math:`m` waves emanating from the origin, one for each eigenvalue :math:`\lambda_{i}` . Each wave :math:`i` carries a jump discontinuity in :math:`\mathbf{U}` propagating with speed :math:`\lambda_{i}` . Naturally, the solution to the left of the :math:`\lambda_{1}` -wave is simply the initial data :math:`\mathbf{U}_{L}` and to the right of the :math:`\lambda_{m}` -wave is :math:`\mathbf{U}_{R}` . The task at hand is to find the solution in the wedge between the :math:`\lambda_{1}` and :math:`\lambda_{m}` waves. As the eigenvectors :math:`\mathbf{K}^{(1)},\cdots,\mathbf{K}^{(m)}` are linearly independent, we can expand the data :math:`\mathbf{U}_{L}` , constant left state, and :math:`\mathbf{U}_{R}` , constant right state, as linear combinations of the set :math:`\mathbf{K}^{(1)},\cdots,\mathbf{K}^{(m)}` , that is

.. math::
	\begin{align}
	\mathbf{U}_{L} = \sum_{i=1}^{m}\alpha_{i}\mathbf{K}^{(i)}
	,\quad
	\mathbf{U}_{R} = \sum_{i=1}^{m}\beta_{i}\mathbf{K}^{(i)}
	\end{align}

with constant coefficients :math:`\alpha_{i},\beta_{i}` for :math:`i=1,\cdots,m` . Formally, the solution fo the IVP is given by :math:`\mathbf{U}(x,t) = \sum_{i=1}^{m}w_{i}^{(0)}(x-\lambda_{i}t)\mathbf{K}^{(i)}` in terms of the initial data :math:`w_{i}^{(0)}(x)` for the characteristic variables and the right eigenvectors :math:`\mathbf{K}^{(i)}` . Note that each of the expansions of left state and right state is a special case of :math:`\mathbf{U}(x,t) = \sum_{i=1}^{m}w_{i}^{(0)}(x-\lambda_{i}t)\mathbf{K}^{(i)}` . In terms of the characteristic variables we have :math:`m` scalar Riemann problems for the PDEs

.. math::
	\begin{align}
	\frac{\partial w_{i}}{\partial t} + \lambda_{i}\frac{\partial w_{i}}{\partial x} = 0
	\end{align}

with initial data obtained by comparing :math:`\mathbf{U}_{L} = \sum_{i=1}^{m}\alpha_{i}\mathbf{K}^{(i)}, \mathbf{U}_{R} = \sum_{i=1}^{m}\beta_{i}\mathbf{K}^{(i)}` with :math:`\mathbf{U}(x,t) = \sum_{i=1}^{m}w_{i}^{(0)}(x-\lambda_{i}t)\mathbf{K}^{(i)}` , that is

.. math::
	\begin{align}
	w_{i}^{(0)}(x) = \left\{ \begin{array}{ll}
	\alpha_{i} \quad \text{if}~ x<0 \\
	\beta_{i} \quad \text{if}~ x>0
	\end{array} \right.
	\end{align}

for :math:`i=1,\cdots,m` . From the previous results, we know that the solutions of these scalar Riemann problems are given by

.. math::
	\begin{align}
	w_{i}(x,t) = w_{i}^{(0)}(x-\lambda_{i}t) = \left\{ \begin{array}{ll}
	\alpha_{i} \quad \text{if}~ x-\lambda_{i}t<0 \\
	\beta_{i} \quad \text{if}~ x-\lambda_{i}t>0
	\end{array} \right.
	\end{align}

For a given point :math:`(x,t)` there is an eigenvalue :math:`\lambda_{I}` such that :math:`\lambda_{I} < \frac{x}{t} < \lambda_{I+1}` , that is :math:`x-\lambda_{i}t > 0 \forall i` such that :math:`i \le I` . We can thus write the final solution to the Riemann problem in terms of the original variables as

.. math::
	\begin{align}
	\mathbf{U}(x,t) = \sum_{i=I+1}^{m}\alpha_{i}\mathbf{K}^{(i)} + \sum_{i=1}^{I}\beta_{i}\mathbf{K}^{(i)}
	\end{align} 

where the integer :math:`I=I(x,t)` is the maximum value of the sub-index :math:`i` for which :math:`x-\lambda_{i}t > 0` .



As an example consider the Riemann problem for a general :math:`2 \times 2` linear system. From the origin :math:`(0,0)` in the :math:`(x,t)` plane there will be two waves travelling with speeds that are equal to the characteristic speeds :math:`\lambda_{1}` and :math:`\lambda_{2}` ( :math:`\lambda_{1} < \lambda_{2}` ); see Fig.2.5. The solution to the left of :math:`\frac{\mathrm{d}x}{\mathrm{d}t}=\lambda_{1}` is simply the data state :math:`\mathbf{U}_{L} = \alpha_{1}\mathbf{K}^{(1)} + \alpha_{2}\mathbf{K}^{(2)}` and to the right of :math:`\frac{\mathrm{d}x}{\mathrm{d}t}=\lambda_{2}` the solution is the constant data state :math:`\mathbf{U}_{R} = \beta_{1}\mathbf{K}^{(1)} + \beta_{2}\mathbf{K}^{(2)}` . The wedge between the :math:`\lambda_{1}` and :math:`\lambda_{2}` waves is usually called the Star Region and the solution there is denoted by :math:`\mathbf{U}^{*}` ; its value is due to the passage of two waves emerging from the origin of the initial discontinuity. From the point :math:`P^{*}(x,t)` we trace back the characteristics with speeds :math:`\lambda_{1}` and :math:`\lambda_{2}` . These are parallel to those passing through the origin. The characteristics through :math:`P^{*}` pass through the initial points :math:`x_{0}^{(2)}=x-\lambda_{2}t` and :math:`x_{0}^{(1)}=x-\lambda_{1}t` . The coefficients in the expansion for :math:`\mathbf{U}(x,t)` are thus determined. The solution at a point :math:`P^{*}` has the form :math:`\mathbf{U}(x,t) = \sum_{i=I+1}^{m}\alpha_{i}\mathbf{K}^{(i)} + \sum_{i=1}^{I}\beta_{i}\mathbf{K}^{(i)}` . It is a question of choosing the correct coefficients :math:`\alpha_{i}` or :math:`\beta_{i}` . Select a time :math:`t^{*}` and a point :math:`x_{L}` to the left of the slowest wave so :math:`\mathbf{U}(x_{L},t^{*})=\mathbf{U}_{L}` see Fig.2.6. The solution at the starting point :math:`(x_{L},t^{*})` is obviously

.. math::
	\begin{align}
	\mathbf{U}_{L} = \sum_{i=1}^{2}\alpha_{i}\mathbf{K}_{i} = \alpha_{1}\mathbf{K}^{(1)} + \alpha_{2}\mathbf{K}^{(2)}
	\end{align}

i.e. all coefficients are :math:`\alpha` 's, that is, the point :math:`(x_{L},t^{*})` lies to the left of every wave. As we move to the right of :math:`(x_{L},t^{*})` on the horizontal line :math:`t=t^{*}` we cross the wave :math:`\frac{\mathrm{d}x}{\mathrm{d}t}=\lambda_{1}` , hence :math:`x - \lambda_{1}t` changes from negative to positive, see the expression of :math:`w_{i}(x,t)` , and therefore the coefficient :math:`\alpha_{1}` above changes to :math:`\beta_{1}` . Thus the solution in the entire Star Region, between the :math:`\lambda_{1}` and :math:`\lambda_{2}` waves, is

.. math::
	\begin{align}
	\mathbf{U}^{*}(x,t) = \beta_{1}\mathbf{K}^{(1)} + \alpha_{2}\mathbf{K}^{(2)}
	\end{align}

As we continue moving right and cross the :math:`\lambda_{2}` wave the value :math:`x-\lambda_{2}t` changes from negative to positive and hence the coefficient :math:`\alpha_{2}` changes to :math:`\beta_{2}` , i.e the solution to the right of the fastest wave of speed :math:`\lambda_{2}` is, trivially,

.. math::
	\begin{align}
	\mathbf{U}_{R} = \beta_{1}\mathbf{K}^{(1)} + \beta_{2}\mathbf{K}^{(2)}
	\end{align}


.. note:: 

	From equation :math:`\mathbf{U}_{L} = \sum_{i=1}^{m}\alpha_{i}\mathbf{K}^{(i)}, \mathbf{U}_{R} = \sum_{i=1}^{m}\beta_{i}\mathbf{K}^{(i)}` it is easy to see that the jump in :math:`\mathbf{U}` across the whole wave structure in the solution of the Riemann problem is

	.. math::
		\begin{align}
		\Delta \mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L} = (\beta_{1} - \alpha_{1})\mathbf{K}^{(1)} + \cdots + (\beta_{m} - \alpha_{m})\mathbf{K}^{(m)}
		\end{align}

	It is an eigenvector expansion with coefficient that are the strengths of the waves present in the Riemann problem. The wave strength of wave :math:`i` is :math:`\beta_{i}-\alpha_{i}` and the jump in :math:`\mathbf{U}` across wave :math:`i` , denoted by :math:`(\Delta \mathbf{U})_{i}` is

	.. math::
		\begin{align}
		(\Delta \mathbf{U})_{i} = (\beta_{i} - \alpha_{i})\mathbf{K}^{(i)}
		\end{align}

	When solving the Riemann problem, sometimes it is more useful to expand the total jump :math:`\Delta\mathbf{U} = \mathbf{U}_{R} - \mathbf{U}_{L}` in terms of the eigenvectors and unknown wave strengths :math:`\delta_{i}=\beta_{i}-\alpha_{i}` .


The Riemann Problem for Linearised Gas Dynamics
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

As an illustrative example we apply the methodology described in the previous section to solve the Riemann problem for the linearised equations of Gas Dynamics

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}
	\end{align}

with

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} \rho \\ u \end{bmatrix}
	,\quad
	\mathbf{A} = \begin{bmatrix} 0 & \rho_{0} \\ a^{2}/\rho_{0} & 0 \end{bmatrix}
	\end{align}

The eigenvalues of the system are

.. math::
	\begin{align}
	\lambda_{1} = -a
	,\quad
	\lambda_{2} = +a
	\end{align}

and the corresponding right eigenvectors are

.. math::
	\begin{align}
	\mathbf{K}^{(1)} = \begin{bmatrix} \rho_{0} \\ -a \end{bmatrix}
	,\quad
	\mathbf{K}^{(2)} = \begin{bmatrix} \rho_{0} \\ a \end{bmatrix}
	\end{align}

First we decompose the left data state :math:`\mathbf{U}_{L} = [\rho_{L}, u_{L}]^{T}` in terms of the right eigenvectors, namely

.. math::
	\begin{align}
	\mathbf{U}_{L} = \begin{bmatrix} \rho_{L} \\ u_{L} \end{bmatrix}
	= \alpha_{1} \begin{bmatrix} \rho_{0} \\ -a \end{bmatrix}
	+ \alpha_{2} \begin{bmatrix} \rho_{0} \\ a \end{bmatrix}
	\end{align}

Solving for the unknown coefficients :math:`\alpha_{1}` and :math:`\alpha_{2}` we obtain

.. math::
	\begin{align}
	\alpha_{1} = \frac{a\rho_{L} - \rho_{0}u_{L}}{2a\rho_{0}}
	,\quad
	\alpha_{2} = \frac{a\rho_{L} + \rho_{0}u_{L}}{2a\rho_{0}}
	\end{align}

Similarly, by expanding the right-hand data :math:`\mathbf{U}_{R} = [\rho_{R}, u_{R}]^{T}` in terms of the eigenvectors and solving for the coefficients :math:`\beta_{1}` and :math:`\beta_{2}` we obtain

.. math::
	\begin{align}
	\beta_{1} = \frac{a\rho_{R} - \rho_{0}u_{R}}{2a\rho_{0}}
	,\quad
	\beta_{2} = \frac{a\rho_{R} + \rho_{0}u_{R}}{2a\rho_{0}}
	\end{align}

Now by using equation :math:`\mathbf{U}^{*}(x,t) = \beta_{1}\mathbf{K}^{(1)} + \alpha_{2}\mathbf{K}^{(2)}`  we find the solution in the star region as

.. math::
	\begin{align}
	\mathbf{U}^{*} = \begin{bmatrix} \rho^{*} \\ u^{*} \end{bmatrix}
	= \beta_{1} \begin{bmatrix} \rho_{0} \\ -a \end{bmatrix}
	+ \alpha_{2} \begin{bmatrix} \rho_{0} \\ a \end{bmatrix}
	\end{align}

After some algebraic manipulations we obtain the solution explicitly as

.. math::
	\begin{align}
	& \rho_{*} = \frac{1}{2}(\rho_{L} + \rho_{R}) - \frac{1}{2}(u_{R} - u_{L})\rho_{0}/a \\
	& u_{*} = \frac{1}{2}(u_{L} + u_{R}) - \frac{1}{2}(\rho_{R} - \rho_{L})a/\rho_{0}
	\end{align}

Fig.2.7 illustrates the solution for :math:`\rho(x,t)` and :math:`u(x,t)` at time :math:`t=1` for the parameter values :math:`\rho_{0}=1,a=1` and initial data :math:`\rho_{L}=1, u_{L}=0, \rho_{R}=\frac{1}{2}` and :math:`u_{R}=0` . The two symmetric waves that emerge from the initial position of the discontinuity carry a discontinuous jump in both density :math:`\rho` and velocity :math:`u` .

.. note:: The exact solution can be very useful in testing numerical methods for systems with discontinuous solutions.


Some Useful Definitions
^^^^^^^^^^^^^^^^^^^^^^^^^^

Next we recall some standard definitions associated with hyperbolic systems.

Recall that for the linear advection equation the solution at a given point :math:`P=(x^{*},t^{*})` depends solely on the initial data at a single point :math:`x_{0}` on the x-axis. This point is obtained by tracing back the characteristic passing through the point :math:`P=(x^{*},t^{*})` . As a matter of fact, the solution at :math:`P=(x^{*},t^{*})` is identical to the value of the initial data :math:`u_{0}(x)` at the point :math:`x_{0}` . One says that the domain of dependence of the point :math:`P=(x^{*},t^{*})` is the point :math:`x_{0}` . For a :math:`2\times 2` system the domain of dependence is an interval :math:`[x_{L}, x_{R}]` on the x-axis that is subtended by the characteristics passing through the point :math:`P=(x^{*},t^{*})` .

Fig.2.8 illustrates the domain of dependence for a :math:`2\times 2` system with characteristic speeds :math:`\lambda_{1}` and :math:`\lambda_{2}` , with :math:`\lambda_{1} < \lambda_{2}` . In general, the characteristics of a hyperbolic system are curved. For a larger system the domain of dependence is determined by the slowest and fastest characteristics and is always a bounded interval, as the characteristic speeds for hyperbolic systems are always finite.




For a given domain of dependence :math:`[x_{L},x_{R}]` , the domain of determinacy is the set of points :math:`(x,t)` , within the domain of existence of the solution :math:`\mathbf{U}(x,t)` , in which :math:`\mathbf{U}(x,t)` is solely determined by initial data on :math:`[x_{L},x_{R}]` .

In Fig.2.8 we illustrate the domain of determinacy of an interval :math:`[x_{L},x_{R}]` for the case of a :math:`2\times 2` system with characteristic speeds :math:`\lambda_{1}` and :math:`\lambda_{2}` , with :math:`\lambda_{1} < \lambda_{2}` .



Another useful concept is that the range of influence of a point :math:`Q= (x_{0},t)` on the x-axis. It is defined as the set of points :math:`(x,t)` in the x-t plane in which the solution :math:`\mathbf{U}(x,t)` is influenced by initial data at the point :math:`Q=(x_{0},0)` .

Fig.2.9 illustrates the range of influence of a point :math:`Q=(x_{0},0)` for the case of a :math:`2\times 2` system with characteristic speeds :math:`\lambda_{1}` and :math:`\lambda_{2}` , with :math:`\lambda_{1}<\lambda_{2}` .



Conservation Laws
---------------------

We advanced the formal definition of a system of :math:`m` conservation laws

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
	\end{align}

where :math:`\mathbf{U}` is the vector of conserved variables and :math:`\mathbf{F}(\mathbf{U})` is the vector of fluxes. This system is hyperbolic if the Jacobian matrix

.. math::
	\begin{align}
	\mathbf{A}(\mathbf{U}) = \frac{\partial \mathbf{F}}{\partial \mathbf{U}}
	\end{align}

has real eigenvalues :math:`\lambda_{i}(\mathbf{U})` and a complete set of linearly independent eigenvectors :math:`\mathbf{K}^{(i)}(\mathbf{U})` , :math:`i=1,\cdots,m` , which we assume to be ordered as

.. math::
	\begin{align}
	& \lambda_{1}(\mathbf{U}) < \lambda_{2}(\mathbf{U}) < \cdots < \lambda_{m}(\mathbf{U}) \\
	& \mathbf{K}^{(1)}(\mathbf{U}), \mathbf{K}^{(2)}(\mathbf{U}), \cdots , \mathbf{K}^{(m)}(\mathbf{U})
	\end{align}

It is important to note that now eigenvalues and eigenvectors depend on :math:`\mathbf{U}` , although sometimes we shall omit the argument :math:`\mathbf{U}` .


Integral Forms of Conservation Laws
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Conservation laws may be expressed in differential and integral form. There are two good reasons for considering the integral form(s) of the conservation laws: (1) the derivation of the governing equations is based on physical conservation principles expressed as integral relations on control volumes, (2) the integral formulation requires less smoothness of the solution, which paves the way to extending the class of admissible solutions to include discontinuous solutions.

The integral form has variants that are worth studying in detail. Consider a one-dimensional time dependent system, such as the Euler equations. Choose a control volume :math:`V = [x_{L},x_{R}] \times [t_{1},t_{2}]` on the x-t plane as shown in Fig.2.10. The integral form of the equation for conservation of mass in one space dimension is

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}t}\int_{x_{L}}^{x_{R}}\rho(x,t)~\mathrm{d}x = f(x_{L},t) - f(x_{R},t)
	\end{align}

where :math:`f = \rho u` is the flux. For the complete system we have

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}t}\int_{x_{L}}^{x_{R}}\mathbf{U}(x,t)\mathrm{d}x = \mathbf{F}\big(\mathbf{U}(x_{L},t)\big) - \mathbf{F}\big(\mathbf{U}(x_{R},t)\big)
	\end{align}

where :math:`\mathbf{F}(\mathbf{U})` is the flux vector. This is one version of the integral form of the conservation laws: **Integral Form I** . The corresponding differential form reads as :math:`\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}` . Another version of the integral form of the conservation laws is obtained by integrating the above equation in time between :math:`t_{1}` and :math:`t_{2}` , with :math:`t_{1} \le t_{2}` . See Fig.2.10. Clearly

.. math::
	\begin{align}
	\int_{t_{1}}^{t_{2}}\Big[ \frac{\mathrm{d}}{\mathrm{d}t}\int_{x_{L}}^{x_{R}}\mathbf{U}(x,t)~\mathrm{d}x \Big]~\mathrm{d}t
	= \int_{x_{L}}^{x_{R}}\mathbf{U}(x,t_{2})~\mathrm{d}x
	- \int_{x_{L}}^{x_{R}}\mathbf{U}(x,t_{1})~\mathrm{d}x
	\end{align}

and thus the equation becomes

.. math::
	\begin{align}
	\int_{x_{L}}^{x_{R}}\mathbf{U}(x,t_{2})~\mathrm{d}x
	= \int_{x_{L}}^{x_{R}}\mathbf{U}(x,t_{1})~\mathrm{d}x
	+ \int_{t_{1}}^{t_{2}}\mathbf{F}\big( \mathbf{U}(x_{L},t) \big)~\mathrm{d}t
	- \int_{t_{1}}^{t_{2}}\mathbf{F}\big( \mathbf{U}(x_{R},t) \big)~\mathrm{d}t
	\end{align}

which we call: **Integral Form II** of the conservation laws.

Another version of the integral form of the conservation laws is obtained by integrating formal conservation laws in any domain :math:`V` in x-t space and using Green's theorem. The result is

.. math::
	\begin{align}
	\oint [\mathbf{U}\mathrm{d}x - \mathbf{F}(\mathbf{U})\mathrm{d}t] = \mathbf{0}
	\end{align}

where the line integration is performed along the boundary of the domain, in an anticlock-wise manner. We call this version **Integral Form III** of the conservation laws. Note that Integral Form II of the conservation laws is a special case of Integral Form III, in which the control volume :math:`V` is the rectangle :math:`[x_{L},x_{R}] \times [t_{1},t_{2}]` .

A fourth integral form results from adopting a more mathematical approach for extending the concept of solution of formal conservation laws to include discontinuities. A weak or generalized solution :math:`\mathbf{U}` is required to satisfy the integral relation

.. math::
	\begin{align}
	\int_{0}^{+\infty}\int_{-\infty}^{+\infty}[\phi_{t}\mathbf{U} + \phi_{x}\mathbf{F}(\mathbf{U})]\mathrm{d}x\mathrm{d}t
	= - \int_{-\infty}^{+\infty}\phi(x,0)\mathbf{U}(x,0)\mathrm{d}x
	\end{align}

for all test functions :math:`\phi(x,t)` that are continuously differentiable and have compact support. A function :math:`\phi(x,t)` has compact support if it vanishes outside some bounded set. Note that in the equation the derivatives of :math:`\mathbf{U}(x,t)` and :math:`\mathbf{F}(\mathbf{U})` have been passed on to the test function :math:`\phi(x,t)` , which is sufficiently smooth to admit these derivatives.

.. note:: The four integral forms corresponding to :math:`\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}` are valid for any system, not just for the Euler equations.


Examples of Conservation Laws
""""""""""""""""""""""""""""""""

Scalar conservation laws ( :math:`m=1` ) in differential form read

.. math::
	\begin{align}
	u_{t} + f(u)_{x} = 0
	\end{align}

To be able to solve for the conserved variable :math:`u(x,t)` the flux function :math:`f(u)` must be a completely determined algebraic function of :math:`u(x,t)` , and possibly some extra parameters of the problem. The linear advection equation is the simplest example, in which the flux function is :math:`f(u)=au` , a linear function of :math:`u` .

The inviscid Burgers's equation has flux :math:`f(u)=\frac{1}{2}u^{2}` , a quadratic function of :math:`u` . Another example a conservation law is the traffic flow equation

.. math::
	\begin{align}
	\rho_{t} + f(\rho)_{x} = 0
	,\quad
	f(\rho) = u_{m}\Big( 1 - \frac{\rho}{\rho_{m}} \Big)\rho
	\end{align}

Here the conserved variable :math:`\rho(x,t)` is a density function (density of motor vehicles), :math:`u_{m}` and :math:`\rho_{m}` are parameters of the problem, namely the maximum speed of vehicles and the maximum density, both positive constants. An example of practical interest in oil-reservoir simulation is the Buckley-Leverett equation

.. math::
	\begin{align}
	u_{t} + f(u)_{x} = 0
	,\quad
	f(u) = \frac{u^{2}}{u^{2} + b(1-u)^{2}}
	\end{align}

where :math:`b` is a parameter of the problem. 

Systems of conservation laws are constructed, as obvious examples, from linear systems

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}
	\end{align}

with constant coefficient matrix :math:`\mathbf{A}` . The required conservation-law form is obtained by defining the flux function as the product of the coefficient matrix :math:`\mathbf{A}` and the vector :math:`\mathbf{U}` , namely

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
	,\quad
	\mathbf{F}(\mathbf{U}) = \mathbf{A}\mathbf{U}
	\end{align}

Trivially, the Jacobian matrix is :math:`\mathbf{A}` .


The isothermal equations of Gas Dynamics are one example of a non-linear system of conservation laws. These are

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
	\end{align}

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} u_{1} \\ u_{2} \end{bmatrix} \equiv \begin{bmatrix} \rho \\ \rho u \end{bmatrix}
	,\quad
	\mathbf{F} = \begin{bmatrix} f_{1} \\ f_{2} \end{bmatrix} \equiv \begin{bmatrix} \rho u \\ \rho u^{2} + a^{2}\rho \end{bmatrix}
	\end{align}

where :math:`a` is positive, constant speed of sound. The Jacobian matrix is found by first expressing :math:`\mathbf{F}` in terms of the components :math:`u_{1} \equiv \rho` and :math:`u_{2} \equiv \rho u` of the vector :math:`\mathbf{U}` of conserved variables, namely

.. math::
	\begin{align}
	\mathbf{F}(\mathbf{U}) = \begin{bmatrix} f_{1} \\ f_{1} \end{bmatrix}
	\equiv \begin{bmatrix} u_{2} \\ u_{2}^{2}/u_{1} + a^{2}u_{1} \end{bmatrix}
	\end{align}

The Jacobian matrix is

.. math::
	\begin{align}
	\mathbf{A}(\mathbf{U}) = \frac{\partial \mathbf{F}}{\partial \mathbf{U}} = 
	\begin{bmatrix}
	0 & 1 \\
	-(u_{2}/u_{1})^{2}+a^{2} & 2u_{2}/u_{1}
	\end{bmatrix}
	=
	\begin{bmatrix}
	0 & 1 \\
	a^{2}-u^{2} & 2u
	\end{bmatrix}
	\end{align}

We can verify that the eigenvalues of :math:`\mathbf{A}` are

.. math::
	\begin{align}
	\lambda_{1} = u-a
	,\quad
	\lambda_{2} = u+a
	\end{align}

and that the right eigenvectors are

.. math::
	\begin{align}
	\mathbf{K}^{(1)} = \begin{bmatrix} 1 \\ u-a \end{bmatrix}
	,\quad
	\mathbf{K}^{(2)} = \begin{bmatrix} 1 \\ u+a \end{bmatrix}
	\end{align}

where the scaling factors for :math:`\mathbf{K}^{(1)}` and :math:`\mathbf{K}^{(2)}` have been taken to be unity. The isothermal equations of Gas Dynamics are thus hyperbolic.


Another non-linear example of a system of conservation laws are the isentropic equations of Gas Dynamics

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
	\end{align}

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} u_{1} \\ u_{2} \end{bmatrix}
	\equiv \begin{bmatrix} \rho \\ \rho u \end{bmatrix}
	,\quad
	\mathbf{F} = \begin{bmatrix} f_{1} \\ f_{2} \end{bmatrix}
	\equiv \begin{bmatrix} \rho u \\ \rho u^{2}+p \end{bmatrix}
	\end{align}

together with the closure condition, or equation of state (EOS)

.. math::
	\begin{align}
	p = C\rho^{\gamma} ,\quad C=\text{constant}
	\end{align}

We can find the eigenvalues are

.. math::
	\begin{align}
	\lambda_{1} = u-a
	,\quad
	\lambda_{2} = u+a
	\end{align}

and the right eigenvectors are

.. math::
	\begin{align}
	\mathbf{K}^{(1)} = \begin{bmatrix} 1 \\ u-a \end{bmatrix}
	,\quad
	\mathbf{K}^{(2)} = \begin{bmatrix} 1 \\ u+a \end{bmatrix}
	\end{align}

with the sound speed :math:`a` as claimed.


.. note:: 

	We can also show that for a generalized isentropic EOS, :math:`p=p(\rho)` , the system is hyperbolic if and only if :math:`p'(\rho) > 0` , that is, the pressure must be a monotone increasing function of :math:`\rho` . Also, the sound speed has the general form :math:`a = \sqrt{p'(\rho)}` .



Non-Linearities and Shock Formation
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Here we study some distinguishing features of non-linear hyperbolic conservation laws, such as wave steepening and shock formation. We restrict our attention to the initial-value problem for scalar non-linear conservation laws, namely

.. math::
	\begin{align}
	u_{t} + f(u)_{x} = 0
	,\quad
	u(x,0) = u_{0}(x)
	\end{align}

A corresponding integral form of the conservation law is

.. math::
	\begin{align}
	\frac{\mathrm{d}}{\mathrm{d}t} \int_{x_{L}}^{x_{R}}u(x,t)\mathrm{d}x
	= f\big( u(x_{L},t) \big) - f\big( u(x_{R},t) \big)
	\end{align}

The flux function :math:`f` is assumed to be a function of :math:`u` only, which under certain circumstances is an inadequate representation of the physical problem being modelled. Relevant physical phenomena of our interest are shock waves in compressible media. These have viscous appropriate flux function for a model conservation law would also include a dependence on :math:`u_{x}` , so that the modified conservation law would read

.. math::
	\begin{align}
	u_{t} + f(u)_{x} = \alpha u_{xx}
	\end{align}

with :math:`\alpha` a positive coefficient of viscosity. The conservation law :math:`u_{t} + f(u)_{x} = 0` may be rewritten as

.. math::
	\begin{align}
	u_{t} + \lambda(u)u_{x} = 0
	\end{align}

where

.. math::
	\begin{align}
	\lambda(u) = \frac{\mathrm{d}f}{\mathrm{d}u} = f'(u)
	\end{align}

is the characteristic speed. In the system case this corresponds to the eigenvalues of the Jacobian matrix. For the linear advection equation :math:`\lambda(u) = a` , constant. For the inviscid Burgers equation :math:`\lambda(u) = u` , that is, the characteristic speed depends on the solution and is in fact identical to the conserved variable. For the traffic flow equation :math:`\lambda(u) = u_{m}\Big( 1-\frac{2u}{\rho_{m}} \Big)` .

The behaviour of the flux function :math:`f(u)` has profound consequences on the behaviour of the solution :math:`u(x,t)` of the conservation law itself. A crucial property is **monotonicity** of the characteristic speed :math:`\lambda(u)` . There are essentially three possiblities:

- :math:`\lambda(u)` is a monotone increasing function of :math:`u` , i.e.
  
.. math::
	\begin{align}
	\frac{\mathrm{d}\lambda(u)}{\mathrm{d}u} = \lambda'(u) = f''(u) > 0 ~(\text{convex flux})
	\end{align}

- :math:`\lambda(u)` is a monotone decreasing function of :math:`u` , i.e.
  
.. math::
	\begin{align}
	\frac{\mathrm{d}\lambda(u)}{\mathrm{d}u} = \lambda'(u) = f''(u) < 0 ~(\text{concave flux})
	\end{align}

- :math:`\lambda(u)` has extrema, for some :math:`u` , i.e.
  
.. math::
	\begin{align}
	\frac{\mathrm{d}\lambda(u)}{\mathrm{d}u} = \lambda'(u) = f''(u) = 0 ~(\text{non-concave, non-concave flux})
	\end{align}

In the case of non-linear systems of conservation laws the character of the flux function is determined by the Equation of State. One speaks of convex, or otherwise, equations of state. For the inviscid Burgers equation :math:`\lambda'(u) = f''(u) = 1 > 0` , the flux is convex. For the traffic flow equation :math:`\lambda'(u) = f''(u) = -2u_{m}/\rho_{m} < 0` , the flux is concave.

.. note:: By analyzing the character of the flux function for the Buckley-Leverett equation, we can show that it is non-convex, non-concave.


We study the inviscid IVP and for the moment we assume that the initial data :math:`u(x,0)=u_{0}(x)` is smooth. For some finite time the solution :math:`u(x,t)` will remain smooth. We rewrite the IVP as

.. math::
	\begin{align}
	& u_{t} + \lambda(u)u_{x} = 0 ,\quad \lambda(u) = f'(u) \\
	& u(x,0) = u_{0}(x)
	\end{align}

Note that the PDE above is a non-linear extension of the linear advection equation in which the characteristic speed is :math:`\lambda(u) = a = \text{constant}` . We construct solutions to the IVP following characteristic curves, in much the same way as performed for the linear advection equation.


Construction of Solutions on Characteristics
""""""""""""""""""""""""""""""""""""""""""""""

Consider characteristic curves :math:`x=x(t)` satisfying the IVP

.. math::
	\begin{align}
	\frac{\mathrm{d}x}{\mathrm{d}t} = \lambda(u)
	,\quad
	x(0) = x_{0}
	\end{align}

Then, by regarding both :math:`u` and :math:`x` to be functions of :math:`t` we find the total derivative of :math:`u` along the curve :math:`x(t)` , namely'

.. math::
	\begin{align}
	\frac{\mathrm{d}u}{\mathrm{d}t} = u_{t} + \lambda(u)u_{x} = 0
	\end{align}

That is, :math:`u` is constant along the characteristic curve satisfying the IVP and therefore the slope :math:`\lambda(u)` is constant along the characteristic. Hence the characteristic curves are straight lines. The value of :math:`u` along each cureve is the value of :math:`u` at the initial point :math:`x(0)=x_{0}` and we write

.. math::
	\begin{align}
	u(x,t) = u_{0}(x_{0})
	\end{align}

Fig.2.11 shows a typical characteristic curve emanating from the initial point :math:`x_{0}` on the x-axis. The slope :math:`\lambda(u)` of the characteristic may then be evaluated at :math:`x_{0}` so that the solution characteristics curves of IVP are

.. math::
	\begin{align}
	x = x_{0} + \lambda\big(u_{0}(x_{0})\big)t
	\end{align}

Relations :math:`u(x,t) = u_{0}(x_{0})` and :math:`x = x_{0} + \lambda\big(u_{0}(x_{0})\big)t` may be regarded as the analytical solution of the IVP. Note that the point :math:`x_{0}` depends on the given point :math:`(x,t)` , see Fig.2.11, and thus :math:`x_{0}=x_{0}(x,t)` . The solution given by the relations above is implicit, which is more apparent if we substitute :math:`x_{0}` from :math:`x = x_{0} + \lambda\big(u_{0}(x_{0})\big)t` into :math:`u(x,t) = u_{0}(x_{0})` to obtain

.. math::
	\begin{align}
	u(x,t) = u_{0}\Big( x - \lambda\big( u_{0}(x_{0}) \big)t \Big)
	\end{align}

Next we verify that the relations actually define the solution. From :math:`u(x,t) = u_{0}(x_{0})` we obtain the :math:`t` and :math:`x` derivatives

.. math::
	\begin{align}
	u_{t} = u_{0}'(x_{0})\frac{\partial x_{0}}{\partial t}
	,\quad
	u_{x} = u_{0}'(x_{0})\frac{\partial x_{0}}{\partial x}
	\end{align}

From :math:`x = x_{0} + \lambda\big(u_{0}(x_{0})\big)t` the :math:`t` and :math:`x` derivatives are found to be

.. math::
	\begin{align}
	& \lambda(u_{0}(x_{0})) + [1 + \lambda'(u_{0}(x_{0})) u_{0}'(x_{0}) t] \frac{\partial x_{0}}{\partial t} = 0 \\
	& [1 + \lambda'(u_{0}(x_{0})) u_{0}'(x_{0}) t] \frac{\partial x_{0}}{\partial x} = 1
	\end{align}

therefore we obtain

.. math::
	\begin{align}
	\frac{\partial x_{0}}{\partial t} = - \frac{\lambda(u_{0}(x_{0}))}{1 + \lambda'(u_{0}(x_{0})) u_{0}'(x_{0}) t}
	\end{align}

and 

.. math::
	\begin{align}
	\frac{\partial x_{0}}{\partial x} = \frac{1}{1 + \lambda'(u_{0}(x_{0})) u_{0}'(x_{0}) t}
	\end{align}

Substitution of the above equations into :math:`u_{t} = u_{0}'(x_{0})\frac{\partial x_{0}}{\partial t}, u_{x} = u_{0}'(x_{0})\frac{\partial x_{0}}{\partial x}` verifies that :math:`u_{t}` and :math:`u_{x}` satisfy the PDE.




Wave Steepening
"""""""""""""""""""

Recall that in the case of the linear advection equation, in which the characteristic speed is :math:`\lambda(u) = a = \text{constant}` , the solution consists of the initial data :math:`u_{0}(x)` translated with speed :math:`a` without distortion. In the non-linear case the characteristic speed :math:`\lambda(u)` is a function of the solution itself. Distortions are therefore produced; this is a distinguishing feature of non-linear problems.

To explain the wave distortion phenomenon we consider initial data :math:`u_{0}(x)` as shown in Fig.2.12. A smooth initial profile is shown in Fig.2.12a along with five initial points :math:`x_{0}^{(i)}` and their corresponding initial data values :math:`u_{0}^{(i)} = u_{0}(x_{0}^{(i)})` . For the moment let us assume that the flux function :math:`f(u)` is convex, that is :math:`\lambda'(u) = f''(u) > 0` . In this case the characteristic speed is an increasing function of :math:`u` . Fig.2.12b shows the characteristics :math:`x^{(i)}(t)` emanating from the initial points :math:`x_{0}^{(i)}` and carrying the constant initial values :math:`u_{0}^{(i)}` along them. Given the assumed convex character of the flux, higher values of :math:`u_{0}(x)` will travel faster than lower values of :math:`u_{0}(x)` . 

There are two intervals on the x-axis where distortions are most evident. These are the intervals :math:`I_{E} = [x_{0}^{(1)}, x_{0}^{(3)}]` and :math:`I_{C} = [x_{0}^{(3)}, x_{0}^{(5)}]` . In :math:`I_{E}` the value :math:`u_{0}^{(3)}` will propagate faster than :math:`u_{0}^{(2)}` and this in turn will propagate faster than :math:`u_{0}^{(1)}` . The orientation of the respective characteristics in Fig.2.12b makes this situation clear. At a later time, the initial data in :math:`I_{E}` will have been transformed into a broader and flatter profile. We say that :math:`I_{E}` is an expansive region. In the expansive region the characteristic speed increases as :math:`x` increases, that is :math:`\lambda_{x} > 0` .

By contrast the interval :math:`I_{C}` is compressive and :math:`\lambda_{x} < 0` ; the value :math:`u_{0}^{(3)}` will propagate faster than :math:`u_{0}^{(4)}` and this in turn will propagate faster than :math:`u_{0}^{(5)}` , as shown by the orientation of the respective characteristics in Fig.2.12b. The compressive region will tend to get steeper and narrower as time evolves. The wave steepening mechanism will eventually produce folding over of the solution profile, with corresponding crossing of characteristics, and triple-valued solutions.

.. note:: 

	Note that the compressible and expansive character of the data just described reverses for the case of a concave flux, :math:`\lambda'(u) = f''(u) < 0` .

Before crossing of characteristics the single-valued solution may be found following characteristics, as described previously. When characteristics first intersect we say that the wave breaks; the derivative :math:`u_{x}` becomes infinite and this happens at a precise breaking time :math:`t_{b}` given by

.. math::
	\begin{align}
	t_{b} = \frac{-1}{\lambda_{x}(x_{0})}
	\end{align}

This is confirmed by equations :math:`\frac{\partial x_{0}}{\partial t} = - \frac{\lambda(u_{0}(x_{0}))}{1 + \lambda'(u_{0}(x_{0})) u_{0}'(x_{0}) t}` and :math:`\frac{\partial x_{0}}{\partial x} = \frac{1}{1 + \lambda'(u_{0}(x_{0})) u_{0}'(x_{0}) t}` . Breaking first occurs on the characteristic emanating from :math:`x=x_{0}` for which :math:`\lambda_{x}(x_{0})` is negative and :math:`|\lambda_{x}(x_{0})|` is a maximum.

This is an anomalous situation that may be rescued by goind back to the physical origins of the equations and questioning the adequacy of the model furnished by :math:`u_{t} + f(u)_{x} = 0` . The improved model equation :math:`u_{t} + f(u)_{x} = \alpha u_{xx}` says that the time rate of change of :math:`u` is not just due to the advection term :math:`f(u)_{x}` but is a competing balance between advection and the diffusion term :math:`\alpha u_{xx}` . As shown in Fig.2.12a in the interval :math:`[x_{0}^{(3)}, x_{0}^{(4)}]` the wave steepening effect of :math:`f(u)_{x}` is opposed by the wave-easing effect of :math:`\alpha u_{xx}` , which is negative there. In the interval :math:`[x_{0}^{(4)}, x_{0}^{(5)}]` the role of these contradictory effects is reversed. The more complete description of the physics does not allowing folding over of the solution. But rather than working with the more complete, and therefore more complex, viscous description of the problem, it is actually possible to insist on using the inviscid model by  allowing discontinuities to be formed as a process of increasing compression, namely shock waves.


Shock Waves
"""""""""""""""

Shock waves in air are small transition layers of very rapid changes of physical quantities such as pressre, density and temperature. The transition layer for a strong shock is of the same order of the magnitude as the mean-free path of the molecules, that is about :math:`10^{-7}~\mathrm{m}` . Therefore replacing these waves as mathematical discontinuities is a reasonable approximation. Very weak shock waves such as sonic booms, are an exception; the discontinuous approximation here can be very inaccurate indeed. 

We therefore insist on using the simplified model :math:`u_{t} + f(u)_{x} = 0` but in its integral form. Consider a solution :math:`u(x,t)` such that :math:`u(x,t), f(u)` and their derivatives are continuous everywhere except on a line :math:`s=s(t)` on the x-t plane across which :math:`u(x,t)` has a jump discontinuity. Select two fixed points :math:`x_{L}` and :math:`x_{R}` on the x-axis such that :math:`x_{L} < s(t) < x_{R}` . Enforcing the conservation law in integral form on the control volume :math:`[x_{L},x_{R}]` leads to

.. math::
	\begin{align}
	f(u(x_{L},t)) - f(u(x_{R},t))
	= \frac{\mathrm{d}}{\mathrm{d}t} \int_{x_{L}}^{s(t)}u(x,t)\mathrm{d}x
	+ \frac{\mathrm{d}}{\mathrm{d}t} \int_{s(t)}^{x_{R}}u(x,t)\mathrm{d}x
	\end{align}

.. math::
	\begin{align}
	f(u(x_{L},t)) - f(u(x_{R},t))
	= [u(s_{L},t) - u(s_{R},t)]S
	+ \int_{x_{L}}^{s(t)}u_{t}(x,t)\mathrm{d}x
	+ \int_{s(t)}^{x_{R}}u_{t}(x,t)\mathrm{d}x
	\end{align}

where :math:`u(s_{L},t)` is the limit of :math:`u(s(t),t)` as :math:`x` tends to :math:`s(t)` from the left, :math:`u(s_{R},t)` is the limit of :math:`u(s(t),t)` as :math:`x` tends to :math:`s(t)` from the right and :math:`S=\frac{\mathrm{d}s}{\mathrm{d}t}` is the speed of the discontinuity. As :math:`u_{t}(x,t)` is bounded the integrals vanish identically as :math:`s(t)` approached from the left and right and we obtain

.. math::
	\begin{align}
	f(u(x_{L},t)) - f(u(x_{R},t))
	= [u(s_{L},t) - u(s_{R},t)]S
	\end{align}

This algebraic expression relating the jumps :math:`\Delta f = f(u(x_{R},t)) - f(u(x_{L},t))` , :math:`\Delta u = u(x_{R},t) - u(x_{L},t)` and the speed :math:`S` of the discontinuity is called the Rankine-Hugoniot condition and is usually expressed as

.. math::
	\begin{align}
	\Delta f = S \Delta u
	\end{align}

For the scalar case considered here one can solve for the speed :math:`S` as

.. math::
	\begin{align}
	S = \frac{\Delta f}{\Delta u}
	\end{align}

Therefore, in order to admit discontinuous solutions we may formulate the problem in terms of PDEs, which are valid in smooth parts of the solution, and the Rankine-Hugoniot conditions across discontinuities.


Two Examples of Discontinuous Solutions
"""""""""""""""""""""""""""""""""""""""""

Consider the following initial-value problem for the inviscid Burgers equation

.. math::
	\begin{align}
	& u_{t} + f(u)_{x} = 0 ,\quad f(u) = \frac{1}{2}u^{2} \\
	& u(x,0) = u_{0}(x) = \left\{ \begin{array}{ll} 
	u_{L} \quad \text{if}~ x<0 \\
	u_{R} \quad \text{if}~ x>0
	\end{array}\right.
	\end{align}

First assume that :math:`u_{L} > u_{R}` . As the flux is convex :math:`\lambda'(u) = f''(u) > 0` the characteristic speeds on the left are greater than those on the right, that is :math:`\lambda_{L} \equiv \lambda(u_{L}) > \lambda_{R} \equiv \lambda(u_{R})` . Based on the discussion about Fig.2.12 the initail data in the IVP is the extreme case of compressive data. Crossing of characteristics takes place immediately, as illustrated in Fig.2.13b. The discontinuous solution of the IVP is

.. math::
	\begin{align}
	u(x,t) = \left\{ \begin{array}{ll}
	u_{L} \quad \text{if}~ x-St < 0 \\
	u_{R} \quad \text{if}~ x-St > 0
	\end{array} \right.
	\end{align}

where the speed of the discontinuity is found from :math:`S=\Delta f / \Delta u` as

.. math::
	\begin{align}
	S = \frac{1}{2}(u_{L} + u_{R})
	\end{align}

This dicontinuous solution is a shock wave and is compressive in nature as discussed previously and as observed in Fig.2.13a; it satisfies the following condition

.. math::
	\begin{align}
	\lambda(u_{L}) > S > \lambda(u_{R})
	\end{align}

which is called the entropy condition.

Now we assume that :math:`u_{L} < u_{R}` in the IVP. This data is the extreme case of expansive data, for convex :math:`f(u)` . A possible mathematical solution has identical form as solution given for the compressive data case. See Fig.2.14. However, this solution is physically incorrect. The discontinuity has not arisen as the result of compression, :math:`\lambda_{L}<\lambda_{R}` ; the characteristics diverge from teh discontinuity. This solution is called a rarefaction shock, or entropy-violating shock, and does not satisfy the entropy condition; it is therefore rejected as a physical solution. Compare Figs.2.13 and 2.14; in the compressive case characteristics run into the discontinuity. Given the expansive character of the data and based on the discussion on Fig.2.12, it would be more reasonable to expect the initial data to break up immediately and to broaden with time. This is actually gives another solution to be discussed next.



Rarefaction Waves
""""""""""""""""""""

Reconsider the IVP with general convex flux function :math:`f(u)` 

.. math::
	\begin{align}
	& u_{t} + f(u)_{x} = 0 \\
	& u(x,0) = u_{0}(x) = \left\{ \begin{array}{ll}
	u_{L} \quad \text{if}~ x<0 \\
	u_{R} \quad \text{if}~ x>0
	\end{array} \right.
	\end{align}

and expansive initial data, :math:`u_{L} < u_{R}` . As discussed previously, the entropy-violating solution to this problem is

.. math::
	\begin{align}
	& u(x,t) = \left\{ \begin{array}{ll} 
	u_{L} \quad \text{if}~ x-St<0 \\
	u_{R} \quad \text{if}~ x-St>0
	\end{array}\right. \\
	& S = \frac{\Delta f}{\Delta u}
	\end{align}

Amongst the various other reasons for rejecting this solution as a physical solution, instability stands out as prominent argument. By instability it is meant that small perturbations of the initial data lead to large changes in the solution. As a matter of fact, under small perturbations, the whole character of the solution changes completely, as we shall see.

Let us modify the initial data by replacing the discontinuous change from :math:`u_{L}` to :math:`u_{R}` by a linear variation of :math:`u_{0}(x)` between two fixed points :math:`x_{L} < 0` and :math:`x_{R} > 0` . Now the initial data reads

.. math::
	\begin{align}
	u_{0}(x) = \left\{ \begin{array}{l}
	u_{L} \quad \text{if}~ x \le x_{L} \\
	u_{L} + \frac{u_{R} - u_{L}}{x_{R} - x_{L}}(x - x_{L}) \quad \text{if}~x_{L}<x<x_{R} \\
	u_{R} \quad \text{if}~ x \ge x_{R}
	\end{array} \right.
	\end{align}

and is illustrated in Fig.2.15a. The corresponding picture of chracteristics emanating from the initial time :math:`t=0` is shown in Fig.2.15b. The solution :math:`u(x,t)` to this problem is found by following characteristics, as discussed previously, and consists of two constant states, :math:`u_{L}` and :math:`u_{R}` , separated by a region of smooth transition between the data values :math:`u_{L}` and :math:`u_{R}` . This is called a rarefaction wave. The right edge of the wave is given by the characteristic emanating from :math:`x_{R}`

.. math::
	\begin{align}
	x = x_{R} + \lambda(u_{R})t
	\end{align}

and is called the Head of the rarefaction. It carries the value :math:`u_{0}(x_{R}) = u_{R}` . The left edge of the wave is given by the characteristic emanating from :math:`x_{L}` 

.. math::
	\begin{align}
	x = x_{L} + \lambda(u_{L})t
	\end{align}

and is called the Tail of the rarefaction. It carries the value :math:`u_{0}(x_{L}) = u_{L}` .

As we assume convexity, :math:`\lambda'(u) = f''(u) > 0` , larger values of :math:`u_{0}(x)` propagate faster than lower values and thus the wave spreads and flattens as time evolves. The spreading of waves is typical non-linear phenomenon not seen in the study of linear hyperbolic systems with constant coefficients. The entire solution is

.. math::
	\begin{align}
	& u(x,t) = u_{L} \quad \text{if}~ \frac{x - x_{L}}{t} < \lambda_{L} \\
	& \lambda(u) = \frac{x - x_{L}}{t} \quad \text{if}~ \lambda_{L} < \frac{x - x_{L}}{t} < \lambda_{R} \\
	& u(x,t) = u_{R} \quad \text{if}~ \frac{x - x_{R}}{t} \ge \lambda_{R}
	\end{align}

No matter how small the size :math:`\Delta x = x_{R} - x_{L}` of the interval over which the discontinuous data in IVP has been spread over, the structure of the above rarefaction solution remains unaltered and is entirely different from the rarefaction shock solution, for which small changes to the data lead to large changes in the solution. Thus the rarefaction shock solutions is unstable. From the above construction the rarefaction solution is stable and as :math:`x_{L}` and :math:`x_{R}` approach zero from below and above respectively, the discontinuous data at :math:`x=0` in the IVP is reproduced. Therefore, the limiting case is to be interpreted as follows: :math:`u_{0}(x)` takes on all the values between :math:`u_{L}` and :math:`u_{R}` at :math:`x=0` and consequantly :math:`\lambda(u_{0}(x))` takes on all the values between :math:`\lambda_{L}` and :math:`\lambda_{R}` at :math:`x=0` . As higher values propagate faster than lower values the initial data disintegrates immediately giving rise to a rarefaction solution. This limiting rarefaction in which all characteristics of the wave emanate from a single point is called a centred rarefaction wave. The solution is

.. math::
	\begin{align}
	& u(x,t) = u_{L} \quad \text{if}~ \frac{x}{t} \ge \lambda_{L} \\
	& \lambda(u) = \frac{x}{t} \quad \text{if}~ \lambda_{L} < \frac{x}{t} < \lambda_{R} \\
	& u(x,t) = u_{R} \quad \text{if}~ \frac{x}{t} \ge \lambda_{R}
	\end{align}

and is illustrated in Fig.2.16.

Now we have at least two solutions to the IVP. Thus, having extended the concept of solution to include discontinuities, extra spurious solutions are now part of this extended class. The question is how to distinguish between a physically corect solution and a spurious solution. The anticipated answer is that a physical discontinuity, in addition to the Rankine-Hugoniot condition :math:`\Delta f = S\Delta u` , also satisfies the entropy condition :math:`\lambda(u_{L}) > S > \lambda(u_{R})` .



The Riemann Problem for the Inviscid Burgers Equation
"""""""""""""""""""""""""""""""""""""""""""""""""""""""

We finalise this section by giving the solution of the Riemann problem for the inviscid Burgers equation, namely

.. math::
	\begin{align}
	& u_{t} + \Big(\frac{u^{2}}{2}\Big)_{x} = 0 \\
	& u(x,0) = \left\{ \begin{array}{l}
	u_{L} ,\quad x<0 \\
	u_{R} ,\quad x>0
	\end{array}\right.
	\end{align}

From the previous discussion the exact solution is a single wave emanating from the origin as shown in Fig.2.17a. In view of the entropy condition this wave is either a shock wave, when :math:`u_{L} > u_{R}` , or a rarefaction wave, when :math:`u_{L} \le u_{R}` . The complete solution is

.. math::
	\begin{align}
	& u(x,t) = \left\{ \begin{array}{l}
	u_{L} \quad \text{if}~ x-St<0 \\
	u_{R} \quad \text{if}~ x-St>0
	\end{array} \right.
	\qquad S=\frac{1}{2}(u_{L}+u_{R}) \quad \text{if}~ u_{L}>u_{R} \\
	& u(x,t) = \left\{ \begin{array}{l}
	u_{L} \quad \text{if}~ \frac{x}{t}\le u_{L} \\
	\frac{x}{t} \quad \text{if}~ u_{L} < x/t < u_{R} \\
	u_{R} \quad \text{if}~ x/t \ge u_{R}
	\end{array} \right.
	\qquad \text{if}~ u_{L} \le u_{R}
	\end{align}

Fig.2.17 shows the solution of the Riemann problem for the inviscid Burgers equation. Fig.2.17a depicts the structure of the general solution and consists of a single wave, Fig.2.17b shows the case in which the solution is a shock wave and Fig.2.17c shows the case in which it is a rarefaction wave.

Some of the studied notions for scalar conservations laws extend quite directly to systems of hyperbolic conservations laws, as we see in the next section.


Characteristic Fields
^^^^^^^^^^^^^^^^^^^^^^^

Consider a hyperbolic system of conservation laws of the form :math:`\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}` with real eigenvalues :math:`\lambda_{i}(\mathbf{U})` and corresponding right eigenvectors :math:`\mathbf{K}^{(i)}(\mathbf{U})` . The characteristic speed :math:`\lambda_{i}(\mathbf{U})` defines a characteristic field, the :math:`\lambda_{i}` -field. Sometimes one also speaks of the :math:`\mathbf{K}^{(i)}` -field, that is the characteristic field defined by the eigenvector :math:`\mathbf{K}^{(i)}` .

A :math:`\lambda_{i}` -characteristic field is said to be linearly degenerate if

.. math::
	\begin{align}
	\nabla\lambda_{i}(\mathbf{U}) \cdot \mathbf{K}^{(i)}(\mathbf{U}) = 0
	,\quad \forall \mathbf{U} \in \mathbb{R}^{m} 
	\end{align}

where :math:`\mathbb{R}^{m}` is the set of real-valued vectors of :math:`m` components.


A :math:`\lambda_{i}` -characteristic field is said to be genuinely nonlinear if

.. math::
	\begin{align}
	\nabla\lambda_{i}(\mathbf{U}) \cdot \mathbf{K}^{(i)}(\mathbf{U}) \ne 0
	,\quad \forall \mathbf{U} \in \mathbb{R}^{m} 
	\end{align}

The symbol :math:`\cdots` denotes the dot product in phase space. :math:`\nabla\lambda_{i}(\mathbf{U})` is the gradient of the eigenvalue :math:`\lambda_{i}(\mathbf{U})` , namely

.. math::
	\begin{align}
	\nabla\lambda_{i}(\mathbf{U}) =  \Big( \frac{\partial}{\partial u_{1}}\lambda_{i}, \frac{\partial }{\partial u_{2}}\lambda_{i}, \cdots, \frac{\partial }{\partial u_{m}}\lambda_{i} \Big)^{T}
	\end{align}

The phase space is the space of vectors :math:`\mathbf{U}=(u_{1},\cdots,u_{m})` ; for a :math:`2 \times 2` system we speak of the phase plane :math:`u_{1}-u_{2}` . Note that for a linear system the eigenvalues :math:`\lambda_{i}` are constant and therefore :math:`\nabla\lambda_{i}(\mathbf{U})=\mathbf{0}` . Hence all characteristic fields of a linear hyperbolic system with constant coefficients are linearly degenerate.


We can show that both characteristic fields of the isothermal equations of Gas Dynamics are genuinely non-linear. First we write the eigenvalues in terms of the conserved variables, namely

.. math::
	\begin{align}
	\lambda_{1} = \frac{u_{2}}{u_{1}} - a
	,\quad
	\lambda_{2} = \frac{u_{2}}{u_{1}} + a
	\end{align}

.. math::
	\begin{align}
	\nabla\lambda_{1}(\mathbf{U}) = \Big( -\frac{u}{\rho}, \frac{1}{\rho} \Big)^{T}
	,\quad
	\nabla\lambda_{2}(\mathbf{U}) = \Big( -\frac{u}{\rho}, \frac{1}{\rho} \Big)^{T}
	\end{align}

Therefore

.. math::
	\begin{align}
	& \nabla\lambda_{1}(\mathbf{U}) \cdot \mathbf{K}^{(1)}(\mathbf{U}) = -\frac{a}{\rho} \ne 0 \\
	& \nabla\lambda_{2}(\mathbf{U}) \cdot \mathbf{K}^{(2)}(\mathbf{U}) = \frac{a}{\rho} \ne 0
	\end{align}

and thus both characteristic fields are genuinely non-linear, as claimed.



In the study of detonation waves in high energy solids it is found useful to devise mathematical objects that preserve some of the basic physical features of detonation phenomena but are simpler to analyse than more comprehensive models. Fickett proposed a system that is essentially the inviscid Burgers equation plus a reaction model. He called the system detonation analogue. Clarke and colleagues pointed out that this analogue is also exceedingly useful for numerical purposes. Writing the system in conservation-law form one has the inhomogeneous system with a source term, namely

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{S}(\mathbf{U})
	\end{align}

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} u_{1} \\ u_{2} \end{bmatrix}
	\equiv \begin{bmatrix} \rho \\ \alpha \end{bmatrix}
	,\quad
	\mathbf{F} = \begin{bmatrix} \frac{1}{2}(\rho^{2} + \alpha Q) \\ 0 \end{bmatrix}
	,\quad
	\mathbf{S} = \begin{bmatrix} 0 \\ 2\sqrt{1-\alpha} \end{bmatrix}
	\end{align}

The parameter :math:`Q` plays the role of heats of reaction and :math:`\alpha` is a reaction progress variable. The mathematical charactor of the system is determined solely by the homogeneous part, :math:`\mathbf{S}=\mathbf{0}` . The Jacobian matrix is

.. math::
	\begin{align}
	\mathbf{A}(\mathbf{U}) = \frac{\partial \mathbf{F}}{\partial \mathbf{U}} = 
	\begin{bmatrix}
	u_{1} & \frac{1}{2}Q \\
	0 & 0
	\end{bmatrix}
	=
	\begin{bmatrix}
	\rho & \frac{1}{2}Q \\
	0 & 0
	\end{bmatrix}
	\end{align}

Simple calculations show that the eigenvalues are

.. math::
	\begin{align}
	\lambda_{1}=0 ,\quad \lambda_{2} = \rho
	\end{align}

and the right eigenvectors are

.. math::
	\begin{align}
	\mathbf{K}^{(1)} = \begin{bmatrix} 1 \\ -2\rho/Q \end{bmatrix}
	,\quad
	\mathbf{K}^{(2)} = \begin{bmatrix} 1 \\ 0 \end{bmatrix}
	\end{align}

The detonation analogue is therefore hyperbolic. And we can check that the :math:`\lambda_{1}` -field is linearly degenerate and that the :math:`\lambda_{2}` -field is genuinely non-linear.



Rankine-Hugoniot Conditions
""""""""""""""""""""""""""""""

Given a system of hyperbolic conservation laws

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0}
	\end{align}

and a discontinuous wave solution of speed :math:`S_{i}` associated with the :math:`\lambda_{i}` -characteristic field, the Rankine-Hugoniot conditions state

.. math::
	\begin{align}
	\Delta \mathbf{F} = S_{i}\Delta \mathbf{U}
	\end{align}

with

.. math::
	\begin{align}
	\Delta\mathbf{U} \equiv \mathbf{U}_{R}-\mathbf{U}_{L}
	,\quad
	\Delta\mathbf{F} \equiv \mathbf{F}_{R}-\mathbf{F}_{L}
	,\quad
	\mathbf{F}_{L} = \mathbf{F}(\mathbf{U}_{L})
	,\quad
	\mathbf{F}_{R} = \mathbf{F}(\mathbf{U}_{R})
	\end{align}

where :math:`\mathbf{U}_{L}` and :math:`\mathbf{U}_{R}` are the respective states immediately to the left and right of the discontinuity. Fig.2.18 illustrates the Rankine-Hugoniot condtions. Note that unlike the scalar case, it is generally not possible to solve for the speed :math:`S_{i}` . For a linear system with constant coefficients

.. math::
	\begin{align}
	\mathbf{U}_{t} + \mathbf{A}\mathbf{U}_{x} = \mathbf{0}
	\end{align}

with eigenvalues :math:`\lambda_{i}` for :math:`i=1,\cdots,m` , the Rankine-Hugoniot conditions across the wave of speed :math:`S_{i} \equiv \lambda_{i}` read

.. math::
	\begin{align}
	\Delta\mathbf{F} = \mathbf{A}\Delta\mathbf{U} = \lambda_{i}(\Delta\mathbf{U})_{i}
	\end{align}

Actually, these conditions provide a technique for finding the solution of the Riemann problem for linear hyperbolic system with constant coefficients.

Now we solve the Riemann problem for the linearised equations of Gas Dynamics using the Rankine-Hugoniot condtions across each wave. The structure of the solution is depicted in Fig.2.5. The unknowns are :math:`\rho_{*}` and :math:`u_{*}` in the Star Region. Recall that the vector :math:`\mathbf{U}` and the coefficient matrix :math:`\mathbf{A}` are given by

.. math::
	\begin{align}
	\mathbf{U} = \begin{bmatrix} u_{1} \\ u_{2} \end{bmatrix}
	= \begin{bmatrix} \rho \\ u \end{bmatrix}
	,\quad
	\mathbf{A} = 
	\begin{bmatrix}
	0 & \rho_{0} \\
	a^{2}/\rho_{0} & 0
	\end{bmatrix}
	\end{align}

and the eigenvalues are

.. math::
	\begin{align}
	\lambda_{1} = -a ,\quad \lambda_{2} = +a
	\end{align}

Application of the Rankine-Hugoniot condtions across the :math:`\lambda_{1}` -wave of speed :math:`S_{1}=\lambda_{1}` gives

.. math::
	\begin{align}
	\begin{bmatrix}
	0 & \rho_{0} \\
	\frac{a^{2}}{\rho_{0}} & 0
	\end{bmatrix}
	\begin{bmatrix}
	\rho_{*} - \rho_{L} \\
	u_{*} - u_{L}
	\end{bmatrix}
	= -a
	\begin{bmatrix}
	\rho_{*} - \rho_{L} \\
	u_{*} - u_{L}
	\end{bmatrix}
	\end{align}

Expanding and solving for :math:`u_{*}` gives

.. math::
	\begin{align}
	u_{*} = u_{L} - (\rho_{*} - \rho_{L})\frac{a}{\rho_{0}}
	\end{align}

For the :math:`\lambda_{2}` -wave of speed :math:`S_{2}=\lambda_{2}` we obtain

.. math::
	\begin{align}
	u_{*} = u_{R} + (\rho_{*} - \rho_{R})\frac{a}{\rho_{0}}
	\end{align} 

The simultaneous solution of these two linear algebraic equations for the unknowns :math:`\rho_{*}` and :math:`u_{*}` is

.. math::
	\begin{align}
	& \rho_{*} = \frac{1}{2}(\rho_{L} + \rho_{R}) - \frac{1}{2}(u_{R} - u_{L})\rho_{0}/a \\
	& u_{*} = \frac{1}{2}(u_{L} + u_{R}) - \frac{1}{2}(\rho_{R} - \rho_{L})a/\rho_{0}
	\end{align}

which is the solution we obtained using a different technique based on eigenvector expansion of the initial data. The technique that makes use of the Rankine-Hugoniot conditions is more direct.


Generalised Riemann Invariants
"""""""""""""""""""""""""""""""""

For a general quasi-linear hyperbolic system

.. math::
	\begin{align}
	\mathbf{W}_{t} + \mathbf{A}(\mathbf{W})\mathbf{W}_{x} = \mathbf{0}
	\end{align}

with

.. math::
	\begin{align}
	\mathbf{W} = [w_{1}, w_{2}, \cdots , w_{m}]^{T}
	\end{align}

we consider the wave associated with the :math:`i` -characteristic field with eigenvalue :math:`\lambda_{i}` and corresponding right eigenvector

.. math::
	\begin{align}
	\mathbf{K}^{(i)} = \Big[ k_{1}^{(i)}, k_{2}^{(i)}, \cdots, k_{m}^{(i)} \Big]^{T}
	\end{align}

The vector of dependent variables :math:`\mathbf{W}` here is some suitable set, which may be the set conserved variables, for instance. Recall that any system of conservation laws may always be expressed in quasi-linear form via the jacobian matrix.

The Generalised Riemann Invariants are relations that hold true, for certain waves, across the wave structure and lead the following :math:`(m-1)` ordinary differential equations

.. math::
	\begin{align}
	\frac{\mathrm{d}\omega_{1}}{k_{1}^{(i)}}
	= \frac{\mathrm{d}\omega_{2}}{k_{2}^{(i)}}
	= \frac{\mathrm{d}\omega_{3}}{k_{3}^{(i)}}
	= \cdots
	= \frac{\mathrm{d}\omega_{m}}{k_{m}^{(i)}}
	\end{align}

They relate ratios of changes :math:`\mathrm{d}w_{s}` of a quantity :math:`w_{s}` to the respective component :math:`k_{s}^{(i)}` of the right eigenvector :math:`\mathbf{K}^{(i)}` corresponding to a :math:`\lambda_{i}` -wave family.


Here we find the Generalised Riemann Invariants for the linearised equations of Gas Dynamics. The dependent variables are

.. math::
	\begin{align}
	\mathbf{W} = \begin{bmatrix} w_{1} \\ w_{2} \end{bmatrix}
	\equiv \begin{bmatrix} \rho \\ u \end{bmatrix}
	\end{align}

and the right eigenvectors are

.. math::
	\begin{align}
	\mathbf{K}^{(1)} = \begin{bmatrix} \rho_{0} \\ -a \end{bmatrix}
	,\quad
	\mathbf{K}^{(2)} = \begin{bmatrix} \rho_{0} \\ a \end{bmatrix}
	\end{align}

Across the :math:`\lambda_{1}` -wave we have

.. math::
	\begin{align}
	\frac{\mathrm{d}\rho}{\rho_{0}} = \frac{\mathrm{d}u}{-a}
	\end{align}

which leads to

.. math::
	\begin{align}
	\mathrm{d}u + \frac{a}{\rho_{0}}\mathrm{d}\rho = 0
	\end{align}

After integration this produces

.. math::
	\begin{align}
	I_{L}(\rho,u) = u + \frac{a}{\rho_{0}}\rho = \text{constant}
	\end{align}

The constant of integration is obtained by evaluating :math:`I_{L}(\rho, u)` at a reference state. Across the :math:`\lambda_{2}` -wave we have

.. math::
	\begin{align}
	\frac{\mathrm{d}\rho}{\rho_{0}} = \frac{\mathrm{d}u}{a}
	\end{align}

which leads to

.. math::
	\begin{align}
	I_{R}(\rho, u) = u - \frac{-a}{\rho_{0}}\rho = \text{constant}
	\end{align}

Again the constant of integration is obtained by evaluating :math:`I_{R}(\rho, u)` at a reference state.

Now we solve the Riemann problem for the linearised equations of Gas Dynamics using the Generalised Riemann Invariants. Application of :math:`I_{L}(\rho, u)` across the left wave connecting the states :math:`\mathbf{W}_{L}` and :math:`\mathbf{W}_{*}` gives

.. math::
	\begin{align}
	u_{*} + \frac{a}{\rho_{0}}\rho_{*} = u_{L} + \frac{a}{\rho_{0}}\rho_{L}
	\end{align}

Similarly, application of :math:`I_{R}(\rho, u)` across the right wave connecting the states :math:`\mathbf{W}_{R}` and :math:`\mathbf{W}_{*}` gives

.. math::
	\begin{align}
	u_{*} - \frac{a}{\rho_{0}}\rho_{*} = u_{R} - \frac{a}{\rho_{0}}\rho_{R}
	\end{align}

and the simultaneous solution for the unknowns :math:`\rho_{*}` and :math:`u_{*}` gives

.. math::
	\begin{align}
	& \rho_{*} = \frac{1}{2}(\rho_{L} + \rho_{R}) - \frac{1}{2}(u_{R}-u_{L})\rho_{0}/a \\
	& u_{*} = \frac{1}{2}(u_{L} + u_{R}) - \frac{1}{2}(\rho_{R} - \rho_{L})a/\rho_{0}
	\end{align}

which is the same solution obtained from applying other techniques.



Now solve the Riemann problem for the Small Perturbation Equations using the following techniques:

1. by expanding the initial data :math:`\mathbf{U}_{L}` and :math:`\mathbf{U}_{R}` in terms of the eigenvectors.
2. by expanding the total jump :math:`\Delta\mathbf{U}` in terms of the eigenvectors.
3. by using the Rankine-Hugoniot Conditions across each wave.
4. by applying the Generalised Riemann Invariants.
   
Use of any of the above techniques will give the general solution

.. math::
	\begin{align}
	& u_{*} = \frac{1}{2}(u_{L} + u_{R}) + \frac{1}{2}a(u_{R} - u_{L}) \\
	& v_{*} = \frac{1}{2}(v_{L} + v_{R}) + \frac{1}{2a}(u_{R} - u_{L})
	\end{align}


For Isentropic Gas Dynamics Revisited, the eigenvalues are :math:`\lambda_{1} = u - a` and :math:`\lambda_{2} = u + a` , with :math:`a = \sqrt{p'(\rho)} = \sqrt{\frac{\gamma p}{\rho}}` defining the sound speed. The corresponding right eigenvectors are given by

.. math::
	\begin{align}
	\mathbf{K}^{(1)} = \begin{bmatrix} 1 \\ u-a \end{bmatrix}
	,\quad
	\mathbf{K}^{(2)} = \begin{bmatrix} 1 \\ u+a \end{bmatrix}
	\end{align}

Across the left :math:`\lambda_{1} = u - a` wave we have

.. math::
	\begin{align}
	\frac{\mathrm{d}\rho}{1} = \frac{\mathrm{d}(\rho u)}{u - a}
	\end{align}

which after expanding differentials yields

.. math::
	\begin{align}
	\mathrm{d}u + \frac{a}{\rho}\mathrm{d}\rho = 0
	\end{align}

On exact integration we obtain

.. math::
	\begin{align}
	& I_{L}(\rho, \rho u) = u + \int\frac{a}{\rho}\mathrm{d}\rho = \text{constant} \\
	& I_{R}(\rho, \rho u) = u - \int \frac{a}{\rho}\mathrm{d}\rho = \text{constant}
	\end{align}

As as the sound speed :math:`a` is a function of :math:`\rho` alone we can evaluate the integral term above exactly as

.. math::
	\begin{align}
	\int \frac{a}{\rho}\mathrm{d}\rho = \frac{2a}{\gamma - 1}
	\end{align}

by first noting that

.. math::
	\begin{align}
	a = \sqrt{p'(\rho)} = \sqrt{C\gamma \rho^{\gamma-1}} = \sqrt{C\gamma}\rho^{\frac{\gamma-1}{2}}
	\end{align}

Then the left and right Riemann Invariants become

.. math::
	\begin{align}
	& I_{L}(\rho, \rho u) = u + \frac{2a}{\gamma - 1} = \text{constant across the}~\lambda_{1}\text{-wave} \\
	& I_{L}(\rho, \rho u) = u - \frac{2a}{\gamma - 1} = \text{constant across the}~\lambda_{2}\text{-wave}
	\end{align}

Generalised Riemann Invariants provide a powerful tool of analysis of hyperbolic conservation laws.





Elementary-Wave Solutions of the Riemann Problem
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The Riemann problem for a general :math:`m \times m` non-linear hyperbolic system with data :math:`\mathbf{U}_{L}, \mathbf{U}_{R}` is the IVP

.. math::
	\begin{align}
	& \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{0} \\
	& \mathbf{U}(x,0) = \mathbf{U}^{(0)}(x) = \left\{ \begin{array}{ll}
	\mathbf{U}_{L} \quad \text{if}~ x<0 \\
	\mathbf{U}_{R} \quad \text{if}~ x>0
	\end{array} \right.
	\end{align}

The similarity solution :math:`\mathbf{U}(x/t)` consists of :math:`m+1` constant states separated by :math:`m` waves, as depicted by the x-t picture of Fig.2.19. For each eigenvalue :math:`\lambda_{i}` there is a wave family. For linear systems with constant coefficients each wave is discontinuity of speed :math:`S_{i} = \lambda_{i}` and defines a linearly degenerate field.

For non–linear systems the waves may be discontinuities such as shock waves and contact waves, or smooth transition waves such as rarefactions. The possible types of waves present in the solution of the Riemann problem depends crucially on closure conditions. For the Euler equations we shall only consider Equations of State such that the only waves present are shocks, contacts and rarefactions. Suppose that the initial data states :math:`\mathbf{U}_{L}, \mathbf{U}_{R}` are connected by a single wave, that is, the solution of the Riemann problem consists of a single non-trivial wave; all other waves have zero strength. This assumption is entirely justified as we can always solve the Riemann problem with general data and then select the constant states on either side of a particular wave as the initial data for the Riemann problem. If the wave is a discontinuity then the wave is a shock wave or a contact wave.

Shock Wave
"""""""""""""

For a shock wave the two constant states :math:`\mathbf{U}_{L}` and :math:`\mathbf{U}_{R}` are connected through a single jump discontinuity in a genuinely non–linear field :math:`i` and the following conditions apply

- the Rankine-Hugoniot conditions
  
.. math::
	\begin{align}
	\mathbf{F}(\mathbf{U}_{R}) - \mathbf{F}(\mathbf{U}_{L}) = S_{i}(\mathbf{U}_{R} - \mathbf{U}_{L})
	\end{align}

- the entropy condition
  
.. math::
	\begin{align}
	\lambda_{i}(\mathbf{U}_{L}) > S_{i} > \lambda_{i}(\mathbf{U}_{R})
	\end{align}

Fig.2.20a depicts a shock wave of speed :math:`S_{i}` . The characteristic :math:`\mathrm{d}x/\mathrm{d}t = \lambda_{i}` on both sides of the wave run into the shock wave, which illustrates the compressive character of a shock.

Contact Wave
""""""""""""""

For a contact wave the two data states :math:`\mathbf{U}_{L}` and :math:`\mathbf{U}_{R}` are connected through a single jump discontinuity of speed :math:`S_{i}` in a linearly degenerate field :math:`i` and the following conditions apply

- the Rankine-Hugoniot conditions
  
.. math::
	\begin{align}
	\mathbf{F}(\mathbf{U}_{R}) - \mathbf{F}(\mathbf{U}_{L}) = S_{i}(\mathbf{U}_{R} - \mathbf{U}_{L})
	\end{align}

- constancy of the Generalised Riemann Invariants across the wave
  
.. math::
	\begin{align}
	\frac{\mathrm{d}w_{1}}{k_{1}^{(i)}}
	= \frac{\mathrm{d}w_{2}}{k_{2}^{(i)}}
	= \frac{\mathrm{d}w_{3}}{k_{3}^{(i)}}
	= \cdots
	= \frac{\mathrm{d}w_{m}}{k_{m}^{(i)}}
	\end{align}

- the parallel characteristic condition
  
.. math::
	\begin{align}
	\lambda_{i}(\mathbf{U}_{L}) = \lambda_{i}(\mathbf{U}_{R}) = S_{i}
	\end{align}

Fig.2.20b depicts a contact discontinuity. Characteristics on both sides of the wave run parallel to it.


Rarefaction Wave
"""""""""""""""""""

For a rarafaction wave the two data states :math:`\mathbf{U}_{L}` and :math:`\mathbf{U}_{R}` are connected through a smooth transition in a genuinely non-linear field :math:`i` and the following conditions are met

- constancy of the Generalised Riemann Invariants across the wave
  
.. math::
	\begin{align}
	\frac{\mathrm{d}w_{1}}{k_{1}^{(i)}}
	= \frac{\mathrm{d}w_{2}}{k_{2}^{(i)}}
	= \frac{\mathrm{d}w_{3}}{k_{3}^{(i)}}
	= \cdots
	= \frac{\mathrm{d}w_{m}}{k_{m}^{(i)}}
	\end{align}

- divergence of characteristics
  
.. math::
	\begin{align}
	\lambda_{i}(\mathbf{U}_{L}) < \lambda_{i}(\mathbf{U}_{R})
	\end{align}

Fig.2.20c depicts a rarefaction wave. Characteristics on the left and right of the wave diverge as do characteristics inside the wave.

.. note:: 

	The solution of the general Riemann problem contains :math:`m` waves of any of the above type, namely: shock waves, contact discontinuities and rarefaction waves. In solving the general Rieamnn problem we shall enforce these conditions by discriminating the particular type of wave present.



Some Properties of the Euler Equations
=========================================

the Euler equations result from neglecting the eﬀects of viscosity, heat conduction and body forces on a compressible medium. Here we show that these equations are a system of hyperbolic conservations laws and study some of their mathematical properties. We analyse the eigenstructure of the equations, that is, we find eigenvalues and eigenvectors; we study properties of the characteristic fields and establish basic relations across rarefactions, contacts and shock waves.

The One-Dimensional Euler Equations
--------------------------------------

Here we study the one–dimensional time–dependent Euler equations with an ideal Equation of State, using conservative and non–conservative formulations. The basic structure of the solution of the Riemann problem is outlined along with a detailed study of the elementary waves present in the solution.


Conservative Formulation
^^^^^^^^^^^^^^^^^^^^^^^^^^^





































