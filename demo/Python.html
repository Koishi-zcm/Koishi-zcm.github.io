<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python &mdash; MyKnowledge MyKnowledge 文档</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="prev" title="Latex" href="Latex.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MyKnowledge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="%E7%94%B5%E8%B7%AF%E5%8E%9F%E7%90%86.html">电路原理</a></li>
<li class="toctree-l1"><a class="reference internal" href="%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF.html">数字电路</a></li>
<li class="toctree-l1"><a class="reference internal" href="AutoCAD.html">AutoCAD</a></li>
<li class="toctree-l1"><a class="reference internal" href="Latex.html">Latex</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basemap">Basemap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">地图投影类型与经纬度范围</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">绘制地图经纬度刻度线</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">绘制地图元素</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">在地图上绘制额外数据内容</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">在地图上绘制散点</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fitz">fitz</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pdf">图片转PDF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#matplotlib">matplotlib</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">显示方式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">图片大小</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">文字显示</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">线条样式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">坐标轴与轴标签</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">图形标签</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id16">折线图(曲线图)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">多列柱状图</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">三维绘图</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#numpy">numpy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id19">基本数学运算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">数据类型转换</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">生成序列</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interp">interp线性插值</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">计算标准差</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pandas">pandas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id23">文件的读取与保存</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">表格的行列显示</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">表格的合并</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">剔除表格重复行</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">按列对数据进行函数处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id30">筛选符合条件的数据</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#re">re</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id31">正则表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id33">re模块匹配分析</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#requests">requests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id34">获取网址响应</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">爬虫案例</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id36">使用re模块进行数据提取的案例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#scipy">scipy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id37">数值导数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id38">数值积分</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id39">一重积分</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id40">二重积分</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id41">多重积分</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id42">寻找函数极小值</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id43">最小二乘法拟合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id44">非线性方程组求解</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id45">微分方程的数值解</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sphinx">Sphinx</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id46">快速新建项目</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id48">修改网页主题</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id49">加宽网页宽度</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sympy">sympy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id50">变量赋值与精度转换</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id51">函数表达式化简</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#simplify">simplify函数化简</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id52">多项式展开</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id53">多项式因式分解</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id54">合并同类项</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id55">有理分式化简</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id56">分式展开</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id57">符号函数求导</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id58">符号函数积分</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id59">符号函数极限</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id60">符号函数的级数展开</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id61">求解符号方程组</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id62">求解微分符号方程</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id63">矩阵运算</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id64">构建矩阵</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id65">求矩阵的幂与求逆</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id66">求矩阵的行列式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id67">求矩阵的特征值和特征多项式</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#laplace">Laplace变换</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MyKnowledge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Python</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/demo/Python.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python">
<h1>Python<a class="headerlink" href="#python" title="此标题的永久链接"></a></h1>
<section id="basemap">
<h2>Basemap<a class="headerlink" href="#basemap" title="此标题的永久链接"></a></h2>
<p>该模块的导入方式一般为 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">mpl_toolkits.basemap</span> <span class="pre">import</span> <span class="pre">Basemap</span></code> 。</p>
<section id="id1">
<h3>地图投影类型与经纬度范围<a class="headerlink" href="#id1" title="此标题的永久链接"></a></h3>
<p>创建一个地图的方式如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span>
    <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;merc&#39;</span><span class="p">,</span>
    <span class="n">llcrnrlon</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>  <span class="c1"># 最左侧经度</span>
    <span class="n">llcrnrlat</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># 最下方纬度</span>
    <span class="n">urcrnrlon</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span>  <span class="c1"># 最右侧经度</span>
    <span class="n">urcrnrlat</span><span class="o">=</span><span class="mi">55</span>  <span class="c1"># 最上方纬度</span>
<span class="p">)</span>
</pre></div>
</div>
<p>其中 <code class="code docutils literal notranslate"><span class="pre">projection</span></code> 参数设置的是投影方式，可以选择的投影方式有 <code class="code docutils literal notranslate"><span class="pre">'cea'</span></code> 圆柱等面积投影、 <code class="code docutils literal notranslate"><span class="pre">mbtfpq</span></code> 麦克布赖德-托马斯平极四次投影、 <code class="code docutils literal notranslate"><span class="pre">aeqd</span></code> 等距方位离投影、 <code class="code docutils literal notranslate"><span class="pre">sinu</span></code> 正弦曲线投影、 <code class="code docutils literal notranslate"><span class="pre">poly</span></code> 多圆锥投影、 <code class="code docutils literal notranslate"><span class="pre">moll</span></code> 默尔威得投影、 <code class="code docutils literal notranslate"><span class="pre">merc</span></code> 墨卡托投影……</p>
<p>另外四个参数是用来设置显示经纬度范围的，四个参数的含义为</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">llcrnrlon</span></code> ：longitude of lower left hand corner，地图左下角的经度界限，也即最左侧经度。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">llcrnrlat</span></code> ：latitude of lower left hand corner，地图左下角的纬度界限，也即最下方纬度。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">urcrnrlon</span></code> ：longitude of upper right hand corner，地图右上角的经度界限，也即最右侧经度。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">urcrnrlat</span></code> ：latitude of upper right hand corner，地图右上角的纬度界限，也即最上方纬度。</p></li>
</ul>
<p>上面四个参数是通过框定界线来确定地图范围的。如果需要将某个地区放置到地图中心，可以改用下面四个参数来确定地图范围：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">width</span></code> ：在投影坐标下的地图宽度，单位为米。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">height</span></code> ：在投影坐标下的地图高度，单位为米。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">lon_0</span></code> ：地图中心位置的经度。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">lat_0</span></code> ：地图中心位置的纬度。</p></li>
</ul>
<p>更多详细信息可以参看 <a class="reference external" href="https://matplotlib.org/basemap/api/basemap_api.html#module-mpl_toolkits.basemap">官方文档</a></p>
</section>
<section id="id3">
<h3>绘制地图经纬度刻度线<a class="headerlink" href="#id3" title="此标题的永久链接"></a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">drawparallels()</span></code> 函数来绘制地图维度刻度线，其基本调用方式为：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drawparallels</span><span class="p">(</span><span class="n">circles</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">textcolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">labelstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">xoffset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">text_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>其中各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">circles</span></code> ：刻度序列，最方便的方式是使用 <code class="code docutils literal notranslate"><span class="pre">np.linspace()</span></code> 来传入，例如 <code class="code docutils literal notranslate"><span class="pre">np.linspace(-90,</span> <span class="pre">90,</span> <span class="pre">7)</span></code> 。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">color</span></code> ：刻度线的颜色，默认是黑色，另外常用的颜色是 <code class="code docutils literal notranslate"><span class="pre">grey</span></code> 。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">labels</span></code> ：显示刻度线的方位，四个数代表bool值，分别对应「left」、「right」、「top」、「bottom」。</p></li>
</ul>
<p>一个完整的使用示例为 <code class="code docutils literal notranslate"><span class="pre">map.drawparallels(circles=np.linspace(-90,</span> <span class="pre">90,</span> <span class="pre">7),</span> <span class="pre">labels=[1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">color='grey')</span></code> 。</p>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">drawmeridians()</span></code> 函数来绘制地图经度刻度线，其基本调用方式为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">textcolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">labelstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">xoffset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">text_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>其中各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">meridians</span></code> ：刻度序列，最方便的方式是使用 <code class="code docutils literal notranslate"><span class="pre">np.linspace()</span></code> 来传入，例如 <code class="code docutils literal notranslate"><span class="pre">np.linspace(-180,</span> <span class="pre">180,</span> <span class="pre">13)</span></code> 。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">color</span></code> ：刻度线的颜色，默认是黑色，另外常用的颜色是 <code class="code docutils literal notranslate"><span class="pre">grey</span></code> 。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">labels</span></code> ：显示刻度线的方位，四个数代表bool值，分别对应「left」、「right」、「top」、「bottom」。</p></li>
</ul>
<p>一个完整的使用示例为 <code class="code docutils literal notranslate"><span class="pre">map.drawmeridians(meridians=np.linspace(-180,</span> <span class="pre">180,</span> <span class="pre">13),</span> <span class="pre">labels=[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">1],</span> <span class="pre">color='grey')</span></code> 。</p>
</section>
<section id="id4">
<h3>绘制地图元素<a class="headerlink" href="#id4" title="此标题的永久链接"></a></h3>
<p>下面是一些常见的绘图元素：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">()</span>  <span class="c1"># 绘制大陆海岸线</span>
<span class="nb">map</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">()</span>  <span class="c1"># 绘制国界线</span>
<span class="nb">map</span><span class="o">.</span><span class="n">drawcounties</span><span class="p">()</span>  <span class="c1"># 绘制州界线</span>
<span class="nb">map</span><span class="o">.</span><span class="n">drawrivers</span><span class="p">()</span>  <span class="c1"># 绘制河流线</span>
</pre></div>
</div>
<p>上述的函数都可以添加 <code class="code docutils literal notranslate"><span class="pre">color</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">linewidth</span></code> 参数来进行调整。</p>
</section>
<section id="id5">
<h3>在地图上绘制额外数据内容<a class="headerlink" href="#id5" title="此标题的永久链接"></a></h3>
<p>可以参考 <a class="reference external" href="https://zhuanlan.zhihu.com/p/158921398">basemap之地图上画额外数据</a></p>
<section id="id7">
<h4>在地图上绘制散点<a class="headerlink" href="#id7" title="此标题的永久链接"></a></h4>
<p>下面的示例实现了在指定经纬度上绘制不同大小的圆点标记。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lon</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;高等院校总数&#39;</span><span class="p">]</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="nb">map</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="fitz">
<h2>fitz<a class="headerlink" href="#fitz" title="此标题的永久链接"></a></h2>
<section id="pdf">
<h3>图片转PDF<a class="headerlink" href="#pdf" title="此标题的永久链接"></a></h3>
<p>下面的代码能够实现将目标文件夹内的同类型图片按顺序合并为一个PDF文件。需要导入 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">fitz</span></code> ， <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">os</span></code> ， <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">re</span></code> 。该函数代码需要传入图片所在目录、图片类型、合并PDF的名称。下面是一个示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">img_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\25281\Desktop\工作文件\学校相关资料\课程相关\大二上\电路原理\作业\第6周&#39;</span>
<span class="n">imgType</span> <span class="o">=</span> <span class="s1">&#39;.jpg&#39;</span>
<span class="n">combined_pdf_name</span> <span class="o">=</span> <span class="s1">&#39;06电路原理.pdf&#39;</span>
</pre></div>
</div>
<p>具体实现的函数代码如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">img_to_pdf</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">imgType</span><span class="p">,</span> <span class="n">combined_pdf_name</span><span class="p">):</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># 打开一个用于存放pdf信息的空doc</span>

    <span class="k">for</span> <span class="n">fileName_in_img_path</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">img_path</span><span class="p">):</span>  <span class="c1"># 从目录中依次获取每一个文件名</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;imgName&gt;.*?)</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">imgType</span><span class="p">),</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># 正则表达式寻找.png后缀的文件</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">fileName_in_img_path</span><span class="p">)</span>  <span class="c1"># 将目录名放入匹配器，并将匹配结果的迭代器存储到result变量中</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>  <span class="c1"># 从迭代器里面获取img文件名进行操作</span>
            <span class="n">imgName</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;imgName&#39;</span><span class="p">)</span>  <span class="c1"># 获取png文件名</span>
            <span class="n">img_file</span> <span class="o">=</span> <span class="n">img_path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">imgName</span> <span class="o">+</span> <span class="n">imgType</span>  <span class="c1"># 获取完整的img文件路径</span>
            <span class="n">imgdoc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img_file</span><span class="p">)</span>  <span class="c1"># 打开img文件获取图片数据</span>
            <span class="n">pdfbytes</span> <span class="o">=</span> <span class="n">imgdoc</span><span class="o">.</span><span class="n">convert_to_pdf</span><span class="p">()</span>  <span class="c1"># 将图片数据转换为pdf格式数据</span>
            <span class="n">subPDF_name</span> <span class="o">=</span> <span class="n">imgName</span> <span class="o">+</span> <span class="s1">&#39;.pdf&#39;</span>  <span class="c1"># 获取子pdf文件名，以原img文件名字命名</span>
            <span class="n">imgpdf</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">subPDF_name</span><span class="p">,</span> <span class="n">pdfbytes</span><span class="p">)</span>  <span class="c1"># 将子pdf文件名与pdf格式数据打开为pdf文件</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">imgpdf</span><span class="p">)</span>  <span class="c1"># 将上述pdf文件插入到doc当中</span>

    <span class="n">doc_position</span> <span class="o">=</span> <span class="n">img_path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">combined_pdf_name</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">doc_position</span><span class="p">)</span>  <span class="c1"># 将doc保存到目标路径</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>
</div>
</section>
</section>
<section id="matplotlib">
<h2>matplotlib<a class="headerlink" href="#matplotlib" title="此标题的永久链接"></a></h2>
<p>最常用的模块是matplotlib.pyplot，一般的导入方式都是 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></code> 。</p>
<section id="id8">
<h3>显示方式<a class="headerlink" href="#id8" title="此标题的永久链接"></a></h3>
<section id="id9">
<h4>图片大小<a class="headerlink" href="#id9" title="此标题的永久链接"></a></h4>
<p>通过 <code class="code docutils literal notranslate"><span class="pre">plt.figure(figsize=(10,</span> <span class="pre">10))</span></code> 的方式来控制图片大小，其含义为“设置的画布大小为10英寸×10英寸”。可以在保存图片的时候设置dpi，例如 <code class="code docutils literal notranslate"><span class="pre">plt.savefig('test.jpg',</span> <span class="pre">dpi=100)</span></code> 表示保存图片为100像素/英寸，那么实际保存的图片大小就是1000像素×1000像素。</p>
<p>只是像上面那样设定的话，输出的图片会有明显的边缘留白。如果需要完全去除周边空白，可以通过设置 <code class="code docutils literal notranslate"><span class="pre">bbox_inches</span></code> 参数来实现，例如 <code class="code docutils literal notranslate"><span class="pre">plt.savefig('test.jpg',</span> <span class="pre">bbox_inches='tight')</span></code> 。当设置为 <code class="code docutils literal notranslate"><span class="pre">bbox_inches='tight'</span></code> 时，可以进一步设置 <code class="code docutils literal notranslate"><span class="pre">pad_inches</span></code> 的值来自定义边框宽度（默认是0.1英寸），例如 <code class="code docutils literal notranslate"><span class="pre">plt.savefig('test.jpg',</span> <span class="pre">bbox_inches='tight',</span> <span class="pre">pad_inches=1)</span></code> 。</p>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>但是需要注意，通过 <code class="code docutils literal notranslate"><span class="pre">bbox_inches='tight'</span></code> 设置得到的图片会让之前的图片大小设置失效。</p>
</div>
<p>如果完全不想留白，并且想保留对输出图片大小的设置，那么可以改用</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;test.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id10">
<h4>文字显示<a class="headerlink" href="#id10" title="此标题的永久链接"></a></h4>
<p>要想让matplotlib.pyplot生成的图表支持中文，需要加入以下代码：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SimHei&#39;</span><span class="p">]</span>  <span class="c1"># 中文</span>
</pre></div>
</div>
<p>要想让matplotlib生成的图表正常显示负号，需要加入以下代码：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># 显示负号</span>
</pre></div>
</div>
</section>
<section id="id11">
<h4>线条样式<a class="headerlink" href="#id11" title="此标题的永久链接"></a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">plt.plot()</span></code> 函数包含下面的可调控参数：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">linestyle</span></code> ：指定折线的类型，默认是实线。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">linewidth</span></code> ：指定折线的宽度。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">marker</span></code> ：可以为折线图添加点，该参数设置点的形状。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">markersize</span></code> ：设置点的大小。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">markeredgecolor</span></code> ：设置点的边框色。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">markerfacecolor</span></code> ：设置点的填充色。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">markeredgewidth</span></code> ：设置点的边框宽度。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">label</span></code> ：添加折线图的标签，类似于图例的作用。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">color</span></code> ：线条的颜色。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">alpha</span></code> ：设置图形的透明度。</p></li>
</ul>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">plt.style.available</span></code> 输出matplotlib.pyplot提供的所有风格名称，共计26种。要使用某种预设的样式时，只需要像如下方式调用即可：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>如果需要调整 <strong>线条的颜色</strong> ，可以修改 <code class="code docutils literal notranslate"><span class="pre">plt.plot()</span></code> 函数的 <code class="code docutils literal notranslate"><span class="pre">color</span></code> 参数。有下面几种方式来进行赋值：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> <span class="c1"># 标准颜色名称</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span> <span class="c1"># 缩写颜色代码（rgbcmyk）</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span> <span class="c1"># 范围在0~1的灰度值</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FFDD44&#39;</span><span class="p">)</span> <span class="c1"># 十六进制（RRGGBB，00~FF）</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">))</span> <span class="c1"># RGB元组，范围在0~1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;chartreuse&#39;</span><span class="p">);</span> <span class="c1"># HTML颜色名称</span>
</pre></div>
</div>
<p>也有一些常用颜色的缩写可以直接赋值使用：</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 27%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>字符</p></th>
<th class="head"><p>颜色</p></th>
<th class="head"><p>英文全称</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘b’</p></td>
<td><p>蓝色</p></td>
<td><p>blue</p></td>
</tr>
<tr class="row-odd"><td><p>‘g’</p></td>
<td><p>绿色</p></td>
<td><p>green</p></td>
</tr>
<tr class="row-even"><td><p>‘r’</p></td>
<td><p>红色</p></td>
<td><p>red</p></td>
</tr>
<tr class="row-odd"><td><p>‘c’</p></td>
<td><p>青色</p></td>
<td><p>cyan</p></td>
</tr>
<tr class="row-even"><td><p>‘m’</p></td>
<td><p>品红</p></td>
<td><p>magenta</p></td>
</tr>
<tr class="row-odd"><td><p>‘y’</p></td>
<td><p>黄色</p></td>
<td><p>yellow</p></td>
</tr>
<tr class="row-even"><td><p>‘k’</p></td>
<td><p>黑色</p></td>
<td><p>black</p></td>
</tr>
<tr class="row-odd"><td><p>‘w’</p></td>
<td><p>白色</p></td>
<td><p>white</p></td>
</tr>
</tbody>
</table>
<p>如果需要调整 <strong>线条样式</strong> ，可以修改 <code class="code docutils literal notranslate"><span class="pre">linestyle</span></code> 参数。下面是一些常见的线条样式。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 43%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>字符</p></th>
<th class="head"><p>类型</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘-’</p></td>
<td><p>实线</p></td>
</tr>
<tr class="row-odd"><td><p>‘–’</p></td>
<td><p>虚线</p></td>
</tr>
<tr class="row-even"><td><p>‘-.’</p></td>
<td><p>点划线</p></td>
</tr>
<tr class="row-odd"><td><p>‘:’</p></td>
<td><p>点线</p></td>
</tr>
</tbody>
</table>
<p>如果需要标出数据点， <strong>数据点的形状</strong> 可以通过 <code class="code docutils literal notranslate"><span class="pre">marker</span></code> 参数来设置，一些常见的数据点形状如下</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>字符</p></th>
<th class="head"><p>类型</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘.’</p></td>
<td><p>点</p></td>
</tr>
<tr class="row-odd"><td><p>‘o’</p></td>
<td><p>圆圈</p></td>
</tr>
<tr class="row-even"><td><p>‘*’</p></td>
<td><p>星形</p></td>
</tr>
<tr class="row-odd"><td><p>‘x’</p></td>
<td><p>十字架</p></td>
</tr>
<tr class="row-even"><td><p>‘s’</p></td>
<td><p>正方形</p></td>
</tr>
<tr class="row-odd"><td><p>‘p’</p></td>
<td><p>五角星</p></td>
</tr>
<tr class="row-even"><td><p>‘D/d’</p></td>
<td><p>钻石/小钻石</p></td>
</tr>
<tr class="row-odd"><td><p>‘h’</p></td>
<td><p>六角形</p></td>
</tr>
<tr class="row-even"><td><p>‘+’</p></td>
<td><p>加号</p></td>
</tr>
<tr class="row-odd"><td><p>‘</p></td>
<td><p>‘   竖直线</p></td>
</tr>
<tr class="row-even"><td><p>‘v^&lt;&gt;’</p></td>
<td><p>下三角、上三角、左三角、右三角</p></td>
</tr>
<tr class="row-odd"><td><p>‘1234’</p></td>
<td><p>Tripod向下、向上、向左、向右</p></td>
</tr>
</tbody>
</table>
<p>如果需要修改 <strong>线条宽度</strong> ，可以使用 <code class="code docutils literal notranslate"><span class="pre">linewidth</span></code> 参数来修改线条的粗细。默认情况下， <code class="code docutils literal notranslate"><span class="pre">linewidth</span></code> 设置为1个单位。利用线条的粗细可以在视觉上强调某条特定的曲线。</p>
</section>
<section id="id12">
<h4>坐标轴与轴标签<a class="headerlink" href="#id12" title="此标题的永久链接"></a></h4>
<section id="id13">
<h5>刻度范围设置<a class="headerlink" href="#id13" title="此标题的永久链接"></a></h5>
<p>如果希望自定义 <strong>坐标轴上下限</strong> ，最基础的方法是 <code class="code docutils literal notranslate"><span class="pre">plt.xlim()</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">plt.ylim()</span></code> ，例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<p>如果你想要让 <strong>坐标轴逆序显示</strong> ，那么也可以逆序设置坐标轴刻度值，例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">)</span>
</pre></div>
</div>
<p>还有一个方法是 <code class="code docutils literal notranslate"><span class="pre">plt.axis()</span></code> 。通过传入 <code class="code docutils literal notranslate"><span class="pre">[xmin,</span> <span class="pre">xmax,</span> <span class="pre">ymin,</span> <span class="pre">ymax]</span></code> 对应的值，可以只用一行代码就设置好x和y的限值：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
</pre></div>
</div>
<p>还可以用 <code class="code docutils literal notranslate"><span class="pre">plt.axis('tight')</span></code> 按照图形的内容 <strong>自动收紧坐标轴</strong> ，不留空白区域；使用 <code class="code docutils literal notranslate"><span class="pre">plt.axis('equal')</span></code> 让屏幕上显示的图形分辨率为1:1， <strong>x轴单位长度与y轴单位长度相等</strong> 。</p>
</section>
<section id="id14">
<h5>刻度显示设置<a class="headerlink" href="#id14" title="此标题的永久链接"></a></h5>
<p>如果希望将原本的浮点数显示转变为 <strong>百分数显示</strong> 在坐标轴刻度，可以使用FuncFormatter函数。需要导入 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">matplotlib.ticker</span> <span class="pre">import</span> <span class="pre">FuncFormatter</span></code> 。首先自定义转换浮点数为百分数刻度显示的函数：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_percent</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    用来将坐标轴的浮点数转换为百分比显示</span>
<span class="sd">    :param temp: 坐标轴数据，一般由plt.gca().yaxis.set_major_formatter自动提供</span>
<span class="sd">    :param position: 显示位置，一般由plt.gca().yaxis.set_major_formatter自动提供</span>
<span class="sd">    :return: 百分比显示的str文字</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%1.0f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">temp</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span>
</pre></div>
</div>
<p>之后只需要在绘图代码中利用 <code class="code docutils literal notranslate"><span class="pre">plt.gca()</span></code> 修改对应坐标轴的显示格式即可。例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">to_percent</span><span class="p">))</span>  <span class="c1"># 将y轴原本的浮点数转换为百分比显示</span>
</pre></div>
</div>
<p>如果希望 <strong>x轴的刻度改为使用中文名词</strong> 来显示，可以使用 <code class="code docutils literal notranslate"><span class="pre">plt.xticks()</span></code> 函数来实现。首先需要有原本的数字刻度 <code class="code docutils literal notranslate"><span class="pre">x</span></code> ，以及将进行对应替换的名词列表 <code class="code docutils literal notranslate"><span class="pre">ticks_x</span></code> ，然后通过下面的方式进行调用：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ticks_x</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<p>其中 <code class="code docutils literal notranslate"><span class="pre">rotation</span></code> 参数设置的是文字的旋转程度。</p>
</section>
</section>
<section id="id15">
<h4>图形标签<a class="headerlink" href="#id15" title="此标题的永久链接"></a></h4>
<p>图形标题与坐标轴标题是最简单的标签，快速设置方法如下所示</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;A Sine Curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;sin(x)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>在单个坐标轴上显示多条线时，创建图例显示每条线是很有效的方法。Matplotlib 内置了 <code class="code docutils literal notranslate"><span class="pre">plt.legend()</span></code> 用来创建图例，例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;-g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;:b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="id16">
<h3>折线图(曲线图)<a class="headerlink" href="#id16" title="此标题的永久链接"></a></h3>
<p>下面是进行折线图（曲线图）绘制的基本模板，根据需要修改 <code class="code docutils literal notranslate"><span class="pre">x</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">y</span></code> 、图片大小、绘图风格、线条样式、标签、绘图范围、像素大小与图片名称。</p>
<p>首先需要先写入下面的代码以使得中文和负号正常显示：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SimHei&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_line_chart</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;line label&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x label&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y label&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;test.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
</section>
<section id="id17">
<h3>多列柱状图<a class="headerlink" href="#id17" title="此标题的永久链接"></a></h3>
<p>下面给出一个通用的创建多列柱状图的函数代码。它要求分别传入x轴标签、柱状形标签和二维数据数组。这些内容都通过列表来记录，如果不希望产生柱状形标签，那么就传入一个空列表。例如下面是一个5组4列柱状图的数据集</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;G1&#39;</span><span class="p">,</span> <span class="s1">&#39;G2&#39;</span><span class="p">,</span> <span class="s1">&#39;G3&#39;</span><span class="p">,</span> <span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="s1">&#39;G5&#39;</span><span class="p">]</span>
<span class="n">bar_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]</span>
<span class="n">data1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">27</span><span class="p">]</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
<span class="n">data3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="n">data4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">26</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">,</span> <span class="n">data4</span><span class="p">]</span>
</pre></div>
</div>
<p>具体的绘图函数代码如下（已经导入 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code> ）。可以根据需要调整每组柱子之间的空隙、y轴标签、生成图片的文件名。如果希望生成图表标题，可以加入 <code class="code docutils literal notranslate"><span class="pre">plt.title('my</span> <span class="pre">title')</span></code> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_multi_bars</span><span class="p">(</span><span class="n">xlabels</span><span class="p">,</span> <span class="n">bar_labels</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">tick_step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">group_gap</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">bar_gap</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    xlabels : x轴坐标标签序列</span>
<span class="sd">    bar_labels : 一组中各柱子的图例</span>
<span class="sd">    dataset ：数据集，二维列表，要求列表每个元素的长度必须与labels的长度一致</span>
<span class="sd">    tick_step ：默认x轴刻度步长为1，通过tick_step可调整x轴刻度步长。</span>
<span class="sd">    group_gap : 柱子组与组之间的间隙，最好为正值，否则组与组之间重叠</span>
<span class="sd">    bar_gap ：每组柱子之间的空隙，默认为0，每组柱子紧挨，正值每组柱子之间有间隙，负值每组柱子之间重叠</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xlabels</span><span class="p">))</span> <span class="o">*</span> <span class="n">tick_step</span>  <span class="c1"># ticks为x轴刻度</span>
    <span class="n">group_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>  <span class="c1"># group_num为数据的组数，即每组柱子的柱子个数</span>
    <span class="n">group_width</span> <span class="o">=</span> <span class="n">tick_step</span> <span class="o">-</span> <span class="n">group_gap</span>  <span class="c1"># group_width为每组柱子的总宽度，group_gap 为柱子组与组之间的间隙。</span>
    <span class="n">bar_span</span> <span class="o">=</span> <span class="n">group_width</span> <span class="o">/</span> <span class="n">group_num</span>  <span class="c1"># bar_span为每组柱子之间在x轴上的距离，即柱子宽度和间隙的总和</span>
    <span class="n">bar_width</span> <span class="o">=</span> <span class="n">bar_span</span> <span class="o">-</span> <span class="n">bar_gap</span>  <span class="c1"># bar_width为每个柱子的实际宽度</span>

    <span class="c1"># baseline_x为每组柱子第一个柱子的基准x轴位置，随后的柱子依次递增bar_span即可</span>
    <span class="n">baseline_x</span> <span class="o">=</span> <span class="n">ticks</span> <span class="o">-</span> <span class="p">(</span><span class="n">group_width</span> <span class="o">-</span> <span class="n">bar_span</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">baseline_x</span> <span class="o">+</span> <span class="n">index</span> <span class="o">*</span> <span class="n">bar_span</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bar_labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>  <span class="c1"># 设置各柱形图例</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Scores&#39;</span><span class="p">)</span>  <span class="c1"># 设置y轴标签</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">)</span>  <span class="c1"># x轴刻度标签位置与x轴刻度一致</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;test.png&#39;</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
</section>
<section id="id18">
<h3>三维绘图<a class="headerlink" href="#id18" title="此标题的永久链接"></a></h3>
<p>可以通过 <code class="code docutils literal notranslate"><span class="pre">plt.axes()</span></code> 函数的关键字 <code class="code docutils literal notranslate"><span class="pre">projection='3d'</span></code> 来实现三维坐标轴。例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">ax</span> <span class="pre">=</span> <span class="pre">fig.add_subplot(111,</span> <span class="pre">projection='3d')</span></code> 的形式可以画多个子图。</p>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">ax.view_init()</span></code> 函数来修改三维视图的摄像机视角，需要设置 <code class="code docutils literal notranslate"><span class="pre">elev</span></code> 参数和 <code class="code docutils literal notranslate"><span class="pre">azim</span></code> 参数，其中elev沿着y轴旋转，azim沿着z轴旋转。当 <code class="code docutils literal notranslate"><span class="pre">elev=0,</span> <span class="pre">azim=0</span></code> 时，视角是沿x轴向y-z平面正视着看去；当 <code class="code docutils literal notranslate"><span class="pre">elev=45,</span> <span class="pre">azim=45</span></code> 时，视角是经典的正轴测视角。</p>
<p>在上面的坐标轴基础上，下面的案例演示了如何绘制 <strong>三维曲线</strong> 和 <strong>散点图</strong> ：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<span class="n">zd</span> <span class="o">=</span> <span class="mi">13</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">xd</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">zd</span><span class="p">)</span>
<span class="n">yd</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">zd</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">xd</span><span class="p">,</span> <span class="n">yd</span><span class="p">,</span> <span class="n">zd</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>  <span class="c1"># 绘制散点图</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>    <span class="c1"># 绘制空间曲线</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;test.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>在上面坐标轴的基础上，下面的案例演示了如何绘制 <strong>三维曲面</strong> ：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>  <span class="c1"># 形成网格二维数组</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">)</span>  <span class="c1"># 也可以调整alpha参数改变曲面透明度</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;test.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">ax.contour()</span></code> 函数来绘制 <strong>等高线</strong> ，要设置 <code class="code docutils literal notranslate"><span class="pre">offset</span></code> 参数，为所需投影位置在投影轴的坐标。同时可以修改 <code class="code docutils literal notranslate"><span class="pre">zdir</span></code> 参数来生成不同方向的等高线投影。例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">)</span>  <span class="c1">#生成z方向投影，投到x-y平面</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">)</span>  <span class="c1">#生成x方向投影，投到y-z平面</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">)</span>   <span class="c1">#生成y方向投影，投到x-z平面</span>
</pre></div>
</div>
<p>如果使用 <code class="code docutils literal notranslate"><span class="pre">ax.contourf()</span></code> 函数，则得到的是“contour with fill”，即有填充颜色的等高线，例如 <code class="code docutils literal notranslate"><span class="pre">ax.contourf(X,</span> <span class="pre">Y,</span> <span class="pre">Z,</span> <span class="pre">zdir='y',</span> <span class="pre">offset=6,</span> <span class="pre">cmap=&quot;rainbow&quot;)</span></code> 。</p>
<p>如果加入渲染时的步长，会得到更加清晰细腻的图像，例如 <code class="code docutils literal notranslate"><span class="pre">ax.plot_surface(X,</span> <span class="pre">Y,</span> <span class="pre">Z,</span> <span class="pre">rstride</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">cstride</span> <span class="pre">=</span> <span class="pre">1,cmap='rainbow')</span></code> ，其中的 <code class="code docutils literal notranslate"><span class="pre">rstride</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">cstride</span></code> 分别表示横竖方向的绘图采样步长，其参数越小绘图越精细。</p>
</section>
</section>
<section id="numpy">
<h2>numpy<a class="headerlink" href="#numpy" title="此标题的永久链接"></a></h2>
<p>numpy模块一般的导入方式都是 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code> 。</p>
<section id="id19">
<h3>基本数学运算<a class="headerlink" href="#id19" title="此标题的永久链接"></a></h3>
<p>numpy提供了各种三角函数。例如 <code class="code docutils literal notranslate"><span class="pre">np.sin()</span></code> ， <code class="code docutils literal notranslate"><span class="pre">np.cos()</span></code> ， <code class="code docutils literal notranslate"><span class="pre">np.tan()</span></code> ， <code class="code docutils literal notranslate"><span class="pre">np.arcsin()</span></code> ， <code class="code docutils literal notranslate"><span class="pre">np.arccos()</span></code> ， <code class="code docutils literal notranslate"><span class="pre">np.arctan()</span></code> 。需要注意的是，这些三角函数的计算内容应该是弧度制，所以对于以角度为单位的数 <code class="code docutils literal notranslate"><span class="pre">degree</span></code> ，需要通过 <code class="code docutils literal notranslate"><span class="pre">degree*np.pi/180</span></code> 来将角度转换为弧度。而弧度可以利用 <code class="code docutils literal notranslate"><span class="pre">np.degrees()</span></code> 函数来将其转换为角度。</p>
<p>在指数运算方面，numpy提供了自然常数e为底的指数函数 <code class="code docutils literal notranslate"><span class="pre">np.exp()</span></code> ，一般的指数计算可以使用 <code class="code docutils literal notranslate"><span class="pre">np.power(a,</span> <span class="pre">b)</span></code> 来计算 <span class="math notranslate nohighlight">\(a^{b}\)</span> 。</p>
<p>在对数运算方面，nump提供了自然常数e为底的对数函数 <code class="code docutils literal notranslate"><span class="pre">np.log()</span></code> 和以10为底的对数函数 <code class="code docutils literal notranslate"><span class="pre">np.log10()</span></code> 。</p>
</section>
<section id="id20">
<h3>数据类型转换<a class="headerlink" href="#id20" title="此标题的永久链接"></a></h3>
<p>numpy数据类型转换需要调用方法 <code class="code docutils literal notranslate"><span class="pre">astype()</span></code> ，例如 <code class="code docutils literal notranslate"><span class="pre">np.array(x).astype(int)</span></code> 。调用astype返回进行了数据类型修改后的数据，但是源数据的类型不会变，需要进一步对源数据的使用dtype进行操作才能改变，例如 <code class="code docutils literal notranslate"><span class="pre">a.astype(np.int16)</span></code> 。但是，没有使用astype而直接修改dtype数据会强制用新数据类型表示，将会导致输出错误数据。</p>
</section>
<section id="id21">
<h3>生成序列<a class="headerlink" href="#id21" title="此标题的永久链接"></a></h3>
<p>生成一维序列可以使用 <code class="code docutils literal notranslate"><span class="pre">linspace</span></code> 函数，能够通过指定区间开始和结尾及点个数来生成序列。其调用方式为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">start</span></code> ：序列开始的值。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">stop</span></code> ：序列结束的值。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">num</span></code> ：生成序列点的数量。默认为50个。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">endpoint</span></code> ：用来控制序列末尾是开区间还是闭区间。默认是闭区间。</p></li>
</ul>
<p>函数将返回一个数组对象。</p>
<p>另外一个用来生成一维序列的函数为 <code class="code docutils literal notranslate"><span class="pre">arange</span></code> ，能够通过指定区间开始和结尾及步长来生成序列。其调用方式为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>一般有三种使用方式：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">arange(stop)</span></code> ：只传入结尾点，函数将返回左开右闭序列 <code class="code docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">stop)</span></code> ，且步长为1。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">arange(start,</span> <span class="pre">stop)</span></code> ：传入开始和结尾，函数将返回左开右闭序列 <code class="code docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">stop)</span></code> ，且步长为1。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">arange(start,</span> <span class="pre">stop,</span> <span class="pre">step)</span></code> ：传入开始、结尾和步长，函数将返回左开右闭序列 <code class="code docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">stop)</span></code> ，且步长为指定的step。</p></li>
</ul>
</section>
<section id="interp">
<h3>interp线性插值<a class="headerlink" href="#interp" title="此标题的永久链接"></a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">np.interp()</span></code> 能够进行一维线性插值，返回离散数据的一维分段线性插值结果。其参数与返回值情况如下：</p>
<ul class="simple">
<li><p>x: 数组。待插入数据的横坐标。</p></li>
<li><p>xp：一维浮点数序列。原始数据点的横坐标，如果period参数没有指定那么就必须是递增的。否则，在使用 <code class="code docutils literal notranslate"><span class="pre">xp</span> <span class="pre">=</span> <span class="pre">xp</span> <span class="pre">%</span> <span class="pre">period</span></code> 正则化之后，xp在内部进行排序。</p></li>
<li><p>fp：一维浮点数或复数序列。原始数据点的纵坐标，和xp序列等长。</p></li>
<li><p>left：可选参数，类型为浮点数或复数（与fp值对应）。作为 <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">xp[0]</span></code> 时的返回值，默认为 <code class="code docutils literal notranslate"><span class="pre">fp[0]</span></code> 。</p></li>
<li><p>right：可选参数，类型为浮点数或复数（与fp值对应）。作为 <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">xp[-1]</span></code> 时的返回值，默认为 <code class="code docutils literal notranslate"><span class="pre">fp[-1]</span></code> 。</p></li>
<li><p>period：None或者浮点数，可选参数。横坐标的周期.。此参数使得可以正确插入angular x-coordinates。如果该参数被设定，那么会忽略left参数和right参数。</p></li>
<li><p>返回值：浮点数或复数（对应于fp值）或ndarray。插入数据的纵坐标，和x形状相同。</p></li>
</ul>
<p>需要注意的是，在没有设定 <code class="code docutils literal notranslate"><span class="pre">period</span></code> 参数时，默认要求xp参数必须是递增的。</p>
<p>一种使用案例是根据标定好的二维数据组进行直线内插值。例如，通过实验标定得知电子管阴极电流 <span class="math notranslate nohighlight">\(I_{f}\)</span> 与温度的对应关系分别为列表 <code class="code docutils literal notranslate"><span class="pre">xp</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">fp</span></code> ，通过实验测量得到的 <span class="math notranslate nohighlight">\(I_{f}\)</span> 序列为 <code class="code docutils literal notranslate"><span class="pre">x</span></code> ，那么通过调用 <code class="code docutils literal notranslate"><span class="pre">np.interp()</span></code> 函数即可得到对应的直线内插值序列：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.500</span><span class="p">,</span> <span class="mf">0.550</span><span class="p">,</span> <span class="mf">0.600</span><span class="p">,</span> <span class="mf">0.650</span><span class="p">,</span> <span class="mf">0.700</span><span class="p">]</span>
<span class="n">fp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1726</span><span class="p">,</span> <span class="mi">1809</span><span class="p">,</span> <span class="mi">1901</span><span class="p">,</span> <span class="mi">1975</span><span class="p">,</span> <span class="mi">2059</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.68</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id22">
<h3>计算标准差<a class="headerlink" href="#id22" title="此标题的永久链接"></a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">np.std()</span></code> 能够计算给定数组沿指定轴线的标准差。其参数和返回值情况如下：</p>
<ul class="simple">
<li><p>arr：数组。输入数组来计算标准差。</p></li>
<li><p>axis： <code class="code docutils literal notranslate"><span class="pre">None</span></code>, <code class="code docutils literal notranslate"><span class="pre">int</span></code> 或元素为 <code class="code docutils literal notranslate"><span class="pre">int</span></code> 的元组。计算标准差的轴。 <code class="code docutils literal notranslate"><span class="pre">axis=0</span></code> 表示沿列计算标准差， <code class="code docutils literal notranslate"><span class="pre">axis=1</span></code> 表示沿行计算标准差。如果给定该参数，那么就会把多维数组视为一个扁平化的列表。</p></li>
<li><p>dtype： <code class="code docutils literal notranslate"><span class="pre">dtype</span></code> 或 <code class="code docutils literal notranslate"><span class="pre">None</span></code> 。在计算标准差时使用的数据类型，默认为 <code class="code docutils literal notranslate"><span class="pre">float64</span></code> 。</p></li>
</ul>
</section>
</section>
<section id="pandas">
<h2>pandas<a class="headerlink" href="#pandas" title="此标题的永久链接"></a></h2>
<p>该模块的一般导入方式为 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">pandas</span> <span class="pre">as</span> <span class="pre">pd</span></code> 。</p>
<section id="id23">
<h3>文件的读取与保存<a class="headerlink" href="#id23" title="此标题的永久链接"></a></h3>
<p>pandas打开文件的函数有三种，分别对应三类文件，如下所示</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 49%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>数据类型</p></th>
<th class="head"><p>说明</p></th>
<th class="head"><p>pandas读取方式</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>csv,tsv,txt</p></td>
<td><p>用逗号、tab分隔的纯文本文件</p></td>
<td><p>pd.read_csv()</p></td>
</tr>
<tr class="row-odd"><td><p>excel</p></td>
<td><p>xls或xlsx文件</p></td>
<td><p>pd.read_excel()</p></td>
</tr>
<tr class="row-even"><td><p>mysql</p></td>
<td><p>关系型数据库表</p></td>
<td><p>pd.read_sql()</p></td>
</tr>
</tbody>
</table>
<p>详细可见 <code class="code docutils literal notranslate"><span class="pre">read_excel()</span></code> 的 <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html">官方文档</a> 和 <code class="code docutils literal notranslate"><span class="pre">read_csv()</span></code> 的 <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">官方文档</a></p>
</section>
<section id="id26">
<h3>表格的行列显示<a class="headerlink" href="#id26" title="此标题的永久链接"></a></h3>
<p>通过下面的代码来解决DataFrame行列显示不全的问题：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id27">
<h3>表格的合并<a class="headerlink" href="#id27" title="此标题的永久链接"></a></h3>
<p>如果需要将表格直接合并，可以使用 <code class="code docutils literal notranslate"><span class="pre">concat()</span></code> 函数来实现。其基本调用方式如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>其中各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">objs</span></code> ：需要进行合并的表格序列，一般通过list来传入。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">axis</span></code> ：表格进行合并的方向。 <code class="code docutils literal notranslate"><span class="pre">axis=0</span></code> 表示各个表格上下进行合并； <code class="code docutils literal notranslate"><span class="pre">axis=1</span></code> 表示各个表格左右进行合并。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">join</span></code> ：合并方式。可选的方式有 <code class="code docutils literal notranslate"><span class="pre">inner,</span> <span class="pre">outer</span></code> ，默认是 <code class="code docutils literal notranslate"><span class="pre">outer</span></code> ，因为列名不匹配而空出的部分会用 <code class="code docutils literal notranslate"><span class="pre">NaN</span></code> 填充。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ignore_index</span></code> ：如果采用默认的False，那么列表合并之后的index还是原来的；如果设置为True，那么会在合并后重新按顺序设置index，效果相当于 <code class="code docutils literal notranslate"><span class="pre">reset_index(drop=True)</span></code> 。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">sort</span></code> ：连接方式为 <code class="code docutils literal notranslate"><span class="pre">outer</span></code> 时，如果连接时存在不匹配的部分，设置为True后可以将这些存在NaN填充的列排到最后。当连接方式为 <code class="code docutils literal notranslate"><span class="pre">inner</span></code> 时此参数不起作用。</p></li>
</ul>
<p>如果需要根据其中某列的共同数据来将两个表格进行合并，可以使用 <code class="code docutils literal notranslate"><span class="pre">merge()</span></code> 函数来实现。其基本的调用方式如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_x&#39;</span><span class="p">,</span> <span class="s1">&#39;_y&#39;</span><span class="p">),</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>其中各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">left</span></code> ：用于合并的表格，必须是DataFrame。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">right</span></code> ：用以与上面的表格进行合并的表格，可以是DataFrame或Series。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">how</span></code> ：合并表格的依据。可以选择的有 <code class="code docutils literal notranslate"><span class="pre">'left',</span> <span class="pre">'right',</span> <span class="pre">'outer',</span> <span class="pre">'inner',</span> <span class="pre">'cross'</span></code> ，默认是 <code class="code docutils literal notranslate"><span class="pre">inner</span></code> 。各种依据的实现效果可以参考 <a class="reference external" href="https://zhuanlan.zhihu.com/p/344353519">DataFrame的合并merge()</a></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">on</span></code> ：连接的列名依据，必须两个表格共有。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">left_on</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">right_on</span></code> ：如果合并列表的依据列的列名并不相同，可以改为使用这两个参数来分别指定，效果同 <code class="code docutils literal notranslate"><span class="pre">on</span></code> 。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">indicator</span></code> ：如果设置为 <code class="code docutils literal notranslate"><span class="pre">True</span></code> ，则会自动添加一列「_merge」，其中包含了各行的合并情况， 分为「left_only」、「right_only」和「both」。可以配合 <code class="code docutils literal notranslate"><span class="pre">query('_merge</span> <span class="pre">==</span> <span class="pre">&quot;left_only&quot;')</span></code> 函数来实现快速查找。</p></li>
</ul>
</section>
<section id="id28">
<h3>剔除表格重复行<a class="headerlink" href="#id28" title="此标题的永久链接"></a></h3>
<p>通过 <code class="code docutils literal notranslate"><span class="pre">drop_duplicates()</span></code> 函数来将Series中重复的元素替换为 <code class="code docutils literal notranslate"><span class="pre">NaN</span></code> ，之后配合 <code class="code docutils literal notranslate"><span class="pre">dropna()</span></code> 函数来将其剔除掉。下面是一个完整的操作示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tte_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tte_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id29">
<h3>按列对数据进行函数处理<a class="headerlink" href="#id29" title="此标题的永久链接"></a></h3>
<p>对于Series对象，使用的是 <code class="code docutils literal notranslate"><span class="pre">map()</span></code> 函数；对于DataFrame对象，使用的是 <code class="code docutils literal notranslate"><span class="pre">apply()</span></code> 函数。对Series操作时，不需要指定方向；对DataFrame操作时，需要指定 <code class="code docutils literal notranslate"><span class="pre">axis=1</span></code> 来按列操作。下面是使用示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;posatt_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;posatt_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1514736000</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;voltage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">calculate_voltage</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;resistance&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id30">
<h3>筛选符合条件的数据<a class="headerlink" href="#id30" title="此标题的永久链接"></a></h3>
<p>直接对DataFrame的列使用逻辑判断运算会得到对应的包含bool判断结果的Series，例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;valid_value_judge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">E0</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">E0</span> <span class="o">&lt;</span> <span class="mi">3000</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;invalid_value_judge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">E0</span> <span class="o">&lt;=</span> <span class="mi">40</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">E0</span> <span class="o">&gt;=</span> <span class="mi">3000</span><span class="p">))</span>
</pre></div>
</div>
<p>再配合 <code class="code docutils literal notranslate"><span class="pre">sum()</span></code> 函数可以实现对符合判断结果的数据进行统计。</p>
</section>
</section>
<section id="re">
<h2>re<a class="headerlink" href="#re" title="此标题的永久链接"></a></h2>
<section id="id31">
<h3>正则表达式<a class="headerlink" href="#id31" title="此标题的永久链接"></a></h3>
<p>可以在 <a class="reference external" href="https://c.runoob.com/front-end/854/">正则表达式在线测试</a> 测试自己的正则表达式效果。</p>
<p>下面是常用的具有固定含义的特殊符号（元符号）：</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>元符号</p></th>
<th class="head"><p>功能</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.</p></td>
<td><p>匹配除了换行符以外的任意字符</p></td>
</tr>
<tr class="row-odd"><td><p>\w</p></td>
<td><p>匹配字母或数字或下划线</p></td>
</tr>
<tr class="row-even"><td><p>\s</p></td>
<td><p>匹配任意的空白符</p></td>
</tr>
<tr class="row-odd"><td><p>\d</p></td>
<td><p>匹配数字</p></td>
</tr>
<tr class="row-even"><td><p>\n</p></td>
<td><p>匹配一个换行符</p></td>
</tr>
<tr class="row-odd"><td><p>\t</p></td>
<td><p>匹配一个制表符</p></td>
</tr>
<tr class="row-even"><td><p>^</p></td>
<td><p>匹配字符串的开始</p></td>
</tr>
<tr class="row-odd"><td><p>$</p></td>
<td><p>匹配字符串的结尾</p></td>
</tr>
<tr class="row-even"><td><p>\W</p></td>
<td><p>匹配字母或数字或下划线以外的内容</p></td>
</tr>
<tr class="row-odd"><td><p>\D</p></td>
<td><p>匹配非数字</p></td>
</tr>
<tr class="row-even"><td><p>\S</p></td>
<td><p>匹配非空白符</p></td>
</tr>
<tr class="row-odd"><td><p>a|b</p></td>
<td><p>匹配字符a或字符b</p></td>
</tr>
<tr class="row-even"><td><p>()</p></td>
<td><p>匹配括号内的表达式，也表示一个组</p></td>
</tr>
<tr class="row-odd"><td><p>[…]</p></td>
<td><p>匹配字符组中的字符，用-表示范围</p></td>
</tr>
<tr class="row-even"><td><p>[^…]</p></td>
<td><p>匹配除了字符组中字符的所有字符</p></td>
</tr>
</tbody>
</table>
<p>可以使用量词来控制前面元符号出现的次数</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>量词符号</p></th>
<th class="head"><p>功能</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>*</p></td>
<td><p>重复零次或更多次</p></td>
</tr>
<tr class="row-odd"><td><p>+</p></td>
<td><p>重复一次或更多次</p></td>
</tr>
<tr class="row-even"><td><p>?</p></td>
<td><p>重复零次或一次</p></td>
</tr>
<tr class="row-odd"><td><p>{n}</p></td>
<td><p>重复n次</p></td>
</tr>
<tr class="row-even"><td><p>{n,}</p></td>
<td><p>重复n次或更多次</p></td>
</tr>
<tr class="row-odd"><td><p>{n,m}</p></td>
<td><p>重复n到m次</p></td>
</tr>
</tbody>
</table>
<p>在爬虫里面常用的两种匹配有 <strong>贪婪匹配</strong> 和 <strong>惰性匹配</strong> ，分别通过 <code class="code docutils literal notranslate"><span class="pre">.*</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">.*?</span></code> 来实现。贪婪匹配的意思是在符合其他限制的前提下，尽可能多地匹配内容；惰性匹配的意思是在符合其他限制的前提下，尽可能少地匹配内容。惰性匹配的实现是在贪婪匹配的基础之上的，先遍历所有字符查找到最远的匹配字符，得到最长的符合匹配要求的字符串，然后反过来回溯寻找最先遇到的匹配字符，得到最短的符合匹配要求的字符。</p>
</section>
<section id="id33">
<h3>re模块匹配分析<a class="headerlink" href="#id33" title="此标题的永久链接"></a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">findall()</span></code> 函数可以匹配字符串中所有符合正则的内容，返回一个列表。例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mypattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\d+&quot;</span>
<span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;Koishi的电话号码是：10086，Satori的电话号码是：10010&quot;</span>
<span class="n">lst</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">mypattern</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
</pre></div>
</div>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">finditer()</span></code> 函数来匹配内容则会返回迭代器，可以通过循环来得到匹配内容。迭代器里面的是match对象，需要用 <code class="code docutils literal notranslate"><span class="pre">group()</span></code> 函数来获取数据。例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mypattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\d+&quot;</span>
<span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;Koishi的电话号码是：10086，Satori的电话号码是：10010&quot;</span>
<span class="n">it</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">mypattern</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</pre></div>
</div>
<p>上面的匹配函数是来寻找所有匹配内容的。使用 <code class="code docutils literal notranslate"><span class="pre">search()</span></code> 函数则只会匹配第一个符合的内容，返回的是match对象，同样需要用 <code class="code docutils literal notranslate"><span class="pre">group()</span></code> 函数来获取数据。例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mypattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\d+&quot;</span>
<span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;Koishi的电话号码是：10086，Satori的电话号码是：10010&quot;</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">mypattern</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">match()</span></code> 函数是从头开始匹配，可以理解为是在 <code class="code docutils literal notranslate"><span class="pre">search()</span></code> 函数的基础上，自动在正则表达式前面加上了 <code class="code docutils literal notranslate"><span class="pre">^</span></code> 。</p>
<p>有时候正则表达式非常复杂，并且在爬虫时经常使用到，就可以用 <code class="code docutils literal notranslate"><span class="pre">compile()</span></code> 函数来将正则表达式预加载来提高效率。例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mypattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\d+&quot;</span>
<span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;Koishi的电话号码是：10086，Satori的电话号码是：10010&quot;</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">mypattern</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</pre></div>
</div>
<p>接下来就从正则表达式匹配到的内容分别获取所需数据。核心就是在原本的匹配符号添加小括号，并添加标签，例如 <code class="code docutils literal notranslate"><span class="pre">(?P&lt;id&gt;d+)</span></code> ，其中的 <code class="code docutils literal notranslate"><span class="pre">&lt;&gt;</span></code> 内包含的字符为标签名称，可以赋值给 <code class="code docutils literal notranslate"><span class="pre">group()</span></code> 函数来获取对应数据。下面是一个简单的示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;div class=&#39;koishi&#39;&gt;&lt;span id=&#39;1&#39;&gt;古明地恋&lt;/span&gt;&lt;/div&gt;</span>
<span class="s2">&lt;div class=&#39;Satori&#39;&gt;&lt;span id=&#39;2&#39;&gt;古明地觉&lt;/span&gt;&lt;/div&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">mypattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&lt;div class=&#39;.*?&#39;&gt;&lt;span id=&#39;(?P&lt;id&gt;\d)&#39;&gt;(?P&lt;name&gt;.*?)&lt;/span&gt;&lt;/div&gt;&quot;</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">mypattern</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># re.S能让.匹配换行符</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="requests">
<h2>requests<a class="headerlink" href="#requests" title="此标题的永久链接"></a></h2>
<section id="id34">
<h3>获取网址响应<a class="headerlink" href="#id34" title="此标题的永久链接"></a></h3>
<p>下面是一个获取搜索页面响应源代码内容的爬虫代码。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.sogou.com/web?query=古明地恋&#39;</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>从直接从网页url得到的响应都是 <code class="code docutils literal notranslate"><span class="pre">get</span></code> 类型的。</p>
</div>
<p>事实上，上面的代码没有成功获取页面源代码，因为没有通过用户检测。要想处理这个反爬手段，可以添加请求头来使请求更像正常请求。在浏览器页面中右键选择「检查」，选择「网络」标签，查看对应请求的标头，找到「user-agent」，将对应的内容复制添加到代码响应头当中，即可成功爬取网页源代码。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.sogou.com/web?query=古明地恋&#39;</span>
<span class="n">myheaders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;user-agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.42&quot;</span>
<span class="p">}</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">myheaders</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>如果不是网页url的响应，就需要通过浏览器F12在「网络」处检查自己所需的内容是在哪个地方请求出来的。下面以爬取百度翻译翻译结果为例进行说明。首先进入百度翻译网页 <code class="code docutils literal notranslate"><span class="pre">https://fanyi.baidu.com/</span></code> ，按下F12进入浏览器开发者界面，观察「网络」情况，然后以英文输入法在搜索框输入「dog」，在事件中查看「预览」，可以发现所需的翻译结果在「sug」事件里面。通过查看其标头可知请求URL为 <code class="code docutils literal notranslate"><span class="pre">https://fanyi.baidu.com/sug</span></code> ，请求方法为 <code class="code docutils literal notranslate"><span class="pre">POST</span></code> ，而自己传入的数据「dog」是在「负载」当中以「kw: dog」的形式传入的。于是爬取的代入如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://fanyi.baidu.com/sug&quot;</span>

<span class="n">mydata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;kw&quot;</span><span class="p">:</span> <span class="s2">&quot;dog&quot;</span>
<span class="p">}</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mydata</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
<span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>发送post请求时，发送的数据必须放在字典中，通过 <code class="code docutils literal notranslate"><span class="pre">data</span></code> 参数进行传递。</p>
</div>
<p>有的响应内容会更加复杂，请求URL也更加复杂。下面以爬取豆瓣电影分类排行榜-喜剧片为例进行说明。首先进入对应的网页界面，按下F12进入开发者工具观察「网络」情况，刷新页面以获取响应。直接查看「全部」响应过于繁杂，常见的二级反馈内容可以在「Fetch/XHR」中看到，在这个案例中就是在其中的第三个事件的「预览」当中可以找到所需数据。可以看到请求URL为 <code class="code docutils literal notranslate"><span class="pre">https://movie.douban.com/j/chart/top_list?type=24&amp;interval_id=100%3A90&amp;action=&amp;start=0&amp;limit=20</span></code> ，请求方法为 <code class="code docutils literal notranslate"><span class="pre">GET</span></code> 。</p>
<p>但是直接使用该URL过于冗杂，而其实际上是通过自动传入的数据形成的，可以在「负载」里面看到传入的对应数据，将其复制下来作为将要传入的字典，这时请求URL就简化为了原本 <code class="code docutils literal notranslate"><span class="pre">?</span></code> 之前的url，可以通过 <code class="code docutils literal notranslate"><span class="pre">print(resp.request.url)</span></code> 来验证。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>因为是GET方法，所以就不再是通过POST方法的 <code class="code docutils literal notranslate"><span class="pre">data</span></code> 参数传入，而是通过GET方法的 <code class="code docutils literal notranslate"><span class="pre">params</span></code> 参数传入。</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://movie.douban.com/j/chart/top_list&quot;</span>

<span class="n">myparams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;24&quot;</span><span class="p">,</span>
    <span class="s2">&quot;interval_id&quot;</span><span class="p">:</span> <span class="s2">&quot;100:90&quot;</span><span class="p">,</span>
    <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="mi">20</span>
<span class="p">}</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">myparams</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>实际上，上面的代码没有返回任何数据，说明程序被反爬了，接下来要尝试各种破解手段。首先考虑的应该是添加user-agent。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://movie.douban.com/j/chart/top_list&quot;</span>

<span class="n">myparams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;24&quot;</span><span class="p">,</span>
    <span class="s2">&quot;interval_id&quot;</span><span class="p">:</span> <span class="s2">&quot;100:90&quot;</span><span class="p">,</span>
    <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="mi">20</span>
<span class="p">}</span>

<span class="n">myheaders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.42&quot;</span>
<span class="p">}</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">myparams</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">myheaders</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
<span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>上述代码就成功爬取到了所需内容。进一步观察可以发现，网页下拉可以加载更多数据，而对应到事件标头可以发现，只是将「负载」中的参数 <code class="code docutils literal notranslate"><span class="pre">start</span></code> 对应的数字进行递增而已，其他没有任何变化，于是就可以通过循环爬取更多内容。</p>
</section>
<section id="id35">
<h3>爬虫案例<a class="headerlink" href="#id35" title="此标题的永久链接"></a></h3>
<section id="id36">
<h4>使用re模块进行数据提取的案例<a class="headerlink" href="#id36" title="此标题的永久链接"></a></h4>
<p>下面来爬取豆瓣电影top250的信息数据，需要爬取电影名、年份、评分、评分人数四类数据。其网址为 <code class="code docutils literal notranslate"><span class="pre">https://movie.douban.com/top250</span></code> ，可以发现所需数据直接放在了网页页面源代码上，所以是通过 <code class="code docutils literal notranslate"><span class="pre">GET</span></code> 方法来获取响应。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://movie.douban.com/top250&quot;</span>

<span class="n">myheaders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.42&quot;</span>
<span class="p">}</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">myheaders</span><span class="p">)</span>
<span class="n">page_content</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span>
<span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>通过观察页面源代码，满足需求的正则表达式如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pattern1</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&lt;li&gt;.*?&lt;span class=&quot;title&quot;&gt;(?P&lt;name&gt;.*?)&lt;/span&gt;&#39;</span>
<span class="n">pattern2</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&lt;br&gt;(?P&lt;year&gt;.*?)&amp;nbsp&#39;</span>
<span class="n">pattern3</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&lt;span class=&quot;rating_num&quot; property=&quot;v:average&quot;&gt;(?P&lt;score&gt;.*?)&lt;/span&gt;&#39;</span>
<span class="n">pattern4</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&lt;span&gt;(?P&lt;num&gt;.*?)人评价&lt;/span&gt;&#39;</span>
<span class="n">mypattern</span> <span class="o">=</span> <span class="n">pattern1</span> <span class="o">+</span> <span class="s1">&#39;.*?&#39;</span> <span class="o">+</span> <span class="n">pattern2</span> <span class="o">+</span> <span class="s1">&#39;.*?&#39;</span> <span class="o">+</span> <span class="n">pattern3</span> <span class="o">+</span> <span class="s1">&#39;.*?&#39;</span> <span class="o">+</span> <span class="n">pattern4</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">mypattern</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># 注意要re.S让.匹配换行符</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">page_content</span><span class="p">)</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># 去掉空白与换行</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>上面的代码说明已经能够提取出所需数据了，接下来配合csv模块将爬取的数据写入到csv文件当中，需要导入 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">csv</span></code> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">mypattern</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># 注意要re.S让.匹配换行符</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">page_content</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;test.csv&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">csvwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>
        <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>如果在 <code class="code docutils literal notranslate"><span class="pre">open()</span></code> 函数里面没有添加 <code class="code docutils literal notranslate"><span class="pre">newline=''</span></code> 参数设置，会导致最后的csv文件存在空行。</p>
</div>
<p>仔细观察原网页，可以发现点击第2页的时候url变成了 <code class="code docutils literal notranslate"><span class="pre">https://movie.douban.com/top250?start=25&amp;filter=</span></code> ，可以观察到 <code class="code docutils literal notranslate"><span class="pre">start=25</span></code> 控制了页面显示的内容。通过循环赋值修改url，可以逐步爬取到排行榜所有的信息。</p>
</section>
</section>
</section>
<section id="scipy">
<h2>scipy<a class="headerlink" href="#scipy" title="此标题的永久链接"></a></h2>
<section id="id37">
<h3>数值导数<a class="headerlink" href="#id37" title="此标题的永久链接"></a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">scipy.misc</span></code> 模块下的 <code class="code docutils literal notranslate"><span class="pre">derivative</span></code> 函数来计算函数在某点处的导数值。其调用方式为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>其中各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">func</span></code> ：需要计算导数值的函数表达式。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">x0</span></code> ：计算导数值对应的横坐标，类型为 <code class="code docutils literal notranslate"><span class="pre">float</span></code> 。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">dx</span></code> ：步长间隔。将步长减小过小会导致舍入误差。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">n</span></code> ：求导阶数。默认为一阶导。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">order</span></code> ：用于计算的点数，必须是奇数整型。</p></li>
</ul>
<p>一般的导入方式是 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.misc</span> <span class="pre">import</span> <span class="pre">derivative</span></code> ，下面是一个简单的示例，计算了 <span class="math notranslate nohighlight">\(\frac{\mathrm{d}(x^{3}+x^{2})}{\mathrm{d}x}\bigg|_{x=1}\)</span> ：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id38">
<h3>数值积分<a class="headerlink" href="#id38" title="此标题的永久链接"></a></h3>
<section id="id39">
<h4>一重积分<a class="headerlink" href="#id39" title="此标题的永久链接"></a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">scipy.integrate</span></code> 库中的 <code class="code docutils literal notranslate"><span class="pre">quad</span></code> 函数进行一重积分。其调用方式为 <code class="code docutils literal notranslate"><span class="pre">scipy.integrate.quad(f，a，b)</span></code> ，各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">f</span></code> ：被积函数。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">a</span></code> ：积分下限的值。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">b</span></code> ：积分上限的值。</p></li>
</ul>
<p>其返回的结果是一个元组，第一个元素是积分结果，第二个元素是积分值绝对误差的估计值。一般的导入方式是 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.integrate</span> <span class="pre">import</span> <span class="pre">quad</span></code> 。下面是一个简单的示例，计算了 <span class="math notranslate nohighlight">\(\int_{0}^{1}e^{-x^{2}}~\mathrm{d}x\)</span> ：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id40">
<h4>二重积分<a class="headerlink" href="#id40" title="此标题的永久链接"></a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">scipy.integrate</span></code> 库中的 <code class="code docutils literal notranslate"><span class="pre">dblquad</span></code> 函数进行二重积分。在进行计算前需要将二重积分写成累次积分的形式。其调用方式为</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>scipy.integrate.dblquad(func，a，b，gfun，hfun)
</pre></div>
</div>
<p>各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">func</span></code> ：被积函数的表达式。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">a</span></code> ：自由变量的下限。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">b</span></code> ：自由变量的上限。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">gfun</span></code> ：束缚变量的下限表达式。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hfun</span></code> ：束缚变量的上限表达式。</p></li>
</ul>
<p>需要注意，即使束缚变量的上下限是常数，也应该设为函数表达式来传入。其返回的结果是一个元组，第一个元素是积分结果，第二个元素是积分值绝对误差的估计值。一般的导入方式是 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.integrate</span> <span class="pre">import</span> <span class="pre">dblquad</span></code> 。下面是一个简单的示例，计算了 <code class="code docutils literal notranslate"><span class="pre">int_{0}^{1/2}mathrm{d}yint_{0}^{sqrt{1-4y^{2}}}16xy~mathrm{d}x</span></code> ：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
<span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="mi">0</span>
<span class="n">h</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">dblquad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id41">
<h4>多重积分<a class="headerlink" href="#id41" title="此标题的永久链接"></a></h4>
<p>如果需要进行多重积分的数值计算，可以使用 <code class="code docutils literal notranslate"><span class="pre">scipy.integrate</span></code> 库中的 <code class="code docutils literal notranslate"><span class="pre">nquad</span></code> 函数。其调用方式为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">nquad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>各参数的含义如下：</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">func</span></code> ：被积函数的表达式。要求以 <code class="code docutils literal notranslate"><span class="pre">func(x0,</span> <span class="pre">x1,</span> <span class="pre">...,</span> <span class="pre">xn,</span> <span class="pre">t0,</span> <span class="pre">t1,</span> <span class="pre">...,</span> <span class="pre">tm)</span></code> 的形式书写，其中 <code class="code docutils literal notranslate"><span class="pre">x0,</span> <span class="pre">x1,</span> <span class="pre">...,</span> <span class="pre">xn</span></code> 为函数变量， <code class="code docutils literal notranslate"><span class="pre">t0,</span> <span class="pre">t1,</span> <span class="pre">...,</span> <span class="pre">tm</span></code> 为函数参数，并且按次序使得 <code class="code docutils literal notranslate"><span class="pre">x0</span></code> 是最内层的积分变量， <code class="code docutils literal notranslate"><span class="pre">xn</span></code> 是最外层的积分变量。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ranges</span></code> ：积分变量上下限。需要是一个可迭代对象，一般是二维列表，依次书写最内层积分变量的[下限，上限]列表直到最外层作为其元素。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">args</span></code> ：被积函数参数 <code class="code docutils literal notranslate"><span class="pre">t0,</span> <span class="pre">t1,</span> <span class="pre">...,</span> <span class="pre">tm</span></code> 的值。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">opts</span></code> ：用来传递给具体积分运算的可选要求。需要是包含字典的可迭代对象或能够返回字典的函数。先后依次对应最内层积分直到最外层的运算。可以调整的opts参数有：</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">epsabs=1.49e-08</span></code> ，绝对误差宽容。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">epsrel=1.49e-0.8</span></code> ，相对误差宽容。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">limit=50</span></code> ，自适应算法中使用的子区间数的上限。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">points=None</span></code> ，在有界积分区间内的断点序列，在这里被积函数可能出现奇点、不连续等问题。序列不需要排序。该选项不能与 <code class="code docutils literal notranslate"><span class="pre">weight</span></code> 一起使用。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">weight=None</span></code> ，字符串指示权重函数。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">wvar=None</span></code> ，用于权重函数的变量。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">wopts=None</span></code> ，可选输入重用切比雪夫矩。</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">full_output</span></code> ：如果设置为 <code class="code docutils literal notranslate"><span class="pre">full_output=True</span></code> ，那么就会返回一个 <code class="code docutils literal notranslate"><span class="pre">neval</span></code> 字典记录被积函数求值的次数。</p></li>
</ul>
<p>该函数将返回计算结果、估计误差。一般的导入方式是 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.integrate</span> <span class="pre">import</span> <span class="pre">nquad</span></code> 。下面是一个案例，计算了</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\int_{t_{0}+t_{1}-1}^{t_{0}+t_{1}+1}\int_{x_{2}+t_{0}^{2}t_{1}^{3}-1}^{x_{2}+t_{0}^{2}t_{1}^{3}+1}\int_{t_{0}x_{1}+t_{1}x_{2}-1}^{t_{0}x_{1}+t_{1}x_{2}+1}f(x_{0},x_{1},x_{2},t_{0},t_{1})~\mathrm{d}x_{0}\mathrm{d}x_{1}\mathrm{d}x_{2}
\end{align}\]</div>
<p>其中被积函数的表达式为</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
f(x_{0},x_{1},x_{2},t_{0},t_{1})=\left\{\begin{array}{ll}
x_{0}x_{2}^{2}+\sin x_{1}+2 &amp; (x_{0}+t_{1}x_{1}-t_{0}&gt;0) \\
x_{0}x_{2}^{2}+\sin x_{1}+1 &amp; (x_{0}+t_{1}x_{1}-t_{0} \leqslant 0)
\end{array}\right.
\end{align}\end{split}\]</div>
<p>且参数为 <span class="math notranslate nohighlight">\((t_{0}, t_{1})=(0,1)\)</span> ，计算代码如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x0</span><span class="o">*</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x0</span><span class="o">+</span><span class="n">t1</span><span class="o">*</span><span class="n">x1</span><span class="o">-</span><span class="n">t0</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">lim0</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">t0</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="n">t1</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">t0</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="n">t1</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">lim1</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x2</span> <span class="o">+</span> <span class="n">t0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">t0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">lim2</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">t0</span> <span class="o">+</span> <span class="n">t1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">t1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">opts0</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;points&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="n">t0</span> <span class="o">-</span> <span class="n">t1</span><span class="o">*</span><span class="n">x1</span><span class="p">]}</span>  <span class="c1"># 由于被积函数分段，在x0=t0-t1*x1处不连续</span>
<span class="k">def</span> <span class="nf">opts1</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{}</span>
<span class="k">def</span> <span class="nf">opts2</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">nquad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">[</span><span class="n">lim0</span><span class="p">,</span> <span class="n">lim1</span><span class="p">,</span> <span class="n">lim2</span><span class="p">],</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">opts</span><span class="o">=</span><span class="p">[</span><span class="n">opts0</span><span class="p">,</span> <span class="n">opts1</span><span class="p">,</span> <span class="n">opts2</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="id42">
<h3>寻找函数极小值<a class="headerlink" href="#id42" title="此标题的永久链接"></a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">scipy.optimize</span></code> 库的 <code class="code docutils literal notranslate"><span class="pre">fmin</span></code> 函数提供了使用下坡单纯形算法来求函数极小值的方法，可以寻找给定横坐标最近的极小值点。这个算法只使用函数的值，而没有使用函数的导数等信息。其调用方式为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxfun</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">retall</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_simplex</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">func</span></code> ：需要求极小值的函数表达式。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">x0</span></code> ：初始猜测点。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">args</span></code> ：传入函数表达式的额外参数。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">xtol</span></code> ：对于自变量收敛来说可接受的自变量迭代之间的绝对误差。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ftol</span></code> ：对于函数值收敛来说可接受的函数值迭代之间的绝对误差。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">maxiter</span></code> ：迭代次数上限。</p></li>
</ul>
<p>函数直接返回的是包含选取到的极小值点横坐标的列表，需要通过索引得到该极小值点的值，并回代到函数当中得到对应的极小值。一般的导入方式是 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.integrate</span> <span class="pre">import</span> <span class="pre">fmin</span></code> 。下面是一个简单的案例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 寻找离1最近的极小值点</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">scipy.optimize</span></code> 库的 <code class="code docutils literal notranslate"><span class="pre">fminbound</span></code> 函数则可以寻找给定区间的极小值点。其调用方式为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">fminbound</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">maxfun</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>其中 <code class="code docutils literal notranslate"><span class="pre">func</span></code> 为需要求极小值的函数表达式， <code class="code docutils literal notranslate"><span class="pre">x1</span></code> 为区间左端点， <code class="code docutils literal notranslate"><span class="pre">x2</span></code> 为区间右端点。一般的导入方式是 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.integrate</span> <span class="pre">import</span> <span class="pre">fminbound</span></code> 。下面是一个简单的案例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fminbound</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id43">
<h3>最小二乘法拟合<a class="headerlink" href="#id43" title="此标题的永久链接"></a></h3>
<p>最小二乘法的数学原理就是使下面公式中的 <span class="math notranslate nohighlight">\(S\)</span> 最小。其中的 <span class="math notranslate nohighlight">\(p\)</span> 表示拟合函数 <span class="math notranslate nohighlight">\(f\)</span> 的所有参数集合。</p>
<div class="math notranslate nohighlight">
\[\begin{align}
S(p)=\sum_{i=1}^{m}[y_{i}-f(x_{i},p)]^{2}
\end{align}\]</div>
<p>scipy中的子函数库optimize已经提供了实现最小二乘拟合算法的函数leastsq。需要导入 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.optimize</span> <span class="pre">import</span> <span class="pre">leastsq</span></code> 。</p>
<p>首先要获取用于拟合的数据。作为测试，下面使用真实函数数据与噪声组合的方式来获取用于拟合的数据，数据集要以列表或数组的形式存在。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span> <span class="c1"># 真实数据的函数参数</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">theta</span><span class="p">])</span> <span class="c1"># 真实数据</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1"># 加入噪声之后的实验数据</span>
</pre></div>
</div>
<p>接下来要自定义拟合函数和残差计算函数。例如下面的拟合函数为 <span class="math notranslate nohighlight">\(A\sin(2\pi kx+\theta)\)</span> ，拟合参数 <span class="math notranslate nohighlight">\(p\)</span> 包括 <span class="math notranslate nohighlight">\(A,k,\theta\)</span> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    数据拟合所用的函数: A*sin(2*pi*k*x + theta)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">residuals</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    实验数据x, y和拟合函数之间的差，p为拟合需要找到的系数</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>接下来开始进行最小二乘法拟合。首先需要自行猜测一组参数，在这个例子里就可以如下猜测：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># 第一次猜测的函数拟合参数</span>
</pre></div>
</div>
<p>之后就开始调用leastsq进行数据拟合，分别传入计算误差的函数、猜测的拟合参数和需要拟合的实验数据：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plsq</span> <span class="o">=</span> <span class="n">leastsq</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<p>调用成功后，通过 <code class="code docutils literal notranslate"><span class="pre">plsq[0]</span></code> 就可以获得拟合参数的列表。如果需要进行拟合曲线绘制，只需要plot即可。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">plsq</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;拟合曲线&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>如果需要求 <strong>决定系数</strong> ，可以使用下面的函数代码。需要依次传入实际y数据、拟合y数据。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_R2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_fit</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">y_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_fit</span><span class="p">)</span>

    <span class="n">SSE</span> <span class="o">=</span> <span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_fit</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">SST</span> <span class="o">=</span> <span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">R2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSE</span> <span class="o">/</span> <span class="n">SST</span>
    <span class="k">return</span> <span class="n">R2</span>
</pre></div>
</div>
</section>
<section id="id44">
<h3>非线性方程组求解<a class="headerlink" href="#id44" title="此标题的永久链接"></a></h3>
<p>optimize库中的fsolve函数可以用来对非线性方程组进行求解，需要导入 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.optimize</span> <span class="pre">import</span> <span class="pre">fsolve</span></code> 。它进行的数学计算逻辑如下，其中 <span class="math notranslate nohighlight">\(f\)</span> 是方程组函数， <span class="math notranslate nohighlight">\(X\)</span> 是未知数矢量。求未知数即是需要找到能令方程组计算误差趋于零的参数。</p>
<div class="math notranslate nohighlight">
\[\begin{align}
f(X) &amp; = 0
\end{align}\]</div>
<p>首先要自定义函数来表示方程组及方程组计算的误差。下面以如下的含有三个未知数的非线性方程组为例（已经导入了 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">math</span> <span class="pre">import</span> <span class="pre">sin,cos</span></code> ）：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
5x_{1}+3 &amp; = 0 \\
4x_{0}^{2}-2\sin(x_{1}\cdot x_{2}) &amp;=0 \\
x_{1}\cdot x_{2} - 1.5 &amp;= 0
\end{align}\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="mi">5</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span>
        <span class="mi">4</span><span class="o">*</span><span class="n">x0</span><span class="o">*</span><span class="n">x0</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">),</span>
        <span class="n">x1</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="mf">1.5</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>之后只需要直接调用fsolve函数即可。需要传入一组试验未知数参数，这里用的试验参数是 <code class="code docutils literal notranslate"><span class="pre">[1,1,1]</span></code> 。返回的result就是以列表形式储存的参数向量。可以用 <code class="code docutils literal notranslate"><span class="pre">func(result)</span></code> 来检查误差情况。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>在对方程组进行求解时，fsolve会自动计算方程组的雅可比矩阵，如果方程组中的未知数很多，而与每个方程有关的未知数较少时，即雅可比矩阵比较稀疏时，传递一个计算雅可比矩阵的函数将能大幅度提高运算速度。对于上面的非线性方程组，使用雅可比矩阵的fsolve方法如下。计算雅可比矩阵的函数j通过fprime参数传递给fsolve，即 <code class="code docutils literal notranslate"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">fsolve(f,</span> <span class="pre">[1,1,1],</span> <span class="pre">fprime=j)</span></code> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">j</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">8</span><span class="o">*</span><span class="n">x0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">)],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x1</span><span class="p">]</span>
        <span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id45">
<h3>微分方程的数值解<a class="headerlink" href="#id45" title="此标题的永久链接"></a></h3>
<p>可以使用 <code class="code docutils literal notranslate"><span class="pre">scipy.integrate</span></code> 模块的odeint函数来求常微分方程的数值解，其采用FORTRAN的odepack库里面的lsoda方法。一般通过 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.integrate</span> <span class="pre">import</span> <span class="pre">odeint</span></code> 来导入。需要注意的是，该函数只能处理一阶方程组，如果是高阶微分方程组，需要通过龙格-库塔方法化为一阶微分方程组。</p>
<p>该函数的基本调用格式是 <code class="code docutils literal notranslate"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">odeint(func,</span> <span class="pre">y0,</span> <span class="pre">t)</span></code> ，其中 <code class="code docutils literal notranslate"><span class="pre">func</span></code> 是定义微分方程的函数或匿名函数； <code class="code docutils literal notranslate"><span class="pre">y0</span></code> 是初始条件的序列； <code class="code docutils literal notranslate"><span class="pre">t</span></code> 是一个自变量取值的序列（其第一个元素必须是初始时刻）；返回值是对应于序列 <code class="code docutils literal notranslate"><span class="pre">t</span></code> 中元素的数值解，如果微分方程组中有 <code class="code docutils literal notranslate"><span class="pre">n</span></code> 个函数，返回值会是 <span class="math notranslate nohighlight">\(n\)</span> 列的矩阵，其第 <span class="math notranslate nohighlight">\(i(i=1,2,\cdots,n)\)</span> 列对应于第 <span class="math notranslate nohighlight">\(i\)</span> 个函数的数值解。</p>
<p>接下来处理下面给的一阶微分方程，求解其在 <span class="math notranslate nohighlight">\(1&lt;x&lt;10\)</span> （步长间隔为0.5）的点上的数值解。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\left\{\begin{array}{l}
y'=-2y+x^{2}+2x \\
y(1)=2
\end{array}\right.
\end{align}\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>  <span class="c1"># 定义微分方程</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># 给定求解范围与步长</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># 初始条件的值与求解范围的第一个元素对应</span>
</pre></div>
</div>
<p>接下来求解下面给的二阶微分方程的数值解。首先引入 <span class="math notranslate nohighlight">\(y_{0}=y\)</span> ， <span class="math notranslate nohighlight">\(y_{1}=y'\)</span> ，将原来的二阶微分方程转换为一阶微分方程组。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\left\{\begin{array}{l}
\frac{\mathrm{d}^{2}y}{\mathrm{d}x^{2}}+2\frac{\mathrm{d}y}{\mathrm{d}x}+2y=0 \\
y(0)=0 \\
y'(0)=1
\end{array}\right .
\quad \Rightarrow \quad
\left\{\begin{array}{l}
y_{0}'=y_{1} \\
y_{1}'=-2y_{0}-2y_{1} \\
y_{0}(0)=0 \\
y_{1}(0)=1
\end{array}\right .
\end{align}\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pfun</span><span class="p">(</span><span class="n">f_list</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">f_list</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">y1</span><span class="p">,</span>
        <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y0</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1</span>
    <span class="p">])</span>  <span class="c1"># 返回的是等式右边的值，要求先低阶再高阶</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># 创建自变量序列</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">pfun</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>如果对微分方程数值求解的方法有特殊要求，可以使用 <code class="code docutils literal notranslate"><span class="pre">integrate</span></code> 模块的 <code class="code docutils literal notranslate"><span class="pre">solve_ivp</span></code> 函数，官方文档见 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html</a>  。其基本的调用方式为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<p>该函数解决的是 <span class="math notranslate nohighlight">\(\left\{\begin{array}{c}\frac{\mathrm{d}y}{\mathrm{d}t}=f(t,y) \\ y(t_{0})=y_{0} \end{array}\right.\)</span> 类型的微分方程。各参数的含义如下：</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">fun</span></code> ：微分方程组等号右边的函数。需要包含自变量与因变量，一般是 <code class="code docutils literal notranslate"><span class="pre">fun(t,y)</span></code> 的形式，其中 <code class="code docutils literal notranslate"><span class="pre">t</span></code> 必须是标量，而 <code class="code docutils literal notranslate"><span class="pre">y</span></code> 可以是数组，返回的函数数组维数需要与之对应。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">t_span</span></code> ：自变量计算区间。需要传入二元数组/元组/列表。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">y0</span></code> ：初始条件，可以是数组。如果需要在复数域求解，则传入复数类型的数据。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">method</span></code> ：积分方法。默认是 <code class="code docutils literal notranslate"><span class="pre">'RK45'</span></code> ，还可以选择 <code class="code docutils literal notranslate"><span class="pre">'RK23'</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">'DOP853'</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">Radau</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">BDF</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">LSODA</span></code> 。其中Explicit Runge-Kutta methods <code class="code docutils literal notranslate"><span class="pre">'RK45'</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">'RK23'</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">'DOP853'</span></code> 用于非刚性问题，implicit methods  <code class="code docutils literal notranslate"><span class="pre">Radau</span></code> 、 <code class="code docutils literal notranslate"><span class="pre">BDF</span></code> 用于刚性问题。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">t_eval</span></code> ：用于计算解的时间点，必须排序并落在 <code class="code docutils literal notranslate"><span class="pre">t_span</span></code> 内。如果为None，则使用求解器选择的点。、</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">args</span></code> ：传递给所定义函数的附加参数。例如，如果fun具有给定的形式是 <code class="code docutils literal notranslate"><span class="pre">fun(t,</span> <span class="pre">y,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c)</span></code> ，那么jac(如果给定)和任何事件函数必须具有相同的参数形式，并且 <code class="code docutils literal notranslate"><span class="pre">args</span></code> 必须是长度为3的元组。</p></li>
</ul>
<p>函数将返回 <code class="code docutils literal notranslate"><span class="pre">t</span></code> 解出的自变量点、 <code class="code docutils literal notranslate"><span class="pre">y</span></code> 在解处的函数值，一般通过 <code class="code docutils literal notranslate"><span class="pre">result.t</span></code> 和 <code class="code docutils literal notranslate"><span class="pre">result.y</span></code> 来获取结果。</p>
<p>该函数的一般导入方式为 <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy.integrate</span> <span class="pre">import</span> <span class="pre">solve_ivp</span></code> 。接下来的案例计算了下面的微分方程组，并且给定初值条件 <span class="math notranslate nohighlight">\(y_{1}(0)=0, y_{2}(0)=1\)</span> 。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp;\frac{\mathrm{d}y_{1}}{\mathrm{d}x}=y_{2} \\
&amp;\frac{\mathrm{d}y_{2}}{\mathrm{d}x}=x^{2} - y_{1} + x
\end{align}\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Microsoft YaHei&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">y2</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">x</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">dydt</span>

<span class="n">init</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># 初始条件</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> <span class="n">init</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">t</span>  <span class="c1"># 与t_eval规定的自变量取值点数组相同</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">y</span>  <span class="c1"># 因为有两个函数值y1,y2，所以得到的是二维数组，依次存储两个函数对应的函数值</span>
<span class="n">y1_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># 获取第一个函数的函数值</span>
<span class="n">y2_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># 获取第二个函数的函数值</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;求解变量y1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;求解变量y2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;时间s&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;testfig.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="sphinx">
<h2>Sphinx<a class="headerlink" href="#sphinx" title="此标题的永久链接"></a></h2>
<p>Sphinx是一个静态网页发布工具，可将rST和md文件，发布为各类常见的用户帮助如联机帮助，用户手册等。</p>
<section id="id46">
<h3>快速新建项目<a class="headerlink" href="#id46" title="此标题的永久链接"></a></h3>
<p>详细内容可以参考 <a class="reference external" href="https://doclikecode.readthedocs.io/zh_CN/latest/1_sphinx/sphinx101.html#:~:text=%E5%BF%AB%E9%80%9F%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE%EF%BC%88%E4%BB%A5Mac%E7%B3%BB%E7%BB%9F%E4%B8%BA%E4%BE%8B%EF%BC%8CWindow%E7%B3%BB%E7%BB%9F%E7%B1%BB%E4%BC%BC%EF%BC%89%20%C2%B6%201%20%E5%9C%A8%E6%A1%8C%E9%9D%A2%E4%B8%8A%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E5%B9%B6%E5%91%BD%E5%90%8D%E4%B8%BA%20sphinx-demo%202%20%E5%9C%A8Terminal%E4%B8%AD%E6%B5%8F%E8%A7%88%E8%87%B3%E4%B8%8A%E8%BF%B0%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E5%B9%B6%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%9A,sphinx-quickstart%203%20%E5%9C%A8%E5%AF%B9%E8%AF%9D%E6%A1%86%E5%BC%8F%E7%9A%84%E9%80%89%E6%8B%A9%E4%B8%AD%EF%BC%8CY%2FN%E7%9A%84%E9%80%89%E9%A1%B9%EF%BC%8C%E9%80%89Y%EF%BC%9B%E5%A6%82%E6%9E%9C%E8%AF%A2%E9%97%AE%E9%85%8D%E7%BD%AE%EF%BC%8C%E7%9B%B4%E6%8E%A5%E5%A4%8D%E5%88%B6%20%5B%5D%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%8C%E5%A6%82%20%5B.rst%5D%EF%BC%8C%E5%88%99%E5%A1%AB%E5%86%99.rst%204%20%E6%96%B0%E5%BB%BA%E6%88%90%E5%8A%9F%E5%90%8E%EF%BC%8C%E5%88%99%E4%BC%9A%E5%BE%97%E5%88%B0%E5%A6%82%E5%9B%BE%E6%89%80%E7%A4%BA%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9%E7%BB%93%E6%9E%84">sphinx快速入门</a></p>
<p>首先新建希望存放项目文件的文件夹，然后在Terminal中浏览至上述文件夹，并运行命令： <code class="code docutils literal notranslate"><span class="pre">sphinx-quickstart</span></code> 。在对话框式的选择中，Y/N的选项，根据需要选Y；语言设置时，填入 <code class="code docutils literal notranslate"><span class="pre">zh-CN</span></code> 以支持中文简体。</p>
<p>新建完成后，浏览至 source 文件夹，并在其根目录下创建新文件夹demo，在demo文件夹中放置用于生成页面的rst文件。放置完成后，打开source文件中的 index.rst，将demo内的文件添加至目录中。例如</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">toctree</span><span class="p">::</span>
   <span class="nc">:maxdepth:</span> 2
   <span class="nc">:caption:</span> Contents:

   demo/电路原理.rst
   demo/数字电路.rst
</pre></div>
</div>
<p>完成后在Terminal中运行编译命令： <code class="code docutils literal notranslate"><span class="pre">sphinx-build</span> <span class="pre">-b</span> <span class="pre">html</span> <span class="pre">source</span> <span class="pre">build</span></code> ，编译成功后在 build 文件夹中则有刚才发布的网站。</p>
</section>
<section id="id48">
<h3>修改网页主题<a class="headerlink" href="#id48" title="此标题的永久链接"></a></h3>
<p>如果需要修改网页主题，打开 source 文件夹中的conf.py，并找到主题配置行 html_theme = ‘alabaster’ ，修改该参数即可。如果要使用ReadtheDoc主题，则修改为 html_theme = ‘sphinx_rtd_theme’ 。</p>
</section>
<section id="id49">
<h3>加宽网页宽度<a class="headerlink" href="#id49" title="此标题的永久链接"></a></h3>
<p>在使用ReadtheDoc主题时，注意到其内容页面集中在中间，右边存在空间冗余。如果需要将网页宽度加大，可以在 <code class="code docutils literal notranslate"><span class="pre">source/_static</span></code> 中新建css文件，命名为 <code class="code docutils literal notranslate"><span class="pre">style.css</span></code> ，内容为</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">wy-nav-content</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>再在 <code class="code docutils literal notranslate"><span class="pre">source/_templates</span></code> 文件夹中新建一个 <code class="code docutils literal notranslate"><span class="pre">layout.html</span></code> 文件，内容为</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">extends</span> <span class="s2">&quot;!layout.html&quot;</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">extrahead</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="n">link</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{{ pathto(&quot;</span><span class="n">_static</span><span class="o">/</span><span class="n">style</span><span class="o">.</span><span class="n">css</span><span class="s2">&quot;, True) }}&quot;</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>确保 <code class="code docutils literal notranslate"><span class="pre">source/conf.py</span></code> 引用了 <code class="code docutils literal notranslate"><span class="pre">source/_static</span></code> 目录，即包含语句 <code class="code docutils literal notranslate"><span class="pre">html_static_path</span> <span class="pre">=</span> <span class="pre">['_static']</span></code> ，就可以实现将原本ReadtheDoc主题页面宽度加大的效果。</p>
</section>
</section>
<section id="sympy">
<h2>sympy<a class="headerlink" href="#sympy" title="此标题的永久链接"></a></h2>
<p>sympy是重要的数学符号运算库，可以完成数学公式的符号推导。为了调用方便，一般通过 <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">sympy</span> <span class="pre">as</span> <span class="pre">sp</span></code> 导入该库。并且，其计算的函数结果可以通过 <code class="code docutils literal notranslate"><span class="pre">latex</span></code> 函数直接输出 <span class="math notranslate nohighlight">\(\LaTeX\)</span> 公式，例如 <code class="code docutils literal notranslate"><span class="pre">print(latex(integrate(sqrt(x),</span> <span class="pre">x)))</span></code> 。</p>
<p>需要注意的是，由sympy创建的符号函数对象不能混用numpy的函数运算。</p>
<section id="id50">
<h3>变量赋值与精度转换<a class="headerlink" href="#id50" title="此标题的永久链接"></a></h3>
<p>采用符号变量的 <code class="code docutils literal notranslate"><span class="pre">subs()</span></code> 方法来进行替换操作，例如下面的代码实现了令表达式 <span class="math notranslate nohighlight">\(\frac{R_{3} \left(R_{1} U_{s2} + R_{2} U_{s1}\right)}{R_{1} R_{2} + R_{1} R_{3} + R_{2} R_{3}}\)</span> 中的 <span class="math notranslate nohighlight">\(R_{1}=3.6,~R_{2}=3.6,~R_{3}=3.3,~U_{s1}=4,~U_{s2}=8\)</span> ，函数返回了其计算结果。如果只需要给一个变量赋值，那么可以像 <code class="code docutils literal notranslate"><span class="pre">expr.subs(x,1)</span></code> 这样传值。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="p">,</span> <span class="n">R1</span><span class="p">,</span> <span class="n">R2</span><span class="p">,</span> <span class="n">R3</span><span class="p">,</span> <span class="n">Us1</span><span class="p">,</span> <span class="n">Us2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;v R1 R2 R3 Us1 Us2&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">R3</span> <span class="o">*</span> <span class="p">(</span><span class="n">R1</span> <span class="o">*</span> <span class="n">Us2</span> <span class="o">+</span> <span class="n">R2</span> <span class="o">*</span> <span class="n">Us1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R1</span> <span class="o">*</span> <span class="n">R2</span> <span class="o">+</span> <span class="n">R1</span> <span class="o">*</span> <span class="n">R3</span> <span class="o">+</span> <span class="n">R2</span> <span class="o">*</span> <span class="n">R3</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;R1&#39;</span><span class="p">:</span> <span class="mf">3.6</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="mf">3.6</span><span class="p">,</span> <span class="s1">&#39;R3&#39;</span><span class="p">:</span> <span class="mf">3.3</span><span class="p">,</span> <span class="s1">&#39;Us1&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Us2&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>
</pre></div>
</div>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">sympify()</span></code> 函数可以将字符串表达式转换为Sympy表达式。例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">str_expr</span> <span class="o">=</span> <span class="s1">&#39;x**2 + 2*x + 1&#39;</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">str_expr</span><span class="p">)</span>
</pre></div>
</div>
<p>使用符号变量的 <code class="code docutils literal notranslate"><span class="pre">evalf()</span></code> 方法可以将数值转换为指定精度的数值解，保留指定的有效数字。例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pi</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># pi保留3位有效数字</span>
</pre></div>
</div>
</section>
<section id="id51">
<h3>函数表达式化简<a class="headerlink" href="#id51" title="此标题的永久链接"></a></h3>
<section id="simplify">
<h4>simplify函数化简<a class="headerlink" href="#simplify" title="此标题的永久链接"></a></h4>
<p>在符号计算中，最常用的操作就是利用 <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> 函数对表达式进行化简。默认情况下， <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> 函数将自行寻找它认为的最简单的表达形式。下面就是分别利用该函数将 <span class="math notranslate nohighlight">\(\sin^{2}x+\cos^{2}x\)</span> 化简为 <span class="math notranslate nohighlight">\(1\)</span> 和将 <span class="math notranslate nohighlight">\(2\sin\alpha\cos\alpha\)</span> 化简为 <span class="math notranslate nohighlight">\(\sin(2\alpha)\)</span> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id52">
<h4>多项式展开<a class="headerlink" href="#id52" title="此标题的永久链接"></a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">expand</span></code> 函数来实现将多项式展开。例如下面就使用了该函数来展开 <span class="math notranslate nohighlight">\((x_{1}+1)^{2}\)</span> ，成功得到 <span class="math notranslate nohighlight">\(x_{1}^{2}+2x_{1}+1\)</span> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x_1&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">expand</span><span class="p">((</span><span class="n">x_1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id53">
<h4>多项式因式分解<a class="headerlink" href="#id53" title="此标题的永久链接"></a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">factor</span></code> 函数来对多项式进行因式分解。例如下面就使用了该函数来对 <span class="math notranslate nohighlight">\(x^{3}-x^{2}+x-1\)</span> 进行因式分解，成功得到 <span class="math notranslate nohighlight">\((x-1)(x^{2}+1)\)</span> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id54">
<h4>合并同类项<a class="headerlink" href="#id54" title="此标题的永久链接"></a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">collect</span></code> 函数来实现合并同类项的操作。例如下面就使用了该函数来对 <span class="math notranslate nohighlight">\(xy+x-3+2x^{2}-zx^{2}\)</span> 根据 <span class="math notranslate nohighlight">\(x\)</span> 合并同类项，成功得到 <span class="math notranslate nohighlight">\(x^{3}+x^{2}(2-z)+x(y+1)-3\)</span> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="n">new_expr</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id55">
<h4>有理分式化简<a class="headerlink" href="#id55" title="此标题的永久链接"></a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">cancel</span></code> 函数来消去分子分母的公因式。例如下面就使用了该函数来将 <code class="code docutils literal notranslate"><span class="pre">frac{x^{2}+2x+1}{x^{2}+x}</span></code> 化简为 <span class="math notranslate nohighlight">\(\frac{x+1}{x}\)</span> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">cancel</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="id56">
<h4>分式展开<a class="headerlink" href="#id56" title="此标题的永久链接"></a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">apart</span></code> 函数来将分式展开。例如下面就使用了该函数来将 <span class="math notranslate nohighlight">\(\frac{4x^{3}+21x^{2}+10x+12}{x^{4}+5x^{3}+5x^{2}+4x}\)</span> 展开为 <span class="math notranslate nohighlight">\(\frac{2x-1}{x^{2}+x+1}-\frac{1}{x+4}+\frac{3}{x}\)</span> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">21</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">new_expr</span> <span class="o">=</span> <span class="n">apart</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id57">
<h3>符号函数求导<a class="headerlink" href="#id57" title="此标题的永久链接"></a></h3>
<p>求导函数使用的是 <code class="code docutils literal notranslate"><span class="pre">diff</span></code> 函数。对一个一元函数求一阶导可以简单地像这样完成： <code class="code docutils literal notranslate"><span class="pre">diff(cos(x),</span> <span class="pre">x)</span></code> 。如果需要求高阶导可以像这样来完成： <code class="code docutils literal notranslate"><span class="pre">diff(x**4,</span> <span class="pre">x,</span> <span class="pre">3)</span></code> 。其中的表达式也不一定要放在括号内，可以作为符号变量放在外面。</p>
<p>下面以计算 <span class="math notranslate nohighlight">\(\frac{\partial y}{\partial x_{2}}=\frac{\partial }{\partial x_{2}}\left ( x_{1}^{2}+x_{2}^{2} \right )\)</span> 为例来说明偏导数的计算。首先要定义表达式的变量名称：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x1 x2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>然后定义表达式内容：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>那么计算对 <span class="math notranslate nohighlight">\(x_{2}\)</span> 偏导数的结果为</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dy_dx2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
<p>可以 <code class="code docutils literal notranslate"><span class="pre">print(dy_dx2)</span></code> 来查看计算结果的表达式。如果需要给该表达式的自变量赋值进行计算，可以使用 <code class="code docutils literal notranslate"><span class="pre">evalf(subs={})</span></code> 函数。其中 <code class="code docutils literal notranslate"><span class="pre">subs={}</span></code> 里面填入对应变量及其取值的字典。例如上述偏导结果代入 <span class="math notranslate nohighlight">\(x_{2}=6\)</span> 的方式如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">dy_dx2</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id58">
<h3>符号函数积分<a class="headerlink" href="#id58" title="此标题的永久链接"></a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">integrate</span></code> 函数来求积分。例如 <code class="code docutils literal notranslate"><span class="pre">integrate(cos(x),</span> <span class="pre">x)</span></code> 。</p>
<p>如果要求定积分，则在变量处传入元组，依次说明变量、积分下限和积分上限。同时注意，在sympy中，使用 <code class="code docutils literal notranslate"><span class="pre">oo</span></code> 来表示 <span class="math notranslate nohighlight">\(\infty\)</span> 。例如 <code class="code docutils literal notranslate"><span class="pre">integrate(exp(-x),</span> <span class="pre">(x,</span> <span class="pre">0,</span> <span class="pre">oo))</span></code> 就计算了 <span class="math notranslate nohighlight">\(\int_{0}^{\infty}e^{-x}~\mathrm{d}x\)</span></p>
<p>如果要计算二重积分，则只需多传入一个变量元组即可。例如 <code class="code docutils literal notranslate"><span class="pre">integrate(exp(-x**2</span> <span class="pre">-</span> <span class="pre">y**2),</span> <span class="pre">(x,</span> <span class="pre">-oo,</span> <span class="pre">oo),</span> <span class="pre">(y,</span> <span class="pre">-oo,</span> <span class="pre">oo))</span></code> 就计算了 <span class="math notranslate nohighlight">\(\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-x^{2}-y^{2}}~\mathrm{d}x\mathrm{d}y\)</span> 。</p>
</section>
<section id="id59">
<h3>符号函数极限<a class="headerlink" href="#id59" title="此标题的永久链接"></a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">limit</span></code> 函数来计算函数极限。例如 <code class="code docutils literal notranslate"><span class="pre">limit(sp.sin(x)/x,</span> <span class="pre">x,</span> <span class="pre">0)</span></code> 计算了 <span class="math notranslate nohighlight">\(\lim\limits_{x\to 0}\frac{\sin x}{x}\)</span> 。</p>
<p>如果要计算单侧积分，则只需额外用 <code class="code docutils literal notranslate"><span class="pre">'+'</span></code> 或 <code class="code docutils literal notranslate"><span class="pre">'-'</span></code> 指定即可。例如 <code class="code docutils literal notranslate"><span class="pre">limit(1/x,</span> <span class="pre">x,</span> <span class="pre">0,</span> <span class="pre">'+')</span></code> 计算了 <span class="math notranslate nohighlight">\(\lim\limits _{x\to 0^{+}}\frac{1}{x}\)</span> 。</p>
</section>
<section id="id60">
<h3>符号函数的级数展开<a class="headerlink" href="#id60" title="此标题的永久链接"></a></h3>
<p>使用符号变量的 <code class="code docutils literal notranslate"><span class="pre">series</span></code> 方法可以对函数 <span class="math notranslate nohighlight">\(f(x)\)</span> 在 <span class="math notranslate nohighlight">\(x=x_{0}\)</span> 处进行 <span class="math notranslate nohighlight">\(n\)</span> 阶展开。例如下面进行对 <span class="math notranslate nohighlight">\(f(x)=\sin x\)</span> 在 <span class="math notranslate nohighlight">\(x=0\)</span> 处进行4阶展开：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">new_expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id61">
<h3>求解符号方程组<a class="headerlink" href="#id61" title="此标题的永久链接"></a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">solve</span></code> 函数来求解符号方程组，依次传入方程组列表和需要求解的变量列表，常数符号不需要写入参数当中。例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">,</span> <span class="n">R1</span><span class="p">,</span> <span class="n">R2</span><span class="p">,</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u1 u2 R1 R2 R3&#39;</span><span class="p">)</span>

<span class="n">eq1</span> <span class="o">=</span> <span class="p">(</span><span class="n">R1</span> <span class="o">+</span> <span class="n">R3</span><span class="p">)</span><span class="o">/</span><span class="n">R3</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">eq2</span> <span class="o">=</span> <span class="p">(</span><span class="n">R1</span><span class="o">*</span><span class="n">R2</span> <span class="o">+</span> <span class="n">R1</span><span class="o">*</span><span class="n">R3</span> <span class="o">+</span> <span class="n">R2</span><span class="o">*</span><span class="n">R3</span><span class="p">)</span><span class="o">/</span><span class="n">R3</span> <span class="o">-</span> <span class="mi">8</span>
<span class="n">eq3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">R3</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="n">eq4</span> <span class="o">=</span> <span class="p">(</span><span class="n">R2</span> <span class="o">+</span> <span class="n">R3</span><span class="p">)</span><span class="o">/</span><span class="n">R3</span> <span class="o">-</span> <span class="mf">2.5</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">([</span><span class="n">eq1</span><span class="p">,</span> <span class="n">eq2</span><span class="p">,</span> <span class="n">eq3</span><span class="p">,</span> <span class="n">eq4</span><span class="p">],</span> <span class="p">[</span><span class="n">R1</span><span class="p">,</span> <span class="n">R2</span><span class="p">,</span> <span class="n">R3</span><span class="p">])</span>
</pre></div>
</div>
<p>如果没有解析解则会报错。这时可以改用 <code class="code docutils literal notranslate"><span class="pre">nsolve</span></code> 函数来求数值解。</p>
</section>
<section id="id62">
<h3>求解微分符号方程<a class="headerlink" href="#id62" title="此标题的永久链接"></a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> 函数求解微分方程。首先建立符号函数变量，需要在 <code class="code docutils literal notranslate"><span class="pre">symbols</span></code> 函数内额外设置 <code class="code docutils literal notranslate"><span class="pre">cls</span></code> 参数，并且在后续方程的书写时带上括号和自变量符号，而不能仅使用符号函数变量来书写，同时使用 <code class="code docutils literal notranslate"><span class="pre">diff</span></code> 函数来表示微分量。下面的案例求解了一个二阶微分方程。</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{\mathrm{d}^{2}u_{c}(t)}{\mathrm{d}t^{2}} +2\alpha \frac{\mathrm{d}u_{c}(t)}{\mathrm{d}t} + \omega_{0}^{2}u_{c}(t)=0
\end{align}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uc</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u_c&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
<span class="n">alpha</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;alpha omega t&#39;</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">uc</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">uc</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">uc</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">uc</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
<p>可以支持微分方程组的计算，只需在传入方程时传入对应的列表即可。</p>
</section>
<section id="id63">
<h3>矩阵运算<a class="headerlink" href="#id63" title="此标题的永久链接"></a></h3>
<section id="id64">
<h4>构建矩阵<a class="headerlink" href="#id64" title="此标题的永久链接"></a></h4>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">Matrix</span></code> 函数构造矩阵。例如 <code class="code docutils literal notranslate"><span class="pre">Matrix([[1,</span> <span class="pre">-1],</span> <span class="pre">[3,</span> <span class="pre">4],</span> <span class="pre">[0,</span> <span class="pre">2]])</span></code> 构造矩阵 <span class="math notranslate nohighlight">\(\begin{pmatrix} 1 &amp; -1\\ 3 &amp; 4\\ 0 &amp; 2\end{pmatrix}\)</span> ， <code class="code docutils literal notranslate"><span class="pre">Matrix([1,</span> <span class="pre">2,</span> <span class="pre">3])</span></code> 构造列向量 <span class="math notranslate nohighlight">\(\begin{pmatrix}1 \\2 \\3\end{pmatrix}\)</span> ，配合转置操作 <code class="code docutils literal notranslate"><span class="pre">T</span></code> 可以像 <code class="code docutils literal notranslate"><span class="pre">Matrix([[1],</span> <span class="pre">[2],</span> <span class="pre">[3]]).T</span></code> 构造行向量 <span class="math notranslate nohighlight">\(\begin{pmatrix} 1 &amp; 2 &amp; 3\end{pmatrix}\)</span> 。</p>
<p>特别地，可以用 <code class="code docutils literal notranslate"><span class="pre">eye(4)</span></code> 构建4阶单位矩阵；用 <code class="code docutils literal notranslate"><span class="pre">zeros(4)</span></code> 构建4阶全零矩阵；用 <code class="code docutils literal notranslate"><span class="pre">ones(4)</span></code> 构建4阶全一矩阵；用 <code class="code docutils literal notranslate"><span class="pre">diag(1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4)</span></code> 构建对角矩阵。</p>
</section>
<section id="id65">
<h4>求矩阵的幂与求逆<a class="headerlink" href="#id65" title="此标题的永久链接"></a></h4>
<p>直接对矩阵变量像数值那样进行幂操作即可，例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>特别地，矩阵的 <span class="math notranslate nohighlight">\(-1\)</span> 次幂就是矩阵的逆。</p>
</section>
<section id="id66">
<h4>求矩阵的行列式<a class="headerlink" href="#id66" title="此标题的永久链接"></a></h4>
<p>用矩阵变量的 <code class="code docutils literal notranslate"><span class="pre">det</span></code> 函数来求其行列式：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id67">
<h4>求矩阵的特征值和特征多项式<a class="headerlink" href="#id67" title="此标题的永久链接"></a></h4>
<p>用矩阵变量的 <code class="code docutils literal notranslate"><span class="pre">eigenvals</span></code> 函数来求其特征值。该函数返回的是字典，字典的key是特征值，value是对应的重数。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]])</span>
<span class="n">eigenvalue</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
</pre></div>
</div>
<p>用矩阵变量的 <code class="code docutils literal notranslate"><span class="pre">charpoly</span></code> 方法来求其特征多项式。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]])</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="n">lamda</span><span class="p">)</span>
<span class="n">eigenpolynomial</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="c1"># 调用了factor来将表达式因式分解</span>
</pre></div>
</div>
</section>
</section>
<section id="laplace">
<h3>Laplace变换<a class="headerlink" href="#laplace" title="此标题的永久链接"></a></h3>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">laplace_transform</span></code> 进行Laplace变换，例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t s&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">laplace_transform</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>使用 <code class="code docutils literal notranslate"><span class="pre">inverse_laplace_transform</span></code> 进行逆Laplace变换，例如</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;s t&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">inverse_laplace_transform</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Latex.html" class="btn btn-neutral float-left" title="Latex" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, Koishi.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>